(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[705],{46343:function(ci,mn,ot){"use strict";ot.d(mn,{S$:function(){return Gr},sX:function(){return Ar},bf:function(){return er},oI:function(){return Rt},ni:function(){return Ae},gg:function(){return Gt}});var vt=ot(34155);function Ze($e,rt,Wt,Kt){function ur(ae){return ae instanceof Wt?ae:new Wt(function(z){z(ae)})}return new(Wt||(Wt=Promise))(function(ae,z){function R(ce){try{b(Kt.next(ce))}catch(Ye){z(Ye)}}function j(ce){try{b(Kt.throw(ce))}catch(Ye){z(Ye)}}function b(ce){ce.done?ae(ce.value):ur(ce.value).then(R,j)}b((Kt=Kt.apply($e,rt||[])).next())})}function l($e,rt){var Wt={label:0,sent:function(){if(ae[0]&1)throw ae[1];return ae[1]},trys:[],ops:[]},Kt,ur,ae,z;return z={next:R(0),throw:R(1),return:R(2)},typeof Symbol=="function"&&(z[Symbol.iterator]=function(){return this}),z;function R(b){return function(ce){return j([b,ce])}}function j(b){if(Kt)throw new TypeError("Generator is already executing.");for(;Wt;)try{if(Kt=1,ur&&(ae=b[0]&2?ur.return:b[0]?ur.throw||((ae=ur.return)&&ae.call(ur),0):ur.next)&&!(ae=ae.call(ur,b[1])).done)return ae;switch(ur=0,ae&&(b=[b[0]&2,ae.value]),b[0]){case 0:case 1:ae=b;break;case 4:return Wt.label++,{value:b[1],done:!1};case 5:Wt.label++,ur=b[1],b=[0];continue;case 7:b=Wt.ops.pop(),Wt.trys.pop();continue;default:if(ae=Wt.trys,!(ae=ae.length>0&&ae[ae.length-1])&&(b[0]===6||b[0]===2)){Wt=0;continue}if(b[0]===3&&(!ae||b[1]>ae[0]&&b[1]<ae[3])){Wt.label=b[1];break}if(b[0]===6&&Wt.label<ae[1]){Wt.label=ae[1],ae=b;break}if(ae&&Wt.label<ae[2]){Wt.label=ae[2],Wt.ops.push(b);break}ae[2]&&Wt.ops.pop(),Wt.trys.pop();continue}b=rt.call($e,Wt)}catch(ce){b=[6,ce],ur=0}finally{Kt=ae=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}}function Vt($e,rt){var Wt=typeof Symbol=="function"&&$e[Symbol.iterator];if(!Wt)return $e;var Kt=Wt.call($e),ur,ae=[],z;try{for(;(rt===void 0||rt-- >0)&&!(ur=Kt.next()).done;)ae.push(ur.value)}catch(R){z={error:R}}finally{try{ur&&!ur.done&&(Wt=Kt.return)&&Wt.call(Kt)}finally{if(z)throw z.error}}return ae}function ge($e,rt,Wt){if(Wt||arguments.length===2)for(var Kt=0,ur=rt.length,ae;Kt<ur;Kt++)(ae||!(Kt in rt))&&(ae||(ae=Array.prototype.slice.call(rt,0,Kt)),ae[Kt]=rt[Kt]);return $e.concat(ae||Array.prototype.slice.call(rt))}function Mt($e){return $e&&$e.__esModule&&Object.prototype.hasOwnProperty.call($e,"default")?$e.default:$e}var Le={exports:{}},Tt={exports:{}},Fe={exports:{}};(function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0}),rt.default=Wt;function Wt(Kt){return Kt&&typeof Kt.length=="number"&&Kt.length>=0&&Kt.length%1==0}$e.exports=rt.default})(Fe,Fe.exports);var dt={},nr={exports:{}},dr={exports:{}};(function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0}),rt.default=function(Wt){return function(){for(var Kt=[],ur=arguments.length;ur--;)Kt[ur]=arguments[ur];var ae=Kt.pop();return Wt.call(this,Kt,ae)}},$e.exports=rt.default})(dr,dr.exports);var Dt={};Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.fallback=Et,Dt.wrap=vr;var Er=Dt.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,wt=Dt.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,fr=Dt.hasNextTick=typeof vt=="object"&&typeof vt.nextTick=="function";function Et($e){setTimeout($e,0)}function vr($e){return function(rt){for(var Wt=[],Kt=arguments.length-1;Kt-- >0;)Wt[Kt]=arguments[Kt+1];return $e(function(){return rt.apply(void 0,Wt)})}}var kt;Er?kt=queueMicrotask:wt?kt=setImmediate:fr?kt=vt.nextTick:kt=Et,Dt.default=vr(kt),function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0}),rt.default=j;var Wt=dr.exports,Kt=R(Wt),ur=Dt,ae=R(ur),z=dt;function R(Ye){return Ye&&Ye.__esModule?Ye:{default:Ye}}function j(Ye){return(0,z.isAsync)(Ye)?function(){for(var Pt=[],te=arguments.length;te--;)Pt[te]=arguments[te];var he=Pt.pop(),ve=Ye.apply(this,Pt);return b(ve,he)}:(0,Kt.default)(function(Pt,te){var he;try{he=Ye.apply(this,Pt)}catch(ve){return te(ve)}if(he&&typeof he.then=="function")return b(he,te);te(null,he)})}function b(Ye,Pt){return Ye.then(function(te){ce(Pt,null,te)},function(te){ce(Pt,te&&te.message?te:new Error(te))})}function ce(Ye,Pt,te){try{Ye(Pt,te)}catch(he){(0,ae.default)(function(ve){throw ve},he)}}$e.exports=rt.default}(nr,nr.exports),Object.defineProperty(dt,"__esModule",{value:!0}),dt.isAsyncIterable=dt.isAsyncGenerator=dt.isAsync=void 0;var mt=nr.exports,k=Te(mt);function Te($e){return $e&&$e.__esModule?$e:{default:$e}}function Se($e){return $e[Symbol.toStringTag]==="AsyncFunction"}function me($e){return $e[Symbol.toStringTag]==="AsyncGenerator"}function De($e){return typeof $e[Symbol.asyncIterator]=="function"}function we($e){if(typeof $e!="function")throw new Error("expected a function");return Se($e)?(0,k.default)($e):$e}dt.default=we,dt.isAsync=Se,dt.isAsyncGenerator=me,dt.isAsyncIterable=De;var ze={exports:{}};(function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0}),rt.default=Wt;function Wt(Kt,ur){if(ur===void 0&&(ur=Kt.length),!ur)throw new Error("arity is undefined");function ae(){for(var z=this,R=[],j=arguments.length;j--;)R[j]=arguments[j];return typeof R[ur-1]=="function"?Kt.apply(this,R):new Promise(function(b,ce){R[ur-1]=function(Ye){for(var Pt=[],te=arguments.length-1;te-- >0;)Pt[te]=arguments[te+1];if(Ye)return ce(Ye);b(Pt.length>1?Pt:Pt[0])},Kt.apply(z,R)})}return ae}$e.exports=rt.default})(ze,ze.exports),function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0});var Wt=Fe.exports,Kt=j(Wt),ur=dt,ae=j(ur),z=ze.exports,R=j(z);function j(b){return b&&b.__esModule?b:{default:b}}rt.default=(0,R.default)(function(b,ce,Ye){var Pt=(0,Kt.default)(ce)?[]:{};b(ce,function(te,he,ve){(0,ae.default)(te)(function(it){for(var at,fe=[],wr=arguments.length-1;wr-- >0;)fe[wr]=arguments[wr+1];fe.length<2&&(at=fe,fe=at[0]),Pt[he]=fe,ve(it)})},function(te){return Ye(te,Pt)})},3),$e.exports=rt.default}(Tt,Tt.exports);var Qt={exports:{}},V={exports:{}},pe={exports:{}},P={exports:{}};(function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0}),rt.default=Wt;function Wt(Kt){function ur(){for(var ae=[],z=arguments.length;z--;)ae[z]=arguments[z];if(Kt!==null){var R=Kt;Kt=null,R.apply(this,ae)}}return Object.assign(ur,Kt),ur}$e.exports=rt.default})(P,P.exports);var U={exports:{}},B={exports:{}};(function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0}),rt.default=function(Wt){return Wt[Symbol.iterator]&&Wt[Symbol.iterator]()},$e.exports=rt.default})(B,B.exports),function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0}),rt.default=ce;var Wt=Fe.exports,Kt=z(Wt),ur=B.exports,ae=z(ur);function z(Ye){return Ye&&Ye.__esModule?Ye:{default:Ye}}function R(Ye){var Pt=-1,te=Ye.length;return function(){return++Pt<te?{value:Ye[Pt],key:Pt}:null}}function j(Ye){var Pt=-1;return function(){var he=Ye.next();return he.done?null:(Pt++,{value:he.value,key:Pt})}}function b(Ye){var Pt=Ye?Object.keys(Ye):[],te=-1,he=Pt.length;return function ve(){var it=Pt[++te];return it==="__proto__"?ve():te<he?{value:Ye[it],key:it}:null}}function ce(Ye){if((0,Kt.default)(Ye))return R(Ye);var Pt=(0,ae.default)(Ye);return Pt?j(Pt):b(Ye)}$e.exports=rt.default}(U,U.exports);var E={exports:{}};(function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0}),rt.default=Wt;function Wt(Kt){return function(){for(var ur=[],ae=arguments.length;ae--;)ur[ae]=arguments[ae];if(Kt===null)throw new Error("Callback was already called.");var z=Kt;Kt=null,z.apply(this,ur)}}$e.exports=rt.default})(E,E.exports);var D={exports:{}},q={exports:{}};(function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0});var Wt={};rt.default=Wt,$e.exports=rt.default})(q,q.exports),function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0}),rt.default=ae;var Wt=q.exports,Kt=ur(Wt);function ur(z){return z&&z.__esModule?z:{default:z}}function ae(z,R,j,b){var ce=!1,Ye=!1,Pt=!1,te=0,he=0;function ve(){te>=R||Pt||ce||(Pt=!0,z.next().then(function(fe){var wr=fe.value,Dr=fe.done;if(!(Ye||ce)){if(Pt=!1,Dr){ce=!0,te<=0&&b(null);return}te++,j(wr,he,it),he++,ve()}}).catch(at))}function it(fe,wr){if(te-=1,!Ye){if(fe)return at(fe);if(fe===!1){ce=!0,Ye=!0;return}if(wr===Kt.default||ce&&te<=0)return ce=!0,b(null);ve()}}function at(fe){Ye||(Pt=!1,ce=!0,b(fe))}ve()}$e.exports=rt.default}(D,D.exports),function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0});var Wt=P.exports,Kt=te(Wt),ur=U.exports,ae=te(ur),z=E.exports,R=te(z),j=dt,b=D.exports,ce=te(b),Ye=q.exports,Pt=te(Ye);function te(he){return he&&he.__esModule?he:{default:he}}rt.default=function(he){return function(ve,it,at){if(at=(0,Kt.default)(at),he<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!ve)return at(null);if((0,j.isAsyncGenerator)(ve))return(0,ce.default)(ve,he,it,at);if((0,j.isAsyncIterable)(ve))return(0,ce.default)(ve[Symbol.asyncIterator](),he,it,at);var fe=(0,ae.default)(ve),wr=!1,Dr=!1,Nr=0,yt=!1;function jr(ai,Mi){if(!Dr)if(Nr-=1,ai)wr=!0,at(ai);else if(ai===!1)wr=!0,Dr=!0;else{if(Mi===Pt.default||wr&&Nr<=0)return wr=!0,at(null);yt||Dn()}}function Dn(){for(yt=!0;Nr<he&&!wr;){var ai=fe();if(ai===null){wr=!0,Nr<=0&&at(null);return}Nr+=1,it(ai.value,ai.key,(0,R.default)(jr))}yt=!1}Dn()}},$e.exports=rt.default}(pe,pe.exports),function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0});var Wt=pe.exports,Kt=j(Wt),ur=dt,ae=j(ur),z=ze.exports,R=j(z);function j(ce){return ce&&ce.__esModule?ce:{default:ce}}function b(ce,Ye,Pt,te){return(0,Kt.default)(Ye)(ce,(0,ae.default)(Pt),te)}rt.default=(0,R.default)(b,4),$e.exports=rt.default}(V,V.exports),function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0});var Wt=V.exports,Kt=z(Wt),ur=ze.exports,ae=z(ur);function z(j){return j&&j.__esModule?j:{default:j}}function R(j,b,ce){return(0,Kt.default)(j,1,b,ce)}rt.default=(0,ae.default)(R,3),$e.exports=rt.default}(Qt,Qt.exports),function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0}),rt.default=R;var Wt=Tt.exports,Kt=z(Wt),ur=Qt.exports,ae=z(ur);function z(j){return j&&j.__esModule?j:{default:j}}function R(j,b){return(0,Kt.default)(ae.default,j,b)}$e.exports=rt.default}(Le,Le.exports);var Q=Mt(Le.exports),Ae=function(){function $e(){this.args=[],this.tasks=[]}return $e.prototype.call=function(){for(var rt=arguments,Wt=[],Kt=0;Kt<arguments.length;Kt++)Wt[Kt]=rt[Kt];return this.args=Wt,Q(this.tasks)},$e.prototype.tap=function(rt,Wt){var Kt=this;this.tasks.push(function(ur){Wt.apply(void 0,ge([],Vt(Kt.args),!1)),ur(null,rt)})},$e}(),ct={exports:{}},ke={exports:{}};(function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0});var Wt=Fe.exports,Kt=it(Wt),ur=q.exports,ae=it(ur),z=V.exports,R=it(z),j=P.exports,b=it(j),ce=E.exports,Ye=it(ce),Pt=dt,te=it(Pt),he=ze.exports,ve=it(he);function it(Dr){return Dr&&Dr.__esModule?Dr:{default:Dr}}function at(Dr,Nr,yt){yt=(0,b.default)(yt);var jr=0,Dn=0,ai=Dr.length,Mi=!1;ai===0&&yt(null);function Li(Kn,L){Kn===!1&&(Mi=!0),Mi!==!0&&(Kn?yt(Kn):(++Dn===ai||L===ae.default)&&yt(null))}for(;jr<ai;jr++)Nr(Dr[jr],jr,(0,Ye.default)(Li))}function fe(Dr,Nr,yt){return(0,R.default)(Dr,Infinity,Nr,yt)}function wr(Dr,Nr,yt){var jr=(0,Kt.default)(Dr)?at:fe;return jr(Dr,(0,te.default)(Nr),yt)}rt.default=(0,ve.default)(wr,3),$e.exports=rt.default})(ke,ke.exports),function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0}),rt.default=R;var Wt=ke.exports,Kt=z(Wt),ur=Tt.exports,ae=z(ur);function z(j){return j&&j.__esModule?j:{default:j}}function R(j,b){return(0,ae.default)(Kt.default,j,b)}$e.exports=rt.default}(ct,ct.exports);var He=Mt(ct.exports),We=function(){function $e(){this.tasks=[]}return $e.prototype.promise=function(){return He(this.tasks)},$e.prototype.tapPromise=function(rt,Wt){var Kt=this;this.tasks.push(function(ur){return Ze(Kt,void 0,void 0,function(){return l(this,function(ae){switch(ae.label){case 0:return[4,Wt()];case 1:return ae.sent(),ur(null,rt),[2]}})})})},$e}(),xt={exports:{}};(function($e,rt){Object.defineProperty(rt,"__esModule",{value:!0});var Wt=P.exports,Kt=ce(Wt),ur=E.exports,ae=ce(ur),z=dt,R=ce(z),j=ze.exports,b=ce(j);function ce(Pt){return Pt&&Pt.__esModule?Pt:{default:Pt}}function Ye(Pt,te){if(te=(0,Kt.default)(te),!Array.isArray(Pt))return te(new Error("First argument to waterfall must be an array of functions"));if(!Pt.length)return te();var he=0;function ve(at){var fe=(0,R.default)(Pt[he++]);fe.apply(void 0,at.concat([(0,ae.default)(it)]))}function it(at){for(var fe=[],wr=arguments.length-1;wr-- >0;)fe[wr]=arguments[wr+1];if(at!==!1){if(at||he===Pt.length)return te.apply(void 0,[at].concat(fe));ve(fe)}}ve([])}rt.default=(0,b.default)(Ye),$e.exports=rt.default})(xt,xt.exports);var jt=Mt(xt.exports),Gt=function(){function $e(){this.tasks=[]}return $e.prototype.call=function(){return jt(this.tasks)},$e.prototype.tap=function(rt,Wt){this.tasks.length===0?this.tasks.push(function(Kt){var ur=Wt();Kt(ur?null:!1,ur)}):this.tasks.push(function(Kt,ur){var ae=Wt.apply(void 0,ge([],Vt(Kt),!1));ur(ae?null:!1,rt)})},$e}(),Rt=function(){function $e(){this.tasks=[]}return $e.prototype.call=function(){return Q(this.tasks)},$e.prototype.tap=function(rt,Wt){this.tasks.push(function(Kt){var ur=Wt();Kt(ur,rt)})},$e}(),Ar=function(){function $e(){this.args=[],this.tasks=[]}return $e.prototype.promise=function(){for(var rt=arguments,Wt=[],Kt=0;Kt<arguments.length;Kt++)Wt[Kt]=rt[Kt];return this.args=Wt,Q(this.tasks)},$e.prototype.tapPromise=function(rt,Wt){var Kt=this;this.tasks.push(function(ur){return Ze(Kt,void 0,void 0,function(){return l(this,function(ae){switch(ae.label){case 0:return[4,Wt.apply(void 0,ge([],Vt(this.args),!1))];case 1:return ae.sent(),ur(null,rt),[2]}})})})},$e}(),Gr=function(){function $e(){this.args=[],this.tasks=[]}return $e.prototype.promise=function(){for(var rt=arguments,Wt=[],Kt=0;Kt<arguments.length;Kt++)Wt[Kt]=rt[Kt];return this.args=Wt,Q(this.tasks)},$e.prototype.tapPromise=function(rt,Wt){var Kt=this;this.tasks.push(function(ur){return Ze(Kt,void 0,void 0,function(){var ae;return l(this,function(z){switch(z.label){case 0:return[4,Wt.apply(void 0,ge([],Vt(this.args),!1))];case 1:return ae=z.sent(),ur(ae,rt),[2]}})})})},$e}(),er=function(){function $e(){this.tasks=[]}return $e.prototype.promise=function(){return jt(this.tasks)},$e.prototype.tapPromise=function(rt,Wt){this.tasks.length===0?this.tasks.push(function(Kt){Wt().then(function(ur){Kt(null,ur)})}):this.tasks.push(function(Kt,ur){Wt(Kt).then(function(ae){ur(null,ae)})})},$e}()},6481:function(ci,mn,ot){"use strict";ot.d(mn,{Z:function(){return l}});var vt=ot(14665),Ze=ot(51814);function l(Vt,ge,Mt){return(0,Ze.Z)()?l=Reflect.construct.bind():l=function(Tt,Fe,dt){var nr=[null];nr.push.apply(nr,Fe);var dr=Function.bind.apply(Tt,nr),Dt=new dr;return dt&&(0,vt.Z)(Dt,dt.prototype),Dt},l.apply(null,arguments)}},66213:function(ci,mn,ot){"use strict";ot.d(mn,{Z:function(){return l}});var vt=ot(77608);function Ze(Vt,ge){for(;!Object.prototype.hasOwnProperty.call(Vt,ge)&&(Vt=(0,vt.Z)(Vt),Vt!==null););return Vt}function l(){return typeof Reflect!="undefined"&&Reflect.get?l=Reflect.get.bind():l=function(ge,Mt,Le){var Tt=Ze(ge,Mt);if(!!Tt){var Fe=Object.getOwnPropertyDescriptor(Tt,Mt);return Fe.get?Fe.get.call(arguments.length<3?ge:Le):Fe.value}},l.apply(this,arguments)}},57869:function(ci,mn,ot){"use strict";ot.d(mn,{Z:function(){return ge}});var vt=ot(77608),Ze=ot(14665);function l(Mt){return Function.toString.call(Mt).indexOf("[native code]")!==-1}var Vt=ot(6481);function ge(Mt){var Le=typeof Map=="function"?new Map:void 0;return ge=function(Fe){if(Fe===null||!l(Fe))return Fe;if(typeof Fe!="function")throw new TypeError("Super expression must either be null or a function");if(typeof Le!="undefined"){if(Le.has(Fe))return Le.get(Fe);Le.set(Fe,dt)}function dt(){return(0,Vt.Z)(Fe,arguments,(0,vt.Z)(this).constructor)}return dt.prototype=Object.create(Fe.prototype,{constructor:{value:dt,enumerable:!1,writable:!0,configurable:!0}}),(0,Ze.Z)(dt,Fe)},ge(Mt)}},38163:function(ci){ci.exports=mn;function mn(Ze,l){var Vt=Ze&&Ze.type,ge;if(Vt==="FeatureCollection")for(ge=0;ge<Ze.features.length;ge++)mn(Ze.features[ge],l);else if(Vt==="GeometryCollection")for(ge=0;ge<Ze.geometries.length;ge++)mn(Ze.geometries[ge],l);else if(Vt==="Feature")mn(Ze.geometry,l);else if(Vt==="Polygon")ot(Ze.coordinates,l);else if(Vt==="MultiPolygon")for(ge=0;ge<Ze.coordinates.length;ge++)ot(Ze.coordinates[ge],l);return Ze}function ot(Ze,l){if(Ze.length!==0){vt(Ze[0],l);for(var Vt=1;Vt<Ze.length;Vt++)vt(Ze[Vt],!l)}}function vt(Ze,l){for(var Vt=0,ge=0,Mt=0,Le=Ze.length,Tt=Le-1;Mt<Le;Tt=Mt++){var Fe=(Ze[Mt][0]-Ze[Tt][0])*(Ze[Tt][1]+Ze[Mt][1]),dt=Vt+Fe;ge+=Math.abs(Vt)>=Math.abs(Fe)?Vt-dt+Fe:Fe-dt+Vt,Vt=dt}Vt+ge>=0!=!!l&&Ze.reverse()}},75550:function(ci){"use strict";ci.exports=mn;function mn(ot,vt){this.x=ot,this.y=vt}mn.prototype={clone:function(){return new mn(this.x,this.y)},add:function(ot){return this.clone()._add(ot)},sub:function(ot){return this.clone()._sub(ot)},multByPoint:function(ot){return this.clone()._multByPoint(ot)},divByPoint:function(ot){return this.clone()._divByPoint(ot)},mult:function(ot){return this.clone()._mult(ot)},div:function(ot){return this.clone()._div(ot)},rotate:function(ot){return this.clone()._rotate(ot)},rotateAround:function(ot,vt){return this.clone()._rotateAround(ot,vt)},matMult:function(ot){return this.clone()._matMult(ot)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(ot){return this.x===ot.x&&this.y===ot.y},dist:function(ot){return Math.sqrt(this.distSqr(ot))},distSqr:function(ot){var vt=ot.x-this.x,Ze=ot.y-this.y;return vt*vt+Ze*Ze},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(ot){return Math.atan2(this.y-ot.y,this.x-ot.x)},angleWith:function(ot){return this.angleWithSep(ot.x,ot.y)},angleWithSep:function(ot,vt){return Math.atan2(this.x*vt-this.y*ot,this.x*ot+this.y*vt)},_matMult:function(ot){var vt=ot[0]*this.x+ot[1]*this.y,Ze=ot[2]*this.x+ot[3]*this.y;return this.x=vt,this.y=Ze,this},_add:function(ot){return this.x+=ot.x,this.y+=ot.y,this},_sub:function(ot){return this.x-=ot.x,this.y-=ot.y,this},_mult:function(ot){return this.x*=ot,this.y*=ot,this},_div:function(ot){return this.x/=ot,this.y/=ot,this},_multByPoint:function(ot){return this.x*=ot.x,this.y*=ot.y,this},_divByPoint:function(ot){return this.x/=ot.x,this.y/=ot.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var ot=this.y;return this.y=this.x,this.x=-ot,this},_rotate:function(ot){var vt=Math.cos(ot),Ze=Math.sin(ot),l=vt*this.x-Ze*this.y,Vt=Ze*this.x+vt*this.y;return this.x=l,this.y=Vt,this},_rotateAround:function(ot,vt){var Ze=Math.cos(ot),l=Math.sin(ot),Vt=vt.x+Ze*(this.x-vt.x)-l*(this.y-vt.y),ge=vt.y+l*(this.x-vt.x)+Ze*(this.y-vt.y);return this.x=Vt,this.y=ge,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},mn.convert=function(ot){return ot instanceof mn?ot:Array.isArray(ot)?new mn(ot[0],ot[1]):ot}},38929:function(ci,mn,ot){ci.exports.VectorTile=ot(22779),ot(66024),ot(59701)},22779:function(ci,mn,ot){"use strict";var vt=ot(59701);ci.exports=Ze;function Ze(Vt,ge){this.layers=Vt.readFields(l,{},ge)}function l(Vt,ge,Mt){if(Vt===3){var Le=new vt(Mt,Mt.readVarint()+Mt.pos);Le.length&&(ge[Le.name]=Le)}}},66024:function(ci,mn,ot){"use strict";var vt=ot(75550);ci.exports=Ze;function Ze(Le,Tt,Fe,dt,nr){this.properties={},this.extent=Fe,this.type=0,this._pbf=Le,this._geometry=-1,this._keys=dt,this._values=nr,Le.readFields(l,this,Tt)}function l(Le,Tt,Fe){Le==1?Tt.id=Fe.readVarint():Le==2?Vt(Fe,Tt):Le==3?Tt.type=Fe.readVarint():Le==4&&(Tt._geometry=Fe.pos)}function Vt(Le,Tt){for(var Fe=Le.readVarint()+Le.pos;Le.pos<Fe;){var dt=Tt._keys[Le.readVarint()],nr=Tt._values[Le.readVarint()];Tt.properties[dt]=nr}}Ze.types=["Unknown","Point","LineString","Polygon"],Ze.prototype.loadGeometry=function(){var Le=this._pbf;Le.pos=this._geometry;for(var Tt=Le.readVarint()+Le.pos,Fe=1,dt=0,nr=0,dr=0,Dt=[],Er;Le.pos<Tt;){if(dt<=0){var wt=Le.readVarint();Fe=wt&7,dt=wt>>3}if(dt--,Fe===1||Fe===2)nr+=Le.readSVarint(),dr+=Le.readSVarint(),Fe===1&&(Er&&Dt.push(Er),Er=[]),Er.push(new vt(nr,dr));else if(Fe===7)Er&&Er.push(Er[0].clone());else throw new Error("unknown command "+Fe)}return Er&&Dt.push(Er),Dt},Ze.prototype.bbox=function(){var Le=this._pbf;Le.pos=this._geometry;for(var Tt=Le.readVarint()+Le.pos,Fe=1,dt=0,nr=0,dr=0,Dt=Infinity,Er=-Infinity,wt=Infinity,fr=-Infinity;Le.pos<Tt;){if(dt<=0){var Et=Le.readVarint();Fe=Et&7,dt=Et>>3}if(dt--,Fe===1||Fe===2)nr+=Le.readSVarint(),dr+=Le.readSVarint(),nr<Dt&&(Dt=nr),nr>Er&&(Er=nr),dr<wt&&(wt=dr),dr>fr&&(fr=dr);else if(Fe!==7)throw new Error("unknown command "+Fe)}return[Dt,wt,Er,fr]},Ze.prototype.toGeoJSON=function(Le,Tt,Fe){var dt=this.extent*Math.pow(2,Fe),nr=this.extent*Le,dr=this.extent*Tt,Dt=this.loadGeometry(),Er=Ze.types[this.type],wt,fr;function Et(mt){for(var k=0;k<mt.length;k++){var Te=mt[k],Se=180-(Te.y+dr)*360/dt;mt[k]=[(Te.x+nr)*360/dt-180,360/Math.PI*Math.atan(Math.exp(Se*Math.PI/180))-90]}}switch(this.type){case 1:var vr=[];for(wt=0;wt<Dt.length;wt++)vr[wt]=Dt[wt][0];Dt=vr,Et(Dt);break;case 2:for(wt=0;wt<Dt.length;wt++)Et(Dt[wt]);break;case 3:for(Dt=ge(Dt),wt=0;wt<Dt.length;wt++)for(fr=0;fr<Dt[wt].length;fr++)Et(Dt[wt][fr]);break}Dt.length===1?Dt=Dt[0]:Er="Multi"+Er;var kt={type:"Feature",geometry:{type:Er,coordinates:Dt},properties:this.properties};return"id"in this&&(kt.id=this.id),kt};function ge(Le){var Tt=Le.length;if(Tt<=1)return[Le];for(var Fe=[],dt,nr,dr=0;dr<Tt;dr++){var Dt=Mt(Le[dr]);Dt!==0&&(nr===void 0&&(nr=Dt<0),nr===Dt<0?(dt&&Fe.push(dt),dt=[Le[dr]]):dt.push(Le[dr]))}return dt&&Fe.push(dt),Fe}function Mt(Le){for(var Tt=0,Fe=0,dt=Le.length,nr=dt-1,dr,Dt;Fe<dt;nr=Fe++)dr=Le[Fe],Dt=Le[nr],Tt+=(Dt.x-dr.x)*(dr.y+Dt.y);return Tt}},59701:function(ci,mn,ot){"use strict";var vt=ot(66024);ci.exports=Ze;function Ze(ge,Mt){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=ge,this._keys=[],this._values=[],this._features=[],ge.readFields(l,this,Mt),this.length=this._features.length}function l(ge,Mt,Le){ge===15?Mt.version=Le.readVarint():ge===1?Mt.name=Le.readString():ge===5?Mt.extent=Le.readVarint():ge===2?Mt._features.push(Le.pos):ge===3?Mt._keys.push(Le.readString()):ge===4&&Mt._values.push(Vt(Le))}function Vt(ge){for(var Mt=null,Le=ge.readVarint()+ge.pos;ge.pos<Le;){var Tt=ge.readVarint()>>3;Mt=Tt===1?ge.readString():Tt===2?ge.readFloat():Tt===3?ge.readDouble():Tt===4?ge.readVarint64():Tt===5?ge.readVarint():Tt===6?ge.readSVarint():Tt===7?ge.readBoolean():null}return Mt}Ze.prototype.feature=function(ge){if(ge<0||ge>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[ge];var Mt=this._pbf.readVarint()+this._pbf.pos;return new vt(this._pbf,Mt,this.extent,this._keys,this._values)}},38159:function(ci,mn,ot){"use strict";ot.d(mn,{Z:function(){return Ze}});var vt=ot(40271);function Ze(l,Vt){Vt===void 0&&(Vt={});var ge=Number(l[0]),Mt=Number(l[1]),Le=Number(l[2]),Tt=Number(l[3]);if(l.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var Fe=[ge,Mt],dt=[ge,Tt],nr=[Le,Tt],dr=[Le,Mt];return(0,vt.yu)([[Fe,dr,nr,dt,Fe]],Vt.properties,{bbox:l,id:Vt.id})}},41672:function(ci,mn,ot){"use strict";var vt=ot(92322);function Ze(l){var Vt=[Infinity,Infinity,-Infinity,-Infinity];return(0,vt.pZ)(l,function(ge){Vt[0]>ge[0]&&(Vt[0]=ge[0]),Vt[1]>ge[1]&&(Vt[1]=ge[1]),Vt[2]<ge[0]&&(Vt[2]=ge[0]),Vt[3]<ge[1]&&(Vt[3]=ge[1])}),Vt}Ze.default=Ze,mn.Z=Ze},40271:function(ci,mn,ot){"use strict";ot.d(mn,{zL:function(){return ge},yu:function(){return Fe},Tu:function(){return nr},uf:function(){return Dt},_R:function(){return Er},tw:function(){return fr},DL:function(){return kt},Ht:function(){return me}});var vt=63710088e-1,Ze={centimeters:vt*100,centimetres:vt*100,degrees:vt/111325,feet:vt*3.28084,inches:vt*39.37,kilometers:vt/1e3,kilometres:vt/1e3,meters:vt,metres:vt,miles:vt/1609.344,millimeters:vt*1e3,millimetres:vt*1e3,nauticalmiles:vt/1852,radians:1,yards:vt*1.0936},l={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/vt,yards:1.0936133},Vt={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function ge(P,U,B){B===void 0&&(B={});var E={type:"Feature"};return(B.id===0||B.id)&&(E.id=B.id),B.bbox&&(E.bbox=B.bbox),E.properties=U||{},E.geometry=P,E}function Mt(P,U,B){switch(B===void 0&&(B={}),P){case"Point":return Le(U).geometry;case"LineString":return nr(U).geometry;case"Polygon":return Fe(U).geometry;case"MultiPoint":return wt(U).geometry;case"MultiLineString":return Er(U).geometry;case"MultiPolygon":return fr(U).geometry;default:throw new Error(P+" is invalid")}}function Le(P,U,B){if(B===void 0&&(B={}),!P)throw new Error("coordinates is required");if(!Array.isArray(P))throw new Error("coordinates must be an Array");if(P.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ze(P[0])||!ze(P[1]))throw new Error("coordinates must contain numbers");var E={type:"Point",coordinates:P};return ge(E,U,B)}function Tt(P,U,B){return B===void 0&&(B={}),Dt(P.map(function(E){return Le(E,U)}),B)}function Fe(P,U,B){B===void 0&&(B={});for(var E=0,D=P;E<D.length;E++){var q=D[E];if(q.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var Q=0;Q<q[q.length-1].length;Q++)if(q[q.length-1][Q]!==q[0][Q])throw new Error("First and last Position are not equivalent.")}var Ae={type:"Polygon",coordinates:P};return ge(Ae,U,B)}function dt(P,U,B){return B===void 0&&(B={}),Dt(P.map(function(E){return Fe(E,U)}),B)}function nr(P,U,B){if(B===void 0&&(B={}),P.length<2)throw new Error("coordinates must be an array of two or more positions");var E={type:"LineString",coordinates:P};return ge(E,U,B)}function dr(P,U,B){return B===void 0&&(B={}),Dt(P.map(function(E){return nr(E,U)}),B)}function Dt(P,U){U===void 0&&(U={});var B={type:"FeatureCollection"};return U.id&&(B.id=U.id),U.bbox&&(B.bbox=U.bbox),B.features=P,B}function Er(P,U,B){B===void 0&&(B={});var E={type:"MultiLineString",coordinates:P};return ge(E,U,B)}function wt(P,U,B){B===void 0&&(B={});var E={type:"MultiPoint",coordinates:P};return ge(E,U,B)}function fr(P,U,B){B===void 0&&(B={});var E={type:"MultiPolygon",coordinates:P};return ge(E,U,B)}function Et(P,U,B){B===void 0&&(B={});var E={type:"GeometryCollection",geometries:P};return ge(E,U,B)}function vr(P,U){if(U===void 0&&(U=0),U&&!(U>=0))throw new Error("precision must be a positive number");var B=Math.pow(10,U||0);return Math.round(P*B)/B}function kt(P,U){U===void 0&&(U="kilometers");var B=Ze[U];if(!B)throw new Error(U+" units is invalid");return P*B}function mt(P,U){U===void 0&&(U="kilometers");var B=Ze[U];if(!B)throw new Error(U+" units is invalid");return P/B}function k(P,U){return Se(mt(P,U))}function Te(P){var U=P%360;return U<0&&(U+=360),U}function Se(P){var U=P%(2*Math.PI);return U*180/Math.PI}function me(P){var U=P%360;return U*Math.PI/180}function De(P,U,B){if(U===void 0&&(U="kilometers"),B===void 0&&(B="kilometers"),!(P>=0))throw new Error("length must be a positive number");return kt(mt(P,U),B)}function we(P,U,B){if(U===void 0&&(U="meters"),B===void 0&&(B="kilometers"),!(P>=0))throw new Error("area must be a positive number");var E=Vt[U];if(!E)throw new Error("invalid original units");var D=Vt[B];if(!D)throw new Error("invalid final units");return P/E*D}function ze(P){return!isNaN(P)&&P!==null&&!Array.isArray(P)}function Qt(P){return!!P&&P.constructor===Object}function V(P){if(!P)throw new Error("bbox is required");if(!Array.isArray(P))throw new Error("bbox must be an Array");if(P.length!==4&&P.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");P.forEach(function(U){if(!ze(U))throw new Error("bbox must only contain numbers")})}function pe(P){if(!P)throw new Error("id is required");if(["string","number"].indexOf(typeof P)===-1)throw new Error("id must be a number or a string")}},83996:function(ci,mn,ot){"use strict";ot.d(mn,{r7:function(){return l},wA:function(){return Tt}});var vt=ot(40271);function Ze(dt){if(!dt)throw new Error("coord is required");if(!Array.isArray(dt)){if(dt.type==="Feature"&&dt.geometry!==null&&dt.geometry.type==="Point")return dt.geometry.coordinates;if(dt.type==="Point")return dt.coordinates}if(Array.isArray(dt)&&dt.length>=2&&!Array.isArray(dt[0])&&!Array.isArray(dt[1]))return dt;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function l(dt){if(Array.isArray(dt))return dt;if(dt.type==="Feature"){if(dt.geometry!==null)return dt.geometry.coordinates}else if(dt.coordinates)return dt.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Vt(dt){if(dt.length>1&&isNumber(dt[0])&&isNumber(dt[1]))return!0;if(Array.isArray(dt[0])&&dt[0].length)return Vt(dt[0]);throw new Error("coordinates must only contain numbers")}function ge(dt,nr,dr){if(!nr||!dr)throw new Error("type and name required");if(!dt||dt.type!==nr)throw new Error("Invalid input to "+dr+": must be a "+nr+", given "+dt.type)}function Mt(dt,nr,dr){if(!dt)throw new Error("No feature passed");if(!dr)throw new Error(".featureOf() requires a name");if(!dt||dt.type!=="Feature"||!dt.geometry)throw new Error("Invalid input to "+dr+", Feature with geometry required");if(!dt.geometry||dt.geometry.type!==nr)throw new Error("Invalid input to "+dr+": must be a "+nr+", given "+dt.geometry.type)}function Le(dt,nr,dr){if(!dt)throw new Error("No featureCollection passed");if(!dr)throw new Error(".collectionOf() requires a name");if(!dt||dt.type!=="FeatureCollection")throw new Error("Invalid input to "+dr+", FeatureCollection required");for(var Dt=0,Er=dt.features;Dt<Er.length;Dt++){var wt=Er[Dt];if(!wt||wt.type!=="Feature"||!wt.geometry)throw new Error("Invalid input to "+dr+", Feature with geometry required");if(!wt.geometry||wt.geometry.type!==nr)throw new Error("Invalid input to "+dr+": must be a "+nr+", given "+wt.geometry.type)}}function Tt(dt){return dt.type==="Feature"?dt.geometry:dt}function Fe(dt,nr){return dt.type==="FeatureCollection"?"FeatureCollection":dt.type==="GeometryCollection"?"GeometryCollection":dt.type==="Feature"&&dt.geometry!==null?dt.geometry.type:dt.type}},92322:function(ci,mn,ot){"use strict";ot.d(mn,{pZ:function(){return Ze},nG:function(){return nr}});var vt=ot(40271);function Ze(kt,mt,k){if(kt!==null)for(var Te,Se,me,De,we,ze,Qt,V=0,pe=0,P,U=kt.type,B=U==="FeatureCollection",E=U==="Feature",D=B?kt.features.length:1,q=0;q<D;q++){Qt=B?kt.features[q].geometry:E?kt.geometry:kt,P=Qt?Qt.type==="GeometryCollection":!1,we=P?Qt.geometries.length:1;for(var Q=0;Q<we;Q++){var Ae=0,ct=0;if(De=P?Qt.geometries[Q]:Qt,De!==null){ze=De.coordinates;var ke=De.type;switch(V=k&&(ke==="Polygon"||ke==="MultiPolygon")?1:0,ke){case null:break;case"Point":if(mt(ze,pe,q,Ae,ct)===!1)return!1;pe++,Ae++;break;case"LineString":case"MultiPoint":for(Te=0;Te<ze.length;Te++){if(mt(ze[Te],pe,q,Ae,ct)===!1)return!1;pe++,ke==="MultiPoint"&&Ae++}ke==="LineString"&&Ae++;break;case"Polygon":case"MultiLineString":for(Te=0;Te<ze.length;Te++){for(Se=0;Se<ze[Te].length-V;Se++){if(mt(ze[Te][Se],pe,q,Ae,ct)===!1)return!1;pe++}ke==="MultiLineString"&&Ae++,ke==="Polygon"&&ct++}ke==="Polygon"&&Ae++;break;case"MultiPolygon":for(Te=0;Te<ze.length;Te++){for(ct=0,Se=0;Se<ze[Te].length;Se++){for(me=0;me<ze[Te][Se].length-V;me++){if(mt(ze[Te][Se][me],pe,q,Ae,ct)===!1)return!1;pe++}ct++}Ae++}break;case"GeometryCollection":for(Te=0;Te<De.geometries.length;Te++)if(Ze(De.geometries[Te],mt,k)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function l(kt,mt,k,Te){var Se=k;return Ze(kt,function(me,De,we,ze,Qt){De===0&&k===void 0?Se=me:Se=mt(Se,me,De,we,ze,Qt)},Te),Se}function Vt(kt,mt){var k;switch(kt.type){case"FeatureCollection":for(k=0;k<kt.features.length&&mt(kt.features[k].properties,k)!==!1;k++);break;case"Feature":mt(kt.properties,0);break}}function ge(kt,mt,k){var Te=k;return Vt(kt,function(Se,me){me===0&&k===void 0?Te=Se:Te=mt(Te,Se,me)}),Te}function Mt(kt,mt){if(kt.type==="Feature")mt(kt,0);else if(kt.type==="FeatureCollection")for(var k=0;k<kt.features.length&&mt(kt.features[k],k)!==!1;k++);}function Le(kt,mt,k){var Te=k;return Mt(kt,function(Se,me){me===0&&k===void 0?Te=Se:Te=mt(Te,Se,me)}),Te}function Tt(kt){var mt=[];return Ze(kt,function(k){mt.push(k)}),mt}function Fe(kt,mt){var k,Te,Se,me,De,we,ze,Qt,V,pe,P=0,U=kt.type==="FeatureCollection",B=kt.type==="Feature",E=U?kt.features.length:1;for(k=0;k<E;k++){for(we=U?kt.features[k].geometry:B?kt.geometry:kt,Qt=U?kt.features[k].properties:B?kt.properties:{},V=U?kt.features[k].bbox:B?kt.bbox:void 0,pe=U?kt.features[k].id:B?kt.id:void 0,ze=we?we.type==="GeometryCollection":!1,De=ze?we.geometries.length:1,Se=0;Se<De;Se++){if(me=ze?we.geometries[Se]:we,me===null){if(mt(null,P,Qt,V,pe)===!1)return!1;continue}switch(me.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(mt(me,P,Qt,V,pe)===!1)return!1;break}case"GeometryCollection":{for(Te=0;Te<me.geometries.length;Te++)if(mt(me.geometries[Te],P,Qt,V,pe)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}P++}}function dt(kt,mt,k){var Te=k;return Fe(kt,function(Se,me,De,we,ze){me===0&&k===void 0?Te=Se:Te=mt(Te,Se,me,De,we,ze)}),Te}function nr(kt,mt){Fe(kt,function(k,Te,Se,me,De){var we=k===null?null:k.type;switch(we){case null:case"Point":case"LineString":case"Polygon":return mt((0,vt.zL)(k,Se,{bbox:me,id:De}),Te,0)===!1?!1:void 0}var ze;switch(we){case"MultiPoint":ze="Point";break;case"MultiLineString":ze="LineString";break;case"MultiPolygon":ze="Polygon";break}for(var Qt=0;Qt<k.coordinates.length;Qt++){var V=k.coordinates[Qt],pe={type:ze,coordinates:V};if(mt((0,vt.zL)(pe,Se),Te,Qt)===!1)return!1}})}function dr(kt,mt,k){var Te=k;return nr(kt,function(Se,me,De){me===0&&De===0&&k===void 0?Te=Se:Te=mt(Te,Se,me,De)}),Te}function Dt(kt,mt){nr(kt,function(k,Te,Se){var me=0;if(!!k.geometry){var De=k.geometry.type;if(!(De==="Point"||De==="MultiPoint")){var we,ze=0,Qt=0,V=0;if(Ze(k,function(pe,P,U,B,E){if(we===void 0||Te>ze||B>Qt||E>V){we=pe,ze=Te,Qt=B,V=E,me=0;return}var D=lineString([we,pe],k.properties);if(mt(D,Te,Se,E,me)===!1)return!1;me++,we=pe})===!1)return!1}}})}function Er(kt,mt,k){var Te=k,Se=!1;return Dt(kt,function(me,De,we,ze,Qt){Se===!1&&k===void 0?Te=me:Te=mt(Te,me,De,we,ze,Qt),Se=!0}),Te}function wt(kt,mt){if(!kt)throw new Error("geojson is required");nr(kt,function(k,Te,Se){if(k.geometry!==null){var me=k.geometry.type,De=k.geometry.coordinates;switch(me){case"LineString":if(mt(k,Te,Se,0,0)===!1)return!1;break;case"Polygon":for(var we=0;we<De.length;we++)if(mt(lineString(De[we],k.properties),Te,Se,we)===!1)return!1;break}}})}function fr(kt,mt,k){var Te=k;return wt(kt,function(Se,me,De,we){me===0&&k===void 0?Te=Se:Te=mt(Te,Se,me,De,we)}),Te}function Et(kt,mt){if(mt=mt||{},!isObject(mt))throw new Error("options is invalid");var k=mt.featureIndex||0,Te=mt.multiFeatureIndex||0,Se=mt.geometryIndex||0,me=mt.segmentIndex||0,De=mt.properties,we;switch(kt.type){case"FeatureCollection":k<0&&(k=kt.features.length+k),De=De||kt.features[k].properties,we=kt.features[k].geometry;break;case"Feature":De=De||kt.properties,we=kt.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":we=kt;break;default:throw new Error("geojson is invalid")}if(we===null)return null;var ze=we.coordinates;switch(we.type){case"Point":case"MultiPoint":return null;case"LineString":return me<0&&(me=ze.length+me-1),lineString([ze[me],ze[me+1]],De,mt);case"Polygon":return Se<0&&(Se=ze.length+Se),me<0&&(me=ze[Se].length+me-1),lineString([ze[Se][me],ze[Se][me+1]],De,mt);case"MultiLineString":return Te<0&&(Te=ze.length+Te),me<0&&(me=ze[Te].length+me-1),lineString([ze[Te][me],ze[Te][me+1]],De,mt);case"MultiPolygon":return Te<0&&(Te=ze.length+Te),Se<0&&(Se=ze[Te].length+Se),me<0&&(me=ze[Te][Se].length-me-1),lineString([ze[Te][Se][me],ze[Te][Se][me+1]],De,mt)}throw new Error("geojson is invalid")}function vr(kt,mt){if(mt=mt||{},!isObject(mt))throw new Error("options is invalid");var k=mt.featureIndex||0,Te=mt.multiFeatureIndex||0,Se=mt.geometryIndex||0,me=mt.coordIndex||0,De=mt.properties,we;switch(kt.type){case"FeatureCollection":k<0&&(k=kt.features.length+k),De=De||kt.features[k].properties,we=kt.features[k].geometry;break;case"Feature":De=De||kt.properties,we=kt.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":we=kt;break;default:throw new Error("geojson is invalid")}if(we===null)return null;var ze=we.coordinates;switch(we.type){case"Point":return point(ze,De,mt);case"MultiPoint":return Te<0&&(Te=ze.length+Te),point(ze[Te],De,mt);case"LineString":return me<0&&(me=ze.length+me),point(ze[me],De,mt);case"Polygon":return Se<0&&(Se=ze.length+Se),me<0&&(me=ze[Se].length+me),point(ze[Se][me],De,mt);case"MultiLineString":return Te<0&&(Te=ze.length+Te),me<0&&(me=ze[Te].length+me),point(ze[Te][me],De,mt);case"MultiPolygon":return Te<0&&(Te=ze.length+Te),Se<0&&(Se=ze[Te].length+Se),me<0&&(me=ze[Te][Se].length-me),point(ze[Te][Se][me],De,mt)}throw new Error("geojson is invalid")}},95335:function(ci,mn,ot){"use strict";var vt=ot(32676),Ze=ot(83996),l=ot(40271);function Vt(ge,Mt,Le){Le===void 0&&(Le={});var Tt=(0,Ze.wA)(ge),Fe=(0,Ze.wA)(Mt),dt=vt.union(Tt.coordinates,Fe.coordinates);return dt.length===0?null:dt.length===1?(0,l.yu)(dt[0],Le.properties):(0,l.tw)(dt,Le.properties)}mn.Z=Vt},94587:function(ci,mn,ot){"use strict";ot.d(mn,{j2:function(){return vt},b4:function(){return Le},YF:function(){return Ze},We:function(){return Tt},VR:function(){return k},G9:function(){return fr},ly:function(){return Et},sd:function(){return wt}});function vt(Te,Se){return Te<Se?-1:Te>Se?1:Te>=Se?0:NaN}function Ze(Te){return Te.length===1&&(Te=l(Te)),{left:function(Se,me,De,we){for(De==null&&(De=0),we==null&&(we=Se.length);De<we;){var ze=De+we>>>1;Te(Se[ze],me)<0?De=ze+1:we=ze}return De},right:function(Se,me,De,we){for(De==null&&(De=0),we==null&&(we=Se.length);De<we;){var ze=De+we>>>1;Te(Se[ze],me)>0?we=ze:De=ze+1}return De}}}function l(Te){return function(Se,me){return vt(Te(Se),me)}}var Vt=Ze(vt),ge=Vt.right,Mt=Vt.left,Le=ge;function Tt(Te,Se){var me=Te.length,De=-1,we,ze,Qt;if(Se==null){for(;++De<me;)if((we=Te[De])!=null&&we>=we)for(ze=Qt=we;++De<me;)(we=Te[De])!=null&&(ze>we&&(ze=we),Qt<we&&(Qt=we))}else for(;++De<me;)if((we=Se(Te[De],De,Te))!=null&&we>=we)for(ze=Qt=we;++De<me;)(we=Se(Te[De],De,Te))!=null&&(ze>we&&(ze=we),Qt<we&&(Qt=we));return[ze,Qt]}var Fe=Array.prototype,dt=Fe.slice,nr=Fe.map,dr=Math.sqrt(50),Dt=Math.sqrt(10),Er=Math.sqrt(2);function wt(Te,Se,me){var De,we=-1,ze,Qt,V;if(Se=+Se,Te=+Te,me=+me,Te===Se&&me>0)return[Te];if((De=Se<Te)&&(ze=Te,Te=Se,Se=ze),(V=fr(Te,Se,me))===0||!isFinite(V))return[];if(V>0)for(Te=Math.ceil(Te/V),Se=Math.floor(Se/V),Qt=new Array(ze=Math.ceil(Se-Te+1));++we<ze;)Qt[we]=(Te+we)*V;else for(Te=Math.floor(Te*V),Se=Math.ceil(Se*V),Qt=new Array(ze=Math.ceil(Te-Se+1));++we<ze;)Qt[we]=(Te-we)/V;return De&&Qt.reverse(),Qt}function fr(Te,Se,me){var De=(Se-Te)/Math.max(0,me),we=Math.floor(Math.log(De)/Math.LN10),ze=De/Math.pow(10,we);return we>=0?(ze>=dr?10:ze>=Dt?5:ze>=Er?2:1)*Math.pow(10,we):-Math.pow(10,-we)/(ze>=dr?10:ze>=Dt?5:ze>=Er?2:1)}function Et(Te,Se,me){var De=Math.abs(Se-Te)/Math.max(0,me),we=Math.pow(10,Math.floor(Math.log(De)/Math.LN10)),ze=De/we;return ze>=dr?we*=10:ze>=Dt?we*=5:ze>=Er&&(we*=2),Se<Te?-we:we}function vr(){var Te=identity,Se=extent,me=sturges;function De(we){var ze,Qt=we.length,V,pe=new Array(Qt);for(ze=0;ze<Qt;++ze)pe[ze]=Te(we[ze],ze,we);var P=Se(pe),U=P[0],B=P[1],E=me(pe,U,B);Array.isArray(E)||(E=tickStep(U,B,E),E=range(Math.ceil(U/E)*E,B,E));for(var D=E.length;E[0]<=U;)E.shift(),--D;for(;E[D-1]>B;)E.pop(),--D;var q=new Array(D+1),Q;for(ze=0;ze<=D;++ze)Q=q[ze]=[],Q.x0=ze>0?E[ze-1]:U,Q.x1=ze<D?E[ze]:B;for(ze=0;ze<Qt;++ze)V=pe[ze],U<=V&&V<=B&&q[bisect(E,V,0,D)].push(we[ze]);return q}return De.value=function(we){return arguments.length?(Te=typeof we=="function"?we:constant(we),De):Te},De.domain=function(we){return arguments.length?(Se=typeof we=="function"?we:constant([we[0],we[1]]),De):Se},De.thresholds=function(we){return arguments.length?(me=typeof we=="function"?we:Array.isArray(we)?constant(slice.call(we)):constant(we),De):me},De}function kt(Te,Se,me){return Te=map.call(Te,number).sort(ascending),Math.ceil((me-Se)/(2*(quantile(Te,.75)-quantile(Te,.25))*Math.pow(Te.length,-1/3)))}function mt(Te){return Te===null?NaN:+Te}function k(Te,Se,me){if(me==null&&(me=mt),!!(De=Te.length)){if((Se=+Se)<=0||De<2)return+me(Te[0],0,Te);if(Se>=1)return+me(Te[De-1],De-1,Te);var De,we=(De-1)*Se,ze=Math.floor(we),Qt=+me(Te[ze],ze,Te),V=+me(Te[ze+1],ze+1,Te);return Qt+(V-Qt)*(we-ze)}}},2650:function(ci,mn,ot){"use strict";ot.d(mn,{ZP:function(){return mt},B8:function(){return me}});function vt(E,D,q){E.prototype=D.prototype=q,q.constructor=E}function Ze(E,D){var q=Object.create(E.prototype);for(var Q in D)q[Q]=D[Q];return q}function l(){}var Vt=.7,ge=1/Vt,Mt="\\s*([+-]?\\d+)\\s*",Le="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Tt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Fe=/^#([0-9a-f]{3,8})$/,dt=new RegExp("^rgb\\("+[Mt,Mt,Mt]+"\\)$"),nr=new RegExp("^rgb\\("+[Tt,Tt,Tt]+"\\)$"),dr=new RegExp("^rgba\\("+[Mt,Mt,Mt,Le]+"\\)$"),Dt=new RegExp("^rgba\\("+[Tt,Tt,Tt,Le]+"\\)$"),Er=new RegExp("^hsl\\("+[Le,Tt,Tt]+"\\)$"),wt=new RegExp("^hsla\\("+[Le,Tt,Tt,Le]+"\\)$"),fr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};vt(l,mt,{copy:function(E){return Object.assign(new this.constructor,this,E)},displayable:function(){return this.rgb().displayable()},hex:Et,formatHex:Et,formatHsl:vr,formatRgb:kt,toString:kt});function Et(){return this.rgb().formatHex()}function vr(){return pe(this).formatHsl()}function kt(){return this.rgb().formatRgb()}function mt(E){var D,q;return E=(E+"").trim().toLowerCase(),(D=Fe.exec(E))?(q=D[1].length,D=parseInt(D[1],16),q===6?k(D):q===3?new De(D>>8&15|D>>4&240,D>>4&15|D&240,(D&15)<<4|D&15,1):q===8?Te(D>>24&255,D>>16&255,D>>8&255,(D&255)/255):q===4?Te(D>>12&15|D>>8&240,D>>8&15|D>>4&240,D>>4&15|D&240,((D&15)<<4|D&15)/255):null):(D=dt.exec(E))?new De(D[1],D[2],D[3],1):(D=nr.exec(E))?new De(D[1]*255/100,D[2]*255/100,D[3]*255/100,1):(D=dr.exec(E))?Te(D[1],D[2],D[3],D[4]):(D=Dt.exec(E))?Te(D[1]*255/100,D[2]*255/100,D[3]*255/100,D[4]):(D=Er.exec(E))?V(D[1],D[2]/100,D[3]/100,1):(D=wt.exec(E))?V(D[1],D[2]/100,D[3]/100,D[4]):fr.hasOwnProperty(E)?k(fr[E]):E==="transparent"?new De(NaN,NaN,NaN,0):null}function k(E){return new De(E>>16&255,E>>8&255,E&255,1)}function Te(E,D,q,Q){return Q<=0&&(E=D=q=NaN),new De(E,D,q,Q)}function Se(E){return E instanceof l||(E=mt(E)),E?(E=E.rgb(),new De(E.r,E.g,E.b,E.opacity)):new De}function me(E,D,q,Q){return arguments.length===1?Se(E):new De(E,D,q,Q==null?1:Q)}function De(E,D,q,Q){this.r=+E,this.g=+D,this.b=+q,this.opacity=+Q}vt(De,me,Ze(l,{brighter:function(E){return E=E==null?ge:Math.pow(ge,E),new De(this.r*E,this.g*E,this.b*E,this.opacity)},darker:function(E){return E=E==null?Vt:Math.pow(Vt,E),new De(this.r*E,this.g*E,this.b*E,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:we,formatHex:we,formatRgb:ze,toString:ze}));function we(){return"#"+Qt(this.r)+Qt(this.g)+Qt(this.b)}function ze(){var E=this.opacity;return E=isNaN(E)?1:Math.max(0,Math.min(1,E)),(E===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(E===1?")":", "+E+")")}function Qt(E){return E=Math.max(0,Math.min(255,Math.round(E)||0)),(E<16?"0":"")+E.toString(16)}function V(E,D,q,Q){return Q<=0?E=D=q=NaN:q<=0||q>=1?E=D=NaN:D<=0&&(E=NaN),new U(E,D,q,Q)}function pe(E){if(E instanceof U)return new U(E.h,E.s,E.l,E.opacity);if(E instanceof l||(E=mt(E)),!E)return new U;if(E instanceof U)return E;E=E.rgb();var D=E.r/255,q=E.g/255,Q=E.b/255,Ae=Math.min(D,q,Q),ct=Math.max(D,q,Q),ke=NaN,He=ct-Ae,We=(ct+Ae)/2;return He?(D===ct?ke=(q-Q)/He+(q<Q)*6:q===ct?ke=(Q-D)/He+2:ke=(D-q)/He+4,He/=We<.5?ct+Ae:2-ct-Ae,ke*=60):He=We>0&&We<1?0:ke,new U(ke,He,We,E.opacity)}function P(E,D,q,Q){return arguments.length===1?pe(E):new U(E,D,q,Q==null?1:Q)}function U(E,D,q,Q){this.h=+E,this.s=+D,this.l=+q,this.opacity=+Q}vt(U,P,Ze(l,{brighter:function(E){return E=E==null?ge:Math.pow(ge,E),new U(this.h,this.s,this.l*E,this.opacity)},darker:function(E){return E=E==null?Vt:Math.pow(Vt,E),new U(this.h,this.s,this.l*E,this.opacity)},rgb:function(){var E=this.h%360+(this.h<0)*360,D=isNaN(E)||isNaN(this.s)?0:this.s,q=this.l,Q=q+(q<.5?q:1-q)*D,Ae=2*q-Q;return new De(B(E>=240?E-240:E+120,Ae,Q),B(E,Ae,Q),B(E<120?E+240:E-120,Ae,Q),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var E=this.opacity;return E=isNaN(E)?1:Math.max(0,Math.min(1,E)),(E===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(E===1?")":", "+E+")")}}));function B(E,D,q){return(E<60?D+(q-D)*E/60:E<180?q:E<240?D+(q-D)*(240-E)/60:D)*255}},18904:function(ci,mn,ot){"use strict";ot.d(mn,{ue:function(){return Er}});var vt={},Ze={},l=34,Vt=10,ge=13;function Mt(k){return new Function("d","return {"+k.map(function(Te,Se){return JSON.stringify(Te)+": d["+Se+'] || ""'}).join(",")+"}")}function Le(k,Te){var Se=Mt(k);return function(me,De){return Te(Se(me),De,k)}}function Tt(k){var Te=Object.create(null),Se=[];return k.forEach(function(me){for(var De in me)De in Te||Se.push(Te[De]=De)}),Se}function Fe(k,Te){var Se=k+"",me=Se.length;return me<Te?new Array(Te-me+1).join(0)+Se:Se}function dt(k){return k<0?"-"+Fe(-k,6):k>9999?"+"+Fe(k,6):Fe(k,4)}function nr(k){var Te=k.getUTCHours(),Se=k.getUTCMinutes(),me=k.getUTCSeconds(),De=k.getUTCMilliseconds();return isNaN(k)?"Invalid Date":dt(k.getUTCFullYear(),4)+"-"+Fe(k.getUTCMonth()+1,2)+"-"+Fe(k.getUTCDate(),2)+(De?"T"+Fe(Te,2)+":"+Fe(Se,2)+":"+Fe(me,2)+"."+Fe(De,3)+"Z":me?"T"+Fe(Te,2)+":"+Fe(Se,2)+":"+Fe(me,2)+"Z":Se||Te?"T"+Fe(Te,2)+":"+Fe(Se,2)+"Z":"")}function dr(k){var Te=new RegExp('["'+k+`
\r]`),Se=k.charCodeAt(0);function me(U,B){var E,D,q=De(U,function(Q,Ae){if(E)return E(Q,Ae-1);D=Q,E=B?Le(Q,B):Mt(Q)});return q.columns=D||[],q}function De(U,B){var E=[],D=U.length,q=0,Q=0,Ae,ct=D<=0,ke=!1;U.charCodeAt(D-1)===Vt&&--D,U.charCodeAt(D-1)===ge&&--D;function He(){if(ct)return Ze;if(ke)return ke=!1,vt;var xt,jt=q,Gt;if(U.charCodeAt(jt)===l){for(;q++<D&&U.charCodeAt(q)!==l||U.charCodeAt(++q)===l;);return(xt=q)>=D?ct=!0:(Gt=U.charCodeAt(q++))===Vt?ke=!0:Gt===ge&&(ke=!0,U.charCodeAt(q)===Vt&&++q),U.slice(jt+1,xt-1).replace(/""/g,'"')}for(;q<D;){if((Gt=U.charCodeAt(xt=q++))===Vt)ke=!0;else if(Gt===ge)ke=!0,U.charCodeAt(q)===Vt&&++q;else if(Gt!==Se)continue;return U.slice(jt,xt)}return ct=!0,U.slice(jt,D)}for(;(Ae=He())!==Ze;){for(var We=[];Ae!==vt&&Ae!==Ze;)We.push(Ae),Ae=He();B&&(We=B(We,Q++))==null||E.push(We)}return E}function we(U,B){return U.map(function(E){return B.map(function(D){return P(E[D])}).join(k)})}function ze(U,B){return B==null&&(B=Tt(U)),[B.map(P).join(k)].concat(we(U,B)).join(`
`)}function Qt(U,B){return B==null&&(B=Tt(U)),we(U,B).join(`
`)}function V(U){return U.map(pe).join(`
`)}function pe(U){return U.map(P).join(k)}function P(U){return U==null?"":U instanceof Date?nr(U):Te.test(U+="")?'"'+U.replace(/"/g,'""')+'"':U}return{parse:me,parseRows:De,format:ze,formatBody:Qt,formatRows:V,formatRow:pe,formatValue:P}}var Dt=dr(","),Er=Dt.parse,wt=Dt.parseRows,fr=Dt.format,Et=Dt.formatBody,vr=Dt.formatRows,kt=Dt.formatRow,mt=Dt.formatValue},43774:function(ci,mn,ot){"use strict";ot.d(mn,{g:function(){return ge}});var vt=Math.PI/3,Ze=[0,vt,2*vt,3*vt,4*vt,5*vt];function l(Mt){return Mt[0]}function Vt(Mt){return Mt[1]}function ge(){var Mt=0,Le=0,Tt=1,Fe=1,dt=l,nr=Vt,dr,Dt,Er;function wt(Et){var vr={},kt=[],mt,k=Et.length;for(mt=0;mt<k;++mt)if(!(isNaN(Se=+dt.call(null,Te=Et[mt],mt,Et))||isNaN(me=+nr.call(null,Te,mt,Et)))){var Te,Se,me,De=Math.round(me=me/Er),we=Math.round(Se=Se/Dt-(De&1)/2),ze=me-De;if(Math.abs(ze)*3>1){var Qt=Se-we,V=we+(Se<we?-1:1)/2,pe=De+(me<De?-1:1),P=Se-V,U=me-pe;Qt*Qt+ze*ze>P*P+U*U&&(we=V+(De&1?1:-1)/2,De=pe)}var B=we+"-"+De,E=vr[B];E?E.push(Te):(kt.push(E=vr[B]=[Te]),E.x=(we+(De&1)/2)*Dt,E.y=De*Er)}return kt}function fr(Et){var vr=0,kt=0;return Ze.map(function(mt){var k=Math.sin(mt)*Et,Te=-Math.cos(mt)*Et,Se=k-vr,me=Te-kt;return vr=k,kt=Te,[Se,me]})}return wt.hexagon=function(Et){return"m"+fr(Et==null?dr:+Et).join("l")+"z"},wt.centers=function(){for(var Et=[],vr=Math.round(Le/Er),kt=Math.round(Mt/Dt),mt=vr*Er;mt<Fe+dr;mt+=Er,++vr)for(var k=kt*Dt+(vr&1)*Dt/2;k<Tt+Dt/2;k+=Dt)Et.push([k,mt]);return Et},wt.mesh=function(){var Et=fr(dr).slice(0,4).join("l");return wt.centers().map(function(vr){return"M"+vr+"m"+Et}).join("")},wt.x=function(Et){return arguments.length?(dt=Et,wt):dt},wt.y=function(Et){return arguments.length?(nr=Et,wt):nr},wt.radius=function(Et){return arguments.length?(dr=+Et,Dt=dr*2*Math.sin(vt),Er=dr*1.5,wt):dr},wt.size=function(Et){return arguments.length?(Mt=Le=0,Tt=+Et[0],Fe=+Et[1],wt):[Tt-Mt,Fe-Le]},wt.extent=function(Et){return arguments.length?(Mt=+Et[0][0],Le=+Et[0][1],Tt=+Et[1][0],Fe=+Et[1][1],wt):[[Mt,Le],[Tt,Fe]]},wt.radius(1)}},55302:function(ci,mn,ot){"use strict";ot.d(mn,{Z:function(){return vt}});function vt(Ze){return function(){return Ze}}},87765:function(ci,mn,ot){"use strict";ot.d(mn,{ZP:function(){return nr},hD:function(){return Dt}});var vt=ot(2650);function Ze(wt,fr,Et,vr,kt){var mt=wt*wt,k=mt*wt;return((1-3*wt+3*mt-k)*fr+(4-6*mt+3*k)*Et+(1+3*wt+3*mt-3*k)*vr+k*kt)/6}function l(wt){var fr=wt.length-1;return function(Et){var vr=Et<=0?Et=0:Et>=1?(Et=1,fr-1):Math.floor(Et*fr),kt=wt[vr],mt=wt[vr+1],k=vr>0?wt[vr-1]:2*kt-mt,Te=vr<fr-1?wt[vr+2]:2*mt-kt;return Ze((Et-vr/fr)*fr,k,kt,mt,Te)}}function Vt(wt){var fr=wt.length;return function(Et){var vr=Math.floor(((Et%=1)<0?++Et:Et)*fr),kt=wt[(vr+fr-1)%fr],mt=wt[vr%fr],k=wt[(vr+1)%fr],Te=wt[(vr+2)%fr];return Ze((Et-vr/fr)*fr,kt,mt,k,Te)}}var ge=ot(55302);function Mt(wt,fr){return function(Et){return wt+Et*fr}}function Le(wt,fr,Et){return wt=Math.pow(wt,Et),fr=Math.pow(fr,Et)-wt,Et=1/Et,function(vr){return Math.pow(wt+vr*fr,Et)}}function Tt(wt,fr){var Et=fr-wt;return Et?Mt(wt,Et>180||Et<-180?Et-360*Math.round(Et/360):Et):constant(isNaN(wt)?fr:wt)}function Fe(wt){return(wt=+wt)==1?dt:function(fr,Et){return Et-fr?Le(fr,Et,wt):(0,ge.Z)(isNaN(fr)?Et:fr)}}function dt(wt,fr){var Et=fr-wt;return Et?Mt(wt,Et):(0,ge.Z)(isNaN(wt)?fr:wt)}var nr=function wt(fr){var Et=Fe(fr);function vr(kt,mt){var k=Et((kt=(0,vt.B8)(kt)).r,(mt=(0,vt.B8)(mt)).r),Te=Et(kt.g,mt.g),Se=Et(kt.b,mt.b),me=dt(kt.opacity,mt.opacity);return function(De){return kt.r=k(De),kt.g=Te(De),kt.b=Se(De),kt.opacity=me(De),kt+""}}return vr.gamma=wt,vr}(1);function dr(wt){return function(fr){var Et=fr.length,vr=new Array(Et),kt=new Array(Et),mt=new Array(Et),k,Te;for(k=0;k<Et;++k)Te=(0,vt.B8)(fr[k]),vr[k]=Te.r||0,kt[k]=Te.g||0,mt[k]=Te.b||0;return vr=wt(vr),kt=wt(kt),mt=wt(mt),Te.opacity=1,function(Se){return Te.r=vr(Se),Te.g=kt(Se),Te.b=mt(Se),Te+""}}}var Dt=dr(l),Er=dr(Vt)},16050:function(ci,mn,ot){"use strict";ot.d(mn,{AB:function(){return fs},ez:function(){return N},BY:function(){return L},p2:function(){return Nt},PK:function(){return k},vY:function(){return $r},FT:function(){return Oi},aE:function(){return Qn},cJ:function(){return Gu},ut:function(){return fi},Xf:function(){return Oo}});var vt=ot(94587),Ze="$";function l(){}l.prototype=Vt.prototype={constructor:l,has:function(g){return Ze+g in this},get:function(g){return this[Ze+g]},set:function(g,I){return this[Ze+g]=I,this},remove:function(g){var I=Ze+g;return I in this&&delete this[I]},clear:function(){for(var g in this)g[0]===Ze&&delete this[g]},keys:function(){var g=[];for(var I in this)I[0]===Ze&&g.push(I.slice(1));return g},values:function(){var g=[];for(var I in this)I[0]===Ze&&g.push(this[I]);return g},entries:function(){var g=[];for(var I in this)I[0]===Ze&&g.push({key:I.slice(1),value:this[I]});return g},size:function(){var g=0;for(var I in this)I[0]===Ze&&++g;return g},empty:function(){for(var g in this)if(g[0]===Ze)return!1;return!0},each:function(g){for(var I in this)I[0]===Ze&&g(this[I],I.slice(1),this)}};function Vt(g,I){var $=new l;if(g instanceof l)g.each(function(Xt,sr){$.set(sr,Xt)});else if(Array.isArray(g)){var le=-1,st=g.length,tt;if(I==null)for(;++le<st;)$.set(le,g[le]);else for(;++le<st;)$.set(I(tt=g[le],le,g),tt)}else if(g)for(var _t in g)$.set(_t,g[_t]);return $}var ge=Vt;function Mt(){var g=[],I=[],$,le,st;function tt(Xt,sr,Jr,Tn){if(sr>=g.length)return $!=null&&Xt.sort($),le!=null?le(Xt):Xt;for(var tr=-1,or=Xt.length,jn=g[sr++],Ci,Ni,xi=map(),Ta,to=Jr();++tr<or;)(Ta=xi.get(Ci=jn(Ni=Xt[tr])+""))?Ta.push(Ni):xi.set(Ci,[Ni]);return xi.each(function(La,ti){Tn(to,ti,tt(La,sr,Jr,Tn))}),to}function _t(Xt,sr){if(++sr>g.length)return Xt;var Jr,Tn=I[sr-1];return le!=null&&sr>=g.length?Jr=Xt.entries():(Jr=[],Xt.each(function(tr,or){Jr.push({key:or,values:_t(tr,sr)})})),Tn!=null?Jr.sort(function(tr,or){return Tn(tr.key,or.key)}):Jr}return st={object:function(Xt){return tt(Xt,0,Le,Tt)},map:function(Xt){return tt(Xt,0,Fe,dt)},entries:function(Xt){return _t(tt(Xt,0,Fe,dt),0)},key:function(Xt){return g.push(Xt),st},sortKeys:function(Xt){return I[g.length-1]=Xt,st},sortValues:function(Xt){return $=Xt,st},rollup:function(Xt){return le=Xt,st}}}function Le(){return{}}function Tt(g,I,$){g[I]=$}function Fe(){return map()}function dt(g,I,$){g.set(I,$)}function nr(){}var dr=ge.prototype;nr.prototype=Dt.prototype={constructor:nr,has:dr.has,add:function(g){return g+="",this[Ze+g]=g,this},remove:dr.remove,clear:dr.clear,values:dr.keys,size:dr.size,empty:dr.empty,each:dr.each};function Dt(g,I){var $=new nr;if(g instanceof nr)g.each(function(tt){$.add(tt)});else if(g){var le=-1,st=g.length;if(I==null)for(;++le<st;)$.add(g[le]);else for(;++le<st;)$.add(I(g[le],le,g))}return $}var Er=null,wt=Array.prototype,fr=wt.map,Et=wt.slice;function vr(g,I){switch(arguments.length){case 0:break;case 1:this.range(g);break;default:this.range(I).domain(g);break}return this}function kt(g,I){switch(arguments.length){case 0:break;case 1:this.interpolator(g);break;default:this.interpolator(I).domain(g);break}return this}var mt={name:"implicit"};function k(){var g=ge(),I=[],$=[],le=mt;function st(tt){var _t=tt+"",Xt=g.get(_t);if(!Xt){if(le!==mt)return le;g.set(_t,Xt=I.push(tt))}return $[(Xt-1)%$.length]}return st.domain=function(tt){if(!arguments.length)return I.slice();I=[],g=ge();for(var _t=-1,Xt=tt.length,sr,Jr;++_t<Xt;)g.has(Jr=(sr=tt[_t])+"")||g.set(Jr,I.push(sr));return st},st.range=function(tt){return arguments.length?($=Et.call(tt),st):$.slice()},st.unknown=function(tt){return arguments.length?(le=tt,st):le},st.copy=function(){return k(I,$).unknown(le)},vr.apply(st,arguments),st}function Te(){var g=ordinal().unknown(void 0),I=g.domain,$=g.range,le=[0,1],st,tt,_t=!1,Xt=0,sr=0,Jr=.5;delete g.unknown;function Tn(){var tr=I().length,or=le[1]<le[0],jn=le[or-0],Ci=le[1-or];st=(Ci-jn)/Math.max(1,tr-Xt+sr*2),_t&&(st=Math.floor(st)),jn+=(Ci-jn-st*(tr-Xt))*Jr,tt=st*(1-Xt),_t&&(jn=Math.round(jn),tt=Math.round(tt));var Ni=sequence(tr).map(function(xi){return jn+st*xi});return $(or?Ni.reverse():Ni)}return g.domain=function(tr){return arguments.length?(I(tr),Tn()):I()},g.range=function(tr){return arguments.length?(le=[+tr[0],+tr[1]],Tn()):le.slice()},g.rangeRound=function(tr){return le=[+tr[0],+tr[1]],_t=!0,Tn()},g.bandwidth=function(){return tt},g.step=function(){return st},g.round=function(tr){return arguments.length?(_t=!!tr,Tn()):_t},g.padding=function(tr){return arguments.length?(Xt=Math.min(1,sr=+tr),Tn()):Xt},g.paddingInner=function(tr){return arguments.length?(Xt=Math.min(1,tr),Tn()):Xt},g.paddingOuter=function(tr){return arguments.length?(sr=+tr,Tn()):sr},g.align=function(tr){return arguments.length?(Jr=Math.max(0,Math.min(1,tr)),Tn()):Jr},g.copy=function(){return Te(I(),le).round(_t).paddingInner(Xt).paddingOuter(sr).align(Jr)},initRange.apply(Tn(),arguments)}function Se(g){var I=g.copy;return g.padding=g.paddingOuter,delete g.paddingInner,delete g.paddingOuter,g.copy=function(){return Se(I())},g}function me(){return Se(Te.apply(null,arguments).paddingInner(1))}var De=ot(2650),we=ot(87765);function ze(g,I){return(isNumberArray(I)?numberArray:Qt)(g,I)}function Qt(g,I){var $=I?I.length:0,le=g?Math.min($,g.length):0,st=new Array(le),tt=new Array($),_t;for(_t=0;_t<le;++_t)st[_t]=ke(g[_t],I[_t]);for(;_t<$;++_t)tt[_t]=I[_t];return function(Xt){for(_t=0;_t<le;++_t)tt[_t]=st[_t](Xt);return tt}}function V(g,I){var $=new Date;return g=+g,I=+I,function(le){return $.setTime(g*(1-le)+I*le),$}}function pe(g,I){return g=+g,I=+I,function($){return g*(1-$)+I*$}}function P(g,I){var $={},le={},st;(g===null||typeof g!="object")&&(g={}),(I===null||typeof I!="object")&&(I={});for(st in I)st in g?$[st]=ke(g[st],I[st]):le[st]=I[st];return function(tt){for(st in $)le[st]=$[st](tt);return le}}var U=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,B=new RegExp(U.source,"g");function E(g){return function(){return g}}function D(g){return function(I){return g(I)+""}}function q(g,I){var $=U.lastIndex=B.lastIndex=0,le,st,tt,_t=-1,Xt=[],sr=[];for(g=g+"",I=I+"";(le=U.exec(g))&&(st=B.exec(I));)(tt=st.index)>$&&(tt=I.slice($,tt),Xt[_t]?Xt[_t]+=tt:Xt[++_t]=tt),(le=le[0])===(st=st[0])?Xt[_t]?Xt[_t]+=st:Xt[++_t]=st:(Xt[++_t]=null,sr.push({i:_t,x:pe(le,st)})),$=B.lastIndex;return $<I.length&&(tt=I.slice($),Xt[_t]?Xt[_t]+=tt:Xt[++_t]=tt),Xt.length<2?sr[0]?D(sr[0].x):E(I):(I=sr.length,function(Jr){for(var Tn=0,tr;Tn<I;++Tn)Xt[(tr=sr[Tn]).i]=tr.x(Jr);return Xt.join("")})}var Q=ot(55302);function Ae(g,I){I||(I=[]);var $=g?Math.min(I.length,g.length):0,le=I.slice(),st;return function(tt){for(st=0;st<$;++st)le[st]=g[st]*(1-tt)+I[st]*tt;return le}}function ct(g){return ArrayBuffer.isView(g)&&!(g instanceof DataView)}function ke(g,I){var $=typeof I,le;return I==null||$==="boolean"?(0,Q.Z)(I):($==="number"?pe:$==="string"?(le=(0,De.ZP)(I))?(I=le,we.ZP):q:I instanceof De.ZP?we.ZP:I instanceof Date?V:ct(I)?Ae:Array.isArray(I)?Qt:typeof I.valueOf!="function"&&typeof I.toString!="function"||isNaN(I)?P:pe)(g,I)}function He(g,I){return g=+g,I=+I,function($){return Math.round(g*(1-$)+I*$)}}function We(g){return function(){return g}}function xt(g){return+g}var jt=[0,1];function Gt(g){return g}function Rt(g,I){return(I-=g=+g)?function($){return($-g)/I}:We(isNaN(I)?NaN:.5)}function Ar(g){var I=g[0],$=g[g.length-1],le;return I>$&&(le=I,I=$,$=le),function(st){return Math.max(I,Math.min($,st))}}function Gr(g,I,$){var le=g[0],st=g[1],tt=I[0],_t=I[1];return st<le?(le=Rt(st,le),tt=$(_t,tt)):(le=Rt(le,st),tt=$(tt,_t)),function(Xt){return tt(le(Xt))}}function er(g,I,$){var le=Math.min(g.length,I.length)-1,st=new Array(le),tt=new Array(le),_t=-1;for(g[le]<g[0]&&(g=g.slice().reverse(),I=I.slice().reverse());++_t<le;)st[_t]=Rt(g[_t],g[_t+1]),tt[_t]=$(I[_t],I[_t+1]);return function(Xt){var sr=(0,vt.b4)(g,Xt,1,le)-1;return tt[sr](st[sr](Xt))}}function $e(g,I){return I.domain(g.domain()).range(g.range()).interpolate(g.interpolate()).clamp(g.clamp()).unknown(g.unknown())}function rt(){var g=jt,I=jt,$=ke,le,st,tt,_t=Gt,Xt,sr,Jr;function Tn(){return Xt=Math.min(g.length,I.length)>2?er:Gr,sr=Jr=null,tr}function tr(or){return isNaN(or=+or)?tt:(sr||(sr=Xt(g.map(le),I,$)))(le(_t(or)))}return tr.invert=function(or){return _t(st((Jr||(Jr=Xt(I,g.map(le),pe)))(or)))},tr.domain=function(or){return arguments.length?(g=fr.call(or,xt),_t===Gt||(_t=Ar(g)),Tn()):g.slice()},tr.range=function(or){return arguments.length?(I=Et.call(or),Tn()):I.slice()},tr.rangeRound=function(or){return I=Et.call(or),$=He,Tn()},tr.clamp=function(or){return arguments.length?(_t=or?Ar(g):Gt,tr):_t!==Gt},tr.interpolate=function(or){return arguments.length?($=or,Tn()):$},tr.unknown=function(or){return arguments.length?(tt=or,tr):tt},function(or,jn){return le=or,st=jn,Tn()}}function Wt(g,I){return rt()(g,I)}var Kt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ur(g){if(!(I=Kt.exec(g)))throw new Error("invalid format: "+g);var I;return new ae({fill:I[1],align:I[2],sign:I[3],symbol:I[4],zero:I[5],width:I[6],comma:I[7],precision:I[8]&&I[8].slice(1),trim:I[9],type:I[10]})}ur.prototype=ae.prototype;function ae(g){this.fill=g.fill===void 0?" ":g.fill+"",this.align=g.align===void 0?">":g.align+"",this.sign=g.sign===void 0?"-":g.sign+"",this.symbol=g.symbol===void 0?"":g.symbol+"",this.zero=!!g.zero,this.width=g.width===void 0?void 0:+g.width,this.comma=!!g.comma,this.precision=g.precision===void 0?void 0:+g.precision,this.trim=!!g.trim,this.type=g.type===void 0?"":g.type+""}ae.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function z(g){return Math.abs(g=Math.round(g))>=1e21?g.toLocaleString("en").replace(/,/g,""):g.toString(10)}function R(g,I){if(($=(g=I?g.toExponential(I-1):g.toExponential()).indexOf("e"))<0)return null;var $,le=g.slice(0,$);return[le.length>1?le[0]+le.slice(2):le,+g.slice($+1)]}function j(g){return g=R(Math.abs(g)),g?g[1]:NaN}function b(g,I){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(j(I)/3)))*3-j(Math.abs(g)))}function ce(g,I){return function($,le){for(var st=$.length,tt=[],_t=0,Xt=g[0],sr=0;st>0&&Xt>0&&(sr+Xt+1>le&&(Xt=Math.max(1,le-sr)),tt.push($.substring(st-=Xt,st+Xt)),!((sr+=Xt+1)>le));)Xt=g[_t=(_t+1)%g.length];return tt.reverse().join(I)}}function Ye(g){return function(I){return I.replace(/[0-9]/g,function($){return g[+$]})}}function Pt(g){e:for(var I=g.length,$=1,le=-1,st;$<I;++$)switch(g[$]){case".":le=st=$;break;case"0":le===0&&(le=$),st=$;break;default:if(!+g[$])break e;le>0&&(le=0);break}return le>0?g.slice(0,le)+g.slice(st+1):g}var te;function he(g,I){var $=R(g,I);if(!$)return g+"";var le=$[0],st=$[1],tt=st-(te=Math.max(-8,Math.min(8,Math.floor(st/3)))*3)+1,_t=le.length;return tt===_t?le:tt>_t?le+new Array(tt-_t+1).join("0"):tt>0?le.slice(0,tt)+"."+le.slice(tt):"0."+new Array(1-tt).join("0")+R(g,Math.max(0,I+tt-1))[0]}function ve(g,I){var $=R(g,I);if(!$)return g+"";var le=$[0],st=$[1];return st<0?"0."+new Array(-st).join("0")+le:le.length>st+1?le.slice(0,st+1)+"."+le.slice(st+1):le+new Array(st-le.length+2).join("0")}var it={"%":function(g,I){return(g*100).toFixed(I)},b:function(g){return Math.round(g).toString(2)},c:function(g){return g+""},d:z,e:function(g,I){return g.toExponential(I)},f:function(g,I){return g.toFixed(I)},g:function(g,I){return g.toPrecision(I)},o:function(g){return Math.round(g).toString(8)},p:function(g,I){return ve(g*100,I)},r:ve,s:he,X:function(g){return Math.round(g).toString(16).toUpperCase()},x:function(g){return Math.round(g).toString(16)}};function at(g){return g}var fe=Array.prototype.map,wr=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Dr(g){var I=g.grouping===void 0||g.thousands===void 0?at:ce(fe.call(g.grouping,Number),g.thousands+""),$=g.currency===void 0?"":g.currency[0]+"",le=g.currency===void 0?"":g.currency[1]+"",st=g.decimal===void 0?".":g.decimal+"",tt=g.numerals===void 0?at:Ye(fe.call(g.numerals,String)),_t=g.percent===void 0?"%":g.percent+"",Xt=g.minus===void 0?"-":g.minus+"",sr=g.nan===void 0?"NaN":g.nan+"";function Jr(tr){tr=ur(tr);var or=tr.fill,jn=tr.align,Ci=tr.sign,Ni=tr.symbol,xi=tr.zero,Ta=tr.width,to=tr.comma,La=tr.precision,ti=tr.trim,yi=tr.type;yi==="n"?(to=!0,yi="g"):it[yi]||(La===void 0&&(La=12),ti=!0,yi="g"),(xi||or==="0"&&jn==="=")&&(xi=!0,or="0",jn="=");var Fo=Ni==="$"?$:Ni==="#"&&/[boxX]/.test(yi)?"0"+yi.toLowerCase():"",si=Ni==="$"?le:/[%p]/.test(yi)?_t:"",ha=it[yi],ba=/[defgprs%]/.test(yi);La=La===void 0?6:/[gprs]/.test(yi)?Math.max(1,Math.min(21,La)):Math.max(0,Math.min(20,La));function ji(ri){var ta=Fo,la=si,Zo,Rs,Os;if(yi==="c")la=ha(ri)+la,ri="";else{ri=+ri;var ps=ri<0||1/ri<0;if(ri=isNaN(ri)?sr:ha(Math.abs(ri),La),ti&&(ri=Pt(ri)),ps&&+ri==0&&Ci!=="+"&&(ps=!1),ta=(ps?Ci==="("?Ci:Xt:Ci==="-"||Ci==="("?"":Ci)+ta,la=(yi==="s"?wr[8+te/3]:"")+la+(ps&&Ci==="("?")":""),ba){for(Zo=-1,Rs=ri.length;++Zo<Rs;)if(Os=ri.charCodeAt(Zo),48>Os||Os>57){la=(Os===46?st+ri.slice(Zo+1):ri.slice(Zo))+la,ri=ri.slice(0,Zo);break}}}to&&!xi&&(ri=I(ri,Infinity));var as=ta.length+ri.length+la.length,Jo=as<Ta?new Array(Ta-as+1).join(or):"";switch(to&&xi&&(ri=I(Jo+ri,Jo.length?Ta-la.length:Infinity),Jo=""),jn){case"<":ri=ta+ri+la+Jo;break;case"=":ri=ta+Jo+ri+la;break;case"^":ri=Jo.slice(0,as=Jo.length>>1)+ta+ri+la+Jo.slice(as);break;default:ri=Jo+ta+ri+la;break}return tt(ri)}return ji.toString=function(){return tr+""},ji}function Tn(tr,or){var jn=Jr((tr=ur(tr),tr.type="f",tr)),Ci=Math.max(-8,Math.min(8,Math.floor(j(or)/3)))*3,Ni=Math.pow(10,-Ci),xi=wr[8+Ci/3];return function(Ta){return jn(Ni*Ta)+xi}}return{format:Jr,formatPrefix:Tn}}var Nr,yt,jr;Dn({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Dn(g){return Nr=Dr(g),yt=Nr.format,jr=Nr.formatPrefix,Nr}function ai(g,I){return g=Math.abs(g),I=Math.abs(I)-g,Math.max(0,j(I)-j(g))+1}function Mi(g){return Math.max(0,-j(Math.abs(g)))}function Li(g,I,$,le){var st=(0,vt.ly)(g,I,$),tt;switch(le=ur(le==null?",f":le),le.type){case"s":{var _t=Math.max(Math.abs(g),Math.abs(I));return le.precision==null&&!isNaN(tt=b(st,_t))&&(le.precision=tt),jr(le,_t)}case"":case"e":case"g":case"p":case"r":{le.precision==null&&!isNaN(tt=ai(st,Math.max(Math.abs(g),Math.abs(I))))&&(le.precision=tt-(le.type==="e"));break}case"f":case"%":{le.precision==null&&!isNaN(tt=Mi(st))&&(le.precision=tt-(le.type==="%")*2);break}}return yt(le)}function Kn(g){var I=g.domain;return g.ticks=function($){var le=I();return(0,vt.sd)(le[0],le[le.length-1],$==null?10:$)},g.tickFormat=function($,le){var st=I();return Li(st[0],st[st.length-1],$==null?10:$,le)},g.nice=function($){$==null&&($=10);var le=I(),st=0,tt=le.length-1,_t=le[st],Xt=le[tt],sr;return Xt<_t&&(sr=_t,_t=Xt,Xt=sr,sr=st,st=tt,tt=sr),sr=(0,vt.G9)(_t,Xt,$),sr>0?(_t=Math.floor(_t/sr)*sr,Xt=Math.ceil(Xt/sr)*sr,sr=(0,vt.G9)(_t,Xt,$)):sr<0&&(_t=Math.ceil(_t*sr)/sr,Xt=Math.floor(Xt*sr)/sr,sr=(0,vt.G9)(_t,Xt,$)),sr>0?(le[st]=Math.floor(_t/sr)*sr,le[tt]=Math.ceil(Xt/sr)*sr,I(le)):sr<0&&(le[st]=Math.ceil(_t*sr)/sr,le[tt]=Math.floor(Xt*sr)/sr,I(le)),g},g}function L(){var g=Wt(Gt,Gt);return g.copy=function(){return $e(g,L())},vr.apply(g,arguments),Kn(g)}function N(g){var I;function $(le){return isNaN(le=+le)?I:le}return $.invert=$,$.domain=$.range=function(le){return arguments.length?(g=fr.call(le,xt),$):g.slice()},$.unknown=function(le){return arguments.length?(I=le,$):I},$.copy=function(){return N(g).unknown(I)},g=arguments.length?fr.call(g,xt):[0,1],Kn($)}function H(g,I){g=g.slice();var $=0,le=g.length-1,st=g[$],tt=g[le],_t;return tt<st&&(_t=$,$=le,le=_t,_t=st,st=tt,tt=_t),g[$]=I.floor(st),g[le]=I.ceil(tt),g}function ne(g){return Math.log(g)}function xe(g){return Math.exp(g)}function Ne(g){return-Math.log(-g)}function Qe(g){return-Math.exp(-g)}function J(g){return isFinite(g)?+("1e"+g):g<0?0:g}function Me(g){return g===10?J:g===Math.E?Math.exp:function(I){return Math.pow(g,I)}}function bt(g){return g===Math.E?Math.log:g===10&&Math.log10||g===2&&Math.log2||(g=Math.log(g),function(I){return Math.log(I)/g})}function gr(g){return function(I){return-g(-I)}}function zt(g){var I=g(ne,xe),$=I.domain,le=10,st,tt;function _t(){return st=bt(le),tt=Me(le),$()[0]<0?(st=gr(st),tt=gr(tt),g(Ne,Qe)):g(ne,xe),I}return I.base=function(Xt){return arguments.length?(le=+Xt,_t()):le},I.domain=function(Xt){return arguments.length?($(Xt),_t()):$()},I.ticks=function(Xt){var sr=$(),Jr=sr[0],Tn=sr[sr.length-1],tr;(tr=Tn<Jr)&&(or=Jr,Jr=Tn,Tn=or);var or=st(Jr),jn=st(Tn),Ci,Ni,xi,Ta=Xt==null?10:+Xt,to=[];if(!(le%1)&&jn-or<Ta){if(or=Math.round(or)-1,jn=Math.round(jn)+1,Jr>0){for(;or<jn;++or)for(Ni=1,Ci=tt(or);Ni<le;++Ni)if(xi=Ci*Ni,!(xi<Jr)){if(xi>Tn)break;to.push(xi)}}else for(;or<jn;++or)for(Ni=le-1,Ci=tt(or);Ni>=1;--Ni)if(xi=Ci*Ni,!(xi<Jr)){if(xi>Tn)break;to.push(xi)}}else to=(0,vt.sd)(or,jn,Math.min(jn-or,Ta)).map(tt);return tr?to.reverse():to},I.tickFormat=function(Xt,sr){if(sr==null&&(sr=le===10?".0e":","),typeof sr!="function"&&(sr=yt(sr)),Xt===Infinity)return sr;Xt==null&&(Xt=10);var Jr=Math.max(1,le*Xt/I.ticks().length);return function(Tn){var tr=Tn/tt(Math.round(st(Tn)));return tr*le<le-.5&&(tr*=le),tr<=Jr?sr(Tn):""}},I.nice=function(){return $(H($(),{floor:function(Xt){return tt(Math.floor(st(Xt)))},ceil:function(Xt){return tt(Math.ceil(st(Xt)))}}))},I}function Nt(){var g=zt(rt()).domain([1,10]);return g.copy=function(){return $e(g,Nt()).base(g.base())},vr.apply(g,arguments),g}function br(g){return function(I){return Math.sign(I)*Math.log1p(Math.abs(I/g))}}function vn(g){return function(I){return Math.sign(I)*Math.expm1(Math.abs(I))*g}}function cn(g){var I=1,$=g(br(I),vn(I));return $.constant=function(le){return arguments.length?g(br(I=+le),vn(I)):I},linearish($)}function Lt(){var g=cn(transformer());return g.copy=function(){return copy(g,Lt()).constant(g.constant())},initRange.apply(g,arguments)}function on(g){return function(I){return I<0?-Math.pow(-I,g):Math.pow(I,g)}}function qr(g){return g<0?-Math.sqrt(-g):Math.sqrt(g)}function Yr(g){return g<0?-g*g:g*g}function $n(g){var I=g(Gt,Gt),$=1;function le(){return $===1?g(Gt,Gt):$===.5?g(qr,Yr):g(on($),on(1/$))}return I.exponent=function(st){return arguments.length?($=+st,le()):$},Kn(I)}function $r(){var g=$n(rt());return g.copy=function(){return $e(g,$r()).exponent(g.exponent())},vr.apply(g,arguments),g}function hi(){return $r.apply(null,arguments).exponent(.5)}function Oi(){var g=[],I=[],$=[],le;function st(){var _t=0,Xt=Math.max(1,I.length);for($=new Array(Xt-1);++_t<Xt;)$[_t-1]=(0,vt.VR)(g,_t/Xt);return tt}function tt(_t){return isNaN(_t=+_t)?le:I[(0,vt.b4)($,_t)]}return tt.invertExtent=function(_t){var Xt=I.indexOf(_t);return Xt<0?[NaN,NaN]:[Xt>0?$[Xt-1]:g[0],Xt<$.length?$[Xt]:g[g.length-1]]},tt.domain=function(_t){if(!arguments.length)return g.slice();g=[];for(var Xt=0,sr=_t.length,Jr;Xt<sr;++Xt)Jr=_t[Xt],Jr!=null&&!isNaN(Jr=+Jr)&&g.push(Jr);return g.sort(vt.j2),st()},tt.range=function(_t){return arguments.length?(I=Et.call(_t),st()):I.slice()},tt.unknown=function(_t){return arguments.length?(le=_t,tt):le},tt.quantiles=function(){return $.slice()},tt.copy=function(){return Oi().domain(g).range(I).unknown(le)},vr.apply(tt,arguments)}function Qn(){var g=0,I=1,$=1,le=[.5],st=[0,1],tt;function _t(sr){return sr<=sr?st[(0,vt.b4)(le,sr,0,$)]:tt}function Xt(){var sr=-1;for(le=new Array($);++sr<$;)le[sr]=((sr+1)*I-(sr-$)*g)/($+1);return _t}return _t.domain=function(sr){return arguments.length?(g=+sr[0],I=+sr[1],Xt()):[g,I]},_t.range=function(sr){return arguments.length?($=(st=Et.call(sr)).length-1,Xt()):st.slice()},_t.invertExtent=function(sr){var Jr=st.indexOf(sr);return Jr<0?[NaN,NaN]:Jr<1?[g,le[0]]:Jr>=$?[le[$-1],I]:[le[Jr-1],le[Jr]]},_t.unknown=function(sr){return arguments.length&&(tt=sr),_t},_t.thresholds=function(){return le.slice()},_t.copy=function(){return Qn().domain([g,I]).range(st).unknown(tt)},vr.apply(Kn(_t),arguments)}function fi(){var g=[.5],I=[0,1],$,le=1;function st(tt){return tt<=tt?I[(0,vt.b4)(g,tt,0,le)]:$}return st.domain=function(tt){return arguments.length?(g=Et.call(tt),le=Math.min(g.length,I.length-1),st):g.slice()},st.range=function(tt){return arguments.length?(I=Et.call(tt),le=Math.min(g.length,I.length-1),st):I.slice()},st.invertExtent=function(tt){var _t=I.indexOf(tt);return[g[_t-1],g[_t]]},st.unknown=function(tt){return arguments.length?($=tt,st):$},st.copy=function(){return fi().domain(g).range(I).unknown($)},vr.apply(st,arguments)}var ei=new Date,zn=new Date;function Wn(g,I,$,le){function st(tt){return g(tt=arguments.length===0?new Date:new Date(+tt)),tt}return st.floor=function(tt){return g(tt=new Date(+tt)),tt},st.ceil=function(tt){return g(tt=new Date(tt-1)),I(tt,1),g(tt),tt},st.round=function(tt){var _t=st(tt),Xt=st.ceil(tt);return tt-_t<Xt-tt?_t:Xt},st.offset=function(tt,_t){return I(tt=new Date(+tt),_t==null?1:Math.floor(_t)),tt},st.range=function(tt,_t,Xt){var sr=[],Jr;if(tt=st.ceil(tt),Xt=Xt==null?1:Math.floor(Xt),!(tt<_t)||!(Xt>0))return sr;do sr.push(Jr=new Date(+tt)),I(tt,Xt),g(tt);while(Jr<tt&&tt<_t);return sr},st.filter=function(tt){return Wn(function(_t){if(_t>=_t)for(;g(_t),!tt(_t);)_t.setTime(_t-1)},function(_t,Xt){if(_t>=_t)if(Xt<0)for(;++Xt<=0;)for(;I(_t,-1),!tt(_t););else for(;--Xt>=0;)for(;I(_t,1),!tt(_t););})},$&&(st.count=function(tt,_t){return ei.setTime(+tt),zn.setTime(+_t),g(ei),g(zn),Math.floor($(ei,zn))},st.every=function(tt){return tt=Math.floor(tt),!isFinite(tt)||!(tt>0)?null:tt>1?st.filter(le?function(_t){return le(_t)%tt==0}:function(_t){return st.count(0,_t)%tt==0}):st}),st}var Qi=Wn(function(g){g.setMonth(0,1),g.setHours(0,0,0,0)},function(g,I){g.setFullYear(g.getFullYear()+I)},function(g,I){return I.getFullYear()-g.getFullYear()},function(g){return g.getFullYear()});Qi.every=function(g){return!isFinite(g=Math.floor(g))||!(g>0)?null:Wn(function(I){I.setFullYear(Math.floor(I.getFullYear()/g)*g),I.setMonth(0,1),I.setHours(0,0,0,0)},function(I,$){I.setFullYear(I.getFullYear()+$*g)})};var _i=Qi,di=Qi.range,vi=Wn(function(g){g.setDate(1),g.setHours(0,0,0,0)},function(g,I){g.setMonth(g.getMonth()+I)},function(g,I){return I.getMonth()-g.getMonth()+(I.getFullYear()-g.getFullYear())*12},function(g){return g.getMonth()}),oa=vi,ns=vi.range,ea=1e3,zi=6e4,yo=36e5,$a=864e5,Di=6048e5;function So(g){return Wn(function(I){I.setDate(I.getDate()-(I.getDay()+7-g)%7),I.setHours(0,0,0,0)},function(I,$){I.setDate(I.getDate()+$*7)},function(I,$){return($-I-($.getTimezoneOffset()-I.getTimezoneOffset())*zi)/Di})}var ya=So(0),na=So(1),ga=So(2),Bi=So(3),wa=So(4),Qa=So(5),_s=So(6),Ga=ya.range,eo=na.range,Hi=ga.range,Pa=Bi.range,go=wa.range,Ma=Qa.range,ls=_s.range,ou=Wn(function(g){g.setHours(0,0,0,0)},function(g,I){g.setDate(g.getDate()+I)},function(g,I){return(I-g-(I.getTimezoneOffset()-g.getTimezoneOffset())*zi)/$a},function(g){return g.getDate()-1}),_o=ou,W=ou.range,ue=Wn(function(g){g.setTime(g-g.getMilliseconds()-g.getSeconds()*ea-g.getMinutes()*zi)},function(g,I){g.setTime(+g+I*yo)},function(g,I){return(I-g)/yo},function(g){return g.getHours()}),Je=ue,Ft=ue.range,Rr=Wn(function(g){g.setTime(g-g.getMilliseconds()-g.getSeconds()*ea)},function(g,I){g.setTime(+g+I*zi)},function(g,I){return(I-g)/zi},function(g){return g.getMinutes()}),An=Rr,mi=Rr.range,_a=Wn(function(g){g.setTime(g-g.getMilliseconds())},function(g,I){g.setTime(+g+I*ea)},function(g,I){return(I-g)/ea},function(g){return g.getUTCSeconds()}),sa=_a,xa=_a.range,Fa=Wn(function(){},function(g,I){g.setTime(+g+I)},function(g,I){return I-g});Fa.every=function(g){return g=Math.floor(g),!isFinite(g)||!(g>0)?null:g>1?Wn(function(I){I.setTime(Math.floor(I/g)*g)},function(I,$){I.setTime(+I+$*g)},function(I,$){return($-I)/g}):Fa};var To=Fa,so=Fa.range;function za(g){return Wn(function(I){I.setUTCDate(I.getUTCDate()-(I.getUTCDay()+7-g)%7),I.setUTCHours(0,0,0,0)},function(I,$){I.setUTCDate(I.getUTCDate()+$*7)},function(I,$){return($-I)/Di})}var xo=za(0),uo=za(1),Ho=za(2),is=za(3),ja=za(4),Wi=za(5),qa=za(6),Bu=xo.range,Ju=uo.range,su=Ho.range,$u=is.range,wu=ja.range,uu=Wi.range,cs=qa.range,Us=Wn(function(g){g.setUTCHours(0,0,0,0)},function(g,I){g.setUTCDate(g.getUTCDate()+I)},function(g,I){return(I-g)/$a},function(g){return g.getUTCDate()-1}),c=Us,m=Us.range,S=Wn(function(g){g.setUTCMonth(0,1),g.setUTCHours(0,0,0,0)},function(g,I){g.setUTCFullYear(g.getUTCFullYear()+I)},function(g,I){return I.getUTCFullYear()-g.getUTCFullYear()},function(g){return g.getUTCFullYear()});S.every=function(g){return!isFinite(g=Math.floor(g))||!(g>0)?null:Wn(function(I){I.setUTCFullYear(Math.floor(I.getUTCFullYear()/g)*g),I.setUTCMonth(0,1),I.setUTCHours(0,0,0,0)},function(I,$){I.setUTCFullYear(I.getUTCFullYear()+$*g)})};var _=S,G=S.range;function oe(g){if(0<=g.y&&g.y<100){var I=new Date(-1,g.m,g.d,g.H,g.M,g.S,g.L);return I.setFullYear(g.y),I}return new Date(g.y,g.m,g.d,g.H,g.M,g.S,g.L)}function je(g){if(0<=g.y&&g.y<100){var I=new Date(Date.UTC(-1,g.m,g.d,g.H,g.M,g.S,g.L));return I.setUTCFullYear(g.y),I}return new Date(Date.UTC(g.y,g.m,g.d,g.H,g.M,g.S,g.L))}function lt(g,I,$){return{y:g,m:I,d:$,H:0,M:0,S:0,L:0}}function gt(g){var I=g.dateTime,$=g.date,le=g.time,st=g.periods,tt=g.days,_t=g.shortDays,Xt=g.months,sr=g.shortMonths,Jr=Fi(st),Tn=Gi(st),tr=Fi(tt),or=Gi(tt),jn=Fi(_t),Ci=Gi(_t),Ni=Fi(Xt),xi=Gi(Xt),Ta=Fi(sr),to=Gi(sr),La={a:ps,A:as,b:Jo,B:$s,c:null,d:qs,e:qs,f:Yl,g:al,G:Ws,H:Wl,I:Zs,j:Pl,L:Xl,m:nl,M:Su,p:Qs,q:fl,Q:Io,s:ku,S:lu,u:cu,U:hu,V:fu,w:Hs,W:Xo,x:null,X:null,y:il,Y:Ml,Z:Tu,"%":ia},ti={a:eu,A:$o,b:pl,B:qu,c:null,d:Au,e:Au,f:Xs,g:Iu,G:Ss,H:ol,I:Nu,j:Kl,L:Cu,m:sl,M:ul,p:Ol,q:Mu,Q:Io,s:ku,S:Ys,u:Ll,U:Dl,V:pu,w:Jl,W:du,x:null,X:null,y:pa,Y:mu,Z:wi,"%":ia},yi={a:ji,A:ri,b:ta,B:la,c:Zo,d:Ea,e:Ea,f:Wo,g:Eu,G:Ms,H:el,I:el,j:kl,L:Es,m:ws,M:Co,p:ba,q:bs,Q:js,s:Xi,S:tl,u:Ao,U:hs,V:Gs,w:bi,W:Qu,x:Rs,X:Os,y:Eu,Y:Ms,Z:xs,"%":rl};La.x=Fo($,La),La.X=Fo(le,La),La.c=Fo(I,La),ti.x=Fo($,ti),ti.X=Fo(le,ti),ti.c=Fo(I,ti);function Fo(n,a){return function(i){var o=[],f=-1,d=0,v=n.length,x,C,F;for(i instanceof Date||(i=new Date(+i));++f<v;)n.charCodeAt(f)===37&&(o.push(n.slice(d,f)),(C=hr[x=n.charAt(++f)])!=null?x=n.charAt(++f):C=x==="e"?" ":"0",(F=a[x])&&(x=F(i,C)),o.push(x),d=f+1);return o.push(n.slice(d,f)),o.join("")}}function si(n,a){return function(i){var o=lt(1900,void 0,1),f=ha(o,n,i+="",0),d,v;if(f!=i.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(o.s*1e3+("L"in o?o.L:0));if(a&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+o.p*12),o.m===void 0&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(d=je(lt(o.y,0,1)),v=d.getUTCDay(),d=v>4||v===0?uo.ceil(d):uo(d),d=c.offset(d,(o.V-1)*7),o.y=d.getUTCFullYear(),o.m=d.getUTCMonth(),o.d=d.getUTCDate()+(o.w+6)%7):(d=oe(lt(o.y,0,1)),v=d.getDay(),d=v>4||v===0?na.ceil(d):na(d),d=_o.offset(d,(o.V-1)*7),o.y=d.getFullYear(),o.m=d.getMonth(),o.d=d.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),v="Z"in o?je(lt(o.y,0,1)).getUTCDay():oe(lt(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+o.W*7-(v+5)%7:o.w+o.U*7-(v+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,je(o)):oe(o)}}function ha(n,a,i,o){for(var f=0,d=a.length,v=i.length,x,C;f<d;){if(o>=v)return-1;if(x=a.charCodeAt(f++),x===37){if(x=a.charAt(f++),C=yi[x in hr?a.charAt(f++):x],!C||(o=C(n,i,o))<0)return-1}else if(x!=i.charCodeAt(o++))return-1}return o}function ba(n,a,i){var o=Jr.exec(a.slice(i));return o?(n.p=Tn[o[0].toLowerCase()],i+o[0].length):-1}function ji(n,a,i){var o=jn.exec(a.slice(i));return o?(n.w=Ci[o[0].toLowerCase()],i+o[0].length):-1}function ri(n,a,i){var o=tr.exec(a.slice(i));return o?(n.w=or[o[0].toLowerCase()],i+o[0].length):-1}function ta(n,a,i){var o=Ta.exec(a.slice(i));return o?(n.m=to[o[0].toLowerCase()],i+o[0].length):-1}function la(n,a,i){var o=Ni.exec(a.slice(i));return o?(n.m=xi[o[0].toLowerCase()],i+o[0].length):-1}function Zo(n,a,i){return ha(n,I,a,i)}function Rs(n,a,i){return ha(n,$,a,i)}function Os(n,a,i){return ha(n,le,a,i)}function ps(n){return _t[n.getDay()]}function as(n){return tt[n.getDay()]}function Jo(n){return sr[n.getMonth()]}function $s(n){return Xt[n.getMonth()]}function Qs(n){return st[+(n.getHours()>=12)]}function fl(n){return 1+~~(n.getMonth()/3)}function eu(n){return _t[n.getUTCDay()]}function $o(n){return tt[n.getUTCDay()]}function pl(n){return sr[n.getUTCMonth()]}function qu(n){return Xt[n.getUTCMonth()]}function Ol(n){return st[+(n.getUTCHours()>=12)]}function Mu(n){return 1+~~(n.getUTCMonth()/3)}return{format:function(n){var a=Fo(n+="",La);return a.toString=function(){return n},a},parse:function(n){var a=si(n+="",!1);return a.toString=function(){return n},a},utcFormat:function(n){var a=Fo(n+="",ti);return a.toString=function(){return n},a},utcParse:function(n){var a=si(n+="",!0);return a.toString=function(){return n},a}}}var hr={"-":"",_:" ","0":"0"},cr=/^\s*\d+/,Cn=/^%/,Xn=/[\\^$*+?|[\]().{}]/g;function sn(g,I,$){var le=g<0?"-":"",st=(le?-g:g)+"",tt=st.length;return le+(tt<$?new Array($-tt+1).join(I)+st:st)}function Ai(g){return g.replace(Xn,"\\$&")}function Fi(g){return new RegExp("^(?:"+g.map(Ai).join("|")+")","i")}function Gi(g){for(var I={},$=-1,le=g.length;++$<le;)I[g[$].toLowerCase()]=$;return I}function bi(g,I,$){var le=cr.exec(I.slice($,$+1));return le?(g.w=+le[0],$+le[0].length):-1}function Ao(g,I,$){var le=cr.exec(I.slice($,$+1));return le?(g.u=+le[0],$+le[0].length):-1}function hs(g,I,$){var le=cr.exec(I.slice($,$+2));return le?(g.U=+le[0],$+le[0].length):-1}function Gs(g,I,$){var le=cr.exec(I.slice($,$+2));return le?(g.V=+le[0],$+le[0].length):-1}function Qu(g,I,$){var le=cr.exec(I.slice($,$+2));return le?(g.W=+le[0],$+le[0].length):-1}function Ms(g,I,$){var le=cr.exec(I.slice($,$+4));return le?(g.y=+le[0],$+le[0].length):-1}function Eu(g,I,$){var le=cr.exec(I.slice($,$+2));return le?(g.y=+le[0]+(+le[0]>68?1900:2e3),$+le[0].length):-1}function xs(g,I,$){var le=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(I.slice($,$+6));return le?(g.Z=le[1]?0:-(le[2]+(le[3]||"00")),$+le[0].length):-1}function bs(g,I,$){var le=cr.exec(I.slice($,$+1));return le?(g.q=le[0]*3-3,$+le[0].length):-1}function ws(g,I,$){var le=cr.exec(I.slice($,$+2));return le?(g.m=le[0]-1,$+le[0].length):-1}function Ea(g,I,$){var le=cr.exec(I.slice($,$+2));return le?(g.d=+le[0],$+le[0].length):-1}function kl(g,I,$){var le=cr.exec(I.slice($,$+3));return le?(g.m=0,g.d=+le[0],$+le[0].length):-1}function el(g,I,$){var le=cr.exec(I.slice($,$+2));return le?(g.H=+le[0],$+le[0].length):-1}function Co(g,I,$){var le=cr.exec(I.slice($,$+2));return le?(g.M=+le[0],$+le[0].length):-1}function tl(g,I,$){var le=cr.exec(I.slice($,$+2));return le?(g.S=+le[0],$+le[0].length):-1}function Es(g,I,$){var le=cr.exec(I.slice($,$+3));return le?(g.L=+le[0],$+le[0].length):-1}function Wo(g,I,$){var le=cr.exec(I.slice($,$+6));return le?(g.L=Math.floor(le[0]/1e3),$+le[0].length):-1}function rl(g,I,$){var le=Cn.exec(I.slice($,$+1));return le?$+le[0].length:-1}function js(g,I,$){var le=cr.exec(I.slice($));return le?(g.Q=+le[0],$+le[0].length):-1}function Xi(g,I,$){var le=cr.exec(I.slice($));return le?(g.s=+le[0],$+le[0].length):-1}function qs(g,I){return sn(g.getDate(),I,2)}function Wl(g,I){return sn(g.getHours(),I,2)}function Zs(g,I){return sn(g.getHours()%12||12,I,2)}function Pl(g,I){return sn(1+_o.count(_i(g),g),I,3)}function Xl(g,I){return sn(g.getMilliseconds(),I,3)}function Yl(g,I){return Xl(g,I)+"000"}function nl(g,I){return sn(g.getMonth()+1,I,2)}function Su(g,I){return sn(g.getMinutes(),I,2)}function lu(g,I){return sn(g.getSeconds(),I,2)}function cu(g){var I=g.getDay();return I===0?7:I}function hu(g,I){return sn(ya.count(_i(g)-1,g),I,2)}function Ls(g){var I=g.getDay();return I>=4||I===0?wa(g):wa.ceil(g)}function fu(g,I){return g=Ls(g),sn(wa.count(_i(g),g)+(_i(g).getDay()===4),I,2)}function Hs(g){return g.getDay()}function Xo(g,I){return sn(na.count(_i(g)-1,g),I,2)}function il(g,I){return sn(g.getFullYear()%100,I,2)}function al(g,I){return g=Ls(g),sn(g.getFullYear()%100,I,2)}function Ml(g,I){return sn(g.getFullYear()%1e4,I,4)}function Ws(g,I){var $=g.getDay();return g=$>=4||$===0?wa(g):wa.ceil(g),sn(g.getFullYear()%1e4,I,4)}function Tu(g){var I=g.getTimezoneOffset();return(I>0?"-":(I*=-1,"+"))+sn(I/60|0,"0",2)+sn(I%60,"0",2)}function Au(g,I){return sn(g.getUTCDate(),I,2)}function ol(g,I){return sn(g.getUTCHours(),I,2)}function Nu(g,I){return sn(g.getUTCHours()%12||12,I,2)}function Kl(g,I){return sn(1+c.count(_(g),g),I,3)}function Cu(g,I){return sn(g.getUTCMilliseconds(),I,3)}function Xs(g,I){return Cu(g,I)+"000"}function sl(g,I){return sn(g.getUTCMonth()+1,I,2)}function ul(g,I){return sn(g.getUTCMinutes(),I,2)}function Ys(g,I){return sn(g.getUTCSeconds(),I,2)}function Ll(g){var I=g.getUTCDay();return I===0?7:I}function Dl(g,I){return sn(xo.count(_(g)-1,g),I,2)}function ll(g){var I=g.getUTCDay();return I>=4||I===0?ja(g):ja.ceil(g)}function pu(g,I){return g=ll(g),sn(ja.count(_(g),g)+(_(g).getUTCDay()===4),I,2)}function Jl(g){return g.getUTCDay()}function du(g,I){return sn(uo.count(_(g)-1,g),I,2)}function pa(g,I){return sn(g.getUTCFullYear()%100,I,2)}function Iu(g,I){return g=ll(g),sn(g.getUTCFullYear()%100,I,2)}function mu(g,I){return sn(g.getUTCFullYear()%1e4,I,4)}function Ss(g,I){var $=g.getUTCDay();return g=$>=4||$===0?ja(g):ja.ceil(g),sn(g.getUTCFullYear()%1e4,I,4)}function wi(){return"+0000"}function ia(){return"%"}function Io(g){return+g}function ku(g){return Math.floor(+g/1e3)}var qo,Pu,dc,mc,Vu;Uu({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Uu(g){return qo=gt(g),Pu=qo.format,dc=qo.parse,mc=qo.utcFormat,Vu=qo.utcParse,qo}var Yo=1e3,Sa=Yo*60,Ts=Sa*60,As=Ts*24,Ba=As*7,dn=As*30,da=As*365;function Ds(g){return new Date(g)}function vu(g){return g instanceof Date?+g:+new Date(+g)}function Ko(g,I,$,le,st,tt,_t,Xt,sr){var Jr=Wt(Gt,Gt),Tn=Jr.invert,tr=Jr.domain,or=sr(".%L"),jn=sr(":%S"),Ci=sr("%I:%M"),Ni=sr("%I %p"),xi=sr("%a %d"),Ta=sr("%b %d"),to=sr("%B"),La=sr("%Y"),ti=[[_t,1,Yo],[_t,5,5*Yo],[_t,15,15*Yo],[_t,30,30*Yo],[tt,1,Sa],[tt,5,5*Sa],[tt,15,15*Sa],[tt,30,30*Sa],[st,1,Ts],[st,3,3*Ts],[st,6,6*Ts],[st,12,12*Ts],[le,1,As],[le,2,2*As],[$,1,Ba],[I,1,dn],[I,3,3*dn],[g,1,da]];function yi(si){return(_t(si)<si?or:tt(si)<si?jn:st(si)<si?Ci:le(si)<si?Ni:I(si)<si?$(si)<si?xi:Ta:g(si)<si?to:La)(si)}function Fo(si,ha,ba,ji){if(si==null&&(si=10),typeof si=="number"){var ri=Math.abs(ba-ha)/si,ta=(0,vt.YF)(function(la){return la[2]}).right(ti,ri);ta===ti.length?(ji=(0,vt.ly)(ha/da,ba/da,si),si=g):ta?(ta=ti[ri/ti[ta-1][2]<ti[ta][2]/ri?ta-1:ta],ji=ta[1],si=ta[0]):(ji=Math.max((0,vt.ly)(ha,ba,si),1),si=Xt)}return ji==null?si:si.every(ji)}return Jr.invert=function(si){return new Date(Tn(si))},Jr.domain=function(si){return arguments.length?tr(fr.call(si,vu)):tr().map(Ds)},Jr.ticks=function(si,ha){var ba=tr(),ji=ba[0],ri=ba[ba.length-1],ta=ri<ji,la;return ta&&(la=ji,ji=ri,ri=la),la=Fo(si,ji,ri,ha),la=la?la.range(ji,ri+1):[],ta?la.reverse():la},Jr.tickFormat=function(si,ha){return ha==null?yi:sr(ha)},Jr.nice=function(si,ha){var ba=tr();return(si=Fo(si,ba[0],ba[ba.length-1],ha))?tr(H(ba,si)):Jr},Jr.copy=function(){return $e(Jr,Ko(g,I,$,le,st,tt,_t,Xt,sr))},Jr}function Oo(){return vr.apply(Ko(_i,oa,ya,_o,Je,An,sa,To,Pu).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Rl(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Zr(){var g=0,I=1,$,le,st,tt,_t=Gt,Xt=!1,sr;function Jr(Tn){return isNaN(Tn=+Tn)?sr:_t(st===0?.5:(Tn=(tt(Tn)-$)*st,Xt?Math.max(0,Math.min(1,Tn)):Tn))}return Jr.domain=function(Tn){return arguments.length?($=tt(g=+Tn[0]),le=tt(I=+Tn[1]),st=$===le?0:1/(le-$),Jr):[g,I]},Jr.clamp=function(Tn){return arguments.length?(Xt=!!Tn,Jr):Xt},Jr.interpolator=function(Tn){return arguments.length?(_t=Tn,Jr):_t},Jr.unknown=function(Tn){return arguments.length?(sr=Tn,Jr):sr},function(Tn){return tt=Tn,$=Tn(g),le=Tn(I),st=$===le?0:1/(le-$),Jr}}function Ks(g,I){return I.domain(g.domain()).interpolator(g.interpolator()).clamp(g.clamp()).unknown(g.unknown())}function Gu(){var g=Kn(Zr()(Gt));return g.copy=function(){return Ks(g,Gu())},kt.apply(g,arguments)}function Js(){var g=loggish(Zr()).domain([1,10]);return g.copy=function(){return Ks(g,Js()).base(g.base())},initInterpolator.apply(g,arguments)}function ua(){var g=symlogish(Zr());return g.copy=function(){return Ks(g,ua()).constant(g.constant())},initInterpolator.apply(g,arguments)}function ko(){var g=powish(Zr());return g.copy=function(){return Ks(g,ko()).exponent(g.exponent())},initInterpolator.apply(g,arguments)}function cl(){return ko.apply(null,arguments).exponent(.5)}function Cs(){var g=[],I=identity;function $(le){if(!isNaN(le=+le))return I((bisect(g,le)-1)/(g.length-1))}return $.domain=function(le){if(!arguments.length)return g.slice();g=[];for(var st=0,tt=le.length,_t;st<tt;++st)_t=le[st],_t!=null&&!isNaN(_t=+_t)&&g.push(_t);return g.sort(ascending),$},$.interpolator=function(le){return arguments.length?(I=le,$):I},$.copy=function(){return Cs(I).domain(g)},initInterpolator.apply($,arguments)}function lo(){var g=0,I=.5,$=1,le,st,tt,_t,Xt,sr=Gt,Jr,Tn=!1,tr;function or(jn){return isNaN(jn=+jn)?tr:(jn=.5+((jn=+Jr(jn))-st)*(jn<st?_t:Xt),sr(Tn?Math.max(0,Math.min(1,jn)):jn))}return or.domain=function(jn){return arguments.length?(le=Jr(g=+jn[0]),st=Jr(I=+jn[1]),tt=Jr($=+jn[2]),_t=le===st?0:.5/(st-le),Xt=st===tt?0:.5/(tt-st),or):[g,I,$]},or.clamp=function(jn){return arguments.length?(Tn=!!jn,or):Tn},or.interpolator=function(jn){return arguments.length?(sr=jn,or):sr},or.unknown=function(jn){return arguments.length?(tr=jn,or):tr},function(jn){return Jr=jn,le=jn(g),st=jn(I),tt=jn($),_t=le===st?0:.5/(st-le),Xt=st===tt?0:.5/(tt-st),or}}function fs(){var g=Kn(lo()(Gt));return g.copy=function(){return Ks(g,fs())},kt.apply(g,arguments)}function $l(){var g=loggish(lo()).domain([.1,1,10]);return g.copy=function(){return copy(g,$l()).base(g.base())},initInterpolator.apply(g,arguments)}function ju(){var g=symlogish(lo());return g.copy=function(){return copy(g,ju()).constant(g.constant())},initInterpolator.apply(g,arguments)}function hl(){var g=powish(lo());return g.copy=function(){return copy(g,hl()).exponent(g.exponent())},initInterpolator.apply(g,arguments)}function Ql(){return hl.apply(null,arguments).exponent(.5)}},9187:function(ci){"use strict";ci.exports=mn,ci.exports.default=mn;function mn(P,U,B){B=B||2;var E=U&&U.length,D=E?U[0]*B:P.length,q=ot(P,0,D,B,!0),Q=[];if(!q||q.next===q.prev)return Q;var Ae,ct,ke,He,We,xt,jt;if(E&&(q=Le(P,U,q,B)),P.length>80*B){Ae=ke=P[0],ct=He=P[1];for(var Gt=B;Gt<D;Gt+=B)We=P[Gt],xt=P[Gt+1],We<Ae&&(Ae=We),xt<ct&&(ct=xt),We>ke&&(ke=We),xt>He&&(He=xt);jt=Math.max(ke-Ae,He-ct),jt=jt!==0?32767/jt:0}return Ze(q,Q,B,Ae,ct,jt,0),Q}function ot(P,U,B,E,D){var q,Q;if(D===pe(P,U,B,E)>0)for(q=U;q<B;q+=E)Q=ze(q,P[q],P[q+1],Q);else for(q=B-E;q>=U;q-=E)Q=ze(q,P[q],P[q+1],Q);return Q&&kt(Q,Q.next)&&(Qt(Q),Q=Q.next),Q}function vt(P,U){if(!P)return P;U||(U=P);var B=P,E;do if(E=!1,!B.steiner&&(kt(B,B.next)||vr(B.prev,B,B.next)===0)){if(Qt(B),B=U=B.prev,B===B.next)break;E=!0}else B=B.next;while(E||B!==U);return U}function Ze(P,U,B,E,D,q,Q){if(!!P){!Q&&q&&dr(P,E,D,q);for(var Ae=P,ct,ke;P.prev!==P.next;){if(ct=P.prev,ke=P.next,q?Vt(P,E,D,q):l(P)){U.push(ct.i/B|0),U.push(P.i/B|0),U.push(ke.i/B|0),Qt(P),P=ke.next,Ae=ke.next;continue}if(P=ke,P===Ae){Q?Q===1?(P=ge(vt(P),U,B),Ze(P,U,B,E,D,q,2)):Q===2&&Mt(P,U,B,E,D,q):Ze(vt(P),U,B,E,D,q,1);break}}}}function l(P){var U=P.prev,B=P,E=P.next;if(vr(U,B,E)>=0)return!1;for(var D=U.x,q=B.x,Q=E.x,Ae=U.y,ct=B.y,ke=E.y,He=D<q?D<Q?D:Q:q<Q?q:Q,We=Ae<ct?Ae<ke?Ae:ke:ct<ke?ct:ke,xt=D>q?D>Q?D:Q:q>Q?q:Q,jt=Ae>ct?Ae>ke?Ae:ke:ct>ke?ct:ke,Gt=E.next;Gt!==U;){if(Gt.x>=He&&Gt.x<=xt&&Gt.y>=We&&Gt.y<=jt&&fr(D,Ae,q,ct,Q,ke,Gt.x,Gt.y)&&vr(Gt.prev,Gt,Gt.next)>=0)return!1;Gt=Gt.next}return!0}function Vt(P,U,B,E){var D=P.prev,q=P,Q=P.next;if(vr(D,q,Q)>=0)return!1;for(var Ae=D.x,ct=q.x,ke=Q.x,He=D.y,We=q.y,xt=Q.y,jt=Ae<ct?Ae<ke?Ae:ke:ct<ke?ct:ke,Gt=He<We?He<xt?He:xt:We<xt?We:xt,Rt=Ae>ct?Ae>ke?Ae:ke:ct>ke?ct:ke,Ar=He>We?He>xt?He:xt:We>xt?We:xt,Gr=Er(jt,Gt,U,B,E),er=Er(Rt,Ar,U,B,E),$e=P.prevZ,rt=P.nextZ;$e&&$e.z>=Gr&&rt&&rt.z<=er;){if($e.x>=jt&&$e.x<=Rt&&$e.y>=Gt&&$e.y<=Ar&&$e!==D&&$e!==Q&&fr(Ae,He,ct,We,ke,xt,$e.x,$e.y)&&vr($e.prev,$e,$e.next)>=0||($e=$e.prevZ,rt.x>=jt&&rt.x<=Rt&&rt.y>=Gt&&rt.y<=Ar&&rt!==D&&rt!==Q&&fr(Ae,He,ct,We,ke,xt,rt.x,rt.y)&&vr(rt.prev,rt,rt.next)>=0))return!1;rt=rt.nextZ}for(;$e&&$e.z>=Gr;){if($e.x>=jt&&$e.x<=Rt&&$e.y>=Gt&&$e.y<=Ar&&$e!==D&&$e!==Q&&fr(Ae,He,ct,We,ke,xt,$e.x,$e.y)&&vr($e.prev,$e,$e.next)>=0)return!1;$e=$e.prevZ}for(;rt&&rt.z<=er;){if(rt.x>=jt&&rt.x<=Rt&&rt.y>=Gt&&rt.y<=Ar&&rt!==D&&rt!==Q&&fr(Ae,He,ct,We,ke,xt,rt.x,rt.y)&&vr(rt.prev,rt,rt.next)>=0)return!1;rt=rt.nextZ}return!0}function ge(P,U,B){var E=P;do{var D=E.prev,q=E.next.next;!kt(D,q)&&mt(D,E,E.next,q)&&me(D,q)&&me(q,D)&&(U.push(D.i/B|0),U.push(E.i/B|0),U.push(q.i/B|0),Qt(E),Qt(E.next),E=P=q),E=E.next}while(E!==P);return vt(E)}function Mt(P,U,B,E,D,q){var Q=P;do{for(var Ae=Q.next.next;Ae!==Q.prev;){if(Q.i!==Ae.i&&Et(Q,Ae)){var ct=we(Q,Ae);Q=vt(Q,Q.next),ct=vt(ct,ct.next),Ze(Q,U,B,E,D,q,0),Ze(ct,U,B,E,D,q,0);return}Ae=Ae.next}Q=Q.next}while(Q!==P)}function Le(P,U,B,E){var D=[],q,Q,Ae,ct,ke;for(q=0,Q=U.length;q<Q;q++)Ae=U[q]*E,ct=q<Q-1?U[q+1]*E:P.length,ke=ot(P,Ae,ct,E,!1),ke===ke.next&&(ke.steiner=!0),D.push(wt(ke));for(D.sort(Tt),q=0;q<D.length;q++)B=Fe(D[q],B);return B}function Tt(P,U){return P.x-U.x}function Fe(P,U){var B=dt(P,U);if(!B)return U;var E=we(B,P);return vt(E,E.next),vt(B,B.next)}function dt(P,U){var B=U,E=P.x,D=P.y,q=-Infinity,Q;do{if(D<=B.y&&D>=B.next.y&&B.next.y!==B.y){var Ae=B.x+(D-B.y)*(B.next.x-B.x)/(B.next.y-B.y);if(Ae<=E&&Ae>q&&(q=Ae,Q=B.x<B.next.x?B:B.next,Ae===E))return Q}B=B.next}while(B!==U);if(!Q)return null;var ct=Q,ke=Q.x,He=Q.y,We=Infinity,xt;B=Q;do E>=B.x&&B.x>=ke&&E!==B.x&&fr(D<He?E:q,D,ke,He,D<He?q:E,D,B.x,B.y)&&(xt=Math.abs(D-B.y)/(E-B.x),me(B,P)&&(xt<We||xt===We&&(B.x>Q.x||B.x===Q.x&&nr(Q,B)))&&(Q=B,We=xt)),B=B.next;while(B!==ct);return Q}function nr(P,U){return vr(P.prev,P,U.prev)<0&&vr(U.next,P,P.next)<0}function dr(P,U,B,E){var D=P;do D.z===0&&(D.z=Er(D.x,D.y,U,B,E)),D.prevZ=D.prev,D.nextZ=D.next,D=D.next;while(D!==P);D.prevZ.nextZ=null,D.prevZ=null,Dt(D)}function Dt(P){var U,B,E,D,q,Q,Ae,ct,ke=1;do{for(B=P,P=null,q=null,Q=0;B;){for(Q++,E=B,Ae=0,U=0;U<ke&&(Ae++,E=E.nextZ,!!E);U++);for(ct=ke;Ae>0||ct>0&&E;)Ae!==0&&(ct===0||!E||B.z<=E.z)?(D=B,B=B.nextZ,Ae--):(D=E,E=E.nextZ,ct--),q?q.nextZ=D:P=D,D.prevZ=q,q=D;B=E}q.nextZ=null,ke*=2}while(Q>1);return P}function Er(P,U,B,E,D){return P=(P-B)*D|0,U=(U-E)*D|0,P=(P|P<<8)&16711935,P=(P|P<<4)&252645135,P=(P|P<<2)&858993459,P=(P|P<<1)&1431655765,U=(U|U<<8)&16711935,U=(U|U<<4)&252645135,U=(U|U<<2)&858993459,U=(U|U<<1)&1431655765,P|U<<1}function wt(P){var U=P,B=P;do(U.x<B.x||U.x===B.x&&U.y<B.y)&&(B=U),U=U.next;while(U!==P);return B}function fr(P,U,B,E,D,q,Q,Ae){return(D-Q)*(U-Ae)>=(P-Q)*(q-Ae)&&(P-Q)*(E-Ae)>=(B-Q)*(U-Ae)&&(B-Q)*(q-Ae)>=(D-Q)*(E-Ae)}function Et(P,U){return P.next.i!==U.i&&P.prev.i!==U.i&&!Se(P,U)&&(me(P,U)&&me(U,P)&&De(P,U)&&(vr(P.prev,P,U.prev)||vr(P,U.prev,U))||kt(P,U)&&vr(P.prev,P,P.next)>0&&vr(U.prev,U,U.next)>0)}function vr(P,U,B){return(U.y-P.y)*(B.x-U.x)-(U.x-P.x)*(B.y-U.y)}function kt(P,U){return P.x===U.x&&P.y===U.y}function mt(P,U,B,E){var D=Te(vr(P,U,B)),q=Te(vr(P,U,E)),Q=Te(vr(B,E,P)),Ae=Te(vr(B,E,U));return!!(D!==q&&Q!==Ae||D===0&&k(P,B,U)||q===0&&k(P,E,U)||Q===0&&k(B,P,E)||Ae===0&&k(B,U,E))}function k(P,U,B){return U.x<=Math.max(P.x,B.x)&&U.x>=Math.min(P.x,B.x)&&U.y<=Math.max(P.y,B.y)&&U.y>=Math.min(P.y,B.y)}function Te(P){return P>0?1:P<0?-1:0}function Se(P,U){var B=P;do{if(B.i!==P.i&&B.next.i!==P.i&&B.i!==U.i&&B.next.i!==U.i&&mt(B,B.next,P,U))return!0;B=B.next}while(B!==P);return!1}function me(P,U){return vr(P.prev,P,P.next)<0?vr(P,U,P.next)>=0&&vr(P,P.prev,U)>=0:vr(P,U,P.prev)<0||vr(P,P.next,U)<0}function De(P,U){var B=P,E=!1,D=(P.x+U.x)/2,q=(P.y+U.y)/2;do B.y>q!=B.next.y>q&&B.next.y!==B.y&&D<(B.next.x-B.x)*(q-B.y)/(B.next.y-B.y)+B.x&&(E=!E),B=B.next;while(B!==P);return E}function we(P,U){var B=new V(P.i,P.x,P.y),E=new V(U.i,U.x,U.y),D=P.next,q=U.prev;return P.next=U,U.prev=P,B.next=D,D.prev=B,E.next=B,B.prev=E,q.next=E,E.prev=q,E}function ze(P,U,B,E){var D=new V(P,U,B);return E?(D.next=E.next,D.prev=E,E.next.prev=D,E.next=D):(D.prev=D,D.next=D),D}function Qt(P){P.next.prev=P.prev,P.prev.next=P.next,P.prevZ&&(P.prevZ.nextZ=P.nextZ),P.nextZ&&(P.nextZ.prevZ=P.prevZ)}function V(P,U,B){this.i=P,this.x=U,this.y=B,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}mn.deviation=function(P,U,B,E){var D=U&&U.length,q=D?U[0]*B:P.length,Q=Math.abs(pe(P,0,q,B));if(D)for(var Ae=0,ct=U.length;Ae<ct;Ae++){var ke=U[Ae]*B,He=Ae<ct-1?U[Ae+1]*B:P.length;Q-=Math.abs(pe(P,ke,He,B))}var We=0;for(Ae=0;Ae<E.length;Ae+=3){var xt=E[Ae]*B,jt=E[Ae+1]*B,Gt=E[Ae+2]*B;We+=Math.abs((P[xt]-P[Gt])*(P[jt+1]-P[xt+1])-(P[xt]-P[jt])*(P[Gt+1]-P[xt+1]))}return Q===0&&We===0?0:Math.abs((We-Q)/Q)};function pe(P,U,B,E){for(var D=0,q=U,Q=B-E;q<B;q+=E)D+=(P[Q]-P[q])*(P[q+1]+P[Q+1]),Q=q;return D}mn.flatten=function(P){for(var U=P[0][0].length,B={vertices:[],holes:[],dimensions:U},E=0,D=0;D<P.length;D++){for(var q=0;q<P[D].length;q++)for(var Q=0;Q<U;Q++)B.vertices.push(P[D][q][Q]);D>0&&(E+=P[D-1].length,B.holes.push(E))}return B}},67709:function(ci){function mn(vt){var Ze=vt.target||vt.srcElement;Ze.__resizeRAF__&&cancelAnimationFrame(Ze.__resizeRAF__),Ze.__resizeRAF__=requestAnimationFrame(function(){var l=Ze.__resizeTrigger__,Vt=l&&l.__resizeListeners__;Vt&&Vt.forEach(function(ge){ge.call(l,vt)})})}var ot=function(Ze,l){var Vt=this,ge=Vt.document,Mt,Le=ge.attachEvent;typeof navigator!="undefined"&&(Mt=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function Tt(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",mn)}if(!Ze.__resizeListeners__)if(Ze.__resizeListeners__=[],Le)Ze.__resizeTrigger__=Ze,Ze.attachEvent("onresize",mn);else{getComputedStyle(Ze).position==="static"&&(Ze.style.position="relative");var Fe=Ze.__resizeTrigger__=ge.createElement("object");Fe.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),Fe.setAttribute("class","resize-sensor"),Fe.setAttribute("tabindex","-1"),Fe.setAttribute("title",""),Fe.__resizeElement__=Ze,Fe.onload=Tt,Fe.type="text/html",Mt&&Ze.appendChild(Fe),Fe.data="about:blank",Mt||Ze.appendChild(Fe)}Ze.__resizeListeners__.push(l)};ci.exports=typeof window=="undefined"?ot:ot.bind(window),ci.exports.unbind=function(vt,Ze){var l=document.attachEvent,Vt=vt.__resizeListeners__||[];if(Ze){var ge=Vt.indexOf(Ze);ge!==-1&&Vt.splice(ge,1)}else Vt=vt.__resizeListeners__=[];if(!Vt.length){if(l)vt.detachEvent("onresize",mn);else if(vt.__resizeTrigger__){var Mt=vt.__resizeTrigger__.contentDocument,Le=Mt&&Mt.defaultView;Le&&(Le.removeEventListener("resize",mn),delete Le.__resizeTrigger__),vt.__resizeTrigger__=!vt.removeChild(vt.__resizeTrigger__)}delete vt.__resizeListeners__}}},26729:function(ci){"use strict";var mn=Object.prototype.hasOwnProperty,ot="~";function vt(){}Object.create&&(vt.prototype=Object.create(null),new vt().__proto__||(ot=!1));function Ze(Mt,Le,Tt){this.fn=Mt,this.context=Le,this.once=Tt||!1}function l(Mt,Le,Tt,Fe,dt){if(typeof Tt!="function")throw new TypeError("The listener must be a function");var nr=new Ze(Tt,Fe||Mt,dt),dr=ot?ot+Le:Le;return Mt._events[dr]?Mt._events[dr].fn?Mt._events[dr]=[Mt._events[dr],nr]:Mt._events[dr].push(nr):(Mt._events[dr]=nr,Mt._eventsCount++),Mt}function Vt(Mt,Le){--Mt._eventsCount==0?Mt._events=new vt:delete Mt._events[Le]}function ge(){this._events=new vt,this._eventsCount=0}ge.prototype.eventNames=function(){var Le=[],Tt,Fe;if(this._eventsCount===0)return Le;for(Fe in Tt=this._events)mn.call(Tt,Fe)&&Le.push(ot?Fe.slice(1):Fe);return Object.getOwnPropertySymbols?Le.concat(Object.getOwnPropertySymbols(Tt)):Le},ge.prototype.listeners=function(Le){var Tt=ot?ot+Le:Le,Fe=this._events[Tt];if(!Fe)return[];if(Fe.fn)return[Fe.fn];for(var dt=0,nr=Fe.length,dr=new Array(nr);dt<nr;dt++)dr[dt]=Fe[dt].fn;return dr},ge.prototype.listenerCount=function(Le){var Tt=ot?ot+Le:Le,Fe=this._events[Tt];return Fe?Fe.fn?1:Fe.length:0},ge.prototype.emit=function(Le,Tt,Fe,dt,nr,dr){var Dt=ot?ot+Le:Le;if(!this._events[Dt])return!1;var Er=this._events[Dt],wt=arguments.length,fr,Et;if(Er.fn){switch(Er.once&&this.removeListener(Le,Er.fn,void 0,!0),wt){case 1:return Er.fn.call(Er.context),!0;case 2:return Er.fn.call(Er.context,Tt),!0;case 3:return Er.fn.call(Er.context,Tt,Fe),!0;case 4:return Er.fn.call(Er.context,Tt,Fe,dt),!0;case 5:return Er.fn.call(Er.context,Tt,Fe,dt,nr),!0;case 6:return Er.fn.call(Er.context,Tt,Fe,dt,nr,dr),!0}for(Et=1,fr=new Array(wt-1);Et<wt;Et++)fr[Et-1]=arguments[Et];Er.fn.apply(Er.context,fr)}else{var vr=Er.length,kt;for(Et=0;Et<vr;Et++)switch(Er[Et].once&&this.removeListener(Le,Er[Et].fn,void 0,!0),wt){case 1:Er[Et].fn.call(Er[Et].context);break;case 2:Er[Et].fn.call(Er[Et].context,Tt);break;case 3:Er[Et].fn.call(Er[Et].context,Tt,Fe);break;case 4:Er[Et].fn.call(Er[Et].context,Tt,Fe,dt);break;default:if(!fr)for(kt=1,fr=new Array(wt-1);kt<wt;kt++)fr[kt-1]=arguments[kt];Er[Et].fn.apply(Er[Et].context,fr)}}return!0},ge.prototype.on=function(Le,Tt,Fe){return l(this,Le,Tt,Fe,!1)},ge.prototype.once=function(Le,Tt,Fe){return l(this,Le,Tt,Fe,!0)},ge.prototype.removeListener=function(Le,Tt,Fe,dt){var nr=ot?ot+Le:Le;if(!this._events[nr])return this;if(!Tt)return Vt(this,nr),this;var dr=this._events[nr];if(dr.fn)dr.fn===Tt&&(!dt||dr.once)&&(!Fe||dr.context===Fe)&&Vt(this,nr);else{for(var Dt=0,Er=[],wt=dr.length;Dt<wt;Dt++)(dr[Dt].fn!==Tt||dt&&!dr[Dt].once||Fe&&dr[Dt].context!==Fe)&&Er.push(dr[Dt]);Er.length?this._events[nr]=Er.length===1?Er[0]:Er:Vt(this,nr)}return this},ge.prototype.removeAllListeners=function(Le){var Tt;return Le?(Tt=ot?ot+Le:Le,this._events[Tt]&&Vt(this,Tt)):(this._events=new vt,this._eventsCount=0),this},ge.prototype.off=ge.prototype.removeListener,ge.prototype.addListener=ge.prototype.on,ge.prefixed=ot,ge.EventEmitter=ge,ci.exports=ge},98592:function(ci,mn,ot){"use strict";ot.d(mn,{Z:function(){return pe}});function vt(E,D,q,Q){for(var Ae=Q,ct=q-D>>1,ke=q-D,He,We=E[D],xt=E[D+1],jt=E[q],Gt=E[q+1],Rt=D+3;Rt<q;Rt+=3){var Ar=Ze(E[Rt],E[Rt+1],We,xt,jt,Gt);if(Ar>Ae)He=Rt,Ae=Ar;else if(Ar===Ae){var Gr=Math.abs(Rt-ct);Gr<ke&&(He=Rt,ke=Gr)}}Ae>Q&&(He-D>3&&vt(E,D,He,Q),E[He+2]=Ae,q-He>3&&vt(E,He,q,Q))}function Ze(E,D,q,Q,Ae,ct){var ke=Ae-q,He=ct-Q;if(ke!==0||He!==0){var We=((E-q)*ke+(D-Q)*He)/(ke*ke+He*He);We>1?(q=Ae,Q=ct):We>0&&(q+=ke*We,Q+=He*We)}return ke=E-q,He=D-Q,ke*ke+He*He}function l(E,D,q,Q){var Ae={id:typeof E=="undefined"?null:E,type:D,geometry:q,tags:Q,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity};return Vt(Ae),Ae}function Vt(E){var D=E.geometry,q=E.type;if(q==="Point"||q==="MultiPoint"||q==="LineString")ge(E,D);else if(q==="Polygon"||q==="MultiLineString")for(var Q=0;Q<D.length;Q++)ge(E,D[Q]);else if(q==="MultiPolygon")for(Q=0;Q<D.length;Q++)for(var Ae=0;Ae<D[Q].length;Ae++)ge(E,D[Q][Ae])}function ge(E,D){for(var q=0;q<D.length;q+=3)E.minX=Math.min(E.minX,D[q]),E.minY=Math.min(E.minY,D[q+1]),E.maxX=Math.max(E.maxX,D[q]),E.maxY=Math.max(E.maxY,D[q+1])}function Mt(E,D){var q=[];if(E.type==="FeatureCollection")for(var Q=0;Q<E.features.length;Q++)Le(q,E.features[Q],D,Q);else E.type==="Feature"?Le(q,E,D):Le(q,{geometry:E},D);return q}function Le(E,D,q,Q){if(!!D.geometry){var Ae=D.geometry.coordinates,ct=D.geometry.type,ke=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2),He=[],We=D.id;if(q.promoteId?We=D.properties[q.promoteId]:q.generateId&&(We=Q||0),ct==="Point")Tt(Ae,He);else if(ct==="MultiPoint")for(var xt=0;xt<Ae.length;xt++)Tt(Ae[xt],He);else if(ct==="LineString")Fe(Ae,He,ke,!1);else if(ct==="MultiLineString")if(q.lineMetrics){for(xt=0;xt<Ae.length;xt++)He=[],Fe(Ae[xt],He,ke,!1),E.push(l(We,"LineString",He,D.properties));return}else dt(Ae,He,ke,!1);else if(ct==="Polygon")dt(Ae,He,ke,!0);else if(ct==="MultiPolygon")for(xt=0;xt<Ae.length;xt++){var jt=[];dt(Ae[xt],jt,ke,!0),He.push(jt)}else if(ct==="GeometryCollection"){for(xt=0;xt<D.geometry.geometries.length;xt++)Le(E,{id:We,geometry:D.geometry.geometries[xt],properties:D.properties},q,Q);return}else throw new Error("Input data is not a valid GeoJSON object.");E.push(l(We,ct,He,D.properties))}}function Tt(E,D){D.push(nr(E[0])),D.push(dr(E[1])),D.push(0)}function Fe(E,D,q,Q){for(var Ae,ct,ke=0,He=0;He<E.length;He++){var We=nr(E[He][0]),xt=dr(E[He][1]);D.push(We),D.push(xt),D.push(0),He>0&&(Q?ke+=(Ae*xt-We*ct)/2:ke+=Math.sqrt(Math.pow(We-Ae,2)+Math.pow(xt-ct,2))),Ae=We,ct=xt}var jt=D.length-3;D[2]=1,vt(D,0,jt,q),D[jt+2]=1,D.size=Math.abs(ke),D.start=0,D.end=D.size}function dt(E,D,q,Q){for(var Ae=0;Ae<E.length;Ae++){var ct=[];Fe(E[Ae],ct,q,Q),D.push(ct)}}function nr(E){return E/360+.5}function dr(E){var D=Math.sin(E*Math.PI/180),q=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return q<0?0:q>1?1:q}function Dt(E,D,q,Q,Ae,ct,ke,He){if(q/=D,Q/=D,ct>=q&&ke<Q)return E;if(ke<q||ct>=Q)return null;for(var We=[],xt=0;xt<E.length;xt++){var jt=E[xt],Gt=jt.geometry,Rt=jt.type,Ar=Ae===0?jt.minX:jt.minY,Gr=Ae===0?jt.maxX:jt.maxY;if(Ar>=q&&Gr<Q){We.push(jt);continue}else if(Gr<q||Ar>=Q)continue;var er=[];if(Rt==="Point"||Rt==="MultiPoint")Er(Gt,er,q,Q,Ae);else if(Rt==="LineString")wt(Gt,er,q,Q,Ae,!1,He.lineMetrics);else if(Rt==="MultiLineString")Et(Gt,er,q,Q,Ae,!1);else if(Rt==="Polygon")Et(Gt,er,q,Q,Ae,!0);else if(Rt==="MultiPolygon")for(var $e=0;$e<Gt.length;$e++){var rt=[];Et(Gt[$e],rt,q,Q,Ae,!0),rt.length&&er.push(rt)}if(er.length){if(He.lineMetrics&&Rt==="LineString"){for($e=0;$e<er.length;$e++)We.push(l(jt.id,Rt,er[$e],jt.tags));continue}(Rt==="LineString"||Rt==="MultiLineString")&&(er.length===1?(Rt="LineString",er=er[0]):Rt="MultiLineString"),(Rt==="Point"||Rt==="MultiPoint")&&(Rt=er.length===3?"Point":"MultiPoint"),We.push(l(jt.id,Rt,er,jt.tags))}}return We.length?We:null}function Er(E,D,q,Q,Ae){for(var ct=0;ct<E.length;ct+=3){var ke=E[ct+Ae];ke>=q&&ke<=Q&&(D.push(E[ct]),D.push(E[ct+1]),D.push(E[ct+2]))}}function wt(E,D,q,Q,Ae,ct,ke){for(var He=fr(E),We=Ae===0?kt:mt,xt=E.start,jt,Gt,Rt=0;Rt<E.length-3;Rt+=3){var Ar=E[Rt],Gr=E[Rt+1],er=E[Rt+2],$e=E[Rt+3],rt=E[Rt+4],Wt=Ae===0?Ar:Gr,Kt=Ae===0?$e:rt,ur=!1;ke&&(jt=Math.sqrt(Math.pow(Ar-$e,2)+Math.pow(Gr-rt,2))),Wt<q?Kt>q&&(Gt=We(He,Ar,Gr,$e,rt,q),ke&&(He.start=xt+jt*Gt)):Wt>Q?Kt<Q&&(Gt=We(He,Ar,Gr,$e,rt,Q),ke&&(He.start=xt+jt*Gt)):vr(He,Ar,Gr,er),Kt<q&&Wt>=q&&(Gt=We(He,Ar,Gr,$e,rt,q),ur=!0),Kt>Q&&Wt<=Q&&(Gt=We(He,Ar,Gr,$e,rt,Q),ur=!0),!ct&&ur&&(ke&&(He.end=xt+jt*Gt),D.push(He),He=fr(E)),ke&&(xt+=jt)}var ae=E.length-3;Ar=E[ae],Gr=E[ae+1],er=E[ae+2],Wt=Ae===0?Ar:Gr,Wt>=q&&Wt<=Q&&vr(He,Ar,Gr,er),ae=He.length-3,ct&&ae>=3&&(He[ae]!==He[0]||He[ae+1]!==He[1])&&vr(He,He[0],He[1],He[2]),He.length&&D.push(He)}function fr(E){var D=[];return D.size=E.size,D.start=E.start,D.end=E.end,D}function Et(E,D,q,Q,Ae,ct){for(var ke=0;ke<E.length;ke++)wt(E[ke],D,q,Q,Ae,ct,!1)}function vr(E,D,q,Q){E.push(D),E.push(q),E.push(Q)}function kt(E,D,q,Q,Ae,ct){var ke=(ct-D)/(Q-D);return E.push(ct),E.push(q+(Ae-q)*ke),E.push(1),ke}function mt(E,D,q,Q,Ae,ct){var ke=(ct-q)/(Ae-q);return E.push(D+(Q-D)*ke),E.push(ct),E.push(1),ke}function k(E,D){var q=D.buffer/D.extent,Q=E,Ae=Dt(E,1,-1-q,q,0,-1,2,D),ct=Dt(E,1,1-q,2+q,0,-1,2,D);return(Ae||ct)&&(Q=Dt(E,1,-q,1+q,0,-1,2,D)||[],Ae&&(Q=Te(Ae,1).concat(Q)),ct&&(Q=Q.concat(Te(ct,-1)))),Q}function Te(E,D){for(var q=[],Q=0;Q<E.length;Q++){var Ae=E[Q],ct=Ae.type,ke;if(ct==="Point"||ct==="MultiPoint"||ct==="LineString")ke=Se(Ae.geometry,D);else if(ct==="MultiLineString"||ct==="Polygon"){ke=[];for(var He=0;He<Ae.geometry.length;He++)ke.push(Se(Ae.geometry[He],D))}else if(ct==="MultiPolygon")for(ke=[],He=0;He<Ae.geometry.length;He++){for(var We=[],xt=0;xt<Ae.geometry[He].length;xt++)We.push(Se(Ae.geometry[He][xt],D));ke.push(We)}q.push(l(Ae.id,ct,ke,Ae.tags))}return q}function Se(E,D){var q=[];q.size=E.size,E.start!==void 0&&(q.start=E.start,q.end=E.end);for(var Q=0;Q<E.length;Q+=3)q.push(E[Q]+D,E[Q+1],E[Q+2]);return q}function me(E,D){if(E.transformed)return E;var q=1<<E.z,Q=E.x,Ae=E.y,ct,ke,He;for(ct=0;ct<E.features.length;ct++){var We=E.features[ct],xt=We.geometry,jt=We.type;if(We.geometry=[],jt===1)for(ke=0;ke<xt.length;ke+=2)We.geometry.push(De(xt[ke],xt[ke+1],D,q,Q,Ae));else for(ke=0;ke<xt.length;ke++){var Gt=[];for(He=0;He<xt[ke].length;He+=2)Gt.push(De(xt[ke][He],xt[ke][He+1],D,q,Q,Ae));We.geometry.push(Gt)}}return E.transformed=!0,E}function De(E,D,q,Q,Ae,ct){return[Math.round(q*(E*Q-Ae)),Math.round(q*(D*Q-ct))]}function we(E,D,q,Q,Ae){for(var ct=D===Ae.maxZoom?0:Ae.tolerance/((1<<D)*Ae.extent),ke={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:q,y:Q,z:D,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},He=0;He<E.length;He++){ke.numFeatures++,ze(ke,E[He],ct,Ae);var We=E[He].minX,xt=E[He].minY,jt=E[He].maxX,Gt=E[He].maxY;We<ke.minX&&(ke.minX=We),xt<ke.minY&&(ke.minY=xt),jt>ke.maxX&&(ke.maxX=jt),Gt>ke.maxY&&(ke.maxY=Gt)}return ke}function ze(E,D,q,Q){var Ae=D.geometry,ct=D.type,ke=[];if(ct==="Point"||ct==="MultiPoint")for(var He=0;He<Ae.length;He+=3)ke.push(Ae[He]),ke.push(Ae[He+1]),E.numPoints++,E.numSimplified++;else if(ct==="LineString")Qt(ke,Ae,E,q,!1,!1);else if(ct==="MultiLineString"||ct==="Polygon")for(He=0;He<Ae.length;He++)Qt(ke,Ae[He],E,q,ct==="Polygon",He===0);else if(ct==="MultiPolygon")for(var We=0;We<Ae.length;We++){var xt=Ae[We];for(He=0;He<xt.length;He++)Qt(ke,xt[He],E,q,!0,He===0)}if(ke.length){var jt=D.tags||null;if(ct==="LineString"&&Q.lineMetrics){jt={};for(var Gt in D.tags)jt[Gt]=D.tags[Gt];jt.mapbox_clip_start=Ae.start/Ae.size,jt.mapbox_clip_end=Ae.end/Ae.size}var Rt={geometry:ke,type:ct==="Polygon"||ct==="MultiPolygon"?3:ct==="LineString"||ct==="MultiLineString"?2:1,tags:jt};D.id!==null&&(Rt.id=D.id),E.features.push(Rt)}}function Qt(E,D,q,Q,Ae,ct){var ke=Q*Q;if(Q>0&&D.size<(Ae?ke:Q)){q.numPoints+=D.length/3;return}for(var He=[],We=0;We<D.length;We+=3)(Q===0||D[We+2]>ke)&&(q.numSimplified++,He.push(D[We]),He.push(D[We+1])),q.numPoints++;Ae&&V(He,ct),E.push(He)}function V(E,D){for(var q=0,Q=0,Ae=E.length,ct=Ae-2;Q<Ae;ct=Q,Q+=2)q+=(E[Q]-E[ct])*(E[Q+1]+E[ct+1]);if(q>0===D)for(Q=0,Ae=E.length;Q<Ae/2;Q+=2){var ke=E[Q],He=E[Q+1];E[Q]=E[Ae-2-Q],E[Q+1]=E[Ae-1-Q],E[Ae-2-Q]=ke,E[Ae-1-Q]=He}}function pe(E,D){return new P(E,D)}function P(E,D){D=this.options=B(Object.create(this.options),D);var q=D.debug;if(q&&console.time("preprocess data"),D.maxZoom<0||D.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(D.promoteId&&D.generateId)throw new Error("promoteId and generateId cannot be used together.");var Q=Mt(E,D);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",D.indexMaxZoom,D.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Q=k(Q,D),Q.length&&this.splitTile(Q,0,0,0),q&&(Q.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}P.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},P.prototype.splitTile=function(E,D,q,Q,Ae,ct,ke){for(var He=[E,D,q,Q],We=this.options,xt=We.debug;He.length;){Q=He.pop(),q=He.pop(),D=He.pop(),E=He.pop();var jt=1<<D,Gt=U(D,q,Q),Rt=this.tiles[Gt];if(!Rt&&(xt>1&&console.time("creation"),Rt=this.tiles[Gt]=we(E,D,q,Q,We),this.tileCoords.push({z:D,x:q,y:Q}),xt)){xt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",D,q,Q,Rt.numFeatures,Rt.numPoints,Rt.numSimplified),console.timeEnd("creation"));var Ar="z"+D;this.stats[Ar]=(this.stats[Ar]||0)+1,this.total++}if(Rt.source=E,Ae){if(D===We.maxZoom||D===Ae)continue;var Gr=1<<Ae-D;if(q!==Math.floor(ct/Gr)||Q!==Math.floor(ke/Gr))continue}else if(D===We.indexMaxZoom||Rt.numPoints<=We.indexMaxPoints)continue;if(Rt.source=null,E.length!==0){xt>1&&console.time("clipping");var er=.5*We.buffer/We.extent,$e=.5-er,rt=.5+er,Wt=1+er,Kt,ur,ae,z,R,j;Kt=ur=ae=z=null,R=Dt(E,jt,q-er,q+rt,0,Rt.minX,Rt.maxX,We),j=Dt(E,jt,q+$e,q+Wt,0,Rt.minX,Rt.maxX,We),E=null,R&&(Kt=Dt(R,jt,Q-er,Q+rt,1,Rt.minY,Rt.maxY,We),ur=Dt(R,jt,Q+$e,Q+Wt,1,Rt.minY,Rt.maxY,We),R=null),j&&(ae=Dt(j,jt,Q-er,Q+rt,1,Rt.minY,Rt.maxY,We),z=Dt(j,jt,Q+$e,Q+Wt,1,Rt.minY,Rt.maxY,We),j=null),xt>1&&console.timeEnd("clipping"),He.push(Kt||[],D+1,q*2,Q*2),He.push(ur||[],D+1,q*2,Q*2+1),He.push(ae||[],D+1,q*2+1,Q*2),He.push(z||[],D+1,q*2+1,Q*2+1)}}},P.prototype.getTile=function(E,D,q){var Q=this.options,Ae=Q.extent,ct=Q.debug;if(E<0||E>24)return null;var ke=1<<E;D=(D%ke+ke)%ke;var He=U(E,D,q);if(this.tiles[He])return me(this.tiles[He],Ae);ct>1&&console.log("drilling down to z%d-%d-%d",E,D,q);for(var We=E,xt=D,jt=q,Gt;!Gt&&We>0;)We--,xt=Math.floor(xt/2),jt=Math.floor(jt/2),Gt=this.tiles[U(We,xt,jt)];return!Gt||!Gt.source?null:(ct>1&&console.log("found parent tile z%d-%d-%d",We,xt,jt),ct>1&&console.time("drilling down"),this.splitTile(Gt.source,We,xt,jt,E,D,q),ct>1&&console.timeEnd("drilling down"),this.tiles[He]?me(this.tiles[He],Ae):null)};function U(E,D,q){return((1<<E)*q+D)*32+E}function B(E,D){for(var q in D)E[q]=D[q];return E}},80645:function(ci,mn){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */mn.read=function(ot,vt,Ze,l,Vt){var ge,Mt,Le=Vt*8-l-1,Tt=(1<<Le)-1,Fe=Tt>>1,dt=-7,nr=Ze?Vt-1:0,dr=Ze?-1:1,Dt=ot[vt+nr];for(nr+=dr,ge=Dt&(1<<-dt)-1,Dt>>=-dt,dt+=Le;dt>0;ge=ge*256+ot[vt+nr],nr+=dr,dt-=8);for(Mt=ge&(1<<-dt)-1,ge>>=-dt,dt+=l;dt>0;Mt=Mt*256+ot[vt+nr],nr+=dr,dt-=8);if(ge===0)ge=1-Fe;else{if(ge===Tt)return Mt?NaN:(Dt?-1:1)*Infinity;Mt=Mt+Math.pow(2,l),ge=ge-Fe}return(Dt?-1:1)*Mt*Math.pow(2,ge-l)},mn.write=function(ot,vt,Ze,l,Vt,ge){var Mt,Le,Tt,Fe=ge*8-Vt-1,dt=(1<<Fe)-1,nr=dt>>1,dr=Vt===23?Math.pow(2,-24)-Math.pow(2,-77):0,Dt=l?0:ge-1,Er=l?1:-1,wt=vt<0||vt===0&&1/vt<0?1:0;for(vt=Math.abs(vt),isNaN(vt)||vt===Infinity?(Le=isNaN(vt)?1:0,Mt=dt):(Mt=Math.floor(Math.log(vt)/Math.LN2),vt*(Tt=Math.pow(2,-Mt))<1&&(Mt--,Tt*=2),Mt+nr>=1?vt+=dr/Tt:vt+=dr*Math.pow(2,1-nr),vt*Tt>=2&&(Mt++,Tt/=2),Mt+nr>=dt?(Le=0,Mt=dt):Mt+nr>=1?(Le=(vt*Tt-1)*Math.pow(2,Vt),Mt=Mt+nr):(Le=vt*Math.pow(2,nr-1)*Math.pow(2,Vt),Mt=0));Vt>=8;ot[Ze+Dt]=Le&255,Dt+=Er,Le/=256,Vt-=8);for(Mt=Mt<<Vt|Le,Fe+=Vt;Fe>0;ot[Ze+Dt]=Mt&255,Dt+=Er,Mt/=256,Fe-=8);ot[Ze+Dt-Er]|=wt*128}},18857:function(ci,mn,ot){"use strict";ot.r(mn),ot.d(mn,{Function:function(){return cs},Interpreter:function(){return qa},default:function(){return Us},evaluate:function(){return uu},vm:function(){return vt}});var vt={};ot.r(vt),ot.d(vt,{Script:function(){return wu},compileFunction:function(){return Ju},createContext:function(){return Bu},runInContext:function(){return su},runInNewContext:function(){return $u}});var Ze={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},l="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",Vt={5:l,"5module":l+" export import",6:l+" const class extends export import super"},ge=/^in(stanceof)?$/,Mt="\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC",Le="\u200C\u200D\xB7\u0300-\u036F\u0387\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u0669\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u06F0-\u06F9\u0711\u0730-\u074A\u07A6-\u07B0\u07C0-\u07C9\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0966-\u096F\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09E6-\u09EF\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A66-\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AE6-\u0AEF\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B66-\u0B6F\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0BE6-\u0BEF\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CE6-\u0CEF\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D66-\u0D6F\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0E50-\u0E59\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECD\u0ED0-\u0ED9\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1040-\u1049\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F-\u109D\u135D-\u135F\u1369-\u1371\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u18A9\u1920-\u192B\u1930-\u193B\u1946-\u194F\u19D0-\u19DA\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AB0-\u1ABD\u1ABF\u1AC0\u1B00-\u1B04\u1B34-\u1B44\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BB0-\u1BB9\u1BE6-\u1BF3\u1C24-\u1C37\u1C40-\u1C49\u1C50-\u1C59\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u203F\u2040\u2054\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA620-\uA629\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F1\uA8FF-\uA909\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9D0-\uA9D9\uA9E5\uA9F0-\uA9F9\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA50-\uAA59\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uABF0-\uABF9\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFF10-\uFF19\uFF3F",Tt=new RegExp("["+Mt+"]"),Fe=new RegExp("["+Mt+Le+"]");Mt=Le=null;var dt=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],nr=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function dr(c,m){for(var S=65536,_=0;_<m.length;_+=2){if(S+=m[_],S>c)return!1;if(S+=m[_+1],S>=c)return!0}}function Dt(c,m){return c<65?c===36:c<91?!0:c<97?c===95:c<123?!0:c<=65535?c>=170&&Tt.test(String.fromCharCode(c)):m===!1?!1:dr(c,dt)}function Er(c,m){return c<48?c===36:c<58?!0:c<65?!1:c<91?!0:c<97?c===95:c<123?!0:c<=65535?c>=170&&Fe.test(String.fromCharCode(c)):m===!1?!1:dr(c,dt)||dr(c,nr)}var wt=function(m,S){S===void 0&&(S={}),this.label=m,this.keyword=S.keyword,this.beforeExpr=!!S.beforeExpr,this.startsExpr=!!S.startsExpr,this.isLoop=!!S.isLoop,this.isAssign=!!S.isAssign,this.prefix=!!S.prefix,this.postfix=!!S.postfix,this.binop=S.binop||null,this.updateContext=null};function fr(c,m){return new wt(c,{beforeExpr:!0,binop:m})}var Et={beforeExpr:!0},vr={startsExpr:!0},kt={};function mt(c,m){return m===void 0&&(m={}),m.keyword=c,kt[c]=new wt(c,m)}var k={num:new wt("num",vr),regexp:new wt("regexp",vr),string:new wt("string",vr),name:new wt("name",vr),eof:new wt("eof"),bracketL:new wt("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new wt("]"),braceL:new wt("{",{beforeExpr:!0,startsExpr:!0}),braceR:new wt("}"),parenL:new wt("(",{beforeExpr:!0,startsExpr:!0}),parenR:new wt(")"),comma:new wt(",",Et),semi:new wt(";",Et),colon:new wt(":",Et),dot:new wt("."),question:new wt("?",Et),questionDot:new wt("?."),arrow:new wt("=>",Et),template:new wt("template"),invalidTemplate:new wt("invalidTemplate"),ellipsis:new wt("...",Et),backQuote:new wt("`",vr),dollarBraceL:new wt("${",{beforeExpr:!0,startsExpr:!0}),eq:new wt("=",{beforeExpr:!0,isAssign:!0}),assign:new wt("_=",{beforeExpr:!0,isAssign:!0}),incDec:new wt("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new wt("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:fr("||",1),logicalAND:fr("&&",2),bitwiseOR:fr("|",3),bitwiseXOR:fr("^",4),bitwiseAND:fr("&",5),equality:fr("==/!=/===/!==",6),relational:fr("</>/<=/>=",7),bitShift:fr("<</>>/>>>",8),plusMin:new wt("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:fr("%",10),star:fr("*",10),slash:fr("/",10),starstar:new wt("**",{beforeExpr:!0}),coalesce:fr("??",1),_break:mt("break"),_case:mt("case",Et),_catch:mt("catch"),_continue:mt("continue"),_debugger:mt("debugger"),_default:mt("default",Et),_do:mt("do",{isLoop:!0,beforeExpr:!0}),_else:mt("else",Et),_finally:mt("finally"),_for:mt("for",{isLoop:!0}),_function:mt("function",vr),_if:mt("if"),_return:mt("return",Et),_switch:mt("switch"),_throw:mt("throw",Et),_try:mt("try"),_var:mt("var"),_const:mt("const"),_while:mt("while",{isLoop:!0}),_with:mt("with"),_new:mt("new",{beforeExpr:!0,startsExpr:!0}),_this:mt("this",vr),_super:mt("super",vr),_class:mt("class",vr),_extends:mt("extends",Et),_export:mt("export"),_import:mt("import",vr),_null:mt("null",vr),_true:mt("true",vr),_false:mt("false",vr),_in:mt("in",{beforeExpr:!0,binop:7}),_instanceof:mt("instanceof",{beforeExpr:!0,binop:7}),_typeof:mt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:mt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:mt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Te=/\r\n?|\n|\u2028|\u2029/,Se=new RegExp(Te.source,"g");function me(c,m){return c===10||c===13||!m&&(c===8232||c===8233)}var De=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,we=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,ze=Object.prototype,Qt=ze.hasOwnProperty,V=ze.toString;function pe(c,m){return Qt.call(c,m)}var P=Array.isArray||function(c){return V.call(c)==="[object Array]"};function U(c){return new RegExp("^(?:"+c.replace(/ /g,"|")+")$")}var B=function(m,S){this.line=m,this.column=S};B.prototype.offset=function(m){return new B(this.line,this.column+m)};var E=function(m,S,_){this.start=S,this.end=_,m.sourceFile!==null&&(this.source=m.sourceFile)};function D(c,m){for(var S=1,_=0;;){Se.lastIndex=_;var G=Se.exec(c);if(G&&G.index<m)++S,_=G.index+G[0].length;else return new B(S,m-_)}}var q={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function Q(c){var m={};for(var S in q)m[S]=c&&pe(c,S)?c[S]:q[S];if(m.ecmaVersion>=2015&&(m.ecmaVersion-=2009),m.allowReserved==null&&(m.allowReserved=m.ecmaVersion<5),P(m.onToken)){var _=m.onToken;m.onToken=function(G){return _.push(G)}}return P(m.onComment)&&(m.onComment=Ae(m,m.onComment)),m}function Ae(c,m){return function(S,_,G,oe,je,lt){var gt={type:S?"Block":"Line",value:_,start:G,end:oe};c.locations&&(gt.loc=new E(this,je,lt)),c.ranges&&(gt.range=[G,oe]),m.push(gt)}}var ct=1,ke=2,He=ct|ke,We=4,xt=8,jt=16,Gt=32,Rt=64,Ar=128;function Gr(c,m){return ke|(c?We:0)|(m?xt:0)}var er=0,$e=1,rt=2,Wt=3,Kt=4,ur=5,ae=function(m,S,_){this.options=m=Q(m),this.sourceFile=m.sourceFile,this.keywords=U(Vt[m.ecmaVersion>=6?6:m.sourceType==="module"?"5module":5]);var G="";if(m.allowReserved!==!0){for(var oe=m.ecmaVersion;!(G=Ze[oe]);oe--);m.sourceType==="module"&&(G+=" await")}this.reservedWords=U(G);var je=(G?G+" ":"")+Ze.strict;this.reservedWordsStrict=U(je),this.reservedWordsStrictBind=U(je+" "+Ze.strictBind),this.input=String(S),this.containsEsc=!1,_?(this.pos=_,this.lineStart=this.input.lastIndexOf(`
`,_-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Te).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=k.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=m.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},this.pos===0&&m.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(ct),this.regexpState=null},z={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};ae.prototype.parse=function(){var m=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(m)},z.inFunction.get=function(){return(this.currentVarScope().flags&ke)>0},z.inGenerator.get=function(){return(this.currentVarScope().flags&xt)>0},z.inAsync.get=function(){return(this.currentVarScope().flags&We)>0},z.allowSuper.get=function(){return(this.currentThisScope().flags&Rt)>0},z.allowDirectSuper.get=function(){return(this.currentThisScope().flags&Ar)>0},z.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},ae.prototype.inNonArrowFunction=function(){return(this.currentThisScope().flags&ke)>0},ae.extend=function(){for(var m=[],S=arguments.length;S--;)m[S]=arguments[S];for(var _=this,G=0;G<m.length;G++)_=m[G](_);return _},ae.parse=function(m,S){return new this(S,m).parse()},ae.parseExpressionAt=function(m,S,_){var G=new this(_,m,S);return G.nextToken(),G.parseExpression()},ae.tokenizer=function(m,S){return new this(S,m)},Object.defineProperties(ae.prototype,z);var R=ae.prototype,j=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;R.strictDirective=function(c){for(;;){we.lastIndex=c,c+=we.exec(this.input)[0].length;var m=j.exec(this.input.slice(c));if(!m)return!1;if((m[1]||m[2])==="use strict"){we.lastIndex=c+m[0].length;var S=we.exec(this.input),_=S.index+S[0].length,G=this.input.charAt(_);return G===";"||G==="}"||Te.test(S[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(G)||G==="!"&&this.input.charAt(_+1)==="=")}c+=m[0].length,we.lastIndex=c,c+=we.exec(this.input)[0].length,this.input[c]===";"&&c++}},R.eat=function(c){return this.type===c?(this.next(),!0):!1},R.isContextual=function(c){return this.type===k.name&&this.value===c&&!this.containsEsc},R.eatContextual=function(c){return this.isContextual(c)?(this.next(),!0):!1},R.expectContextual=function(c){this.eatContextual(c)||this.unexpected()},R.canInsertSemicolon=function(){return this.type===k.eof||this.type===k.braceR||Te.test(this.input.slice(this.lastTokEnd,this.start))},R.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},R.semicolon=function(){!this.eat(k.semi)&&!this.insertSemicolon()&&this.unexpected()},R.afterTrailingComma=function(c,m){if(this.type===c)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),m||this.next(),!0},R.expect=function(c){this.eat(c)||this.unexpected()},R.unexpected=function(c){this.raise(c!=null?c:this.start,"Unexpected token")};function b(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}R.checkPatternErrors=function(c,m){if(!!c){c.trailingComma>-1&&this.raiseRecoverable(c.trailingComma,"Comma is not permitted after the rest element");var S=m?c.parenthesizedAssign:c.parenthesizedBind;S>-1&&this.raiseRecoverable(S,"Parenthesized pattern")}},R.checkExpressionErrors=function(c,m){if(!c)return!1;var S=c.shorthandAssign,_=c.doubleProto;if(!m)return S>=0||_>=0;S>=0&&this.raise(S,"Shorthand property assignments are valid only in destructuring patterns"),_>=0&&this.raiseRecoverable(_,"Redefinition of __proto__ property")},R.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},R.isSimpleAssignTarget=function(c){return c.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(c.expression):c.type==="Identifier"||c.type==="MemberExpression"};var ce=ae.prototype;ce.parseTopLevel=function(c){var m={};for(c.body||(c.body=[]);this.type!==k.eof;){var S=this.parseStatement(null,!0,m);c.body.push(S)}if(this.inModule)for(var _=0,G=Object.keys(this.undefinedExports);_<G.length;_+=1){var oe=G[_];this.raiseRecoverable(this.undefinedExports[oe].start,"Export '"+oe+"' is not defined")}return this.adaptDirectivePrologue(c.body),this.next(),c.sourceType=this.options.sourceType,this.finishNode(c,"Program")};var Ye={kind:"loop"},Pt={kind:"switch"};ce.isLet=function(c){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;we.lastIndex=this.pos;var m=we.exec(this.input),S=this.pos+m[0].length,_=this.input.charCodeAt(S);if(_===91)return!0;if(c)return!1;if(_===123)return!0;if(Dt(_,!0)){for(var G=S+1;Er(this.input.charCodeAt(G),!0);)++G;var oe=this.input.slice(S,G);if(!ge.test(oe))return!0}return!1},ce.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;we.lastIndex=this.pos;var c=we.exec(this.input),m=this.pos+c[0].length;return!Te.test(this.input.slice(this.pos,m))&&this.input.slice(m,m+8)==="function"&&(m+8===this.input.length||!Er(this.input.charAt(m+8)))},ce.parseStatement=function(c,m,S){var _=this.type,G=this.startNode(),oe;switch(this.isLet(c)&&(_=k._var,oe="let"),_){case k._break:case k._continue:return this.parseBreakContinueStatement(G,_.keyword);case k._debugger:return this.parseDebuggerStatement(G);case k._do:return this.parseDoStatement(G);case k._for:return this.parseForStatement(G);case k._function:return c&&(this.strict||c!=="if"&&c!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(G,!1,!c);case k._class:return c&&this.unexpected(),this.parseClass(G,!0);case k._if:return this.parseIfStatement(G);case k._return:return this.parseReturnStatement(G);case k._switch:return this.parseSwitchStatement(G);case k._throw:return this.parseThrowStatement(G);case k._try:return this.parseTryStatement(G);case k._const:case k._var:return oe=oe||this.value,c&&oe!=="var"&&this.unexpected(),this.parseVarStatement(G,oe);case k._while:return this.parseWhileStatement(G);case k._with:return this.parseWithStatement(G);case k.braceL:return this.parseBlock(!0,G);case k.semi:return this.parseEmptyStatement(G);case k._export:case k._import:if(this.options.ecmaVersion>10&&_===k._import){we.lastIndex=this.pos;var je=we.exec(this.input),lt=this.pos+je[0].length,gt=this.input.charCodeAt(lt);if(gt===40||gt===46)return this.parseExpressionStatement(G,this.parseExpression())}return this.options.allowImportExportEverywhere||(m||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),_===k._import?this.parseImport(G):this.parseExport(G,S);default:if(this.isAsyncFunction())return c&&this.unexpected(),this.next(),this.parseFunctionStatement(G,!0,!c);var hr=this.value,cr=this.parseExpression();return _===k.name&&cr.type==="Identifier"&&this.eat(k.colon)?this.parseLabeledStatement(G,hr,cr,c):this.parseExpressionStatement(G,cr)}},ce.parseBreakContinueStatement=function(c,m){var S=m==="break";this.next(),this.eat(k.semi)||this.insertSemicolon()?c.label=null:this.type!==k.name?this.unexpected():(c.label=this.parseIdent(),this.semicolon());for(var _=0;_<this.labels.length;++_){var G=this.labels[_];if((c.label==null||G.name===c.label.name)&&(G.kind!=null&&(S||G.kind==="loop")||c.label&&S))break}return _===this.labels.length&&this.raise(c.start,"Unsyntactic "+m),this.finishNode(c,S?"BreakStatement":"ContinueStatement")},ce.parseDebuggerStatement=function(c){return this.next(),this.semicolon(),this.finishNode(c,"DebuggerStatement")},ce.parseDoStatement=function(c){return this.next(),this.labels.push(Ye),c.body=this.parseStatement("do"),this.labels.pop(),this.expect(k._while),c.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(k.semi):this.semicolon(),this.finishNode(c,"DoWhileStatement")},ce.parseForStatement=function(c){this.next();var m=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(Ye),this.enterScope(0),this.expect(k.parenL),this.type===k.semi)return m>-1&&this.unexpected(m),this.parseFor(c,null);var S=this.isLet();if(this.type===k._var||this.type===k._const||S){var _=this.startNode(),G=S?"let":this.value;return this.next(),this.parseVar(_,!0,G),this.finishNode(_,"VariableDeclaration"),(this.type===k._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&_.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===k._in?m>-1&&this.unexpected(m):c.await=m>-1),this.parseForIn(c,_)):(m>-1&&this.unexpected(m),this.parseFor(c,_))}var oe=new b,je=this.parseExpression(!0,oe);return this.type===k._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===k._in?m>-1&&this.unexpected(m):c.await=m>-1),this.toAssignable(je,!1,oe),this.checkLVal(je),this.parseForIn(c,je)):(this.checkExpressionErrors(oe,!0),m>-1&&this.unexpected(m),this.parseFor(c,je))},ce.parseFunctionStatement=function(c,m,S){return this.next(),this.parseFunction(c,he|(S?0:ve),!1,m)},ce.parseIfStatement=function(c){return this.next(),c.test=this.parseParenExpression(),c.consequent=this.parseStatement("if"),c.alternate=this.eat(k._else)?this.parseStatement("if"):null,this.finishNode(c,"IfStatement")},ce.parseReturnStatement=function(c){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(k.semi)||this.insertSemicolon()?c.argument=null:(c.argument=this.parseExpression(),this.semicolon()),this.finishNode(c,"ReturnStatement")},ce.parseSwitchStatement=function(c){this.next(),c.discriminant=this.parseParenExpression(),c.cases=[],this.expect(k.braceL),this.labels.push(Pt),this.enterScope(0);for(var m,S=!1;this.type!==k.braceR;)if(this.type===k._case||this.type===k._default){var _=this.type===k._case;m&&this.finishNode(m,"SwitchCase"),c.cases.push(m=this.startNode()),m.consequent=[],this.next(),_?m.test=this.parseExpression():(S&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),S=!0,m.test=null),this.expect(k.colon)}else m||this.unexpected(),m.consequent.push(this.parseStatement(null));return this.exitScope(),m&&this.finishNode(m,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(c,"SwitchStatement")},ce.parseThrowStatement=function(c){return this.next(),Te.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),c.argument=this.parseExpression(),this.semicolon(),this.finishNode(c,"ThrowStatement")};var te=[];ce.parseTryStatement=function(c){if(this.next(),c.block=this.parseBlock(),c.handler=null,this.type===k._catch){var m=this.startNode();if(this.next(),this.eat(k.parenL)){m.param=this.parseBindingAtom();var S=m.param.type==="Identifier";this.enterScope(S?Gt:0),this.checkLVal(m.param,S?Kt:rt),this.expect(k.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),m.param=null,this.enterScope(0);m.body=this.parseBlock(!1),this.exitScope(),c.handler=this.finishNode(m,"CatchClause")}return c.finalizer=this.eat(k._finally)?this.parseBlock():null,!c.handler&&!c.finalizer&&this.raise(c.start,"Missing catch or finally clause"),this.finishNode(c,"TryStatement")},ce.parseVarStatement=function(c,m){return this.next(),this.parseVar(c,!1,m),this.semicolon(),this.finishNode(c,"VariableDeclaration")},ce.parseWhileStatement=function(c){return this.next(),c.test=this.parseParenExpression(),this.labels.push(Ye),c.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(c,"WhileStatement")},ce.parseWithStatement=function(c){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),c.object=this.parseParenExpression(),c.body=this.parseStatement("with"),this.finishNode(c,"WithStatement")},ce.parseEmptyStatement=function(c){return this.next(),this.finishNode(c,"EmptyStatement")},ce.parseLabeledStatement=function(c,m,S,_){for(var G=0,oe=this.labels;G<oe.length;G+=1){var je=oe[G];je.name===m&&this.raise(S.start,"Label '"+m+"' is already declared")}for(var lt=this.type.isLoop?"loop":this.type===k._switch?"switch":null,gt=this.labels.length-1;gt>=0;gt--){var hr=this.labels[gt];if(hr.statementStart===c.start)hr.statementStart=this.start,hr.kind=lt;else break}return this.labels.push({name:m,kind:lt,statementStart:this.start}),c.body=this.parseStatement(_?_.indexOf("label")===-1?_+"label":_:"label"),this.labels.pop(),c.label=S,this.finishNode(c,"LabeledStatement")},ce.parseExpressionStatement=function(c,m){return c.expression=m,this.semicolon(),this.finishNode(c,"ExpressionStatement")},ce.parseBlock=function(c,m,S){for(c===void 0&&(c=!0),m===void 0&&(m=this.startNode()),m.body=[],this.expect(k.braceL),c&&this.enterScope(0);this.type!==k.braceR;){var _=this.parseStatement(null);m.body.push(_)}return S&&(this.strict=!1),this.next(),c&&this.exitScope(),this.finishNode(m,"BlockStatement")},ce.parseFor=function(c,m){return c.init=m,this.expect(k.semi),c.test=this.type===k.semi?null:this.parseExpression(),this.expect(k.semi),c.update=this.type===k.parenR?null:this.parseExpression(),this.expect(k.parenR),c.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(c,"ForStatement")},ce.parseForIn=function(c,m){var S=this.type===k._in;return this.next(),m.type==="VariableDeclaration"&&m.declarations[0].init!=null&&(!S||this.options.ecmaVersion<8||this.strict||m.kind!=="var"||m.declarations[0].id.type!=="Identifier")?this.raise(m.start,(S?"for-in":"for-of")+" loop variable declaration may not have an initializer"):m.type==="AssignmentPattern"&&this.raise(m.start,"Invalid left-hand side in for-loop"),c.left=m,c.right=S?this.parseExpression():this.parseMaybeAssign(),this.expect(k.parenR),c.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(c,S?"ForInStatement":"ForOfStatement")},ce.parseVar=function(c,m,S){for(c.declarations=[],c.kind=S;;){var _=this.startNode();if(this.parseVarId(_,S),this.eat(k.eq)?_.init=this.parseMaybeAssign(m):S==="const"&&!(this.type===k._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():_.id.type!=="Identifier"&&!(m&&(this.type===k._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):_.init=null,c.declarations.push(this.finishNode(_,"VariableDeclarator")),!this.eat(k.comma))break}return c},ce.parseVarId=function(c,m){c.id=this.parseBindingAtom(),this.checkLVal(c.id,m==="var"?$e:rt,!1)};var he=1,ve=2,it=4;ce.parseFunction=function(c,m,S,_){this.initFunction(c),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!_)&&(this.type===k.star&&m&ve&&this.unexpected(),c.generator=this.eat(k.star)),this.options.ecmaVersion>=8&&(c.async=!!_),m&he&&(c.id=m&it&&this.type!==k.name?null:this.parseIdent(),c.id&&!(m&ve)&&this.checkLVal(c.id,this.strict||c.generator||c.async?this.treatFunctionsAsVar?$e:rt:Wt));var G=this.yieldPos,oe=this.awaitPos,je=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Gr(c.async,c.generator)),m&he||(c.id=this.type===k.name?this.parseIdent():null),this.parseFunctionParams(c),this.parseFunctionBody(c,S,!1),this.yieldPos=G,this.awaitPos=oe,this.awaitIdentPos=je,this.finishNode(c,m&he?"FunctionDeclaration":"FunctionExpression")},ce.parseFunctionParams=function(c){this.expect(k.parenL),c.params=this.parseBindingList(k.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},ce.parseClass=function(c,m){this.next();var S=this.strict;this.strict=!0,this.parseClassId(c,m),this.parseClassSuper(c);var _=this.startNode(),G=!1;for(_.body=[],this.expect(k.braceL);this.type!==k.braceR;){var oe=this.parseClassElement(c.superClass!==null);oe&&(_.body.push(oe),oe.type==="MethodDefinition"&&oe.kind==="constructor"&&(G&&this.raise(oe.start,"Duplicate constructor in the same class"),G=!0))}return this.strict=S,this.next(),c.body=this.finishNode(_,"ClassBody"),this.finishNode(c,m?"ClassDeclaration":"ClassExpression")},ce.parseClassElement=function(c){var m=this;if(this.eat(k.semi))return null;var S=this.startNode(),_=function(gt,hr){hr===void 0&&(hr=!1);var cr=m.start,Cn=m.startLoc;return m.eatContextual(gt)?m.type!==k.parenL&&(!hr||!m.canInsertSemicolon())?!0:(S.key&&m.unexpected(),S.computed=!1,S.key=m.startNodeAt(cr,Cn),S.key.name=gt,m.finishNode(S.key,"Identifier"),!1):!1};S.kind="method",S.static=_("static");var G=this.eat(k.star),oe=!1;G||(this.options.ecmaVersion>=8&&_("async",!0)?(oe=!0,G=this.options.ecmaVersion>=9&&this.eat(k.star)):_("get")?S.kind="get":_("set")&&(S.kind="set")),S.key||this.parsePropertyName(S);var je=S.key,lt=!1;return!S.computed&&!S.static&&(je.type==="Identifier"&&je.name==="constructor"||je.type==="Literal"&&je.value==="constructor")?(S.kind!=="method"&&this.raise(je.start,"Constructor can't have get/set modifier"),G&&this.raise(je.start,"Constructor can't be a generator"),oe&&this.raise(je.start,"Constructor can't be an async method"),S.kind="constructor",lt=c):S.static&&je.type==="Identifier"&&je.name==="prototype"&&this.raise(je.start,"Classes may not have a static property named prototype"),this.parseClassMethod(S,G,oe,lt),S.kind==="get"&&S.value.params.length!==0&&this.raiseRecoverable(S.value.start,"getter should have no params"),S.kind==="set"&&S.value.params.length!==1&&this.raiseRecoverable(S.value.start,"setter should have exactly one param"),S.kind==="set"&&S.value.params[0].type==="RestElement"&&this.raiseRecoverable(S.value.params[0].start,"Setter cannot use rest params"),S},ce.parseClassMethod=function(c,m,S,_){return c.value=this.parseMethod(m,S,_),this.finishNode(c,"MethodDefinition")},ce.parseClassId=function(c,m){this.type===k.name?(c.id=this.parseIdent(),m&&this.checkLVal(c.id,rt,!1)):(m===!0&&this.unexpected(),c.id=null)},ce.parseClassSuper=function(c){c.superClass=this.eat(k._extends)?this.parseExprSubscripts():null},ce.parseExport=function(c,m){if(this.next(),this.eat(k.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(c.exported=this.parseIdent(!0),this.checkExport(m,c.exported.name,this.lastTokStart)):c.exported=null),this.expectContextual("from"),this.type!==k.string&&this.unexpected(),c.source=this.parseExprAtom(),this.semicolon(),this.finishNode(c,"ExportAllDeclaration");if(this.eat(k._default)){this.checkExport(m,"default",this.lastTokStart);var S;if(this.type===k._function||(S=this.isAsyncFunction())){var _=this.startNode();this.next(),S&&this.next(),c.declaration=this.parseFunction(_,he|it,!1,S)}else if(this.type===k._class){var G=this.startNode();c.declaration=this.parseClass(G,"nullableID")}else c.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(c,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())c.declaration=this.parseStatement(null),c.declaration.type==="VariableDeclaration"?this.checkVariableExport(m,c.declaration.declarations):this.checkExport(m,c.declaration.id.name,c.declaration.id.start),c.specifiers=[],c.source=null;else{if(c.declaration=null,c.specifiers=this.parseExportSpecifiers(m),this.eatContextual("from"))this.type!==k.string&&this.unexpected(),c.source=this.parseExprAtom();else{for(var oe=0,je=c.specifiers;oe<je.length;oe+=1){var lt=je[oe];this.checkUnreserved(lt.local),this.checkLocalExport(lt.local)}c.source=null}this.semicolon()}return this.finishNode(c,"ExportNamedDeclaration")},ce.checkExport=function(c,m,S){!c||(pe(c,m)&&this.raiseRecoverable(S,"Duplicate export '"+m+"'"),c[m]=!0)},ce.checkPatternExport=function(c,m){var S=m.type;if(S==="Identifier")this.checkExport(c,m.name,m.start);else if(S==="ObjectPattern")for(var _=0,G=m.properties;_<G.length;_+=1){var oe=G[_];this.checkPatternExport(c,oe)}else if(S==="ArrayPattern")for(var je=0,lt=m.elements;je<lt.length;je+=1){var gt=lt[je];gt&&this.checkPatternExport(c,gt)}else S==="Property"?this.checkPatternExport(c,m.value):S==="AssignmentPattern"?this.checkPatternExport(c,m.left):S==="RestElement"?this.checkPatternExport(c,m.argument):S==="ParenthesizedExpression"&&this.checkPatternExport(c,m.expression)},ce.checkVariableExport=function(c,m){if(!!c)for(var S=0,_=m;S<_.length;S+=1){var G=_[S];this.checkPatternExport(c,G.id)}},ce.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},ce.parseExportSpecifiers=function(c){var m=[],S=!0;for(this.expect(k.braceL);!this.eat(k.braceR);){if(S)S=!1;else if(this.expect(k.comma),this.afterTrailingComma(k.braceR))break;var _=this.startNode();_.local=this.parseIdent(!0),_.exported=this.eatContextual("as")?this.parseIdent(!0):_.local,this.checkExport(c,_.exported.name,_.exported.start),m.push(this.finishNode(_,"ExportSpecifier"))}return m},ce.parseImport=function(c){return this.next(),this.type===k.string?(c.specifiers=te,c.source=this.parseExprAtom()):(c.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),c.source=this.type===k.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(c,"ImportDeclaration")},ce.parseImportSpecifiers=function(){var c=[],m=!0;if(this.type===k.name){var S=this.startNode();if(S.local=this.parseIdent(),this.checkLVal(S.local,rt),c.push(this.finishNode(S,"ImportDefaultSpecifier")),!this.eat(k.comma))return c}if(this.type===k.star){var _=this.startNode();return this.next(),this.expectContextual("as"),_.local=this.parseIdent(),this.checkLVal(_.local,rt),c.push(this.finishNode(_,"ImportNamespaceSpecifier")),c}for(this.expect(k.braceL);!this.eat(k.braceR);){if(m)m=!1;else if(this.expect(k.comma),this.afterTrailingComma(k.braceR))break;var G=this.startNode();G.imported=this.parseIdent(!0),this.eatContextual("as")?G.local=this.parseIdent():(this.checkUnreserved(G.imported),G.local=G.imported),this.checkLVal(G.local,rt),c.push(this.finishNode(G,"ImportSpecifier"))}return c},ce.adaptDirectivePrologue=function(c){for(var m=0;m<c.length&&this.isDirectiveCandidate(c[m]);++m)c[m].directive=c[m].expression.raw.slice(1,-1)},ce.isDirectiveCandidate=function(c){return c.type==="ExpressionStatement"&&c.expression.type==="Literal"&&typeof c.expression.value=="string"&&(this.input[c.start]==='"'||this.input[c.start]==="'")};var at=ae.prototype;at.toAssignable=function(c,m,S){if(this.options.ecmaVersion>=6&&c)switch(c.type){case"Identifier":this.inAsync&&c.name==="await"&&this.raise(c.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":c.type="ObjectPattern",S&&this.checkPatternErrors(S,!0);for(var _=0,G=c.properties;_<G.length;_+=1){var oe=G[_];this.toAssignable(oe,m),oe.type==="RestElement"&&(oe.argument.type==="ArrayPattern"||oe.argument.type==="ObjectPattern")&&this.raise(oe.argument.start,"Unexpected token")}break;case"Property":c.kind!=="init"&&this.raise(c.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(c.value,m);break;case"ArrayExpression":c.type="ArrayPattern",S&&this.checkPatternErrors(S,!0),this.toAssignableList(c.elements,m);break;case"SpreadElement":c.type="RestElement",this.toAssignable(c.argument,m),c.argument.type==="AssignmentPattern"&&this.raise(c.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":c.operator!=="="&&this.raise(c.left.end,"Only '=' operator can be used for specifying default value."),c.type="AssignmentPattern",delete c.operator,this.toAssignable(c.left,m);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(c.expression,m,S);break;case"ChainExpression":this.raiseRecoverable(c.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!m)break;default:this.raise(c.start,"Assigning to rvalue")}else S&&this.checkPatternErrors(S,!0);return c},at.toAssignableList=function(c,m){for(var S=c.length,_=0;_<S;_++){var G=c[_];G&&this.toAssignable(G,m)}if(S){var oe=c[S-1];this.options.ecmaVersion===6&&m&&oe&&oe.type==="RestElement"&&oe.argument.type!=="Identifier"&&this.unexpected(oe.argument.start)}return c},at.parseSpread=function(c){var m=this.startNode();return this.next(),m.argument=this.parseMaybeAssign(!1,c),this.finishNode(m,"SpreadElement")},at.parseRestBinding=function(){var c=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==k.name&&this.unexpected(),c.argument=this.parseBindingAtom(),this.finishNode(c,"RestElement")},at.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case k.bracketL:var c=this.startNode();return this.next(),c.elements=this.parseBindingList(k.bracketR,!0,!0),this.finishNode(c,"ArrayPattern");case k.braceL:return this.parseObj(!0)}return this.parseIdent()},at.parseBindingList=function(c,m,S){for(var _=[],G=!0;!this.eat(c);)if(G?G=!1:this.expect(k.comma),m&&this.type===k.comma)_.push(null);else{if(S&&this.afterTrailingComma(c))break;if(this.type===k.ellipsis){var oe=this.parseRestBinding();this.parseBindingListItem(oe),_.push(oe),this.type===k.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(c);break}else{var je=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(je),_.push(je)}}return _},at.parseBindingListItem=function(c){return c},at.parseMaybeDefault=function(c,m,S){if(S=S||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(k.eq))return S;var _=this.startNodeAt(c,m);return _.left=S,_.right=this.parseMaybeAssign(),this.finishNode(_,"AssignmentPattern")},at.checkLVal=function(c,m,S){switch(m===void 0&&(m=er),c.type){case"Identifier":m===rt&&c.name==="let"&&this.raiseRecoverable(c.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(c.name)&&this.raiseRecoverable(c.start,(m?"Binding ":"Assigning to ")+c.name+" in strict mode"),S&&(pe(S,c.name)&&this.raiseRecoverable(c.start,"Argument name clash"),S[c.name]=!0),m!==er&&m!==ur&&this.declareName(c.name,m,c.start);break;case"ChainExpression":this.raiseRecoverable(c.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":m&&this.raiseRecoverable(c.start,"Binding member expression");break;case"ObjectPattern":for(var _=0,G=c.properties;_<G.length;_+=1){var oe=G[_];this.checkLVal(oe,m,S)}break;case"Property":this.checkLVal(c.value,m,S);break;case"ArrayPattern":for(var je=0,lt=c.elements;je<lt.length;je+=1){var gt=lt[je];gt&&this.checkLVal(gt,m,S)}break;case"AssignmentPattern":this.checkLVal(c.left,m,S);break;case"RestElement":this.checkLVal(c.argument,m,S);break;case"ParenthesizedExpression":this.checkLVal(c.expression,m,S);break;default:this.raise(c.start,(m?"Binding":"Assigning to")+" rvalue")}};var fe=ae.prototype;fe.checkPropClash=function(c,m,S){if(!(this.options.ecmaVersion>=9&&c.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(c.computed||c.method||c.shorthand))){var _=c.key,G;switch(_.type){case"Identifier":G=_.name;break;case"Literal":G=String(_.value);break;default:return}var oe=c.kind;if(this.options.ecmaVersion>=6){G==="__proto__"&&oe==="init"&&(m.proto&&(S?S.doubleProto<0&&(S.doubleProto=_.start):this.raiseRecoverable(_.start,"Redefinition of __proto__ property")),m.proto=!0);return}G="$"+G;var je=m[G];if(je){var lt;oe==="init"?lt=this.strict&&je.init||je.get||je.set:lt=je.init||je[oe],lt&&this.raiseRecoverable(_.start,"Redefinition of property")}else je=m[G]={init:!1,get:!1,set:!1};je[oe]=!0}},fe.parseExpression=function(c,m){var S=this.start,_=this.startLoc,G=this.parseMaybeAssign(c,m);if(this.type===k.comma){var oe=this.startNodeAt(S,_);for(oe.expressions=[G];this.eat(k.comma);)oe.expressions.push(this.parseMaybeAssign(c,m));return this.finishNode(oe,"SequenceExpression")}return G},fe.parseMaybeAssign=function(c,m,S){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(c);this.exprAllowed=!1}var _=!1,G=-1,oe=-1;m?(G=m.parenthesizedAssign,oe=m.trailingComma,m.parenthesizedAssign=m.trailingComma=-1):(m=new b,_=!0);var je=this.start,lt=this.startLoc;(this.type===k.parenL||this.type===k.name)&&(this.potentialArrowAt=this.start);var gt=this.parseMaybeConditional(c,m);if(S&&(gt=S.call(this,gt,je,lt)),this.type.isAssign){var hr=this.startNodeAt(je,lt);return hr.operator=this.value,hr.left=this.type===k.eq?this.toAssignable(gt,!1,m):gt,_||(m.parenthesizedAssign=m.trailingComma=m.doubleProto=-1),m.shorthandAssign>=hr.left.start&&(m.shorthandAssign=-1),this.checkLVal(gt),this.next(),hr.right=this.parseMaybeAssign(c),this.finishNode(hr,"AssignmentExpression")}else _&&this.checkExpressionErrors(m,!0);return G>-1&&(m.parenthesizedAssign=G),oe>-1&&(m.trailingComma=oe),gt},fe.parseMaybeConditional=function(c,m){var S=this.start,_=this.startLoc,G=this.parseExprOps(c,m);if(this.checkExpressionErrors(m))return G;if(this.eat(k.question)){var oe=this.startNodeAt(S,_);return oe.test=G,oe.consequent=this.parseMaybeAssign(),this.expect(k.colon),oe.alternate=this.parseMaybeAssign(c),this.finishNode(oe,"ConditionalExpression")}return G},fe.parseExprOps=function(c,m){var S=this.start,_=this.startLoc,G=this.parseMaybeUnary(m,!1);return this.checkExpressionErrors(m)||G.start===S&&G.type==="ArrowFunctionExpression"?G:this.parseExprOp(G,S,_,-1,c)},fe.parseExprOp=function(c,m,S,_,G){var oe=this.type.binop;if(oe!=null&&(!G||this.type!==k._in)&&oe>_){var je=this.type===k.logicalOR||this.type===k.logicalAND,lt=this.type===k.coalesce;lt&&(oe=k.logicalAND.binop);var gt=this.value;this.next();var hr=this.start,cr=this.startLoc,Cn=this.parseExprOp(this.parseMaybeUnary(null,!1),hr,cr,oe,G),Xn=this.buildBinary(m,S,c,Cn,gt,je||lt);return(je&&this.type===k.coalesce||lt&&(this.type===k.logicalOR||this.type===k.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(Xn,m,S,_,G)}return c},fe.buildBinary=function(c,m,S,_,G,oe){var je=this.startNodeAt(c,m);return je.left=S,je.operator=G,je.right=_,this.finishNode(je,oe?"LogicalExpression":"BinaryExpression")},fe.parseMaybeUnary=function(c,m){var S=this.start,_=this.startLoc,G;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))G=this.parseAwait(),m=!0;else if(this.type.prefix){var oe=this.startNode(),je=this.type===k.incDec;oe.operator=this.value,oe.prefix=!0,this.next(),oe.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(c,!0),je?this.checkLVal(oe.argument):this.strict&&oe.operator==="delete"&&oe.argument.type==="Identifier"?this.raiseRecoverable(oe.start,"Deleting local variable in strict mode"):m=!0,G=this.finishNode(oe,je?"UpdateExpression":"UnaryExpression")}else{if(G=this.parseExprSubscripts(c),this.checkExpressionErrors(c))return G;for(;this.type.postfix&&!this.canInsertSemicolon();){var lt=this.startNodeAt(S,_);lt.operator=this.value,lt.prefix=!1,lt.argument=G,this.checkLVal(G),this.next(),G=this.finishNode(lt,"UpdateExpression")}}return!m&&this.eat(k.starstar)?this.buildBinary(S,_,G,this.parseMaybeUnary(null,!1),"**",!1):G},fe.parseExprSubscripts=function(c){var m=this.start,S=this.startLoc,_=this.parseExprAtom(c);if(_.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return _;var G=this.parseSubscripts(_,m,S);return c&&G.type==="MemberExpression"&&(c.parenthesizedAssign>=G.start&&(c.parenthesizedAssign=-1),c.parenthesizedBind>=G.start&&(c.parenthesizedBind=-1)),G},fe.parseSubscripts=function(c,m,S,_){for(var G=this.options.ecmaVersion>=8&&c.type==="Identifier"&&c.name==="async"&&this.lastTokEnd===c.end&&!this.canInsertSemicolon()&&c.end-c.start==5&&this.potentialArrowAt===c.start,oe=!1;;){var je=this.parseSubscript(c,m,S,_,G,oe);if(je.optional&&(oe=!0),je===c||je.type==="ArrowFunctionExpression"){if(oe){var lt=this.startNodeAt(m,S);lt.expression=je,je=this.finishNode(lt,"ChainExpression")}return je}c=je}},fe.parseSubscript=function(c,m,S,_,G,oe){var je=this.options.ecmaVersion>=11,lt=je&&this.eat(k.questionDot);_&&lt&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var gt=this.eat(k.bracketL);if(gt||lt&&this.type!==k.parenL&&this.type!==k.backQuote||this.eat(k.dot)){var hr=this.startNodeAt(m,S);hr.object=c,hr.property=gt?this.parseExpression():this.parseIdent(this.options.allowReserved!=="never"),hr.computed=!!gt,gt&&this.expect(k.bracketR),je&&(hr.optional=lt),c=this.finishNode(hr,"MemberExpression")}else if(!_&&this.eat(k.parenL)){var cr=new b,Cn=this.yieldPos,Xn=this.awaitPos,sn=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var Ai=this.parseExprList(k.parenR,this.options.ecmaVersion>=8,!1,cr);if(G&&!lt&&!this.canInsertSemicolon()&&this.eat(k.arrow))return this.checkPatternErrors(cr,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=Cn,this.awaitPos=Xn,this.awaitIdentPos=sn,this.parseArrowExpression(this.startNodeAt(m,S),Ai,!0);this.checkExpressionErrors(cr,!0),this.yieldPos=Cn||this.yieldPos,this.awaitPos=Xn||this.awaitPos,this.awaitIdentPos=sn||this.awaitIdentPos;var Fi=this.startNodeAt(m,S);Fi.callee=c,Fi.arguments=Ai,je&&(Fi.optional=lt),c=this.finishNode(Fi,"CallExpression")}else if(this.type===k.backQuote){(lt||oe)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var Gi=this.startNodeAt(m,S);Gi.tag=c,Gi.quasi=this.parseTemplate({isTagged:!0}),c=this.finishNode(Gi,"TaggedTemplateExpression")}return c},fe.parseExprAtom=function(c){this.type===k.slash&&this.readRegexp();var m,S=this.potentialArrowAt===this.start;switch(this.type){case k._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),m=this.startNode(),this.next(),this.type===k.parenL&&!this.allowDirectSuper&&this.raise(m.start,"super() call outside constructor of a subclass"),this.type!==k.dot&&this.type!==k.bracketL&&this.type!==k.parenL&&this.unexpected(),this.finishNode(m,"Super");case k._this:return m=this.startNode(),this.next(),this.finishNode(m,"ThisExpression");case k.name:var _=this.start,G=this.startLoc,oe=this.containsEsc,je=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!oe&&je.name==="async"&&!this.canInsertSemicolon()&&this.eat(k._function))return this.parseFunction(this.startNodeAt(_,G),0,!1,!0);if(S&&!this.canInsertSemicolon()){if(this.eat(k.arrow))return this.parseArrowExpression(this.startNodeAt(_,G),[je],!1);if(this.options.ecmaVersion>=8&&je.name==="async"&&this.type===k.name&&!oe)return je=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(k.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(_,G),[je],!0)}return je;case k.regexp:var lt=this.value;return m=this.parseLiteral(lt.value),m.regex={pattern:lt.pattern,flags:lt.flags},m;case k.num:case k.string:return this.parseLiteral(this.value);case k._null:case k._true:case k._false:return m=this.startNode(),m.value=this.type===k._null?null:this.type===k._true,m.raw=this.type.keyword,this.next(),this.finishNode(m,"Literal");case k.parenL:var gt=this.start,hr=this.parseParenAndDistinguishExpression(S);return c&&(c.parenthesizedAssign<0&&!this.isSimpleAssignTarget(hr)&&(c.parenthesizedAssign=gt),c.parenthesizedBind<0&&(c.parenthesizedBind=gt)),hr;case k.bracketL:return m=this.startNode(),this.next(),m.elements=this.parseExprList(k.bracketR,!0,!0,c),this.finishNode(m,"ArrayExpression");case k.braceL:return this.parseObj(!1,c);case k._function:return m=this.startNode(),this.next(),this.parseFunction(m,0);case k._class:return this.parseClass(this.startNode(),!1);case k._new:return this.parseNew();case k.backQuote:return this.parseTemplate();case k._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},fe.parseExprImport=function(){var c=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var m=this.parseIdent(!0);switch(this.type){case k.parenL:return this.parseDynamicImport(c);case k.dot:return c.meta=m,this.parseImportMeta(c);default:this.unexpected()}},fe.parseDynamicImport=function(c){if(this.next(),c.source=this.parseMaybeAssign(),!this.eat(k.parenR)){var m=this.start;this.eat(k.comma)&&this.eat(k.parenR)?this.raiseRecoverable(m,"Trailing comma is not allowed in import()"):this.unexpected(m)}return this.finishNode(c,"ImportExpression")},fe.parseImportMeta=function(c){this.next();var m=this.containsEsc;return c.property=this.parseIdent(!0),c.property.name!=="meta"&&this.raiseRecoverable(c.property.start,"The only valid meta property for import is 'import.meta'"),m&&this.raiseRecoverable(c.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&this.raiseRecoverable(c.start,"Cannot use 'import.meta' outside a module"),this.finishNode(c,"MetaProperty")},fe.parseLiteral=function(c){var m=this.startNode();return m.value=c,m.raw=this.input.slice(this.start,this.end),m.raw.charCodeAt(m.raw.length-1)===110&&(m.bigint=m.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(m,"Literal")},fe.parseParenExpression=function(){this.expect(k.parenL);var c=this.parseExpression();return this.expect(k.parenR),c},fe.parseParenAndDistinguishExpression=function(c){var m=this.start,S=this.startLoc,_,G=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var oe=this.start,je=this.startLoc,lt=[],gt=!0,hr=!1,cr=new b,Cn=this.yieldPos,Xn=this.awaitPos,sn;for(this.yieldPos=0,this.awaitPos=0;this.type!==k.parenR;)if(gt?gt=!1:this.expect(k.comma),G&&this.afterTrailingComma(k.parenR,!0)){hr=!0;break}else if(this.type===k.ellipsis){sn=this.start,lt.push(this.parseParenItem(this.parseRestBinding())),this.type===k.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}else lt.push(this.parseMaybeAssign(!1,cr,this.parseParenItem));var Ai=this.start,Fi=this.startLoc;if(this.expect(k.parenR),c&&!this.canInsertSemicolon()&&this.eat(k.arrow))return this.checkPatternErrors(cr,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=Cn,this.awaitPos=Xn,this.parseParenArrowList(m,S,lt);(!lt.length||hr)&&this.unexpected(this.lastTokStart),sn&&this.unexpected(sn),this.checkExpressionErrors(cr,!0),this.yieldPos=Cn||this.yieldPos,this.awaitPos=Xn||this.awaitPos,lt.length>1?(_=this.startNodeAt(oe,je),_.expressions=lt,this.finishNodeAt(_,"SequenceExpression",Ai,Fi)):_=lt[0]}else _=this.parseParenExpression();if(this.options.preserveParens){var Gi=this.startNodeAt(m,S);return Gi.expression=_,this.finishNode(Gi,"ParenthesizedExpression")}else return _},fe.parseParenItem=function(c){return c},fe.parseParenArrowList=function(c,m,S){return this.parseArrowExpression(this.startNodeAt(c,m),S)};var wr=[];fe.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var c=this.startNode(),m=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(k.dot)){c.meta=m;var S=this.containsEsc;return c.property=this.parseIdent(!0),c.property.name!=="target"&&this.raiseRecoverable(c.property.start,"The only valid meta property for new is 'new.target'"),S&&this.raiseRecoverable(c.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(c.start,"'new.target' can only be used in functions"),this.finishNode(c,"MetaProperty")}var _=this.start,G=this.startLoc,oe=this.type===k._import;return c.callee=this.parseSubscripts(this.parseExprAtom(),_,G,!0),oe&&c.callee.type==="ImportExpression"&&this.raise(_,"Cannot use new with import()"),this.eat(k.parenL)?c.arguments=this.parseExprList(k.parenR,this.options.ecmaVersion>=8,!1):c.arguments=wr,this.finishNode(c,"NewExpression")},fe.parseTemplateElement=function(c){var m=c.isTagged,S=this.startNode();return this.type===k.invalidTemplate?(m||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),S.value={raw:this.value,cooked:null}):S.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),S.tail=this.type===k.backQuote,this.finishNode(S,"TemplateElement")},fe.parseTemplate=function(c){c===void 0&&(c={});var m=c.isTagged;m===void 0&&(m=!1);var S=this.startNode();this.next(),S.expressions=[];var _=this.parseTemplateElement({isTagged:m});for(S.quasis=[_];!_.tail;)this.type===k.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(k.dollarBraceL),S.expressions.push(this.parseExpression()),this.expect(k.braceR),S.quasis.push(_=this.parseTemplateElement({isTagged:m}));return this.next(),this.finishNode(S,"TemplateLiteral")},fe.isAsyncProp=function(c){return!c.computed&&c.key.type==="Identifier"&&c.key.name==="async"&&(this.type===k.name||this.type===k.num||this.type===k.string||this.type===k.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===k.star)&&!Te.test(this.input.slice(this.lastTokEnd,this.start))},fe.parseObj=function(c,m){var S=this.startNode(),_=!0,G={};for(S.properties=[],this.next();!this.eat(k.braceR);){if(_)_=!1;else if(this.expect(k.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(k.braceR))break;var oe=this.parseProperty(c,m);c||this.checkPropClash(oe,G,m),S.properties.push(oe)}return this.finishNode(S,c?"ObjectPattern":"ObjectExpression")},fe.parseProperty=function(c,m){var S=this.startNode(),_,G,oe,je;if(this.options.ecmaVersion>=9&&this.eat(k.ellipsis))return c?(S.argument=this.parseIdent(!1),this.type===k.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(S,"RestElement")):(this.type===k.parenL&&m&&(m.parenthesizedAssign<0&&(m.parenthesizedAssign=this.start),m.parenthesizedBind<0&&(m.parenthesizedBind=this.start)),S.argument=this.parseMaybeAssign(!1,m),this.type===k.comma&&m&&m.trailingComma<0&&(m.trailingComma=this.start),this.finishNode(S,"SpreadElement"));this.options.ecmaVersion>=6&&(S.method=!1,S.shorthand=!1,(c||m)&&(oe=this.start,je=this.startLoc),c||(_=this.eat(k.star)));var lt=this.containsEsc;return this.parsePropertyName(S),!c&&!lt&&this.options.ecmaVersion>=8&&!_&&this.isAsyncProp(S)?(G=!0,_=this.options.ecmaVersion>=9&&this.eat(k.star),this.parsePropertyName(S,m)):G=!1,this.parsePropertyValue(S,c,_,G,oe,je,m,lt),this.finishNode(S,"Property")},fe.parsePropertyValue=function(c,m,S,_,G,oe,je,lt){if((S||_)&&this.type===k.colon&&this.unexpected(),this.eat(k.colon))c.value=m?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,je),c.kind="init";else if(this.options.ecmaVersion>=6&&this.type===k.parenL)m&&this.unexpected(),c.kind="init",c.method=!0,c.value=this.parseMethod(S,_);else if(!m&&!lt&&this.options.ecmaVersion>=5&&!c.computed&&c.key.type==="Identifier"&&(c.key.name==="get"||c.key.name==="set")&&this.type!==k.comma&&this.type!==k.braceR&&this.type!==k.eq){(S||_)&&this.unexpected(),c.kind=c.key.name,this.parsePropertyName(c),c.value=this.parseMethod(!1);var gt=c.kind==="get"?0:1;if(c.value.params.length!==gt){var hr=c.value.start;c.kind==="get"?this.raiseRecoverable(hr,"getter should have no params"):this.raiseRecoverable(hr,"setter should have exactly one param")}else c.kind==="set"&&c.value.params[0].type==="RestElement"&&this.raiseRecoverable(c.value.params[0].start,"Setter cannot use rest params")}else this.options.ecmaVersion>=6&&!c.computed&&c.key.type==="Identifier"?((S||_)&&this.unexpected(),this.checkUnreserved(c.key),c.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=G),c.kind="init",m?c.value=this.parseMaybeDefault(G,oe,c.key):this.type===k.eq&&je?(je.shorthandAssign<0&&(je.shorthandAssign=this.start),c.value=this.parseMaybeDefault(G,oe,c.key)):c.value=c.key,c.shorthand=!0):this.unexpected()},fe.parsePropertyName=function(c){if(this.options.ecmaVersion>=6){if(this.eat(k.bracketL))return c.computed=!0,c.key=this.parseMaybeAssign(),this.expect(k.bracketR),c.key;c.computed=!1}return c.key=this.type===k.num||this.type===k.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},fe.initFunction=function(c){c.id=null,this.options.ecmaVersion>=6&&(c.generator=c.expression=!1),this.options.ecmaVersion>=8&&(c.async=!1)},fe.parseMethod=function(c,m,S){var _=this.startNode(),G=this.yieldPos,oe=this.awaitPos,je=this.awaitIdentPos;return this.initFunction(_),this.options.ecmaVersion>=6&&(_.generator=c),this.options.ecmaVersion>=8&&(_.async=!!m),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Gr(m,_.generator)|Rt|(S?Ar:0)),this.expect(k.parenL),_.params=this.parseBindingList(k.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(_,!1,!0),this.yieldPos=G,this.awaitPos=oe,this.awaitIdentPos=je,this.finishNode(_,"FunctionExpression")},fe.parseArrowExpression=function(c,m,S){var _=this.yieldPos,G=this.awaitPos,oe=this.awaitIdentPos;return this.enterScope(Gr(S,!1)|jt),this.initFunction(c),this.options.ecmaVersion>=8&&(c.async=!!S),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,c.params=this.toAssignableList(m,!0),this.parseFunctionBody(c,!0,!1),this.yieldPos=_,this.awaitPos=G,this.awaitIdentPos=oe,this.finishNode(c,"ArrowFunctionExpression")},fe.parseFunctionBody=function(c,m,S){var _=m&&this.type!==k.braceL,G=this.strict,oe=!1;if(_)c.body=this.parseMaybeAssign(),c.expression=!0,this.checkParams(c,!1);else{var je=this.options.ecmaVersion>=7&&!this.isSimpleParamList(c.params);(!G||je)&&(oe=this.strictDirective(this.end),oe&&je&&this.raiseRecoverable(c.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var lt=this.labels;this.labels=[],oe&&(this.strict=!0),this.checkParams(c,!G&&!oe&&!m&&!S&&this.isSimpleParamList(c.params)),this.strict&&c.id&&this.checkLVal(c.id,ur),c.body=this.parseBlock(!1,void 0,oe&&!G),c.expression=!1,this.adaptDirectivePrologue(c.body.body),this.labels=lt}this.exitScope()},fe.isSimpleParamList=function(c){for(var m=0,S=c;m<S.length;m+=1){var _=S[m];if(_.type!=="Identifier")return!1}return!0},fe.checkParams=function(c,m){for(var S={},_=0,G=c.params;_<G.length;_+=1){var oe=G[_];this.checkLVal(oe,$e,m?null:S)}},fe.parseExprList=function(c,m,S,_){for(var G=[],oe=!0;!this.eat(c);){if(oe)oe=!1;else if(this.expect(k.comma),m&&this.afterTrailingComma(c))break;var je=void 0;S&&this.type===k.comma?je=null:this.type===k.ellipsis?(je=this.parseSpread(_),_&&this.type===k.comma&&_.trailingComma<0&&(_.trailingComma=this.start)):je=this.parseMaybeAssign(!1,_),G.push(je)}return G},fe.checkUnreserved=function(c){var m=c.start,S=c.end,_=c.name;if(this.inGenerator&&_==="yield"&&this.raiseRecoverable(m,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&_==="await"&&this.raiseRecoverable(m,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(_)&&this.raise(m,"Unexpected keyword '"+_+"'"),!(this.options.ecmaVersion<6&&this.input.slice(m,S).indexOf("\\")!==-1)){var G=this.strict?this.reservedWordsStrict:this.reservedWords;G.test(_)&&(!this.inAsync&&_==="await"&&this.raiseRecoverable(m,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(m,"The keyword '"+_+"' is reserved"))}},fe.parseIdent=function(c,m){var S=this.startNode();return this.type===k.name?S.name=this.value:this.type.keyword?(S.name=this.type.keyword,(S.name==="class"||S.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop()):this.unexpected(),this.next(!!c),this.finishNode(S,"Identifier"),c||(this.checkUnreserved(S),S.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=S.start)),S},fe.parseYield=function(c){this.yieldPos||(this.yieldPos=this.start);var m=this.startNode();return this.next(),this.type===k.semi||this.canInsertSemicolon()||this.type!==k.star&&!this.type.startsExpr?(m.delegate=!1,m.argument=null):(m.delegate=this.eat(k.star),m.argument=this.parseMaybeAssign(c)),this.finishNode(m,"YieldExpression")},fe.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var c=this.startNode();return this.next(),c.argument=this.parseMaybeUnary(null,!1),this.finishNode(c,"AwaitExpression")};var Dr=ae.prototype;Dr.raise=function(c,m){var S=D(this.input,c);m+=" ("+S.line+":"+S.column+")";var _=new SyntaxError(m);throw _.pos=c,_.loc=S,_.raisedAt=this.pos,_},Dr.raiseRecoverable=Dr.raise,Dr.curPosition=function(){if(this.options.locations)return new B(this.curLine,this.pos-this.lineStart)};var Nr=ae.prototype,yt=function(m){this.flags=m,this.var=[],this.lexical=[],this.functions=[]};Nr.enterScope=function(c){this.scopeStack.push(new yt(c))},Nr.exitScope=function(){this.scopeStack.pop()},Nr.treatFunctionsAsVarInScope=function(c){return c.flags&ke||!this.inModule&&c.flags&ct},Nr.declareName=function(c,m,S){var _=!1;if(m===rt){var G=this.currentScope();_=G.lexical.indexOf(c)>-1||G.functions.indexOf(c)>-1||G.var.indexOf(c)>-1,G.lexical.push(c),this.inModule&&G.flags&ct&&delete this.undefinedExports[c]}else if(m===Kt){var oe=this.currentScope();oe.lexical.push(c)}else if(m===Wt){var je=this.currentScope();this.treatFunctionsAsVar?_=je.lexical.indexOf(c)>-1:_=je.lexical.indexOf(c)>-1||je.var.indexOf(c)>-1,je.functions.push(c)}else for(var lt=this.scopeStack.length-1;lt>=0;--lt){var gt=this.scopeStack[lt];if(gt.lexical.indexOf(c)>-1&&!(gt.flags&Gt&&gt.lexical[0]===c)||!this.treatFunctionsAsVarInScope(gt)&&gt.functions.indexOf(c)>-1){_=!0;break}if(gt.var.push(c),this.inModule&&gt.flags&ct&&delete this.undefinedExports[c],gt.flags&He)break}_&&this.raiseRecoverable(S,"Identifier '"+c+"' has already been declared")},Nr.checkLocalExport=function(c){this.scopeStack[0].lexical.indexOf(c.name)===-1&&this.scopeStack[0].var.indexOf(c.name)===-1&&(this.undefinedExports[c.name]=c)},Nr.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},Nr.currentVarScope=function(){for(var c=this.scopeStack.length-1;;c--){var m=this.scopeStack[c];if(m.flags&He)return m}},Nr.currentThisScope=function(){for(var c=this.scopeStack.length-1;;c--){var m=this.scopeStack[c];if(m.flags&He&&!(m.flags&jt))return m}};var jr=function(m,S,_){this.type="",this.start=S,this.end=0,m.options.locations&&(this.loc=new E(m,_)),m.options.directSourceFile&&(this.sourceFile=m.options.directSourceFile),m.options.ranges&&(this.range=[S,0])},Dn=ae.prototype;Dn.startNode=function(){return new jr(this,this.start,this.startLoc)},Dn.startNodeAt=function(c,m){return new jr(this,c,m)};function ai(c,m,S,_){return c.type=m,c.end=S,this.options.locations&&(c.loc.end=_),this.options.ranges&&(c.range[1]=S),c}Dn.finishNode=function(c,m){return ai.call(this,c,m,this.lastTokEnd,this.lastTokEndLoc)},Dn.finishNodeAt=function(c,m,S,_){return ai.call(this,c,m,S,_)};var Mi=function(m,S,_,G,oe){this.token=m,this.isExpr=!!S,this.preserveSpace=!!_,this.override=G,this.generator=!!oe},Li={b_stat:new Mi("{",!1),b_expr:new Mi("{",!0),b_tmpl:new Mi("${",!1),p_stat:new Mi("(",!1),p_expr:new Mi("(",!0),q_tmpl:new Mi("`",!0,!0,function(c){return c.tryReadTemplateToken()}),f_stat:new Mi("function",!1),f_expr:new Mi("function",!0),f_expr_gen:new Mi("function",!0,!1,null,!0),f_gen:new Mi("function",!1,!1,null,!0)},Kn=ae.prototype;Kn.initialContext=function(){return[Li.b_stat]},Kn.braceIsBlock=function(c){var m=this.curContext();return m===Li.f_expr||m===Li.f_stat?!0:c===k.colon&&(m===Li.b_stat||m===Li.b_expr)?!m.isExpr:c===k._return||c===k.name&&this.exprAllowed?Te.test(this.input.slice(this.lastTokEnd,this.start)):c===k._else||c===k.semi||c===k.eof||c===k.parenR||c===k.arrow?!0:c===k.braceL?m===Li.b_stat:c===k._var||c===k._const||c===k.name?!1:!this.exprAllowed},Kn.inGeneratorContext=function(){for(var c=this.context.length-1;c>=1;c--){var m=this.context[c];if(m.token==="function")return m.generator}return!1},Kn.updateContext=function(c){var m,S=this.type;S.keyword&&c===k.dot?this.exprAllowed=!1:(m=S.updateContext)?m.call(this,c):this.exprAllowed=S.beforeExpr},k.parenR.updateContext=k.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var c=this.context.pop();c===Li.b_stat&&this.curContext().token==="function"&&(c=this.context.pop()),this.exprAllowed=!c.isExpr},k.braceL.updateContext=function(c){this.context.push(this.braceIsBlock(c)?Li.b_stat:Li.b_expr),this.exprAllowed=!0},k.dollarBraceL.updateContext=function(){this.context.push(Li.b_tmpl),this.exprAllowed=!0},k.parenL.updateContext=function(c){var m=c===k._if||c===k._for||c===k._with||c===k._while;this.context.push(m?Li.p_stat:Li.p_expr),this.exprAllowed=!0},k.incDec.updateContext=function(){},k._function.updateContext=k._class.updateContext=function(c){c.beforeExpr&&c!==k.semi&&c!==k._else&&!(c===k._return&&Te.test(this.input.slice(this.lastTokEnd,this.start)))&&!((c===k.colon||c===k.braceL)&&this.curContext()===Li.b_stat)?this.context.push(Li.f_expr):this.context.push(Li.f_stat),this.exprAllowed=!1},k.backQuote.updateContext=function(){this.curContext()===Li.q_tmpl?this.context.pop():this.context.push(Li.q_tmpl),this.exprAllowed=!1},k.star.updateContext=function(c){if(c===k._function){var m=this.context.length-1;this.context[m]===Li.f_expr?this.context[m]=Li.f_expr_gen:this.context[m]=Li.f_gen}this.exprAllowed=!0},k.name.updateContext=function(c){var m=!1;this.options.ecmaVersion>=6&&c!==k.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(m=!0),this.exprAllowed=m};var L="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",N=L+" Extended_Pictographic",H=N,ne={9:L,10:N,11:H},xe="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",Ne="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",Qe=Ne+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",J=Qe+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",Me={9:Ne,10:Qe,11:J},bt={};function gr(c){var m=bt[c]={binary:U(ne[c]+" "+xe),nonBinary:{General_Category:U(xe),Script:U(Me[c])}};m.nonBinary.Script_Extensions=m.nonBinary.Script,m.nonBinary.gc=m.nonBinary.General_Category,m.nonBinary.sc=m.nonBinary.Script,m.nonBinary.scx=m.nonBinary.Script_Extensions}gr(9),gr(10),gr(11);var zt=ae.prototype,Nt=function(m){this.parser=m,this.validFlags="gim"+(m.options.ecmaVersion>=6?"uy":"")+(m.options.ecmaVersion>=9?"s":""),this.unicodeProperties=bt[m.options.ecmaVersion>=11?11:m.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};Nt.prototype.reset=function(m,S,_){var G=_.indexOf("u")!==-1;this.start=m|0,this.source=S+"",this.flags=_,this.switchU=G&&this.parser.options.ecmaVersion>=6,this.switchN=G&&this.parser.options.ecmaVersion>=9},Nt.prototype.raise=function(m){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+m)},Nt.prototype.at=function(m,S){S===void 0&&(S=!1);var _=this.source,G=_.length;if(m>=G)return-1;var oe=_.charCodeAt(m);if(!(S||this.switchU)||oe<=55295||oe>=57344||m+1>=G)return oe;var je=_.charCodeAt(m+1);return je>=56320&&je<=57343?(oe<<10)+je-56613888:oe},Nt.prototype.nextIndex=function(m,S){S===void 0&&(S=!1);var _=this.source,G=_.length;if(m>=G)return G;var oe=_.charCodeAt(m),je;return!(S||this.switchU)||oe<=55295||oe>=57344||m+1>=G||(je=_.charCodeAt(m+1))<56320||je>57343?m+1:m+2},Nt.prototype.current=function(m){return m===void 0&&(m=!1),this.at(this.pos,m)},Nt.prototype.lookahead=function(m){return m===void 0&&(m=!1),this.at(this.nextIndex(this.pos,m),m)},Nt.prototype.advance=function(m){m===void 0&&(m=!1),this.pos=this.nextIndex(this.pos,m)},Nt.prototype.eat=function(m,S){return S===void 0&&(S=!1),this.current(S)===m?(this.advance(S),!0):!1};function br(c){return c<=65535?String.fromCharCode(c):(c-=65536,String.fromCharCode((c>>10)+55296,(c&1023)+56320))}zt.validateRegExpFlags=function(c){for(var m=c.validFlags,S=c.flags,_=0;_<S.length;_++){var G=S.charAt(_);m.indexOf(G)===-1&&this.raise(c.start,"Invalid regular expression flag"),S.indexOf(G,_+1)>-1&&this.raise(c.start,"Duplicate regular expression flag")}},zt.validateRegExpPattern=function(c){this.regexp_pattern(c),!c.switchN&&this.options.ecmaVersion>=9&&c.groupNames.length>0&&(c.switchN=!0,this.regexp_pattern(c))},zt.regexp_pattern=function(c){c.pos=0,c.lastIntValue=0,c.lastStringValue="",c.lastAssertionIsQuantifiable=!1,c.numCapturingParens=0,c.maxBackReference=0,c.groupNames.length=0,c.backReferenceNames.length=0,this.regexp_disjunction(c),c.pos!==c.source.length&&(c.eat(41)&&c.raise("Unmatched ')'"),(c.eat(93)||c.eat(125))&&c.raise("Lone quantifier brackets")),c.maxBackReference>c.numCapturingParens&&c.raise("Invalid escape");for(var m=0,S=c.backReferenceNames;m<S.length;m+=1){var _=S[m];c.groupNames.indexOf(_)===-1&&c.raise("Invalid named capture referenced")}},zt.regexp_disjunction=function(c){for(this.regexp_alternative(c);c.eat(124);)this.regexp_alternative(c);this.regexp_eatQuantifier(c,!0)&&c.raise("Nothing to repeat"),c.eat(123)&&c.raise("Lone quantifier brackets")},zt.regexp_alternative=function(c){for(;c.pos<c.source.length&&this.regexp_eatTerm(c););},zt.regexp_eatTerm=function(c){return this.regexp_eatAssertion(c)?(c.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(c)&&c.switchU&&c.raise("Invalid quantifier"),!0):(c.switchU?this.regexp_eatAtom(c):this.regexp_eatExtendedAtom(c))?(this.regexp_eatQuantifier(c),!0):!1},zt.regexp_eatAssertion=function(c){var m=c.pos;if(c.lastAssertionIsQuantifiable=!1,c.eat(94)||c.eat(36))return!0;if(c.eat(92)){if(c.eat(66)||c.eat(98))return!0;c.pos=m}if(c.eat(40)&&c.eat(63)){var S=!1;if(this.options.ecmaVersion>=9&&(S=c.eat(60)),c.eat(61)||c.eat(33))return this.regexp_disjunction(c),c.eat(41)||c.raise("Unterminated group"),c.lastAssertionIsQuantifiable=!S,!0}return c.pos=m,!1},zt.regexp_eatQuantifier=function(c,m){return m===void 0&&(m=!1),this.regexp_eatQuantifierPrefix(c,m)?(c.eat(63),!0):!1},zt.regexp_eatQuantifierPrefix=function(c,m){return c.eat(42)||c.eat(43)||c.eat(63)||this.regexp_eatBracedQuantifier(c,m)},zt.regexp_eatBracedQuantifier=function(c,m){var S=c.pos;if(c.eat(123)){var _=0,G=-1;if(this.regexp_eatDecimalDigits(c)&&(_=c.lastIntValue,c.eat(44)&&this.regexp_eatDecimalDigits(c)&&(G=c.lastIntValue),c.eat(125)))return G!==-1&&G<_&&!m&&c.raise("numbers out of order in {} quantifier"),!0;c.switchU&&!m&&c.raise("Incomplete quantifier"),c.pos=S}return!1},zt.regexp_eatAtom=function(c){return this.regexp_eatPatternCharacters(c)||c.eat(46)||this.regexp_eatReverseSolidusAtomEscape(c)||this.regexp_eatCharacterClass(c)||this.regexp_eatUncapturingGroup(c)||this.regexp_eatCapturingGroup(c)},zt.regexp_eatReverseSolidusAtomEscape=function(c){var m=c.pos;if(c.eat(92)){if(this.regexp_eatAtomEscape(c))return!0;c.pos=m}return!1},zt.regexp_eatUncapturingGroup=function(c){var m=c.pos;if(c.eat(40)){if(c.eat(63)&&c.eat(58)){if(this.regexp_disjunction(c),c.eat(41))return!0;c.raise("Unterminated group")}c.pos=m}return!1},zt.regexp_eatCapturingGroup=function(c){if(c.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(c):c.current()===63&&c.raise("Invalid group"),this.regexp_disjunction(c),c.eat(41))return c.numCapturingParens+=1,!0;c.raise("Unterminated group")}return!1},zt.regexp_eatExtendedAtom=function(c){return c.eat(46)||this.regexp_eatReverseSolidusAtomEscape(c)||this.regexp_eatCharacterClass(c)||this.regexp_eatUncapturingGroup(c)||this.regexp_eatCapturingGroup(c)||this.regexp_eatInvalidBracedQuantifier(c)||this.regexp_eatExtendedPatternCharacter(c)},zt.regexp_eatInvalidBracedQuantifier=function(c){return this.regexp_eatBracedQuantifier(c,!0)&&c.raise("Nothing to repeat"),!1},zt.regexp_eatSyntaxCharacter=function(c){var m=c.current();return vn(m)?(c.lastIntValue=m,c.advance(),!0):!1};function vn(c){return c===36||c>=40&&c<=43||c===46||c===63||c>=91&&c<=94||c>=123&&c<=125}zt.regexp_eatPatternCharacters=function(c){for(var m=c.pos,S=0;(S=c.current())!==-1&&!vn(S);)c.advance();return c.pos!==m},zt.regexp_eatExtendedPatternCharacter=function(c){var m=c.current();return m!==-1&&m!==36&&!(m>=40&&m<=43)&&m!==46&&m!==63&&m!==91&&m!==94&&m!==124?(c.advance(),!0):!1},zt.regexp_groupSpecifier=function(c){if(c.eat(63)){if(this.regexp_eatGroupName(c)){c.groupNames.indexOf(c.lastStringValue)!==-1&&c.raise("Duplicate capture group name"),c.groupNames.push(c.lastStringValue);return}c.raise("Invalid group")}},zt.regexp_eatGroupName=function(c){if(c.lastStringValue="",c.eat(60)){if(this.regexp_eatRegExpIdentifierName(c)&&c.eat(62))return!0;c.raise("Invalid capture group name")}return!1},zt.regexp_eatRegExpIdentifierName=function(c){if(c.lastStringValue="",this.regexp_eatRegExpIdentifierStart(c)){for(c.lastStringValue+=br(c.lastIntValue);this.regexp_eatRegExpIdentifierPart(c);)c.lastStringValue+=br(c.lastIntValue);return!0}return!1},zt.regexp_eatRegExpIdentifierStart=function(c){var m=c.pos,S=this.options.ecmaVersion>=11,_=c.current(S);return c.advance(S),_===92&&this.regexp_eatRegExpUnicodeEscapeSequence(c,S)&&(_=c.lastIntValue),cn(_)?(c.lastIntValue=_,!0):(c.pos=m,!1)};function cn(c){return Dt(c,!0)||c===36||c===95}zt.regexp_eatRegExpIdentifierPart=function(c){var m=c.pos,S=this.options.ecmaVersion>=11,_=c.current(S);return c.advance(S),_===92&&this.regexp_eatRegExpUnicodeEscapeSequence(c,S)&&(_=c.lastIntValue),Lt(_)?(c.lastIntValue=_,!0):(c.pos=m,!1)};function Lt(c){return Er(c,!0)||c===36||c===95||c===8204||c===8205}zt.regexp_eatAtomEscape=function(c){return this.regexp_eatBackReference(c)||this.regexp_eatCharacterClassEscape(c)||this.regexp_eatCharacterEscape(c)||c.switchN&&this.regexp_eatKGroupName(c)?!0:(c.switchU&&(c.current()===99&&c.raise("Invalid unicode escape"),c.raise("Invalid escape")),!1)},zt.regexp_eatBackReference=function(c){var m=c.pos;if(this.regexp_eatDecimalEscape(c)){var S=c.lastIntValue;if(c.switchU)return S>c.maxBackReference&&(c.maxBackReference=S),!0;if(S<=c.numCapturingParens)return!0;c.pos=m}return!1},zt.regexp_eatKGroupName=function(c){if(c.eat(107)){if(this.regexp_eatGroupName(c))return c.backReferenceNames.push(c.lastStringValue),!0;c.raise("Invalid named reference")}return!1},zt.regexp_eatCharacterEscape=function(c){return this.regexp_eatControlEscape(c)||this.regexp_eatCControlLetter(c)||this.regexp_eatZero(c)||this.regexp_eatHexEscapeSequence(c)||this.regexp_eatRegExpUnicodeEscapeSequence(c,!1)||!c.switchU&&this.regexp_eatLegacyOctalEscapeSequence(c)||this.regexp_eatIdentityEscape(c)},zt.regexp_eatCControlLetter=function(c){var m=c.pos;if(c.eat(99)){if(this.regexp_eatControlLetter(c))return!0;c.pos=m}return!1},zt.regexp_eatZero=function(c){return c.current()===48&&!hi(c.lookahead())?(c.lastIntValue=0,c.advance(),!0):!1},zt.regexp_eatControlEscape=function(c){var m=c.current();return m===116?(c.lastIntValue=9,c.advance(),!0):m===110?(c.lastIntValue=10,c.advance(),!0):m===118?(c.lastIntValue=11,c.advance(),!0):m===102?(c.lastIntValue=12,c.advance(),!0):m===114?(c.lastIntValue=13,c.advance(),!0):!1},zt.regexp_eatControlLetter=function(c){var m=c.current();return on(m)?(c.lastIntValue=m%32,c.advance(),!0):!1};function on(c){return c>=65&&c<=90||c>=97&&c<=122}zt.regexp_eatRegExpUnicodeEscapeSequence=function(c,m){m===void 0&&(m=!1);var S=c.pos,_=m||c.switchU;if(c.eat(117)){if(this.regexp_eatFixedHexDigits(c,4)){var G=c.lastIntValue;if(_&&G>=55296&&G<=56319){var oe=c.pos;if(c.eat(92)&&c.eat(117)&&this.regexp_eatFixedHexDigits(c,4)){var je=c.lastIntValue;if(je>=56320&&je<=57343)return c.lastIntValue=(G-55296)*1024+(je-56320)+65536,!0}c.pos=oe,c.lastIntValue=G}return!0}if(_&&c.eat(123)&&this.regexp_eatHexDigits(c)&&c.eat(125)&&qr(c.lastIntValue))return!0;_&&c.raise("Invalid unicode escape"),c.pos=S}return!1};function qr(c){return c>=0&&c<=1114111}zt.regexp_eatIdentityEscape=function(c){if(c.switchU)return this.regexp_eatSyntaxCharacter(c)?!0:c.eat(47)?(c.lastIntValue=47,!0):!1;var m=c.current();return m!==99&&(!c.switchN||m!==107)?(c.lastIntValue=m,c.advance(),!0):!1},zt.regexp_eatDecimalEscape=function(c){c.lastIntValue=0;var m=c.current();if(m>=49&&m<=57){do c.lastIntValue=10*c.lastIntValue+(m-48),c.advance();while((m=c.current())>=48&&m<=57);return!0}return!1},zt.regexp_eatCharacterClassEscape=function(c){var m=c.current();if(Yr(m))return c.lastIntValue=-1,c.advance(),!0;if(c.switchU&&this.options.ecmaVersion>=9&&(m===80||m===112)){if(c.lastIntValue=-1,c.advance(),c.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(c)&&c.eat(125))return!0;c.raise("Invalid property name")}return!1};function Yr(c){return c===100||c===68||c===115||c===83||c===119||c===87}zt.regexp_eatUnicodePropertyValueExpression=function(c){var m=c.pos;if(this.regexp_eatUnicodePropertyName(c)&&c.eat(61)){var S=c.lastStringValue;if(this.regexp_eatUnicodePropertyValue(c)){var _=c.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(c,S,_),!0}}if(c.pos=m,this.regexp_eatLoneUnicodePropertyNameOrValue(c)){var G=c.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(c,G),!0}return!1},zt.regexp_validateUnicodePropertyNameAndValue=function(c,m,S){pe(c.unicodeProperties.nonBinary,m)||c.raise("Invalid property name"),c.unicodeProperties.nonBinary[m].test(S)||c.raise("Invalid property value")},zt.regexp_validateUnicodePropertyNameOrValue=function(c,m){c.unicodeProperties.binary.test(m)||c.raise("Invalid property name")},zt.regexp_eatUnicodePropertyName=function(c){var m=0;for(c.lastStringValue="";$n(m=c.current());)c.lastStringValue+=br(m),c.advance();return c.lastStringValue!==""};function $n(c){return on(c)||c===95}zt.regexp_eatUnicodePropertyValue=function(c){var m=0;for(c.lastStringValue="";$r(m=c.current());)c.lastStringValue+=br(m),c.advance();return c.lastStringValue!==""};function $r(c){return $n(c)||hi(c)}zt.regexp_eatLoneUnicodePropertyNameOrValue=function(c){return this.regexp_eatUnicodePropertyValue(c)},zt.regexp_eatCharacterClass=function(c){if(c.eat(91)){if(c.eat(94),this.regexp_classRanges(c),c.eat(93))return!0;c.raise("Unterminated character class")}return!1},zt.regexp_classRanges=function(c){for(;this.regexp_eatClassAtom(c);){var m=c.lastIntValue;if(c.eat(45)&&this.regexp_eatClassAtom(c)){var S=c.lastIntValue;c.switchU&&(m===-1||S===-1)&&c.raise("Invalid character class"),m!==-1&&S!==-1&&m>S&&c.raise("Range out of order in character class")}}},zt.regexp_eatClassAtom=function(c){var m=c.pos;if(c.eat(92)){if(this.regexp_eatClassEscape(c))return!0;if(c.switchU){var S=c.current();(S===99||fi(S))&&c.raise("Invalid class escape"),c.raise("Invalid escape")}c.pos=m}var _=c.current();return _!==93?(c.lastIntValue=_,c.advance(),!0):!1},zt.regexp_eatClassEscape=function(c){var m=c.pos;if(c.eat(98))return c.lastIntValue=8,!0;if(c.switchU&&c.eat(45))return c.lastIntValue=45,!0;if(!c.switchU&&c.eat(99)){if(this.regexp_eatClassControlLetter(c))return!0;c.pos=m}return this.regexp_eatCharacterClassEscape(c)||this.regexp_eatCharacterEscape(c)},zt.regexp_eatClassControlLetter=function(c){var m=c.current();return hi(m)||m===95?(c.lastIntValue=m%32,c.advance(),!0):!1},zt.regexp_eatHexEscapeSequence=function(c){var m=c.pos;if(c.eat(120)){if(this.regexp_eatFixedHexDigits(c,2))return!0;c.switchU&&c.raise("Invalid escape"),c.pos=m}return!1},zt.regexp_eatDecimalDigits=function(c){var m=c.pos,S=0;for(c.lastIntValue=0;hi(S=c.current());)c.lastIntValue=10*c.lastIntValue+(S-48),c.advance();return c.pos!==m};function hi(c){return c>=48&&c<=57}zt.regexp_eatHexDigits=function(c){var m=c.pos,S=0;for(c.lastIntValue=0;Oi(S=c.current());)c.lastIntValue=16*c.lastIntValue+Qn(S),c.advance();return c.pos!==m};function Oi(c){return c>=48&&c<=57||c>=65&&c<=70||c>=97&&c<=102}function Qn(c){return c>=65&&c<=70?10+(c-65):c>=97&&c<=102?10+(c-97):c-48}zt.regexp_eatLegacyOctalEscapeSequence=function(c){if(this.regexp_eatOctalDigit(c)){var m=c.lastIntValue;if(this.regexp_eatOctalDigit(c)){var S=c.lastIntValue;m<=3&&this.regexp_eatOctalDigit(c)?c.lastIntValue=m*64+S*8+c.lastIntValue:c.lastIntValue=m*8+S}else c.lastIntValue=m;return!0}return!1},zt.regexp_eatOctalDigit=function(c){var m=c.current();return fi(m)?(c.lastIntValue=m-48,c.advance(),!0):(c.lastIntValue=0,!1)};function fi(c){return c>=48&&c<=55}zt.regexp_eatFixedHexDigits=function(c,m){var S=c.pos;c.lastIntValue=0;for(var _=0;_<m;++_){var G=c.current();if(!Oi(G))return c.pos=S,!1;c.lastIntValue=16*c.lastIntValue+Qn(G),c.advance()}return!0};var ei=function(m){this.type=m.type,this.value=m.value,this.start=m.start,this.end=m.end,m.options.locations&&(this.loc=new E(m,m.startLoc,m.endLoc)),m.options.ranges&&(this.range=[m.start,m.end])},zn=ae.prototype;zn.next=function(c){!c&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new ei(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},zn.getToken=function(){return this.next(),new ei(this)},typeof Symbol!="undefined"&&(zn[Symbol.iterator]=function(){var c=this;return{next:function(){var m=c.getToken();return{done:m.type===k.eof,value:m}}}}),zn.curContext=function(){return this.context[this.context.length-1]},zn.nextToken=function(){var c=this.curContext();if((!c||!c.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(k.eof);if(c.override)return c.override(this);this.readToken(this.fullCharCodeAtPos())},zn.readToken=function(c){return Dt(c,this.options.ecmaVersion>=6)||c===92?this.readWord():this.getTokenFromCode(c)},zn.fullCharCodeAtPos=function(){var c=this.input.charCodeAt(this.pos);if(c<=55295||c>=57344)return c;var m=this.input.charCodeAt(this.pos+1);return(c<<10)+m-56613888},zn.skipBlockComment=function(){var c=this.options.onComment&&this.curPosition(),m=this.pos,S=this.input.indexOf("*/",this.pos+=2);if(S===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=S+2,this.options.locations){Se.lastIndex=m;for(var _;(_=Se.exec(this.input))&&_.index<this.pos;)++this.curLine,this.lineStart=_.index+_[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(m+2,S),m,this.pos,c,this.curPosition())},zn.skipLineComment=function(c){for(var m=this.pos,S=this.options.onComment&&this.curPosition(),_=this.input.charCodeAt(this.pos+=c);this.pos<this.input.length&&!me(_);)_=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(m+c,this.pos),m,this.pos,S,this.curPosition())},zn.skipSpace=function(){e:for(;this.pos<this.input.length;){var c=this.input.charCodeAt(this.pos);switch(c){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(c>8&&c<14||c>=5760&&De.test(String.fromCharCode(c)))++this.pos;else break e}}},zn.finishToken=function(c,m){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var S=this.type;this.type=c,this.value=m,this.updateContext(S)},zn.readToken_dot=function(){var c=this.input.charCodeAt(this.pos+1);if(c>=48&&c<=57)return this.readNumber(!0);var m=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&c===46&&m===46?(this.pos+=3,this.finishToken(k.ellipsis)):(++this.pos,this.finishToken(k.dot))},zn.readToken_slash=function(){var c=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):c===61?this.finishOp(k.assign,2):this.finishOp(k.slash,1)},zn.readToken_mult_modulo_exp=function(c){var m=this.input.charCodeAt(this.pos+1),S=1,_=c===42?k.star:k.modulo;return this.options.ecmaVersion>=7&&c===42&&m===42&&(++S,_=k.starstar,m=this.input.charCodeAt(this.pos+2)),m===61?this.finishOp(k.assign,S+1):this.finishOp(_,S)},zn.readToken_pipe_amp=function(c){var m=this.input.charCodeAt(this.pos+1);if(m===c){if(this.options.ecmaVersion>=12){var S=this.input.charCodeAt(this.pos+2);if(S===61)return this.finishOp(k.assign,3)}return this.finishOp(c===124?k.logicalOR:k.logicalAND,2)}return m===61?this.finishOp(k.assign,2):this.finishOp(c===124?k.bitwiseOR:k.bitwiseAND,1)},zn.readToken_caret=function(){var c=this.input.charCodeAt(this.pos+1);return c===61?this.finishOp(k.assign,2):this.finishOp(k.bitwiseXOR,1)},zn.readToken_plus_min=function(c){var m=this.input.charCodeAt(this.pos+1);return m===c?m===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Te.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(k.incDec,2):m===61?this.finishOp(k.assign,2):this.finishOp(k.plusMin,1)},zn.readToken_lt_gt=function(c){var m=this.input.charCodeAt(this.pos+1),S=1;return m===c?(S=c===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+S)===61?this.finishOp(k.assign,S+1):this.finishOp(k.bitShift,S)):m===33&&c===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(m===61&&(S=2),this.finishOp(k.relational,S))},zn.readToken_eq_excl=function(c){var m=this.input.charCodeAt(this.pos+1);return m===61?this.finishOp(k.equality,this.input.charCodeAt(this.pos+2)===61?3:2):c===61&&m===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(k.arrow)):this.finishOp(c===61?k.eq:k.prefix,1)},zn.readToken_question=function(){var c=this.options.ecmaVersion;if(c>=11){var m=this.input.charCodeAt(this.pos+1);if(m===46){var S=this.input.charCodeAt(this.pos+2);if(S<48||S>57)return this.finishOp(k.questionDot,2)}if(m===63){if(c>=12){var _=this.input.charCodeAt(this.pos+2);if(_===61)return this.finishOp(k.assign,3)}return this.finishOp(k.coalesce,2)}}return this.finishOp(k.question,1)},zn.getTokenFromCode=function(c){switch(c){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(k.parenL);case 41:return++this.pos,this.finishToken(k.parenR);case 59:return++this.pos,this.finishToken(k.semi);case 44:return++this.pos,this.finishToken(k.comma);case 91:return++this.pos,this.finishToken(k.bracketL);case 93:return++this.pos,this.finishToken(k.bracketR);case 123:return++this.pos,this.finishToken(k.braceL);case 125:return++this.pos,this.finishToken(k.braceR);case 58:return++this.pos,this.finishToken(k.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(k.backQuote);case 48:var m=this.input.charCodeAt(this.pos+1);if(m===120||m===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(m===111||m===79)return this.readRadixNumber(8);if(m===98||m===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(c);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(c);case 124:case 38:return this.readToken_pipe_amp(c);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(c);case 60:case 62:return this.readToken_lt_gt(c);case 61:case 33:return this.readToken_eq_excl(c);case 63:return this.readToken_question();case 126:return this.finishOp(k.prefix,1)}this.raise(this.pos,"Unexpected character '"+_i(c)+"'")},zn.finishOp=function(c,m){var S=this.input.slice(this.pos,this.pos+m);return this.pos+=m,this.finishToken(c,S)},zn.readRegexp=function(){for(var c,m,S=this.pos;;){this.pos>=this.input.length&&this.raise(S,"Unterminated regular expression");var _=this.input.charAt(this.pos);if(Te.test(_)&&this.raise(S,"Unterminated regular expression"),c)c=!1;else{if(_==="[")m=!0;else if(_==="]"&&m)m=!1;else if(_==="/"&&!m)break;c=_==="\\"}++this.pos}var G=this.input.slice(S,this.pos);++this.pos;var oe=this.pos,je=this.readWord1();this.containsEsc&&this.unexpected(oe);var lt=this.regexpState||(this.regexpState=new Nt(this));lt.reset(S,G,je),this.validateRegExpFlags(lt),this.validateRegExpPattern(lt);var gt=null;try{gt=new RegExp(G,je)}catch(hr){}return this.finishToken(k.regexp,{pattern:G,flags:je,value:gt})},zn.readInt=function(c,m,S){for(var _=this.options.ecmaVersion>=12&&m===void 0,G=S&&this.input.charCodeAt(this.pos)===48,oe=this.pos,je=0,lt=0,gt=0,hr=m==null?Infinity:m;gt<hr;++gt,++this.pos){var cr=this.input.charCodeAt(this.pos),Cn=void 0;if(_&&cr===95){G&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),lt===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),gt===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),lt=cr;continue}if(cr>=97?Cn=cr-97+10:cr>=65?Cn=cr-65+10:cr>=48&&cr<=57?Cn=cr-48:Cn=Infinity,Cn>=c)break;lt=cr,je=je*c+Cn}return _&&lt===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===oe||m!=null&&this.pos-oe!==m?null:je};function Wn(c,m){return m?parseInt(c,8):parseFloat(c.replace(/_/g,""))}function Qi(c){return typeof BigInt!="function"?null:BigInt(c.replace(/_/g,""))}zn.readRadixNumber=function(c){var m=this.pos;this.pos+=2;var S=this.readInt(c);return S==null&&this.raise(this.start+2,"Expected number in radix "+c),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(S=Qi(this.input.slice(m,this.pos)),++this.pos):Dt(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(k.num,S)},zn.readNumber=function(c){var m=this.pos;!c&&this.readInt(10,void 0,!0)===null&&this.raise(m,"Invalid number");var S=this.pos-m>=2&&this.input.charCodeAt(m)===48;S&&this.strict&&this.raise(m,"Invalid number");var _=this.input.charCodeAt(this.pos);if(!S&&!c&&this.options.ecmaVersion>=11&&_===110){var G=Qi(this.input.slice(m,this.pos));return++this.pos,Dt(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(k.num,G)}S&&/[89]/.test(this.input.slice(m,this.pos))&&(S=!1),_===46&&!S&&(++this.pos,this.readInt(10),_=this.input.charCodeAt(this.pos)),(_===69||_===101)&&!S&&(_=this.input.charCodeAt(++this.pos),(_===43||_===45)&&++this.pos,this.readInt(10)===null&&this.raise(m,"Invalid number")),Dt(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var oe=Wn(this.input.slice(m,this.pos),S);return this.finishToken(k.num,oe)},zn.readCodePoint=function(){var c=this.input.charCodeAt(this.pos),m;if(c===123){this.options.ecmaVersion<6&&this.unexpected();var S=++this.pos;m=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,m>1114111&&this.invalidStringToken(S,"Code point out of bounds")}else m=this.readHexChar(4);return m};function _i(c){return c<=65535?String.fromCharCode(c):(c-=65536,String.fromCharCode((c>>10)+55296,(c&1023)+56320))}zn.readString=function(c){for(var m="",S=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var _=this.input.charCodeAt(this.pos);if(_===c)break;_===92?(m+=this.input.slice(S,this.pos),m+=this.readEscapedChar(!1),S=this.pos):(me(_,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return m+=this.input.slice(S,this.pos++),this.finishToken(k.string,m)};var di={};zn.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(c){if(c===di)this.readInvalidTemplateToken();else throw c}this.inTemplateElement=!1},zn.invalidStringToken=function(c,m){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw di;this.raise(c,m)},zn.readTmplToken=function(){for(var c="",m=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var S=this.input.charCodeAt(this.pos);if(S===96||S===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===k.template||this.type===k.invalidTemplate)?S===36?(this.pos+=2,this.finishToken(k.dollarBraceL)):(++this.pos,this.finishToken(k.backQuote)):(c+=this.input.slice(m,this.pos),this.finishToken(k.template,c));if(S===92)c+=this.input.slice(m,this.pos),c+=this.readEscapedChar(!0),m=this.pos;else if(me(S)){switch(c+=this.input.slice(m,this.pos),++this.pos,S){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:c+=`
`;break;default:c+=String.fromCharCode(S);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),m=this.pos}else++this.pos}},zn.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(k.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},zn.readEscapedChar=function(c){var m=this.input.charCodeAt(++this.pos);switch(++this.pos,m){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return _i(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(c){var S=this.pos-1;return this.invalidStringToken(S,"Invalid escape sequence in template string"),null}default:if(m>=48&&m<=55){var _=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],G=parseInt(_,8);return G>255&&(_=_.slice(0,-1),G=parseInt(_,8)),this.pos+=_.length-1,m=this.input.charCodeAt(this.pos),(_!=="0"||m===56||m===57)&&(this.strict||c)&&this.invalidStringToken(this.pos-1-_.length,c?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(G)}return me(m)?"":String.fromCharCode(m)}},zn.readHexChar=function(c){var m=this.pos,S=this.readInt(16,c);return S===null&&this.invalidStringToken(m,"Bad character escape sequence"),S},zn.readWord1=function(){this.containsEsc=!1;for(var c="",m=!0,S=this.pos,_=this.options.ecmaVersion>=6;this.pos<this.input.length;){var G=this.fullCharCodeAtPos();if(Er(G,_))this.pos+=G<=65535?1:2;else if(G===92){this.containsEsc=!0,c+=this.input.slice(S,this.pos);var oe=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var je=this.readCodePoint();(m?Dt:Er)(je,_)||this.invalidStringToken(oe,"Invalid Unicode escape"),c+=_i(je),S=this.pos}else break;m=!1}return c+this.input.slice(S,this.pos)},zn.readWord=function(){var c=this.readWord1(),m=k.name;return this.keywords.test(c)&&(m=kt[c]),this.finishToken(m,c)};var vi="7.4.1";ae.acorn={Parser:ae,version:vi,defaultOptions:q,Position:B,SourceLocation:E,getLineInfo:D,Node:jr,TokenType:wt,tokTypes:k,keywordTypes:kt,TokContext:Mi,tokContexts:Li,isIdentifierChar:Er,isIdentifierStart:Dt,Token:ei,isNewLine:me,lineBreak:Te,lineBreakG:Se,nonASCIIwhitespace:De};function oa(c,m){return ae.parse(c,m)}function ns(c,m,S){return ae.parseExpressionAt(c,m,S)}function ea(c,m){return ae.tokenizer(c,m)}function zi(c,m){c.prototype=Object.create(m.prototype),c.prototype.constructor=c,c.__proto__=m}function yo(c){var m=typeof Map=="function"?new Map:void 0;return yo=function(_){if(_===null||!So(_))return _;if(typeof _!="function")throw new TypeError("Super expression must either be null or a function");if(typeof m!="undefined"){if(m.has(_))return m.get(_);m.set(_,G)}function G(){return Di(_,arguments,na(this).constructor)}return G.prototype=Object.create(_.prototype,{constructor:{value:G,enumerable:!1,writable:!0,configurable:!0}}),ya(G,_)},yo(c)}function $a(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(c){return!1}}function Di(c,m,S){return $a()?Di=Reflect.construct:Di=function(G,oe,je){var lt=[null];lt.push.apply(lt,oe);var gt=Function.bind.apply(G,lt),hr=new gt;return je&&ya(hr,je.prototype),hr},Di.apply(null,arguments)}function So(c){return Function.toString.call(c).indexOf("[native code]")!==-1}function ya(c,m){return ya=Object.setPrototypeOf||function(_,G){return _.__proto__=G,_},ya(c,m)}function na(c){return na=Object.setPrototypeOf?Object.getPrototypeOf:function(S){return S.__proto__||Object.getPrototypeOf(S)},na(c)}var ga=function(c){zi(m,c);function m(){return c.apply(this,arguments)||this}return m}(yo(Error)),Bi=function(c){zi(m,c);function m(){return c.apply(this,arguments)||this}return m}(yo(SyntaxError)),wa=function(c){zi(m,c);function m(){return c.apply(this,arguments)||this}return m}(yo(ReferenceError)),Qa=function(c){zi(m,c);function m(){return c.apply(this,arguments)||this}return m}(yo(TypeError)),_s=function(c){zi(m,c);function m(){return c.apply(this,arguments)||this}return m}(ga),Ga=function(c){zi(m,c);function m(){return c.apply(this,arguments)||this}return m}(Bi),eo=function(c){zi(m,c);function m(){return c.apply(this,arguments)||this}return m}(wa),Hi={UnknownError:[3001,"%0",_s],ExecutionTimeOutError:[3002,"Script execution timed out after %0ms",_s],NodeTypeSyntaxError:[1001,"Unknown node type: %0",eo],BinaryOperatorSyntaxError:[1002,"Unknown binary operator: %0",eo],LogicalOperatorSyntaxError:[1003,"Unknown logical operator: %0",eo],UnaryOperatorSyntaxError:[1004,"Unknown unary operator: %0",eo],UpdateOperatorSyntaxError:[1005,"Unknown update operator: %0",eo],ObjectStructureSyntaxError:[1006,"Unknown object structure: %0",eo],AssignmentExpressionSyntaxError:[1007,"Unknown assignment expression: %0",eo],VariableTypeSyntaxError:[1008,"Unknown variable type: %0",eo],ParamTypeSyntaxError:[1009,"Unknown param type: %0",eo],AssignmentTypeSyntaxError:[1010,"Unknown assignment type: %0",eo],FunctionUndefinedReferenceError:[2001,"%0 is not a function",wa],VariableUndefinedReferenceError:[2002,"%0 is not defined",wa],IsNotConstructor:[2003,"%0 is not a constructor",Qa]};function Pa(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(c){return!1}}function go(c,m,S){return Pa()?go=Reflect.construct:go=function(G,oe,je){var lt=[null];lt.push.apply(lt,oe);var gt=Function.bind.apply(G,lt),hr=new gt;return je&&Ma(hr,je.prototype),hr},go.apply(null,arguments)}function Ma(c,m){return Ma=Object.setPrototypeOf||function(_,G){return _.__proto__=G,_},Ma(c,m)}var ls="0.0.3";function ou(c,m){Object.defineProperty(c,"name",{value:m,writable:!1,enumerable:!1,configurable:!0})}var _o=Object.prototype.hasOwnProperty,W=Symbol("Break"),ue=Symbol("Continue"),Je=Symbol("DefaultCase"),Ft=Symbol("EmptyStatementReturn"),Rr=Symbol("WithScopeName"),An=Symbol("SuperScopeName"),mi=Symbol("RootScopeName"),_a=Symbol("GlobalScopeName");function sa(c){return typeof c=="function"}var xa=function(){function c(S){this.interpreter=S}var m=c.prototype;return m.generator=function(){var _=this.interpreter;function G(){return this.getCurrentScope()}function oe(){return this.getGlobalScope()}function je(){return this.getCurrentContext()}return{getOptions:_.getOptions.bind(_),getCurrentScope:G.bind(_),getGlobalScope:oe.bind(_),getCurrentContext:je.bind(_),getExecStartTime:_.getExecStartTime.bind(_)}},c}();function Fa(c,m,S){if(S===void 0&&(S=!0),!(c instanceof xa))throw new Error("Illegal call");if(typeof m!="string")return m;if(!!m){var _=c.generator(),G=_.getOptions(),oe={timeout:G.timeout,_initEnv:function(){S||this.setCurrentContext(_.getCurrentContext()),this.execStartTime=_.getExecStartTime(),this.execEndTime=this.execStartTime}},je=S?_.getGlobalScope():_.getCurrentScope(),lt=new qa(je,oe);return lt.evaluate(m)}}Object.defineProperty(Fa,"__IS_EVAL_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});function To(c){if(!(c instanceof xa))throw new Error("Illegal call");for(var m=c.generator(),S=arguments.length,_=new Array(S>1?S-1:0),G=1;G<S;G++)_[G-1]=arguments[G];var oe=_.pop(),je=new qa(m.getGlobalScope(),m.getOptions()),lt=`
		    (function anonymous(`+_.join(",")+`){
		        `+oe+`
		    });
		    `;return je.evaluate(lt)}Object.defineProperty(To,"__IS_FUNCTION_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});var so=function(m){this.value=m},za=function(m){this.value=m},xo=function(m){this.value=m},uo=function(m,S,_){S===void 0&&(S=null),this.name=_,this.parent=S,this.data=m,this.labelStack=[]};function Ho(){}function is(c,m){return c===void 0&&(c=null),new uo(Object.create(null),c,m)}function ja(c){return Object.create(c)}var Wi={NaN:NaN,Infinity:Infinity,undefined:void 0,Object,Array,String,Boolean,Number,Date,RegExp,Error,URIError,TypeError,RangeError,SyntaxError,ReferenceError,Float32Array,Float64Array,Uint32Array,Math,parseInt,parseFloat,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,escape,unescape,eval:Fa,Function:To};typeof JSON!="undefined"&&(Wi.JSON=JSON),typeof Promise!="undefined"&&(Wi.Promise=Promise),typeof Set!="undefined"&&(Wi.Set=Set),typeof Map!="undefined"&&(Wi.Map=Map),typeof Symbol!="undefined"&&(Wi.Symbol=Symbol),typeof Proxy!="undefined"&&(Wi.Proxy=Proxy),typeof WeakMap!="undefined"&&(Wi.WeakMap=WeakMap),typeof WeakSet!="undefined"&&(Wi.WeakSet=WeakSet),typeof Reflect!="undefined"&&(Wi.Reflect=Reflect);var qa=function(){function c(S,_){S===void 0&&(S=c.global),_===void 0&&(_={}),this.sourceList=[],this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.isVarDeclMode=!1,this.lastExecNode=null,this.isRunning=!1,this.options={ecmaVersion:_.ecmaVersion||c.ecmaVersion,timeout:_.timeout||0,rootContext:_.rootContext,globalContextInFunction:_.globalContextInFunction===void 0?c.globalContextInFunction:_.globalContextInFunction,_initEnv:_._initEnv},this.context=S||Object.create(null),this.callStack=[],this.initEnvironment(this.context)}var m=c.prototype;return m.initEnvironment=function(_){var G;if(_ instanceof uo)G=_;else{var oe=null,je=this.createSuperScope(_);this.options.rootContext&&(oe=new uo(ja(this.options.rootContext),je,mi)),G=new uo(_,oe||je,_a)}this.globalScope=G,this.currentScope=this.globalScope,this.globalContext=G.data,this.currentContext=G.data,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.execStartTime=Date.now(),this.execEndTime=this.execStartTime;var lt=this.options._initEnv;lt&&lt.call(this)},m.getExecStartTime=function(){return this.execStartTime},m.getExecutionTime=function(){return this.execEndTime-this.execStartTime},m.setExecTimeout=function(_){_===void 0&&(_=0),this.options.timeout=_},m.getOptions=function(){return this.options},m.getGlobalScope=function(){return this.globalScope},m.getCurrentScope=function(){return this.currentScope},m.getCurrentContext=function(){return this.currentContext},m.isInterruptThrow=function(_){return _ instanceof _s||_ instanceof eo||_ instanceof Ga},m.createSuperScope=function(_){var G=Object.assign({},Wi),oe=Object.keys(G);return oe.forEach(function(je){je in _&&delete G[je]}),new uo(G,null,An)},m.setCurrentContext=function(_){this.currentContext=_},m.setCurrentScope=function(_){this.currentScope=_},m.evaluate=function(_){_===void 0&&(_="");var G;if(!!_)return G=oa(_,{ranges:!0,locations:!0,ecmaVersion:this.options.ecmaVersion||c.ecmaVersion}),this.evaluateNode(G,_)},m.appendCode=function(_){return this.evaluate(_)},m.evaluateNode=function(_,G){var oe=this;G===void 0&&(G=""),this.value=void 0,this.source=G,this.sourceList.push(G),this.isRunning=!0,this.execStartTime=Date.now(),this.execEndTime=this.execStartTime,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var je=this.getCurrentScope(),lt=this.getCurrentContext(),gt=je.labelStack.concat([]),hr=this.callStack.concat([]),cr=function(){oe.setCurrentScope(je),oe.setCurrentContext(lt),je.labelStack=gt,oe.callStack=hr};try{var Cn=this.createClosure(_);this.addDeclarationsToScope(this.collectDeclVars,this.collectDeclFuncs,this.getCurrentScope()),Cn()}catch(Xn){throw Xn}finally{cr(),this.execEndTime=Date.now()}return this.isRunning=!1,this.getValue()},m.createErrorMessage=function(_,G,oe){var je=_[1].replace("%0",String(G));return oe!==null&&(je+=this.getNodePosition(oe||this.lastExecNode)),je},m.createError=function(_,G){return new G(_)},m.createThrowError=function(_,G){return this.createError(_,G)},m.createInternalThrowError=function(_,G,oe){return this.createError(this.createErrorMessage(_,G,oe),_[2])},m.checkTimeout=function(){if(!this.isRunning)return!1;var _=this.options.timeout||0,G=Date.now();return G-this.execStartTime>_},m.getNodePosition=function(_){if(_){var G="";return _.loc?" ["+_.loc.start.line+":"+_.loc.start.column+"]"+G:""}return""},m.createClosure=function(_){var G=this,oe;switch(_.type){case"BinaryExpression":oe=this.binaryExpressionHandler(_);break;case"LogicalExpression":oe=this.logicalExpressionHandler(_);break;case"UnaryExpression":oe=this.unaryExpressionHandler(_);break;case"UpdateExpression":oe=this.updateExpressionHandler(_);break;case"ObjectExpression":oe=this.objectExpressionHandler(_);break;case"ArrayExpression":oe=this.arrayExpressionHandler(_);break;case"CallExpression":oe=this.callExpressionHandler(_);break;case"NewExpression":oe=this.newExpressionHandler(_);break;case"MemberExpression":oe=this.memberExpressionHandler(_);break;case"ThisExpression":oe=this.thisExpressionHandler(_);break;case"SequenceExpression":oe=this.sequenceExpressionHandler(_);break;case"Literal":oe=this.literalHandler(_);break;case"Identifier":oe=this.identifierHandler(_);break;case"AssignmentExpression":oe=this.assignmentExpressionHandler(_);break;case"FunctionDeclaration":oe=this.functionDeclarationHandler(_);break;case"VariableDeclaration":oe=this.variableDeclarationHandler(_);break;case"BlockStatement":case"Program":oe=this.programHandler(_);break;case"ExpressionStatement":oe=this.expressionStatementHandler(_);break;case"EmptyStatement":oe=this.emptyStatementHandler(_);break;case"ReturnStatement":oe=this.returnStatementHandler(_);break;case"FunctionExpression":oe=this.functionExpressionHandler(_);break;case"IfStatement":oe=this.ifStatementHandler(_);break;case"ConditionalExpression":oe=this.conditionalExpressionHandler(_);break;case"ForStatement":oe=this.forStatementHandler(_);break;case"WhileStatement":oe=this.whileStatementHandler(_);break;case"DoWhileStatement":oe=this.doWhileStatementHandler(_);break;case"ForInStatement":oe=this.forInStatementHandler(_);break;case"WithStatement":oe=this.withStatementHandler(_);break;case"ThrowStatement":oe=this.throwStatementHandler(_);break;case"TryStatement":oe=this.tryStatementHandler(_);break;case"ContinueStatement":oe=this.continueStatementHandler(_);break;case"BreakStatement":oe=this.breakStatementHandler(_);break;case"SwitchStatement":oe=this.switchStatementHandler(_);break;case"LabeledStatement":oe=this.labeledStatementHandler(_);break;case"DebuggerStatement":oe=this.debuggerStatementHandler(_);break;default:throw this.createInternalThrowError(Hi.NodeTypeSyntaxError,_.type,_)}return function(){var je=G.options.timeout;if(je&&je>0&&G.checkTimeout())throw G.createInternalThrowError(Hi.ExecutionTimeOutError,je,null);return G.lastExecNode=_,oe.apply(void 0,arguments)}},m.binaryExpressionHandler=function(_){var G=this,oe=this.createClosure(_.left),je=this.createClosure(_.right);return function(){var lt=oe(),gt=je();switch(_.operator){case"==":return lt==gt;case"!=":return lt!=gt;case"===":return lt===gt;case"!==":return lt!==gt;case"<":return lt<gt;case"<=":return lt<=gt;case">":return lt>gt;case">=":return lt>=gt;case"<<":return lt<<gt;case">>":return lt>>gt;case">>>":return lt>>>gt;case"+":return lt+gt;case"-":return lt-gt;case"*":return lt*gt;case"**":return Math.pow(lt,gt);case"/":return lt/gt;case"%":return lt%gt;case"|":return lt|gt;case"^":return lt^gt;case"&":return lt&gt;case"in":return lt in gt;case"instanceof":return lt instanceof gt;default:throw G.createInternalThrowError(Hi.BinaryOperatorSyntaxError,_.operator,_)}}},m.logicalExpressionHandler=function(_){var G=this,oe=this.createClosure(_.left),je=this.createClosure(_.right);return function(){switch(_.operator){case"||":return oe()||je();case"&&":return oe()&&je();default:throw G.createInternalThrowError(Hi.LogicalOperatorSyntaxError,_.operator,_)}}},m.unaryExpressionHandler=function(_){var G=this;switch(_.operator){case"delete":var oe=this.createObjectGetter(_.argument),je=this.createNameGetter(_.argument);return function(){var cr=oe(),Cn=je();return delete cr[Cn]};default:var lt;if(_.operator==="typeof"&&_.argument.type==="Identifier"){var gt=this.createObjectGetter(_.argument),hr=this.createNameGetter(_.argument);lt=function(){return gt()[hr()]}}else lt=this.createClosure(_.argument);return function(){var cr=lt();switch(_.operator){case"-":return-cr;case"+":return+cr;case"!":return!cr;case"~":return~cr;case"void":return;case"typeof":return typeof cr;default:throw G.createInternalThrowError(Hi.UnaryOperatorSyntaxError,_.operator,_)}}}},m.updateExpressionHandler=function(_){var G=this,oe=this.createObjectGetter(_.argument),je=this.createNameGetter(_.argument);return function(){var lt=oe(),gt=je();switch(G.assertVariable(lt,gt,_),_.operator){case"++":return _.prefix?++lt[gt]:lt[gt]++;case"--":return _.prefix?--lt[gt]:lt[gt]--;default:throw G.createInternalThrowError(Hi.UpdateOperatorSyntaxError,_.operator,_)}}},m.objectExpressionHandler=function(_){var G=this,oe=[];function je(gt){return gt.type==="Identifier"?gt.name:gt.type==="Literal"?gt.value:this.throwError(Hi.ObjectStructureSyntaxError,gt.type,gt)}var lt=Object.create(null);return _.properties.forEach(function(gt){var hr=gt.kind,cr=je(gt.key);(!lt[cr]||hr==="init")&&(lt[cr]={}),lt[cr][hr]=G.createClosure(gt.value),oe.push({key:cr,property:gt})}),function(){for(var gt={},hr=oe.length,cr=0;cr<hr;cr++){var Cn=oe[cr],Xn=Cn.key,sn=lt[Xn],Ai=sn.init?sn.init():void 0,Fi=sn.get?sn.get():function(){},Gi=sn.set?sn.set():function(Gs){};if("set"in sn||"get"in sn){var bi={configurable:!0,enumerable:!0,get:Fi,set:Gi};Object.defineProperty(gt,Xn,bi)}else{var Ao=Cn.property,hs=Ao.kind;Ao.key.type==="Identifier"&&Ao.value.type==="FunctionExpression"&&hs==="init"&&!Ao.value.id&&ou(Ai,Ao.key.name),gt[Xn]=Ai}}return gt}},m.arrayExpressionHandler=function(_){var G=this,oe=_.elements.map(function(je){return je&&G.createClosure(je)});return function(){for(var je=oe.length,lt=Array(je),gt=0;gt<je;gt++){var hr=oe[gt];hr&&(lt[gt]=hr())}return lt}},m.safeObjectGet=function(_,G,oe){return _[G]},m.createCallFunctionGetter=function(_){var G=this;switch(_.type){case"MemberExpression":var oe=this.createClosure(_.object),je=this.createMemberKeyGetter(_),lt=this.source;return function(){var hr=oe(),cr=je(),Cn=G.safeObjectGet(hr,cr,_);if(!Cn||!sa(Cn)){var Xn=lt.slice(_.start,_.end);throw G.createInternalThrowError(Hi.FunctionUndefinedReferenceError,Xn,_)}return Cn.__IS_EVAL_FUNC?function(sn){return Cn(new xa(G),sn,!0)}:Cn.__IS_FUNCTION_FUNC?function(){for(var sn=arguments.length,Ai=new Array(sn),Fi=0;Fi<sn;Fi++)Ai[Fi]=arguments[Fi];return Cn.apply(void 0,[new xa(G)].concat(Ai))}:Cn.bind(hr)};default:var gt=this.createClosure(_);return function(){var hr="";_.type==="Identifier"&&(hr=_.name);var cr=gt();if(!cr||!sa(cr))throw G.createInternalThrowError(Hi.FunctionUndefinedReferenceError,hr,_);if(_.type==="Identifier"&&cr.__IS_EVAL_FUNC&&hr==="eval")return function(sn){var Ai=G.getScopeFromName(hr,G.getCurrentScope()),Fi=Ai.name===An||Ai.name===_a||Ai.name===mi;return cr(new xa(G),sn,!Fi)};if(cr.__IS_EVAL_FUNC)return function(sn){return cr(new xa(G),sn,!0)};if(cr.__IS_FUNCTION_FUNC)return function(){for(var sn=arguments.length,Ai=new Array(sn),Fi=0;Fi<sn;Fi++)Ai[Fi]=arguments[Fi];return cr.apply(void 0,[new xa(G)].concat(Ai))};var Cn=G.options.globalContextInFunction;if(_.type==="Identifier"){var Xn=G.getIdentifierScope(_);Xn.name===Rr&&(Cn=Xn.data)}return cr.bind(Cn)}}},m.callExpressionHandler=function(_){var G=this,oe=this.createCallFunctionGetter(_.callee),je=_.arguments.map(function(lt){return G.createClosure(lt)});return function(){return oe().apply(void 0,je.map(function(lt){return lt()}))}},m.functionExpressionHandler=function(_){var G=this,oe=this,je=this.source,lt=this.collectDeclVars,gt=this.collectDeclFuncs;this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var hr=_.id?_.id.name:"",cr=_.params.length,Cn=_.params.map(function(Fi){return G.createParamNameGetter(Fi)}),Xn=this.createClosure(_.body),sn=this.collectDeclVars,Ai=this.collectDeclFuncs;return this.collectDeclVars=lt,this.collectDeclFuncs=gt,function(){var Fi=oe.getCurrentScope(),Gi=function bi(){for(var Ao=arguments.length,hs=new Array(Ao),Gs=0;Gs<Ao;Gs++)hs[Gs]=arguments[Gs];oe.callStack.push(""+hr);var Qu=oe.getCurrentScope(),Ms=is(Fi,"FunctionScope("+hr+")");oe.setCurrentScope(Ms),oe.addDeclarationsToScope(sn,Ai,Ms),hr&&(Ms.data[hr]=bi),Ms.data.arguments=arguments,Cn.forEach(function(bs,ws){Ms.data[bs()]=hs[ws]});var Eu=oe.getCurrentContext();oe.setCurrentContext(this);var xs=Xn();if(oe.setCurrentContext(Eu),oe.setCurrentScope(Qu),oe.callStack.pop(),xs instanceof so)return xs.value};return ou(Gi,hr),Object.defineProperty(Gi,"length",{value:cr,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(Gi,"toString",{value:function(){return je.slice(_.start,_.end)},writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(Gi,"valueOf",{value:function(){return je.slice(_.start,_.end)},writable:!0,configurable:!0,enumerable:!1}),Gi}},m.newExpressionHandler=function(_){var G=this,oe=this.source,je=this.createClosure(_.callee),lt=_.arguments.map(function(gt){return G.createClosure(gt)});return function(){var gt=je();if(!sa(gt)||gt.__IS_EVAL_FUNC){var hr=_.callee,cr=oe.slice(hr.start,hr.end);throw G.createInternalThrowError(Hi.IsNotConstructor,cr,_)}return gt.__IS_FUNCTION_FUNC?gt.apply(void 0,[new xa(G)].concat(lt.map(function(Cn){return Cn()}))):go(gt,lt.map(function(Cn){return Cn()}))}},m.memberExpressionHandler=function(_){var G=this.createClosure(_.object),oe=this.createMemberKeyGetter(_);return function(){var je=G(),lt=oe();return je[lt]}},m.thisExpressionHandler=function(_){var G=this;return function(){return G.getCurrentContext()}},m.sequenceExpressionHandler=function(_){var G=this,oe=_.expressions.map(function(je){return G.createClosure(je)});return function(){for(var je,lt=oe.length,gt=0;gt<lt;gt++){var hr=oe[gt];je=hr()}return je}},m.literalHandler=function(_){return function(){return _.regex?new RegExp(_.regex.pattern,_.regex.flags):_.value}},m.identifierHandler=function(_){var G=this;return function(){var oe=G.getCurrentScope(),je=G.getScopeDataFromName(_.name,oe);return G.assertVariable(je,_.name,_),je[_.name]}},m.getIdentifierScope=function(_){var G=this.getCurrentScope(),oe=this.getScopeFromName(_.name,G);return oe},m.assignmentExpressionHandler=function(_){var G=this;_.left.type==="Identifier"&&_.right.type==="FunctionExpression"&&!_.right.id&&(_.right.id={type:"Identifier",name:_.left.name});var oe=this.createObjectGetter(_.left),je=this.createNameGetter(_.left),lt=this.createClosure(_.right);return function(){var gt=oe(),hr=je(),cr=lt();switch(_.operator!=="="&&G.assertVariable(gt,hr,_),_.operator){case"=":return gt[hr]=cr;case"+=":return gt[hr]+=cr;case"-=":return gt[hr]-=cr;case"*=":return gt[hr]*=cr;case"**=":return gt[hr]=Math.pow(gt[hr],cr);case"/=":return gt[hr]/=cr;case"%=":return gt[hr]%=cr;case"<<=":return gt[hr]<<=cr;case">>=":return gt[hr]>>=cr;case">>>=":return gt[hr]>>>=cr;case"&=":return gt[hr]&=cr;case"^=":return gt[hr]^=cr;case"|=":return gt[hr]|=cr;default:throw G.createInternalThrowError(Hi.AssignmentExpressionSyntaxError,_.type,_)}}},m.functionDeclarationHandler=function(_){if(_.id){var G=this.functionExpressionHandler(_);Object.defineProperty(G,"isFunctionDeclareClosure",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.funcDeclaration(_.id.name,G)}return function(){return Ft}},m.getVariableName=function(_){if(_.type==="Identifier")return _.name;throw this.createInternalThrowError(Hi.VariableTypeSyntaxError,_.type,_)},m.variableDeclarationHandler=function(_){for(var G=this,oe,je=[],lt=0;lt<_.declarations.length;lt++){var gt=_.declarations[lt];this.varDeclaration(this.getVariableName(gt.id)),gt.init&&je.push({type:"AssignmentExpression",operator:"=",left:gt.id,right:gt.init})}return je.length&&(oe=this.createClosure({type:"BlockStatement",body:je})),function(){if(oe){var hr=G.isVarDeclMode;G.isVarDeclMode=!0,oe(),G.isVarDeclMode=hr}return Ft}},m.assertVariable=function(_,G,oe){if(_===this.globalScope.data&&!(G in _))throw this.createInternalThrowError(Hi.VariableUndefinedReferenceError,G,oe)},m.programHandler=function(_){var G=this,oe=_.body.map(function(je){return G.createClosure(je)});return function(){for(var je=Ft,lt=0;lt<oe.length;lt++){var gt=oe[lt],hr=G.setValue(gt());if(hr!==Ft&&(je=hr,je instanceof so||je instanceof za||je instanceof xo||je===W||je===ue))break}return je}},m.expressionStatementHandler=function(_){return this.createClosure(_.expression)},m.emptyStatementHandler=function(_){return function(){return Ft}},m.returnStatementHandler=function(_){var G=_.argument?this.createClosure(_.argument):Ho;return function(){return new so(G())}},m.ifStatementHandler=function(_){var G=this.createClosure(_.test),oe=this.createClosure(_.consequent),je=_.alternate?this.createClosure(_.alternate):function(){return Ft};return function(){return G()?oe():je()}},m.conditionalExpressionHandler=function(_){return this.ifStatementHandler(_)},m.forStatementHandler=function(_){var G=this,oe=Ho,je=_.test?this.createClosure(_.test):function(){return!0},lt=Ho,gt=this.createClosure(_.body);return _.type==="ForStatement"&&(oe=_.init?this.createClosure(_.init):oe,lt=_.update?this.createClosure(_.update):Ho),function(hr){var cr,Cn=Ft,Xn=_.type==="DoWhileStatement";for(hr&&hr.type==="LabeledStatement"&&(cr=hr.label.name),oe();Xn||je();lt()){Xn=!1;var sn=G.setValue(gt());if(!(sn===Ft||sn===ue)){if(sn===W)break;if(Cn=sn,Cn instanceof xo&&Cn.value===cr){Cn=Ft;continue}if(Cn instanceof so||Cn instanceof za||Cn instanceof xo)break}}return Cn}},m.whileStatementHandler=function(_){return this.forStatementHandler(_)},m.doWhileStatementHandler=function(_){return this.forStatementHandler(_)},m.forInStatementHandler=function(_){var G=this,oe=_.left,je=this.createClosure(_.right),lt=this.createClosure(_.body);return _.left.type==="VariableDeclaration"&&(this.createClosure(_.left)(),oe=_.left.declarations[0].id),function(gt){var hr,cr=Ft,Cn;gt&&gt.type==="LabeledStatement"&&(hr=gt.label.name);var Xn=je();for(Cn in Xn){G.assignmentExpressionHandler({type:"AssignmentExpression",operator:"=",left:oe,right:{type:"Literal",value:Cn}})();var sn=G.setValue(lt());if(!(sn===Ft||sn===ue)){if(sn===W)break;if(cr=sn,cr instanceof xo&&cr.value===hr){cr=Ft;continue}if(cr instanceof so||cr instanceof za||cr instanceof xo)break}}return cr}},m.withStatementHandler=function(_){var G=this,oe=this.createClosure(_.object),je=this.createClosure(_.body);return function(){var lt=oe(),gt=G.getCurrentScope(),hr=new uo(lt,gt,Rr);G.setCurrentScope(hr);var cr=G.setValue(je());return G.setCurrentScope(gt),cr}},m.throwStatementHandler=function(_){var G=this,oe=this.createClosure(_.argument);return function(){throw G.setValue(void 0),oe()}},m.tryStatementHandler=function(_){var G=this,oe=this.createClosure(_.block),je=_.handler?this.catchClauseHandler(_.handler):null,lt=_.finalizer?this.createClosure(_.finalizer):null;return function(){var gt=G.getCurrentScope(),hr=G.getCurrentContext(),cr=gt.labelStack.concat([]),Cn=G.callStack.concat([]),Xn=Ft,sn,Ai,Fi=function(){G.setCurrentScope(gt),G.setCurrentContext(hr),gt.labelStack=cr,G.callStack=Cn};try{Xn=G.setValue(oe()),Xn instanceof so&&(sn=Xn)}catch(Gi){if(Fi(),G.isInterruptThrow(Gi))throw Gi;if(je)try{Xn=G.setValue(je(Gi)),Xn instanceof so&&(sn=Xn)}catch(bi){if(Fi(),G.isInterruptThrow(bi))throw bi;Ai=bi}}if(lt)try{Xn=lt(),Xn instanceof so&&(sn=Xn)}catch(Gi){if(Fi(),G.isInterruptThrow(Gi))throw Gi;Ai=Gi}if(Ai)throw Ai;return sn||Xn}},m.catchClauseHandler=function(_){var G=this,oe=this.createParamNameGetter(_.param),je=this.createClosure(_.body);return function(lt){var gt,hr=G.getCurrentScope(),cr=hr.data,Cn=oe(),Xn=_o.call(cr,Cn),sn=cr[Cn];return cr[Cn]=lt,gt=je(),Xn?cr[Cn]=sn:delete cr[Cn],gt}},m.continueStatementHandler=function(_){return function(){return _.label?new xo(_.label.name):ue}},m.breakStatementHandler=function(_){return function(){return _.label?new za(_.label.name):W}},m.switchStatementHandler=function(_){var G=this,oe=this.createClosure(_.discriminant),je=_.cases.map(function(lt){return G.switchCaseHandler(lt)});return function(){for(var lt=oe(),gt=!1,hr,cr,Cn,Xn=0;Xn<je.length;Xn++){var sn=je[Xn](),Ai=sn.testClosure();if(Ai===Je){Cn=sn;continue}if(gt||Ai===lt){if(gt=!0,cr=G.setValue(sn.bodyClosure()),cr===Ft)continue;if(cr===W||(hr=cr,hr instanceof so||hr instanceof za||hr instanceof xo||hr===ue))break}}if(!gt&&Cn){cr=G.setValue(Cn.bodyClosure());var Fi=cr===Ft||cr===W||cr===ue;Fi||(hr=cr)}return hr}},m.switchCaseHandler=function(_){var G=_.test?this.createClosure(_.test):function(){return Je},oe=this.createClosure({type:"BlockStatement",body:_.consequent});return function(){return{testClosure:G,bodyClosure:oe}}},m.labeledStatementHandler=function(_){var G=this,oe=_.label.name,je=this.createClosure(_.body);return function(){var lt,gt=G.getCurrentScope();return gt.labelStack.push(oe),lt=je(_),lt instanceof za&&lt.value===oe&&(lt=Ft),gt.labelStack.pop(),lt}},m.debuggerStatementHandler=function(_){return function(){debugger;return Ft}},m.createParamNameGetter=function(_){if(_.type==="Identifier")return function(){return _.name};throw this.createInternalThrowError(Hi.ParamTypeSyntaxError,_.type,_)},m.createObjectKeyGetter=function(_){var G;return _.type==="Identifier"?G=function(){return _.name}:G=this.createClosure(_),function(){return G()}},m.createMemberKeyGetter=function(_){return _.computed?this.createClosure(_.property):this.createObjectKeyGetter(_.property)},m.createObjectGetter=function(_){var G=this;switch(_.type){case"Identifier":return function(){return G.getScopeDataFromName(_.name,G.getCurrentScope())};case"MemberExpression":return this.createClosure(_.object);default:throw this.createInternalThrowError(Hi.AssignmentTypeSyntaxError,_.type,_)}},m.createNameGetter=function(_){switch(_.type){case"Identifier":return function(){return _.name};case"MemberExpression":return this.createMemberKeyGetter(_);default:throw this.createInternalThrowError(Hi.AssignmentTypeSyntaxError,_.type,_)}},m.varDeclaration=function(_){var G=this.collectDeclVars;G[_]=void 0},m.funcDeclaration=function(_,G){var oe=this.collectDeclFuncs;oe[_]=G},m.addDeclarationsToScope=function(_,G,oe){var je=oe.data;for(var lt in G){var gt=G[lt];je[lt]=gt&&gt()}for(var hr in _)hr in je||(je[hr]=void 0)},m.getScopeValue=function(_,G){var oe=this.getScopeFromName(_,G);return oe.data[_]},m.getScopeDataFromName=function(_,G){return this.getScopeFromName(_,G).data},m.getScopeFromName=function(_,G){var oe=G;do if(_ in oe.data)return oe;while(oe=oe.parent);return this.globalScope},m.setValue=function(_){var G=this.callStack.length;return this.isVarDeclMode||G||_===Ft||_===W||_===ue||_ instanceof za||_ instanceof xo||(this.value=_ instanceof so?_.value:_),_},m.getValue=function(){return this.value},c}();qa.version=ls,qa.eval=Fa,qa.Function=To,qa.ecmaVersion=5,qa.globalContextInFunction=void 0,qa.global=Object.create(null);function Bu(c){return c===void 0&&(c=Object.create(null)),c}function Ju(c,m,S){m===void 0&&(m=[]),S===void 0&&(S={});var _=S.parsingContext,G=S.timeout===void 0?0:S.timeout,oe=`
    (function anonymous(`+m.join(",")+`){
         `+c+`
    });
    `,je=new qa(_,{ecmaVersion:S.ecmaVersion,timeout:G,rootContext:S.rootContext,globalContextInFunction:S.globalContextInFunction});return je.evaluate(oe)}function su(c,m,S){var _=new qa(m,S);return _.evaluate(c)}var $u=su,wu=function(){function c(S){this._code=S}var m=c.prototype;return m.runInContext=function(_){return su(this._code,_)},m.runInNewContext=function(_){return su(this._code,_)},c}(),uu=function(c,m,S){return su(c,m,S)};function cs(){for(var c=arguments.length,m=new Array(c),S=0;S<c;S++)m[S]=arguments[S];var _=m.pop();return Ju(_||"",m)}var Us=uu},20396:function(ci,mn,ot){var vt;/*! Hammer.JS - v2.0.7 - 2016-04-22
* http://hammerjs.github.io/
*
* Copyright (c) 2016 Jorik Tangelder;
* Licensed under the MIT license */(function(Ze,l,Vt,ge){"use strict";var Mt=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Le=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),Tt=Mt||Le,Fe=["","webkit","Moz","MS","ms","o"],dt=Tt?"":l.createElement("div"),nr="function",dr=Math.round,Dt=Math.abs,Er=Date.now;function wt(W,ue,Je){return setTimeout(Se(W,Je),ue)}function fr(W,ue,Je){return Array.isArray(W)?(Et(W,Je[ue],Je),!0):!1}function Et(W,ue,Je){var Ft;if(!!W)if(W.forEach)W.forEach(ue,Je);else if(W.length!==ge)for(Ft=0;Ft<W.length;)ue.call(Je,W[Ft],Ft,W),Ft++;else for(Ft in W)W.hasOwnProperty(Ft)&&ue.call(Je,W[Ft],Ft,W)}function vr(W,ue,Je){var Ft="DEPRECATED METHOD: "+ue+`
`+Je+` AT 
`;return function(){var Rr=new Error("get-stack-trace"),An=Rr&&Rr.stack?Rr.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",mi=Ze.console&&(Ze.console.warn||Ze.console.log);return mi&&mi.call(Ze.console,Ft,An),W.apply(this,arguments)}}var kt;typeof Object.assign!="function"?kt=function(ue){if(ue===ge||ue===null)throw new TypeError("Cannot convert undefined or null to object");for(var Je=Object(ue),Ft=1;Ft<arguments.length;Ft++){var Rr=arguments[Ft];if(Rr!==ge&&Rr!==null)for(var An in Rr)Rr.hasOwnProperty(An)&&(Je[An]=Rr[An])}return Je}:kt=Object.assign;var mt=vr(function(ue,Je,Ft){for(var Rr=Object.keys(Je),An=0;An<Rr.length;)(!Ft||Ft&&ue[Rr[An]]===ge)&&(ue[Rr[An]]=Je[Rr[An]]),An++;return ue},"extend","Use `assign`."),k=vr(function(ue,Je){return mt(ue,Je,!0)},"merge","Use `assign`.");function Te(W,ue,Je){var Ft=ue.prototype,Rr;Rr=W.prototype=Object.create(Ft),Rr.constructor=W,Rr._super=Ft,Je&&kt(Rr,Je)}function Se(W,ue){return function(){return W.apply(ue,arguments)}}function me(W,ue){return typeof W==nr?W.apply(ue&&ue[0]||ge,ue):W}function De(W,ue){return W===ge?ue:W}function we(W,ue,Je){Et(pe(ue),function(Ft){W.addEventListener(Ft,Je,!1)})}function ze(W,ue,Je){Et(pe(ue),function(Ft){W.removeEventListener(Ft,Je,!1)})}function Qt(W,ue){for(;W;){if(W==ue)return!0;W=W.parentNode}return!1}function V(W,ue){return W.indexOf(ue)>-1}function pe(W){return W.trim().split(/\s+/g)}function P(W,ue,Je){if(W.indexOf&&!Je)return W.indexOf(ue);for(var Ft=0;Ft<W.length;){if(Je&&W[Ft][Je]==ue||!Je&&W[Ft]===ue)return Ft;Ft++}return-1}function U(W){return Array.prototype.slice.call(W,0)}function B(W,ue,Je){for(var Ft=[],Rr=[],An=0;An<W.length;){var mi=ue?W[An][ue]:W[An];P(Rr,mi)<0&&Ft.push(W[An]),Rr[An]=mi,An++}return Je&&(ue?Ft=Ft.sort(function(sa,xa){return sa[ue]>xa[ue]}):Ft=Ft.sort()),Ft}function E(W,ue){for(var Je,Ft,Rr=ue[0].toUpperCase()+ue.slice(1),An=0;An<Fe.length;){if(Je=Fe[An],Ft=Je?Je+Rr:ue,Ft in W)return Ft;An++}return ge}var D=1;function q(){return D++}function Q(W){var ue=W.ownerDocument||W;return ue.defaultView||ue.parentWindow||Ze}var Ae=/mobile|tablet|ip(ad|hone|od)|android/i,ct="ontouchstart"in Ze,ke=E(Ze,"PointerEvent")!==ge,He=ct&&Ae.test(navigator.userAgent),We="touch",xt="pen",jt="mouse",Gt="kinect",Rt=25,Ar=1,Gr=2,er=4,$e=8,rt=1,Wt=2,Kt=4,ur=8,ae=16,z=Wt|Kt,R=ur|ae,j=z|R,b=["x","y"],ce=["clientX","clientY"];function Ye(W,ue){var Je=this;this.manager=W,this.callback=ue,this.element=W.element,this.target=W.options.inputTarget,this.domHandler=function(Ft){me(W.options.enable,[W])&&Je.handler(Ft)},this.init()}Ye.prototype={handler:function(){},init:function(){this.evEl&&we(this.element,this.evEl,this.domHandler),this.evTarget&&we(this.target,this.evTarget,this.domHandler),this.evWin&&we(Q(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ze(this.element,this.evEl,this.domHandler),this.evTarget&&ze(this.target,this.evTarget,this.domHandler),this.evWin&&ze(Q(this.element),this.evWin,this.domHandler)}};function Pt(W){var ue,Je=W.options.inputClass;return Je?ue=Je:ke?ue=xe:He?ue=Nt:ct?ue=Lt:ue=Kn,new ue(W,te)}function te(W,ue,Je){var Ft=Je.pointers.length,Rr=Je.changedPointers.length,An=ue&Ar&&Ft-Rr==0,mi=ue&(er|$e)&&Ft-Rr==0;Je.isFirst=!!An,Je.isFinal=!!mi,An&&(W.session={}),Je.eventType=ue,he(W,Je),W.emit("hammer.input",Je),W.recognize(Je),W.session.prevInput=Je}function he(W,ue){var Je=W.session,Ft=ue.pointers,Rr=Ft.length;Je.firstInput||(Je.firstInput=at(ue)),Rr>1&&!Je.firstMultiple?Je.firstMultiple=at(ue):Rr===1&&(Je.firstMultiple=!1);var An=Je.firstInput,mi=Je.firstMultiple,_a=mi?mi.center:An.center,sa=ue.center=fe(Ft);ue.timeStamp=Er(),ue.deltaTime=ue.timeStamp-An.timeStamp,ue.angle=yt(_a,sa),ue.distance=Nr(_a,sa),ve(Je,ue),ue.offsetDirection=Dr(ue.deltaX,ue.deltaY);var xa=wr(ue.deltaTime,ue.deltaX,ue.deltaY);ue.overallVelocityX=xa.x,ue.overallVelocityY=xa.y,ue.overallVelocity=Dt(xa.x)>Dt(xa.y)?xa.x:xa.y,ue.scale=mi?Dn(mi.pointers,Ft):1,ue.rotation=mi?jr(mi.pointers,Ft):0,ue.maxPointers=Je.prevInput?ue.pointers.length>Je.prevInput.maxPointers?ue.pointers.length:Je.prevInput.maxPointers:ue.pointers.length,it(Je,ue);var Fa=W.element;Qt(ue.srcEvent.target,Fa)&&(Fa=ue.srcEvent.target),ue.target=Fa}function ve(W,ue){var Je=ue.center,Ft=W.offsetDelta||{},Rr=W.prevDelta||{},An=W.prevInput||{};(ue.eventType===Ar||An.eventType===er)&&(Rr=W.prevDelta={x:An.deltaX||0,y:An.deltaY||0},Ft=W.offsetDelta={x:Je.x,y:Je.y}),ue.deltaX=Rr.x+(Je.x-Ft.x),ue.deltaY=Rr.y+(Je.y-Ft.y)}function it(W,ue){var Je=W.lastInterval||ue,Ft=ue.timeStamp-Je.timeStamp,Rr,An,mi,_a;if(ue.eventType!=$e&&(Ft>Rt||Je.velocity===ge)){var sa=ue.deltaX-Je.deltaX,xa=ue.deltaY-Je.deltaY,Fa=wr(Ft,sa,xa);An=Fa.x,mi=Fa.y,Rr=Dt(Fa.x)>Dt(Fa.y)?Fa.x:Fa.y,_a=Dr(sa,xa),W.lastInterval=ue}else Rr=Je.velocity,An=Je.velocityX,mi=Je.velocityY,_a=Je.direction;ue.velocity=Rr,ue.velocityX=An,ue.velocityY=mi,ue.direction=_a}function at(W){for(var ue=[],Je=0;Je<W.pointers.length;)ue[Je]={clientX:dr(W.pointers[Je].clientX),clientY:dr(W.pointers[Je].clientY)},Je++;return{timeStamp:Er(),pointers:ue,center:fe(ue),deltaX:W.deltaX,deltaY:W.deltaY}}function fe(W){var ue=W.length;if(ue===1)return{x:dr(W[0].clientX),y:dr(W[0].clientY)};for(var Je=0,Ft=0,Rr=0;Rr<ue;)Je+=W[Rr].clientX,Ft+=W[Rr].clientY,Rr++;return{x:dr(Je/ue),y:dr(Ft/ue)}}function wr(W,ue,Je){return{x:ue/W||0,y:Je/W||0}}function Dr(W,ue){return W===ue?rt:Dt(W)>=Dt(ue)?W<0?Wt:Kt:ue<0?ur:ae}function Nr(W,ue,Je){Je||(Je=b);var Ft=ue[Je[0]]-W[Je[0]],Rr=ue[Je[1]]-W[Je[1]];return Math.sqrt(Ft*Ft+Rr*Rr)}function yt(W,ue,Je){Je||(Je=b);var Ft=ue[Je[0]]-W[Je[0]],Rr=ue[Je[1]]-W[Je[1]];return Math.atan2(Rr,Ft)*180/Math.PI}function jr(W,ue){return yt(ue[1],ue[0],ce)+yt(W[1],W[0],ce)}function Dn(W,ue){return Nr(ue[0],ue[1],ce)/Nr(W[0],W[1],ce)}var ai={mousedown:Ar,mousemove:Gr,mouseup:er},Mi="mousedown",Li="mousemove mouseup";function Kn(){this.evEl=Mi,this.evWin=Li,this.pressed=!1,Ye.apply(this,arguments)}Te(Kn,Ye,{handler:function(ue){var Je=ai[ue.type];Je&Ar&&ue.button===0&&(this.pressed=!0),Je&Gr&&ue.which!==1&&(Je=er),!!this.pressed&&(Je&er&&(this.pressed=!1),this.callback(this.manager,Je,{pointers:[ue],changedPointers:[ue],pointerType:jt,srcEvent:ue}))}});var L={pointerdown:Ar,pointermove:Gr,pointerup:er,pointercancel:$e,pointerout:$e},N={2:We,3:xt,4:jt,5:Gt},H="pointerdown",ne="pointermove pointerup pointercancel";!Tt&&Ze.MSPointerEvent&&!Ze.PointerEvent&&(H="MSPointerDown",ne="MSPointerMove MSPointerUp MSPointerCancel");function xe(){this.evEl=H,this.evWin=ne,Ye.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Te(xe,Ye,{handler:function(ue){var Je=this.store,Ft=!1,Rr=ue.type.toLowerCase().replace("ms",""),An=L[Rr],mi=N[ue.pointerType]||ue.pointerType,_a=mi==We,sa=P(Je,ue.pointerId,"pointerId");An&Ar&&(ue.button===0||_a)?sa<0&&(Je.push(ue),sa=Je.length-1):An&(er|$e)&&(Ft=!0),!(sa<0)&&(Je[sa]=ue,this.callback(this.manager,An,{pointers:Je,changedPointers:[ue],pointerType:mi,srcEvent:ue}),Ft&&Je.splice(sa,1))}});var Ne={touchstart:Ar,touchmove:Gr,touchend:er,touchcancel:$e},Qe="touchstart",J="touchstart touchmove touchend touchcancel";function Me(){this.evTarget=Qe,this.evWin=J,this.started=!1,Ye.apply(this,arguments)}Te(Me,Ye,{handler:function(ue){var Je=Ne[ue.type];if(Je===Ar&&(this.started=!0),!!this.started){var Ft=bt.call(this,ue,Je);Je&(er|$e)&&Ft[0].length-Ft[1].length==0&&(this.started=!1),this.callback(this.manager,Je,{pointers:Ft[0],changedPointers:Ft[1],pointerType:We,srcEvent:ue})}}});function bt(W,ue){var Je=U(W.touches),Ft=U(W.changedTouches);return ue&(er|$e)&&(Je=B(Je.concat(Ft),"identifier",!0)),[Je,Ft]}var gr={touchstart:Ar,touchmove:Gr,touchend:er,touchcancel:$e},zt="touchstart touchmove touchend touchcancel";function Nt(){this.evTarget=zt,this.targetIds={},Ye.apply(this,arguments)}Te(Nt,Ye,{handler:function(ue){var Je=gr[ue.type],Ft=br.call(this,ue,Je);!Ft||this.callback(this.manager,Je,{pointers:Ft[0],changedPointers:Ft[1],pointerType:We,srcEvent:ue})}});function br(W,ue){var Je=U(W.touches),Ft=this.targetIds;if(ue&(Ar|Gr)&&Je.length===1)return Ft[Je[0].identifier]=!0,[Je,Je];var Rr,An,mi=U(W.changedTouches),_a=[],sa=this.target;if(An=Je.filter(function(xa){return Qt(xa.target,sa)}),ue===Ar)for(Rr=0;Rr<An.length;)Ft[An[Rr].identifier]=!0,Rr++;for(Rr=0;Rr<mi.length;)Ft[mi[Rr].identifier]&&_a.push(mi[Rr]),ue&(er|$e)&&delete Ft[mi[Rr].identifier],Rr++;if(!!_a.length)return[B(An.concat(_a),"identifier",!0),_a]}var vn=2500,cn=25;function Lt(){Ye.apply(this,arguments);var W=Se(this.handler,this);this.touch=new Nt(this.manager,W),this.mouse=new Kn(this.manager,W),this.primaryTouch=null,this.lastTouches=[]}Te(Lt,Ye,{handler:function(ue,Je,Ft){var Rr=Ft.pointerType==We,An=Ft.pointerType==jt;if(!(An&&Ft.sourceCapabilities&&Ft.sourceCapabilities.firesTouchEvents)){if(Rr)on.call(this,Je,Ft);else if(An&&Yr.call(this,Ft))return;this.callback(ue,Je,Ft)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function on(W,ue){W&Ar?(this.primaryTouch=ue.changedPointers[0].identifier,qr.call(this,ue)):W&(er|$e)&&qr.call(this,ue)}function qr(W){var ue=W.changedPointers[0];if(ue.identifier===this.primaryTouch){var Je={x:ue.clientX,y:ue.clientY};this.lastTouches.push(Je);var Ft=this.lastTouches,Rr=function(){var An=Ft.indexOf(Je);An>-1&&Ft.splice(An,1)};setTimeout(Rr,vn)}}function Yr(W){for(var ue=W.srcEvent.clientX,Je=W.srcEvent.clientY,Ft=0;Ft<this.lastTouches.length;Ft++){var Rr=this.lastTouches[Ft],An=Math.abs(ue-Rr.x),mi=Math.abs(Je-Rr.y);if(An<=cn&&mi<=cn)return!0}return!1}var $n=Tt?ge:E(dt.style,"touchAction"),$r=$n!==ge,hi="compute",Oi="auto",Qn="manipulation",fi="none",ei="pan-x",zn="pan-y",Wn=di();function Qi(W,ue){this.manager=W,this.set(ue)}Qi.prototype={set:function(W){W==hi&&(W=this.compute()),$r&&this.manager.element.style&&Wn[W]&&(this.manager.element.style[$n]=W),this.actions=W.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var W=[];return Et(this.manager.recognizers,function(ue){me(ue.options.enable,[ue])&&(W=W.concat(ue.getTouchAction()))}),_i(W.join(" "))},preventDefaults:function(W){var ue=W.srcEvent,Je=W.offsetDirection;if(this.manager.session.prevented){ue.preventDefault();return}var Ft=this.actions,Rr=V(Ft,fi)&&!Wn[fi],An=V(Ft,zn)&&!Wn[zn],mi=V(Ft,ei)&&!Wn[ei];if(Rr){var _a=W.pointers.length===1,sa=W.distance<2,xa=W.deltaTime<250;if(_a&&sa&&xa)return}if(!(mi&&An)&&(Rr||An&&Je&z||mi&&Je&R))return this.preventSrc(ue)},preventSrc:function(W){this.manager.session.prevented=!0,W.preventDefault()}};function _i(W){if(V(W,fi))return fi;var ue=V(W,ei),Je=V(W,zn);return ue&&Je?fi:ue||Je?ue?ei:zn:V(W,Qn)?Qn:Oi}function di(){if(!$r)return!1;var W={};if(Tt)return W;var ue=Ze.CSS&&Ze.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Je){W[Je]=ue?Ze.CSS.supports("touch-action",Je):!0}),W}var vi=1,oa=2,ns=4,ea=8,zi=ea,yo=16,$a=32;function Di(W){this.options=kt({},this.defaults,W||{}),this.id=q(),this.manager=null,this.options.enable=De(this.options.enable,!0),this.state=vi,this.simultaneous={},this.requireFail=[]}Di.prototype={defaults:{},set:function(W){return kt(this.options,W),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(W){if(fr(W,"recognizeWith",this))return this;var ue=this.simultaneous;return W=na(W,this),ue[W.id]||(ue[W.id]=W,W.recognizeWith(this)),this},dropRecognizeWith:function(W){return fr(W,"dropRecognizeWith",this)?this:(W=na(W,this),delete this.simultaneous[W.id],this)},requireFailure:function(W){if(fr(W,"requireFailure",this))return this;var ue=this.requireFail;return W=na(W,this),P(ue,W)===-1&&(ue.push(W),W.requireFailure(this)),this},dropRequireFailure:function(W){if(fr(W,"dropRequireFailure",this))return this;W=na(W,this);var ue=P(this.requireFail,W);return ue>-1&&this.requireFail.splice(ue,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(W){return!!this.simultaneous[W.id]},emit:function(W){var ue=this,Je=this.state;function Ft(Rr){ue.manager.emit(Rr,W)}Je<ea&&Ft(ue.options.event+So(Je)),Ft(ue.options.event),W.additionalEvent&&Ft(W.additionalEvent),Je>=ea&&Ft(ue.options.event+So(Je))},tryEmit:function(W){if(this.canEmit())return this.emit(W);this.state=$a},canEmit:function(){for(var W=0;W<this.requireFail.length;){if(!(this.requireFail[W].state&($a|vi)))return!1;W++}return!0},recognize:function(W){var ue=kt({},W);if(!me(this.options.enable,[this,ue])){this.reset(),this.state=$a;return}this.state&(zi|yo|$a)&&(this.state=vi),this.state=this.process(ue),this.state&(oa|ns|ea|yo)&&this.tryEmit(ue)},process:function(W){},getTouchAction:function(){},reset:function(){}};function So(W){return W&yo?"cancel":W&ea?"end":W&ns?"move":W&oa?"start":""}function ya(W){return W==ae?"down":W==ur?"up":W==Wt?"left":W==Kt?"right":""}function na(W,ue){var Je=ue.manager;return Je?Je.get(W):W}function ga(){Di.apply(this,arguments)}Te(ga,Di,{defaults:{pointers:1},attrTest:function(W){var ue=this.options.pointers;return ue===0||W.pointers.length===ue},process:function(W){var ue=this.state,Je=W.eventType,Ft=ue&(oa|ns),Rr=this.attrTest(W);return Ft&&(Je&$e||!Rr)?ue|yo:Ft||Rr?Je&er?ue|ea:ue&oa?ue|ns:oa:$a}});function Bi(){ga.apply(this,arguments),this.pX=null,this.pY=null}Te(Bi,ga,{defaults:{event:"pan",threshold:10,pointers:1,direction:j},getTouchAction:function(){var W=this.options.direction,ue=[];return W&z&&ue.push(zn),W&R&&ue.push(ei),ue},directionTest:function(W){var ue=this.options,Je=!0,Ft=W.distance,Rr=W.direction,An=W.deltaX,mi=W.deltaY;return Rr&ue.direction||(ue.direction&z?(Rr=An===0?rt:An<0?Wt:Kt,Je=An!=this.pX,Ft=Math.abs(W.deltaX)):(Rr=mi===0?rt:mi<0?ur:ae,Je=mi!=this.pY,Ft=Math.abs(W.deltaY))),W.direction=Rr,Je&&Ft>ue.threshold&&Rr&ue.direction},attrTest:function(W){return ga.prototype.attrTest.call(this,W)&&(this.state&oa||!(this.state&oa)&&this.directionTest(W))},emit:function(W){this.pX=W.deltaX,this.pY=W.deltaY;var ue=ya(W.direction);ue&&(W.additionalEvent=this.options.event+ue),this._super.emit.call(this,W)}});function wa(){ga.apply(this,arguments)}Te(wa,ga,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[fi]},attrTest:function(W){return this._super.attrTest.call(this,W)&&(Math.abs(W.scale-1)>this.options.threshold||this.state&oa)},emit:function(W){if(W.scale!==1){var ue=W.scale<1?"in":"out";W.additionalEvent=this.options.event+ue}this._super.emit.call(this,W)}});function Qa(){Di.apply(this,arguments),this._timer=null,this._input=null}Te(Qa,Di,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Oi]},process:function(W){var ue=this.options,Je=W.pointers.length===ue.pointers,Ft=W.distance<ue.threshold,Rr=W.deltaTime>ue.time;if(this._input=W,!Ft||!Je||W.eventType&(er|$e)&&!Rr)this.reset();else if(W.eventType&Ar)this.reset(),this._timer=wt(function(){this.state=zi,this.tryEmit()},ue.time,this);else if(W.eventType&er)return zi;return $a},reset:function(){clearTimeout(this._timer)},emit:function(W){this.state===zi&&(W&&W.eventType&er?this.manager.emit(this.options.event+"up",W):(this._input.timeStamp=Er(),this.manager.emit(this.options.event,this._input)))}});function _s(){ga.apply(this,arguments)}Te(_s,ga,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[fi]},attrTest:function(W){return this._super.attrTest.call(this,W)&&(Math.abs(W.rotation)>this.options.threshold||this.state&oa)}});function Ga(){ga.apply(this,arguments)}Te(Ga,ga,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:z|R,pointers:1},getTouchAction:function(){return Bi.prototype.getTouchAction.call(this)},attrTest:function(W){var ue=this.options.direction,Je;return ue&(z|R)?Je=W.overallVelocity:ue&z?Je=W.overallVelocityX:ue&R&&(Je=W.overallVelocityY),this._super.attrTest.call(this,W)&&ue&W.offsetDirection&&W.distance>this.options.threshold&&W.maxPointers==this.options.pointers&&Dt(Je)>this.options.velocity&&W.eventType&er},emit:function(W){var ue=ya(W.offsetDirection);ue&&this.manager.emit(this.options.event+ue,W),this.manager.emit(this.options.event,W)}});function eo(){Di.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Te(eo,Di,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Qn]},process:function(W){var ue=this.options,Je=W.pointers.length===ue.pointers,Ft=W.distance<ue.threshold,Rr=W.deltaTime<ue.time;if(this.reset(),W.eventType&Ar&&this.count===0)return this.failTimeout();if(Ft&&Rr&&Je){if(W.eventType!=er)return this.failTimeout();var An=this.pTime?W.timeStamp-this.pTime<ue.interval:!0,mi=!this.pCenter||Nr(this.pCenter,W.center)<ue.posThreshold;this.pTime=W.timeStamp,this.pCenter=W.center,!mi||!An?this.count=1:this.count+=1,this._input=W;var _a=this.count%ue.taps;if(_a===0)return this.hasRequireFailures()?(this._timer=wt(function(){this.state=zi,this.tryEmit()},ue.interval,this),oa):zi}return $a},failTimeout:function(){return this._timer=wt(function(){this.state=$a},this.options.interval,this),$a},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==zi&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Hi(W,ue){return ue=ue||{},ue.recognizers=De(ue.recognizers,Hi.defaults.preset),new Ma(W,ue)}Hi.VERSION="2.0.7",Hi.defaults={domEvents:!1,touchAction:hi,enable:!0,inputTarget:null,inputClass:null,preset:[[_s,{enable:!1}],[wa,{enable:!1},["rotate"]],[Ga,{direction:z}],[Bi,{direction:z},["swipe"]],[eo],[eo,{event:"doubletap",taps:2},["tap"]],[Qa]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Pa=1,go=2;function Ma(W,ue){this.options=kt({},Hi.defaults,ue||{}),this.options.inputTarget=this.options.inputTarget||W,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=W,this.input=Pt(this),this.touchAction=new Qi(this,this.options.touchAction),ls(this,!0),Et(this.options.recognizers,function(Je){var Ft=this.add(new Je[0](Je[1]));Je[2]&&Ft.recognizeWith(Je[2]),Je[3]&&Ft.requireFailure(Je[3])},this)}Ma.prototype={set:function(W){return kt(this.options,W),W.touchAction&&this.touchAction.update(),W.inputTarget&&(this.input.destroy(),this.input.target=W.inputTarget,this.input.init()),this},stop:function(W){this.session.stopped=W?go:Pa},recognize:function(W){var ue=this.session;if(!ue.stopped){this.touchAction.preventDefaults(W);var Je,Ft=this.recognizers,Rr=ue.curRecognizer;(!Rr||Rr&&Rr.state&zi)&&(Rr=ue.curRecognizer=null);for(var An=0;An<Ft.length;)Je=Ft[An],ue.stopped!==go&&(!Rr||Je==Rr||Je.canRecognizeWith(Rr))?Je.recognize(W):Je.reset(),!Rr&&Je.state&(oa|ns|ea)&&(Rr=ue.curRecognizer=Je),An++}},get:function(W){if(W instanceof Di)return W;for(var ue=this.recognizers,Je=0;Je<ue.length;Je++)if(ue[Je].options.event==W)return ue[Je];return null},add:function(W){if(fr(W,"add",this))return this;var ue=this.get(W.options.event);return ue&&this.remove(ue),this.recognizers.push(W),W.manager=this,this.touchAction.update(),W},remove:function(W){if(fr(W,"remove",this))return this;if(W=this.get(W),W){var ue=this.recognizers,Je=P(ue,W);Je!==-1&&(ue.splice(Je,1),this.touchAction.update())}return this},on:function(W,ue){if(W!==ge&&ue!==ge){var Je=this.handlers;return Et(pe(W),function(Ft){Je[Ft]=Je[Ft]||[],Je[Ft].push(ue)}),this}},off:function(W,ue){if(W!==ge){var Je=this.handlers;return Et(pe(W),function(Ft){ue?Je[Ft]&&Je[Ft].splice(P(Je[Ft],ue),1):delete Je[Ft]}),this}},emit:function(W,ue){this.options.domEvents&&ou(W,ue);var Je=this.handlers[W]&&this.handlers[W].slice();if(!(!Je||!Je.length)){ue.type=W,ue.preventDefault=function(){ue.srcEvent.preventDefault()};for(var Ft=0;Ft<Je.length;)Je[Ft](ue),Ft++}},destroy:function(){this.element&&ls(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function ls(W,ue){var Je=W.element;if(!!Je.style){var Ft;Et(W.options.cssProps,function(Rr,An){Ft=E(Je.style,An),ue?(W.oldCssProps[Ft]=Je.style[Ft],Je.style[Ft]=Rr):Je.style[Ft]=W.oldCssProps[Ft]||""}),ue||(W.oldCssProps={})}}function ou(W,ue){if(!Tt){var Je=l.createEvent("Event");Je.initEvent(W,!0,!0),Je.gesture=ue,ue.target.dispatchEvent(Je)}}if(!Tt){kt(Hi,{INPUT_START:Ar,INPUT_MOVE:Gr,INPUT_END:er,INPUT_CANCEL:$e,STATE_POSSIBLE:vi,STATE_BEGAN:oa,STATE_CHANGED:ns,STATE_ENDED:ea,STATE_RECOGNIZED:zi,STATE_CANCELLED:yo,STATE_FAILED:$a,DIRECTION_NONE:rt,DIRECTION_LEFT:Wt,DIRECTION_RIGHT:Kt,DIRECTION_UP:ur,DIRECTION_DOWN:ae,DIRECTION_HORIZONTAL:z,DIRECTION_VERTICAL:R,DIRECTION_ALL:j,Manager:Ma,Input:Ye,TouchAction:Qi,TouchInput:Nt,MouseInput:Kn,PointerEventInput:xe,TouchMouseInput:Lt,SingleTouchInput:Me,Recognizer:Di,AttrRecognizer:ga,Tap:eo,Pan:Bi,Swipe:Ga,Pinch:wa,Rotate:_s,Press:Qa,on:we,off:ze,each:Et,merge:k,extend:mt,assign:kt,inherit:Te,bindFn:Se,prefixed:E});var _o=typeof window!="undefined"?window:typeof self!="undefined"?self:{};_o.Hammer=Hi,vt=function(){return Hi}.call(mn,ot,mn,ci),vt!==ge&&(ci.exports=vt)}})(typeof window!="undefined"?window:{console:null,MSPointerEvent:null,PointerEvent:null,CSS:null},document,"Hammer")},88307:function(ci,mn,ot){(function(vt,Ze){ci.exports=Ze(ot(18857))})(this,function(vt){"use strict";var Ze=function(T){return T instanceof Uint8Array||T instanceof Uint16Array||T instanceof Uint32Array||T instanceof Int8Array||T instanceof Int16Array||T instanceof Int32Array||T instanceof Float32Array||T instanceof Float64Array||T instanceof Uint8ClampedArray},l=function(T,ie){for(var Oe=Object.keys(ie),Ut=0;Ut<Oe.length;++Ut)T[Oe[Ut]]=ie[Oe[Ut]];return T},Vt=`
`;function ge(T){return typeof atob!="undefined"?atob(T):"base64:"+T}function Mt(T){var ie=new Error("(regl) "+T);throw console.error(ie),ie}function Le(T,ie){T||Mt(ie)}function Tt(T){return T?": "+T:""}function Fe(T,ie,Oe){T in ie||Mt("unknown parameter ("+T+")"+Tt(Oe)+". possible values: "+Object.keys(ie).join())}function dt(T,ie){Ze(T)||Mt("invalid parameter type"+Tt(ie)+". must be a typed array")}function nr(T,ie){switch(ie){case"number":return typeof T=="number";case"object":return typeof T=="object";case"string":return typeof T=="string";case"boolean":return typeof T=="boolean";case"function":return typeof T=="function";case"undefined":return typeof T=="undefined";case"symbol":return typeof T=="symbol"}}function dr(T,ie,Oe){nr(T,ie)||Mt("invalid parameter type"+Tt(Oe)+". expected "+ie+", got "+typeof T)}function Dt(T,ie){T>=0&&(T|0)===T||Mt("invalid parameter type, ("+T+")"+Tt(ie)+". must be a nonnegative integer")}function Er(T,ie,Oe){ie.indexOf(T)<0&&Mt("invalid value"+Tt(Oe)+". must be one of: "+ie)}var wt=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function fr(T){Object.keys(T).forEach(function(ie){wt.indexOf(ie)<0&&Mt('invalid regl constructor argument "'+ie+'". must be one of '+wt)})}function Et(T,ie){for(T=T+"";T.length<ie;)T=" "+T;return T}function vr(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function kt(T,ie){this.number=T,this.line=ie,this.errors=[]}function mt(T,ie,Oe){this.file=T,this.line=ie,this.message=Oe}function k(){var T=new Error,ie=(T.stack||T).toString(),Oe=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(ie);if(Oe)return Oe[1];var Ut=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(ie);return Ut?Ut[1]:"unknown"}function Te(){var T=new Error,ie=(T.stack||T).toString(),Oe=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(ie);if(Oe)return Oe[1];var Ut=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(ie);return Ut?Ut[1]:"unknown"}function Se(T,ie){var Oe=T.split(`
`),Ut=1,pr=0,Bt={unknown:new vr,0:new vr};Bt.unknown.name=Bt[0].name=ie||k(),Bt.unknown.lines.push(new kt(0,""));for(var ir=0;ir<Oe.length;++ir){var _r=Oe[ir],Tr=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(_r);if(Tr)switch(Tr[1]){case"line":var Ir=/(\d+)(\s+\d+)?/.exec(Tr[2]);Ir&&(Ut=Ir[1]|0,Ir[2]&&(pr=Ir[2]|0,pr in Bt||(Bt[pr]=new vr)));break;case"define":var Lr=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Tr[2]);Lr&&(Bt[pr].name=Lr[1]?ge(Lr[2]):Lr[2]);break}Bt[pr].lines.push(new kt(Ut++,_r))}return Object.keys(Bt).forEach(function(Or){var Kr=Bt[Or];Kr.lines.forEach(function(Cr){Kr.index[Cr.number]=Cr})}),Bt}function me(T){var ie=[];return T.split(`
`).forEach(function(Oe){if(!(Oe.length<5)){var Ut=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Oe);Ut?ie.push(new mt(Ut[1]|0,Ut[2]|0,Ut[3].trim())):Oe.length>0&&ie.push(new mt("unknown",0,Oe))}}),ie}function De(T,ie){ie.forEach(function(Oe){var Ut=T[Oe.file];if(Ut){var pr=Ut.index[Oe.line];if(pr){pr.errors.push(Oe),Ut.hasErrors=!0;return}}T.unknown.hasErrors=!0,T.unknown.lines[0].errors.push(Oe)})}function we(T,ie,Oe,Ut,pr){if(!T.getShaderParameter(ie,T.COMPILE_STATUS)){var Bt=T.getShaderInfoLog(ie),ir=Ut===T.FRAGMENT_SHADER?"fragment":"vertex";B(Oe,"string",ir+" shader source must be a string",pr);var _r=Se(Oe,pr),Tr=me(Bt);De(_r,Tr),Object.keys(_r).forEach(function(Ir){var Lr=_r[Ir];if(!Lr.hasErrors)return;var Or=[""],Kr=[""];function Cr(Mr,ht){Or.push(Mr),Kr.push(ht||"")}Cr("file number "+Ir+": "+Lr.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Lr.lines.forEach(function(Mr){if(Mr.errors.length>0){Cr(Et(Mr.number,4)+"|  ","background-color:yellow; font-weight:bold"),Cr(Mr.line+Vt,"color:red; background-color:yellow; font-weight:bold");var ht=0;Mr.errors.forEach(function(Yt){var kr=Yt.message,Hr=/^\s*'(.*)'\s*:\s*(.*)$/.exec(kr);if(Hr){var yr=Hr[1];switch(kr=Hr[2],yr){case"assign":yr="=";break}ht=Math.max(Mr.line.indexOf(yr,ht),0)}else ht=0;Cr(Et("| ",6)),Cr(Et("^^^",ht+3)+Vt,"font-weight:bold"),Cr(Et("| ",6)),Cr(kr+Vt,"font-weight:bold")}),Cr(Et("| ",6)+Vt)}else Cr(Et(Mr.number,4)+"|  "),Cr(Mr.line+Vt,"color:red")}),typeof document!="undefined"&&!window.chrome?(Kr[0]=Or.join("%c"),console.log.apply(console,Kr)):console.log(Or.join(""))}),Le.raise("Error compiling "+ir+" shader, "+_r[0].name)}}function ze(T,ie,Oe,Ut,pr){if(!T.getProgramParameter(ie,T.LINK_STATUS)){var Bt=T.getProgramInfoLog(ie),ir=Se(Oe,pr),_r=Se(Ut,pr),Tr='Error linking program with vertex shader, "'+_r[0].name+'", and fragment shader "'+ir[0].name+'"';typeof document!="undefined"?console.log("%c"+Tr+Vt+"%c"+Bt,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Tr+Vt+Bt),Le.raise(Tr)}}function Qt(T){T._commandRef=k()}function V(T,ie,Oe,Ut){Qt(T);function pr(Tr){return Tr?Ut.id(Tr):0}T._fragId=pr(T.static.frag),T._vertId=pr(T.static.vert);function Bt(Tr,Ir){Object.keys(Ir).forEach(function(Lr){Tr[Ut.id(Lr)]=!0})}var ir=T._uniformSet={};Bt(ir,ie.static),Bt(ir,ie.dynamic);var _r=T._attributeSet={};Bt(_r,Oe.static),Bt(_r,Oe.dynamic),T._hasCount="count"in T.static||"count"in T.dynamic||"elements"in T.static||"elements"in T.dynamic}function pe(T,ie){var Oe=Te();Mt(T+" in command "+(ie||k())+(Oe==="unknown"?"":" called from "+Oe))}function P(T,ie,Oe){T||pe(ie,Oe||k())}function U(T,ie,Oe,Ut){T in ie||pe("unknown parameter ("+T+")"+Tt(Oe)+". possible values: "+Object.keys(ie).join(),Ut||k())}function B(T,ie,Oe,Ut){nr(T,ie)||pe("invalid parameter type"+Tt(Oe)+". expected "+ie+", got "+typeof T,Ut||k())}function E(T){T()}function D(T,ie,Oe){T.texture?Er(T.texture._texture.internalformat,ie,"unsupported texture format for attachment"):Er(T.renderbuffer._renderbuffer.format,Oe,"unsupported renderbuffer format for attachment")}var q=33071,Q=9728,Ae=9984,ct=9985,ke=9986,He=9987,We=5120,xt=5121,jt=5122,Gt=5123,Rt=5124,Ar=5125,Gr=5126,er=32819,$e=32820,rt=33635,Wt=34042,Kt=36193,ur={};ur[We]=ur[xt]=1,ur[jt]=ur[Gt]=ur[Kt]=ur[rt]=ur[er]=ur[$e]=2,ur[Rt]=ur[Ar]=ur[Gr]=ur[Wt]=4;function ae(T,ie){return T===$e||T===er||T===rt?2:T===Wt?4:ur[T]*ie}function z(T){return!(T&T-1)&&!!T}function R(T,ie,Oe){var Ut,pr=ie.width,Bt=ie.height,ir=ie.channels;Le(pr>0&&pr<=Oe.maxTextureSize&&Bt>0&&Bt<=Oe.maxTextureSize,"invalid texture shape"),(T.wrapS!==q||T.wrapT!==q)&&Le(z(pr)&&z(Bt),"incompatible wrap mode for texture, both width and height must be power of 2"),ie.mipmask===1?pr!==1&&Bt!==1&&Le(T.minFilter!==Ae&&T.minFilter!==ke&&T.minFilter!==ct&&T.minFilter!==He,"min filter requires mipmap"):(Le(z(pr)&&z(Bt),"texture must be a square power of 2 to support mipmapping"),Le(ie.mipmask===(pr<<1)-1,"missing or incomplete mipmap data")),ie.type===Gr&&(Oe.extensions.indexOf("oes_texture_float_linear")<0&&Le(T.minFilter===Q&&T.magFilter===Q,"filter not supported, must enable oes_texture_float_linear"),Le(!T.genMipmaps,"mipmap generation not supported with float textures"));var _r=ie.images;for(Ut=0;Ut<16;++Ut)if(_r[Ut]){var Tr=pr>>Ut,Ir=Bt>>Ut;Le(ie.mipmask&1<<Ut,"missing mipmap data");var Lr=_r[Ut];if(Le(Lr.width===Tr&&Lr.height===Ir,"invalid shape for mip images"),Le(Lr.format===ie.format&&Lr.internalformat===ie.internalformat&&Lr.type===ie.type,"incompatible type for mip image"),!Lr.compressed)if(Lr.data){var Or=Math.ceil(ae(Lr.type,ir)*Tr/Lr.unpackAlignment)*Lr.unpackAlignment;Le(Lr.data.byteLength===Or*Ir,"invalid data for image, buffer size is inconsistent with image format")}else Lr.element||Lr.copy}else T.genMipmaps||Le((ie.mipmask&1<<Ut)==0,"extra mipmap data");ie.compressed&&Le(!T.genMipmaps,"mipmap generation for compressed images not supported")}function j(T,ie,Oe,Ut){var pr=T.width,Bt=T.height,ir=T.channels;Le(pr>0&&pr<=Ut.maxTextureSize&&Bt>0&&Bt<=Ut.maxTextureSize,"invalid texture shape"),Le(pr===Bt,"cube map must be square"),Le(ie.wrapS===q&&ie.wrapT===q,"wrap mode not supported by cube map");for(var _r=0;_r<Oe.length;++_r){var Tr=Oe[_r];Le(Tr.width===pr&&Tr.height===Bt,"inconsistent cube map face shape"),ie.genMipmaps&&(Le(!Tr.compressed,"can not generate mipmap for compressed textures"),Le(Tr.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Ir=Tr.images,Lr=0;Lr<16;++Lr){var Or=Ir[Lr];if(Or){var Kr=pr>>Lr,Cr=Bt>>Lr;Le(Tr.mipmask&1<<Lr,"missing mipmap data"),Le(Or.width===Kr&&Or.height===Cr,"invalid shape for mip images"),Le(Or.format===T.format&&Or.internalformat===T.internalformat&&Or.type===T.type,"incompatible type for mip image"),Or.compressed||(Or.data?Le(Or.data.byteLength===Kr*Cr*Math.max(ae(Or.type,ir),Or.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Or.element||Or.copy)}}}}var b=l(Le,{optional:E,raise:Mt,commandRaise:pe,command:P,parameter:Fe,commandParameter:U,constructor:fr,type:dr,commandType:B,isTypedArray:dt,nni:Dt,oneOf:Er,shaderError:we,linkError:ze,callSite:Te,saveCommandRef:Qt,saveDrawInfo:V,framebufferFormat:D,guessCommand:k,texture2D:R,textureCube:j}),ce=0,Ye=0,Pt=5,te=6;function he(T,ie){this.id=ce++,this.type=T,this.data=ie}function ve(T){return T.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function it(T){if(T.length===0)return[];var ie=T.charAt(0),Oe=T.charAt(T.length-1);if(T.length>1&&ie===Oe&&(ie==='"'||ie==="'"))return['"'+ve(T.substr(1,T.length-2))+'"'];var Ut=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(T);if(Ut)return it(T.substr(0,Ut.index)).concat(it(Ut[1])).concat(it(T.substr(Ut.index+Ut[0].length)));var pr=T.split(".");if(pr.length===1)return['"'+ve(T)+'"'];for(var Bt=[],ir=0;ir<pr.length;++ir)Bt=Bt.concat(it(pr[ir]));return Bt}function at(T){return"["+it(T).join("][")+"]"}function fe(T,ie){return new he(T,at(ie+""))}function wr(T){return typeof T=="function"&&!T._reglType||T instanceof he}function Dr(T,ie){if(typeof T=="function")return new he(Ye,T);if(typeof T=="number"||typeof T=="boolean")return new he(Pt,T);if(Array.isArray(T))return new he(te,T.map(function(Oe,Ut){return Dr(Oe,ie+"["+Ut+"]")}));if(T instanceof he)return T;b(!1,"invalid option type in uniform "+ie)}var Nr={DynamicVariable:he,define:fe,isDynamic:wr,unbox:Dr,accessor:at},yt={next:typeof requestAnimationFrame=="function"?function(T){return requestAnimationFrame(T)}:function(T){return setTimeout(T,16)},cancel:typeof cancelAnimationFrame=="function"?function(T){return cancelAnimationFrame(T)}:clearTimeout},jr=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Dn=jr?function(){return+new Date}:typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function ai(){var T={"":0},ie=[""];return{id:function(Oe){var Ut=T[Oe];return Ut||(Ut=T[Oe]=ie.length,ie.push(Oe),Ut)},str:function(Oe){return ie[Oe]}}}function Mi(T,ie,Oe){var Ut=document.createElement("canvas");l(Ut.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),T.appendChild(Ut),T===document.body&&(Ut.style.position="absolute",l(T.style,{margin:0,padding:0}));function pr(){var _r=window.innerWidth,Tr=window.innerHeight;if(T!==document.body){var Ir=Ut.getBoundingClientRect();_r=Ir.right-Ir.left,Tr=Ir.bottom-Ir.top}Ut.width=Oe*_r,Ut.height=Oe*Tr}var Bt;T!==document.body&&typeof ResizeObserver=="function"?(Bt=new ResizeObserver(function(){setTimeout(pr)}),Bt.observe(T)):window.addEventListener("resize",pr,!1);function ir(){Bt?Bt.disconnect():window.removeEventListener("resize",pr),T.removeChild(Ut)}return pr(),{canvas:Ut,onDestroy:ir}}function Li(T,ie){function Oe(Ut){try{return T.getContext(Ut,ie)}catch(pr){return null}}return Oe("webgl")||Oe("experimental-webgl")||Oe("webgl-experimental")}function Kn(T){return typeof T.nodeName=="string"&&typeof T.appendChild=="function"&&typeof T.getBoundingClientRect=="function"}function L(T){return typeof T.drawArrays=="function"||typeof T.drawElements=="function"}function N(T){return typeof T=="string"?T.split():(b(Array.isArray(T),"invalid extension array"),T)}function H(T){return typeof T=="string"?(b(typeof document!="undefined","not supported outside of DOM"),document.querySelector(T)):T}function ne(T){var ie=T||{},Oe,Ut,pr,Bt,ir={},_r=[],Tr=[],Ir=typeof window=="undefined"?1:window.devicePixelRatio,Lr=!1,Or=function(Mr){Mr&&b.raise(Mr)},Kr=function(){};if(typeof ie=="string"?(b(typeof document!="undefined","selector queries only supported in DOM environments"),Oe=document.querySelector(ie),b(Oe,"invalid query string for element")):typeof ie=="object"?Kn(ie)?Oe=ie:L(ie)?(Bt=ie,pr=Bt.canvas):(b.constructor(ie),"gl"in ie?Bt=ie.gl:"canvas"in ie?pr=H(ie.canvas):"container"in ie&&(Ut=H(ie.container)),"attributes"in ie&&(ir=ie.attributes,b.type(ir,"object","invalid context attributes")),"extensions"in ie&&(_r=N(ie.extensions)),"optionalExtensions"in ie&&(Tr=N(ie.optionalExtensions)),"onDone"in ie&&(b.type(ie.onDone,"function","invalid or missing onDone callback"),Or=ie.onDone),"profile"in ie&&(Lr=!!ie.profile),"pixelRatio"in ie&&(Ir=+ie.pixelRatio,b(Ir>0,"invalid pixel ratio"))):b.raise("invalid arguments to regl"),Oe&&(Oe.nodeName.toLowerCase()==="canvas"?pr=Oe:Ut=Oe),!Bt){if(!pr){b(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var Cr=Mi(Ut||document.body,Or,Ir);if(!Cr)return null;pr=Cr.canvas,Kr=Cr.onDestroy}ir.premultipliedAlpha===void 0&&(ir.premultipliedAlpha=!0),Bt=Li(pr,ir)}return Bt?{gl:Bt,canvas:pr,container:Ut,extensions:_r,optionalExtensions:Tr,pixelRatio:Ir,profile:Lr,onDone:Or,onDestroy:Kr}:(Kr(),Or("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function xe(T,ie){var Oe={};function Ut(_r){b.type(_r,"string","extension name must be string");var Tr=_r.toLowerCase(),Ir;try{Ir=Oe[Tr]=pr(_r)}catch(Lr){}return!!Ir}function pr(_r){return T.getExtension(_r)?T.getExtension(_r):T.getExtension(_r.toLowerCase())?T.getExtension(_r.toLowerCase()):null}for(var Bt=0;Bt<ie.extensions.length;++Bt){var ir=ie.extensions[Bt];if(!Ut(ir))return ie.onDestroy(),ie.onDone('"'+ir+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return ie.optionalExtensions.forEach(Ut),{extensions:Oe,restore:function(){Object.keys(Oe).forEach(function(_r){if(Oe[_r]&&!Ut(_r))throw new Error("(regl): error restoring extension "+_r)})}}}function Ne(T,ie){for(var Oe=Array(T),Ut=0;Ut<T;++Ut)Oe[Ut]=ie(Ut);return Oe}var Qe=5120,J=5121,Me=5122,bt=5123,gr=5124,zt=5125,Nt=5126;function br(T){for(var ie=16;ie<=1<<28;ie*=16)if(T<=ie)return ie;return 0}function vn(T){var ie,Oe;return ie=(T>65535)<<4,T>>>=ie,Oe=(T>255)<<3,T>>>=Oe,ie|=Oe,Oe=(T>15)<<2,T>>>=Oe,ie|=Oe,Oe=(T>3)<<1,T>>>=Oe,ie|=Oe,ie|T>>1}function cn(){var T=Ne(8,function(){return[]});function ie(Bt){var ir=br(Bt),_r=T[vn(ir)>>2];return _r.length>0?_r.pop():new ArrayBuffer(ir)}function Oe(Bt){T[vn(Bt.byteLength)>>2].push(Bt)}function Ut(Bt,ir){var _r=null;switch(Bt){case Qe:_r=new Int8Array(ie(ir),0,ir);break;case J:_r=new Uint8Array(ie(ir),0,ir);break;case Me:_r=new Int16Array(ie(2*ir),0,ir);break;case bt:_r=new Uint16Array(ie(2*ir),0,ir);break;case gr:_r=new Int32Array(ie(4*ir),0,ir);break;case zt:_r=new Uint32Array(ie(4*ir),0,ir);break;case Nt:_r=new Float32Array(ie(4*ir),0,ir);break;default:return null}return _r.length!==ir?_r.subarray(0,ir):_r}function pr(Bt){Oe(Bt.buffer)}return{alloc:ie,free:Oe,allocType:Ut,freeType:pr}}var Lt=cn();Lt.zero=cn();var on=3408,qr=3410,Yr=3411,$n=3412,$r=3413,hi=3414,Oi=3415,Qn=33901,fi=33902,ei=3379,zn=3386,Wn=34921,Qi=36347,_i=36348,di=35661,vi=35660,oa=34930,ns=36349,ea=34076,zi=34024,yo=7936,$a=7937,Di=7938,So=35724,ya=34047,na=36063,ga=34852,Bi=3553,wa=34067,Qa=34069,_s=33984,Ga=6408,eo=5126,Hi=5121,Pa=36160,go=36053,Ma=36064,ls=16384,ou=function(T,ie){var Oe=1;ie.ext_texture_filter_anisotropic&&(Oe=T.getParameter(ya));var Ut=1,pr=1;ie.webgl_draw_buffers&&(Ut=T.getParameter(ga),pr=T.getParameter(na));var Bt=!!ie.oes_texture_float;if(Bt){var ir=T.createTexture();T.bindTexture(Bi,ir),T.texImage2D(Bi,0,Ga,1,1,0,Ga,eo,null);var _r=T.createFramebuffer();if(T.bindFramebuffer(Pa,_r),T.framebufferTexture2D(Pa,Ma,Bi,ir,0),T.bindTexture(Bi,null),T.checkFramebufferStatus(Pa)!==go)Bt=!1;else{T.viewport(0,0,1,1),T.clearColor(1,0,0,1),T.clear(ls);var Tr=Lt.allocType(eo,4);T.readPixels(0,0,1,1,Ga,eo,Tr),T.getError()?Bt=!1:(T.deleteFramebuffer(_r),T.deleteTexture(ir),Bt=Tr[0]===1),Lt.freeType(Tr)}}var Ir=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Lr=!0;if(!Ir){var Or=T.createTexture(),Kr=Lt.allocType(Hi,36);T.activeTexture(_s),T.bindTexture(wa,Or),T.texImage2D(Qa,0,Ga,3,3,0,Ga,Hi,Kr),Lt.freeType(Kr),T.bindTexture(wa,null),T.deleteTexture(Or),Lr=!T.getError()}return{colorBits:[T.getParameter(qr),T.getParameter(Yr),T.getParameter($n),T.getParameter($r)],depthBits:T.getParameter(hi),stencilBits:T.getParameter(Oi),subpixelBits:T.getParameter(on),extensions:Object.keys(ie).filter(function(Cr){return!!ie[Cr]}),maxAnisotropic:Oe,maxDrawbuffers:Ut,maxColorAttachments:pr,pointSizeDims:T.getParameter(Qn),lineWidthDims:T.getParameter(fi),maxViewportDims:T.getParameter(zn),maxCombinedTextureUnits:T.getParameter(di),maxCubeMapSize:T.getParameter(ea),maxRenderbufferSize:T.getParameter(zi),maxTextureUnits:T.getParameter(oa),maxTextureSize:T.getParameter(ei),maxAttributes:T.getParameter(Wn),maxVertexUniforms:T.getParameter(Qi),maxVertexTextureUnits:T.getParameter(vi),maxVaryingVectors:T.getParameter(_i),maxFragmentUniforms:T.getParameter(ns),glsl:T.getParameter(So),renderer:T.getParameter($a),vendor:T.getParameter(yo),version:T.getParameter(Di),readFloat:Bt,npotTextureCube:Lr}};function _o(T){return!!T&&typeof T=="object"&&Array.isArray(T.shape)&&Array.isArray(T.stride)&&typeof T.offset=="number"&&T.shape.length===T.stride.length&&(Array.isArray(T.data)||Ze(T.data))}var W=function(T){return Object.keys(T).map(function(ie){return T[ie]})},ue={shape:_a,flatten:mi};function Je(T,ie,Oe){for(var Ut=0;Ut<ie;++Ut)Oe[Ut]=T[Ut]}function Ft(T,ie,Oe,Ut){for(var pr=0,Bt=0;Bt<ie;++Bt)for(var ir=T[Bt],_r=0;_r<Oe;++_r)Ut[pr++]=ir[_r]}function Rr(T,ie,Oe,Ut,pr,Bt){for(var ir=Bt,_r=0;_r<ie;++_r)for(var Tr=T[_r],Ir=0;Ir<Oe;++Ir)for(var Lr=Tr[Ir],Or=0;Or<Ut;++Or)pr[ir++]=Lr[Or]}function An(T,ie,Oe,Ut,pr){for(var Bt=1,ir=Oe+1;ir<ie.length;++ir)Bt*=ie[ir];var _r=ie[Oe];if(ie.length-Oe==4){var Tr=ie[Oe+1],Ir=ie[Oe+2],Lr=ie[Oe+3];for(ir=0;ir<_r;++ir)Rr(T[ir],Tr,Ir,Lr,Ut,pr),pr+=Bt}else for(ir=0;ir<_r;++ir)An(T[ir],ie,Oe+1,Ut,pr),pr+=Bt}function mi(T,ie,Oe,Ut){var pr=1;if(ie.length)for(var Bt=0;Bt<ie.length;++Bt)pr*=ie[Bt];else pr=0;var ir=Ut||Lt.allocType(Oe,pr);switch(ie.length){case 0:break;case 1:Je(T,ie[0],ir);break;case 2:Ft(T,ie[0],ie[1],ir);break;case 3:Rr(T,ie[0],ie[1],ie[2],ir,0);break;default:An(T,ie,0,ir,0)}return ir}function _a(T){for(var ie=[],Oe=T;Oe.length;Oe=Oe[0])ie.push(Oe.length);return ie}var sa={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},xa=5120,Fa=5122,To=5124,so=5121,za=5123,xo=5125,uo=5126,Ho=5126,is={int8:xa,int16:Fa,int32:To,uint8:so,uint16:za,uint32:xo,float:uo,float32:Ho},ja=35048,Wi=35040,qa={dynamic:ja,stream:Wi,static:35044},Bu=ue.flatten,Ju=ue.shape,su=35044,$u=35040,wu=5121,uu=5126,cs=[];cs[5120]=1,cs[5122]=2,cs[5124]=4,cs[5121]=1,cs[5123]=2,cs[5125]=4,cs[5126]=4;function Us(T){return sa[Object.prototype.toString.call(T)]|0}function c(T,ie){for(var Oe=0;Oe<ie.length;++Oe)T[Oe]=ie[Oe]}function m(T,ie,Oe,Ut,pr,Bt,ir){for(var _r=0,Tr=0;Tr<Oe;++Tr)for(var Ir=0;Ir<Ut;++Ir)T[_r++]=ie[pr*Tr+Bt*Ir+ir]}function S(T,ie,Oe,Ut){var pr=0,Bt={};function ir(ht){this.id=pr++,this.buffer=T.createBuffer(),this.type=ht,this.usage=su,this.byteLength=0,this.dimension=1,this.dtype=wu,this.persistentData=null,Oe.profile&&(this.stats={size:0})}ir.prototype.bind=function(){T.bindBuffer(this.type,this.buffer)},ir.prototype.destroy=function(){Kr(this)};var _r=[];function Tr(ht,Yt){var kr=_r.pop();return kr||(kr=new ir(ht)),kr.bind(),Or(kr,Yt,$u,0,1,!1),kr}function Ir(ht){_r.push(ht)}function Lr(ht,Yt,kr){ht.byteLength=Yt.byteLength,T.bufferData(ht.type,Yt,kr)}function Or(ht,Yt,kr,Hr,yr,zr){var nn;if(ht.usage=kr,Array.isArray(Yt)){if(ht.dtype=Hr||uu,Yt.length>0){var Ln;if(Array.isArray(Yt[0])){nn=Ju(Yt);for(var ar=1,lr=1;lr<nn.length;++lr)ar*=nn[lr];ht.dimension=ar,Ln=Bu(Yt,nn,ht.dtype),Lr(ht,Ln,kr),zr?ht.persistentData=Ln:Lt.freeType(Ln)}else if(typeof Yt[0]=="number"){ht.dimension=yr;var wn=Lt.allocType(ht.dtype,Yt.length);c(wn,Yt),Lr(ht,wn,kr),zr?ht.persistentData=wn:Lt.freeType(wn)}else Ze(Yt[0])?(ht.dimension=Yt[0].length,ht.dtype=Hr||Us(Yt[0])||uu,Ln=Bu(Yt,[Yt.length,Yt[0].length],ht.dtype),Lr(ht,Ln,kr),zr?ht.persistentData=Ln:Lt.freeType(Ln)):b.raise("invalid buffer data")}}else if(Ze(Yt))ht.dtype=Hr||Us(Yt),ht.dimension=yr,Lr(ht,Yt,kr),zr&&(ht.persistentData=new Uint8Array(new Uint8Array(Yt.buffer)));else if(_o(Yt)){nn=Yt.shape;var Qr=Yt.stride,Pr=Yt.offset,rn=0,an=0,ui=0,Yn=0;nn.length===1?(rn=nn[0],an=1,ui=Qr[0],Yn=0):nn.length===2?(rn=nn[0],an=nn[1],ui=Qr[0],Yn=Qr[1]):b.raise("invalid shape"),ht.dtype=Hr||Us(Yt.data)||uu,ht.dimension=an;var en=Lt.allocType(ht.dtype,rn*an);m(en,Yt.data,rn,an,ui,Yn,Pr),Lr(ht,en,kr),zr?ht.persistentData=en:Lt.freeType(en)}else Yt instanceof ArrayBuffer?(ht.dtype=wu,ht.dimension=yr,Lr(ht,Yt,kr),zr&&(ht.persistentData=new Uint8Array(new Uint8Array(Yt)))):b.raise("invalid buffer data")}function Kr(ht){ie.bufferCount--,Ut(ht);var Yt=ht.buffer;b(Yt,"buffer must not be deleted already"),T.deleteBuffer(Yt),ht.buffer=null,delete Bt[ht.id]}function Cr(ht,Yt,kr,Hr){ie.bufferCount++;var yr=new ir(Yt);Bt[yr.id]=yr;function zr(ar){var lr=su,wn=null,Qr=0,Pr=0,rn=1;return Array.isArray(ar)||Ze(ar)||_o(ar)||ar instanceof ArrayBuffer?wn=ar:typeof ar=="number"?Qr=ar|0:ar&&(b.type(ar,"object","buffer arguments must be an object, a number or an array"),"data"in ar&&(b(wn===null||Array.isArray(wn)||Ze(wn)||_o(wn),"invalid data for buffer"),wn=ar.data),"usage"in ar&&(b.parameter(ar.usage,qa,"invalid buffer usage"),lr=qa[ar.usage]),"type"in ar&&(b.parameter(ar.type,is,"invalid buffer type"),Pr=is[ar.type]),"dimension"in ar&&(b.type(ar.dimension,"number","invalid dimension"),rn=ar.dimension|0),"length"in ar&&(b.nni(Qr,"buffer length must be a nonnegative integer"),Qr=ar.length|0)),yr.bind(),wn?Or(yr,wn,lr,Pr,rn,Hr):(Qr&&T.bufferData(yr.type,Qr,lr),yr.dtype=Pr||wu,yr.usage=lr,yr.dimension=rn,yr.byteLength=Qr),Oe.profile&&(yr.stats.size=yr.byteLength*cs[yr.dtype]),zr}function nn(ar,lr){b(lr+ar.byteLength<=yr.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+ar.byteLength+" starting from offset "+lr+" to a buffer of size "+yr.byteLength),T.bufferSubData(yr.type,lr,ar)}function Ln(ar,lr){var wn=(lr||0)|0,Qr;if(yr.bind(),Ze(ar)||ar instanceof ArrayBuffer)nn(ar,wn);else if(Array.isArray(ar)){if(ar.length>0)if(typeof ar[0]=="number"){var Pr=Lt.allocType(yr.dtype,ar.length);c(Pr,ar),nn(Pr,wn),Lt.freeType(Pr)}else if(Array.isArray(ar[0])||Ze(ar[0])){Qr=Ju(ar);var rn=Bu(ar,Qr,yr.dtype);nn(rn,wn),Lt.freeType(rn)}else b.raise("invalid buffer data")}else if(_o(ar)){Qr=ar.shape;var an=ar.stride,ui=0,Yn=0,en=0,ln=0;Qr.length===1?(ui=Qr[0],Yn=1,en=an[0],ln=0):Qr.length===2?(ui=Qr[0],Yn=Qr[1],en=an[0],ln=an[1]):b.raise("invalid shape");var Gn=Array.isArray(ar.data)?yr.dtype:Us(ar.data),ii=Lt.allocType(Gn,ui*Yn);m(ii,ar.data,ui,Yn,en,ln,ar.offset),nn(ii,wn),Lt.freeType(ii)}else b.raise("invalid data for buffer subdata");return zr}return kr||zr(ht),zr._reglType="buffer",zr._buffer=yr,zr.subdata=Ln,Oe.profile&&(zr.stats=yr.stats),zr.destroy=function(){Kr(yr)},zr}function Mr(){W(Bt).forEach(function(ht){ht.buffer=T.createBuffer(),T.bindBuffer(ht.type,ht.buffer),T.bufferData(ht.type,ht.persistentData||ht.byteLength,ht.usage)})}return Oe.profile&&(ie.getTotalBufferSize=function(){var ht=0;return Object.keys(Bt).forEach(function(Yt){ht+=Bt[Yt].stats.size}),ht}),{create:Cr,createStream:Tr,destroyStream:Ir,clear:function(){W(Bt).forEach(Kr),_r.forEach(Kr)},getBuffer:function(ht){return ht&&ht._buffer instanceof ir?ht._buffer:null},restore:Mr,_initBuffer:Or}}var _=0,G=0,oe=1,je=1,lt=4,gt=4,hr={points:_,point:G,lines:oe,line:je,triangles:lt,triangle:gt,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},cr=0,Cn=1,Xn=4,sn=5120,Ai=5121,Fi=5122,Gi=5123,bi=5124,Ao=5125,hs=34963,Gs=35040,Qu=35044;function Ms(T,ie,Oe,Ut){var pr={},Bt=0,ir={uint8:Ai,uint16:Gi};ie.oes_element_index_uint&&(ir.uint32=Ao);function _r(Mr){this.id=Bt++,pr[this.id]=this,this.buffer=Mr,this.primType=Xn,this.vertCount=0,this.type=0}_r.prototype.bind=function(){this.buffer.bind()};var Tr=[];function Ir(Mr){var ht=Tr.pop();return ht||(ht=new _r(Oe.create(null,hs,!0,!1)._buffer)),Or(ht,Mr,Gs,-1,-1,0,0),ht}function Lr(Mr){Tr.push(Mr)}function Or(Mr,ht,Yt,kr,Hr,yr,zr){Mr.buffer.bind();var nn;if(ht){var Ln=zr;!zr&&(!Ze(ht)||_o(ht)&&!Ze(ht.data))&&(Ln=ie.oes_element_index_uint?Ao:Gi),Oe._initBuffer(Mr.buffer,ht,Yt,Ln,3)}else T.bufferData(hs,yr,Yt),Mr.buffer.dtype=nn||Ai,Mr.buffer.usage=Yt,Mr.buffer.dimension=3,Mr.buffer.byteLength=yr;if(nn=zr,!zr){switch(Mr.buffer.dtype){case Ai:case sn:nn=Ai;break;case Gi:case Fi:nn=Gi;break;case Ao:case bi:nn=Ao;break;default:b.raise("unsupported type for element array")}Mr.buffer.dtype=nn}Mr.type=nn,b(nn!==Ao||!!ie.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var ar=Hr;ar<0&&(ar=Mr.buffer.byteLength,nn===Gi?ar>>=1:nn===Ao&&(ar>>=2)),Mr.vertCount=ar;var lr=kr;if(kr<0){lr=Xn;var wn=Mr.buffer.dimension;wn===1&&(lr=cr),wn===2&&(lr=Cn),wn===3&&(lr=Xn)}Mr.primType=lr}function Kr(Mr){Ut.elementsCount--,b(Mr.buffer!==null,"must not double destroy elements"),delete pr[Mr.id],Mr.buffer.destroy(),Mr.buffer=null}function Cr(Mr,ht){var Yt=Oe.create(null,hs,!0),kr=new _r(Yt._buffer);Ut.elementsCount++;function Hr(yr){if(!yr)Yt(),kr.primType=Xn,kr.vertCount=0,kr.type=Ai;else if(typeof yr=="number")Yt(yr),kr.primType=Xn,kr.vertCount=yr|0,kr.type=Ai;else{var zr=null,nn=Qu,Ln=-1,ar=-1,lr=0,wn=0;Array.isArray(yr)||Ze(yr)||_o(yr)?zr=yr:(b.type(yr,"object","invalid arguments for elements"),"data"in yr&&(zr=yr.data,b(Array.isArray(zr)||Ze(zr)||_o(zr),"invalid data for element buffer")),"usage"in yr&&(b.parameter(yr.usage,qa,"invalid element buffer usage"),nn=qa[yr.usage]),"primitive"in yr&&(b.parameter(yr.primitive,hr,"invalid element buffer primitive"),Ln=hr[yr.primitive]),"count"in yr&&(b(typeof yr.count=="number"&&yr.count>=0,"invalid vertex count for elements"),ar=yr.count|0),"type"in yr&&(b.parameter(yr.type,ir,"invalid buffer type"),wn=ir[yr.type]),"length"in yr?lr=yr.length|0:(lr=ar,wn===Gi||wn===Fi?lr*=2:(wn===Ao||wn===bi)&&(lr*=4))),Or(kr,zr,nn,Ln,ar,lr,wn)}return Hr}return Hr(Mr),Hr._reglType="elements",Hr._elements=kr,Hr.subdata=function(yr,zr){return Yt.subdata(yr,zr),Hr},Hr.destroy=function(){Kr(kr)},Hr}return{create:Cr,createStream:Ir,destroyStream:Lr,getElements:function(Mr){return typeof Mr=="function"&&Mr._elements instanceof _r?Mr._elements:null},clear:function(){W(pr).forEach(Kr)}}}var Eu=new Float32Array(1),xs=new Uint32Array(Eu.buffer),bs=5123;function ws(T){for(var ie=Lt.allocType(bs,T.length),Oe=0;Oe<T.length;++Oe)if(isNaN(T[Oe]))ie[Oe]=65535;else if(T[Oe]===Infinity)ie[Oe]=31744;else if(T[Oe]===-Infinity)ie[Oe]=64512;else{Eu[0]=T[Oe];var Ut=xs[0],pr=Ut>>>31<<15,Bt=(Ut<<1>>>24)-127,ir=Ut>>13&(1<<10)-1;if(Bt<-24)ie[Oe]=pr;else if(Bt<-14){var _r=-14-Bt;ie[Oe]=pr+(ir+(1<<10)>>_r)}else Bt>15?ie[Oe]=pr+31744:ie[Oe]=pr+(Bt+15<<10)+ir}return ie}function Ea(T){return Array.isArray(T)||Ze(T)}var kl=function(T){return!(T&T-1)&&!!T},el=34467,Co=3553,tl=34067,Es=34069,Wo=6408,rl=6406,js=6407,Xi=6409,qs=6410,Wl=32854,Zs=32855,Pl=36194,Xl=32819,Yl=32820,nl=33635,Su=34042,lu=6402,cu=34041,hu=35904,Ls=35906,fu=36193,Hs=33776,Xo=33777,il=33778,al=33779,Ml=35986,Ws=35987,Tu=34798,Au=35840,ol=35841,Nu=35842,Kl=35843,Cu=36196,Xs=5121,sl=5123,ul=5125,Ys=5126,Ll=10242,Dl=10243,ll=10497,pu=33071,Jl=33648,du=10240,pa=10241,Iu=9728,mu=9729,Ss=9984,wi=9985,ia=9986,Io=9987,ku=33170,qo=4352,Pu=4353,dc=4354,mc=34046,Vu=3317,Uu=37440,Yo=37441,Sa=37443,Ts=37444,As=33984,Ba=[Ss,ia,wi,Io],dn=[0,Xi,qs,js,Wo],da={};da[Xi]=da[rl]=da[lu]=1,da[cu]=da[qs]=2,da[js]=da[hu]=3,da[Wo]=da[Ls]=4;function Ds(T){return"[object "+T+"]"}var vu=Ds("HTMLCanvasElement"),Ko=Ds("OffscreenCanvas"),Oo=Ds("CanvasRenderingContext2D"),Rl=Ds("ImageBitmap"),Zr=Ds("HTMLImageElement"),Ks=Ds("HTMLVideoElement"),Gu=Object.keys(sa).concat([vu,Ko,Oo,Rl,Zr,Ks]),Js=[];Js[Xs]=1,Js[Ys]=4,Js[fu]=2,Js[sl]=2,Js[ul]=4;var ua=[];ua[Wl]=2,ua[Zs]=2,ua[Pl]=2,ua[cu]=4,ua[Hs]=.5,ua[Xo]=.5,ua[il]=1,ua[al]=1,ua[Ml]=.5,ua[Ws]=1,ua[Tu]=1,ua[Au]=.5,ua[ol]=.25,ua[Nu]=.5,ua[Kl]=.25,ua[Cu]=.5;function ko(T){return Array.isArray(T)&&(T.length===0||typeof T[0]=="number")}function cl(T){if(!Array.isArray(T))return!1;var ie=T.length;return!(ie===0||!Ea(T[0]))}function Cs(T){return Object.prototype.toString.call(T)}function lo(T){return Cs(T)===vu}function fs(T){return Cs(T)===Ko}function $l(T){return Cs(T)===Oo}function ju(T){return Cs(T)===Rl}function hl(T){return Cs(T)===Zr}function Ql(T){return Cs(T)===Ks}function g(T){var ie=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(ie&&T&&T.getContext)}function I(T){var ie=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(ie&&T&&"src"in T&&"crossOrigin"in T)}function $(T){if(!T)return!1;if(g(T)||I(T))return!0;var ie=Cs(T);return Gu.indexOf(ie)>=0?!0:ko(T)||cl(T)||_o(T)}function le(T){return sa[Object.prototype.toString.call(T)]|0}function st(T,ie){var Oe=ie.length;switch(T.type){case Xs:case sl:case ul:case Ys:var Ut=Lt.allocType(T.type,Oe);Ut.set(ie),T.data=Ut;break;case fu:T.data=ws(ie);break;default:b.raise("unsupported texture type, must specify a typed array")}}function tt(T,ie){return Lt.allocType(T.type===fu?Ys:T.type,ie)}function _t(T,ie){T.type===fu?(T.data=ws(ie),Lt.freeType(ie)):T.data=ie}function Xt(T,ie,Oe,Ut,pr,Bt){for(var ir=T.width,_r=T.height,Tr=T.channels,Ir=ir*_r*Tr,Lr=tt(T,Ir),Or=0,Kr=0;Kr<_r;++Kr)for(var Cr=0;Cr<ir;++Cr)for(var Mr=0;Mr<Tr;++Mr)Lr[Or++]=ie[Oe*Cr+Ut*Kr+pr*Mr+Bt];_t(T,Lr)}function sr(T,ie,Oe,Ut,pr,Bt){var ir;if(typeof ua[T]!="undefined"?ir=ua[T]:ir=da[T]*Js[ie],Bt&&(ir*=6),pr){for(var _r=0,Tr=Oe;Tr>=1;)_r+=ir*Tr*Tr,Tr/=2;return _r}else return ir*Oe*Ut}function Jr(T,ie,Oe,Ut,pr,Bt,ir){var _r={"don't care":qo,"dont care":qo,nice:dc,fast:Pu},Tr={repeat:ll,clamp:pu,mirror:Jl},Ir={nearest:Iu,linear:mu},Lr=l({mipmap:Io,"nearest mipmap nearest":Ss,"linear mipmap nearest":wi,"nearest mipmap linear":ia,"linear mipmap linear":Io},Ir),Or={none:0,browser:Ts},Kr={uint8:Xs,rgba4:Xl,rgb565:nl,"rgb5 a1":Yl},Cr={alpha:rl,luminance:Xi,"luminance alpha":qs,rgb:js,rgba:Wo,rgba4:Wl,"rgb5 a1":Zs,rgb565:Pl},Mr={};ie.ext_srgb&&(Cr.srgb=hu,Cr.srgba=Ls),ie.oes_texture_float&&(Kr.float32=Kr.float=Ys),ie.oes_texture_half_float&&(Kr.float16=Kr["half float"]=fu),ie.webgl_depth_texture&&(l(Cr,{depth:lu,"depth stencil":cu}),l(Kr,{uint16:sl,uint32:ul,"depth stencil":Su})),ie.webgl_compressed_texture_s3tc&&l(Mr,{"rgb s3tc dxt1":Hs,"rgba s3tc dxt1":Xo,"rgba s3tc dxt3":il,"rgba s3tc dxt5":al}),ie.webgl_compressed_texture_atc&&l(Mr,{"rgb atc":Ml,"rgba atc explicit alpha":Ws,"rgba atc interpolated alpha":Tu}),ie.webgl_compressed_texture_pvrtc&&l(Mr,{"rgb pvrtc 4bppv1":Au,"rgb pvrtc 2bppv1":ol,"rgba pvrtc 4bppv1":Nu,"rgba pvrtc 2bppv1":Kl}),ie.webgl_compressed_texture_etc1&&(Mr["rgb etc1"]=Cu);var ht=Array.prototype.slice.call(T.getParameter(el)||new Uint32Array(0));Object.keys(Mr).forEach(function(be){var qt=Mr[be];ht.indexOf(qt)>=0&&(Cr[be]=qt)});var Yt=Object.keys(Cr);Oe.textureFormats=Yt;var kr=[];Object.keys(Cr).forEach(function(be){var qt=Cr[be];kr[qt]=be});var Hr=[];Object.keys(Kr).forEach(function(be){var qt=Kr[be];Hr[qt]=be});var yr=[];Object.keys(Ir).forEach(function(be){var qt=Ir[be];yr[qt]=be});var zr=[];Object.keys(Lr).forEach(function(be){var qt=Lr[be];zr[qt]=be});var nn=[];Object.keys(Tr).forEach(function(be){var qt=Tr[be];nn[qt]=be});var Ln=Yt.reduce(function(be,qt){var At=Cr[qt];return At===Xi||At===rl||At===Xi||At===qs||At===lu||At===cu||ie.ext_srgb&&(At===hu||At===Ls)?be[At]=At:At===Zs||qt.indexOf("rgba")>=0?be[At]=Wo:be[At]=js,be},{});function ar(){this.internalformat=Wo,this.format=Wo,this.type=Xs,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Ts,this.width=0,this.height=0,this.channels=0}function lr(be,qt){be.internalformat=qt.internalformat,be.format=qt.format,be.type=qt.type,be.compressed=qt.compressed,be.premultiplyAlpha=qt.premultiplyAlpha,be.flipY=qt.flipY,be.unpackAlignment=qt.unpackAlignment,be.colorSpace=qt.colorSpace,be.width=qt.width,be.height=qt.height,be.channels=qt.channels}function wn(be,qt){if(!(typeof qt!="object"||!qt)){if("premultiplyAlpha"in qt&&(b.type(qt.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),be.premultiplyAlpha=qt.premultiplyAlpha),"flipY"in qt&&(b.type(qt.flipY,"boolean","invalid texture flip"),be.flipY=qt.flipY),"alignment"in qt&&(b.oneOf(qt.alignment,[1,2,4,8],"invalid texture unpack alignment"),be.unpackAlignment=qt.alignment),"colorSpace"in qt&&(b.parameter(qt.colorSpace,Or,"invalid colorSpace"),be.colorSpace=Or[qt.colorSpace]),"type"in qt){var At=qt.type;b(ie.oes_texture_float||!(At==="float"||At==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),b(ie.oes_texture_half_float||!(At==="half float"||At==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),b(ie.webgl_depth_texture||!(At==="uint16"||At==="uint32"||At==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),b.parameter(At,Kr,"invalid texture type"),be.type=Kr[At]}var gn=be.width,ki=be.height,de=be.channels,Y=!1;"shape"in qt?(b(Array.isArray(qt.shape)&&qt.shape.length>=2,"shape must be an array"),gn=qt.shape[0],ki=qt.shape[1],qt.shape.length===3&&(de=qt.shape[2],b(de>0&&de<=4,"invalid number of channels"),Y=!0),b(gn>=0&&gn<=Oe.maxTextureSize,"invalid width"),b(ki>=0&&ki<=Oe.maxTextureSize,"invalid height")):("radius"in qt&&(gn=ki=qt.radius,b(gn>=0&&gn<=Oe.maxTextureSize,"invalid radius")),"width"in qt&&(gn=qt.width,b(gn>=0&&gn<=Oe.maxTextureSize,"invalid width")),"height"in qt&&(ki=qt.height,b(ki>=0&&ki<=Oe.maxTextureSize,"invalid height")),"channels"in qt&&(de=qt.channels,b(de>0&&de<=4,"invalid number of channels"),Y=!0)),be.width=gn|0,be.height=ki|0,be.channels=de|0;var Ue=!1;if("format"in qt){var ft=qt.format;b(ie.webgl_depth_texture||!(ft==="depth"||ft==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),b.parameter(ft,Cr,"invalid texture format");var Ot=be.internalformat=Cr[ft];be.format=Ln[Ot],ft in Kr&&("type"in qt||(be.type=Kr[ft])),ft in Mr&&(be.compressed=!0),Ue=!0}!Y&&Ue?be.channels=da[be.format]:Y&&!Ue?be.channels!==dn[be.format]&&(be.format=be.internalformat=dn[be.channels]):Ue&&Y&&b(be.channels===da[be.format],"number of channels inconsistent with specified format")}}function Qr(be){T.pixelStorei(Uu,be.flipY),T.pixelStorei(Yo,be.premultiplyAlpha),T.pixelStorei(Sa,be.colorSpace),T.pixelStorei(Vu,be.unpackAlignment)}function Pr(){ar.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function rn(be,qt){var At=null;if($(qt)?At=qt:qt&&(b.type(qt,"object","invalid pixel data type"),wn(be,qt),"x"in qt&&(be.xOffset=qt.x|0),"y"in qt&&(be.yOffset=qt.y|0),$(qt.data)&&(At=qt.data)),b(!be.compressed||At instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),qt.copy){b(!At,"can not specify copy and data field for the same texture");var gn=pr.viewportWidth,ki=pr.viewportHeight;be.width=be.width||gn-be.xOffset,be.height=be.height||ki-be.yOffset,be.needsCopy=!0,b(be.xOffset>=0&&be.xOffset<gn&&be.yOffset>=0&&be.yOffset<ki&&be.width>0&&be.width<=gn&&be.height>0&&be.height<=ki,"copy texture read out of bounds")}else if(!At)be.width=be.width||1,be.height=be.height||1,be.channels=be.channels||4;else if(Ze(At))be.channels=be.channels||4,be.data=At,!("type"in qt)&&be.type===Xs&&(be.type=le(At));else if(ko(At))be.channels=be.channels||4,st(be,At),be.alignment=1,be.needsFree=!0;else if(_o(At)){var de=At.data;!Array.isArray(de)&&be.type===Xs&&(be.type=le(de));var Y=At.shape,Ue=At.stride,ft,Ot,Ke,Re,nt,se;Y.length===3?(Ke=Y[2],se=Ue[2]):(b(Y.length===2,"invalid ndarray pixel data, must be 2 or 3D"),Ke=1,se=1),ft=Y[0],Ot=Y[1],Re=Ue[0],nt=Ue[1],be.alignment=1,be.width=ft,be.height=Ot,be.channels=Ke,be.format=be.internalformat=dn[Ke],be.needsFree=!0,Xt(be,de,Re,nt,se,At.offset)}else if(g(At)||lo(At)||fs(At)||$l(At))g(At)||lo(At)||fs(At)?be.element=At:be.element=At.canvas,be.width=be.element.width,be.height=be.element.height,be.channels=4;else if(ju(At))be.element=At,be.width=At.width,be.height=At.height,be.channels=4;else if(hl(At))be.element=At,be.width=At.naturalWidth,be.height=At.naturalHeight,be.channels=4;else if(I(At))be.element=At,be.width=At.width,be.height=At.height,be.channels=4;else if(Ql(At))be.element=At,be.width=At.videoWidth,be.height=At.videoHeight,be.channels=4;else if(cl(At)){var Ve=be.width||At[0].length,ye=be.height||At.length,pt=be.channels;Ea(At[0][0])?pt=pt||At[0][0].length:pt=pt||1;for(var Ct=ue.shape(At),xr=1,Wr=0;Wr<Ct.length;++Wr)xr*=Ct[Wr];var Xr=tt(be,xr);ue.flatten(At,Ct,"",Xr),_t(be,Xr),be.alignment=1,be.width=Ve,be.height=ye,be.channels=pt,be.format=be.internalformat=dn[pt],be.needsFree=!0}be.type===Ys?b(Oe.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):be.type===fu&&b(Oe.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function an(be,qt,At){var gn=be.element,ki=be.data,de=be.internalformat,Y=be.format,Ue=be.type,ft=be.width,Ot=be.height;Qr(be),gn?T.texImage2D(qt,At,Y,Y,Ue,gn):be.compressed?T.compressedTexImage2D(qt,At,de,ft,Ot,0,ki):be.needsCopy?(Ut(),T.copyTexImage2D(qt,At,Y,be.xOffset,be.yOffset,ft,Ot,0)):T.texImage2D(qt,At,Y,ft,Ot,0,Y,Ue,ki||null)}function ui(be,qt,At,gn,ki){var de=be.element,Y=be.data,Ue=be.internalformat,ft=be.format,Ot=be.type,Ke=be.width,Re=be.height;Qr(be),de?T.texSubImage2D(qt,ki,At,gn,ft,Ot,de):be.compressed?T.compressedTexSubImage2D(qt,ki,At,gn,Ue,Ke,Re,Y):be.needsCopy?(Ut(),T.copyTexSubImage2D(qt,ki,At,gn,be.xOffset,be.yOffset,Ke,Re)):T.texSubImage2D(qt,ki,At,gn,Ke,Re,ft,Ot,Y)}var Yn=[];function en(){return Yn.pop()||new Pr}function ln(be){be.needsFree&&Lt.freeType(be.data),Pr.call(be),Yn.push(be)}function Gn(){ar.call(this),this.genMipmaps=!1,this.mipmapHint=qo,this.mipmask=0,this.images=Array(16)}function ii(be,qt,At){var gn=be.images[0]=en();be.mipmask=1,gn.width=be.width=qt,gn.height=be.height=At,gn.channels=be.channels=4}function Ii(be,qt){var At=null;if($(qt))At=be.images[0]=en(),lr(At,be),rn(At,qt),be.mipmask=1;else if(wn(be,qt),Array.isArray(qt.mipmap))for(var gn=qt.mipmap,ki=0;ki<gn.length;++ki)At=be.images[ki]=en(),lr(At,be),At.width>>=ki,At.height>>=ki,rn(At,gn[ki]),be.mipmask|=1<<ki;else At=be.images[0]=en(),lr(At,be),rn(At,qt),be.mipmask=1;lr(be,be.images[0]),be.compressed&&(be.internalformat===Hs||be.internalformat===Xo||be.internalformat===il||be.internalformat===al)&&b(be.width%4==0&&be.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Da(be,qt){for(var At=be.images,gn=0;gn<At.length;++gn){if(!At[gn])return;an(At[gn],qt,gn)}}var Va=[];function Si(){var be=Va.pop()||new Gn;ar.call(be),be.mipmask=0;for(var qt=0;qt<16;++qt)be.images[qt]=null;return be}function Po(be){for(var qt=be.images,At=0;At<qt.length;++At)qt[At]&&ln(qt[At]),qt[At]=null;Va.push(be)}function Aa(){this.minFilter=Iu,this.magFilter=Iu,this.wrapS=pu,this.wrapT=pu,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=qo}function bo(be,qt){if("min"in qt){var At=qt.min;b.parameter(At,Lr),be.minFilter=Lr[At],Ba.indexOf(be.minFilter)>=0&&!("faces"in qt)&&(be.genMipmaps=!0)}if("mag"in qt){var gn=qt.mag;b.parameter(gn,Ir),be.magFilter=Ir[gn]}var ki=be.wrapS,de=be.wrapT;if("wrap"in qt){var Y=qt.wrap;typeof Y=="string"?(b.parameter(Y,Tr),ki=de=Tr[Y]):Array.isArray(Y)&&(b.parameter(Y[0],Tr),b.parameter(Y[1],Tr),ki=Tr[Y[0]],de=Tr[Y[1]])}else{if("wrapS"in qt){var Ue=qt.wrapS;b.parameter(Ue,Tr),ki=Tr[Ue]}if("wrapT"in qt){var ft=qt.wrapT;b.parameter(ft,Tr),de=Tr[ft]}}if(be.wrapS=ki,be.wrapT=de,"anisotropic"in qt){var Ot=qt.anisotropic;b(typeof Ot=="number"&&Ot>=1&&Ot<=Oe.maxAnisotropic,"aniso samples must be between 1 and "),be.anisotropic=qt.anisotropic}if("mipmap"in qt){var Ke=!1;switch(typeof qt.mipmap){case"string":b.parameter(qt.mipmap,_r,"invalid mipmap hint"),be.mipmapHint=_r[qt.mipmap],be.genMipmaps=!0,Ke=!0;break;case"boolean":Ke=be.genMipmaps=qt.mipmap;break;case"object":b(Array.isArray(qt.mipmap),"invalid mipmap type"),be.genMipmaps=!1,Ke=!0;break;default:b.raise("invalid mipmap type")}Ke&&!("min"in qt)&&(be.minFilter=Ss)}}function Xa(be,qt){T.texParameteri(qt,pa,be.minFilter),T.texParameteri(qt,du,be.magFilter),T.texParameteri(qt,Ll,be.wrapS),T.texParameteri(qt,Dl,be.wrapT),ie.ext_texture_filter_anisotropic&&T.texParameteri(qt,mc,be.anisotropic),be.genMipmaps&&(T.hint(ku,be.mipmapHint),T.generateMipmap(qt))}var wo=0,po={},Vo=Oe.maxTextureUnits,Ua=Array(Vo).map(function(){return null});function li(be){ar.call(this),this.mipmask=0,this.internalformat=Wo,this.id=wo++,this.refCount=1,this.target=be,this.texture=T.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Aa,ir.profile&&(this.stats={size:0})}function mo(be){T.activeTexture(As),T.bindTexture(be.target,be.texture)}function Vi(){var be=Ua[0];be?T.bindTexture(be.target,be.texture):T.bindTexture(Co,null)}function Mo(be){var qt=be.texture;b(qt,"must not double destroy texture");var At=be.unit,gn=be.target;At>=0&&(T.activeTexture(As+At),T.bindTexture(gn,null),Ua[At]=null),T.deleteTexture(qt),be.texture=null,be.params=null,be.pixels=null,be.refCount=0,delete po[be.id],Bt.textureCount--}l(li.prototype,{bind:function(){var be=this;be.bindCount+=1;var qt=be.unit;if(qt<0){for(var At=0;At<Vo;++At){var gn=Ua[At];if(gn){if(gn.bindCount>0)continue;gn.unit=-1}Ua[At]=be,qt=At;break}qt>=Vo&&b.raise("insufficient number of texture units"),ir.profile&&Bt.maxTextureUnits<qt+1&&(Bt.maxTextureUnits=qt+1),be.unit=qt,T.activeTexture(As+qt),T.bindTexture(be.target,be.texture)}return qt},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Mo(this)}});function Zn(be,qt){var At=new li(Co);po[At.id]=At,Bt.textureCount++;function gn(Y,Ue){var ft=At.texInfo;Aa.call(ft);var Ot=Si();return typeof Y=="number"?typeof Ue=="number"?ii(Ot,Y|0,Ue|0):ii(Ot,Y|0,Y|0):Y?(b.type(Y,"object","invalid arguments to regl.texture"),bo(ft,Y),Ii(Ot,Y)):ii(Ot,1,1),ft.genMipmaps&&(Ot.mipmask=(Ot.width<<1)-1),At.mipmask=Ot.mipmask,lr(At,Ot),b.texture2D(ft,Ot,Oe),At.internalformat=Ot.internalformat,gn.width=Ot.width,gn.height=Ot.height,mo(At),Da(Ot,Co),Xa(ft,Co),Vi(),Po(Ot),ir.profile&&(At.stats.size=sr(At.internalformat,At.type,Ot.width,Ot.height,ft.genMipmaps,!1)),gn.format=kr[At.internalformat],gn.type=Hr[At.type],gn.mag=yr[ft.magFilter],gn.min=zr[ft.minFilter],gn.wrapS=nn[ft.wrapS],gn.wrapT=nn[ft.wrapT],gn}function ki(Y,Ue,ft,Ot){b(!!Y,"must specify image data");var Ke=Ue|0,Re=ft|0,nt=Ot|0,se=en();return lr(se,At),se.width=0,se.height=0,rn(se,Y),se.width=se.width||(At.width>>nt)-Ke,se.height=se.height||(At.height>>nt)-Re,b(At.type===se.type&&At.format===se.format&&At.internalformat===se.internalformat,"incompatible format for texture.subimage"),b(Ke>=0&&Re>=0&&Ke+se.width<=At.width&&Re+se.height<=At.height,"texture.subimage write out of bounds"),b(At.mipmask&1<<nt,"missing mipmap data"),b(se.data||se.element||se.needsCopy,"missing image data"),mo(At),ui(se,Co,Ke,Re,nt),Vi(),ln(se),gn}function de(Y,Ue){var ft=Y|0,Ot=Ue|0||ft;if(ft===At.width&&Ot===At.height)return gn;gn.width=At.width=ft,gn.height=At.height=Ot,mo(At);for(var Ke=0;At.mipmask>>Ke;++Ke){var Re=ft>>Ke,nt=Ot>>Ke;if(!Re||!nt)break;T.texImage2D(Co,Ke,At.format,Re,nt,0,At.format,At.type,null)}return Vi(),ir.profile&&(At.stats.size=sr(At.internalformat,At.type,ft,Ot,!1,!1)),gn}return gn(be,qt),gn.subimage=ki,gn.resize=de,gn._reglType="texture2d",gn._texture=At,ir.profile&&(gn.stats=At.stats),gn.destroy=function(){At.decRef()},gn}function Ti(be,qt,At,gn,ki,de){var Y=new li(tl);po[Y.id]=Y,Bt.cubeCount++;var Ue=new Array(6);function ft(Re,nt,se,Ve,ye,pt){var Ct,xr=Y.texInfo;for(Aa.call(xr),Ct=0;Ct<6;++Ct)Ue[Ct]=Si();if(typeof Re=="number"||!Re){var Wr=Re|0||1;for(Ct=0;Ct<6;++Ct)ii(Ue[Ct],Wr,Wr)}else if(typeof Re=="object")if(nt)Ii(Ue[0],Re),Ii(Ue[1],nt),Ii(Ue[2],se),Ii(Ue[3],Ve),Ii(Ue[4],ye),Ii(Ue[5],pt);else if(bo(xr,Re),wn(Y,Re),"faces"in Re){var Xr=Re.faces;for(b(Array.isArray(Xr)&&Xr.length===6,"cube faces must be a length 6 array"),Ct=0;Ct<6;++Ct)b(typeof Xr[Ct]=="object"&&!!Xr[Ct],"invalid input for cube map face"),lr(Ue[Ct],Y),Ii(Ue[Ct],Xr[Ct])}else for(Ct=0;Ct<6;++Ct)Ii(Ue[Ct],Re);else b.raise("invalid arguments to cube map");for(lr(Y,Ue[0]),b.optional(function(){Oe.npotTextureCube||b(kl(Y.width)&&kl(Y.height),"your browser does not support non power or two texture dimensions")}),xr.genMipmaps?Y.mipmask=(Ue[0].width<<1)-1:Y.mipmask=Ue[0].mipmask,b.textureCube(Y,xr,Ue,Oe),Y.internalformat=Ue[0].internalformat,ft.width=Ue[0].width,ft.height=Ue[0].height,mo(Y),Ct=0;Ct<6;++Ct)Da(Ue[Ct],Es+Ct);for(Xa(xr,tl),Vi(),ir.profile&&(Y.stats.size=sr(Y.internalformat,Y.type,ft.width,ft.height,xr.genMipmaps,!0)),ft.format=kr[Y.internalformat],ft.type=Hr[Y.type],ft.mag=yr[xr.magFilter],ft.min=zr[xr.minFilter],ft.wrapS=nn[xr.wrapS],ft.wrapT=nn[xr.wrapT],Ct=0;Ct<6;++Ct)Po(Ue[Ct]);return ft}function Ot(Re,nt,se,Ve,ye){b(!!nt,"must specify image data"),b(typeof Re=="number"&&Re===(Re|0)&&Re>=0&&Re<6,"invalid face");var pt=se|0,Ct=Ve|0,xr=ye|0,Wr=en();return lr(Wr,Y),Wr.width=0,Wr.height=0,rn(Wr,nt),Wr.width=Wr.width||(Y.width>>xr)-pt,Wr.height=Wr.height||(Y.height>>xr)-Ct,b(Y.type===Wr.type&&Y.format===Wr.format&&Y.internalformat===Wr.internalformat,"incompatible format for texture.subimage"),b(pt>=0&&Ct>=0&&pt+Wr.width<=Y.width&&Ct+Wr.height<=Y.height,"texture.subimage write out of bounds"),b(Y.mipmask&1<<xr,"missing mipmap data"),b(Wr.data||Wr.element||Wr.needsCopy,"missing image data"),mo(Y),ui(Wr,Es+Re,pt,Ct,xr),Vi(),ln(Wr),ft}function Ke(Re){var nt=Re|0;if(nt!==Y.width){ft.width=Y.width=nt,ft.height=Y.height=nt,mo(Y);for(var se=0;se<6;++se)for(var Ve=0;Y.mipmask>>Ve;++Ve)T.texImage2D(Es+se,Ve,Y.format,nt>>Ve,nt>>Ve,0,Y.format,Y.type,null);return Vi(),ir.profile&&(Y.stats.size=sr(Y.internalformat,Y.type,ft.width,ft.height,!1,!0)),ft}}return ft(be,qt,At,gn,ki,de),ft.subimage=Ot,ft.resize=Ke,ft._reglType="textureCube",ft._texture=Y,ir.profile&&(ft.stats=Y.stats),ft.destroy=function(){Y.decRef()},ft}function Yi(){for(var be=0;be<Vo;++be)T.activeTexture(As+be),T.bindTexture(Co,null),Ua[be]=null;W(po).forEach(Mo),Bt.cubeCount=0,Bt.textureCount=0}ir.profile&&(Bt.getTotalTextureSize=function(){var be=0;return Object.keys(po).forEach(function(qt){be+=po[qt].stats.size}),be});function Ya(){for(var be=0;be<Vo;++be){var qt=Ua[be];qt&&(qt.bindCount=0,qt.unit=-1,Ua[be]=null)}W(po).forEach(function(At){At.texture=T.createTexture(),T.bindTexture(At.target,At.texture);for(var gn=0;gn<32;++gn)if((At.mipmask&1<<gn)!=0)if(At.target===Co)T.texImage2D(Co,gn,At.internalformat,At.width>>gn,At.height>>gn,0,At.internalformat,At.type,null);else for(var ki=0;ki<6;++ki)T.texImage2D(Es+ki,gn,At.internalformat,At.width>>gn,At.height>>gn,0,At.internalformat,At.type,null);Xa(At.texInfo,At.target)})}function Ou(){for(var be=0;be<Vo;++be){var qt=Ua[be];qt&&(qt.bindCount=0,qt.unit=-1,Ua[be]=null),T.activeTexture(As+be),T.bindTexture(Co,null),T.bindTexture(tl,null)}}return{create2D:Zn,createCube:Ti,clear:Yi,getTexture:function(be){return null},restore:Ya,refresh:Ou}}var Tn=36161,tr=32854,or=32855,jn=36194,Ci=33189,Ni=36168,xi=34041,Ta=35907,to=34836,La=34842,ti=34843,yi=[];yi[tr]=2,yi[or]=2,yi[jn]=2,yi[Ci]=2,yi[Ni]=1,yi[xi]=4,yi[Ta]=4,yi[to]=16,yi[La]=8,yi[ti]=6;function Fo(T,ie,Oe){return yi[T]*ie*Oe}var si=function(T,ie,Oe,Ut,pr){var Bt={rgba4:tr,rgb565:jn,"rgb5 a1":or,depth:Ci,stencil:Ni,"depth stencil":xi};ie.ext_srgb&&(Bt.srgba=Ta),ie.ext_color_buffer_half_float&&(Bt.rgba16f=La,Bt.rgb16f=ti),ie.webgl_color_buffer_float&&(Bt.rgba32f=to);var ir=[];Object.keys(Bt).forEach(function(Cr){var Mr=Bt[Cr];ir[Mr]=Cr});var _r=0,Tr={};function Ir(Cr){this.id=_r++,this.refCount=1,this.renderbuffer=Cr,this.format=tr,this.width=0,this.height=0,pr.profile&&(this.stats={size:0})}Ir.prototype.decRef=function(){--this.refCount<=0&&Lr(this)};function Lr(Cr){var Mr=Cr.renderbuffer;b(Mr,"must not double destroy renderbuffer"),T.bindRenderbuffer(Tn,null),T.deleteRenderbuffer(Mr),Cr.renderbuffer=null,Cr.refCount=0,delete Tr[Cr.id],Ut.renderbufferCount--}function Or(Cr,Mr){var ht=new Ir(T.createRenderbuffer());Tr[ht.id]=ht,Ut.renderbufferCount++;function Yt(Hr,yr){var zr=0,nn=0,Ln=tr;if(typeof Hr=="object"&&Hr){var ar=Hr;if("shape"in ar){var lr=ar.shape;b(Array.isArray(lr)&&lr.length>=2,"invalid renderbuffer shape"),zr=lr[0]|0,nn=lr[1]|0}else"radius"in ar&&(zr=nn=ar.radius|0),"width"in ar&&(zr=ar.width|0),"height"in ar&&(nn=ar.height|0);"format"in ar&&(b.parameter(ar.format,Bt,"invalid renderbuffer format"),Ln=Bt[ar.format])}else typeof Hr=="number"?(zr=Hr|0,typeof yr=="number"?nn=yr|0:nn=zr):Hr?b.raise("invalid arguments to renderbuffer constructor"):zr=nn=1;if(b(zr>0&&nn>0&&zr<=Oe.maxRenderbufferSize&&nn<=Oe.maxRenderbufferSize,"invalid renderbuffer size"),!(zr===ht.width&&nn===ht.height&&Ln===ht.format))return Yt.width=ht.width=zr,Yt.height=ht.height=nn,ht.format=Ln,T.bindRenderbuffer(Tn,ht.renderbuffer),T.renderbufferStorage(Tn,Ln,zr,nn),b(T.getError()===0,"invalid render buffer format"),pr.profile&&(ht.stats.size=Fo(ht.format,ht.width,ht.height)),Yt.format=ir[ht.format],Yt}function kr(Hr,yr){var zr=Hr|0,nn=yr|0||zr;return zr===ht.width&&nn===ht.height||(b(zr>0&&nn>0&&zr<=Oe.maxRenderbufferSize&&nn<=Oe.maxRenderbufferSize,"invalid renderbuffer size"),Yt.width=ht.width=zr,Yt.height=ht.height=nn,T.bindRenderbuffer(Tn,ht.renderbuffer),T.renderbufferStorage(Tn,ht.format,zr,nn),b(T.getError()===0,"invalid render buffer format"),pr.profile&&(ht.stats.size=Fo(ht.format,ht.width,ht.height))),Yt}return Yt(Cr,Mr),Yt.resize=kr,Yt._reglType="renderbuffer",Yt._renderbuffer=ht,pr.profile&&(Yt.stats=ht.stats),Yt.destroy=function(){ht.decRef()},Yt}pr.profile&&(Ut.getTotalRenderbufferSize=function(){var Cr=0;return Object.keys(Tr).forEach(function(Mr){Cr+=Tr[Mr].stats.size}),Cr});function Kr(){W(Tr).forEach(function(Cr){Cr.renderbuffer=T.createRenderbuffer(),T.bindRenderbuffer(Tn,Cr.renderbuffer),T.renderbufferStorage(Tn,Cr.format,Cr.width,Cr.height)}),T.bindRenderbuffer(Tn,null)}return{create:Or,clear:function(){W(Tr).forEach(Lr)},restore:Kr}},ha=36160,ba=36161,ji=3553,ri=34069,ta=36064,la=36096,Zo=36128,Rs=33306,Os=36053,ps=36054,as=36055,Jo=36057,$s=36061,Qs=36193,fl=5121,eu=5126,$o=6407,pl=6408,qu=6402,Ol=[$o,pl],Mu=[];Mu[pl]=4,Mu[$o]=3;var n=[];n[fl]=1,n[eu]=4,n[Qs]=2;var a=32854,i=32855,o=36194,f=33189,d=36168,v=34041,x=35907,C=34836,F=34842,K=34843,ee=[a,i,o,x,F,K,C],re={};re[Os]="complete",re[ps]="incomplete attachment",re[Jo]="incomplete dimensions",re[as]="incomplete, missing attachment",re[$s]="unsupported";function Pe(T,ie,Oe,Ut,pr,Bt){var ir={cur:null,next:null,dirty:!1,setFBO:null},_r=["rgba"],Tr=["rgba4","rgb565","rgb5 a1"];ie.ext_srgb&&Tr.push("srgba"),ie.ext_color_buffer_half_float&&Tr.push("rgba16f","rgb16f"),ie.webgl_color_buffer_float&&Tr.push("rgba32f");var Ir=["uint8"];ie.oes_texture_half_float&&Ir.push("half float","float16"),ie.oes_texture_float&&Ir.push("float","float32");function Lr(Pr,rn,an){this.target=Pr,this.texture=rn,this.renderbuffer=an;var ui=0,Yn=0;rn?(ui=rn.width,Yn=rn.height):an&&(ui=an.width,Yn=an.height),this.width=ui,this.height=Yn}function Or(Pr){Pr&&(Pr.texture&&Pr.texture._texture.decRef(),Pr.renderbuffer&&Pr.renderbuffer._renderbuffer.decRef())}function Kr(Pr,rn,an){if(!!Pr)if(Pr.texture){var ui=Pr.texture._texture,Yn=Math.max(1,ui.width),en=Math.max(1,ui.height);b(Yn===rn&&en===an,"inconsistent width/height for supplied texture"),ui.refCount+=1}else{var ln=Pr.renderbuffer._renderbuffer;b(ln.width===rn&&ln.height===an,"inconsistent width/height for renderbuffer"),ln.refCount+=1}}function Cr(Pr,rn){rn&&(rn.texture?T.framebufferTexture2D(ha,Pr,rn.target,rn.texture._texture.texture,0):T.framebufferRenderbuffer(ha,Pr,ba,rn.renderbuffer._renderbuffer.renderbuffer))}function Mr(Pr){var rn=ji,an=null,ui=null,Yn=Pr;typeof Pr=="object"&&(Yn=Pr.data,"target"in Pr&&(rn=Pr.target|0)),b.type(Yn,"function","invalid attachment data");var en=Yn._reglType;return en==="texture2d"?(an=Yn,b(rn===ji)):en==="textureCube"?(an=Yn,b(rn>=ri&&rn<ri+6,"invalid cube map target")):en==="renderbuffer"?(ui=Yn,rn=ba):b.raise("invalid regl object for attachment"),new Lr(rn,an,ui)}function ht(Pr,rn,an,ui,Yn){if(an){var en=Ut.create2D({width:Pr,height:rn,format:ui,type:Yn});return en._texture.refCount=0,new Lr(ji,en,null)}else{var ln=pr.create({width:Pr,height:rn,format:ui});return ln._renderbuffer.refCount=0,new Lr(ba,null,ln)}}function Yt(Pr){return Pr&&(Pr.texture||Pr.renderbuffer)}function kr(Pr,rn,an){Pr&&(Pr.texture?Pr.texture.resize(rn,an):Pr.renderbuffer&&Pr.renderbuffer.resize(rn,an),Pr.width=rn,Pr.height=an)}var Hr=0,yr={};function zr(){this.id=Hr++,yr[this.id]=this,this.framebuffer=T.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function nn(Pr){Pr.colorAttachments.forEach(Or),Or(Pr.depthAttachment),Or(Pr.stencilAttachment),Or(Pr.depthStencilAttachment)}function Ln(Pr){var rn=Pr.framebuffer;b(rn,"must not double destroy framebuffer"),T.deleteFramebuffer(rn),Pr.framebuffer=null,Bt.framebufferCount--,delete yr[Pr.id]}function ar(Pr){var rn;T.bindFramebuffer(ha,Pr.framebuffer);var an=Pr.colorAttachments;for(rn=0;rn<an.length;++rn)Cr(ta+rn,an[rn]);for(rn=an.length;rn<Oe.maxColorAttachments;++rn)T.framebufferTexture2D(ha,ta+rn,ji,null,0);T.framebufferTexture2D(ha,Rs,ji,null,0),T.framebufferTexture2D(ha,la,ji,null,0),T.framebufferTexture2D(ha,Zo,ji,null,0),Cr(la,Pr.depthAttachment),Cr(Zo,Pr.stencilAttachment),Cr(Rs,Pr.depthStencilAttachment);var ui=T.checkFramebufferStatus(ha);!T.isContextLost()&&ui!==Os&&b.raise("framebuffer configuration not supported, status = "+re[ui]),T.bindFramebuffer(ha,ir.next?ir.next.framebuffer:null),ir.cur=ir.next,T.getError()}function lr(Pr,rn){var an=new zr;Bt.framebufferCount++;function ui(en,ln){var Gn;b(ir.next!==an,"can not update framebuffer which is currently in use");var ii=0,Ii=0,Da=!0,Va=!0,Si=null,Po=!0,Aa="rgba",bo="uint8",Xa=1,wo=null,po=null,Vo=null,Ua=!1;if(typeof en=="number")ii=en|0,Ii=ln|0||ii;else if(!en)ii=Ii=1;else{b.type(en,"object","invalid arguments for framebuffer");var li=en;if("shape"in li){var mo=li.shape;b(Array.isArray(mo)&&mo.length>=2,"invalid shape for framebuffer"),ii=mo[0],Ii=mo[1]}else"radius"in li&&(ii=Ii=li.radius),"width"in li&&(ii=li.width),"height"in li&&(Ii=li.height);("color"in li||"colors"in li)&&(Si=li.color||li.colors,Array.isArray(Si)&&b(Si.length===1||ie.webgl_draw_buffers,"multiple render targets not supported")),Si||("colorCount"in li&&(Xa=li.colorCount|0,b(Xa>0,"invalid color buffer count")),"colorTexture"in li&&(Po=!!li.colorTexture,Aa="rgba4"),"colorType"in li&&(bo=li.colorType,Po?(b(ie.oes_texture_float||!(bo==="float"||bo==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),b(ie.oes_texture_half_float||!(bo==="half float"||bo==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):bo==="half float"||bo==="float16"?(b(ie.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Aa="rgba16f"):(bo==="float"||bo==="float32")&&(b(ie.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Aa="rgba32f"),b.oneOf(bo,Ir,"invalid color type")),"colorFormat"in li&&(Aa=li.colorFormat,_r.indexOf(Aa)>=0?Po=!0:Tr.indexOf(Aa)>=0?Po=!1:b.optional(function(){Po?b.oneOf(li.colorFormat,_r,"invalid color format for texture"):b.oneOf(li.colorFormat,Tr,"invalid color format for renderbuffer")}))),("depthTexture"in li||"depthStencilTexture"in li)&&(Ua=!!(li.depthTexture||li.depthStencilTexture),b(!Ua||ie.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in li&&(typeof li.depth=="boolean"?Da=li.depth:(wo=li.depth,Va=!1)),"stencil"in li&&(typeof li.stencil=="boolean"?Va=li.stencil:(po=li.stencil,Da=!1)),"depthStencil"in li&&(typeof li.depthStencil=="boolean"?Da=Va=li.depthStencil:(Vo=li.depthStencil,Da=!1,Va=!1))}var Vi=null,Mo=null,Zn=null,Ti=null;if(Array.isArray(Si))Vi=Si.map(Mr);else if(Si)Vi=[Mr(Si)];else for(Vi=new Array(Xa),Gn=0;Gn<Xa;++Gn)Vi[Gn]=ht(ii,Ii,Po,Aa,bo);b(ie.webgl_draw_buffers||Vi.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),b(Vi.length<=Oe.maxColorAttachments,"too many color attachments, not supported"),ii=ii||Vi[0].width,Ii=Ii||Vi[0].height,wo?Mo=Mr(wo):Da&&!Va&&(Mo=ht(ii,Ii,Ua,"depth","uint32")),po?Zn=Mr(po):Va&&!Da&&(Zn=ht(ii,Ii,!1,"stencil","uint8")),Vo?Ti=Mr(Vo):!wo&&!po&&Va&&Da&&(Ti=ht(ii,Ii,Ua,"depth stencil","depth stencil")),b(!!wo+!!po+!!Vo<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Yi=null;for(Gn=0;Gn<Vi.length;++Gn)if(Kr(Vi[Gn],ii,Ii),b(!Vi[Gn]||Vi[Gn].texture&&Ol.indexOf(Vi[Gn].texture._texture.format)>=0||Vi[Gn].renderbuffer&&ee.indexOf(Vi[Gn].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Gn+" is invalid"),Vi[Gn]&&Vi[Gn].texture){var Ya=Mu[Vi[Gn].texture._texture.format]*n[Vi[Gn].texture._texture.type];Yi===null?Yi=Ya:b(Yi===Ya,"all color attachments much have the same number of bits per pixel.")}return Kr(Mo,ii,Ii),b(!Mo||Mo.texture&&Mo.texture._texture.format===qu||Mo.renderbuffer&&Mo.renderbuffer._renderbuffer.format===f,"invalid depth attachment for framebuffer object"),Kr(Zn,ii,Ii),b(!Zn||Zn.renderbuffer&&Zn.renderbuffer._renderbuffer.format===d,"invalid stencil attachment for framebuffer object"),Kr(Ti,ii,Ii),b(!Ti||Ti.texture&&Ti.texture._texture.format===v||Ti.renderbuffer&&Ti.renderbuffer._renderbuffer.format===v,"invalid depth-stencil attachment for framebuffer object"),nn(an),an.width=ii,an.height=Ii,an.colorAttachments=Vi,an.depthAttachment=Mo,an.stencilAttachment=Zn,an.depthStencilAttachment=Ti,ui.color=Vi.map(Yt),ui.depth=Yt(Mo),ui.stencil=Yt(Zn),ui.depthStencil=Yt(Ti),ui.width=an.width,ui.height=an.height,ar(an),ui}function Yn(en,ln){b(ir.next!==an,"can not resize a framebuffer which is currently in use");var Gn=Math.max(en|0,1),ii=Math.max(ln|0||Gn,1);if(Gn===an.width&&ii===an.height)return ui;for(var Ii=an.colorAttachments,Da=0;Da<Ii.length;++Da)kr(Ii[Da],Gn,ii);return kr(an.depthAttachment,Gn,ii),kr(an.stencilAttachment,Gn,ii),kr(an.depthStencilAttachment,Gn,ii),an.width=ui.width=Gn,an.height=ui.height=ii,ar(an),ui}return ui(Pr,rn),l(ui,{resize:Yn,_reglType:"framebuffer",_framebuffer:an,destroy:function(){Ln(an),nn(an)},use:function(en){ir.setFBO({framebuffer:ui},en)}})}function wn(Pr){var rn=Array(6);function an(Yn){var en;b(rn.indexOf(ir.next)<0,"can not update framebuffer which is currently in use");var ln={color:null},Gn=0,ii=null,Ii="rgba",Da="uint8",Va=1;if(typeof Yn=="number")Gn=Yn|0;else if(!Yn)Gn=1;else{b.type(Yn,"object","invalid arguments for framebuffer");var Si=Yn;if("shape"in Si){var Po=Si.shape;b(Array.isArray(Po)&&Po.length>=2,"invalid shape for framebuffer"),b(Po[0]===Po[1],"cube framebuffer must be square"),Gn=Po[0]}else"radius"in Si&&(Gn=Si.radius|0),"width"in Si?(Gn=Si.width|0,"height"in Si&&b(Si.height===Gn,"must be square")):"height"in Si&&(Gn=Si.height|0);("color"in Si||"colors"in Si)&&(ii=Si.color||Si.colors,Array.isArray(ii)&&b(ii.length===1||ie.webgl_draw_buffers,"multiple render targets not supported")),ii||("colorCount"in Si&&(Va=Si.colorCount|0,b(Va>0,"invalid color buffer count")),"colorType"in Si&&(b.oneOf(Si.colorType,Ir,"invalid color type"),Da=Si.colorType),"colorFormat"in Si&&(Ii=Si.colorFormat,b.oneOf(Si.colorFormat,_r,"invalid color format for texture"))),"depth"in Si&&(ln.depth=Si.depth),"stencil"in Si&&(ln.stencil=Si.stencil),"depthStencil"in Si&&(ln.depthStencil=Si.depthStencil)}var Aa;if(ii)if(Array.isArray(ii))for(Aa=[],en=0;en<ii.length;++en)Aa[en]=ii[en];else Aa=[ii];else{Aa=Array(Va);var bo={radius:Gn,format:Ii,type:Da};for(en=0;en<Va;++en)Aa[en]=Ut.createCube(bo)}for(ln.color=Array(Aa.length),en=0;en<Aa.length;++en){var Xa=Aa[en];b(typeof Xa=="function"&&Xa._reglType==="textureCube","invalid cube map"),Gn=Gn||Xa.width,b(Xa.width===Gn&&Xa.height===Gn,"invalid cube map shape"),ln.color[en]={target:ri,data:Aa[en]}}for(en=0;en<6;++en){for(var wo=0;wo<Aa.length;++wo)ln.color[wo].target=ri+en;en>0&&(ln.depth=rn[0].depth,ln.stencil=rn[0].stencil,ln.depthStencil=rn[0].depthStencil),rn[en]?rn[en](ln):rn[en]=lr(ln)}return l(an,{width:Gn,height:Gn,color:Aa})}function ui(Yn){var en,ln=Yn|0;if(b(ln>0&&ln<=Oe.maxCubeMapSize,"invalid radius for cube fbo"),ln===an.width)return an;var Gn=an.color;for(en=0;en<Gn.length;++en)Gn[en].resize(ln);for(en=0;en<6;++en)rn[en].resize(ln);return an.width=an.height=ln,an}return an(Pr),l(an,{faces:rn,resize:ui,_reglType:"framebufferCube",destroy:function(){rn.forEach(function(Yn){Yn.destroy()})}})}function Qr(){ir.cur=null,ir.next=null,ir.dirty=!0,W(yr).forEach(function(Pr){Pr.framebuffer=T.createFramebuffer(),ar(Pr)})}return l(ir,{getFramebuffer:function(Pr){if(typeof Pr=="function"&&Pr._reglType==="framebuffer"){var rn=Pr._framebuffer;if(rn instanceof zr)return rn}return null},create:lr,createCube:wn,clear:function(){W(yr).forEach(Ln)},restore:Qr})}var Ce=5126,qe=34962,_e=34963,Ge=["attributes","elements","offset","count","primitive","instances"];function et(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Ce,this.offset=0,this.stride=0,this.divisor=0}function St(T,ie,Oe,Ut,pr,Bt,ir){for(var _r=Oe.maxAttributes,Tr=new Array(_r),Ir=0;Ir<_r;++Ir)Tr[Ir]=new et;var Lr=0,Or={},Kr={Record:et,scope:{},state:Tr,currentVAO:null,targetVAO:null,restore:Mr()?nn:function(){},createVAO:Ln,getVAO:Yt,destroyBuffer:Cr,setVAO:Mr()?kr:Hr,clear:Mr()?yr:function(){}};function Cr(ar){for(var lr=0;lr<Tr.length;++lr){var wn=Tr[lr];wn.buffer===ar&&(T.disableVertexAttribArray(lr),wn.buffer=null)}}function Mr(){return ie.oes_vertex_array_object}function ht(){return ie.angle_instanced_arrays}function Yt(ar){return typeof ar=="function"&&ar._vao?ar._vao:null}function kr(ar){if(ar!==Kr.currentVAO){var lr=Mr();ar?lr.bindVertexArrayOES(ar.vao):lr.bindVertexArrayOES(null),Kr.currentVAO=ar}}function Hr(ar){if(ar!==Kr.currentVAO){if(ar)ar.bindAttrs();else{for(var lr=ht(),wn=0;wn<Tr.length;++wn){var Qr=Tr[wn];Qr.buffer?(T.enableVertexAttribArray(wn),Qr.buffer.bind(),T.vertexAttribPointer(wn,Qr.size,Qr.type,Qr.normalized,Qr.stride,Qr.offfset),lr&&Qr.divisor&&lr.vertexAttribDivisorANGLE(wn,Qr.divisor)):(T.disableVertexAttribArray(wn),T.vertexAttrib4f(wn,Qr.x,Qr.y,Qr.z,Qr.w))}ir.elements?T.bindBuffer(_e,ir.elements.buffer.buffer):T.bindBuffer(_e,null)}Kr.currentVAO=ar}}function yr(){W(Or).forEach(function(ar){ar.destroy()})}function zr(){this.id=++Lr,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var ar=Mr();ar?this.vao=ar.createVertexArrayOES():this.vao=null,Or[this.id]=this,this.buffers=[]}zr.prototype.bindAttrs=function(){for(var ar=ht(),lr=this.attributes,wn=0;wn<lr.length;++wn){var Qr=lr[wn];Qr.buffer?(T.enableVertexAttribArray(wn),T.bindBuffer(qe,Qr.buffer.buffer),T.vertexAttribPointer(wn,Qr.size,Qr.type,Qr.normalized,Qr.stride,Qr.offset),ar&&Qr.divisor&&ar.vertexAttribDivisorANGLE(wn,Qr.divisor)):(T.disableVertexAttribArray(wn),T.vertexAttrib4f(wn,Qr.x,Qr.y,Qr.z,Qr.w))}for(var Pr=lr.length;Pr<_r;++Pr)T.disableVertexAttribArray(Pr);var rn=Bt.getElements(this.elements);rn?T.bindBuffer(_e,rn.buffer.buffer):T.bindBuffer(_e,null)},zr.prototype.refresh=function(){var ar=Mr();ar&&(ar.bindVertexArrayOES(this.vao),this.bindAttrs(),Kr.currentVAO=null,ar.bindVertexArrayOES(null))},zr.prototype.destroy=function(){if(this.vao){var ar=Mr();this===Kr.currentVAO&&(Kr.currentVAO=null,ar.bindVertexArrayOES(null)),ar.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),Or[this.id]&&(delete Or[this.id],Ut.vaoCount-=1)};function nn(){var ar=Mr();ar&&W(Or).forEach(function(lr){lr.refresh()})}function Ln(ar){var lr=new zr;Ut.vaoCount+=1;function wn(Qr){var Pr;if(Array.isArray(Qr))Pr=Qr,lr.elements&&lr.ownsElements&&lr.elements.destroy(),lr.elements=null,lr.ownsElements=!1,lr.offset=0,lr.count=0,lr.instances=-1,lr.primitive=4;else{if(b(typeof Qr=="object","invalid arguments for create vao"),b("attributes"in Qr,"must specify attributes for vao"),Qr.elements){var rn=Qr.elements;lr.ownsElements?typeof rn=="function"&&rn._reglType==="elements"?(lr.elements.destroy(),lr.ownsElements=!1):(lr.elements(rn),lr.ownsElements=!1):Bt.getElements(Qr.elements)?(lr.elements=Qr.elements,lr.ownsElements=!1):(lr.elements=Bt.create(Qr.elements),lr.ownsElements=!0)}else lr.elements=null,lr.ownsElements=!1;Pr=Qr.attributes,lr.offset=0,lr.count=-1,lr.instances=-1,lr.primitive=4,lr.elements&&(lr.count=lr.elements._elements.vertCount,lr.primitive=lr.elements._elements.primType),"offset"in Qr&&(lr.offset=Qr.offset|0),"count"in Qr&&(lr.count=Qr.count|0),"instances"in Qr&&(lr.instances=Qr.instances|0),"primitive"in Qr&&(b(Qr.primitive in hr,"bad primitive type: "+Qr.primitive),lr.primitive=hr[Qr.primitive]),b.optional(function(){for(var Da=Object.keys(Qr),Va=0;Va<Da.length;++Va)b(Ge.indexOf(Da[Va])>=0,'invalid option for vao: "'+Da[Va]+'" valid options are '+Ge)}),b(Array.isArray(Pr),"attributes must be an array")}b(Pr.length<_r,"too many attributes"),b(Pr.length>0,"must specify at least one attribute");var an={},ui=lr.attributes;ui.length=Pr.length;for(var Yn=0;Yn<Pr.length;++Yn){var en=Pr[Yn],ln=ui[Yn]=new et,Gn=en.data||en;if(Array.isArray(Gn)||Ze(Gn)||_o(Gn)){var ii;lr.buffers[Yn]&&(ii=lr.buffers[Yn],Ze(Gn)&&ii._buffer.byteLength>=Gn.byteLength?ii.subdata(Gn):(ii.destroy(),lr.buffers[Yn]=null)),lr.buffers[Yn]||(ii=lr.buffers[Yn]=pr.create(en,qe,!1,!0)),ln.buffer=pr.getBuffer(ii),ln.size=ln.buffer.dimension|0,ln.normalized=!1,ln.type=ln.buffer.dtype,ln.offset=0,ln.stride=0,ln.divisor=0,ln.state=1,an[Yn]=1}else pr.getBuffer(en)?(ln.buffer=pr.getBuffer(en),ln.size=ln.buffer.dimension|0,ln.normalized=!1,ln.type=ln.buffer.dtype,ln.offset=0,ln.stride=0,ln.divisor=0,ln.state=1):pr.getBuffer(en.buffer)?(ln.buffer=pr.getBuffer(en.buffer),ln.size=(+en.size||ln.buffer.dimension)|0,ln.normalized=!!en.normalized||!1,"type"in en?(b.parameter(en.type,is,"invalid buffer type"),ln.type=is[en.type]):ln.type=ln.buffer.dtype,ln.offset=(en.offset||0)|0,ln.stride=(en.stride||0)|0,ln.divisor=(en.divisor||0)|0,ln.state=1,b(ln.size>=1&&ln.size<=4,"size must be between 1 and 4"),b(ln.offset>=0,"invalid offset"),b(ln.stride>=0&&ln.stride<=255,"stride must be between 0 and 255"),b(ln.divisor>=0,"divisor must be positive"),b(!ln.divisor||!!ie.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in en?(b(Yn>0,"first attribute must not be a constant"),ln.x=+en.x||0,ln.y=+en.y||0,ln.z=+en.z||0,ln.w=+en.w||0,ln.state=2):b(!1,"invalid attribute spec for location "+Yn)}for(var Ii=0;Ii<lr.buffers.length;++Ii)!an[Ii]&&lr.buffers[Ii]&&(lr.buffers[Ii].destroy(),lr.buffers[Ii]=null);return lr.refresh(),wn}return wn.destroy=function(){for(var Qr=0;Qr<lr.buffers.length;++Qr)lr.buffers[Qr]&&lr.buffers[Qr].destroy();lr.buffers.length=0,lr.ownsElements&&(lr.elements.destroy(),lr.elements=null,lr.ownsElements=!1),lr.destroy()},wn._vao=lr,wn._reglType="vao",wn(ar)}return Kr}var $t=35632,Zt=35633,rr=35718,Sr=35721;function Ur(T,ie,Oe,Ut){var pr={},Bt={};function ir(ht,Yt,kr,Hr){this.name=ht,this.id=Yt,this.location=kr,this.info=Hr}function _r(ht,Yt){for(var kr=0;kr<ht.length;++kr)if(ht[kr].id===Yt.id){ht[kr].location=Yt.location;return}ht.push(Yt)}function Tr(ht,Yt,kr){var Hr=ht===$t?pr:Bt,yr=Hr[Yt];if(!yr){var zr=ie.str(Yt);yr=T.createShader(ht),T.shaderSource(yr,zr),T.compileShader(yr),b.shaderError(T,yr,zr,ht,kr),Hr[Yt]=yr}return yr}var Ir={},Lr=[],Or=0;function Kr(ht,Yt){this.id=Or++,this.fragId=ht,this.vertId=Yt,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Ut.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Cr(ht,Yt,kr){var Hr,yr,zr=Tr($t,ht.fragId),nn=Tr(Zt,ht.vertId),Ln=ht.program=T.createProgram();if(T.attachShader(Ln,zr),T.attachShader(Ln,nn),kr)for(Hr=0;Hr<kr.length;++Hr){var ar=kr[Hr];T.bindAttribLocation(Ln,ar[0],ar[1])}T.linkProgram(Ln),b.linkError(T,Ln,ie.str(ht.fragId),ie.str(ht.vertId),Yt);var lr=T.getProgramParameter(Ln,rr);Ut.profile&&(ht.stats.uniformsCount=lr);var wn=ht.uniforms;for(Hr=0;Hr<lr;++Hr)if(yr=T.getActiveUniform(Ln,Hr),yr)if(yr.size>1)for(var Qr=0;Qr<yr.size;++Qr){var Pr=yr.name.replace("[0]","["+Qr+"]");_r(wn,new ir(Pr,ie.id(Pr),T.getUniformLocation(Ln,Pr),yr))}else _r(wn,new ir(yr.name,ie.id(yr.name),T.getUniformLocation(Ln,yr.name),yr));var rn=T.getProgramParameter(Ln,Sr);Ut.profile&&(ht.stats.attributesCount=rn);var an=ht.attributes;for(Hr=0;Hr<rn;++Hr)yr=T.getActiveAttrib(Ln,Hr),yr&&_r(an,new ir(yr.name,ie.id(yr.name),T.getAttribLocation(Ln,yr.name),yr))}Ut.profile&&(Oe.getMaxUniformsCount=function(){var ht=0;return Lr.forEach(function(Yt){Yt.stats.uniformsCount>ht&&(ht=Yt.stats.uniformsCount)}),ht},Oe.getMaxAttributesCount=function(){var ht=0;return Lr.forEach(function(Yt){Yt.stats.attributesCount>ht&&(ht=Yt.stats.attributesCount)}),ht});function Mr(){pr={},Bt={};for(var ht=0;ht<Lr.length;++ht)Cr(Lr[ht],null,Lr[ht].attributes.map(function(Yt){return[Yt.location,Yt.name]}))}return{clear:function(){var ht=T.deleteShader.bind(T);W(pr).forEach(ht),pr={},W(Bt).forEach(ht),Bt={},Lr.forEach(function(Yt){T.deleteProgram(Yt.program)}),Lr.length=0,Ir={},Oe.shaderCount=0},program:function(ht,Yt,kr,Hr){b.command(ht>=0,"missing vertex shader",kr),b.command(Yt>=0,"missing fragment shader",kr);var yr=Ir[Yt];yr||(yr=Ir[Yt]={});var zr=yr[ht];if(zr&&(zr.refCount++,!Hr))return zr;var nn=new Kr(Yt,ht);return Oe.shaderCount++,Cr(nn,kr,Hr),zr||(yr[ht]=nn),Lr.push(nn),l(nn,{destroy:function(){if(nn.refCount--,nn.refCount<=0){T.deleteProgram(nn.program);var Ln=Lr.indexOf(nn);Lr.splice(Ln,1),Oe.shaderCount--}yr[nn.vertId].refCount<=0&&(T.deleteShader(Bt[nn.vertId]),delete Bt[nn.vertId],delete Ir[nn.fragId][nn.vertId]),Object.keys(Ir[nn.fragId]).length||(T.deleteShader(pr[nn.fragId]),delete pr[nn.fragId],delete Ir[nn.fragId])}})},restore:Mr,shader:Tr,frag:-1,vert:-1}}var Br=6408,hn=5121,Pn=3333,Mn=5126;function Rn(T,ie,Oe,Ut,pr,Bt,ir){function _r(Lr){var Or;ie.next===null?(b(pr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Or=hn):(b(ie.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Or=ie.next.colorAttachments[0].texture._texture.type,b.optional(function(){Bt.oes_texture_float?(b(Or===hn||Or===Mn,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Or===Mn&&b(ir.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):b(Or===hn,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var Kr=0,Cr=0,Mr=Ut.framebufferWidth,ht=Ut.framebufferHeight,Yt=null;Ze(Lr)?Yt=Lr:Lr&&(b.type(Lr,"object","invalid arguments to regl.read()"),Kr=Lr.x|0,Cr=Lr.y|0,b(Kr>=0&&Kr<Ut.framebufferWidth,"invalid x offset for regl.read"),b(Cr>=0&&Cr<Ut.framebufferHeight,"invalid y offset for regl.read"),Mr=(Lr.width||Ut.framebufferWidth-Kr)|0,ht=(Lr.height||Ut.framebufferHeight-Cr)|0,Yt=Lr.data||null),Yt&&(Or===hn?b(Yt instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Or===Mn&&b(Yt instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),b(Mr>0&&Mr+Kr<=Ut.framebufferWidth,"invalid width for read pixels"),b(ht>0&&ht+Cr<=Ut.framebufferHeight,"invalid height for read pixels"),Oe();var kr=Mr*ht*4;return Yt||(Or===hn?Yt=new Uint8Array(kr):Or===Mn&&(Yt=Yt||new Float32Array(kr))),b.isTypedArray(Yt,"data buffer for regl.read() must be a typedarray"),b(Yt.byteLength>=kr,"data buffer for regl.read() too small"),T.pixelStorei(Pn,4),T.readPixels(Kr,Cr,Mr,ht,Br,Or,Yt),Yt}function Tr(Lr){var Or;return ie.setFBO({framebuffer:Lr.framebuffer},function(){Or=_r(Lr)}),Or}function Ir(Lr){return!Lr||!("framebuffer"in Lr)?_r(Lr):Tr(Lr)}return Ir}function Ei(T){return Array.prototype.slice.call(T)}function fn(T){return Ei(T).join("")}function Jn(){var T=0,ie=[],Oe=[];function Ut(Or){for(var Kr=0;Kr<Oe.length;++Kr)if(Oe[Kr]===Or)return ie[Kr];var Cr="g"+T++;return ie.push(Cr),Oe.push(Or),Cr}function pr(){var Or=[];function Kr(){Or.push.apply(Or,Ei(arguments))}var Cr=[];function Mr(){var ht="v"+T++;return Cr.push(ht),arguments.length>0&&(Or.push(ht,"="),Or.push.apply(Or,Ei(arguments)),Or.push(";")),ht}return l(Kr,{def:Mr,toString:function(){return fn([Cr.length>0?"var "+Cr.join(",")+";":"",fn(Or)])}})}function Bt(){var Or=pr(),Kr=pr(),Cr=Or.toString,Mr=Kr.toString;function ht(Yt,kr){Kr(Yt,kr,"=",Or.def(Yt,kr),";")}return l(function(){Or.apply(Or,Ei(arguments))},{def:Or.def,entry:Or,exit:Kr,save:ht,set:function(Yt,kr,Hr){ht(Yt,kr),Or(Yt,kr,"=",Hr,";")},toString:function(){return Cr()+Mr()}})}function ir(){var Or=fn(arguments),Kr=Bt(),Cr=Bt(),Mr=Kr.toString,ht=Cr.toString;return l(Kr,{then:function(){return Kr.apply(Kr,Ei(arguments)),this},else:function(){return Cr.apply(Cr,Ei(arguments)),this},toString:function(){var Yt=ht();return Yt&&(Yt="else{"+Yt+"}"),fn(["if(",Or,"){",Mr(),"}",Yt])}})}var _r=pr(),Tr={};function Ir(Or,Kr){var Cr=[];function Mr(){var yr="a"+Cr.length;return Cr.push(yr),yr}Kr=Kr||0;for(var ht=0;ht<Kr;++ht)Mr();var Yt=Bt(),kr=Yt.toString,Hr=Tr[Or]=l(Yt,{arg:Mr,toString:function(){return fn(["function(",Cr.join(),"){",kr(),"}"])}});return Hr}function Lr(){var Or=['"use strict";',_r,"return {"];Object.keys(Tr).forEach(function(ht){Or.push('"',ht,'":',Tr[ht].toString(),",")}),Or.push("}");var Kr=fn(Or).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Cr=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Mr=Cr?vt.Function.apply(null,ie.concat(Kr)):Function.apply(null,ie.concat(Kr));return Mr.apply(null,Oe)}return{global:_r,link:Ut,block:pr,proc:Ir,scope:Bt,cond:ir,compile:Lr}}var ni="xyzw".split(""),qn=5121,Bn=1,oi=2,Vn=0,Nn=1,Ha=2,Ca=3,co=4,ho=5,Ia=6,Na="dither",Qo="blend.enable",zo="blend.color",tu="blend.equation",Bo="blend.func",Is="depth.enable",ds="depth.func",dl="depth.range",Zu="depth.mask",ru="colorMask",Hu="cull.enable",ml="cull.face",ks="frontFace",Wu="lineWidth",Fs="polygonOffset.enable",Wa="polygonOffset.offset",nu="sample.alpha",yu="sample.enable",gu="sample.coverage",qi="stencil.enable",os="stencil.mask",No="stencil.func",_u="stencil.opFront",Fl="stencil.opBack",zl="scissor.enable",ec="scissor.box",ms="viewport",vl="profile",Ps="framebuffer",Lu="vert",Bl="frag",zs="elements",fo="primitive",Nl="count",vc="offset",Lc="instances",yc="vao",ah="Width",oh="Height",yl=Ps+ah,tc=Ps+oh,Dc=ms+ah,Ph=ms+oh,Xu="drawingBuffer",rc=Xu+ah,Mh=Xu+oh,sf=[Bo,tu,No,_u,Fl,gu,ms,ec,Wa],nc=34962,sh=34963,uf=35632,lf=35633,Lh=3553,uh=34067,cf=2884,ic=3042,hf=3024,ro=2960,Rc=2929,Dh=3089,Oc=32823,Fc=32926,gc=32928,zc=5126,_c=35664,gl=35665,ac=35666,xc=5124,Bc=35667,_l=35668,Nc=35669,bc=35670,Vc=35671,oc=35672,sc=35673,vs=35674,wc=35675,Ec=35676,Sc=35678,Tc=35680,Uc=4,Du=1028,Vl=1029,Rh=2304,Gc=2305,Oh=32775,ff=32776,pf=519,Bs=7680,Fh=0,jc=1,uc=32774,xu=513,zh=36160,df=36064,Ru={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},lc=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Ul={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},xl={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Bh={frag:uf,vert:lf},lh={cw:Rh,ccw:Gc};function qc(T){return Array.isArray(T)||Ze(T)||_o(T)}function ch(T){return T.sort(function(ie,Oe){return ie===ms?-1:Oe===ms?1:ie<Oe?-1:1})}function ra(T,ie,Oe,Ut){this.thisDep=T,this.contextDep=ie,this.propDep=Oe,this.append=Ut}function bl(T){return T&&!(T.thisDep||T.contextDep||T.propDep)}function no(T){return new ra(!1,!1,!1,T)}function ys(T,ie){var Oe=T.type;if(Oe===Vn){var Ut=T.data.length;return new ra(!0,Ut>=1,Ut>=2,ie)}else if(Oe===co){var pr=T.data;return new ra(pr.thisDep,pr.contextDep,pr.propDep,ie)}else{if(Oe===ho)return new ra(!1,!1,!1,ie);if(Oe===Ia){for(var Bt=!1,ir=!1,_r=!1,Tr=0;Tr<T.data.length;++Tr){var Ir=T.data[Tr];if(Ir.type===Nn)_r=!0;else if(Ir.type===Ha)ir=!0;else if(Ir.type===Ca)Bt=!0;else if(Ir.type===Vn){Bt=!0;var Lr=Ir.data;Lr>=1&&(ir=!0),Lr>=2&&(_r=!0)}else Ir.type===co&&(Bt=Bt||Ir.data.thisDep,ir=ir||Ir.data.contextDep,_r=_r||Ir.data.propDep)}return new ra(Bt,ir,_r,ie)}else return new ra(Oe===Ca,Oe===Ha,Oe===Nn,ie)}}var Nh=new ra(!1,!1,!1,function(){});function Vh(T,ie,Oe,Ut,pr,Bt,ir,_r,Tr,Ir,Lr,Or,Kr,Cr,Mr){var ht=Ir.Record,Yt={add:32774,subtract:32778,"reverse subtract":32779};Oe.ext_blend_minmax&&(Yt.min=Oh,Yt.max=ff);var kr=Oe.angle_instanced_arrays,Hr=Oe.webgl_draw_buffers,yr=Oe.oes_vertex_array_object,zr={dirty:!0,profile:Mr.profile},nn={},Ln=[],ar={},lr={};function wn(de){return de.replace(".","_")}function Qr(de,Y,Ue){var ft=wn(de);Ln.push(de),nn[ft]=zr[ft]=!!Ue,ar[ft]=Y}function Pr(de,Y,Ue){var ft=wn(de);Ln.push(de),Array.isArray(Ue)?(zr[ft]=Ue.slice(),nn[ft]=Ue.slice()):zr[ft]=nn[ft]=Ue,lr[ft]=Y}Qr(Na,hf),Qr(Qo,ic),Pr(zo,"blendColor",[0,0,0,0]),Pr(tu,"blendEquationSeparate",[uc,uc]),Pr(Bo,"blendFuncSeparate",[jc,Fh,jc,Fh]),Qr(Is,Rc,!0),Pr(ds,"depthFunc",xu),Pr(dl,"depthRange",[0,1]),Pr(Zu,"depthMask",!0),Pr(ru,ru,[!0,!0,!0,!0]),Qr(Hu,cf),Pr(ml,"cullFace",Vl),Pr(ks,ks,Gc),Pr(Wu,Wu,1),Qr(Fs,Oc),Pr(Wa,"polygonOffset",[0,0]),Qr(nu,Fc),Qr(yu,gc),Pr(gu,"sampleCoverage",[1,!1]),Qr(qi,ro),Pr(os,"stencilMask",-1),Pr(No,"stencilFunc",[pf,0,-1]),Pr(_u,"stencilOpSeparate",[Du,Bs,Bs,Bs]),Pr(Fl,"stencilOpSeparate",[Vl,Bs,Bs,Bs]),Qr(zl,Dh),Pr(ec,"scissor",[0,0,T.drawingBufferWidth,T.drawingBufferHeight]),Pr(ms,ms,[0,0,T.drawingBufferWidth,T.drawingBufferHeight]);var rn={gl:T,context:Kr,strings:ie,next:nn,current:zr,draw:Or,elements:Bt,buffer:pr,shader:Lr,attributes:Ir.state,vao:Ir,uniforms:Tr,framebuffer:_r,extensions:Oe,timer:Cr,isBufferArgs:qc},an={primTypes:hr,compareFuncs:Ul,blendFuncs:Ru,blendEquations:Yt,stencilOps:xl,glTypes:is,orientationType:lh};b.optional(function(){rn.isArrayLike=Ea}),Hr&&(an.backBuffer=[Vl],an.drawBuffer=Ne(Ut.maxDrawbuffers,function(de){return de===0?[0]:Ne(de,function(Y){return df+Y})}));var ui=0;function Yn(){var de=Jn(),Y=de.link,Ue=de.global;de.id=ui++,de.batchId="0";var ft=Y(rn),Ot=de.shared={props:"a0"};Object.keys(rn).forEach(function(Ve){Ot[Ve]=Ue.def(ft,".",Ve)}),b.optional(function(){de.CHECK=Y(b),de.commandStr=b.guessCommand(),de.command=Y(de.commandStr),de.assert=function(Ve,ye,pt){Ve("if(!(",ye,"))",this.CHECK,".commandRaise(",Y(pt),",",this.command,");")},an.invalidBlendCombinations=lc});var Ke=de.next={},Re=de.current={};Object.keys(lr).forEach(function(Ve){Array.isArray(zr[Ve])&&(Ke[Ve]=Ue.def(Ot.next,".",Ve),Re[Ve]=Ue.def(Ot.current,".",Ve))});var nt=de.constants={};Object.keys(an).forEach(function(Ve){nt[Ve]=Ue.def(JSON.stringify(an[Ve]))}),de.invoke=function(Ve,ye){switch(ye.type){case Vn:var pt=["this",Ot.context,Ot.props,de.batchId];return Ve.def(Y(ye.data),".call(",pt.slice(0,Math.max(ye.data.length+1,4)),")");case Nn:return Ve.def(Ot.props,ye.data);case Ha:return Ve.def(Ot.context,ye.data);case Ca:return Ve.def("this",ye.data);case co:return ye.data.append(de,Ve),ye.data.ref;case ho:return ye.data.toString();case Ia:return ye.data.map(function(Ct){return de.invoke(Ve,Ct)})}},de.attribCache={};var se={};return de.scopeAttrib=function(Ve){var ye=ie.id(Ve);if(ye in se)return se[ye];var pt=Ir.scope[ye];pt||(pt=Ir.scope[ye]=new ht);var Ct=se[ye]=Y(pt);return Ct},de}function en(de){var Y=de.static,Ue=de.dynamic,ft;if(vl in Y){var Ot=!!Y[vl];ft=no(function(Re,nt){return Ot}),ft.enable=Ot}else if(vl in Ue){var Ke=Ue[vl];ft=ys(Ke,function(Re,nt){return Re.invoke(nt,Ke)})}return ft}function ln(de,Y){var Ue=de.static,ft=de.dynamic;if(Ps in Ue){var Ot=Ue[Ps];return Ot?(Ot=_r.getFramebuffer(Ot),b.command(Ot,"invalid framebuffer object"),no(function(Re,nt){var se=Re.link(Ot),Ve=Re.shared;nt.set(Ve.framebuffer,".next",se);var ye=Ve.context;return nt.set(ye,"."+yl,se+".width"),nt.set(ye,"."+tc,se+".height"),se})):no(function(Re,nt){var se=Re.shared;nt.set(se.framebuffer,".next","null");var Ve=se.context;return nt.set(Ve,"."+yl,Ve+"."+rc),nt.set(Ve,"."+tc,Ve+"."+Mh),"null"})}else if(Ps in ft){var Ke=ft[Ps];return ys(Ke,function(Re,nt){var se=Re.invoke(nt,Ke),Ve=Re.shared,ye=Ve.framebuffer,pt=nt.def(ye,".getFramebuffer(",se,")");b.optional(function(){Re.assert(nt,"!"+se+"||"+pt,"invalid framebuffer object")}),nt.set(ye,".next",pt);var Ct=Ve.context;return nt.set(Ct,"."+yl,pt+"?"+pt+".width:"+Ct+"."+rc),nt.set(Ct,"."+tc,pt+"?"+pt+".height:"+Ct+"."+Mh),pt})}else return null}function Gn(de,Y,Ue){var ft=de.static,Ot=de.dynamic;function Ke(se){if(se in ft){var Ve=ft[se];b.commandType(Ve,"object","invalid "+se,Ue.commandStr);var ye=!0,pt=Ve.x|0,Ct=Ve.y|0,xr,Wr;return"width"in Ve?(xr=Ve.width|0,b.command(xr>=0,"invalid "+se,Ue.commandStr)):ye=!1,"height"in Ve?(Wr=Ve.height|0,b.command(Wr>=0,"invalid "+se,Ue.commandStr)):ye=!1,new ra(!ye&&Y&&Y.thisDep,!ye&&Y&&Y.contextDep,!ye&&Y&&Y.propDep,function(Vr,Sn){var pn=Vr.shared.context,En=xr;"width"in Ve||(En=Sn.def(pn,".",yl,"-",pt));var bn=Wr;return"height"in Ve||(bn=Sn.def(pn,".",tc,"-",Ct)),[pt,Ct,En,bn]})}else if(se in Ot){var Xr=Ot[se],un=ys(Xr,function(Vr,Sn){var pn=Vr.invoke(Sn,Xr);b.optional(function(){Vr.assert(Sn,pn+"&&typeof "+pn+'==="object"',"invalid "+se)});var En=Vr.shared.context,bn=Sn.def(pn,".x|0"),_n=Sn.def(pn,".y|0"),Un=Sn.def('"width" in ',pn,"?",pn,".width|0:","(",En,".",yl,"-",bn,")"),aa=Sn.def('"height" in ',pn,"?",pn,".height|0:","(",En,".",tc,"-",_n,")");return b.optional(function(){Vr.assert(Sn,Un+">=0&&"+aa+">=0","invalid "+se)}),[bn,_n,Un,aa]});return Y&&(un.thisDep=un.thisDep||Y.thisDep,un.contextDep=un.contextDep||Y.contextDep,un.propDep=un.propDep||Y.propDep),un}else return Y?new ra(Y.thisDep,Y.contextDep,Y.propDep,function(Vr,Sn){var pn=Vr.shared.context;return[0,0,Sn.def(pn,".",yl),Sn.def(pn,".",tc)]}):null}var Re=Ke(ms);if(Re){var nt=Re;Re=new ra(Re.thisDep,Re.contextDep,Re.propDep,function(se,Ve){var ye=nt.append(se,Ve),pt=se.shared.context;return Ve.set(pt,"."+Dc,ye[2]),Ve.set(pt,"."+Ph,ye[3]),ye})}return{viewport:Re,scissor_box:Ke(ec)}}function ii(de,Y){var Ue=de.static,ft=typeof Ue[Bl]=="string"&&typeof Ue[Lu]=="string";if(ft){if(Object.keys(Y.dynamic).length>0)return null;var Ot=Y.static,Ke=Object.keys(Ot);if(Ke.length>0&&typeof Ot[Ke[0]]=="number"){for(var Re=[],nt=0;nt<Ke.length;++nt)b(typeof Ot[Ke[nt]]=="number","must specify all vertex attribute locations when using vaos"),Re.push([Ot[Ke[nt]]|0,Ke[nt]]);return Re}}return null}function Ii(de,Y,Ue){var ft=de.static,Ot=de.dynamic;function Ke(ye){if(ye in ft){var pt=ie.id(ft[ye]);b.optional(function(){Lr.shader(Bh[ye],pt,b.guessCommand())});var Ct=no(function(){return pt});return Ct.id=pt,Ct}else if(ye in Ot){var xr=Ot[ye];return ys(xr,function(Wr,Xr){var un=Wr.invoke(Xr,xr),Vr=Xr.def(Wr.shared.strings,".id(",un,")");return b.optional(function(){Xr(Wr.shared.shader,".shader(",Bh[ye],",",Vr,",",Wr.command,");")}),Vr})}return null}var Re=Ke(Bl),nt=Ke(Lu),se=null,Ve;return bl(Re)&&bl(nt)?(se=Lr.program(nt.id,Re.id,null,Ue),Ve=no(function(ye,pt){return ye.link(se)})):Ve=new ra(Re&&Re.thisDep||nt&&nt.thisDep,Re&&Re.contextDep||nt&&nt.contextDep,Re&&Re.propDep||nt&&nt.propDep,function(ye,pt){var Ct=ye.shared.shader,xr;Re?xr=Re.append(ye,pt):xr=pt.def(Ct,".",Bl);var Wr;nt?Wr=nt.append(ye,pt):Wr=pt.def(Ct,".",Lu);var Xr=Ct+".program("+Wr+","+xr;return b.optional(function(){Xr+=","+ye.command}),pt.def(Xr+")")}),{frag:Re,vert:nt,progVar:Ve,program:se}}function Da(de,Y){var Ue=de.static,ft=de.dynamic,Ot={},Ke=!1;function Re(){if(yc in Ue){var Sn=Ue[yc];return Sn!==null&&Ir.getVAO(Sn)===null&&(Sn=Ir.createVAO(Sn)),Ke=!0,Ot.vao=Sn,no(function(En){var bn=Ir.getVAO(Sn);return bn?En.link(bn):"null"})}else if(yc in ft){Ke=!0;var pn=ft[yc];return ys(pn,function(En,bn){var _n=En.invoke(bn,pn);return bn.def(En.shared.vao+".getVAO("+_n+")")})}return null}var nt=Re(),se=!1;function Ve(){if(zs in Ue){var Sn=Ue[zs];if(Ot.elements=Sn,qc(Sn)){var pn=Ot.elements=Bt.create(Sn,!0);Sn=Bt.getElements(pn),se=!0}else Sn&&(Sn=Bt.getElements(Sn),se=!0,b.command(Sn,"invalid elements",Y.commandStr));var En=no(function(_n,Un){if(Sn){var aa=_n.link(Sn);return _n.ELEMENTS=aa,aa}return _n.ELEMENTS=null,null});return En.value=Sn,En}else if(zs in ft){se=!0;var bn=ft[zs];return ys(bn,function(_n,Un){var aa=_n.shared,Lo=aa.isBufferArgs,ma=aa.elements,Ki=_n.invoke(Un,bn),Fu=Un.def("null"),es=Un.def(Lo,"(",Ki,")"),bu=_n.cond(es).then(Fu,"=",ma,".createStream(",Ki,");").else(Fu,"=",ma,".getElements(",Ki,");");return b.optional(function(){_n.assert(bu.else,"!"+Ki+"||"+Fu,"invalid elements")}),Un.entry(bu),Un.exit(_n.cond(es).then(ma,".destroyStream(",Fu,");")),_n.ELEMENTS=Fu,Fu})}else if(Ke)return new ra(nt.thisDep,nt.contextDep,nt.propDep,function(_n,Un){return Un.def(_n.shared.vao+".currentVAO?"+_n.shared.elements+".getElements("+_n.shared.vao+".currentVAO.elements):null")});return null}var ye=Ve();function pt(){if(fo in Ue){var Sn=Ue[fo];return Ot.primitive=Sn,b.commandParameter(Sn,hr,"invalid primitve",Y.commandStr),no(function(En,bn){return hr[Sn]})}else if(fo in ft){var pn=ft[fo];return ys(pn,function(En,bn){var _n=En.constants.primTypes,Un=En.invoke(bn,pn);return b.optional(function(){En.assert(bn,Un+" in "+_n,"invalid primitive, must be one of "+Object.keys(hr))}),bn.def(_n,"[",Un,"]")})}else{if(se)return bl(ye)?ye.value?no(function(En,bn){return bn.def(En.ELEMENTS,".primType")}):no(function(){return Uc}):new ra(ye.thisDep,ye.contextDep,ye.propDep,function(En,bn){var _n=En.ELEMENTS;return bn.def(_n,"?",_n,".primType:",Uc)});if(Ke)return new ra(nt.thisDep,nt.contextDep,nt.propDep,function(En,bn){return bn.def(En.shared.vao+".currentVAO?"+En.shared.vao+".currentVAO.primitive:"+Uc)})}return null}function Ct(Sn,pn){if(Sn in Ue){var En=Ue[Sn]|0;return pn?Ot.offset=En:Ot.instances=En,b.command(!pn||En>=0,"invalid "+Sn,Y.commandStr),no(function(_n,Un){return pn&&(_n.OFFSET=En),En})}else if(Sn in ft){var bn=ft[Sn];return ys(bn,function(_n,Un){var aa=_n.invoke(Un,bn);return pn&&(_n.OFFSET=aa,b.optional(function(){_n.assert(Un,aa+">=0","invalid "+Sn)})),aa})}else if(pn){if(se)return no(function(_n,Un){return _n.OFFSET=0,0});if(Ke)return new ra(nt.thisDep,nt.contextDep,nt.propDep,function(_n,Un){return Un.def(_n.shared.vao+".currentVAO?"+_n.shared.vao+".currentVAO.offset:0")})}else if(Ke)return new ra(nt.thisDep,nt.contextDep,nt.propDep,function(_n,Un){return Un.def(_n.shared.vao+".currentVAO?"+_n.shared.vao+".currentVAO.instances:-1")});return null}var xr=Ct(vc,!0);function Wr(){if(Nl in Ue){var Sn=Ue[Nl]|0;return Ot.count=Sn,b.command(typeof Sn=="number"&&Sn>=0,"invalid vertex count",Y.commandStr),no(function(){return Sn})}else if(Nl in ft){var pn=ft[Nl];return ys(pn,function(Un,aa){var Lo=Un.invoke(aa,pn);return b.optional(function(){Un.assert(aa,"typeof "+Lo+'==="number"&&'+Lo+">=0&&"+Lo+"===("+Lo+"|0)","invalid vertex count")}),Lo})}else if(se)if(bl(ye)){if(ye)return xr?new ra(xr.thisDep,xr.contextDep,xr.propDep,function(Un,aa){var Lo=aa.def(Un.ELEMENTS,".vertCount-",Un.OFFSET);return b.optional(function(){Un.assert(aa,Lo+">=0","invalid vertex offset/element buffer too small")}),Lo}):no(function(Un,aa){return aa.def(Un.ELEMENTS,".vertCount")});var En=no(function(){return-1});return b.optional(function(){En.MISSING=!0}),En}else{var bn=new ra(ye.thisDep||xr.thisDep,ye.contextDep||xr.contextDep,ye.propDep||xr.propDep,function(Un,aa){var Lo=Un.ELEMENTS;return Un.OFFSET?aa.def(Lo,"?",Lo,".vertCount-",Un.OFFSET,":-1"):aa.def(Lo,"?",Lo,".vertCount:-1")});return b.optional(function(){bn.DYNAMIC=!0}),bn}else if(Ke){var _n=new ra(nt.thisDep,nt.contextDep,nt.propDep,function(Un,aa){return aa.def(Un.shared.vao,".currentVAO?",Un.shared.vao,".currentVAO.count:-1")});return _n}return null}var Xr=pt(),un=Wr(),Vr=Ct(Lc,!1);return{elements:ye,primitive:Xr,count:un,instances:Vr,offset:xr,vao:nt,vaoActive:Ke,elementsActive:se,static:Ot}}function Va(de,Y){var Ue=de.static,ft=de.dynamic,Ot={};return Ln.forEach(function(Ke){var Re=wn(Ke);function nt(se,Ve){if(Ke in Ue){var ye=se(Ue[Ke]);Ot[Re]=no(function(){return ye})}else if(Ke in ft){var pt=ft[Ke];Ot[Re]=ys(pt,function(Ct,xr){return Ve(Ct,xr,Ct.invoke(xr,pt))})}}switch(Ke){case Hu:case Qo:case Na:case qi:case Is:case zl:case Fs:case nu:case yu:case Zu:return nt(function(se){return b.commandType(se,"boolean",Ke,Y.commandStr),se},function(se,Ve,ye){return b.optional(function(){se.assert(Ve,"typeof "+ye+'==="boolean"',"invalid flag "+Ke,se.commandStr)}),ye});case ds:return nt(function(se){return b.commandParameter(se,Ul,"invalid "+Ke,Y.commandStr),Ul[se]},function(se,Ve,ye){var pt=se.constants.compareFuncs;return b.optional(function(){se.assert(Ve,ye+" in "+pt,"invalid "+Ke+", must be one of "+Object.keys(Ul))}),Ve.def(pt,"[",ye,"]")});case dl:return nt(function(se){return b.command(Ea(se)&&se.length===2&&typeof se[0]=="number"&&typeof se[1]=="number"&&se[0]<=se[1],"depth range is 2d array",Y.commandStr),se},function(se,Ve,ye){b.optional(function(){se.assert(Ve,se.shared.isArrayLike+"("+ye+")&&"+ye+".length===2&&typeof "+ye+'[0]==="number"&&typeof '+ye+'[1]==="number"&&'+ye+"[0]<="+ye+"[1]","depth range must be a 2d array")});var pt=Ve.def("+",ye,"[0]"),Ct=Ve.def("+",ye,"[1]");return[pt,Ct]});case Bo:return nt(function(se){b.commandType(se,"object","blend.func",Y.commandStr);var Ve="srcRGB"in se?se.srcRGB:se.src,ye="srcAlpha"in se?se.srcAlpha:se.src,pt="dstRGB"in se?se.dstRGB:se.dst,Ct="dstAlpha"in se?se.dstAlpha:se.dst;return b.commandParameter(Ve,Ru,Re+".srcRGB",Y.commandStr),b.commandParameter(ye,Ru,Re+".srcAlpha",Y.commandStr),b.commandParameter(pt,Ru,Re+".dstRGB",Y.commandStr),b.commandParameter(Ct,Ru,Re+".dstAlpha",Y.commandStr),b.command(lc.indexOf(Ve+", "+pt)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+Ve+", "+pt+")",Y.commandStr),[Ru[Ve],Ru[pt],Ru[ye],Ru[Ct]]},function(se,Ve,ye){var pt=se.constants.blendFuncs;b.optional(function(){se.assert(Ve,ye+"&&typeof "+ye+'==="object"',"invalid blend func, must be an object")});function Ct(pn,En){var bn=Ve.def('"',pn,En,'" in ',ye,"?",ye,".",pn,En,":",ye,".",pn);return b.optional(function(){se.assert(Ve,bn+" in "+pt,"invalid "+Ke+"."+pn+En+", must be one of "+Object.keys(Ru))}),bn}var xr=Ct("src","RGB"),Wr=Ct("dst","RGB");b.optional(function(){var pn=se.constants.invalidBlendCombinations;se.assert(Ve,pn+".indexOf("+xr+'+", "+'+Wr+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var Xr=Ve.def(pt,"[",xr,"]"),un=Ve.def(pt,"[",Ct("src","Alpha"),"]"),Vr=Ve.def(pt,"[",Wr,"]"),Sn=Ve.def(pt,"[",Ct("dst","Alpha"),"]");return[Xr,Vr,un,Sn]});case tu:return nt(function(se){if(typeof se=="string")return b.commandParameter(se,Yt,"invalid "+Ke,Y.commandStr),[Yt[se],Yt[se]];if(typeof se=="object")return b.commandParameter(se.rgb,Yt,Ke+".rgb",Y.commandStr),b.commandParameter(se.alpha,Yt,Ke+".alpha",Y.commandStr),[Yt[se.rgb],Yt[se.alpha]];b.commandRaise("invalid blend.equation",Y.commandStr)},function(se,Ve,ye){var pt=se.constants.blendEquations,Ct=Ve.def(),xr=Ve.def(),Wr=se.cond("typeof ",ye,'==="string"');return b.optional(function(){function Xr(un,Vr,Sn){se.assert(un,Sn+" in "+pt,"invalid "+Vr+", must be one of "+Object.keys(Yt))}Xr(Wr.then,Ke,ye),se.assert(Wr.else,ye+"&&typeof "+ye+'==="object"',"invalid "+Ke),Xr(Wr.else,Ke+".rgb",ye+".rgb"),Xr(Wr.else,Ke+".alpha",ye+".alpha")}),Wr.then(Ct,"=",xr,"=",pt,"[",ye,"];"),Wr.else(Ct,"=",pt,"[",ye,".rgb];",xr,"=",pt,"[",ye,".alpha];"),Ve(Wr),[Ct,xr]});case zo:return nt(function(se){return b.command(Ea(se)&&se.length===4,"blend.color must be a 4d array",Y.commandStr),Ne(4,function(Ve){return+se[Ve]})},function(se,Ve,ye){return b.optional(function(){se.assert(Ve,se.shared.isArrayLike+"("+ye+")&&"+ye+".length===4","blend.color must be a 4d array")}),Ne(4,function(pt){return Ve.def("+",ye,"[",pt,"]")})});case os:return nt(function(se){return b.commandType(se,"number",Re,Y.commandStr),se|0},function(se,Ve,ye){return b.optional(function(){se.assert(Ve,"typeof "+ye+'==="number"',"invalid stencil.mask")}),Ve.def(ye,"|0")});case No:return nt(function(se){b.commandType(se,"object",Re,Y.commandStr);var Ve=se.cmp||"keep",ye=se.ref||0,pt="mask"in se?se.mask:-1;return b.commandParameter(Ve,Ul,Ke+".cmp",Y.commandStr),b.commandType(ye,"number",Ke+".ref",Y.commandStr),b.commandType(pt,"number",Ke+".mask",Y.commandStr),[Ul[Ve],ye,pt]},function(se,Ve,ye){var pt=se.constants.compareFuncs;b.optional(function(){function Xr(){se.assert(Ve,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Xr(ye+"&&typeof ",ye,'==="object"'),Xr('!("cmp" in ',ye,")||(",ye,".cmp in ",pt,")")});var Ct=Ve.def('"cmp" in ',ye,"?",pt,"[",ye,".cmp]",":",Bs),xr=Ve.def(ye,".ref|0"),Wr=Ve.def('"mask" in ',ye,"?",ye,".mask|0:-1");return[Ct,xr,Wr]});case _u:case Fl:return nt(function(se){b.commandType(se,"object",Re,Y.commandStr);var Ve=se.fail||"keep",ye=se.zfail||"keep",pt=se.zpass||"keep";return b.commandParameter(Ve,xl,Ke+".fail",Y.commandStr),b.commandParameter(ye,xl,Ke+".zfail",Y.commandStr),b.commandParameter(pt,xl,Ke+".zpass",Y.commandStr),[Ke===Fl?Vl:Du,xl[Ve],xl[ye],xl[pt]]},function(se,Ve,ye){var pt=se.constants.stencilOps;b.optional(function(){se.assert(Ve,ye+"&&typeof "+ye+'==="object"',"invalid "+Ke)});function Ct(xr){return b.optional(function(){se.assert(Ve,'!("'+xr+'" in '+ye+")||("+ye+"."+xr+" in "+pt+")","invalid "+Ke+"."+xr+", must be one of "+Object.keys(xl))}),Ve.def('"',xr,'" in ',ye,"?",pt,"[",ye,".",xr,"]:",Bs)}return[Ke===Fl?Vl:Du,Ct("fail"),Ct("zfail"),Ct("zpass")]});case Wa:return nt(function(se){b.commandType(se,"object",Re,Y.commandStr);var Ve=se.factor|0,ye=se.units|0;return b.commandType(Ve,"number",Re+".factor",Y.commandStr),b.commandType(ye,"number",Re+".units",Y.commandStr),[Ve,ye]},function(se,Ve,ye){b.optional(function(){se.assert(Ve,ye+"&&typeof "+ye+'==="object"',"invalid "+Ke)});var pt=Ve.def(ye,".factor|0"),Ct=Ve.def(ye,".units|0");return[pt,Ct]});case ml:return nt(function(se){var Ve=0;return se==="front"?Ve=Du:se==="back"&&(Ve=Vl),b.command(!!Ve,Re,Y.commandStr),Ve},function(se,Ve,ye){return b.optional(function(){se.assert(Ve,ye+'==="front"||'+ye+'==="back"',"invalid cull.face")}),Ve.def(ye,'==="front"?',Du,":",Vl)});case Wu:return nt(function(se){return b.command(typeof se=="number"&&se>=Ut.lineWidthDims[0]&&se<=Ut.lineWidthDims[1],"invalid line width, must be a positive number between "+Ut.lineWidthDims[0]+" and "+Ut.lineWidthDims[1],Y.commandStr),se},function(se,Ve,ye){return b.optional(function(){se.assert(Ve,"typeof "+ye+'==="number"&&'+ye+">="+Ut.lineWidthDims[0]+"&&"+ye+"<="+Ut.lineWidthDims[1],"invalid line width")}),ye});case ks:return nt(function(se){return b.commandParameter(se,lh,Re,Y.commandStr),lh[se]},function(se,Ve,ye){return b.optional(function(){se.assert(Ve,ye+'==="cw"||'+ye+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),Ve.def(ye+'==="cw"?'+Rh+":"+Gc)});case ru:return nt(function(se){return b.command(Ea(se)&&se.length===4,"color.mask must be length 4 array",Y.commandStr),se.map(function(Ve){return!!Ve})},function(se,Ve,ye){return b.optional(function(){se.assert(Ve,se.shared.isArrayLike+"("+ye+")&&"+ye+".length===4","invalid color.mask")}),Ne(4,function(pt){return"!!"+ye+"["+pt+"]"})});case gu:return nt(function(se){b.command(typeof se=="object"&&se,Re,Y.commandStr);var Ve="value"in se?se.value:1,ye=!!se.invert;return b.command(typeof Ve=="number"&&Ve>=0&&Ve<=1,"sample.coverage.value must be a number between 0 and 1",Y.commandStr),[Ve,ye]},function(se,Ve,ye){b.optional(function(){se.assert(Ve,ye+"&&typeof "+ye+'==="object"',"invalid sample.coverage")});var pt=Ve.def('"value" in ',ye,"?+",ye,".value:1"),Ct=Ve.def("!!",ye,".invert");return[pt,Ct]})}}),Ot}function Si(de,Y){var Ue=de.static,ft=de.dynamic,Ot={};return Object.keys(Ue).forEach(function(Ke){var Re=Ue[Ke],nt;if(typeof Re=="number"||typeof Re=="boolean")nt=no(function(){return Re});else if(typeof Re=="function"){var se=Re._reglType;se==="texture2d"||se==="textureCube"?nt=no(function(Ve){return Ve.link(Re)}):se==="framebuffer"||se==="framebufferCube"?(b.command(Re.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Ke+'"',Y.commandStr),nt=no(function(Ve){return Ve.link(Re.color[0])})):b.commandRaise('invalid data for uniform "'+Ke+'"',Y.commandStr)}else Ea(Re)?nt=no(function(Ve){var ye=Ve.global.def("[",Ne(Re.length,function(pt){return b.command(typeof Re[pt]=="number"||typeof Re[pt]=="boolean","invalid uniform "+Ke,Ve.commandStr),Re[pt]}),"]");return ye}):b.commandRaise('invalid or missing data for uniform "'+Ke+'"',Y.commandStr);nt.value=Re,Ot[Ke]=nt}),Object.keys(ft).forEach(function(Ke){var Re=ft[Ke];Ot[Ke]=ys(Re,function(nt,se){return nt.invoke(se,Re)})}),Ot}function Po(de,Y){var Ue=de.static,ft=de.dynamic,Ot={};return Object.keys(Ue).forEach(function(Ke){var Re=Ue[Ke],nt=ie.id(Ke),se=new ht;if(qc(Re))se.state=Bn,se.buffer=pr.getBuffer(pr.create(Re,nc,!1,!0)),se.type=0;else{var Ve=pr.getBuffer(Re);if(Ve)se.state=Bn,se.buffer=Ve,se.type=0;else if(b.command(typeof Re=="object"&&Re,"invalid data for attribute "+Ke,Y.commandStr),"constant"in Re){var ye=Re.constant;se.buffer="null",se.state=oi,typeof ye=="number"?se.x=ye:(b.command(Ea(ye)&&ye.length>0&&ye.length<=4,"invalid constant for attribute "+Ke,Y.commandStr),ni.forEach(function(Vr,Sn){Sn<ye.length&&(se[Vr]=ye[Sn])}))}else{qc(Re.buffer)?Ve=pr.getBuffer(pr.create(Re.buffer,nc,!1,!0)):Ve=pr.getBuffer(Re.buffer),b.command(!!Ve,'missing buffer for attribute "'+Ke+'"',Y.commandStr);var pt=Re.offset|0;b.command(pt>=0,'invalid offset for attribute "'+Ke+'"',Y.commandStr);var Ct=Re.stride|0;b.command(Ct>=0&&Ct<256,'invalid stride for attribute "'+Ke+'", must be integer betweeen [0, 255]',Y.commandStr);var xr=Re.size|0;b.command(!("size"in Re)||xr>0&&xr<=4,'invalid size for attribute "'+Ke+'", must be 1,2,3,4',Y.commandStr);var Wr=!!Re.normalized,Xr=0;"type"in Re&&(b.commandParameter(Re.type,is,"invalid type for attribute "+Ke,Y.commandStr),Xr=is[Re.type]);var un=Re.divisor|0;b.optional(function(){"divisor"in Re&&(b.command(un===0||kr,'cannot specify divisor for attribute "'+Ke+'", instancing not supported',Y.commandStr),b.command(un>=0,'invalid divisor for attribute "'+Ke+'"',Y.commandStr));var Vr=Y.commandStr,Sn=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Re).forEach(function(pn){b.command(Sn.indexOf(pn)>=0,'unknown parameter "'+pn+'" for attribute pointer "'+Ke+'" (valid parameters are '+Sn+")",Vr)})}),se.buffer=Ve,se.state=Bn,se.size=xr,se.normalized=Wr,se.type=Xr||Ve.dtype,se.offset=pt,se.stride=Ct,se.divisor=un}}Ot[Ke]=no(function(Vr,Sn){var pn=Vr.attribCache;if(nt in pn)return pn[nt];var En={isStream:!1};return Object.keys(se).forEach(function(bn){En[bn]=se[bn]}),se.buffer&&(En.buffer=Vr.link(se.buffer),En.type=En.type||En.buffer+".dtype"),pn[nt]=En,En})}),Object.keys(ft).forEach(function(Ke){var Re=ft[Ke];function nt(se,Ve){var ye=se.invoke(Ve,Re),pt=se.shared,Ct=se.constants,xr=pt.isBufferArgs,Wr=pt.buffer;b.optional(function(){se.assert(Ve,ye+"&&(typeof "+ye+'==="object"||typeof '+ye+'==="function")&&('+xr+"("+ye+")||"+Wr+".getBuffer("+ye+")||"+Wr+".getBuffer("+ye+".buffer)||"+xr+"("+ye+'.buffer)||("constant" in '+ye+"&&(typeof "+ye+'.constant==="number"||'+pt.isArrayLike+"("+ye+".constant))))",'invalid dynamic attribute "'+Ke+'"')});var Xr={isStream:Ve.def(!1)},un=new ht;un.state=Bn,Object.keys(un).forEach(function(En){Xr[En]=Ve.def(""+un[En])});var Vr=Xr.buffer,Sn=Xr.type;Ve("if(",xr,"(",ye,")){",Xr.isStream,"=true;",Vr,"=",Wr,".createStream(",nc,",",ye,");",Sn,"=",Vr,".dtype;","}else{",Vr,"=",Wr,".getBuffer(",ye,");","if(",Vr,"){",Sn,"=",Vr,".dtype;",'}else if("constant" in ',ye,"){",Xr.state,"=",oi,";","if(typeof "+ye+'.constant === "number"){',Xr[ni[0]],"=",ye,".constant;",ni.slice(1).map(function(En){return Xr[En]}).join("="),"=0;","}else{",ni.map(function(En,bn){return Xr[En]+"="+ye+".constant.length>"+bn+"?"+ye+".constant["+bn+"]:0;"}).join(""),"}}else{","if(",xr,"(",ye,".buffer)){",Vr,"=",Wr,".createStream(",nc,",",ye,".buffer);","}else{",Vr,"=",Wr,".getBuffer(",ye,".buffer);","}",Sn,'="type" in ',ye,"?",Ct.glTypes,"[",ye,".type]:",Vr,".dtype;",Xr.normalized,"=!!",ye,".normalized;");function pn(En){Ve(Xr[En],"=",ye,".",En,"|0;")}return pn("size"),pn("offset"),pn("stride"),pn("divisor"),Ve("}}"),Ve.exit("if(",Xr.isStream,"){",Wr,".destroyStream(",Vr,");","}"),Xr}Ot[Ke]=ys(Re,nt)}),Ot}function Aa(de){var Y=de.static,Ue=de.dynamic,ft={};return Object.keys(Y).forEach(function(Ot){var Ke=Y[Ot];ft[Ot]=no(function(Re,nt){return typeof Ke=="number"||typeof Ke=="boolean"?""+Ke:Re.link(Ke)})}),Object.keys(Ue).forEach(function(Ot){var Ke=Ue[Ot];ft[Ot]=ys(Ke,function(Re,nt){return Re.invoke(nt,Ke)})}),ft}function bo(de,Y,Ue,ft,Ot){var Ke=de.static,Re=de.dynamic;b.optional(function(){var pn=[Ps,Lu,Bl,zs,fo,vc,Nl,Lc,vl,yc].concat(Ln);function En(bn){Object.keys(bn).forEach(function(_n){b.command(pn.indexOf(_n)>=0,'unknown parameter "'+_n+'"',Ot.commandStr)})}En(Ke),En(Re)});var nt=ii(de,Y),se=ln(de,Ot),Ve=Gn(de,se,Ot),ye=Da(de,Ot),pt=Va(de,Ot),Ct=Ii(de,Ot,nt);function xr(pn){var En=Ve[pn];En&&(pt[pn]=En)}xr(ms),xr(wn(ec));var Wr=Object.keys(pt).length>0,Xr={framebuffer:se,draw:ye,shader:Ct,state:pt,dirty:Wr,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(Xr.profile=en(de,Ot),Xr.uniforms=Si(Ue,Ot),Xr.drawVAO=Xr.scopeVAO=ye.vao,!Xr.drawVAO&&Ct.program&&!nt&&Oe.angle_instanced_arrays&&ye.static.elements){var un=!0,Vr=Ct.program.attributes.map(function(pn){var En=Y.static[pn];return un=un&&!!En,En});if(un&&Vr.length>0){var Sn=Ir.getVAO(Ir.createVAO({attributes:Vr,elements:ye.static.elements}));Xr.drawVAO=new ra(null,null,null,function(pn,En){return pn.link(Sn)}),Xr.useVAO=!0}}return nt?Xr.useVAO=!0:Xr.attributes=Po(Y,Ot),Xr.context=Aa(ft,Ot),Xr}function Xa(de,Y,Ue){var ft=de.shared,Ot=ft.context,Ke=de.scope();Object.keys(Ue).forEach(function(Re){Y.save(Ot,"."+Re);var nt=Ue[Re],se=nt.append(de,Y);Array.isArray(se)?Ke(Ot,".",Re,"=[",se.join(),"];"):Ke(Ot,".",Re,"=",se,";")}),Y(Ke)}function wo(de,Y,Ue,ft){var Ot=de.shared,Ke=Ot.gl,Re=Ot.framebuffer,nt;Hr&&(nt=Y.def(Ot.extensions,".webgl_draw_buffers"));var se=de.constants,Ve=se.drawBuffer,ye=se.backBuffer,pt;Ue?pt=Ue.append(de,Y):pt=Y.def(Re,".next"),ft||Y("if(",pt,"!==",Re,".cur){"),Y("if(",pt,"){",Ke,".bindFramebuffer(",zh,",",pt,".framebuffer);"),Hr&&Y(nt,".drawBuffersWEBGL(",Ve,"[",pt,".colorAttachments.length]);"),Y("}else{",Ke,".bindFramebuffer(",zh,",null);"),Hr&&Y(nt,".drawBuffersWEBGL(",ye,");"),Y("}",Re,".cur=",pt,";"),ft||Y("}")}function po(de,Y,Ue){var ft=de.shared,Ot=ft.gl,Ke=de.current,Re=de.next,nt=ft.current,se=ft.next,Ve=de.cond(nt,".dirty");Ln.forEach(function(ye){var pt=wn(ye);if(!(pt in Ue.state)){var Ct,xr;if(pt in Re){Ct=Re[pt],xr=Ke[pt];var Wr=Ne(zr[pt].length,function(un){return Ve.def(Ct,"[",un,"]")});Ve(de.cond(Wr.map(function(un,Vr){return un+"!=="+xr+"["+Vr+"]"}).join("||")).then(Ot,".",lr[pt],"(",Wr,");",Wr.map(function(un,Vr){return xr+"["+Vr+"]="+un}).join(";"),";"))}else{Ct=Ve.def(se,".",pt);var Xr=de.cond(Ct,"!==",nt,".",pt);Ve(Xr),pt in ar?Xr(de.cond(Ct).then(Ot,".enable(",ar[pt],");").else(Ot,".disable(",ar[pt],");"),nt,".",pt,"=",Ct,";"):Xr(Ot,".",lr[pt],"(",Ct,");",nt,".",pt,"=",Ct,";")}}}),Object.keys(Ue.state).length===0&&Ve(nt,".dirty=false;"),Y(Ve)}function Vo(de,Y,Ue,ft){var Ot=de.shared,Ke=de.current,Re=Ot.current,nt=Ot.gl;ch(Object.keys(Ue)).forEach(function(se){var Ve=Ue[se];if(!(ft&&!ft(Ve))){var ye=Ve.append(de,Y);if(ar[se]){var pt=ar[se];bl(Ve)?ye?Y(nt,".enable(",pt,");"):Y(nt,".disable(",pt,");"):Y(de.cond(ye).then(nt,".enable(",pt,");").else(nt,".disable(",pt,");")),Y(Re,".",se,"=",ye,";")}else if(Ea(ye)){var Ct=Ke[se];Y(nt,".",lr[se],"(",ye,");",ye.map(function(xr,Wr){return Ct+"["+Wr+"]="+xr}).join(";"),";")}else Y(nt,".",lr[se],"(",ye,");",Re,".",se,"=",ye,";")}})}function Ua(de,Y){kr&&(de.instancing=Y.def(de.shared.extensions,".angle_instanced_arrays"))}function li(de,Y,Ue,ft,Ot){var Ke=de.shared,Re=de.stats,nt=Ke.current,se=Ke.timer,Ve=Ue.profile;function ye(){var pn=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return pn||typeof performance=="undefined"?"Date.now()":"performance.now()"}var pt,Ct;function xr(pn){pt=Y.def(),pn(pt,"=",ye(),";"),typeof Ot=="string"?pn(Re,".count+=",Ot,";"):pn(Re,".count++;"),Cr&&(ft?(Ct=Y.def(),pn(Ct,"=",se,".getNumPendingQueries();")):pn(se,".beginQuery(",Re,");"))}function Wr(pn){pn(Re,".cpuTime+=",ye(),"-",pt,";"),Cr&&(ft?pn(se,".pushScopeStats(",Ct,",",se,".getNumPendingQueries(),",Re,");"):pn(se,".endQuery();"))}function Xr(pn){var En=Y.def(nt,".profile");Y(nt,".profile=",pn,";"),Y.exit(nt,".profile=",En,";")}var un;if(Ve){if(bl(Ve)){Ve.enable?(xr(Y),Wr(Y.exit),Xr("true")):Xr("false");return}un=Ve.append(de,Y),Xr(un)}else un=Y.def(nt,".profile");var Vr=de.block();xr(Vr),Y("if(",un,"){",Vr,"}");var Sn=de.block();Wr(Sn),Y.exit("if(",un,"){",Sn,"}")}function mo(de,Y,Ue,ft,Ot){var Ke=de.shared;function Re(se){switch(se){case _c:case Bc:case Vc:return 2;case gl:case _l:case oc:return 3;case ac:case Nc:case sc:return 4;default:return 1}}function nt(se,Ve,ye){var pt=Ke.gl,Ct=Y.def(se,".location"),xr=Y.def(Ke.attributes,"[",Ct,"]"),Wr=ye.state,Xr=ye.buffer,un=[ye.x,ye.y,ye.z,ye.w],Vr=["buffer","normalized","offset","stride"];function Sn(){Y("if(!",xr,".buffer){",pt,".enableVertexAttribArray(",Ct,");}");var En=ye.type,bn;if(ye.size?bn=Y.def(ye.size,"||",Ve):bn=Ve,Y("if(",xr,".type!==",En,"||",xr,".size!==",bn,"||",Vr.map(function(Un){return xr+"."+Un+"!=="+ye[Un]}).join("||"),"){",pt,".bindBuffer(",nc,",",Xr,".buffer);",pt,".vertexAttribPointer(",[Ct,bn,En,ye.normalized,ye.stride,ye.offset],");",xr,".type=",En,";",xr,".size=",bn,";",Vr.map(function(Un){return xr+"."+Un+"="+ye[Un]+";"}).join(""),"}"),kr){var _n=ye.divisor;Y("if(",xr,".divisor!==",_n,"){",de.instancing,".vertexAttribDivisorANGLE(",[Ct,_n],");",xr,".divisor=",_n,";}")}}function pn(){Y("if(",xr,".buffer){",pt,".disableVertexAttribArray(",Ct,");",xr,".buffer=null;","}if(",ni.map(function(En,bn){return xr+"."+En+"!=="+un[bn]}).join("||"),"){",pt,".vertexAttrib4f(",Ct,",",un,");",ni.map(function(En,bn){return xr+"."+En+"="+un[bn]+";"}).join(""),"}")}Wr===Bn?Sn():Wr===oi?pn():(Y("if(",Wr,"===",Bn,"){"),Sn(),Y("}else{"),pn(),Y("}"))}ft.forEach(function(se){var Ve=se.name,ye=Ue.attributes[Ve],pt;if(ye){if(!Ot(ye))return;pt=ye.append(de,Y)}else{if(!Ot(Nh))return;var Ct=de.scopeAttrib(Ve);b.optional(function(){de.assert(Y,Ct+".state","missing attribute "+Ve)}),pt={},Object.keys(new ht).forEach(function(xr){pt[xr]=Y.def(Ct,".",xr)})}nt(de.link(se),Re(se.info.type),pt)})}function Vi(de,Y,Ue,ft,Ot,Ke){for(var Re=de.shared,nt=Re.gl,se,Ve=0;Ve<ft.length;++Ve){var ye=ft[Ve],pt=ye.name,Ct=ye.info.type,xr=Ue.uniforms[pt],Wr=de.link(ye),Xr=Wr+".location",un;if(xr){if(!Ot(xr))continue;if(bl(xr)){var Vr=xr.value;if(b.command(Vr!==null&&typeof Vr!="undefined",'missing uniform "'+pt+'"',de.commandStr),Ct===Sc||Ct===Tc){b.command(typeof Vr=="function"&&(Ct===Sc&&(Vr._reglType==="texture2d"||Vr._reglType==="framebuffer")||Ct===Tc&&(Vr._reglType==="textureCube"||Vr._reglType==="framebufferCube")),"invalid texture for uniform "+pt,de.commandStr);var Sn=de.link(Vr._texture||Vr.color[0]._texture);Y(nt,".uniform1i(",Xr,",",Sn+".bind());"),Y.exit(Sn,".unbind();")}else if(Ct===vs||Ct===wc||Ct===Ec){b.optional(function(){b.command(Ea(Vr),"invalid matrix for uniform "+pt,de.commandStr),b.command(Ct===vs&&Vr.length===4||Ct===wc&&Vr.length===9||Ct===Ec&&Vr.length===16,"invalid length for matrix uniform "+pt,de.commandStr)});var pn=de.global.def("new Float32Array(["+Array.prototype.slice.call(Vr)+"])"),En=2;Ct===wc?En=3:Ct===Ec&&(En=4),Y(nt,".uniformMatrix",En,"fv(",Xr,",false,",pn,");")}else{switch(Ct){case zc:b.commandType(Vr,"number","uniform "+pt,de.commandStr),se="1f";break;case _c:b.command(Ea(Vr)&&Vr.length===2,"uniform "+pt,de.commandStr),se="2f";break;case gl:b.command(Ea(Vr)&&Vr.length===3,"uniform "+pt,de.commandStr),se="3f";break;case ac:b.command(Ea(Vr)&&Vr.length===4,"uniform "+pt,de.commandStr),se="4f";break;case bc:b.commandType(Vr,"boolean","uniform "+pt,de.commandStr),se="1i";break;case xc:b.commandType(Vr,"number","uniform "+pt,de.commandStr),se="1i";break;case Vc:b.command(Ea(Vr)&&Vr.length===2,"uniform "+pt,de.commandStr),se="2i";break;case Bc:b.command(Ea(Vr)&&Vr.length===2,"uniform "+pt,de.commandStr),se="2i";break;case oc:b.command(Ea(Vr)&&Vr.length===3,"uniform "+pt,de.commandStr),se="3i";break;case _l:b.command(Ea(Vr)&&Vr.length===3,"uniform "+pt,de.commandStr),se="3i";break;case sc:b.command(Ea(Vr)&&Vr.length===4,"uniform "+pt,de.commandStr),se="4i";break;case Nc:b.command(Ea(Vr)&&Vr.length===4,"uniform "+pt,de.commandStr),se="4i";break}Y(nt,".uniform",se,"(",Xr,",",Ea(Vr)?Array.prototype.slice.call(Vr):Vr,");")}continue}else un=xr.append(de,Y)}else{if(!Ot(Nh))continue;un=Y.def(Re.uniforms,"[",ie.id(pt),"]")}Ct===Sc?(b(!Array.isArray(un),"must specify a scalar prop for textures"),Y("if(",un,"&&",un,'._reglType==="framebuffer"){',un,"=",un,".color[0];","}")):Ct===Tc&&(b(!Array.isArray(un),"must specify a scalar prop for cube maps"),Y("if(",un,"&&",un,'._reglType==="framebufferCube"){',un,"=",un,".color[0];","}")),b.optional(function(){function es(Vs,wl){de.assert(Y,Vs,'bad data or missing for uniform "'+pt+'".  '+wl)}function bu(Vs){b(!Array.isArray(un),"must not specify an array type for uniform"),es("typeof "+un+'==="'+Vs+'"',"invalid type, expected "+Vs)}function Ns(Vs,wl){Array.isArray(un)?b(un.length===Vs,"must have length "+Vs):es(Re.isArrayLike+"("+un+")&&"+un+".length==="+Vs,"invalid vector, should have length "+Vs,de.commandStr)}function dh(Vs){b(!Array.isArray(un),"must not specify a value type"),es("typeof "+un+'==="function"&&'+un+'._reglType==="texture'+(Vs===Lh?"2d":"Cube")+'"',"invalid texture type",de.commandStr)}switch(Ct){case xc:bu("number");break;case Bc:Ns(2,"number");break;case _l:Ns(3,"number");break;case Nc:Ns(4,"number");break;case zc:bu("number");break;case _c:Ns(2,"number");break;case gl:Ns(3,"number");break;case ac:Ns(4,"number");break;case bc:bu("boolean");break;case Vc:Ns(2,"boolean");break;case oc:Ns(3,"boolean");break;case sc:Ns(4,"boolean");break;case vs:Ns(4,"number");break;case wc:Ns(9,"number");break;case Ec:Ns(16,"number");break;case Sc:dh(Lh);break;case Tc:dh(uh);break}});var bn=1;switch(Ct){case Sc:case Tc:var _n=Y.def(un,"._texture");Y(nt,".uniform1i(",Xr,",",_n,".bind());"),Y.exit(_n,".unbind();");continue;case xc:case bc:se="1i";break;case Bc:case Vc:se="2i",bn=2;break;case _l:case oc:se="3i",bn=3;break;case Nc:case sc:se="4i",bn=4;break;case zc:se="1f";break;case _c:se="2f",bn=2;break;case gl:se="3f",bn=3;break;case ac:se="4f",bn=4;break;case vs:se="Matrix2fv";break;case wc:se="Matrix3fv";break;case Ec:se="Matrix4fv";break}if(se.charAt(0)==="M"){Y(nt,".uniform",se,"(",Xr,",");var Un=Math.pow(Ct-vs+2,2),aa=de.global.def("new Float32Array(",Un,")");Array.isArray(un)?Y("false,(",Ne(Un,function(es){return aa+"["+es+"]="+un[es]}),",",aa,")"):Y("false,(Array.isArray(",un,")||",un," instanceof Float32Array)?",un,":(",Ne(Un,function(es){return aa+"["+es+"]="+un+"["+es+"]"}),",",aa,")"),Y(");")}else if(bn>1){for(var Lo=[],ma=[],Ki=0;Ki<bn;++Ki)Array.isArray(un)?ma.push(un[Ki]):ma.push(Y.def(un+"["+Ki+"]")),Ke&&Lo.push(Y.def());Ke&&Y("if(!",de.batchId,"||",Lo.map(function(es,bu){return es+"!=="+ma[bu]}).join("||"),"){",Lo.map(function(es,bu){return es+"="+ma[bu]+";"}).join("")),Y(nt,".uniform",se,"(",Xr,",",ma.join(","),");"),Ke&&Y("}")}else{if(b(!Array.isArray(un),"uniform value must not be an array"),Ke){var Fu=Y.def();Y("if(!",de.batchId,"||",Fu,"!==",un,"){",Fu,"=",un,";")}Y(nt,".uniform",se,"(",Xr,",",un,");"),Ke&&Y("}")}}}function Mo(de,Y,Ue,ft){var Ot=de.shared,Ke=Ot.gl,Re=Ot.draw,nt=ft.draw;function se(){var bn=nt.elements,_n,Un=Y;return bn?((bn.contextDep&&ft.contextDynamic||bn.propDep)&&(Un=Ue),_n=bn.append(de,Un),nt.elementsActive&&Un("if("+_n+")"+Ke+".bindBuffer("+sh+","+_n+".buffer.buffer);")):(_n=Un.def(),Un(_n,"=",Re,".",zs,";","if(",_n,"){",Ke,".bindBuffer(",sh,",",_n,".buffer.buffer);}","else if(",Ot.vao,".currentVAO){",_n,"=",de.shared.elements+".getElements("+Ot.vao,".currentVAO.elements);",yr?"":"if("+_n+")"+Ke+".bindBuffer("+sh+","+_n+".buffer.buffer);","}")),_n}function Ve(){var bn=nt.count,_n,Un=Y;return bn?((bn.contextDep&&ft.contextDynamic||bn.propDep)&&(Un=Ue),_n=bn.append(de,Un),b.optional(function(){bn.MISSING&&de.assert(Y,"false","missing vertex count"),bn.DYNAMIC&&de.assert(Un,_n+">=0","missing vertex count")})):(_n=Un.def(Re,".",Nl),b.optional(function(){de.assert(Un,_n+">=0","missing vertex count")})),_n}var ye=se();function pt(bn){var _n=nt[bn];return _n?_n.contextDep&&ft.contextDynamic||_n.propDep?_n.append(de,Ue):_n.append(de,Y):Y.def(Re,".",bn)}var Ct=pt(fo),xr=pt(vc),Wr=Ve();if(typeof Wr=="number"){if(Wr===0)return}else Ue("if(",Wr,"){"),Ue.exit("}");var Xr,un;kr&&(Xr=pt(Lc),un=de.instancing);var Vr=ye+".type",Sn=nt.elements&&bl(nt.elements)&&!nt.vaoActive;function pn(){function bn(){Ue(un,".drawElementsInstancedANGLE(",[Ct,Wr,Vr,xr+"<<(("+Vr+"-"+qn+")>>1)",Xr],");")}function _n(){Ue(un,".drawArraysInstancedANGLE(",[Ct,xr,Wr,Xr],");")}ye&&ye!=="null"?Sn?bn():(Ue("if(",ye,"){"),bn(),Ue("}else{"),_n(),Ue("}")):_n()}function En(){function bn(){Ue(Ke+".drawElements("+[Ct,Wr,Vr,xr+"<<(("+Vr+"-"+qn+")>>1)"]+");")}function _n(){Ue(Ke+".drawArrays("+[Ct,xr,Wr]+");")}ye&&ye!=="null"?Sn?bn():(Ue("if(",ye,"){"),bn(),Ue("}else{"),_n(),Ue("}")):_n()}kr&&(typeof Xr!="number"||Xr>=0)?typeof Xr=="string"?(Ue("if(",Xr,">0){"),pn(),Ue("}else if(",Xr,"<0){"),En(),Ue("}")):pn():En()}function Zn(de,Y,Ue,ft,Ot){var Ke=Yn(),Re=Ke.proc("body",Ot);return b.optional(function(){Ke.commandStr=Y.commandStr,Ke.command=Ke.link(Y.commandStr)}),kr&&(Ke.instancing=Re.def(Ke.shared.extensions,".angle_instanced_arrays")),de(Ke,Re,Ue,ft),Ke.compile().body}function Ti(de,Y,Ue,ft){Ua(de,Y),Ue.useVAO?Ue.drawVAO?Y(de.shared.vao,".setVAO(",Ue.drawVAO.append(de,Y),");"):Y(de.shared.vao,".setVAO(",de.shared.vao,".targetVAO);"):(Y(de.shared.vao,".setVAO(null);"),mo(de,Y,Ue,ft.attributes,function(){return!0})),Vi(de,Y,Ue,ft.uniforms,function(){return!0},!1),Mo(de,Y,Y,Ue)}function Yi(de,Y){var Ue=de.proc("draw",1);Ua(de,Ue),Xa(de,Ue,Y.context),wo(de,Ue,Y.framebuffer),po(de,Ue,Y),Vo(de,Ue,Y.state),li(de,Ue,Y,!1,!0);var ft=Y.shader.progVar.append(de,Ue);if(Ue(de.shared.gl,".useProgram(",ft,".program);"),Y.shader.program)Ti(de,Ue,Y,Y.shader.program);else{Ue(de.shared.vao,".setVAO(null);");var Ot=de.global.def("{}"),Ke=Ue.def(ft,".id"),Re=Ue.def(Ot,"[",Ke,"]");Ue(de.cond(Re).then(Re,".call(this,a0);").else(Re,"=",Ot,"[",Ke,"]=",de.link(function(nt){return Zn(Ti,de,Y,nt,1)}),"(",ft,");",Re,".call(this,a0);"))}Object.keys(Y.state).length>0&&Ue(de.shared.current,".dirty=true;"),de.shared.vao&&Ue(de.shared.vao,".setVAO(null);")}function Ya(de,Y,Ue,ft){de.batchId="a1",Ua(de,Y);function Ot(){return!0}mo(de,Y,Ue,ft.attributes,Ot),Vi(de,Y,Ue,ft.uniforms,Ot,!1),Mo(de,Y,Y,Ue)}function Ou(de,Y,Ue,ft){Ua(de,Y);var Ot=Ue.contextDep,Ke=Y.def(),Re="a0",nt="a1",se=Y.def();de.shared.props=se,de.batchId=Ke;var Ve=de.scope(),ye=de.scope();Y(Ve.entry,"for(",Ke,"=0;",Ke,"<",nt,";++",Ke,"){",se,"=",Re,"[",Ke,"];",ye,"}",Ve.exit);function pt(Vr){return Vr.contextDep&&Ot||Vr.propDep}function Ct(Vr){return!pt(Vr)}if(Ue.needsContext&&Xa(de,ye,Ue.context),Ue.needsFramebuffer&&wo(de,ye,Ue.framebuffer),Vo(de,ye,Ue.state,pt),Ue.profile&&pt(Ue.profile)&&li(de,ye,Ue,!1,!0),ft)Ue.useVAO?Ue.drawVAO?pt(Ue.drawVAO)?ye(de.shared.vao,".setVAO(",Ue.drawVAO.append(de,ye),");"):Ve(de.shared.vao,".setVAO(",Ue.drawVAO.append(de,Ve),");"):Ve(de.shared.vao,".setVAO(",de.shared.vao,".targetVAO);"):(Ve(de.shared.vao,".setVAO(null);"),mo(de,Ve,Ue,ft.attributes,Ct),mo(de,ye,Ue,ft.attributes,pt)),Vi(de,Ve,Ue,ft.uniforms,Ct,!1),Vi(de,ye,Ue,ft.uniforms,pt,!0),Mo(de,Ve,ye,Ue);else{var xr=de.global.def("{}"),Wr=Ue.shader.progVar.append(de,ye),Xr=ye.def(Wr,".id"),un=ye.def(xr,"[",Xr,"]");ye(de.shared.gl,".useProgram(",Wr,".program);","if(!",un,"){",un,"=",xr,"[",Xr,"]=",de.link(function(Vr){return Zn(Ya,de,Ue,Vr,2)}),"(",Wr,");}",un,".call(this,a0[",Ke,"],",Ke,");")}}function be(de,Y){var Ue=de.proc("batch",2);de.batchId="0",Ua(de,Ue);var ft=!1,Ot=!0;Object.keys(Y.context).forEach(function(xr){ft=ft||Y.context[xr].propDep}),ft||(Xa(de,Ue,Y.context),Ot=!1);var Ke=Y.framebuffer,Re=!1;Ke?(Ke.propDep?ft=Re=!0:Ke.contextDep&&ft&&(Re=!0),Re||wo(de,Ue,Ke)):wo(de,Ue,null),Y.state.viewport&&Y.state.viewport.propDep&&(ft=!0);function nt(xr){return xr.contextDep&&ft||xr.propDep}po(de,Ue,Y),Vo(de,Ue,Y.state,function(xr){return!nt(xr)}),(!Y.profile||!nt(Y.profile))&&li(de,Ue,Y,!1,"a1"),Y.contextDep=ft,Y.needsContext=Ot,Y.needsFramebuffer=Re;var se=Y.shader.progVar;if(se.contextDep&&ft||se.propDep)Ou(de,Ue,Y,null);else{var Ve=se.append(de,Ue);if(Ue(de.shared.gl,".useProgram(",Ve,".program);"),Y.shader.program)Ou(de,Ue,Y,Y.shader.program);else{Ue(de.shared.vao,".setVAO(null);");var ye=de.global.def("{}"),pt=Ue.def(Ve,".id"),Ct=Ue.def(ye,"[",pt,"]");Ue(de.cond(Ct).then(Ct,".call(this,a0,a1);").else(Ct,"=",ye,"[",pt,"]=",de.link(function(xr){return Zn(Ou,de,Y,xr,2)}),"(",Ve,");",Ct,".call(this,a0,a1);"))}}Object.keys(Y.state).length>0&&Ue(de.shared.current,".dirty=true;"),de.shared.vao&&Ue(de.shared.vao,".setVAO(null);")}function qt(de,Y){var Ue=de.proc("scope",3);de.batchId="a2";var ft=de.shared,Ot=ft.current;Xa(de,Ue,Y.context),Y.framebuffer&&Y.framebuffer.append(de,Ue),ch(Object.keys(Y.state)).forEach(function(Re){var nt=Y.state[Re],se=nt.append(de,Ue);Ea(se)?se.forEach(function(Ve,ye){Ue.set(de.next[Re],"["+ye+"]",Ve)}):Ue.set(ft.next,"."+Re,se)}),li(de,Ue,Y,!0,!0),[zs,vc,Nl,Lc,fo].forEach(function(Re){var nt=Y.draw[Re];!nt||Ue.set(ft.draw,"."+Re,""+nt.append(de,Ue))}),Object.keys(Y.uniforms).forEach(function(Re){var nt=Y.uniforms[Re].append(de,Ue);Array.isArray(nt)&&(nt="["+nt.join()+"]"),Ue.set(ft.uniforms,"["+ie.id(Re)+"]",nt)}),Object.keys(Y.attributes).forEach(function(Re){var nt=Y.attributes[Re].append(de,Ue),se=de.scopeAttrib(Re);Object.keys(new ht).forEach(function(Ve){Ue.set(se,"."+Ve,nt[Ve])})}),Y.scopeVAO&&Ue.set(ft.vao,".targetVAO",Y.scopeVAO.append(de,Ue));function Ke(Re){var nt=Y.shader[Re];nt&&Ue.set(ft.shader,"."+Re,nt.append(de,Ue))}Ke(Lu),Ke(Bl),Object.keys(Y.state).length>0&&(Ue(Ot,".dirty=true;"),Ue.exit(Ot,".dirty=true;")),Ue("a1(",de.shared.context,",a0,",de.batchId,");")}function At(de){if(!(typeof de!="object"||Ea(de))){for(var Y=Object.keys(de),Ue=0;Ue<Y.length;++Ue)if(Nr.isDynamic(de[Y[Ue]]))return!0;return!1}}function gn(de,Y,Ue){var ft=Y.static[Ue];if(!ft||!At(ft))return;var Ot=de.global,Ke=Object.keys(ft),Re=!1,nt=!1,se=!1,Ve=de.global.def("{}");Ke.forEach(function(pt){var Ct=ft[pt];if(Nr.isDynamic(Ct)){typeof Ct=="function"&&(Ct=ft[pt]=Nr.unbox(Ct));var xr=ys(Ct,null);Re=Re||xr.thisDep,se=se||xr.propDep,nt=nt||xr.contextDep}else{switch(Ot(Ve,".",pt,"="),typeof Ct){case"number":Ot(Ct);break;case"string":Ot('"',Ct,'"');break;case"object":Array.isArray(Ct)&&Ot("[",Ct.join(),"]");break;default:Ot(de.link(Ct));break}Ot(";")}});function ye(pt,Ct){Ke.forEach(function(xr){var Wr=ft[xr];if(!!Nr.isDynamic(Wr)){var Xr=pt.invoke(Ct,Wr);Ct(Ve,".",xr,"=",Xr,";")}})}Y.dynamic[Ue]=new Nr.DynamicVariable(co,{thisDep:Re,contextDep:nt,propDep:se,ref:Ve,append:ye}),delete Y.static[Ue]}function ki(de,Y,Ue,ft,Ot){var Ke=Yn();Ke.stats=Ke.link(Ot),Object.keys(Y.static).forEach(function(nt){gn(Ke,Y,nt)}),sf.forEach(function(nt){gn(Ke,de,nt)});var Re=bo(de,Y,Ue,ft,Ke);return Yi(Ke,Re),qt(Ke,Re),be(Ke,Re),l(Ke.compile(),{destroy:function(){Re.shader.program.destroy()}})}return{next:nn,current:zr,procs:function(){var de=Yn(),Y=de.proc("poll"),Ue=de.proc("refresh"),ft=de.block();Y(ft),Ue(ft);var Ot=de.shared,Ke=Ot.gl,Re=Ot.next,nt=Ot.current;ft(nt,".dirty=false;"),wo(de,Y),wo(de,Ue,null,!0);var se;kr&&(se=de.link(kr)),Oe.oes_vertex_array_object&&Ue(de.link(Oe.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var Ve=0;Ve<Ut.maxAttributes;++Ve){var ye=Ue.def(Ot.attributes,"[",Ve,"]"),pt=de.cond(ye,".buffer");pt.then(Ke,".enableVertexAttribArray(",Ve,");",Ke,".bindBuffer(",nc,",",ye,".buffer.buffer);",Ke,".vertexAttribPointer(",Ve,",",ye,".size,",ye,".type,",ye,".normalized,",ye,".stride,",ye,".offset);").else(Ke,".disableVertexAttribArray(",Ve,");",Ke,".vertexAttrib4f(",Ve,",",ye,".x,",ye,".y,",ye,".z,",ye,".w);",ye,".buffer=null;"),Ue(pt),kr&&Ue(se,".vertexAttribDivisorANGLE(",Ve,",",ye,".divisor);")}return Ue(de.shared.vao,".currentVAO=null;",de.shared.vao,".setVAO(",de.shared.vao,".targetVAO);"),Object.keys(ar).forEach(function(Ct){var xr=ar[Ct],Wr=ft.def(Re,".",Ct),Xr=de.block();Xr("if(",Wr,"){",Ke,".enable(",xr,")}else{",Ke,".disable(",xr,")}",nt,".",Ct,"=",Wr,";"),Ue(Xr),Y("if(",Wr,"!==",nt,".",Ct,"){",Xr,"}")}),Object.keys(lr).forEach(function(Ct){var xr=lr[Ct],Wr=zr[Ct],Xr,un,Vr=de.block();if(Vr(Ke,".",xr,"("),Ea(Wr)){var Sn=Wr.length;Xr=de.global.def(Re,".",Ct),un=de.global.def(nt,".",Ct),Vr(Ne(Sn,function(pn){return Xr+"["+pn+"]"}),");",Ne(Sn,function(pn){return un+"["+pn+"]="+Xr+"["+pn+"];"}).join("")),Y("if(",Ne(Sn,function(pn){return Xr+"["+pn+"]!=="+un+"["+pn+"]"}).join("||"),"){",Vr,"}")}else Xr=ft.def(Re,".",Ct),un=ft.def(nt,".",Ct),Vr(Xr,");",nt,".",Ct,"=",Xr,";"),Y("if(",Xr,"!==",un,"){",Vr,"}");Ue(Vr)}),de.compile()}(),compile:ki}}function mf(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var vf=34918,yf=34919,hh=35007,gf=function(T,ie){if(!ie.ext_disjoint_timer_query)return null;var Oe=[];function Ut(){return Oe.pop()||ie.ext_disjoint_timer_query.createQueryEXT()}function pr(kr){Oe.push(kr)}var Bt=[];function ir(kr){var Hr=Ut();ie.ext_disjoint_timer_query.beginQueryEXT(hh,Hr),Bt.push(Hr),Cr(Bt.length-1,Bt.length,kr)}function _r(){ie.ext_disjoint_timer_query.endQueryEXT(hh)}function Tr(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Ir=[];function Lr(){return Ir.pop()||new Tr}function Or(kr){Ir.push(kr)}var Kr=[];function Cr(kr,Hr,yr){var zr=Lr();zr.startQueryIndex=kr,zr.endQueryIndex=Hr,zr.sum=0,zr.stats=yr,Kr.push(zr)}var Mr=[],ht=[];function Yt(){var kr,Hr,yr=Bt.length;if(yr!==0){ht.length=Math.max(ht.length,yr+1),Mr.length=Math.max(Mr.length,yr+1),Mr[0]=0,ht[0]=0;var zr=0;for(kr=0,Hr=0;Hr<Bt.length;++Hr){var nn=Bt[Hr];ie.ext_disjoint_timer_query.getQueryObjectEXT(nn,yf)?(zr+=ie.ext_disjoint_timer_query.getQueryObjectEXT(nn,vf),pr(nn)):Bt[kr++]=nn,Mr[Hr+1]=zr,ht[Hr+1]=kr}for(Bt.length=kr,kr=0,Hr=0;Hr<Kr.length;++Hr){var Ln=Kr[Hr],ar=Ln.startQueryIndex,lr=Ln.endQueryIndex;Ln.sum+=Mr[lr]-Mr[ar];var wn=ht[ar],Qr=ht[lr];Qr===wn?(Ln.stats.gpuTime+=Ln.sum/1e6,Or(Ln)):(Ln.startQueryIndex=wn,Ln.endQueryIndex=Qr,Kr[kr++]=Ln)}Kr.length=kr}}return{beginQuery:ir,endQuery:_r,pushScopeStats:Cr,update:Yt,getNumPendingQueries:function(){return Bt.length},clear:function(){Oe.push.apply(Oe,Bt);for(var kr=0;kr<Oe.length;kr++)ie.ext_disjoint_timer_query.deleteQueryEXT(Oe[kr]);Bt.length=0,Oe.length=0},restore:function(){Bt.length=0,Oe.length=0}}},_f=16384,Ac=256,Uh=1024,Gh=34962,Cc="webglcontextlost",fa="webglcontextrestored",fh=1,Yu=2,cc=3;function ph(T,ie){for(var Oe=0;Oe<T.length;++Oe)if(T[Oe]===ie)return Oe;return-1}function xf(T){var ie=ne(T);if(!ie)return null;var Oe=ie.gl,Ut=Oe.getContextAttributes(),pr=Oe.isContextLost(),Bt=xe(Oe,ie);if(!Bt)return null;var ir=ai(),_r=mf(),Tr=Bt.extensions,Ir=gf(Oe,Tr),Lr=Dn(),Or=Oe.drawingBufferWidth,Kr=Oe.drawingBufferHeight,Cr={tick:0,time:0,viewportWidth:Or,viewportHeight:Kr,framebufferWidth:Or,framebufferHeight:Kr,drawingBufferWidth:Or,drawingBufferHeight:Kr,pixelRatio:ie.pixelRatio},Mr={},ht={elements:null,primitive:4,count:-1,offset:0,instances:-1},Yt=ou(Oe,Tr),kr=S(Oe,_r,ie,zr),Hr=Ms(Oe,Tr,kr,_r),yr=St(Oe,Tr,Yt,_r,kr,Hr,ht);function zr(Zn){return yr.destroyBuffer(Zn)}var nn=Ur(Oe,ir,_r,ie),Ln=Jr(Oe,Tr,Yt,function(){wn.procs.poll()},Cr,_r,ie),ar=si(Oe,Tr,Yt,_r,ie),lr=Pe(Oe,Tr,Yt,Ln,ar,_r),wn=Vh(Oe,ir,Tr,Yt,kr,Hr,Ln,lr,Mr,yr,nn,ht,Cr,Ir,ie),Qr=Rn(Oe,lr,wn.procs.poll,Cr,Ut,Tr,Yt),Pr=wn.next,rn=Oe.canvas,an=[],ui=[],Yn=[],en=[ie.onDestroy],ln=null;function Gn(){if(an.length===0){Ir&&Ir.update(),ln=null;return}ln=yt.next(Gn),Ua();for(var Zn=an.length-1;Zn>=0;--Zn){var Ti=an[Zn];Ti&&Ti(Cr,null,0)}Oe.flush(),Ir&&Ir.update()}function ii(){!ln&&an.length>0&&(ln=yt.next(Gn))}function Ii(){ln&&(yt.cancel(Gn),ln=null)}function Da(Zn){Zn.preventDefault(),pr=!0,Ii(),ui.forEach(function(Ti){Ti()})}function Va(Zn){Oe.getError(),pr=!1,Bt.restore(),nn.restore(),kr.restore(),Ln.restore(),ar.restore(),lr.restore(),yr.restore(),Ir&&Ir.restore(),wn.procs.refresh(),ii(),Yn.forEach(function(Ti){Ti()})}var Si=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;!Si&&rn&&(rn.addEventListener(Cc,Da,!1),rn.addEventListener(fa,Va,!1));function Po(){an.length=0,Ii(),!Si&&rn&&(rn.removeEventListener(Cc,Da),rn.removeEventListener(fa,Va)),nn.clear(),lr.clear(),ar.clear(),yr.clear(),Ln.clear(),Hr.clear(),kr.clear(),Ir&&Ir.clear(),en.forEach(function(Zn){Zn()})}function Aa(Zn){b(!!Zn,"invalid args to regl({...})"),b.type(Zn,"object","invalid args to regl({...})");function Ti(Ke){var Re=l({},Ke);delete Re.uniforms,delete Re.attributes,delete Re.context,delete Re.vao,"stencil"in Re&&Re.stencil.op&&(Re.stencil.opBack=Re.stencil.opFront=Re.stencil.op,delete Re.stencil.op);function nt(se){if(se in Re){var Ve=Re[se];delete Re[se],Object.keys(Ve).forEach(function(ye){Re[se+"."+ye]=Ve[ye]})}}return nt("blend"),nt("depth"),nt("cull"),nt("stencil"),nt("polygonOffset"),nt("scissor"),nt("sample"),"vao"in Ke&&(Re.vao=Ke.vao),Re}function Yi(Ke,Re){var nt={},se={};return Object.keys(Ke).forEach(function(Ve){var ye=Ke[Ve];if(Nr.isDynamic(ye)){se[Ve]=Nr.unbox(ye,Ve);return}else if(Re&&Array.isArray(ye)){for(var pt=0;pt<ye.length;++pt)if(Nr.isDynamic(ye[pt])){se[Ve]=Nr.unbox(ye,Ve);return}}nt[Ve]=ye}),{dynamic:se,static:nt}}var Ya=Yi(Zn.context||{},!0),Ou=Yi(Zn.uniforms||{},!0),be=Yi(Zn.attributes||{},!1),qt=Yi(Ti(Zn),!1),At={gpuTime:0,cpuTime:0,count:0},gn=wn.compile(qt,be,Ou,Ya,At),ki=gn.draw,de=gn.batch,Y=gn.scope,Ue=[];function ft(Ke){for(;Ue.length<Ke;)Ue.push(null);return Ue}function Ot(Ke,Re){var nt;if(pr&&b.raise("context lost"),typeof Ke=="function")return Y.call(this,null,Ke,0);if(typeof Re=="function")if(typeof Ke=="number")for(nt=0;nt<Ke;++nt)Y.call(this,null,Re,nt);else if(Array.isArray(Ke))for(nt=0;nt<Ke.length;++nt)Y.call(this,Ke[nt],Re,nt);else return Y.call(this,Ke,Re,0);else if(typeof Ke=="number"){if(Ke>0)return de.call(this,ft(Ke|0),Ke|0)}else if(Array.isArray(Ke)){if(Ke.length)return de.call(this,Ke,Ke.length)}else return ki.call(this,Ke)}return l(Ot,{stats:At,destroy:function(){gn.destroy()}})}var bo=lr.setFBO=Aa({framebuffer:Nr.define.call(null,fh,"framebuffer")});function Xa(Zn,Ti){var Yi=0;wn.procs.poll();var Ya=Ti.color;Ya&&(Oe.clearColor(+Ya[0]||0,+Ya[1]||0,+Ya[2]||0,+Ya[3]||0),Yi|=_f),"depth"in Ti&&(Oe.clearDepth(+Ti.depth),Yi|=Ac),"stencil"in Ti&&(Oe.clearStencil(Ti.stencil|0),Yi|=Uh),b(!!Yi,"called regl.clear with no buffer specified"),Oe.clear(Yi)}function wo(Zn){if(b(typeof Zn=="object"&&Zn,"regl.clear() takes an object as input"),"framebuffer"in Zn)if(Zn.framebuffer&&Zn.framebuffer_reglType==="framebufferCube")for(var Ti=0;Ti<6;++Ti)bo(l({framebuffer:Zn.framebuffer.faces[Ti]},Zn),Xa);else bo(Zn,Xa);else Xa(null,Zn)}function po(Zn){b.type(Zn,"function","regl.frame() callback must be a function"),an.push(Zn);function Ti(){var Yi=ph(an,Zn);b(Yi>=0,"cannot cancel a frame twice");function Ya(){var Ou=ph(an,Ya);an[Ou]=an[an.length-1],an.length-=1,an.length<=0&&Ii()}an[Yi]=Ya}return ii(),{cancel:Ti}}function Vo(){var Zn=Pr.viewport,Ti=Pr.scissor_box;Zn[0]=Zn[1]=Ti[0]=Ti[1]=0,Cr.viewportWidth=Cr.framebufferWidth=Cr.drawingBufferWidth=Zn[2]=Ti[2]=Oe.drawingBufferWidth,Cr.viewportHeight=Cr.framebufferHeight=Cr.drawingBufferHeight=Zn[3]=Ti[3]=Oe.drawingBufferHeight}function Ua(){Cr.tick+=1,Cr.time=mo(),Vo(),wn.procs.poll()}function li(){Ln.refresh(),Vo(),wn.procs.refresh(),Ir&&Ir.update()}function mo(){return(Dn()-Lr)/1e3}li();function Vi(Zn,Ti){b.type(Ti,"function","listener callback must be a function");var Yi;switch(Zn){case"frame":return po(Ti);case"lost":Yi=ui;break;case"restore":Yi=Yn;break;case"destroy":Yi=en;break;default:b.raise("invalid event, must be one of frame,lost,restore,destroy")}return Yi.push(Ti),{cancel:function(){for(var Ya=0;Ya<Yi.length;++Ya)if(Yi[Ya]===Ti){Yi[Ya]=Yi[Yi.length-1],Yi.pop();return}}}}var Mo=l(Aa,{clear:wo,prop:Nr.define.bind(null,fh),context:Nr.define.bind(null,Yu),this:Nr.define.bind(null,cc),draw:Aa({}),buffer:function(Zn){return kr.create(Zn,Gh,!1,!1)},elements:function(Zn){return Hr.create(Zn,!1)},texture:Ln.create2D,cube:Ln.createCube,renderbuffer:ar.create,framebuffer:lr.create,framebufferCube:lr.createCube,vao:yr.createVAO,attributes:Ut,frame:po,on:Vi,limits:Yt,hasExtension:function(Zn){return Yt.extensions.indexOf(Zn.toLowerCase())>=0},read:Qr,destroy:Po,_gl:Oe,_refresh:li,poll:function(){Ua(),Ir&&Ir.update()},now:mo,stats:_r});return ie.onDone(null,Mo),Mo}return xf})},6158:function(ci){(function(mn,ot){ci.exports=ot()})(this,function(){"use strict";var mn,ot,vt;function Ze(l,Vt){if(!mn)mn=Vt;else if(!ot)ot=Vt;else{var ge="var sharedChunk = {}; ("+mn+")(sharedChunk); ("+ot+")(sharedChunk);",Mt={};mn(Mt),vt=Vt(Mt),typeof window!="undefined"&&(vt.workerUrl=window.URL.createObjectURL(new Blob([ge],{type:"text/javascript"})))}}return Ze(["exports"],function(l){"use strict";function Vt(e,t){return e(t={exports:{}},t.exports),t.exports}var ge=Mt;function Mt(e,t,r,s){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(s-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=s,this.p2x=r,this.p2y=s}Mt.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},Mt.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},Mt.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},Mt.prototype.solveCurveX=function(e,t){var r,s,u,h,p;for(t===void 0&&(t=1e-6),u=e,p=0;p<8;p++){if(h=this.sampleCurveX(u)-e,Math.abs(h)<t)return u;var y=this.sampleCurveDerivativeX(u);if(Math.abs(y)<1e-6)break;u-=h/y}if((u=e)<(r=0))return r;if(u>(s=1))return s;for(;r<s;){if(h=this.sampleCurveX(u),Math.abs(h-e)<t)return u;e>h?r=u:s=u,u=.5*(s-r)+r}return u},Mt.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var Le=Tt;function Tt(e,t){this.x=e,this.y=t}Tt.prototype={clone:function(){return new Tt(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),s=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=s,this},_rotateAround:function(e,t){var r=Math.cos(e),s=Math.sin(e),u=t.y+s*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-s*(this.y-t.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Tt.convert=function(e){return e instanceof Tt?e:Array.isArray(e)?new Tt(e[0],e[1]):e};var Fe=typeof self!="undefined"?self:{},dt=Math.pow(2,53)-1;function nr(e,t,r,s){var u=new ge(e,t,r,s);return function(h){return u.solve(h)}}var dr=nr(.25,.1,.25,1);function Dt(e,t,r){return Math.min(r,Math.max(t,e))}function Er(e,t,r){var s=r-t,u=((e-t)%s+s)%s+t;return u===t?r:u}function wt(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var s=0,u=t;s<u.length;s+=1){var h=u[s];for(var p in h)e[p]=h[p]}return e}var fr=1;function Et(){return fr++}function vr(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function kt(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function mt(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function k(e,t){return e.indexOf(t,e.length-t.length)!==-1}function Te(e,t,r){var s={};for(var u in e)s[u]=t.call(r||this,e[u],u,e);return s}function Se(e,t,r){var s={};for(var u in e)t.call(r||this,e[u],u,e)&&(s[u]=e[u]);return s}function me(e){return Array.isArray(e)?e.map(me):typeof e=="object"&&e?Te(e,me):e}var De={};function we(e){De[e]||(typeof console!="undefined"&&console.warn(e),De[e]=!0)}function ze(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function Qt(e){for(var t=0,r=0,s=e.length,u=s-1,h=void 0,p=void 0;r<s;u=r++)t+=((p=e[u]).x-(h=e[r]).x)*(h.y+p.y);return t}function V(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function pe(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(s,u,h,p){var y=h||p;return t[u]=!y||y.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var P=null;function U(e){if(P==null){var t=e.navigator?e.navigator.userAgent:null;P=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return P}function B(e){try{var t=Fe[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var E,D,q,Q,Ae=Fe.performance&&Fe.performance.now?Fe.performance.now.bind(Fe.performance):Date.now.bind(Date),ct=Fe.requestAnimationFrame||Fe.mozRequestAnimationFrame||Fe.webkitRequestAnimationFrame||Fe.msRequestAnimationFrame,ke=Fe.cancelAnimationFrame||Fe.mozCancelAnimationFrame||Fe.webkitCancelAnimationFrame||Fe.msCancelAnimationFrame,He={now:Ae,frame:function(e){var t=ct(e);return{cancel:function(){return ke(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var r=Fe.document.createElement("canvas"),s=r.getContext("2d");if(!s)throw new Error("failed to create canvas 2d context");return r.width=e.width,r.height=e.height,s.drawImage(e,0,0,e.width,e.height),s.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return E||(E=Fe.document.createElement("a")),E.href=e,E.href},hardwareConcurrency:Fe.navigator&&Fe.navigator.hardwareConcurrency||4,get devicePixelRatio(){return Fe.devicePixelRatio},get prefersReducedMotion(){return!!Fe.matchMedia&&(D==null&&(D=Fe.matchMedia("(prefers-reduced-motion: reduce)")),D.matches)}},We={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},xt={supported:!1,testSupport:function(e){!jt&&Q&&(Gt?Rt(e):q=e)}},jt=!1,Gt=!1;function Rt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Q),e.isContextLost())return;xt.supported=!0}catch(r){}e.deleteTexture(t),jt=!0}Fe.document&&((Q=Fe.document.createElement("img")).onload=function(){q&&Rt(q),q=null,Gt=!0},Q.onerror=function(){jt=!0,q=null},Q.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Ar="01",Gr=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function er(e){return e.indexOf("mapbox:")===0}Gr.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ar,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},Gr.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Gr.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},Gr.prototype.normalizeStyleURL=function(e,t){if(!er(e))return e;var r=Kt(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},Gr.prototype.normalizeGlyphsURL=function(e,t){if(!er(e))return e;var r=Kt(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},Gr.prototype.normalizeSourceURL=function(e,t){if(!er(e))return e;var r=Kt(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},Gr.prototype.normalizeSpriteURL=function(e,t,r,s){var u=Kt(e);return er(e)?(u.path="/styles/v1"+u.path+"/sprite"+t+r,this._makeAPIURL(u,this._customAccessToken||s)):(u.path+=""+t+r,ur(u))},Gr.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!er(e))return e;var r=Kt(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(He.devicePixelRatio>=2||t===512?"@2x":"")+(xt.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var s=this._customAccessToken||function(u){for(var h=0,p=u;h<p.length;h+=1){var y=p[h].match(/^access_token=(.*)$/);if(y)return y[1]}return null}(r.params)||We.ACCESS_TOKEN;return We.REQUIRE_ACCESS_TOKEN&&s&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,s)},Gr.prototype.canonicalizeTileURL=function(e,t){var r=Kt(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var s="mapbox://tiles/";s+=r.path.replace("/v4/","");var u=r.params;return t&&(u=u.filter(function(h){return!h.match(/^access_token=/)})),u.length&&(s+="?"+u.join("&")),s},Gr.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&er(t),s=[],u=0,h=e.tiles||[];u<h.length;u+=1){var p=h[u];rt(p)?s.push(this.canonicalizeTileURL(p,r)):s.push(p)}return s},Gr.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",s=Kt(We.API_URL);if(e.protocol=s.protocol,e.authority=s.authority,e.protocol==="http"){var u=e.params.indexOf("secure");u>=0&&e.params.splice(u,1)}if(s.path!=="/"&&(e.path=""+s.path+e.path),!We.REQUIRE_ACCESS_TOKEN)return ur(e);if(!(t=t||We.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(h){return h.indexOf("access_token")===-1}),e.params.push("access_token="+t),ur(e)};var $e=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function rt(e){return $e.test(e)}var Wt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Kt(e){var t=e.match(Wt);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function ur(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function ae(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(Fe.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(r){return null}}var z=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};z.prototype.getStorageKey=function(e){var t,r=ae(We.ACCESS_TOKEN);return t=r&&r.u?Fe.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(s,u){return String.fromCharCode(Number("0x"+u))})):We.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},z.prototype.fetchEventData=function(){var e=B("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var s=Fe.localStorage.getItem(t);s&&(this.eventData=JSON.parse(s));var u=Fe.localStorage.getItem(r);u&&(this.anonId=u)}catch(h){we("Unable to read from LocalStorage")}},z.prototype.saveEventData=function(){var e=B("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{Fe.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&Fe.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(s){we("Unable to write to LocalStorage")}},z.prototype.processRequests=function(e){},z.prototype.postEvent=function(e,t,r,s){var u=this;if(We.EVENTS_URL){var h=Kt(We.EVENTS_URL);h.params.push("access_token="+(s||We.ACCESS_TOKEN||""));var p={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:Ar,userId:this.anonId},y=t?wt(p,t):p,w={url:ur(h),headers:{"Content-Type":"text/plain"},body:JSON.stringify([y])};this.pendingRequest=Kn(w,function(A){u.pendingRequest=null,r(A),u.saveEventData(),u.processRequests(s)})}},z.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var R,j,b=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,s,u,h){this.skuToken=u,(We.EVENTS_URL&&h||We.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(p){return er(p)||rt(p)}))&&this.queueRequest({id:s,timestamp:Date.now()},h)},t.prototype.processRequests=function(r){var s=this;if(!this.pendingRequest&&this.queue.length!==0){var u=this.queue.shift(),h=u.id,p=u.timestamp;h&&this.success[h]||(this.anonId||this.fetchEventData(),kt(this.anonId)||(this.anonId=vr()),this.postEvent(p,{skuToken:this.skuToken},function(y){y||h&&(s.success[h]=!0)},r))}},t}(z),ce=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,s){We.EVENTS_URL&&We.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(u){return er(u)||rt(u)})&&this.queueRequest(Date.now(),s)},t.prototype.processRequests=function(r){var s=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var u=ae(We.ACCESS_TOKEN),h=u?u.u:We.ACCESS_TOKEN,p=h!==this.eventData.tokenU;kt(this.anonId)||(this.anonId=vr(),p=!0);var y=this.queue.shift();if(this.eventData.lastSuccess){var w=new Date(this.eventData.lastSuccess),A=new Date(y),M=(y-this.eventData.lastSuccess)/864e5;p=p||M>=1||M<-1||w.getDate()!==A.getDate()}else p=!0;if(!p)return this.processRequests();this.postEvent(y,{"enabled.telemetry":!1},function(O){O||(s.eventData.lastSuccess=y,s.eventData.tokenU=h)},r)}},t}(z)),Ye=ce.postTurnstileEvent.bind(ce),Pt=new b,te=Pt.postMapLoadEvent.bind(Pt),he=500,ve=50;function it(){Fe.caches&&!R&&(R=Fe.caches.open("mapbox-tiles"))}function at(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var fe,wr=1/0;function Dr(){return fe==null&&(fe=Fe.OffscreenCanvas&&new Fe.OffscreenCanvas(1,1).getContext("2d")&&typeof Fe.createImageBitmap=="function"),fe}var Nr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Nr);var yt=function(e){function t(r,s,u){s===401&&rt(u)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=s,this.url=u,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),jr=V()?function(){return self.worker&&self.worker.referrer}:function(){return(Fe.location.protocol==="blob:"?Fe.parent:Fe).location.href},Dn,ai,Mi=function(e,t){if(!(/^file:/.test(r=e.url)||/^file:/.test(jr())&&!/^\w+:/.test(r))){if(Fe.fetch&&Fe.Request&&Fe.AbortController&&Fe.Request.prototype.hasOwnProperty("signal"))return function(s,u){var h,p=new Fe.AbortController,y=new Fe.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:jr(),signal:p.signal}),w=!1,A=!1,M=(h=y.url).indexOf("sku=")>0&&rt(h);s.type==="json"&&y.headers.set("Accept","application/json");var O=function(X,Ee,Ie){if(!A){if(X&&X.message!=="SecurityError"&&we(X),Ee&&Ie)return Z(Ee);var Xe=Date.now();Fe.fetch(y).then(function(Be){if(Be.ok){var ut=M?Be.clone():null;return Z(Be,ut,Xe)}return u(new yt(Be.statusText,Be.status,s.url))}).catch(function(Be){Be.code!==20&&u(new Error(Be.message))})}},Z=function(X,Ee,Ie){(s.type==="arrayBuffer"?X.arrayBuffer():s.type==="json"?X.json():X.text()).then(function(Xe){A||(Ee&&Ie&&function(Be,ut,It){if(it(),R){var Ht={status:ut.status,statusText:ut.statusText,headers:new Fe.Headers};ut.headers.forEach(function(mr,Fr){return Ht.headers.set(Fr,mr)});var Jt=pe(ut.headers.get("Cache-Control")||"");Jt["no-store"]||(Jt["max-age"]&&Ht.headers.set("Expires",new Date(It+1e3*Jt["max-age"]).toUTCString()),new Date(Ht.headers.get("Expires")).getTime()-It<42e4||function(mr,Fr){if(j===void 0)try{new Response(new ReadableStream),j=!0}catch(tn){j=!1}j?Fr(mr.body):mr.blob().then(Fr)}(ut,function(mr){var Fr=new Fe.Response(mr,Ht);it(),R&&R.then(function(tn){return tn.put(at(Be.url),Fr)}).catch(function(tn){return we(tn.message)})}))}}(y,Ee,Ie),w=!0,u(null,Xe,X.headers.get("Cache-Control"),X.headers.get("Expires")))}).catch(function(Xe){A||u(new Error(Xe.message))})};return M?function(X,Ee){if(it(),!R)return Ee(null);var Ie=at(X.url);R.then(function(Xe){Xe.match(Ie).then(function(Be){var ut=function(It){if(!It)return!1;var Ht=new Date(It.headers.get("Expires")||0),Jt=pe(It.headers.get("Cache-Control")||"");return Ht>Date.now()&&!Jt["no-cache"]}(Be);Xe.delete(Ie),ut&&Xe.put(Ie,Be.clone()),Ee(null,Be,ut)}).catch(Ee)}).catch(Ee)}(y,O):O(null,null),{cancel:function(){A=!0,w||p.abort()}}}(e,t);if(V()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var r;return function(s,u){var h=new Fe.XMLHttpRequest;for(var p in h.open(s.method||"GET",s.url,!0),s.type==="arrayBuffer"&&(h.responseType="arraybuffer"),s.headers)h.setRequestHeader(p,s.headers[p]);return s.type==="json"&&(h.responseType="text",h.setRequestHeader("Accept","application/json")),h.withCredentials=s.credentials==="include",h.onerror=function(){u(new Error(h.statusText))},h.onload=function(){if((h.status>=200&&h.status<300||h.status===0)&&h.response!==null){var y=h.response;if(s.type==="json")try{y=JSON.parse(h.response)}catch(w){return u(w)}u(null,y,h.getResponseHeader("Cache-Control"),h.getResponseHeader("Expires"))}else u(new yt(h.statusText,h.status,s.url))},h.send(s.body),{cancel:function(){return h.abort()}}}(e,t)},Li=function(e,t){return Mi(wt(e,{type:"arrayBuffer"}),t)},Kn=function(e,t){return Mi(wt(e,{method:"POST"}),t)},L="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Dn=[],ai=0;var N=function(e,t){if(xt.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),ai>=We.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return Dn.push(r),r}ai++;var s=!1,u=function(){if(!s)for(s=!0,ai--;Dn.length&&ai<We.MAX_PARALLEL_IMAGE_REQUESTS;){var p=Dn.shift();p.cancelled||(p.cancel=N(p.requestParameters,p.callback).cancel)}},h=Li(e,function(p,y,w,A){u(),p?t(p):y&&(Dr()?function(M,O){var Z=new Fe.Blob([new Uint8Array(M)],{type:"image/png"});Fe.createImageBitmap(Z).then(function(X){O(null,X)}).catch(function(X){O(new Error("Could not load image because of "+X.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(y,t):function(M,O,Z,X){var Ee=new Fe.Image,Ie=Fe.URL;Ee.onload=function(){O(null,Ee),Ie.revokeObjectURL(Ee.src),Ee.onload=null,Fe.requestAnimationFrame(function(){Ee.src=L})},Ee.onerror=function(){return O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Xe=new Fe.Blob([new Uint8Array(M)],{type:"image/png"});Ee.cacheControl=Z,Ee.expires=X,Ee.src=M.byteLength?Ie.createObjectURL(Xe):L}(y,t,w,A))});return{cancel:function(){h.cancel(),u()}}};function H(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function ne(e,t,r){if(r&&r[e]){var s=r[e].indexOf(t);s!==-1&&r[e].splice(s,1)}}var xe=function(e,t){t===void 0&&(t={}),wt(this,t),this.type=e},Ne=function(e){function t(r,s){s===void 0&&(s={}),e.call(this,"error",wt({error:r},s))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(xe),Qe=function(){};Qe.prototype.on=function(e,t){return this._listeners=this._listeners||{},H(e,t,this._listeners),this},Qe.prototype.off=function(e,t){return ne(e,t,this._listeners),ne(e,t,this._oneTimeListeners),this},Qe.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},H(e,t,this._oneTimeListeners),this},Qe.prototype.fire=function(e,t){typeof e=="string"&&(e=new xe(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var s=0,u=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];s<u.length;s+=1)u[s].call(this,e);for(var h=0,p=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];h<p.length;h+=1){var y=p[h];ne(r,y,this._oneTimeListeners),y.call(this,e)}var w=this._eventedParent;w&&(wt(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(e))}else e instanceof Ne&&console.error(e.error);return this},Qe.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Qe.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var J={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Me=function(e,t,r,s){this.message=(e?e+": ":"")+r,s&&(this.identifier=s),t!=null&&t.__line__&&(this.line=t.__line__)};function bt(e){var t=e.value;return t?[new Me(e.key,t,"constants have been deprecated as of v8")]:[]}function gr(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var s=0,u=t;s<u.length;s+=1){var h=u[s];for(var p in h)e[p]=h[p]}return e}function zt(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Nt(e){if(Array.isArray(e))return e.map(Nt);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=Nt(e[r]);return t}return zt(e)}var br=function(e){function t(r,s){e.call(this,s),this.message=s,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),vn=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var r=0,s=t;r<s.length;r+=1){var u=s[r];this.bindings[u[0]]=u[1]}};vn.prototype.concat=function(e){return new vn(this,e)},vn.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},vn.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var cn={kind:"null"},Lt={kind:"number"},on={kind:"string"},qr={kind:"boolean"},Yr={kind:"color"},$n={kind:"object"},$r={kind:"value"},hi={kind:"collator"},Oi={kind:"formatted"},Qn={kind:"resolvedImage"};function fi(e,t){return{kind:"array",itemType:e,N:t}}function ei(e){if(e.kind==="array"){var t=ei(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var zn=[cn,Lt,on,qr,Yr,Oi,$n,fi($r),Qn];function Wn(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Wn(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var r=0,s=zn;r<s.length;r+=1)if(!Wn(s[r],t))return null}}return"Expected "+ei(e)+" but found "+ei(t)+" instead."}function Qi(e,t){return t.some(function(r){return r.kind===e.kind})}function _i(e,t){return t.some(function(r){return r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e})}var di=Vt(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function s(y){return(y=Math.round(y))<0?0:y>255?255:y}function u(y){return s(y[y.length-1]==="%"?parseFloat(y)/100*255:parseInt(y))}function h(y){return(w=y[y.length-1]==="%"?parseFloat(y)/100:parseFloat(y))<0?0:w>1?1:w;var w}function p(y,w,A){return A<0?A+=1:A>1&&(A-=1),6*A<1?y+(w-y)*A*6:2*A<1?w:3*A<2?y+(w-y)*(2/3-A)*6:y}try{t.parseCSSColor=function(y){var w,A=y.replace(/ /g,"").toLowerCase();if(A in r)return r[A].slice();if(A[0]==="#")return A.length===4?(w=parseInt(A.substr(1),16))>=0&&w<=4095?[(3840&w)>>4|(3840&w)>>8,240&w|(240&w)>>4,15&w|(15&w)<<4,1]:null:A.length===7&&(w=parseInt(A.substr(1),16))>=0&&w<=16777215?[(16711680&w)>>16,(65280&w)>>8,255&w,1]:null;var M=A.indexOf("("),O=A.indexOf(")");if(M!==-1&&O+1===A.length){var Z=A.substr(0,M),X=A.substr(M+1,O-(M+1)).split(","),Ee=1;switch(Z){case"rgba":if(X.length!==4)return null;Ee=h(X.pop());case"rgb":return X.length!==3?null:[u(X[0]),u(X[1]),u(X[2]),Ee];case"hsla":if(X.length!==4)return null;Ee=h(X.pop());case"hsl":if(X.length!==3)return null;var Ie=(parseFloat(X[0])%360+360)%360/360,Xe=h(X[1]),Be=h(X[2]),ut=Be<=.5?Be*(Xe+1):Be+Xe-Be*Xe,It=2*Be-ut;return[s(255*p(It,ut,Ie+1/3)),s(255*p(It,ut,Ie)),s(255*p(It,ut,Ie-1/3)),Ee];default:return null}}return null}}catch(y){}}).parseCSSColor,vi=function(e,t,r,s){s===void 0&&(s=1),this.r=e,this.g=t,this.b=r,this.a=s};vi.parse=function(e){if(e){if(e instanceof vi)return e;if(typeof e=="string"){var t=di(e);if(t)return new vi(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},vi.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],s=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+s+")"},vi.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},vi.black=new vi(0,0,0,1),vi.white=new vi(1,1,1,1),vi.transparent=new vi(0,0,0,0),vi.red=new vi(1,0,0,1);var oa=function(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};oa.prototype.compare=function(e,t){return this.collator.compare(e,t)},oa.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ns=function(e,t,r,s,u){this.text=e,this.image=t,this.scale=r,this.fontStack=s,this.textColor=u},ea=function(e){this.sections=e};ea.fromString=function(e){return new ea([new ns(e,null,null,null,null)])},ea.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},ea.factory=function(e){return e instanceof ea?e:ea.fromString(e)},ea.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},ea.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var s=r[t];if(s.image)e.push(["image",s.image.name]);else{e.push(s.text);var u={};s.fontStack&&(u["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(u["font-scale"]=s.scale),s.textColor&&(u["text-color"]=["rgba"].concat(s.textColor.toArray())),e.push(u)}}return e};var zi=function(e){this.name=e.name,this.available=e.available};function yo(e,t,r,s){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:"Invalid rgba value ["+[e,t,r,s].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof s=="number"?[e,t,r,s]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function $a(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof vi||e instanceof oa||e instanceof ea||e instanceof zi)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!$a(r[t]))return!1;return!0}if(typeof e=="object"){for(var s in e)if(!$a(e[s]))return!1;return!0}return!1}function Di(e){if(e===null)return cn;if(typeof e=="string")return on;if(typeof e=="boolean")return qr;if(typeof e=="number")return Lt;if(e instanceof vi)return Yr;if(e instanceof oa)return hi;if(e instanceof ea)return Oi;if(e instanceof zi)return Qn;if(Array.isArray(e)){for(var t,r=e.length,s=0,u=e;s<u.length;s+=1){var h=Di(u[s]);if(t){if(t===h)continue;t=$r;break}t=h}return fi(t||$r,r)}return $n}function So(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof vi||e instanceof ea||e instanceof zi?e.toString():JSON.stringify(e)}zi.prototype.toString=function(){return this.name},zi.fromString=function(e){return e?new zi({name:e,available:!1}):null},zi.prototype.serialize=function(){return["image",this.name]};var ya=function(e,t){this.type=e,this.value=t};ya.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!$a(e[1]))return t.error("invalid value");var r=e[1],s=Di(r),u=t.expectedType;return s.kind!=="array"||s.N!==0||!u||u.kind!=="array"||typeof u.N=="number"&&u.N!==0||(s=u),new ya(s,r)},ya.prototype.evaluate=function(){return this.value},ya.prototype.eachChild=function(){},ya.prototype.outputDefined=function(){return!0},ya.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof vi?["rgba"].concat(this.value.toArray()):this.value instanceof ea?this.value.serialize():this.value};var na=function(e){this.name="ExpressionEvaluationError",this.message=e};na.prototype.toJSON=function(){return this.message};var ga={string:on,number:Lt,boolean:qr,object:$n},Bi=function(e,t){this.type=e,this.args=t};Bi.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,s=1,u=e[0];if(u==="array"){var h,p;if(e.length>2){var y=e[1];if(typeof y!="string"||!(y in ga)||y==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);h=ga[y],s++}else h=$r;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);p=e[2],s++}r=fi(h,p)}else r=ga[u];for(var w=[];s<e.length;s++){var A=t.parse(e[s],s,$r);if(!A)return null;w.push(A)}return new Bi(r,w)},Bi.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!Wn(this.type,Di(r)))return r;if(t===this.args.length-1)throw new na("Expected value to be of type "+ei(this.type)+", but found "+ei(Di(r))+" instead.")}return null},Bi.prototype.eachChild=function(e){this.args.forEach(e)},Bi.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Bi.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var r=e.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){t.push(r.kind);var s=e.N;(typeof s=="number"||this.args.length>1)&&t.push(s)}}return t.concat(this.args.map(function(u){return u.serialize()}))};var wa=function(e){this.type=Oi,this.sections=e};wa.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");for(var s=[],u=!1,h=1;h<=e.length-1;++h){var p=e[h];if(u&&typeof p=="object"&&!Array.isArray(p)){u=!1;var y=null;if(p["font-scale"]&&!(y=t.parse(p["font-scale"],1,Lt)))return null;var w=null;if(p["text-font"]&&!(w=t.parse(p["text-font"],1,fi(on))))return null;var A=null;if(p["text-color"]&&!(A=t.parse(p["text-color"],1,Yr)))return null;var M=s[s.length-1];M.scale=y,M.font=w,M.textColor=A}else{var O=t.parse(e[h],1,$r);if(!O)return null;var Z=O.type.kind;if(Z!=="string"&&Z!=="value"&&Z!=="null"&&Z!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");u=!0,s.push({content:O,scale:null,font:null,textColor:null})}}return new wa(s)},wa.prototype.evaluate=function(e){return new ea(this.sections.map(function(t){var r=t.content.evaluate(e);return Di(r)===Qn?new ns("",r,null,null,null):new ns(So(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},wa.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var s=r[t];e(s.content),s.scale&&e(s.scale),s.font&&e(s.font),s.textColor&&e(s.textColor)}},wa.prototype.outputDefined=function(){return!1},wa.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var s=r[t];e.push(s.content.serialize());var u={};s.scale&&(u["font-scale"]=s.scale.serialize()),s.font&&(u["text-font"]=s.font.serialize()),s.textColor&&(u["text-color"]=s.textColor.serialize()),e.push(u)}return e};var Qa=function(e){this.type=Qn,this.input=e};Qa.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var r=t.parse(e[1],1,on);return r?new Qa(r):t.error("No image name provided.")},Qa.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=zi.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},Qa.prototype.eachChild=function(e){e(this.input)},Qa.prototype.outputDefined=function(){return!1},Qa.prototype.serialize=function(){return["image",this.input.serialize()]};var _s={"to-boolean":qr,"to-color":Yr,"to-number":Lt,"to-string":on},Ga=function(e,t){this.type=e,this.args=t};Ga.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var s=_s[r],u=[],h=1;h<e.length;h++){var p=t.parse(e[h],h,$r);if(!p)return null;u.push(p)}return new Ga(s,u)},Ga.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,r,s=0,u=this.args;s<u.length;s+=1){if(r=null,(t=u[s].evaluate(e))instanceof vi)return t;if(typeof t=="string"){var h=e.parseColor(t);if(h)return h}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":yo(t[0],t[1],t[2],t[3])))return new vi(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new na(r||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var p=null,y=0,w=this.args;y<w.length;y+=1){if((p=w[y].evaluate(e))===null)return 0;var A=Number(p);if(!isNaN(A))return A}throw new na("Could not convert "+JSON.stringify(p)+" to number.")}return this.type.kind==="formatted"?ea.fromString(So(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?zi.fromString(So(this.args[0].evaluate(e))):So(this.args[0].evaluate(e))},Ga.prototype.eachChild=function(e){this.args.forEach(e)},Ga.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ga.prototype.serialize=function(){if(this.type.kind==="formatted")return new wa([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Qa(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var eo=["Unknown","Point","LineString","Polygon"],Hi=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Hi.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Hi.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?eo[this.feature.type]:this.feature.type:null},Hi.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Hi.prototype.canonicalID=function(){return this.canonical},Hi.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Hi.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=vi.parse(e)),t};var Pa=function(e,t,r,s){this.name=e,this.type=t,this._evaluate=r,this.args=s};Pa.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Pa.prototype.eachChild=function(e){this.args.forEach(e)},Pa.prototype.outputDefined=function(){return!1},Pa.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Pa.parse=function(e,t){var r,s=e[0],u=Pa.definitions[s];if(!u)return t.error('Unknown expression "'+s+'". If you wanted a literal array, use ["literal", [...]].',0);for(var h=Array.isArray(u)?u[0]:u.type,p=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,y=p.filter(function(On){var xn=On[0];return!Array.isArray(xn)||xn.length===e.length-1}),w=null,A=0,M=y;A<M.length;A+=1){var O=M[A],Z=O[0],X=O[1];w=new Ho(t.registry,t.path,null,t.scope);for(var Ee=[],Ie=!1,Xe=1;Xe<e.length;Xe++){var Be=e[Xe],ut=Array.isArray(Z)?Z[Xe-1]:Z.type,It=w.parse(Be,1+Ee.length,ut);if(!It){Ie=!0;break}Ee.push(It)}if(!Ie)if(Array.isArray(Z)&&Z.length!==Ee.length)w.error("Expected "+Z.length+" arguments, but found "+Ee.length+" instead.");else{for(var Ht=0;Ht<Ee.length;Ht++){var Jt=Array.isArray(Z)?Z[Ht]:Z.type,mr=Ee[Ht];w.concat(Ht+1).checkSubtype(Jt,mr.type)}if(w.errors.length===0)return new Pa(s,h,X,Ee)}}if(y.length===1)(r=t.errors).push.apply(r,w.errors);else{for(var Fr=(y.length?y:p).map(function(On){var xn;return xn=On[0],Array.isArray(xn)?"("+xn.map(ei).join(", ")+")":"("+ei(xn.type)+"...)"}).join(" | "),tn=[],kn=1;kn<e.length;kn++){var yn=t.parse(e[kn],1+tn.length);if(!yn)return null;tn.push(ei(yn.type))}t.error("Expected arguments of type "+Fr+", but found ("+tn.join(", ")+") instead.")}return null},Pa.register=function(e,t){for(var r in Pa.definitions=t,t)e[r]=Pa};var go=function(e,t,r){this.type=hi,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t};function Ma(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function ls(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function ou(e,t){var r=(180+e[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,u=Math.pow(2,t.z);return[Math.round(r*u*8192),Math.round(s*u*8192)]}function _o(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function W(e,t){for(var r,s,u,h,p,y,w,A=!1,M=0,O=t.length;M<O;M++)for(var Z=t[M],X=0,Ee=Z.length;X<Ee-1;X++){if((h=(r=e)[0]-(s=Z[X])[0])*(w=r[1]-(u=Z[X+1])[1])-(y=r[0]-u[0])*(p=r[1]-s[1])==0&&h*y<=0&&p*w<=0)return!1;_o(e,Z[X],Z[X+1])&&(A=!A)}return A}function ue(e,t){for(var r=0;r<t.length;r++)if(W(e,t[r]))return!0;return!1}function Je(e,t,r,s){var u=s[0]-r[0],h=s[1]-r[1],p=(e[0]-r[0])*h-u*(e[1]-r[1]),y=(t[0]-r[0])*h-u*(t[1]-r[1]);return p>0&&y<0||p<0&&y>0}function Ft(e,t,r){for(var s=0,u=r;s<u.length;s+=1)for(var h=u[s],p=0;p<h.length-1;++p)if((O=[(M=h[p+1])[0]-(A=h[p])[0],M[1]-A[1]])[0]*(Z=[(w=t)[0]-(y=e)[0],w[1]-y[1]])[1]-O[1]*Z[0]!=0&&Je(y,w,A,M)&&Je(A,M,y,w))return!0;var y,w,A,M,O,Z;return!1}function Rr(e,t){for(var r=0;r<e.length;++r)if(!W(e[r],t))return!1;for(var s=0;s<e.length-1;++s)if(Ft(e[s],e[s+1],t))return!1;return!0}function An(e,t){for(var r=0;r<t.length;r++)if(Rr(e,t[r]))return!0;return!1}function mi(e,t,r){for(var s=[],u=0;u<e.length;u++){for(var h=[],p=0;p<e[u].length;p++){var y=ou(e[u][p],r);Ma(t,y),h.push(y)}s.push(h)}return s}function _a(e,t,r){for(var s=[],u=0;u<e.length;u++){var h=mi(e[u],t,r);s.push(h)}return s}function sa(e,t,r,s){if(e[0]<r[0]||e[0]>r[2]){var u=.5*s,h=e[0]-r[0]>u?-s:r[0]-e[0]>u?s:0;h===0&&(h=e[0]-r[2]>u?-s:r[2]-e[0]>u?s:0),e[0]+=h}Ma(t,e)}function xa(e,t,r,s){for(var u=8192*Math.pow(2,s.z),h=[8192*s.x,8192*s.y],p=[],y=0,w=e;y<w.length;y+=1)for(var A=0,M=w[y];A<M.length;A+=1){var O=M[A],Z=[O.x+h[0],O.y+h[1]];sa(Z,t,r,u),p.push(Z)}return p}function Fa(e,t,r,s){for(var u,h=8192*Math.pow(2,s.z),p=[8192*s.x,8192*s.y],y=[],w=0,A=e;w<A.length;w+=1){for(var M=[],O=0,Z=A[w];O<Z.length;O+=1){var X=Z[O],Ee=[X.x+p[0],X.y+p[1]];Ma(t,Ee),M.push(Ee)}y.push(M)}if(t[2]-t[0]<=h/2){(u=t)[0]=u[1]=1/0,u[2]=u[3]=-1/0;for(var Ie=0,Xe=y;Ie<Xe.length;Ie+=1)for(var Be=0,ut=Xe[Ie];Be<ut.length;Be+=1)sa(ut[Be],t,r,h)}return y}go.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");var s=t.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,qr);if(!s)return null;var u=t.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,qr);if(!u)return null;var h=null;return r.locale&&!(h=t.parse(r.locale,1,on))?null:new go(s,u,h)},go.prototype.evaluate=function(e){return new oa(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},go.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},go.prototype.outputDefined=function(){return!1},go.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var To=function(e,t){this.type=qr,this.geojson=e,this.geometries=t};function so(e){if(e instanceof Pa&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof To)return!1;var t=!0;return e.eachChild(function(r){t&&!so(r)&&(t=!1)}),t}function za(e){if(e instanceof Pa&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(r){t&&!za(r)&&(t=!1)}),t}function xo(e,t){if(e instanceof Pa&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(s){r&&!xo(s,t)&&(r=!1)}),r}To.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if($a(e[1])){var r=e[1];if(r.type==="FeatureCollection")for(var s=0;s<r.features.length;++s){var u=r.features[s].geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new To(r,r.features[s].geometry)}else if(r.type==="Feature"){var h=r.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new To(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new To(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},To.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,r){var s=[1/0,1/0,-1/0,-1/0],u=[1/0,1/0,-1/0,-1/0],h=t.canonicalID();if(r.type==="Polygon"){var p=mi(r.coordinates,u,h),y=xa(t.geometry(),s,u,h);if(!ls(s,u))return!1;for(var w=0,A=y;w<A.length;w+=1)if(!W(A[w],p))return!1}if(r.type==="MultiPolygon"){var M=_a(r.coordinates,u,h),O=xa(t.geometry(),s,u,h);if(!ls(s,u))return!1;for(var Z=0,X=O;Z<X.length;Z+=1)if(!ue(X[Z],M))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,r){var s=[1/0,1/0,-1/0,-1/0],u=[1/0,1/0,-1/0,-1/0],h=t.canonicalID();if(r.type==="Polygon"){var p=mi(r.coordinates,u,h),y=Fa(t.geometry(),s,u,h);if(!ls(s,u))return!1;for(var w=0,A=y;w<A.length;w+=1)if(!Rr(A[w],p))return!1}if(r.type==="MultiPolygon"){var M=_a(r.coordinates,u,h),O=Fa(t.geometry(),s,u,h);if(!ls(s,u))return!1;for(var Z=0,X=O;Z<X.length;Z+=1)if(!An(X[Z],M))return!1}return!0}(e,this.geometries)}return!1},To.prototype.eachChild=function(){},To.prototype.outputDefined=function(){return!0},To.prototype.serialize=function(){return["within",this.geojson]};var uo=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};uo.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new uo(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},uo.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},uo.prototype.eachChild=function(){},uo.prototype.outputDefined=function(){return!1},uo.prototype.serialize=function(){return["var",this.name]};var Ho=function(e,t,r,s,u){t===void 0&&(t=[]),s===void 0&&(s=new vn),u===void 0&&(u=[]),this.registry=e,this.path=t,this.key=t.map(function(h){return"["+h+"]"}).join(""),this.scope=s,this.errors=u,this.expectedType=r};function is(e,t){for(var r,s=e.length-1,u=0,h=s,p=0;u<=h;)if((r=e[p=Math.floor((u+h)/2)])<=t){if(p===s||t<e[p+1])return p;u=p+1}else{if(!(r>t))throw new na("Input is not a number.");h=p-1}return 0}Ho.prototype.parse=function(e,t,r,s,u){return u===void 0&&(u={}),t?this.concat(t,r,s)._parse(e,u):this._parse(e,u)},Ho.prototype._parse=function(e,t){function r(A,M,O){return O==="assert"?new Bi(M,[A]):O==="coerce"?new Ga(M,[A]):A}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var s=e[0];if(typeof s!="string")return this.error("Expression name must be a string, but found "+typeof s+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var u=this.registry[s];if(u){var h=u.parse(e,this);if(!h)return null;if(this.expectedType){var p=this.expectedType,y=h.type;if(p.kind!=="string"&&p.kind!=="number"&&p.kind!=="boolean"&&p.kind!=="object"&&p.kind!=="array"||y.kind!=="value")if(p.kind!=="color"&&p.kind!=="formatted"&&p.kind!=="resolvedImage"||y.kind!=="value"&&y.kind!=="string"){if(this.checkSubtype(p,y))return null}else h=r(h,p,t.typeAnnotation||"coerce");else h=r(h,p,t.typeAnnotation||"assert")}if(!(h instanceof ya)&&h.type.kind!=="resolvedImage"&&function A(M){if(M instanceof uo)return A(M.boundExpression);if(M instanceof Pa&&M.name==="error"||M instanceof go||M instanceof To)return!1;var O=M instanceof Ga||M instanceof Bi,Z=!0;return M.eachChild(function(X){Z=O?Z&&A(X):Z&&X instanceof ya}),!!Z&&so(M)&&xo(M,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(h)){var w=new Hi;try{h=new ya(h.type,h.evaluate(w))}catch(A){return this.error(A.message),null}}return h}return this.error('Unknown expression "'+s+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Ho.prototype.concat=function(e,t,r){var s=typeof e=="number"?this.path.concat(e):this.path,u=r?this.scope.concat(r):this.scope;return new Ho(this.registry,s,t||null,u,this.errors)},Ho.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var s=""+this.key+t.map(function(u){return"["+u+"]"}).join("");this.errors.push(new br(s,e))},Ho.prototype.checkSubtype=function(e,t){var r=Wn(e,t);return r&&this.error(r),r};var ja=function(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var s=0,u=r;s<u.length;s+=1){var h=u[s],p=h[1];this.labels.push(h[0]),this.outputs.push(p)}};function Wi(e,t,r){return e*(1-r)+t*r}ja.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,Lt);if(!r)return null;var s=[],u=null;t.expectedType&&t.expectedType.kind!=="value"&&(u=t.expectedType);for(var h=1;h<e.length;h+=2){var p=h===1?-1/0:e[h],y=e[h+1],w=h,A=h+1;if(typeof p!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',w);if(s.length&&s[s.length-1][0]>=p)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',w);var M=t.parse(y,A,u);if(!M)return null;u=u||M.type,s.push([p,M])}return new ja(u,r,s)},ja.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var s=this.input.evaluate(e);if(s<=t[0])return r[0].evaluate(e);var u=t.length;return s>=t[u-1]?r[u-1].evaluate(e):r[is(t,s)].evaluate(e)},ja.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},ja.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},ja.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var qa=Object.freeze({__proto__:null,number:Wi,color:function(e,t,r){return new vi(Wi(e.r,t.r,r),Wi(e.g,t.g,r),Wi(e.b,t.b,r),Wi(e.a,t.a,r))},array:function(e,t,r){return e.map(function(s,u){return Wi(s,t[u],r)})}}),Bu=6/29*3*(6/29),Ju=Math.PI/180,su=180/Math.PI;function $u(e){return e>.008856451679035631?Math.pow(e,1/3):e/Bu+4/29}function wu(e){return e>6/29?e*e*e:Bu*(e-4/29)}function uu(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function cs(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Us(e){var t=cs(e.r),r=cs(e.g),s=cs(e.b),u=$u((.4124564*t+.3575761*r+.1804375*s)/.95047),h=$u((.2126729*t+.7151522*r+.072175*s)/1);return{l:116*h-16,a:500*(u-h),b:200*(h-$u((.0193339*t+.119192*r+.9503041*s)/1.08883)),alpha:e.a}}function c(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,s=isNaN(e.b)?t:t-e.b/200;return t=1*wu(t),r=.95047*wu(r),s=1.08883*wu(s),new vi(uu(3.2404542*r-1.5371385*t-.4985314*s),uu(-.969266*r+1.8760108*t+.041556*s),uu(.0556434*r-.2040259*t+1.0572252*s),e.alpha)}function m(e,t,r){var s=t-e;return e+r*(s>180||s<-180?s-360*Math.round(s/360):s)}var S={forward:Us,reverse:c,interpolate:function(e,t,r){return{l:Wi(e.l,t.l,r),a:Wi(e.a,t.a,r),b:Wi(e.b,t.b,r),alpha:Wi(e.alpha,t.alpha,r)}}},_={forward:function(e){var t=Us(e),r=t.l,s=t.a,u=t.b,h=Math.atan2(u,s)*su;return{h:h<0?h+360:h,c:Math.sqrt(s*s+u*u),l:r,alpha:e.a}},reverse:function(e){var t=e.h*Ju,r=e.c;return c({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:m(e.h,t.h,r),c:Wi(e.c,t.c,r),l:Wi(e.l,t.l,r),alpha:Wi(e.alpha,t.alpha,r)}}},G=Object.freeze({__proto__:null,lab:S,hcl:_}),oe=function(e,t,r,s,u){this.type=e,this.operator=t,this.interpolation=r,this.input=s,this.labels=[],this.outputs=[];for(var h=0,p=u;h<p.length;h+=1){var y=p[h],w=y[1];this.labels.push(y[0]),this.outputs.push(w)}};function je(e,t,r,s){var u=s-r,h=e-r;return u===0?0:t===1?h/u:(Math.pow(t,h)-1)/(Math.pow(t,u)-1)}oe.interpolationFactor=function(e,t,r,s){var u=0;if(e.name==="exponential")u=je(t,e.base,r,s);else if(e.name==="linear")u=je(t,1,r,s);else if(e.name==="cubic-bezier"){var h=e.controlPoints;u=new ge(h[0],h[1],h[2],h[3]).solve(je(t,1,r,s))}return u},oe.parse=function(e,t){var r=e[0],s=e[1],u=e[2],h=e.slice(3);if(!Array.isArray(s)||s.length===0)return t.error("Expected an interpolation type expression.",1);if(s[0]==="linear")s={name:"linear"};else if(s[0]==="exponential"){var p=s[1];if(typeof p!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);s={name:"exponential",base:p}}else{if(s[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(s[0]),1,0);var y=s.slice(1);if(y.length!==4||y.some(function(Xe){return typeof Xe!="number"||Xe<0||Xe>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);s={name:"cubic-bezier",controlPoints:y}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(u=t.parse(u,2,Lt)))return null;var w=[],A=null;r==="interpolate-hcl"||r==="interpolate-lab"?A=Yr:t.expectedType&&t.expectedType.kind!=="value"&&(A=t.expectedType);for(var M=0;M<h.length;M+=2){var O=h[M],Z=h[M+1],X=M+3,Ee=M+4;if(typeof O!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',X);if(w.length&&w[w.length-1][0]>=O)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',X);var Ie=t.parse(Z,Ee,A);if(!Ie)return null;A=A||Ie.type,w.push([O,Ie])}return A.kind==="number"||A.kind==="color"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new oe(A,r,s,u,w):t.error("Type "+ei(A)+" is not interpolatable.")},oe.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var s=this.input.evaluate(e);if(s<=t[0])return r[0].evaluate(e);var u=t.length;if(s>=t[u-1])return r[u-1].evaluate(e);var h=is(t,s),p=oe.interpolationFactor(this.interpolation,s,t[h],t[h+1]),y=r[h].evaluate(e),w=r[h+1].evaluate(e);return this.operator==="interpolate"?qa[this.type.kind.toLowerCase()](y,w,p):this.operator==="interpolate-hcl"?_.reverse(_.interpolate(_.forward(y),_.forward(w),p)):S.reverse(S.interpolate(S.forward(y),S.forward(w),p))},oe.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},oe.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},oe.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var lt=function(e,t){this.type=e,this.args=t};lt.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,s=t.expectedType;s&&s.kind!=="value"&&(r=s);for(var u=[],h=0,p=e.slice(1);h<p.length;h+=1){var y=t.parse(p[h],1+u.length,r,void 0,{typeAnnotation:"omit"});if(!y)return null;r=r||y.type,u.push(y)}var w=s&&u.some(function(A){return Wn(s,A.type)});return new lt(w?$r:r,u)},lt.prototype.evaluate=function(e){for(var t,r=null,s=0,u=0,h=this.args;u<h.length&&(s++,(r=h[u].evaluate(e))&&r instanceof zi&&!r.available&&(t||(t=r.name),r=null,s===this.args.length&&(r=t)),r===null);u+=1);return r},lt.prototype.eachChild=function(e){this.args.forEach(e)},lt.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},lt.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var gt=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};gt.prototype.evaluate=function(e){return this.result.evaluate(e)},gt.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},gt.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],s=1;s<e.length-1;s+=2){var u=e[s];if(typeof u!="string")return t.error("Expected string, but found "+typeof u+" instead.",s);if(/[^a-zA-Z0-9_]/.test(u))return t.error("Variable names must contain only alphanumeric characters or '_'.",s);var h=t.parse(e[s+1],s+1);if(!h)return null;r.push([u,h])}var p=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return p?new gt(r,p):null},gt.prototype.outputDefined=function(){return this.result.outputDefined()},gt.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var s=r[t];e.push(s[0],s[1].serialize())}return e.push(this.result.serialize()),e};var hr=function(e,t,r){this.type=e,this.index=t,this.input=r};hr.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Lt),s=t.parse(e[2],2,fi(t.expectedType||$r));return r&&s?new hr(s.type.itemType,r,s):null},hr.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new na("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new na("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new na("Array index must be an integer, but found "+t+" instead.");return r[t]},hr.prototype.eachChild=function(e){e(this.index),e(this.input)},hr.prototype.outputDefined=function(){return!1},hr.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var cr=function(e,t){this.type=qr,this.needle=e,this.haystack=t};cr.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,$r),s=t.parse(e[2],2,$r);return r&&s?Qi(r.type,[qr,on,Lt,cn,$r])?new cr(r,s):t.error("Expected first argument to be of type boolean, string, number or null, but found "+ei(r.type)+" instead"):null},cr.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!_i(t,["boolean","string","number","null"]))throw new na("Expected first argument to be of type boolean, string, number or null, but found "+ei(Di(t))+" instead.");if(!_i(r,["string","array"]))throw new na("Expected second argument to be of type array or string, but found "+ei(Di(r))+" instead.");return r.indexOf(t)>=0},cr.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},cr.prototype.outputDefined=function(){return!0},cr.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Cn=function(e,t,r){this.type=Lt,this.needle=e,this.haystack=t,this.fromIndex=r};Cn.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,$r),s=t.parse(e[2],2,$r);if(!r||!s)return null;if(!Qi(r.type,[qr,on,Lt,cn,$r]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+ei(r.type)+" instead");if(e.length===4){var u=t.parse(e[3],3,Lt);return u?new Cn(r,s,u):null}return new Cn(r,s)},Cn.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!_i(t,["boolean","string","number","null"]))throw new na("Expected first argument to be of type boolean, string, number or null, but found "+ei(Di(t))+" instead.");if(!_i(r,["string","array"]))throw new na("Expected second argument to be of type array or string, but found "+ei(Di(r))+" instead.");if(this.fromIndex){var s=this.fromIndex.evaluate(e);return r.indexOf(t,s)}return r.indexOf(t)},Cn.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Cn.prototype.outputDefined=function(){return!1},Cn.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Xn=function(e,t,r,s,u,h){this.inputType=e,this.type=t,this.input=r,this.cases=s,this.outputs=u,this.otherwise=h};Xn.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,s;t.expectedType&&t.expectedType.kind!=="value"&&(s=t.expectedType);for(var u={},h=[],p=2;p<e.length-1;p+=2){var y=e[p],w=e[p+1];Array.isArray(y)||(y=[y]);var A=t.concat(p);if(y.length===0)return A.error("Expected at least one branch label.");for(var M=0,O=y;M<O.length;M+=1){var Z=O[M];if(typeof Z!="number"&&typeof Z!="string")return A.error("Branch labels must be numbers or strings.");if(typeof Z=="number"&&Math.abs(Z)>Number.MAX_SAFE_INTEGER)return A.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Z=="number"&&Math.floor(Z)!==Z)return A.error("Numeric branch labels must be integer values.");if(r){if(A.checkSubtype(r,Di(Z)))return null}else r=Di(Z);if(u[String(Z)]!==void 0)return A.error("Branch labels must be unique.");u[String(Z)]=h.length}var X=t.parse(w,p,s);if(!X)return null;s=s||X.type,h.push(X)}var Ee=t.parse(e[1],1,$r);if(!Ee)return null;var Ie=t.parse(e[e.length-1],e.length-1,s);return Ie?Ee.type.kind!=="value"&&t.concat(1).checkSubtype(r,Ee.type)?null:new Xn(r,s,Ee,u,h,Ie):null},Xn.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Di(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},Xn.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},Xn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},Xn.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],s={},u=0,h=Object.keys(this.cases).sort();u<h.length;u+=1){var p=h[u];(O=s[this.cases[p]])===void 0?(s[this.cases[p]]=r.length,r.push([this.cases[p],[p]])):r[O][1].push(p)}for(var y=function(X){return e.inputType.kind==="number"?Number(X):X},w=0,A=r;w<A.length;w+=1){var M=A[w],O=M[0],Z=M[1];t.push(Z.length===1?y(Z[0]):Z.map(y)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var sn=function(e,t,r){this.type=e,this.branches=t,this.otherwise=r};sn.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);for(var s=[],u=1;u<e.length-1;u+=2){var h=t.parse(e[u],u,qr);if(!h)return null;var p=t.parse(e[u+1],u+1,r);if(!p)return null;s.push([h,p]),r=r||p.type}var y=t.parse(e[e.length-1],e.length-1,r);return y?new sn(r,s,y):null},sn.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var s=r[t],u=s[1];if(s[0].evaluate(e))return u.evaluate(e)}return this.otherwise.evaluate(e)},sn.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var s=r[t],u=s[1];e(s[0]),e(u)}e(this.otherwise)},sn.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},sn.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ai=function(e,t,r,s){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=s};function Fi(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Gi(e,t,r,s){return s.compare(t,r)===0}function bi(e,t,r){var s=e!=="=="&&e!=="!=";return function(){function u(h,p,y){this.type=qr,this.lhs=h,this.rhs=p,this.collator=y,this.hasUntypedArgument=h.type.kind==="value"||p.type.kind==="value"}return u.parse=function(h,p){if(h.length!==3&&h.length!==4)return p.error("Expected two or three arguments.");var y=h[0],w=p.parse(h[1],1,$r);if(!w)return null;if(!Fi(y,w.type))return p.concat(1).error('"'+y+`" comparisons are not supported for type '`+ei(w.type)+"'.");var A=p.parse(h[2],2,$r);if(!A)return null;if(!Fi(y,A.type))return p.concat(2).error('"'+y+`" comparisons are not supported for type '`+ei(A.type)+"'.");if(w.type.kind!==A.type.kind&&w.type.kind!=="value"&&A.type.kind!=="value")return p.error("Cannot compare types '"+ei(w.type)+"' and '"+ei(A.type)+"'.");s&&(w.type.kind==="value"&&A.type.kind!=="value"?w=new Bi(A.type,[w]):w.type.kind!=="value"&&A.type.kind==="value"&&(A=new Bi(w.type,[A])));var M=null;if(h.length===4){if(w.type.kind!=="string"&&A.type.kind!=="string"&&w.type.kind!=="value"&&A.type.kind!=="value")return p.error("Cannot use collator to compare non-string types.");if(!(M=p.parse(h[3],3,hi)))return null}return new u(w,A,M)},u.prototype.evaluate=function(h){var p=this.lhs.evaluate(h),y=this.rhs.evaluate(h);if(s&&this.hasUntypedArgument){var w=Di(p),A=Di(y);if(w.kind!==A.kind||w.kind!=="string"&&w.kind!=="number")throw new na('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+w.kind+", "+A.kind+") instead.")}if(this.collator&&!s&&this.hasUntypedArgument){var M=Di(p),O=Di(y);if(M.kind!=="string"||O.kind!=="string")return t(h,p,y)}return this.collator?r(h,p,y,this.collator.evaluate(h)):t(h,p,y)},u.prototype.eachChild=function(h){h(this.lhs),h(this.rhs),this.collator&&h(this.collator)},u.prototype.outputDefined=function(){return!0},u.prototype.serialize=function(){var h=[e];return this.eachChild(function(p){h.push(p.serialize())}),h},u}()}Ai.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,$r),s=t.parse(e[2],2,Lt);if(!r||!s)return null;if(!Qi(r.type,[fi($r),on,$r]))return t.error("Expected first argument to be of type array or string, but found "+ei(r.type)+" instead");if(e.length===4){var u=t.parse(e[3],3,Lt);return u?new Ai(r.type,r,s,u):null}return new Ai(r.type,r,s)},Ai.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!_i(t,["string","array"]))throw new na("Expected first argument to be of type array or string, but found "+ei(Di(t))+" instead.");if(this.endIndex){var s=this.endIndex.evaluate(e);return t.slice(r,s)}return t.slice(r)},Ai.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Ai.prototype.outputDefined=function(){return!1},Ai.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Ao=bi("==",function(e,t,r){return t===r},Gi),hs=bi("!=",function(e,t,r){return t!==r},function(e,t,r,s){return!Gi(0,t,r,s)}),Gs=bi("<",function(e,t,r){return t<r},function(e,t,r,s){return s.compare(t,r)<0}),Qu=bi(">",function(e,t,r){return t>r},function(e,t,r,s){return s.compare(t,r)>0}),Ms=bi("<=",function(e,t,r){return t<=r},function(e,t,r,s){return s.compare(t,r)<=0}),Eu=bi(">=",function(e,t,r){return t>=r},function(e,t,r,s){return s.compare(t,r)>=0}),xs=function(e,t,r,s,u){this.type=on,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=s,this.maxFractionDigits=u};xs.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Lt);if(!r)return null;var s=e[2];if(typeof s!="object"||Array.isArray(s))return t.error("NumberFormat options argument must be an object.");var u=null;if(s.locale&&!(u=t.parse(s.locale,1,on)))return null;var h=null;if(s.currency&&!(h=t.parse(s.currency,1,on)))return null;var p=null;if(s["min-fraction-digits"]&&!(p=t.parse(s["min-fraction-digits"],1,Lt)))return null;var y=null;return s["max-fraction-digits"]&&!(y=t.parse(s["max-fraction-digits"],1,Lt))?null:new xs(r,u,h,p,y)},xs.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},xs.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},xs.prototype.outputDefined=function(){return!1},xs.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var bs=function(e){this.type=Lt,this.input=e};bs.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+ei(r.type)+" instead."):new bs(r):null},bs.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new na("Expected value to be of type string or array, but found "+ei(Di(t))+" instead.")},bs.prototype.eachChild=function(e){e(this.input)},bs.prototype.outputDefined=function(){return!1},bs.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var ws={"==":Ao,"!=":hs,">":Qu,"<":Gs,">=":Eu,"<=":Ms,array:Bi,at:hr,boolean:Bi,case:sn,coalesce:lt,collator:go,format:wa,image:Qa,in:cr,"index-of":Cn,interpolate:oe,"interpolate-hcl":oe,"interpolate-lab":oe,length:bs,let:gt,literal:ya,match:Xn,number:Bi,"number-format":xs,object:Bi,slice:Ai,step:ja,string:Bi,"to-boolean":Ga,"to-color":Ga,"to-number":Ga,"to-string":Ga,var:uo,within:To};function Ea(e,t){var r=t[0],s=t[1],u=t[2],h=t[3];r=r.evaluate(e),s=s.evaluate(e),u=u.evaluate(e);var p=h?h.evaluate(e):1,y=yo(r,s,u,p);if(y)throw new na(y);return new vi(r/255*p,s/255*p,u/255*p,p)}function kl(e,t){return e in t}function el(e,t){var r=t[e];return r===void 0?null:r}function Co(e){return{type:e}}function tl(e){return{result:"success",value:e}}function Es(e){return{result:"error",value:e}}function Wo(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function rl(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function js(e){return!!e.expression&&e.expression.interpolated}function Xi(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function qs(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Wl(e){return e}function Zs(e,t,r){return e!==void 0?e:t!==void 0?t:r!==void 0?r:void 0}function Pl(e,t,r,s,u){return Zs(typeof r===u?s[r]:void 0,e.default,t.default)}function Xl(e,t,r){if(Xi(r)!=="number")return Zs(e.default,t.default);var s=e.stops.length;if(s===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[s-1][0])return e.stops[s-1][1];var u=is(e.stops.map(function(h){return h[0]}),r);return e.stops[u][1]}function Yl(e,t,r){var s=e.base!==void 0?e.base:1;if(Xi(r)!=="number")return Zs(e.default,t.default);var u=e.stops.length;if(u===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[u-1][0])return e.stops[u-1][1];var h=is(e.stops.map(function(O){return O[0]}),r),p=function(O,Z,X,Ee){var Ie=Ee-X,Xe=O-X;return Ie===0?0:Z===1?Xe/Ie:(Math.pow(Z,Xe)-1)/(Math.pow(Z,Ie)-1)}(r,s,e.stops[h][0],e.stops[h+1][0]),y=e.stops[h][1],w=e.stops[h+1][1],A=qa[t.type]||Wl;if(e.colorSpace&&e.colorSpace!=="rgb"){var M=G[e.colorSpace];A=function(O,Z){return M.reverse(M.interpolate(M.forward(O),M.forward(Z),p))}}return typeof y.evaluate=="function"?{evaluate:function(){for(var O=[],Z=arguments.length;Z--;)O[Z]=arguments[Z];var X=y.evaluate.apply(void 0,O),Ee=w.evaluate.apply(void 0,O);if(X!==void 0&&Ee!==void 0)return A(X,Ee,p)}}:A(y,w,p)}function nl(e,t,r){return t.type==="color"?r=vi.parse(r):t.type==="formatted"?r=ea.fromString(r.toString()):t.type==="resolvedImage"?r=zi.fromString(r.toString()):Xi(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),Zs(r,e.default,t.default)}Pa.register(ws,{error:[{kind:"error"},[on],function(e,t){throw new na(t[0].evaluate(e))}],typeof:[on,[$r],function(e,t){return ei(Di(t[0].evaluate(e)))}],"to-rgba":[fi(Lt,4),[Yr],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[Yr,[Lt,Lt,Lt],Ea],rgba:[Yr,[Lt,Lt,Lt,Lt],Ea],has:{type:qr,overloads:[[[on],function(e,t){return kl(t[0].evaluate(e),e.properties())}],[[on,$n],function(e,t){var r=t[1];return kl(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:$r,overloads:[[[on],function(e,t){return el(t[0].evaluate(e),e.properties())}],[[on,$n],function(e,t){var r=t[1];return el(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[$r,[on],function(e,t){return el(t[0].evaluate(e),e.featureState||{})}],properties:[$n,[],function(e){return e.properties()}],"geometry-type":[on,[],function(e){return e.geometryType()}],id:[$r,[],function(e){return e.id()}],zoom:[Lt,[],function(e){return e.globals.zoom}],"heatmap-density":[Lt,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Lt,[],function(e){return e.globals.lineProgress||0}],accumulated:[$r,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[Lt,Co(Lt),function(e,t){for(var r=0,s=0,u=t;s<u.length;s+=1)r+=u[s].evaluate(e);return r}],"*":[Lt,Co(Lt),function(e,t){for(var r=1,s=0,u=t;s<u.length;s+=1)r*=u[s].evaluate(e);return r}],"-":{type:Lt,overloads:[[[Lt,Lt],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[Lt],function(e,t){return-t[0].evaluate(e)}]]},"/":[Lt,[Lt,Lt],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[Lt,[Lt,Lt],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[Lt,[],function(){return Math.LN2}],pi:[Lt,[],function(){return Math.PI}],e:[Lt,[],function(){return Math.E}],"^":[Lt,[Lt,Lt],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[Lt,[Lt],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[Lt,[Lt],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[Lt,[Lt],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[Lt,[Lt],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[Lt,[Lt],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[Lt,[Lt],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[Lt,[Lt],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[Lt,[Lt],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[Lt,[Lt],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[Lt,[Lt],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[Lt,Co(Lt),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[Lt,Co(Lt),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[Lt,[Lt],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[Lt,[Lt],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[Lt,[Lt],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[Lt,[Lt],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[qr,[on,$r],function(e,t){var r=t[0],s=t[1];return e.properties()[r.value]===s.value}],"filter-id-==":[qr,[$r],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[qr,[on],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[qr,[on,$r],function(e,t){var r=t[0],s=t[1],u=e.properties()[r.value],h=s.value;return typeof u==typeof h&&u<h}],"filter-id-<":[qr,[$r],function(e,t){var r=t[0],s=e.id(),u=r.value;return typeof s==typeof u&&s<u}],"filter->":[qr,[on,$r],function(e,t){var r=t[0],s=t[1],u=e.properties()[r.value],h=s.value;return typeof u==typeof h&&u>h}],"filter-id->":[qr,[$r],function(e,t){var r=t[0],s=e.id(),u=r.value;return typeof s==typeof u&&s>u}],"filter-<=":[qr,[on,$r],function(e,t){var r=t[0],s=t[1],u=e.properties()[r.value],h=s.value;return typeof u==typeof h&&u<=h}],"filter-id-<=":[qr,[$r],function(e,t){var r=t[0],s=e.id(),u=r.value;return typeof s==typeof u&&s<=u}],"filter->=":[qr,[on,$r],function(e,t){var r=t[0],s=t[1],u=e.properties()[r.value],h=s.value;return typeof u==typeof h&&u>=h}],"filter-id->=":[qr,[$r],function(e,t){var r=t[0],s=e.id(),u=r.value;return typeof s==typeof u&&s>=u}],"filter-has":[qr,[$r],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[qr,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[qr,[fi(on)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[qr,[fi($r)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[qr,[on,fi($r)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[qr,[on,fi($r)],function(e,t){var r=t[0],s=t[1];return function(u,h,p,y){for(;p<=y;){var w=p+y>>1;if(h[w]===u)return!0;h[w]>u?y=w-1:p=w+1}return!1}(e.properties()[r.value],s.value,0,s.value.length-1)}],all:{type:qr,overloads:[[[qr,qr],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[Co(qr),function(e,t){for(var r=0,s=t;r<s.length;r+=1)if(!s[r].evaluate(e))return!1;return!0}]]},any:{type:qr,overloads:[[[qr,qr],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[Co(qr),function(e,t){for(var r=0,s=t;r<s.length;r+=1)if(s[r].evaluate(e))return!0;return!1}]]},"!":[qr,[qr],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[qr,[on],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[on,[on],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[on,[on],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[on,Co($r),function(e,t){return t.map(function(r){return So(r.evaluate(e))}).join("")}],"resolved-locale":[on,[hi],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var Su=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new Hi,this._defaultValue=t?function(r){return r.type==="color"&&qs(r.default)?new vi(0,0,0,0):r.type==="color"?vi.parse(r.default)||null:r.default===void 0?null:r.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function lu(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in ws}function cu(e,t){var r=new Ho(ws,[],t?function(u){var h={color:Yr,string:on,number:Lt,enum:on,boolean:qr,formatted:Oi,resolvedImage:Qn};return u.type==="array"?fi(h[u.value]||$r,u.length):h[u.type]}(t):void 0),s=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return s?tl(new Su(s,t)):Es(r.errors)}Su.prototype.evaluateWithoutErrorHandling=function(e,t,r,s,u,h){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=s,this._evaluator.availableImages=u||null,this._evaluator.formattedSection=h,this.expression.evaluate(this._evaluator)},Su.prototype.evaluate=function(e,t,r,s,u,h){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=s,this._evaluator.availableImages=u||null,this._evaluator.formattedSection=h||null;try{var p=this.expression.evaluate(this._evaluator);if(p==null||typeof p=="number"&&p!=p)return this._defaultValue;if(this._enumValues&&!(p in this._enumValues))throw new na("Expected value to be one of "+Object.keys(this._enumValues).map(function(y){return JSON.stringify(y)}).join(", ")+", but found "+JSON.stringify(p)+" instead.");return p}catch(y){return this._warningHistory[y.message]||(this._warningHistory[y.message]=!0,typeof console!="undefined"&&console.warn(y.message)),this._defaultValue}};var hu=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!za(t.expression)};hu.prototype.evaluateWithoutErrorHandling=function(e,t,r,s,u,h){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,s,u,h)},hu.prototype.evaluate=function(e,t,r,s,u,h){return this._styleExpression.evaluate(e,t,r,s,u,h)};var Ls=function(e,t,r,s){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!za(t.expression),this.interpolationType=s};function fu(e,t){if((e=cu(e,t)).result==="error")return e;var r=e.value.expression,s=so(r);if(!s&&!Wo(t))return Es([new br("","data expressions not supported")]);var u=xo(r,["zoom"]);if(!u&&!rl(t))return Es([new br("","zoom expressions not supported")]);var h=function p(y){var w=null;if(y instanceof gt)w=p(y.result);else if(y instanceof lt)for(var A=0,M=y.args;A<M.length&&!(w=p(M[A]));A+=1);else(y instanceof ja||y instanceof oe)&&y.input instanceof Pa&&y.input.name==="zoom"&&(w=y);return w instanceof br||y.eachChild(function(O){var Z=p(O);Z instanceof br?w=Z:!w&&Z?w=new br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):w&&Z&&w!==Z&&(w=new br("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),w}(r);return h||u?h instanceof br?Es([h]):h instanceof oe&&!js(t)?Es([new br("",'"interpolate" expressions cannot be used with this property')]):tl(h?new Ls(s?"camera":"composite",e.value,h.labels,h instanceof oe?h.interpolation:void 0):new hu(s?"constant":"source",e.value)):Es([new br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Ls.prototype.evaluateWithoutErrorHandling=function(e,t,r,s,u,h){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,s,u,h)},Ls.prototype.evaluate=function(e,t,r,s,u,h){return this._styleExpression.evaluate(e,t,r,s,u,h)},Ls.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?oe.interpolationFactor(this.interpolationType,e,t,r):0};var Hs=function(e,t){this._parameters=e,this._specification=t,gr(this,function r(s,u){var h,p,y,w=u.type==="color",A=s.stops&&typeof s.stops[0][0]=="object",M=A||!(A||s.property!==void 0),O=s.type||(js(u)?"exponential":"interval");if(w&&((s=gr({},s)).stops&&(s.stops=s.stops.map(function(yn){return[yn[0],vi.parse(yn[1])]})),s.default=vi.parse(s.default?s.default:u.default)),s.colorSpace&&s.colorSpace!=="rgb"&&!G[s.colorSpace])throw new Error("Unknown color space: "+s.colorSpace);if(O==="exponential")h=Yl;else if(O==="interval")h=Xl;else if(O==="categorical"){h=Pl,p=Object.create(null);for(var Z=0,X=s.stops;Z<X.length;Z+=1){var Ee=X[Z];p[Ee[0]]=Ee[1]}y=typeof s.stops[0][0]}else{if(O!=="identity")throw new Error('Unknown function type "'+O+'"');h=nl}if(A){for(var Ie={},Xe=[],Be=0;Be<s.stops.length;Be++){var ut=s.stops[Be],It=ut[0].zoom;Ie[It]===void 0&&(Ie[It]={zoom:It,type:s.type,property:s.property,default:s.default,stops:[]},Xe.push(It)),Ie[It].stops.push([ut[0].value,ut[1]])}for(var Ht=[],Jt=0,mr=Xe;Jt<mr.length;Jt+=1){var Fr=mr[Jt];Ht.push([Ie[Fr].zoom,r(Ie[Fr],u)])}var tn={name:"linear"};return{kind:"composite",interpolationType:tn,interpolationFactor:oe.interpolationFactor.bind(void 0,tn),zoomStops:Ht.map(function(yn){return yn[0]}),evaluate:function(yn,On){var xn=yn.zoom;return Yl({stops:Ht,base:s.base},u,xn).evaluate(xn,On)}}}if(M){var kn=O==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:kn,interpolationFactor:oe.interpolationFactor.bind(void 0,kn),zoomStops:s.stops.map(function(yn){return yn[0]}),evaluate:function(yn){return h(s,u,yn.zoom,p,y)}}}return{kind:"source",evaluate:function(yn,On){var xn=On&&On.properties?On.properties[s.property]:void 0;return xn===void 0?Zs(s.default,u.default):h(s,u,xn,p,y)}}}(this._parameters,this._specification))};function Xo(e){var t=e.key,r=e.value,s=e.valueSpec||{},u=e.objectElementValidators||{},h=e.style,p=e.styleSpec,y=[],w=Xi(r);if(w!=="object")return[new Me(t,r,"object expected, "+w+" found")];for(var A in r){var M=A.split(".")[0],O=s[M]||s["*"],Z=void 0;if(u[M])Z=u[M];else if(s[M])Z=wi;else if(u["*"])Z=u["*"];else{if(!s["*"]){y.push(new Me(t,r[A],'unknown property "'+A+'"'));continue}Z=wi}y=y.concat(Z({key:(t&&t+".")+A,value:r[A],valueSpec:O,style:h,styleSpec:p,object:r,objectKey:A},r))}for(var X in s)u[X]||s[X].required&&s[X].default===void 0&&r[X]===void 0&&y.push(new Me(t,r,'missing required property "'+X+'"'));return y}function il(e){var t=e.value,r=e.valueSpec,s=e.style,u=e.styleSpec,h=e.key,p=e.arrayElementValidator||wi;if(Xi(t)!=="array")return[new Me(h,t,"array expected, "+Xi(t)+" found")];if(r.length&&t.length!==r.length)return[new Me(h,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new Me(h,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var y={type:r.value,values:r.values};u.$version<7&&(y.function=r.function),Xi(r.value)==="object"&&(y=r.value);for(var w=[],A=0;A<t.length;A++)w=w.concat(p({array:t,arrayIndex:A,value:t[A],valueSpec:y,style:s,styleSpec:u,key:h+"["+A+"]"}));return w}function al(e){var t=e.key,r=e.value,s=e.valueSpec,u=Xi(r);return u==="number"&&r!=r&&(u="NaN"),u!=="number"?[new Me(t,r,"number expected, "+u+" found")]:"minimum"in s&&r<s.minimum?[new Me(t,r,r+" is less than the minimum value "+s.minimum)]:"maximum"in s&&r>s.maximum?[new Me(t,r,r+" is greater than the maximum value "+s.maximum)]:[]}function Ml(e){var t,r,s,u=e.valueSpec,h=zt(e.value.type),p={},y=h!=="categorical"&&e.value.property===void 0,w=!y,A=Xi(e.value.stops)==="array"&&Xi(e.value.stops[0])==="array"&&Xi(e.value.stops[0][0])==="object",M=Xo({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(X){if(h==="identity")return[new Me(X.key,X.value,'identity function may not have a "stops" property')];var Ee=[],Ie=X.value;return Ee=Ee.concat(il({key:X.key,value:Ie,valueSpec:X.valueSpec,style:X.style,styleSpec:X.styleSpec,arrayElementValidator:O})),Xi(Ie)==="array"&&Ie.length===0&&Ee.push(new Me(X.key,Ie,"array must have at least one stop")),Ee},default:function(X){return wi({key:X.key,value:X.value,valueSpec:u,style:X.style,styleSpec:X.styleSpec})}}});return h==="identity"&&y&&M.push(new Me(e.key,e.value,'missing required property "property"')),h==="identity"||e.value.stops||M.push(new Me(e.key,e.value,'missing required property "stops"')),h==="exponential"&&e.valueSpec.expression&&!js(e.valueSpec)&&M.push(new Me(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(w&&!Wo(e.valueSpec)?M.push(new Me(e.key,e.value,"property functions not supported")):y&&!rl(e.valueSpec)&&M.push(new Me(e.key,e.value,"zoom functions not supported"))),h!=="categorical"&&!A||e.value.property!==void 0||M.push(new Me(e.key,e.value,'"property" property is required')),M;function O(X){var Ee=[],Ie=X.value,Xe=X.key;if(Xi(Ie)!=="array")return[new Me(Xe,Ie,"array expected, "+Xi(Ie)+" found")];if(Ie.length!==2)return[new Me(Xe,Ie,"array length 2 expected, length "+Ie.length+" found")];if(A){if(Xi(Ie[0])!=="object")return[new Me(Xe,Ie,"object expected, "+Xi(Ie[0])+" found")];if(Ie[0].zoom===void 0)return[new Me(Xe,Ie,"object stop key must have zoom")];if(Ie[0].value===void 0)return[new Me(Xe,Ie,"object stop key must have value")];if(s&&s>zt(Ie[0].zoom))return[new Me(Xe,Ie[0].zoom,"stop zoom values must appear in ascending order")];zt(Ie[0].zoom)!==s&&(s=zt(Ie[0].zoom),r=void 0,p={}),Ee=Ee.concat(Xo({key:Xe+"[0]",value:Ie[0],valueSpec:{zoom:{}},style:X.style,styleSpec:X.styleSpec,objectElementValidators:{zoom:al,value:Z}}))}else Ee=Ee.concat(Z({key:Xe+"[0]",value:Ie[0],valueSpec:{},style:X.style,styleSpec:X.styleSpec},Ie));return lu(Nt(Ie[1]))?Ee.concat([new Me(Xe+"[1]",Ie[1],"expressions are not allowed in function stops.")]):Ee.concat(wi({key:Xe+"[1]",value:Ie[1],valueSpec:u,style:X.style,styleSpec:X.styleSpec}))}function Z(X,Ee){var Ie=Xi(X.value),Xe=zt(X.value),Be=X.value!==null?X.value:Ee;if(t){if(Ie!==t)return[new Me(X.key,Be,Ie+" stop domain type must match previous stop domain type "+t)]}else t=Ie;if(Ie!=="number"&&Ie!=="string"&&Ie!=="boolean")return[new Me(X.key,Be,"stop domain value must be a number, string, or boolean")];if(Ie!=="number"&&h!=="categorical"){var ut="number expected, "+Ie+" found";return Wo(u)&&h===void 0&&(ut+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Me(X.key,Be,ut)]}return h!=="categorical"||Ie!=="number"||isFinite(Xe)&&Math.floor(Xe)===Xe?h!=="categorical"&&Ie==="number"&&r!==void 0&&Xe<r?[new Me(X.key,Be,"stop domain values must appear in ascending order")]:(r=Xe,h==="categorical"&&Xe in p?[new Me(X.key,Be,"stop domain values must be unique")]:(p[Xe]=!0,[])):[new Me(X.key,Be,"integer expected, found "+Xe)]}}function Ws(e){var t=(e.expressionContext==="property"?fu:cu)(Nt(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(s){return new Me(""+e.key+s.key,e.value,s.message)});var r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new Me(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!za(r))return[new Me(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!za(r))return[new Me(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!xo(r,["zoom","feature-state"]))return[new Me(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!so(r))return[new Me(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Tu(e){var t=e.key,r=e.value,s=e.valueSpec,u=[];return Array.isArray(s.values)?s.values.indexOf(zt(r))===-1&&u.push(new Me(t,r,"expected one of ["+s.values.join(", ")+"], "+JSON.stringify(r)+" found")):Object.keys(s.values).indexOf(zt(r))===-1&&u.push(new Me(t,r,"expected one of ["+Object.keys(s.values).join(", ")+"], "+JSON.stringify(r)+" found")),u}function Au(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var s=r[t];if(!Au(s)&&typeof s!="boolean")return!1}return!0;default:return!0}}Hs.deserialize=function(e){return new Hs(e._parameters,e._specification)},Hs.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var ol={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Nu(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};Au(e)||(e=Cu(e));var t=cu(e,ol);if(t.result==="error")throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(r,s,u){return t.value.evaluate(r,s,{},u)},needGeometry:function r(s){if(!Array.isArray(s))return!1;if(s[0]==="within")return!0;for(var u=1;u<s.length;u++)if(r(s[u]))return!0;return!1}(e)}}function Kl(e,t){return e<t?-1:e>t?1:0}function Cu(e){if(!e)return!0;var t,r=e[0];return e.length<=1?r!=="any":r==="=="?Xs(e[1],e[2],"=="):r==="!="?Ys(Xs(e[1],e[2],"==")):r==="<"||r===">"||r==="<="||r===">="?Xs(e[1],e[2],r):r==="any"?(t=e.slice(1),["any"].concat(t.map(Cu))):r==="all"?["all"].concat(e.slice(1).map(Cu)):r==="none"?["all"].concat(e.slice(1).map(Cu).map(Ys)):r==="in"?sl(e[1],e.slice(2)):r==="!in"?Ys(sl(e[1],e.slice(2))):r==="has"?ul(e[1]):r==="!has"?Ys(ul(e[1])):r!=="within"||e}function Xs(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function sl(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Kl)]]:["filter-in-small",e,["literal",t]]}}function ul(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Ys(e){return["!",e]}function Ll(e){return Au(Nt(e.value))?Ws(gr({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var s=r.value,u=r.key;if(Xi(s)!=="array")return[new Me(u,s,"array expected, "+Xi(s)+" found")];var h,p=r.styleSpec,y=[];if(s.length<1)return[new Me(u,s,"filter array must have at least 1 element")];switch(y=y.concat(Tu({key:u+"[0]",value:s[0],valueSpec:p.filter_operator,style:r.style,styleSpec:r.styleSpec})),zt(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&zt(s[1])==="$type"&&y.push(new Me(u,s,'"$type" cannot be use with operator "'+s[0]+'"'));case"==":case"!=":s.length!==3&&y.push(new Me(u,s,'filter array for operator "'+s[0]+'" must have 3 elements'));case"in":case"!in":s.length>=2&&(h=Xi(s[1]))!=="string"&&y.push(new Me(u+"[1]",s[1],"string expected, "+h+" found"));for(var w=2;w<s.length;w++)h=Xi(s[w]),zt(s[1])==="$type"?y=y.concat(Tu({key:u+"["+w+"]",value:s[w],valueSpec:p.geometry_type,style:r.style,styleSpec:r.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&y.push(new Me(u+"["+w+"]",s[w],"string, number, or boolean expected, "+h+" found"));break;case"any":case"all":case"none":for(var A=1;A<s.length;A++)y=y.concat(t({key:u+"["+A+"]",value:s[A],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":h=Xi(s[1]),s.length!==2?y.push(new Me(u,s,'filter array for "'+s[0]+'" operator must have 2 elements')):h!=="string"&&y.push(new Me(u+"[1]",s[1],"string expected, "+h+" found"));break;case"within":h=Xi(s[1]),s.length!==2?y.push(new Me(u,s,'filter array for "'+s[0]+'" operator must have 2 elements')):h!=="object"&&y.push(new Me(u+"[1]",s[1],"object expected, "+h+" found"))}return y}(e)}function Dl(e,t){var r=e.key,s=e.style,u=e.styleSpec,h=e.value,p=e.objectKey,y=u[t+"_"+e.layerType];if(!y)return[];var w=p.match(/^(.*)-transition$/);if(t==="paint"&&w&&y[w[1]]&&y[w[1]].transition)return wi({key:r,value:h,valueSpec:u.transition,style:s,styleSpec:u});var A,M=e.valueSpec||y[p];if(!M)return[new Me(r,h,'unknown property "'+p+'"')];if(Xi(h)==="string"&&Wo(M)&&!M.tokens&&(A=/^{([^}]+)}$/.exec(h)))return[new Me(r,h,'"'+p+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(A[1])+" }`.")];var O=[];return e.layerType==="symbol"&&(p==="text-field"&&s&&!s.glyphs&&O.push(new Me(r,h,'use of "text-field" requires a style "glyphs" property')),p==="text-font"&&qs(Nt(h))&&zt(h.type)==="identity"&&O.push(new Me(r,h,'"text-font" does not support identity functions'))),O.concat(wi({key:e.key,value:h,valueSpec:M,style:s,styleSpec:u,expressionContext:"property",propertyType:t,propertyKey:p}))}function ll(e){return Dl(e,"paint")}function pu(e){return Dl(e,"layout")}function Jl(e){var t=[],r=e.value,s=e.key,u=e.style,h=e.styleSpec;r.type||r.ref||t.push(new Me(s,r,'either "type" or "ref" is required'));var p,y=zt(r.type),w=zt(r.ref);if(r.id)for(var A=zt(r.id),M=0;M<e.arrayIndex;M++){var O=u.layers[M];zt(O.id)===A&&t.push(new Me(s,r.id,'duplicate layer id "'+r.id+'", previously used at line '+O.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(Ee){Ee in r&&t.push(new Me(s,r[Ee],'"'+Ee+'" is prohibited for ref layers'))}),u.layers.forEach(function(Ee){zt(Ee.id)===w&&(p=Ee)}),p?p.ref?t.push(new Me(s,r.ref,"ref cannot reference another ref layer")):y=zt(p.type):t.push(new Me(s,r.ref,'ref layer "'+w+'" not found'));else if(y!=="background")if(r.source){var Z=u.sources&&u.sources[r.source],X=Z&&zt(Z.type);Z?X==="vector"&&y==="raster"?t.push(new Me(s,r.source,'layer "'+r.id+'" requires a raster source')):X==="raster"&&y!=="raster"?t.push(new Me(s,r.source,'layer "'+r.id+'" requires a vector source')):X!=="vector"||r["source-layer"]?X==="raster-dem"&&y!=="hillshade"?t.push(new Me(s,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!r.paint||!r.paint["line-gradient"]||X==="geojson"&&Z.lineMetrics||t.push(new Me(s,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Me(s,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new Me(s,r.source,'source "'+r.source+'" not found'))}else t.push(new Me(s,r,'missing required property "source"'));return t=t.concat(Xo({key:s,value:r,valueSpec:h.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return wi({key:s+".type",value:r.type,valueSpec:h.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:Ll,layout:function(Ee){return Xo({layer:r,key:Ee.key,value:Ee.value,style:Ee.style,styleSpec:Ee.styleSpec,objectElementValidators:{"*":function(Ie){return pu(gr({layerType:y},Ie))}}})},paint:function(Ee){return Xo({layer:r,key:Ee.key,value:Ee.value,style:Ee.style,styleSpec:Ee.styleSpec,objectElementValidators:{"*":function(Ie){return ll(gr({layerType:y},Ie))}}})}}}))}function du(e){var t=e.value,r=e.key,s=Xi(t);return s!=="string"?[new Me(r,t,"string expected, "+s+" found")]:[]}var pa={promoteId:function(e){var t=e.key,r=e.value;if(Xi(r)==="string")return du({key:t,value:r});var s=[];for(var u in r)s.push.apply(s,du({key:t+"."+u,value:r[u]}));return s}};function Iu(e){var t=e.value,r=e.key,s=e.styleSpec,u=e.style;if(!t.type)return[new Me(r,t,'"type" is required')];var h,p=zt(t.type);switch(p){case"vector":case"raster":case"raster-dem":return Xo({key:r,value:t,valueSpec:s["source_"+p.replace("-","_")],style:e.style,styleSpec:s,objectElementValidators:pa});case"geojson":if(h=Xo({key:r,value:t,valueSpec:s.source_geojson,style:u,styleSpec:s,objectElementValidators:pa}),t.cluster)for(var y in t.clusterProperties){var w=t.clusterProperties[y],A=w[0],M=typeof A=="string"?[A,["accumulated"],["get",y]]:A;h.push.apply(h,Ws({key:r+"."+y+".map",value:w[1],expressionContext:"cluster-map"})),h.push.apply(h,Ws({key:r+"."+y+".reduce",value:M,expressionContext:"cluster-reduce"}))}return h;case"video":return Xo({key:r,value:t,valueSpec:s.source_video,style:u,styleSpec:s});case"image":return Xo({key:r,value:t,valueSpec:s.source_image,style:u,styleSpec:s});case"canvas":return[new Me(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Tu({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:u,styleSpec:s})}}function mu(e){var t=e.value,r=e.styleSpec,s=r.light,u=e.style,h=[],p=Xi(t);if(t===void 0)return h;if(p!=="object")return h.concat([new Me("light",t,"object expected, "+p+" found")]);for(var y in t){var w=y.match(/^(.*)-transition$/);h=h.concat(w&&s[w[1]]&&s[w[1]].transition?wi({key:y,value:t[y],valueSpec:r.transition,style:u,styleSpec:r}):s[y]?wi({key:y,value:t[y],valueSpec:s[y],style:u,styleSpec:r}):[new Me(y,t[y],'unknown property "'+y+'"')])}return h}var Ss={"*":function(){return[]},array:il,boolean:function(e){var t=e.value,r=e.key,s=Xi(t);return s!=="boolean"?[new Me(r,t,"boolean expected, "+s+" found")]:[]},number:al,color:function(e){var t=e.key,r=e.value,s=Xi(r);return s!=="string"?[new Me(t,r,"color expected, "+s+" found")]:di(r)===null?[new Me(t,r,'color expected, "'+r+'" found')]:[]},constants:bt,enum:Tu,filter:Ll,function:Ml,layer:Jl,object:Xo,source:Iu,light:mu,string:du,formatted:function(e){return du(e).length===0?[]:Ws(e)},resolvedImage:function(e){return du(e).length===0?[]:Ws(e)}};function wi(e){var t=e.value,r=e.valueSpec,s=e.styleSpec;return r.expression&&qs(zt(t))?Ml(e):r.expression&&lu(Nt(t))?Ws(e):r.type&&Ss[r.type]?Ss[r.type](e):Xo(gr({},e,{valueSpec:r.type?s[r.type]:r}))}function ia(e){var t=e.value,r=e.key,s=du(e);return s.length||(t.indexOf("{fontstack}")===-1&&s.push(new Me(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&s.push(new Me(r,t,'"glyphs" url must include a "{range}" token'))),s}function Io(e,t){t===void 0&&(t=J);var r=[];return r=r.concat(wi({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:ia,"*":function(){return[]}}})),e.constants&&(r=r.concat(bt({key:"constants",value:e.constants,style:e,styleSpec:t}))),ku(r)}function ku(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function qo(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return ku(e.apply(this,t))}}Io.source=qo(Iu),Io.light=qo(mu),Io.layer=qo(Jl),Io.filter=qo(Ll),Io.paintProperty=qo(ll),Io.layoutProperty=qo(pu);var Pu=Io,dc=Pu.light,mc=Pu.paintProperty,Vu=Pu.layoutProperty;function Uu(e,t){var r=!1;if(t&&t.length)for(var s=0,u=t;s<u.length;s+=1)e.fire(new Ne(new Error(u[s].message))),r=!0;return r}var Yo=Sa;function Sa(e,t,r){var s=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var u=new Int32Array(this.arrayBuffer);e=u[0],this.d=(t=u[1])+2*(r=u[2]);for(var h=0;h<this.d*this.d;h++){var p=u[3+h],y=u[3+h+1];s.push(p===y?null:u.subarray(p,y))}var w=u[3+s.length+1];this.keys=u.subarray(u[3+s.length],w),this.bboxes=u.subarray(w),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var A=0;A<this.d*this.d;A++)s.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var M=r/t*e;this.min=-M,this.max=e+M}Sa.prototype.insert=function(e,t,r,s,u){this._forEachCell(t,r,s,u,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(u)},Sa.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Sa.prototype._insertCell=function(e,t,r,s,u,h){this.cells[u].push(h)},Sa.prototype.query=function(e,t,r,s,u){var h=this.min,p=this.max;if(e<=h&&t<=h&&p<=r&&p<=s&&!u)return Array.prototype.slice.call(this.keys);var y=[];return this._forEachCell(e,t,r,s,this._queryCell,y,{},u),y},Sa.prototype._queryCell=function(e,t,r,s,u,h,p,y){var w=this.cells[u];if(w!==null)for(var A=this.keys,M=this.bboxes,O=0;O<w.length;O++){var Z=w[O];if(p[Z]===void 0){var X=4*Z;(y?y(M[X+0],M[X+1],M[X+2],M[X+3]):e<=M[X+2]&&t<=M[X+3]&&r>=M[X+0]&&s>=M[X+1])?(p[Z]=!0,h.push(A[Z])):p[Z]=!1}}},Sa.prototype._forEachCell=function(e,t,r,s,u,h,p,y){for(var w=this._convertToCellCoord(e),A=this._convertToCellCoord(t),M=this._convertToCellCoord(r),O=this._convertToCellCoord(s),Z=w;Z<=M;Z++)for(var X=A;X<=O;X++){var Ee=this.d*X+Z;if((!y||y(this._convertFromCellCoord(Z),this._convertFromCellCoord(X),this._convertFromCellCoord(Z+1),this._convertFromCellCoord(X+1)))&&u.call(this,e,t,r,s,Ee,h,p,y))return}},Sa.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Sa.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Sa.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,s=0;s<this.cells.length;s++)r+=this.cells[s].length;var u=new Int32Array(t+r+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var h=t,p=0;p<e.length;p++){var y=e[p];u[3+p]=h,u.set(y,h),h+=y.length}return u[3+e.length]=h,u.set(this.keys,h),u[3+e.length+1]=h+=this.keys.length,u.set(this.bboxes,h),h+=this.bboxes.length,u.buffer};var Ts=Fe.ImageData,As=Fe.ImageBitmap,Ba={};function dn(e,t,r){r===void 0&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Ba[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var da in dn("Object",Object),Yo.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},Yo.deserialize=function(e){return new Yo(e.buffer)},dn("Grid",Yo),dn("Color",vi),dn("Error",Error),dn("ResolvedImage",zi),dn("StylePropertyFunction",Hs),dn("StyleExpression",Su,{omit:["_evaluator"]}),dn("ZoomDependentExpression",Ls),dn("ZoomConstantExpression",hu),dn("CompoundExpression",Pa,{omit:["_evaluate"]}),ws)ws[da]._classRegistryKey||dn("Expression_"+da,ws[da]);function Ds(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function vu(e){return As&&e instanceof As}function Ko(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Ds(e)||vu(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof Ts)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var s=[],u=0,h=e;u<h.length;u+=1)s.push(Ko(h[u],t));return s}if(typeof e=="object"){var p=e.constructor,y=p._classRegistryKey;if(!y)throw new Error("can't serialize object of unregistered class");var w=p.serialize?p.serialize(e,t):{};if(!p.serialize){for(var A in e)if(e.hasOwnProperty(A)&&!(Ba[y].omit.indexOf(A)>=0)){var M=e[A];w[A]=Ba[y].shallow.indexOf(A)>=0?M:Ko(M,t)}e instanceof Error&&(w.message=e.message)}if(w.$name)throw new Error("$name property is reserved for worker serialization logic.");return y!=="Object"&&(w.$name=y),w}throw new Error("can't serialize object of type "+typeof e)}function Oo(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Ds(e)||vu(e)||ArrayBuffer.isView(e)||e instanceof Ts)return e;if(Array.isArray(e))return e.map(Oo);if(typeof e=="object"){var t=e.$name||"Object",r=Ba[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var s=Object.create(r.prototype),u=0,h=Object.keys(e);u<h.length;u+=1){var p=h[u];if(p!=="$name"){var y=e[p];s[p]=Ba[t].shallow.indexOf(p)>=0?y:Oo(y)}}return s}throw new Error("can't deserialize object of type "+typeof e)}var Rl=function(){this.first=!0};Rl.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var Zr={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function Ks(e){for(var t=0,r=e;t<r.length;t+=1)if(Gu(r[t].charCodeAt(0)))return!0;return!1}function Gu(e){return!(e!==746&&e!==747&&(e<4352||!(Zr["Bopomofo Extended"](e)||Zr.Bopomofo(e)||Zr["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||Zr["CJK Compatibility Ideographs"](e)||Zr["CJK Compatibility"](e)||Zr["CJK Radicals Supplement"](e)||Zr["CJK Strokes"](e)||!(!Zr["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||Zr["CJK Unified Ideographs Extension A"](e)||Zr["CJK Unified Ideographs"](e)||Zr["Enclosed CJK Letters and Months"](e)||Zr["Hangul Compatibility Jamo"](e)||Zr["Hangul Jamo Extended-A"](e)||Zr["Hangul Jamo Extended-B"](e)||Zr["Hangul Jamo"](e)||Zr["Hangul Syllables"](e)||Zr.Hiragana(e)||Zr["Ideographic Description Characters"](e)||Zr.Kanbun(e)||Zr["Kangxi Radicals"](e)||Zr["Katakana Phonetic Extensions"](e)||Zr.Katakana(e)&&e!==12540||!(!Zr["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!Zr["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||Zr["Unified Canadian Aboriginal Syllabics"](e)||Zr["Unified Canadian Aboriginal Syllabics Extended"](e)||Zr["Vertical Forms"](e)||Zr["Yijing Hexagram Symbols"](e)||Zr["Yi Syllables"](e)||Zr["Yi Radicals"](e))))}function Js(e){return!(Gu(e)||function(t){return!!(Zr["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Zr["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Zr["Letterlike Symbols"](t)||Zr["Number Forms"](t)||Zr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Zr["Control Pictures"](t)&&t!==9251||Zr["Optical Character Recognition"](t)||Zr["Enclosed Alphanumerics"](t)||Zr["Geometric Shapes"](t)||Zr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Zr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Zr["CJK Symbols and Punctuation"](t)||Zr.Katakana(t)||Zr["Private Use Area"](t)||Zr["CJK Compatibility Forms"](t)||Zr["Small Form Variants"](t)||Zr["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function ua(e){return e>=1424&&e<=2303||Zr["Arabic Presentation Forms-A"](e)||Zr["Arabic Presentation Forms-B"](e)}function ko(e,t){return!(!t&&ua(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Zr.Khmer(e))}function cl(e){for(var t=0,r=e;t<r.length;t+=1)if(ua(r[t].charCodeAt(0)))return!0;return!1}var Cs=null,lo="unavailable",fs=null,$l=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(lo="error"),Cs&&Cs(e)};function ju(){hl.fire(new xe("pluginStateChange",{pluginStatus:lo,pluginURL:fs}))}var hl=new Qe,Ql=function(){return lo},g=function(){if(lo!=="deferred"||!fs)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");lo="loading",ju(),fs&&Li({url:fs},function(e){e?$l(e):(lo="loaded",ju())})},I={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return lo==="loaded"||I.applyArabicShaping!=null},isLoading:function(){return lo==="loading"},setState:function(e){lo=e.pluginStatus,fs=e.pluginURL},isParsed:function(){return I.applyArabicShaping!=null&&I.processBidirectionalText!=null&&I.processStyledBidirectionalText!=null},getPluginURL:function(){return fs}},$=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Rl,this.transition={})};$.prototype.isSupportedScript=function(e){return function(t,r){for(var s=0,u=t;s<u.length;s+=1)if(!ko(u[s].charCodeAt(0),r))return!1;return!0}(e,I.isLoaded())},$.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},$.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var le=function(e,t){this.property=e,this.value=t,this.expression=function(r,s){if(qs(r))return new Hs(r,s);if(lu(r)){var u=fu(r,s);if(u.result==="error")throw new Error(u.value.map(function(p){return p.key+": "+p.message}).join(", "));return u.value}var h=r;return typeof r=="string"&&s.type==="color"&&(h=vi.parse(r)),{kind:"constant",evaluate:function(){return h}}}(t===void 0?e.specification.default:t,e.specification)};le.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},le.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var st=function(e){this.property=e,this.value=new le(e,void 0)};st.prototype.transitioned=function(e,t){return new _t(this.property,this.value,t,wt({},e.transition,this.transition),e.now)},st.prototype.untransitioned=function(){return new _t(this.property,this.value,null,{},0)};var tt=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};tt.prototype.getValue=function(e){return me(this._values[e].value.value)},tt.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new st(this._values[e].property)),this._values[e].value=new le(this._values[e].property,t===null?void 0:me(t))},tt.prototype.getTransition=function(e){return me(this._values[e].transition)},tt.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new st(this._values[e].property)),this._values[e].transition=me(t)||void 0},tt.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var s=r[t],u=this.getValue(s);u!==void 0&&(e[s]=u);var h=this.getTransition(s);h!==void 0&&(e[s+"-transition"]=h)}return e},tt.prototype.transitioned=function(e,t){for(var r=new Xt(this._properties),s=0,u=Object.keys(this._values);s<u.length;s+=1){var h=u[s];r._values[h]=this._values[h].transitioned(e,t._values[h])}return r},tt.prototype.untransitioned=function(){for(var e=new Xt(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var s=r[t];e._values[s]=this._values[s].untransitioned()}return e};var _t=function(e,t,r,s,u){this.property=e,this.value=t,this.begin=u+s.delay||0,this.end=this.begin+s.duration||0,e.specification.transition&&(s.delay||s.duration)&&(this.prior=r)};_t.prototype.possiblyEvaluate=function(e,t,r){var s=e.now||0,u=this.value.possiblyEvaluate(e,t,r),h=this.prior;if(h){if(s>this.end)return this.prior=null,u;if(this.value.isDataDriven())return this.prior=null,u;if(s<this.begin)return h.possiblyEvaluate(e,t,r);var p=(s-this.begin)/(this.end-this.begin);return this.property.interpolate(h.possiblyEvaluate(e,t,r),u,function(y){if(y<=0)return 0;if(y>=1)return 1;var w=y*y,A=w*y;return 4*(y<.5?A:3*(y-w)+A-.75)}(p))}return u};var Xt=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Xt.prototype.possiblyEvaluate=function(e,t,r){for(var s=new Tn(this._properties),u=0,h=Object.keys(this._values);u<h.length;u+=1){var p=h[u];s._values[p]=this._values[p].possiblyEvaluate(e,t,r)}return s},Xt.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var sr=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};sr.prototype.getValue=function(e){return me(this._values[e].value)},sr.prototype.setValue=function(e,t){this._values[e]=new le(this._values[e].property,t===null?void 0:me(t))},sr.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var s=r[t],u=this.getValue(s);u!==void 0&&(e[s]=u)}return e},sr.prototype.possiblyEvaluate=function(e,t,r){for(var s=new Tn(this._properties),u=0,h=Object.keys(this._values);u<h.length;u+=1){var p=h[u];s._values[p]=this._values[p].possiblyEvaluate(e,t,r)}return s};var Jr=function(e,t,r){this.property=e,this.value=t,this.parameters=r};Jr.prototype.isConstant=function(){return this.value.kind==="constant"},Jr.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},Jr.prototype.evaluate=function(e,t,r,s){return this.property.evaluate(this.value,this.parameters,e,t,r,s)};var Tn=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};Tn.prototype.get=function(e){return this._values[e]};var tr=function(e){this.specification=e};tr.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},tr.prototype.interpolate=function(e,t,r){var s=qa[this.specification.type];return s?s(e,t,r):e};var or=function(e,t){this.specification=e,this.overrides=t};or.prototype.possiblyEvaluate=function(e,t,r,s){return new Jr(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},r,s)}:e.expression,t)},or.prototype.interpolate=function(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new Jr(this,{kind:"constant",value:void 0},e.parameters);var s=qa[this.specification.type];return s?new Jr(this,{kind:"constant",value:s(e.value.value,t.value.value,r)},e.parameters):e},or.prototype.evaluate=function(e,t,r,s,u,h){return e.kind==="constant"?e.value:e.evaluate(t,r,s,u,h)};var jn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,s,u,h){if(r.value===void 0)return new Jr(this,{kind:"constant",value:void 0},s);if(r.expression.kind==="constant"){var p=r.expression.evaluate(s,null,{},u,h),y=r.property.specification.type==="resolvedImage"&&typeof p!="string"?p.name:p,w=this._calculate(y,y,y,s);return new Jr(this,{kind:"constant",value:w},s)}if(r.expression.kind==="camera"){var A=this._calculate(r.expression.evaluate({zoom:s.zoom-1}),r.expression.evaluate({zoom:s.zoom}),r.expression.evaluate({zoom:s.zoom+1}),s);return new Jr(this,{kind:"constant",value:A},s)}return new Jr(this,r.expression,s)},t.prototype.evaluate=function(r,s,u,h,p,y){if(r.kind==="source"){var w=r.evaluate(s,u,h,p,y);return this._calculate(w,w,w,s)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(s.zoom)-1},u,h),r.evaluate({zoom:Math.floor(s.zoom)},u,h),r.evaluate({zoom:Math.floor(s.zoom)+1},u,h),s):r.value},t.prototype._calculate=function(r,s,u,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:r,to:s}:{from:u,to:s}},t.prototype.interpolate=function(r){return r},t}(or),Ci=function(e){this.specification=e};Ci.prototype.possiblyEvaluate=function(e,t,r,s){if(e.value!==void 0){if(e.expression.kind==="constant"){var u=e.expression.evaluate(t,null,{},r,s);return this._calculate(u,u,u,t)}return this._calculate(e.expression.evaluate(new $(Math.floor(t.zoom-1),t)),e.expression.evaluate(new $(Math.floor(t.zoom),t)),e.expression.evaluate(new $(Math.floor(t.zoom+1),t)),t)}},Ci.prototype._calculate=function(e,t,r,s){return s.zoom>s.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},Ci.prototype.interpolate=function(e){return e};var Ni=function(e){this.specification=e};Ni.prototype.possiblyEvaluate=function(e,t,r,s){return!!e.expression.evaluate(t,null,{},r,s)},Ni.prototype.interpolate=function(){return!1};var xi=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var r=e[t];r.specification.overridable&&this.overridableProperties.push(t);var s=this.defaultPropertyValues[t]=new le(r,void 0),u=this.defaultTransitionablePropertyValues[t]=new st(r);this.defaultTransitioningPropertyValues[t]=u.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=s.possiblyEvaluate({})}};dn("DataDrivenProperty",or),dn("DataConstantProperty",tr),dn("CrossFadedDataDrivenProperty",jn),dn("CrossFadedProperty",Ci),dn("ColorRampProperty",Ni);var Ta=function(e){function t(r,s){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},r.type!=="custom"&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),s.layout&&(this._unevaluatedLayout=new sr(s.layout)),s.paint)){for(var u in this._transitionablePaint=new tt(s.paint),r.paint)this.setPaintProperty(u,r.paint[u],{validate:!1});for(var h in r.layout)this.setLayoutProperty(h,r.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Tn(s.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,s,u){u===void 0&&(u={}),s!=null&&this._validate(Vu,"layers."+this.id+".layout."+r,r,s,u)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,s):this.visibility=s)},t.prototype.getPaintProperty=function(r){return k(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,s,u){if(u===void 0&&(u={}),s!=null&&this._validate(mc,"layers."+this.id+".paint."+r,r,s,u))return!1;if(k(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),s||void 0),!1;var h=this._transitionablePaint._values[r],p=h.property.specification["property-type"]==="cross-faded-data-driven",y=h.value.isDataDriven(),w=h.value;this._transitionablePaint.setValue(r,s),this._handleSpecialPaintPropertyUpdate(r);var A=this._transitionablePaint._values[r].value;return A.isDataDriven()||y||p||this._handleOverridablePaintPropertyUpdate(r,w,A)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,s,u){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,s){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,s)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Se(r,function(s,u){return!(s===void 0||u==="layout"&&!Object.keys(s).length||u==="paint"&&!Object.keys(s).length)})},t.prototype._validate=function(r,s,u,h,p){return p===void 0&&(p={}),(!p||p.validate!==!1)&&Uu(this,r.call(Pu,{key:s,layerType:this.type,objectKey:u,value:h,styleSpec:J,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var s=this.paint.get(r);if(s instanceof Jr&&Wo(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1},t}(Qe),to={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},La=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},ti=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function yi(e,t){t===void 0&&(t=1);var r=0,s=0;return{members:e.map(function(u){var h=to[u.type].BYTES_PER_ELEMENT,p=r=Fo(r,Math.max(t,h)),y=u.components||1;return s=Math.max(s,h),r+=h*y,{name:u.name,type:u.type,components:y,offset:p}}),size:Fo(r,Math.max(s,t)),alignment:t}}function Fo(e,t){return Math.ceil(e/t)*t}ti.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},ti.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},ti.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},ti.prototype.clear=function(){this.length=0},ti.prototype.resize=function(e){this.reserve(e),this.length=e},ti.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},ti.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var si=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s){var u=this.length;return this.resize(u+1),this.emplace(u,r,s)},t.prototype.emplace=function(r,s,u){var h=2*r;return this.int16[h+0]=s,this.int16[h+1]=u,r},t}(ti);si.prototype.bytesPerElement=4,dn("StructArrayLayout2i4",si);var ha=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,u,h){var p=this.length;return this.resize(p+1),this.emplace(p,r,s,u,h)},t.prototype.emplace=function(r,s,u,h,p){var y=4*r;return this.int16[y+0]=s,this.int16[y+1]=u,this.int16[y+2]=h,this.int16[y+3]=p,r},t}(ti);ha.prototype.bytesPerElement=8,dn("StructArrayLayout4i8",ha);var ba=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,u,h,p,y){var w=this.length;return this.resize(w+1),this.emplace(w,r,s,u,h,p,y)},t.prototype.emplace=function(r,s,u,h,p,y,w){var A=6*r;return this.int16[A+0]=s,this.int16[A+1]=u,this.int16[A+2]=h,this.int16[A+3]=p,this.int16[A+4]=y,this.int16[A+5]=w,r},t}(ti);ba.prototype.bytesPerElement=12,dn("StructArrayLayout2i4i12",ba);var ji=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,u,h,p,y){var w=this.length;return this.resize(w+1),this.emplace(w,r,s,u,h,p,y)},t.prototype.emplace=function(r,s,u,h,p,y,w){var A=4*r,M=8*r;return this.int16[A+0]=s,this.int16[A+1]=u,this.uint8[M+4]=h,this.uint8[M+5]=p,this.uint8[M+6]=y,this.uint8[M+7]=w,r},t}(ti);ji.prototype.bytesPerElement=8,dn("StructArrayLayout2i4ub8",ji);var ri=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s){var u=this.length;return this.resize(u+1),this.emplace(u,r,s)},t.prototype.emplace=function(r,s,u){var h=2*r;return this.float32[h+0]=s,this.float32[h+1]=u,r},t}(ti);ri.prototype.bytesPerElement=8,dn("StructArrayLayout2f8",ri);var ta=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,u,h,p,y,w,A,M,O){var Z=this.length;return this.resize(Z+1),this.emplace(Z,r,s,u,h,p,y,w,A,M,O)},t.prototype.emplace=function(r,s,u,h,p,y,w,A,M,O,Z){var X=10*r;return this.uint16[X+0]=s,this.uint16[X+1]=u,this.uint16[X+2]=h,this.uint16[X+3]=p,this.uint16[X+4]=y,this.uint16[X+5]=w,this.uint16[X+6]=A,this.uint16[X+7]=M,this.uint16[X+8]=O,this.uint16[X+9]=Z,r},t}(ti);ta.prototype.bytesPerElement=20,dn("StructArrayLayout10ui20",ta);var la=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,u,h,p,y,w,A,M,O,Z,X){var Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,r,s,u,h,p,y,w,A,M,O,Z,X)},t.prototype.emplace=function(r,s,u,h,p,y,w,A,M,O,Z,X,Ee){var Ie=12*r;return this.int16[Ie+0]=s,this.int16[Ie+1]=u,this.int16[Ie+2]=h,this.int16[Ie+3]=p,this.uint16[Ie+4]=y,this.uint16[Ie+5]=w,this.uint16[Ie+6]=A,this.uint16[Ie+7]=M,this.int16[Ie+8]=O,this.int16[Ie+9]=Z,this.int16[Ie+10]=X,this.int16[Ie+11]=Ee,r},t}(ti);la.prototype.bytesPerElement=24,dn("StructArrayLayout4i4ui4i24",la);var Zo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,u){var h=this.length;return this.resize(h+1),this.emplace(h,r,s,u)},t.prototype.emplace=function(r,s,u,h){var p=3*r;return this.float32[p+0]=s,this.float32[p+1]=u,this.float32[p+2]=h,r},t}(ti);Zo.prototype.bytesPerElement=12,dn("StructArrayLayout3f12",Zo);var Rs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var s=this.length;return this.resize(s+1),this.emplace(s,r)},t.prototype.emplace=function(r,s){return this.uint32[1*r+0]=s,r},t}(ti);Rs.prototype.bytesPerElement=4,dn("StructArrayLayout1ul4",Rs);var Os=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,u,h,p,y,w,A,M){var O=this.length;return this.resize(O+1),this.emplace(O,r,s,u,h,p,y,w,A,M)},t.prototype.emplace=function(r,s,u,h,p,y,w,A,M,O){var Z=10*r,X=5*r;return this.int16[Z+0]=s,this.int16[Z+1]=u,this.int16[Z+2]=h,this.int16[Z+3]=p,this.int16[Z+4]=y,this.int16[Z+5]=w,this.uint32[X+3]=A,this.uint16[Z+8]=M,this.uint16[Z+9]=O,r},t}(ti);Os.prototype.bytesPerElement=20,dn("StructArrayLayout6i1ul2ui20",Os);var ps=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,u,h,p,y){var w=this.length;return this.resize(w+1),this.emplace(w,r,s,u,h,p,y)},t.prototype.emplace=function(r,s,u,h,p,y,w){var A=6*r;return this.int16[A+0]=s,this.int16[A+1]=u,this.int16[A+2]=h,this.int16[A+3]=p,this.int16[A+4]=y,this.int16[A+5]=w,r},t}(ti);ps.prototype.bytesPerElement=12,dn("StructArrayLayout2i2i2i12",ps);var as=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,u,h,p){var y=this.length;return this.resize(y+1),this.emplace(y,r,s,u,h,p)},t.prototype.emplace=function(r,s,u,h,p,y){var w=4*r,A=8*r;return this.float32[w+0]=s,this.float32[w+1]=u,this.float32[w+2]=h,this.int16[A+6]=p,this.int16[A+7]=y,r},t}(ti);as.prototype.bytesPerElement=16,dn("StructArrayLayout2f1f2i16",as);var Jo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,u,h){var p=this.length;return this.resize(p+1),this.emplace(p,r,s,u,h)},t.prototype.emplace=function(r,s,u,h,p){var y=12*r,w=3*r;return this.uint8[y+0]=s,this.uint8[y+1]=u,this.float32[w+1]=h,this.float32[w+2]=p,r},t}(ti);Jo.prototype.bytesPerElement=12,dn("StructArrayLayout2ub2f12",Jo);var $s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,u){var h=this.length;return this.resize(h+1),this.emplace(h,r,s,u)},t.prototype.emplace=function(r,s,u,h){var p=3*r;return this.uint16[p+0]=s,this.uint16[p+1]=u,this.uint16[p+2]=h,r},t}(ti);$s.prototype.bytesPerElement=6,dn("StructArrayLayout3ui6",$s);var Qs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,u,h,p,y,w,A,M,O,Z,X,Ee,Ie,Xe,Be,ut){var It=this.length;return this.resize(It+1),this.emplace(It,r,s,u,h,p,y,w,A,M,O,Z,X,Ee,Ie,Xe,Be,ut)},t.prototype.emplace=function(r,s,u,h,p,y,w,A,M,O,Z,X,Ee,Ie,Xe,Be,ut,It){var Ht=24*r,Jt=12*r,mr=48*r;return this.int16[Ht+0]=s,this.int16[Ht+1]=u,this.uint16[Ht+2]=h,this.uint16[Ht+3]=p,this.uint32[Jt+2]=y,this.uint32[Jt+3]=w,this.uint32[Jt+4]=A,this.uint16[Ht+10]=M,this.uint16[Ht+11]=O,this.uint16[Ht+12]=Z,this.float32[Jt+7]=X,this.float32[Jt+8]=Ee,this.uint8[mr+36]=Ie,this.uint8[mr+37]=Xe,this.uint8[mr+38]=Be,this.uint32[Jt+10]=ut,this.int16[Ht+22]=It,r},t}(ti);Qs.prototype.bytesPerElement=48,dn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Qs);var fl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,u,h,p,y,w,A,M,O,Z,X,Ee,Ie,Xe,Be,ut,It,Ht,Jt,mr,Fr,tn,kn,yn,On,xn,gi){var Hn=this.length;return this.resize(Hn+1),this.emplace(Hn,r,s,u,h,p,y,w,A,M,O,Z,X,Ee,Ie,Xe,Be,ut,It,Ht,Jt,mr,Fr,tn,kn,yn,On,xn,gi)},t.prototype.emplace=function(r,s,u,h,p,y,w,A,M,O,Z,X,Ee,Ie,Xe,Be,ut,It,Ht,Jt,mr,Fr,tn,kn,yn,On,xn,gi,Hn){var In=34*r,Pi=17*r;return this.int16[In+0]=s,this.int16[In+1]=u,this.int16[In+2]=h,this.int16[In+3]=p,this.int16[In+4]=y,this.int16[In+5]=w,this.int16[In+6]=A,this.int16[In+7]=M,this.uint16[In+8]=O,this.uint16[In+9]=Z,this.uint16[In+10]=X,this.uint16[In+11]=Ee,this.uint16[In+12]=Ie,this.uint16[In+13]=Xe,this.uint16[In+14]=Be,this.uint16[In+15]=ut,this.uint16[In+16]=It,this.uint16[In+17]=Ht,this.uint16[In+18]=Jt,this.uint16[In+19]=mr,this.uint16[In+20]=Fr,this.uint16[In+21]=tn,this.uint16[In+22]=kn,this.uint32[Pi+12]=yn,this.float32[Pi+13]=On,this.float32[Pi+14]=xn,this.float32[Pi+15]=gi,this.float32[Pi+16]=Hn,r},t}(ti);fl.prototype.bytesPerElement=68,dn("StructArrayLayout8i15ui1ul4f68",fl);var eu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var s=this.length;return this.resize(s+1),this.emplace(s,r)},t.prototype.emplace=function(r,s){return this.float32[1*r+0]=s,r},t}(ti);eu.prototype.bytesPerElement=4,dn("StructArrayLayout1f4",eu);var $o=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,u){var h=this.length;return this.resize(h+1),this.emplace(h,r,s,u)},t.prototype.emplace=function(r,s,u,h){var p=3*r;return this.int16[p+0]=s,this.int16[p+1]=u,this.int16[p+2]=h,r},t}(ti);$o.prototype.bytesPerElement=6,dn("StructArrayLayout3i6",$o);var pl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,u){var h=this.length;return this.resize(h+1),this.emplace(h,r,s,u)},t.prototype.emplace=function(r,s,u,h){var p=4*r;return this.uint32[2*r+0]=s,this.uint16[p+2]=u,this.uint16[p+3]=h,r},t}(ti);pl.prototype.bytesPerElement=8,dn("StructArrayLayout1ul2ui8",pl);var qu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s){var u=this.length;return this.resize(u+1),this.emplace(u,r,s)},t.prototype.emplace=function(r,s,u){var h=2*r;return this.uint16[h+0]=s,this.uint16[h+1]=u,r},t}(ti);qu.prototype.bytesPerElement=4,dn("StructArrayLayout2ui4",qu);var Ol=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var s=this.length;return this.resize(s+1),this.emplace(s,r)},t.prototype.emplace=function(r,s){return this.uint16[1*r+0]=s,r},t}(ti);Ol.prototype.bytesPerElement=2,dn("StructArrayLayout1ui2",Ol);var Mu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,u,h){var p=this.length;return this.resize(p+1),this.emplace(p,r,s,u,h)},t.prototype.emplace=function(r,s,u,h,p){var y=4*r;return this.float32[y+0]=s,this.float32[y+1]=u,this.float32[y+2]=h,this.float32[y+3]=p,r},t}(ti);Mu.prototype.bytesPerElement=16,dn("StructArrayLayout4f16",Mu);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new Le(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(La);n.prototype.size=20;var a=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new n(this,r)},t}(Os);dn("CollisionBoxArray",a);var i=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(s){this._structArray.uint8[this._pos1+37]=s},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(s){this._structArray.uint8[this._pos1+38]=s},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(s){this._structArray.uint32[this._pos4+10]=s},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(La);i.prototype.size=48;var o=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new i(this,r)},t}(Qs);dn("PlacedSymbolArray",o);var f=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(s){this._structArray.uint32[this._pos4+12]=s},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(La);f.prototype.size=68;var d=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new f(this,r)},t}(fl);dn("SymbolInstanceArray",d);var v=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}(eu);dn("GlyphOffsetArray",v);var x=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}($o);dn("SymbolLineVertexArray",x);var C=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(La);C.prototype.size=8;var F=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new C(this,r)},t}(pl);dn("FeatureIndexArray",F);var K=yi([{name:"a_pos",components:2,type:"Int16"}],4).members,ee=function(e){e===void 0&&(e=[]),this.segments=e};function re(e,t){return 256*(e=Dt(Math.floor(e),0,255))+Dt(Math.floor(t),0,255)}ee.prototype.prepareSegment=function(e,t,r,s){var u=this.segments[this.segments.length-1];return e>ee.MAX_VERTEX_ARRAY_LENGTH&&we("Max vertices per segment is "+ee.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!u||u.vertexLength+e>ee.MAX_VERTEX_ARRAY_LENGTH||u.sortKey!==s)&&(u={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},s!==void 0&&(u.sortKey=s),this.segments.push(u)),u},ee.prototype.get=function(){return this.segments},ee.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var s in r.vaos)r.vaos[s].destroy()}},ee.simpleSegment=function(e,t,r,s){return new ee([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:s,vaos:{},sortKey:0}])},ee.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,dn("SegmentVector",ee);var Pe=yi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Ce=Vt(function(e){e.exports=function(t,r){var s,u,h,p,y,w,A,M;for(u=t.length-(s=3&t.length),h=r,y=3432918353,w=461845907,M=0;M<u;)A=255&t.charCodeAt(M)|(255&t.charCodeAt(++M))<<8|(255&t.charCodeAt(++M))<<16|(255&t.charCodeAt(++M))<<24,++M,h=27492+(65535&(p=5*(65535&(h=(h^=A=(65535&(A=(A=(65535&A)*y+(((A>>>16)*y&65535)<<16)&4294967295)<<15|A>>>17))*w+(((A>>>16)*w&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(p>>>16)&65535)<<16);switch(A=0,s){case 3:A^=(255&t.charCodeAt(M+2))<<16;case 2:A^=(255&t.charCodeAt(M+1))<<8;case 1:h^=A=(65535&(A=(A=(65535&(A^=255&t.charCodeAt(M)))*y+(((A>>>16)*y&65535)<<16)&4294967295)<<15|A>>>17))*w+(((A>>>16)*w&65535)<<16)&4294967295}return h^=t.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0}}),qe=Vt(function(e){e.exports=function(t,r){for(var s,u=t.length,h=r^u,p=0;u>=4;)s=1540483477*(65535&(s=255&t.charCodeAt(p)|(255&t.charCodeAt(++p))<<8|(255&t.charCodeAt(++p))<<16|(255&t.charCodeAt(++p))<<24))+((1540483477*(s>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),u-=4,++p;switch(u){case 3:h^=(255&t.charCodeAt(p+2))<<16;case 2:h^=(255&t.charCodeAt(p+1))<<8;case 1:h=1540483477*(65535&(h^=255&t.charCodeAt(p)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0}}),_e=Ce,Ge=qe;_e.murmur3=Ce,_e.murmur2=Ge;var et=function(){this.ids=[],this.positions=[],this.indexed=!1};et.prototype.add=function(e,t,r,s){this.ids.push($t(e)),this.positions.push(t,r,s)},et.prototype.getPositions=function(e){for(var t=$t(e),r=0,s=this.ids.length-1;r<s;){var u=r+s>>1;this.ids[u]>=t?s=u:r=u+1}for(var h=[];this.ids[r]===t;)h.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return h},et.serialize=function(e,t){var r=new Float64Array(e.ids),s=new Uint32Array(e.positions);return function u(h,p,y,w){for(;y<w;){for(var A=h[y+w>>1],M=y-1,O=w+1;;){do M++;while(h[M]<A);do O--;while(h[O]>A);if(M>=O)break;Zt(h,M,O),Zt(p,3*M,3*O),Zt(p,3*M+1,3*O+1),Zt(p,3*M+2,3*O+2)}O-y<w-O?(u(h,p,y,O),y=O+1):(u(h,p,O+1,w),w=O)}}(r,s,0,r.length-1),t&&t.push(r.buffer,s.buffer),{ids:r,positions:s}},et.deserialize=function(e){var t=new et;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var St=Math.pow(2,53)-1;function $t(e){var t=+e;return!isNaN(t)&&t<=St?t:_e(String(e))}function Zt(e,t,r){var s=e[t];e[t]=e[r],e[r]=s}dn("FeaturePositionMap",et);var rr=function(e,t){this.gl=e.gl,this.location=t},Sr=function(e){function t(r,s){e.call(this,r,s),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(rr),Ur=function(e){function t(r,s){e.call(this,r,s),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(rr),Br=function(e){function t(r,s){e.call(this,r,s),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(rr),hn=function(e){function t(r,s){e.call(this,r,s),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(rr),Pn=function(e){function t(r,s){e.call(this,r,s),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(rr),Mn=function(e){function t(r,s){e.call(this,r,s),this.current=vi.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(rr),Rn=new Float32Array(16),Ei=function(e){function t(r,s){e.call(this,r,s),this.current=Rn}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var s=1;s<16;s++)if(r[s]!==this.current[s]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(rr);function fn(e){return[re(255*e.r,255*e.g),re(255*e.b,255*e.a)]}var Jn=function(e,t,r){this.value=e,this.uniformNames=t.map(function(s){return"u_"+s}),this.type=r};Jn.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},Jn.prototype.getBinding=function(e,t,r){return this.type==="color"?new Mn(e,t):new Ur(e,t)};var ni=function(e,t){this.uniformNames=t.map(function(r){return"u_"+r}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ni.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},ni.prototype.setUniform=function(e,t,r,s){var u=s==="u_pattern_to"?this.patternTo:s==="u_pattern_from"?this.patternFrom:s==="u_pixel_ratio_to"?this.pixelRatioTo:s==="u_pixel_ratio_from"?this.pixelRatioFrom:null;u&&e.set(u)},ni.prototype.getBinding=function(e,t,r){return r.substr(0,9)==="u_pattern"?new Pn(e,t):new Ur(e,t)};var qn=function(e,t,r,s){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map(function(u){return{name:"a_"+u,type:"Float32",components:r==="color"?2:1,offset:0}}),this.paintVertexArray=new s};qn.prototype.populatePaintArray=function(e,t,r,s,u){var h=this.paintVertexArray.length,p=this.expression.evaluate(new $(0),t,{},s,[],u);this.paintVertexArray.resize(e),this._setPaintValue(h,e,p)},qn.prototype.updatePaintArray=function(e,t,r,s){var u=this.expression.evaluate({zoom:0},r,s);this._setPaintValue(e,t,u)},qn.prototype._setPaintValue=function(e,t,r){if(this.type==="color")for(var s=fn(r),u=e;u<t;u++)this.paintVertexArray.emplace(u,s[0],s[1]);else{for(var h=e;h<t;h++)this.paintVertexArray.emplace(h,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},qn.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},qn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Bn=function(e,t,r,s,u,h){this.expression=e,this.uniformNames=t.map(function(p){return"u_"+p+"_t"}),this.type=r,this.useIntegerZoom=s,this.zoom=u,this.maxValue=0,this.paintVertexAttributes=t.map(function(p){return{name:"a_"+p,type:"Float32",components:r==="color"?4:2,offset:0}}),this.paintVertexArray=new h};Bn.prototype.populatePaintArray=function(e,t,r,s,u){var h=this.expression.evaluate(new $(this.zoom),t,{},s,[],u),p=this.expression.evaluate(new $(this.zoom+1),t,{},s,[],u),y=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(y,e,h,p)},Bn.prototype.updatePaintArray=function(e,t,r,s){var u=this.expression.evaluate({zoom:this.zoom},r,s),h=this.expression.evaluate({zoom:this.zoom+1},r,s);this._setPaintValue(e,t,u,h)},Bn.prototype._setPaintValue=function(e,t,r,s){if(this.type==="color")for(var u=fn(r),h=fn(s),p=e;p<t;p++)this.paintVertexArray.emplace(p,u[0],u[1],h[0],h[1]);else{for(var y=e;y<t;y++)this.paintVertexArray.emplace(y,r,s);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(s))}},Bn.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Bn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Bn.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,s=Dt(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(s)},Bn.prototype.getBinding=function(e,t,r){return new Ur(e,t)};var oi=function(e,t,r,s,u,h){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=s,this.layerId=h,this.zoomInPaintVertexArray=new u,this.zoomOutPaintVertexArray=new u};oi.prototype.populatePaintArray=function(e,t,r){var s=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(s,e,t.patterns&&t.patterns[this.layerId],r)},oi.prototype.updatePaintArray=function(e,t,r,s,u){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],u)},oi.prototype._setPaintValues=function(e,t,r,s){if(s&&r){var u=s[r.min],h=s[r.mid],p=s[r.max];if(u&&h&&p)for(var y=e;y<t;y++)this.zoomInPaintVertexArray.emplace(y,h.tl[0],h.tl[1],h.br[0],h.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],h.pixelRatio,u.pixelRatio),this.zoomOutPaintVertexArray.emplace(y,h.tl[0],h.tl[1],h.br[0],h.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1],h.pixelRatio,p.pixelRatio)}},oi.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Pe.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Pe.members,this.expression.isStateDependent))},oi.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Vn=function(e,t,r){this.binders={},this._buffers=[];var s=[];for(var u in e.paint._values)if(r(u)){var h=e.paint.get(u);if(h instanceof Jr&&Wo(h.property.specification)){var p=Ha(u,e.type),y=h.value,w=h.property.specification.type,A=h.property.useIntegerZoom,M=h.property.specification["property-type"],O=M==="cross-faded"||M==="cross-faded-data-driven";if(y.kind==="constant")this.binders[u]=O?new ni(y.value,p):new Jn(y.value,p,w),s.push("/u_"+u);else if(y.kind==="source"||O){var Z=Ca(u,w,"source");this.binders[u]=O?new oi(y,w,A,t,Z,e.id):new qn(y,p,w,Z),s.push("/a_"+u)}else{var X=Ca(u,w,"composite");this.binders[u]=new Bn(y,p,w,A,t,X),s.push("/z_"+u)}}}this.cacheKey=s.sort().join("")};Vn.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof qn||t instanceof Bn?t.maxValue:0},Vn.prototype.populatePaintArrays=function(e,t,r,s,u){for(var h in this.binders){var p=this.binders[h];(p instanceof qn||p instanceof Bn||p instanceof oi)&&p.populatePaintArray(e,t,r,s,u)}},Vn.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var s=this.binders[r];s instanceof ni&&s.setConstantPatternPositions(e,t)}},Vn.prototype.updatePaintArrays=function(e,t,r,s,u){var h=!1;for(var p in e)for(var y=0,w=t.getPositions(p);y<w.length;y+=1){var A=w[y],M=r.feature(A.index);for(var O in this.binders){var Z=this.binders[O];if((Z instanceof qn||Z instanceof Bn||Z instanceof oi)&&Z.expression.isStateDependent===!0){var X=s.paint.get(O);Z.expression=X.value,Z.updatePaintArray(A.start,A.end,M,e[p],u),h=!0}}}return h},Vn.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof Jn||r instanceof ni)&&e.push.apply(e,r.uniformNames.map(function(s){return"#define HAS_UNIFORM_"+s}))}return e},Vn.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof qn||r instanceof Bn)for(var s=0;s<r.paintVertexAttributes.length;s++)e.push(r.paintVertexAttributes[s].name);else if(r instanceof oi)for(var u=0;u<Pe.members.length;u++)e.push(Pe.members[u].name)}return e},Vn.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof Jn||r instanceof ni||r instanceof Bn)for(var s=0,u=r.uniformNames;s<u.length;s+=1)e.push(u[s])}return e},Vn.prototype.getPaintVertexBuffers=function(){return this._buffers},Vn.prototype.getUniforms=function(e,t){var r=[];for(var s in this.binders){var u=this.binders[s];if(u instanceof Jn||u instanceof ni||u instanceof Bn)for(var h=0,p=u.uniformNames;h<p.length;h+=1){var y=p[h];if(t[y]){var w=u.getBinding(e,t[y],y);r.push({name:y,property:s,binding:w})}}}return r},Vn.prototype.setUniforms=function(e,t,r,s){for(var u=0,h=t;u<h.length;u+=1){var p=h[u],y=p.name,w=p.property;this.binders[w].setUniform(p.binding,s,r.get(w),y)}},Vn.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof oi){var s=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;s&&this._buffers.push(s)}else(r instanceof qn||r instanceof Bn)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},Vn.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof qn||r instanceof Bn||r instanceof oi)&&r.upload(e)}this.updatePaintBuffers()},Vn.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof qn||t instanceof Bn||t instanceof oi)&&t.destroy()}};var Nn=function(e,t,r){r===void 0&&(r=function(){return!0}),this.programConfigurations={};for(var s=0,u=e;s<u.length;s+=1){var h=u[s];this.programConfigurations[h.id]=new Vn(h,t,r)}this.needsUpload=!1,this._featureMap=new et,this._bufferOffset=0};function Ha(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function Ca(e,t,r){var s={color:{source:ri,composite:Mu},number:{source:eu,composite:ri}},u=function(h){return{"line-pattern":{source:ta,composite:ta},"fill-pattern":{source:ta,composite:ta},"fill-extrusion-pattern":{source:ta,composite:ta}}[h]}(e);return u&&u[r]||s[t][r]}Nn.prototype.populatePaintArrays=function(e,t,r,s,u,h){for(var p in this.programConfigurations)this.programConfigurations[p].populatePaintArrays(e,t,s,u,h);t.id!==void 0&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Nn.prototype.updatePaintArrays=function(e,t,r,s){for(var u=0,h=r;u<h.length;u+=1){var p=h[u];this.needsUpload=this.programConfigurations[p.id].updatePaintArrays(e,this._featureMap,t,p,s)||this.needsUpload}},Nn.prototype.get=function(e){return this.programConfigurations[e]},Nn.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Nn.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},dn("ConstantBinder",Jn),dn("CrossFadedConstantBinder",ni),dn("SourceExpressionBinder",qn),dn("CrossFadedCompositeBinder",oi),dn("CompositeExpressionBinder",Bn),dn("ProgramConfiguration",Vn,{omit:["_buffers"]}),dn("ProgramConfigurationSet",Nn);var co=Math.pow(2,14)-1,ho=-co-1;function Ia(e){for(var t=8192/e.extent,r=e.loadGeometry(),s=0;s<r.length;s++)for(var u=r[s],h=0;h<u.length;h++){var p=u[h],y=Math.round(p.x*t),w=Math.round(p.y*t);p.x=Dt(y,ho,co),p.y=Dt(w,ho,co),(y<p.x||y>p.x+1||w<p.y||w>p.y+1)&&we("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Na(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Ia(e):[]}}function Qo(e,t,r,s,u){e.emplaceBack(2*t+(s+1)/2,2*r+(u+1)/2)}var zo=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new si,this.indexArray=new $s,this.segments=new ee,this.programConfigurations=new Nn(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function tu(e,t){for(var r=0;r<e.length;r++)if(ks(t,e[r]))return!0;for(var s=0;s<t.length;s++)if(ks(e,t[s]))return!0;return!!dl(e,t)}function Bo(e,t,r){return!!ks(e,t)||!!ru(t,e,r)}function Is(e,t){if(e.length===1)return ml(t,e[0]);for(var r=0;r<t.length;r++)for(var s=t[r],u=0;u<s.length;u++)if(ks(e,s[u]))return!0;for(var h=0;h<e.length;h++)if(ml(t,e[h]))return!0;for(var p=0;p<t.length;p++)if(dl(e,t[p]))return!0;return!1}function ds(e,t,r){if(e.length>1){if(dl(e,t))return!0;for(var s=0;s<t.length;s++)if(ru(t[s],e,r))return!0}for(var u=0;u<e.length;u++)if(ru(e[u],t,r))return!0;return!1}function dl(e,t){if(e.length===0||t.length===0)return!1;for(var r=0;r<e.length-1;r++)for(var s=e[r],u=e[r+1],h=0;h<t.length-1;h++)if(Zu(s,u,t[h],t[h+1]))return!0;return!1}function Zu(e,t,r,s){return ze(e,r,s)!==ze(t,r,s)&&ze(e,t,r)!==ze(e,t,s)}function ru(e,t,r){var s=r*r;if(t.length===1)return e.distSqr(t[0])<s;for(var u=1;u<t.length;u++)if(Hu(e,t[u-1],t[u])<s)return!0;return!1}function Hu(e,t,r){var s=t.distSqr(r);if(s===0)return e.distSqr(t);var u=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/s;return e.distSqr(u<0?t:u>1?r:r.sub(t)._mult(u)._add(t))}function ml(e,t){for(var r,s,u,h=!1,p=0;p<e.length;p++)for(var y=0,w=(r=e[p]).length-1;y<r.length;w=y++)(s=r[y]).y>t.y!=(u=r[w]).y>t.y&&t.x<(u.x-s.x)*(t.y-s.y)/(u.y-s.y)+s.x&&(h=!h);return h}function ks(e,t){for(var r=!1,s=0,u=e.length-1;s<e.length;u=s++){var h=e[s],p=e[u];h.y>t.y!=p.y>t.y&&t.x<(p.x-h.x)*(t.y-h.y)/(p.y-h.y)+h.x&&(r=!r)}return r}function Wu(e,t,r){var s=r[0],u=r[2];if(e.x<s.x&&t.x<s.x||e.x>u.x&&t.x>u.x||e.y<s.y&&t.y<s.y||e.y>u.y&&t.y>u.y)return!1;var h=ze(e,t,r[0]);return h!==ze(e,t,r[1])||h!==ze(e,t,r[2])||h!==ze(e,t,r[3])}function Fs(e,t,r){var s=t.paint.get(e).value;return s.kind==="constant"?s.value:r.programConfigurations.get(t.id).getMaxValue(e)}function Wa(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function nu(e,t,r,s,u){if(!t[0]&&!t[1])return e;var h=Le.convert(t)._mult(u);r==="viewport"&&h._rotate(-s);for(var p=[],y=0;y<e.length;y++)p.push(e[y].sub(h));return p}zo.prototype.populate=function(e,t,r){var s=this.layers[0],u=[],h=null;s.type==="circle"&&(h=s.layout.get("circle-sort-key"));for(var p=0,y=e;p<y.length;p+=1){var w=y[p],A=w.feature,M=w.id,O=w.index,Z=w.sourceLayerIndex,X=this.layers[0]._featureFilter.needGeometry,Ee=Na(A,X);if(this.layers[0]._featureFilter.filter(new $(this.zoom),Ee,r)){var Ie=h?h.evaluate(Ee,{},r):void 0,Xe={id:M,properties:A.properties,type:A.type,sourceLayerIndex:Z,index:O,geometry:X?Ee.geometry:Ia(A),patterns:{},sortKey:Ie};u.push(Xe)}}h&&u.sort(function(tn,kn){return tn.sortKey-kn.sortKey});for(var Be=0,ut=u;Be<ut.length;Be+=1){var It=ut[Be],Ht=It.geometry,Jt=It.index,mr=It.sourceLayerIndex,Fr=e[Jt].feature;this.addFeature(It,Ht,Jt,r),t.featureIndex.insert(Fr,Ht,Jt,mr,this.index)}},zo.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},zo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},zo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},zo.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,K),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},zo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},zo.prototype.addFeature=function(e,t,r,s){for(var u=0,h=t;u<h.length;u+=1)for(var p=0,y=h[u];p<y.length;p+=1){var w=y[p],A=w.x,M=w.y;if(!(A<0||A>=8192||M<0||M>=8192)){var O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),Z=O.vertexLength;Qo(this.layoutVertexArray,A,M,-1,-1),Qo(this.layoutVertexArray,A,M,1,-1),Qo(this.layoutVertexArray,A,M,1,1),Qo(this.layoutVertexArray,A,M,-1,1),this.indexArray.emplaceBack(Z,Z+1,Z+2),this.indexArray.emplaceBack(Z,Z+3,Z+2),O.vertexLength+=4,O.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},s)},dn("CircleBucket",zo,{omit:["layers"]});var yu=new xi({"circle-sort-key":new or(J.layout_circle["circle-sort-key"])}),gu={paint:new xi({"circle-radius":new or(J.paint_circle["circle-radius"]),"circle-color":new or(J.paint_circle["circle-color"]),"circle-blur":new or(J.paint_circle["circle-blur"]),"circle-opacity":new or(J.paint_circle["circle-opacity"]),"circle-translate":new tr(J.paint_circle["circle-translate"]),"circle-translate-anchor":new tr(J.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new tr(J.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new tr(J.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new or(J.paint_circle["circle-stroke-width"]),"circle-stroke-color":new or(J.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new or(J.paint_circle["circle-stroke-opacity"])}),layout:yu},qi=typeof Float32Array!="undefined"?Float32Array:Array;function os(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function No(e,t,r){var s=t[0],u=t[1],h=t[2],p=t[3],y=t[4],w=t[5],A=t[6],M=t[7],O=t[8],Z=t[9],X=t[10],Ee=t[11],Ie=t[12],Xe=t[13],Be=t[14],ut=t[15],It=r[0],Ht=r[1],Jt=r[2],mr=r[3];return e[0]=It*s+Ht*y+Jt*O+mr*Ie,e[1]=It*u+Ht*w+Jt*Z+mr*Xe,e[2]=It*h+Ht*A+Jt*X+mr*Be,e[3]=It*p+Ht*M+Jt*Ee+mr*ut,e[4]=(It=r[4])*s+(Ht=r[5])*y+(Jt=r[6])*O+(mr=r[7])*Ie,e[5]=It*u+Ht*w+Jt*Z+mr*Xe,e[6]=It*h+Ht*A+Jt*X+mr*Be,e[7]=It*p+Ht*M+Jt*Ee+mr*ut,e[8]=(It=r[8])*s+(Ht=r[9])*y+(Jt=r[10])*O+(mr=r[11])*Ie,e[9]=It*u+Ht*w+Jt*Z+mr*Xe,e[10]=It*h+Ht*A+Jt*X+mr*Be,e[11]=It*p+Ht*M+Jt*Ee+mr*ut,e[12]=(It=r[12])*s+(Ht=r[13])*y+(Jt=r[14])*O+(mr=r[15])*Ie,e[13]=It*u+Ht*w+Jt*Z+mr*Xe,e[14]=It*h+Ht*A+Jt*X+mr*Be,e[15]=It*p+Ht*M+Jt*Ee+mr*ut,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var _u,Fl=No;function zl(e,t,r){var s=t[0],u=t[1],h=t[2],p=t[3];return e[0]=r[0]*s+r[4]*u+r[8]*h+r[12]*p,e[1]=r[1]*s+r[5]*u+r[9]*h+r[13]*p,e[2]=r[2]*s+r[6]*u+r[10]*h+r[14]*p,e[3]=r[3]*s+r[7]*u+r[11]*h+r[15]*p,e}_u=new qi(3),qi!=Float32Array&&(_u[0]=0,_u[1]=0,_u[2]=0),function(){var e=new qi(4);qi!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var ec=(function(){var e=new qi(2);qi!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,gu)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new zo(r)},t.prototype.queryRadius=function(r){var s=r;return Fs("circle-radius",this,s)+Fs("circle-stroke-width",this,s)+Wa(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,s,u,h,p,y,w,A){for(var M=nu(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,w),O=this.paint.get("circle-radius").evaluate(s,u)+this.paint.get("circle-stroke-width").evaluate(s,u),Z=this.paint.get("circle-pitch-alignment")==="map",X=Z?M:function(Fr,tn){return Fr.map(function(kn){return ms(kn,tn)})}(M,A),Ee=Z?O*w:O,Ie=0,Xe=h;Ie<Xe.length;Ie+=1)for(var Be=0,ut=Xe[Ie];Be<ut.length;Be+=1){var It=ut[Be],Ht=Z?It:ms(It,A),Jt=Ee,mr=zl([],[It.x,It.y,0,1],A);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Jt*=mr[3]/y.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Jt*=y.cameraToCenterDistance/mr[3]),Bo(X,Ht,Jt))return!0}return!1},t}(Ta));function ms(e,t){var r=zl([],[e.x,e.y,0,1],t);return new Le(r[0]/r[3],r[1]/r[3])}var vl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(zo);function Ps(e,t,r,s){var u=t.width,h=t.height;if(s){if(s instanceof Uint8ClampedArray)s=new Uint8Array(s.buffer);else if(s.length!==u*h*r)throw new RangeError("mismatched image size")}else s=new Uint8Array(u*h*r);return e.width=u,e.height=h,e.data=s,e}function Lu(e,t,r){var s=t.width,u=t.height;if(s!==e.width||u!==e.height){var h=Ps({},{width:s,height:u},r);Bl(e,h,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,s),height:Math.min(e.height,u)},r),e.width=s,e.height=u,e.data=h.data}}function Bl(e,t,r,s,u,h){if(u.width===0||u.height===0)return t;if(u.width>e.width||u.height>e.height||r.x>e.width-u.width||r.y>e.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>t.width||u.height>t.height||s.x>t.width-u.width||s.y>t.height-u.height)throw new RangeError("out of range destination coordinates for image copy");for(var p=e.data,y=t.data,w=0;w<u.height;w++)for(var A=((r.y+w)*e.width+r.x)*h,M=((s.y+w)*t.width+s.x)*h,O=0;O<u.width*h;O++)y[M+O]=p[A+O];return t}dn("HeatmapBucket",vl,{omit:["layers"]});var zs=function(e,t){Ps(this,e,1,t)};zs.prototype.resize=function(e){Lu(this,e,1)},zs.prototype.clone=function(){return new zs({width:this.width,height:this.height},new Uint8Array(this.data))},zs.copy=function(e,t,r,s,u){Bl(e,t,r,s,u,1)};var fo=function(e,t){Ps(this,e,4,t)};fo.prototype.resize=function(e){Lu(this,e,4)},fo.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},fo.prototype.clone=function(){return new fo({width:this.width,height:this.height},new Uint8Array(this.data))},fo.copy=function(e,t,r,s,u){Bl(e,t,r,s,u,4)},dn("AlphaImage",zs),dn("RGBAImage",fo);var Nl={paint:new xi({"heatmap-radius":new or(J.paint_heatmap["heatmap-radius"]),"heatmap-weight":new or(J.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new tr(J.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ni(J.paint_heatmap["heatmap-color"]),"heatmap-opacity":new tr(J.paint_heatmap["heatmap-opacity"])})};function vc(e){var t={},r=e.resolution||256,s=e.clips?e.clips.length:1,u=e.image||new fo({width:r,height:s}),h=function(Ee,Ie,Xe){t[e.evaluationKey]=Xe;var Be=e.expression.evaluate(t);u.data[Ee+Ie+0]=Math.floor(255*Be.r/Be.a),u.data[Ee+Ie+1]=Math.floor(255*Be.g/Be.a),u.data[Ee+Ie+2]=Math.floor(255*Be.b/Be.a),u.data[Ee+Ie+3]=Math.floor(255*Be.a)};if(e.clips)for(var p=0,y=0;p<s;++p,y+=4*r)for(var w=0,A=0;w<r;w++,A+=4){var M=w/(r-1),O=e.clips[p];h(y,A,O.start*(1-M)+O.end*M)}else for(var Z=0,X=0;Z<r;Z++,X+=4)h(0,X,Z/(r-1));return u}var Lc=function(e){function t(r){e.call(this,r,Nl),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new vl(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=vc({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(Ta),yc={paint:new xi({"hillshade-illumination-direction":new tr(J.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new tr(J.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new tr(J.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new tr(J.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new tr(J.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new tr(J.paint_hillshade["hillshade-accent-color"])})},ah=function(e){function t(r){e.call(this,r,yc)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(Ta),oh=yi([{name:"a_pos",components:2,type:"Int16"}],4).members,yl=Dc,tc=Dc;function Dc(e,t,r){r=r||2;var s,u,h,p,y,w,A,M=t&&t.length,O=M?t[0]*r:e.length,Z=Ph(e,0,O,r,!0),X=[];if(!Z||Z.next===Z.prev)return X;if(M&&(Z=function(Ie,Xe,Be,ut){var It,Ht,Jt,mr=[];for(It=0,Ht=Xe.length;It<Ht;It++)(Jt=Ph(Ie,Xe[It]*ut,It<Ht-1?Xe[It+1]*ut:Ie.length,ut,!1))===Jt.next&&(Jt.steiner=!0),mr.push(cf(Jt));for(mr.sort(uf),It=0;It<mr.length;It++)lf(mr[It],Be),Be=Xu(Be,Be.next);return Be}(e,t,Z,r)),e.length>80*r){s=h=e[0],u=p=e[1];for(var Ee=r;Ee<O;Ee+=r)(y=e[Ee])<s&&(s=y),(w=e[Ee+1])<u&&(u=w),y>h&&(h=y),w>p&&(p=w);A=(A=Math.max(h-s,p-u))!==0?1/A:0}return rc(Z,X,r,s,u,A),X}function Ph(e,t,r,s,u){var h,p;if(u===xc(e,t,r,s)>0)for(h=t;h<r;h+=s)p=_c(h,e[h],e[h+1],p);else for(h=r-s;h>=t;h-=s)p=_c(h,e[h],e[h+1],p);return p&&Rc(p,p.next)&&(gl(p),p=p.next),p}function Xu(e,t){if(!e)return e;t||(t=e);var r,s=e;do if(r=!1,s.steiner||!Rc(s,s.next)&&ro(s.prev,s,s.next)!==0)s=s.next;else{if(gl(s),(s=t=s.prev)===s.next)break;r=!0}while(r||s!==t);return t}function rc(e,t,r,s,u,h,p){if(e){!p&&h&&function(M,O,Z,X){var Ee=M;do Ee.z===null&&(Ee.z=uh(Ee.x,Ee.y,O,Z,X)),Ee.prevZ=Ee.prev,Ee.nextZ=Ee.next,Ee=Ee.next;while(Ee!==M);Ee.prevZ.nextZ=null,Ee.prevZ=null,function(Ie){var Xe,Be,ut,It,Ht,Jt,mr,Fr,tn=1;do{for(Be=Ie,Ie=null,Ht=null,Jt=0;Be;){for(Jt++,ut=Be,mr=0,Xe=0;Xe<tn&&(mr++,ut=ut.nextZ);Xe++);for(Fr=tn;mr>0||Fr>0&&ut;)mr!==0&&(Fr===0||!ut||Be.z<=ut.z)?(It=Be,Be=Be.nextZ,mr--):(It=ut,ut=ut.nextZ,Fr--),Ht?Ht.nextZ=It:Ie=It,It.prevZ=Ht,Ht=It;Be=ut}Ht.nextZ=null,tn*=2}while(Jt>1)}(Ee)}(e,s,u,h);for(var y,w,A=e;e.prev!==e.next;)if(y=e.prev,w=e.next,h?sf(e,s,u,h):Mh(e))t.push(y.i/r),t.push(e.i/r),t.push(w.i/r),gl(e),e=w.next,A=w.next;else if((e=w)===A){p?p===1?rc(e=nc(Xu(e),t,r),t,r,s,u,h,2):p===2&&sh(e,t,r,s,u,h):rc(Xu(e),t,r,s,u,h,1);break}}}function Mh(e){var t=e.prev,r=e,s=e.next;if(ro(t,r,s)>=0)return!1;for(var u=e.next.next;u!==e.prev;){if(ic(t.x,t.y,r.x,r.y,s.x,s.y,u.x,u.y)&&ro(u.prev,u,u.next)>=0)return!1;u=u.next}return!0}function sf(e,t,r,s){var u=e.prev,h=e,p=e.next;if(ro(u,h,p)>=0)return!1;for(var y=u.x>h.x?u.x>p.x?u.x:p.x:h.x>p.x?h.x:p.x,w=u.y>h.y?u.y>p.y?u.y:p.y:h.y>p.y?h.y:p.y,A=uh(u.x<h.x?u.x<p.x?u.x:p.x:h.x<p.x?h.x:p.x,u.y<h.y?u.y<p.y?u.y:p.y:h.y<p.y?h.y:p.y,t,r,s),M=uh(y,w,t,r,s),O=e.prevZ,Z=e.nextZ;O&&O.z>=A&&Z&&Z.z<=M;){if(O!==e.prev&&O!==e.next&&ic(u.x,u.y,h.x,h.y,p.x,p.y,O.x,O.y)&&ro(O.prev,O,O.next)>=0||(O=O.prevZ,Z!==e.prev&&Z!==e.next&&ic(u.x,u.y,h.x,h.y,p.x,p.y,Z.x,Z.y)&&ro(Z.prev,Z,Z.next)>=0))return!1;Z=Z.nextZ}for(;O&&O.z>=A;){if(O!==e.prev&&O!==e.next&&ic(u.x,u.y,h.x,h.y,p.x,p.y,O.x,O.y)&&ro(O.prev,O,O.next)>=0)return!1;O=O.prevZ}for(;Z&&Z.z<=M;){if(Z!==e.prev&&Z!==e.next&&ic(u.x,u.y,h.x,h.y,p.x,p.y,Z.x,Z.y)&&ro(Z.prev,Z,Z.next)>=0)return!1;Z=Z.nextZ}return!0}function nc(e,t,r){var s=e;do{var u=s.prev,h=s.next.next;!Rc(u,h)&&Dh(u,s,s.next,h)&&gc(u,h)&&gc(h,u)&&(t.push(u.i/r),t.push(s.i/r),t.push(h.i/r),gl(s),gl(s.next),s=e=h),s=s.next}while(s!==e);return Xu(s)}function sh(e,t,r,s,u,h){var p=e;do{for(var y=p.next.next;y!==p.prev;){if(p.i!==y.i&&hf(p,y)){var w=zc(p,y);return p=Xu(p,p.next),w=Xu(w,w.next),rc(p,t,r,s,u,h),void rc(w,t,r,s,u,h)}y=y.next}p=p.next}while(p!==e)}function uf(e,t){return e.x-t.x}function lf(e,t){if(t=function(s,u){var h,p=u,y=s.x,w=s.y,A=-1/0;do{if(w<=p.y&&w>=p.next.y&&p.next.y!==p.y){var M=p.x+(w-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(M<=y&&M>A){if(A=M,M===y){if(w===p.y)return p;if(w===p.next.y)return p.next}h=p.x<p.next.x?p:p.next}}p=p.next}while(p!==u);if(!h)return null;if(y===A)return h;var O,Z=h,X=h.x,Ee=h.y,Ie=1/0;p=h;do y>=p.x&&p.x>=X&&y!==p.x&&ic(w<Ee?y:A,w,X,Ee,w<Ee?A:y,w,p.x,p.y)&&(O=Math.abs(w-p.y)/(y-p.x),gc(p,s)&&(O<Ie||O===Ie&&(p.x>h.x||p.x===h.x&&Lh(h,p)))&&(h=p,Ie=O)),p=p.next;while(p!==Z);return h}(e,t)){var r=zc(t,e);Xu(t,t.next),Xu(r,r.next)}}function Lh(e,t){return ro(e.prev,e,t.prev)<0&&ro(t.next,e,e.next)<0}function uh(e,t,r,s,u){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*u)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-s)*u)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function cf(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function ic(e,t,r,s,u,h,p,y){return(u-p)*(t-y)-(e-p)*(h-y)>=0&&(e-p)*(s-y)-(r-p)*(t-y)>=0&&(r-p)*(h-y)-(u-p)*(s-y)>=0}function hf(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,s){var u=r;do{if(u.i!==r.i&&u.next.i!==r.i&&u.i!==s.i&&u.next.i!==s.i&&Dh(u,u.next,r,s))return!0;u=u.next}while(u!==r);return!1}(e,t)&&(gc(e,t)&&gc(t,e)&&function(r,s){var u=r,h=!1,p=(r.x+s.x)/2,y=(r.y+s.y)/2;do u.y>y!=u.next.y>y&&u.next.y!==u.y&&p<(u.next.x-u.x)*(y-u.y)/(u.next.y-u.y)+u.x&&(h=!h),u=u.next;while(u!==r);return h}(e,t)&&(ro(e.prev,e,t.prev)||ro(e,t.prev,t))||Rc(e,t)&&ro(e.prev,e,e.next)>0&&ro(t.prev,t,t.next)>0)}function ro(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Rc(e,t){return e.x===t.x&&e.y===t.y}function Dh(e,t,r,s){var u=Fc(ro(e,t,r)),h=Fc(ro(e,t,s)),p=Fc(ro(r,s,e)),y=Fc(ro(r,s,t));return u!==h&&p!==y||!(u!==0||!Oc(e,r,t))||!(h!==0||!Oc(e,s,t))||!(p!==0||!Oc(r,e,s))||!(y!==0||!Oc(r,t,s))}function Oc(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Fc(e){return e>0?1:e<0?-1:0}function gc(e,t){return ro(e.prev,e,e.next)<0?ro(e,t,e.next)>=0&&ro(e,e.prev,t)>=0:ro(e,t,e.prev)<0||ro(e,e.next,t)<0}function zc(e,t){var r=new ac(e.i,e.x,e.y),s=new ac(t.i,t.x,t.y),u=e.next,h=t.prev;return e.next=t,t.prev=e,r.next=u,u.prev=r,s.next=r,r.prev=s,h.next=s,s.prev=h,s}function _c(e,t,r,s){var u=new ac(e,t,r);return s?(u.next=s.next,u.prev=s,s.next.prev=u,s.next=u):(u.prev=u,u.next=u),u}function gl(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function ac(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function xc(e,t,r,s){for(var u=0,h=t,p=r-s;h<r;h+=s)u+=(e[p]-e[h])*(e[h+1]+e[p+1]),p=h;return u}function Bc(e,t,r,s,u){(function h(p,y,w,A,M){for(;A>w;){if(A-w>600){var O=A-w+1,Z=y-w+1,X=Math.log(O),Ee=.5*Math.exp(2*X/3),Ie=.5*Math.sqrt(X*Ee*(O-Ee)/O)*(Z-O/2<0?-1:1);h(p,y,Math.max(w,Math.floor(y-Z*Ee/O+Ie)),Math.min(A,Math.floor(y+(O-Z)*Ee/O+Ie)),M)}var Xe=p[y],Be=w,ut=A;for(_l(p,w,y),M(p[A],Xe)>0&&_l(p,w,A);Be<ut;){for(_l(p,Be,ut),Be++,ut--;M(p[Be],Xe)<0;)Be++;for(;M(p[ut],Xe)>0;)ut--}M(p[w],Xe)===0?_l(p,w,ut):_l(p,++ut,A),ut<=y&&(w=ut+1),y<=ut&&(A=ut-1)}})(e,t,r||0,s||e.length-1,u||Nc)}function _l(e,t,r){var s=e[t];e[t]=e[r],e[r]=s}function Nc(e,t){return e<t?-1:e>t?1:0}function bc(e,t){var r=e.length;if(r<=1)return[e];for(var s,u,h=[],p=0;p<r;p++){var y=Qt(e[p]);y!==0&&(e[p].area=Math.abs(y),u===void 0&&(u=y<0),u===y<0?(s&&h.push(s),s=[e[p]]):s.push(e[p]))}if(s&&h.push(s),t>1)for(var w=0;w<h.length;w++)h[w].length<=t||(Bc(h[w],t,1,h[w].length-1,Vc),h[w]=h[w].slice(0,t));return h}function Vc(e,t){return t.area-e.area}function oc(e,t,r){for(var s=r.patternDependencies,u=!1,h=0,p=t;h<p.length;h+=1){var y=p[h].paint.get(e+"-pattern");y.isConstant()||(u=!0);var w=y.constantOr(null);w&&(u=!0,s[w.to]=!0,s[w.from]=!0)}return u}function sc(e,t,r,s,u){for(var h=u.patternDependencies,p=0,y=t;p<y.length;p+=1){var w=y[p],A=w.paint.get(e+"-pattern").value;if(A.kind!=="constant"){var M=A.evaluate({zoom:s-1},r,{},u.availableImages),O=A.evaluate({zoom:s},r,{},u.availableImages),Z=A.evaluate({zoom:s+1},r,{},u.availableImages);O=O&&O.name?O.name:O,Z=Z&&Z.name?Z.name:Z,h[M=M&&M.name?M.name:M]=!0,h[O]=!0,h[Z]=!0,r.patterns[w.id]={min:M,mid:O,max:Z}}}return r}Dc.deviation=function(e,t,r,s){var u=t&&t.length,h=Math.abs(xc(e,0,u?t[0]*r:e.length,r));if(u)for(var p=0,y=t.length;p<y;p++)h-=Math.abs(xc(e,t[p]*r,p<y-1?t[p+1]*r:e.length,r));var w=0;for(p=0;p<s.length;p+=3){var A=s[p]*r,M=s[p+1]*r,O=s[p+2]*r;w+=Math.abs((e[A]-e[O])*(e[M+1]-e[A+1])-(e[A]-e[M])*(e[O+1]-e[A+1]))}return h===0&&w===0?0:Math.abs((w-h)/h)},Dc.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},s=0,u=0;u<e.length;u++){for(var h=0;h<e[u].length;h++)for(var p=0;p<t;p++)r.vertices.push(e[u][h][p]);u>0&&r.holes.push(s+=e[u-1].length)}return r},yl.default=tc;var vs=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new si,this.indexArray=new $s,this.indexArray2=new qu,this.programConfigurations=new Nn(e.layers,e.zoom),this.segments=new ee,this.segments2=new ee,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};vs.prototype.populate=function(e,t,r){this.hasPattern=oc("fill",this.layers,t);for(var s=this.layers[0].layout.get("fill-sort-key"),u=[],h=0,p=e;h<p.length;h+=1){var y=p[h],w=y.feature,A=y.id,M=y.index,O=y.sourceLayerIndex,Z=this.layers[0]._featureFilter.needGeometry,X=Na(w,Z);if(this.layers[0]._featureFilter.filter(new $(this.zoom),X,r)){var Ee=s?s.evaluate(X,{},r,t.availableImages):void 0,Ie={id:A,properties:w.properties,type:w.type,sourceLayerIndex:O,index:M,geometry:Z?X.geometry:Ia(w),patterns:{},sortKey:Ee};u.push(Ie)}}s&&u.sort(function(Fr,tn){return Fr.sortKey-tn.sortKey});for(var Xe=0,Be=u;Xe<Be.length;Xe+=1){var ut=Be[Xe],It=ut.geometry,Ht=ut.index,Jt=ut.sourceLayerIndex;if(this.hasPattern){var mr=sc("fill",this.layers,ut,this.zoom,t);this.patternFeatures.push(mr)}else this.addFeature(ut,It,Ht,r,{});t.featureIndex.insert(e[Ht].feature,It,Ht,Jt,this.index)}},vs.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},vs.prototype.addFeatures=function(e,t,r){for(var s=0,u=this.patternFeatures;s<u.length;s+=1){var h=u[s];this.addFeature(h,h.geometry,h.index,t,r)}},vs.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},vs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},vs.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,oh),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},vs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},vs.prototype.addFeature=function(e,t,r,s,u){for(var h=0,p=bc(t,500);h<p.length;h+=1){for(var y=p[h],w=0,A=0,M=y;A<M.length;A+=1)w+=M[A].length;for(var O=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),Z=O.vertexLength,X=[],Ee=[],Ie=0,Xe=y;Ie<Xe.length;Ie+=1){var Be=Xe[Ie];if(Be.length!==0){Be!==y[0]&&Ee.push(X.length/2);var ut=this.segments2.prepareSegment(Be.length,this.layoutVertexArray,this.indexArray2),It=ut.vertexLength;this.layoutVertexArray.emplaceBack(Be[0].x,Be[0].y),this.indexArray2.emplaceBack(It+Be.length-1,It),X.push(Be[0].x),X.push(Be[0].y);for(var Ht=1;Ht<Be.length;Ht++)this.layoutVertexArray.emplaceBack(Be[Ht].x,Be[Ht].y),this.indexArray2.emplaceBack(It+Ht-1,It+Ht),X.push(Be[Ht].x),X.push(Be[Ht].y);ut.vertexLength+=Be.length,ut.primitiveLength+=Be.length}}for(var Jt=yl(X,Ee),mr=0;mr<Jt.length;mr+=3)this.indexArray.emplaceBack(Z+Jt[mr],Z+Jt[mr+1],Z+Jt[mr+2]);O.vertexLength+=w,O.primitiveLength+=Jt.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,u,s)},dn("FillBucket",vs,{omit:["layers","patternFeatures"]});var wc=new xi({"fill-sort-key":new or(J.layout_fill["fill-sort-key"])}),Ec={paint:new xi({"fill-antialias":new tr(J.paint_fill["fill-antialias"]),"fill-opacity":new or(J.paint_fill["fill-opacity"]),"fill-color":new or(J.paint_fill["fill-color"]),"fill-outline-color":new or(J.paint_fill["fill-outline-color"]),"fill-translate":new tr(J.paint_fill["fill-translate"]),"fill-translate-anchor":new tr(J.paint_fill["fill-translate-anchor"]),"fill-pattern":new jn(J.paint_fill["fill-pattern"])}),layout:wc},Sc=function(e){function t(r){e.call(this,r,Ec)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,s){e.prototype.recalculate.call(this,r,s);var u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new vs(r)},t.prototype.queryRadius=function(){return Wa(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,s,u,h,p,y,w){return Is(nu(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,w),h)},t.prototype.isTileClipped=function(){return!0},t}(Ta),Tc=yi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Uc=Du;function Du(e,t,r,s,u){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=s,this._values=u,e.readFields(Vl,this,t)}function Vl(e,t,r){e==1?t.id=r.readVarint():e==2?function(s,u){for(var h=s.readVarint()+s.pos;s.pos<h;){var p=u._keys[s.readVarint()],y=u._values[s.readVarint()];u.properties[p]=y}}(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function Rh(e){for(var t,r,s=0,u=0,h=e.length,p=h-1;u<h;p=u++)s+=((r=e[p]).x-(t=e[u]).x)*(t.y+r.y);return s}Du.types=["Unknown","Point","LineString","Polygon"],Du.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,s=1,u=0,h=0,p=0,y=[];e.pos<r;){if(u<=0){var w=e.readVarint();s=7&w,u=w>>3}if(u--,s===1||s===2)h+=e.readSVarint(),p+=e.readSVarint(),s===1&&(t&&y.push(t),t=[]),t.push(new Le(h,p));else{if(s!==7)throw new Error("unknown command "+s);t&&t.push(t[0].clone())}}return t&&y.push(t),y},Du.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,s=0,u=0,h=0,p=1/0,y=-1/0,w=1/0,A=-1/0;e.pos<t;){if(s<=0){var M=e.readVarint();r=7&M,s=M>>3}if(s--,r===1||r===2)(u+=e.readSVarint())<p&&(p=u),u>y&&(y=u),(h+=e.readSVarint())<w&&(w=h),h>A&&(A=h);else if(r!==7)throw new Error("unknown command "+r)}return[p,w,y,A]},Du.prototype.toGeoJSON=function(e,t,r){var s,u,h=this.extent*Math.pow(2,r),p=this.extent*e,y=this.extent*t,w=this.loadGeometry(),A=Du.types[this.type];function M(X){for(var Ee=0;Ee<X.length;Ee++){var Ie=X[Ee];X[Ee]=[360*(Ie.x+p)/h-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ie.y+y)/h)*Math.PI/180))-90]}}switch(this.type){case 1:var O=[];for(s=0;s<w.length;s++)O[s]=w[s][0];M(w=O);break;case 2:for(s=0;s<w.length;s++)M(w[s]);break;case 3:for(w=function(X){var Ee=X.length;if(Ee<=1)return[X];for(var Ie,Xe,Be=[],ut=0;ut<Ee;ut++){var It=Rh(X[ut]);It!==0&&(Xe===void 0&&(Xe=It<0),Xe===It<0?(Ie&&Be.push(Ie),Ie=[X[ut]]):Ie.push(X[ut]))}return Ie&&Be.push(Ie),Be}(w),s=0;s<w.length;s++)for(u=0;u<w[s].length;u++)M(w[s][u])}w.length===1?w=w[0]:A="Multi"+A;var Z={type:"Feature",geometry:{type:A,coordinates:w},properties:this.properties};return"id"in this&&(Z.id=this.id),Z};var Gc=Oh;function Oh(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(ff,this,t),this.length=this._features.length}function ff(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(function(s){for(var u=null,h=s.readVarint()+s.pos;s.pos<h;){var p=s.readVarint()>>3;u=p===1?s.readString():p===2?s.readFloat():p===3?s.readDouble():p===4?s.readVarint64():p===5?s.readVarint():p===6?s.readSVarint():p===7?s.readBoolean():null}return u}(r))}function pf(e,t,r){if(e===3){var s=new Gc(r,r.readVarint()+r.pos);s.length&&(t[s.name]=s)}}Oh.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Uc(this._pbf,t,this.extent,this._keys,this._values)};var Bs={VectorTile:function(e,t){this.layers=e.readFields(pf,{},t)},VectorTileFeature:Uc,VectorTileLayer:Gc},Fh=Bs.VectorTileFeature.types,jc=Math.pow(2,13);function uc(e,t,r,s,u,h,p,y){e.emplaceBack(t,r,2*Math.floor(s*jc)+p,u*jc*2,h*jc*2,Math.round(y))}var xu=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ba,this.indexArray=new $s,this.programConfigurations=new Nn(e.layers,e.zoom),this.segments=new ee,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function zh(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}xu.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=oc("fill-extrusion",this.layers,t);for(var s=0,u=e;s<u.length;s+=1){var h=u[s],p=h.feature,y=h.id,w=h.index,A=h.sourceLayerIndex,M=this.layers[0]._featureFilter.needGeometry,O=Na(p,M);if(this.layers[0]._featureFilter.filter(new $(this.zoom),O,r)){var Z={id:y,sourceLayerIndex:A,index:w,geometry:M?O.geometry:Ia(p),properties:p.properties,type:p.type,patterns:{}};this.hasPattern?this.features.push(sc("fill-extrusion",this.layers,Z,this.zoom,t)):this.addFeature(Z,Z.geometry,w,r,{}),t.featureIndex.insert(p,Z.geometry,w,A,this.index,!0)}}},xu.prototype.addFeatures=function(e,t,r){for(var s=0,u=this.features;s<u.length;s+=1){var h=u[s];this.addFeature(h,h.geometry,h.index,t,r)}},xu.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},xu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},xu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},xu.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Tc),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},xu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},xu.prototype.addFeature=function(e,t,r,s,u){for(var h=0,p=bc(t,500);h<p.length;h+=1){for(var y=p[h],w=0,A=0,M=y;A<M.length;A+=1)w+=M[A].length;for(var O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Z=0,X=y;Z<X.length;Z+=1){var Ee=X[Z];if(Ee.length!==0&&!((Pi=Ee).every(function(pi){return pi.x<0})||Pi.every(function(pi){return pi.x>8192})||Pi.every(function(pi){return pi.y<0})||Pi.every(function(pi){return pi.y>8192})))for(var Ie=0,Xe=0;Xe<Ee.length;Xe++){var Be=Ee[Xe];if(Xe>=1){var ut=Ee[Xe-1];if(!zh(Be,ut)){O.vertexLength+4>ee.MAX_VERTEX_ARRAY_LENGTH&&(O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var It=Be.sub(ut)._perp()._unit(),Ht=ut.dist(Be);Ie+Ht>32768&&(Ie=0),uc(this.layoutVertexArray,Be.x,Be.y,It.x,It.y,0,0,Ie),uc(this.layoutVertexArray,Be.x,Be.y,It.x,It.y,0,1,Ie),uc(this.layoutVertexArray,ut.x,ut.y,It.x,It.y,0,0,Ie+=Ht),uc(this.layoutVertexArray,ut.x,ut.y,It.x,It.y,0,1,Ie);var Jt=O.vertexLength;this.indexArray.emplaceBack(Jt,Jt+2,Jt+1),this.indexArray.emplaceBack(Jt+1,Jt+2,Jt+3),O.vertexLength+=4,O.primitiveLength+=2}}}}if(O.vertexLength+w>ee.MAX_VERTEX_ARRAY_LENGTH&&(O=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray)),Fh[e.type]==="Polygon"){for(var mr=[],Fr=[],tn=O.vertexLength,kn=0,yn=y;kn<yn.length;kn+=1){var On=yn[kn];if(On.length!==0){On!==y[0]&&Fr.push(mr.length/2);for(var xn=0;xn<On.length;xn++){var gi=On[xn];uc(this.layoutVertexArray,gi.x,gi.y,0,0,1,1,0),mr.push(gi.x),mr.push(gi.y)}}}for(var Hn=yl(mr,Fr),In=0;In<Hn.length;In+=3)this.indexArray.emplaceBack(tn+Hn[In],tn+Hn[In+2],tn+Hn[In+1]);O.primitiveLength+=Hn.length/3,O.vertexLength+=w}}var Pi;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,u,s)},dn("FillExtrusionBucket",xu,{omit:["layers","features"]});var df={paint:new xi({"fill-extrusion-opacity":new tr(J["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new or(J["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new tr(J["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new tr(J["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new jn(J["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new or(J["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new or(J["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new tr(J["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Ru=function(e){function t(r){e.call(this,r,df)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new xu(r)},t.prototype.queryRadius=function(){return Wa(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,s,u,h,p,y,w,A){var M=nu(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,w),O=this.paint.get("fill-extrusion-height").evaluate(s,u),Z=this.paint.get("fill-extrusion-base").evaluate(s,u),X=function(Ie,Xe,Be,ut){for(var It=[],Ht=0,Jt=Ie;Ht<Jt.length;Ht+=1){var mr=Jt[Ht],Fr=[mr.x,mr.y,0,1];zl(Fr,Fr,Xe),It.push(new Le(Fr[0]/Fr[3],Fr[1]/Fr[3]))}return It}(M,A),Ee=function(Ie,Xe,Be,ut){for(var It=[],Ht=[],Jt=ut[8]*Xe,mr=ut[9]*Xe,Fr=ut[10]*Xe,tn=ut[11]*Xe,kn=ut[8]*Be,yn=ut[9]*Be,On=ut[10]*Be,xn=ut[11]*Be,gi=0,Hn=Ie;gi<Hn.length;gi+=1){for(var In=[],Pi=[],pi=0,Ui=Hn[gi];pi<Ui.length;pi+=1){var Fn=Ui[pi],Ji=Fn.x,Ra=Fn.y,Ka=ut[0]*Ji+ut[4]*Ra+ut[12],Za=ut[1]*Ji+ut[5]*Ra+ut[13],Oa=ut[2]*Ji+ut[6]*Ra+ut[14],Ja=ut[3]*Ji+ut[7]*Ra+ut[15],Do=Oa+Fr,Ro=Ja+tn,ss=Ka+kn,Go=Za+yn,us=Oa+On,io=Ja+xn,jo=new Le((Ka+Jt)/Ro,(Za+mr)/Ro);jo.z=Do/Ro,In.push(jo);var Ri=new Le(ss/io,Go/io);Ri.z=us/io,Pi.push(Ri)}It.push(In),Ht.push(Pi)}return[It,Ht]}(h,Z,O,A);return function(Ie,Xe,Be){var ut=1/0;Is(Be,Xe)&&(ut=Ul(Be,Xe[0]));for(var It=0;It<Xe.length;It++)for(var Ht=Xe[It],Jt=Ie[It],mr=0;mr<Ht.length-1;mr++){var Fr=Ht[mr],tn=[Fr,Ht[mr+1],Jt[mr+1],Jt[mr],Fr];tu(Be,tn)&&(ut=Math.min(ut,Ul(Be,tn)))}return ut!==1/0&&ut}(Ee[0],Ee[1],X)},t}(Ta);function lc(e,t){return e.x*t.x+e.y*t.y}function Ul(e,t){if(e.length===1){for(var r,s=0,u=t[s++];!r||u.equals(r);)if(!(r=t[s++]))return 1/0;for(;s<t.length;s++){var h=t[s],p=e[0],y=r.sub(u),w=h.sub(u),A=p.sub(u),M=lc(y,y),O=lc(y,w),Z=lc(w,w),X=lc(A,y),Ee=lc(A,w),Ie=M*Z-O*O,Xe=(Z*X-O*Ee)/Ie,Be=(M*Ee-O*X)/Ie,ut=u.z*(1-Xe-Be)+r.z*Xe+h.z*Be;if(isFinite(ut))return ut}return 1/0}for(var It=1/0,Ht=0,Jt=t;Ht<Jt.length;Ht+=1)It=Math.min(It,Jt[Ht].z);return It}var xl=yi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Bh=yi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,lh=Bs.VectorTileFeature.types,qc=Math.cos(Math.PI/180*37.5),ch=Math.pow(2,14)/.5,ra=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(r){t.gradients[r.id]={}}),this.layoutVertexArray=new ji,this.layoutVertexArray2=new ri,this.indexArray=new $s,this.programConfigurations=new Nn(e.layers,e.zoom),this.segments=new ee,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};ra.prototype.populate=function(e,t,r){this.hasPattern=oc("line",this.layers,t);for(var s=this.layers[0].layout.get("line-sort-key"),u=[],h=0,p=e;h<p.length;h+=1){var y=p[h],w=y.feature,A=y.id,M=y.index,O=y.sourceLayerIndex,Z=this.layers[0]._featureFilter.needGeometry,X=Na(w,Z);if(this.layers[0]._featureFilter.filter(new $(this.zoom),X,r)){var Ee=s?s.evaluate(X,{},r):void 0,Ie={id:A,properties:w.properties,type:w.type,sourceLayerIndex:O,index:M,geometry:Z?X.geometry:Ia(w),patterns:{},sortKey:Ee};u.push(Ie)}}s&&u.sort(function(Fr,tn){return Fr.sortKey-tn.sortKey});for(var Xe=0,Be=u;Xe<Be.length;Xe+=1){var ut=Be[Xe],It=ut.geometry,Ht=ut.index,Jt=ut.sourceLayerIndex;if(this.hasPattern){var mr=sc("line",this.layers,ut,this.zoom,t);this.patternFeatures.push(mr)}else this.addFeature(ut,It,Ht,r,{});t.featureIndex.insert(e[Ht].feature,It,Ht,Jt,this.index)}},ra.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},ra.prototype.addFeatures=function(e,t,r){for(var s=0,u=this.patternFeatures;s<u.length;s+=1){var h=u[s];this.addFeature(h,h.geometry,h.index,t,r)}},ra.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ra.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ra.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Bh)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xl),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},ra.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ra.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},ra.prototype.addFeature=function(e,t,r,s,u){var h=this.layers[0].layout,p=h.get("line-join").evaluate(e,{}),y=h.get("line-cap"),w=h.get("line-miter-limit"),A=h.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var M=0,O=t;M<O.length;M+=1)this.addLine(O[M],e,p,y,w,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,u,s)},ra.prototype.addLine=function(e,t,r,s,u,h){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var p=0;p<e.length-1;p++)this.totalDistance+=e[p].dist(e[p+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var y=lh[t.type]==="Polygon",w=e.length;w>=2&&e[w-1].equals(e[w-2]);)w--;for(var A=0;A<w-1&&e[A].equals(e[A+1]);)A++;if(!(w<(y?3:2))){r==="bevel"&&(u=1.05);var M,O=this.overscaling<=16?122880/(512*this.overscaling):0,Z=this.segments.prepareSegment(10*w,this.layoutVertexArray,this.indexArray),X=void 0,Ee=void 0,Ie=void 0,Xe=void 0;this.e1=this.e2=-1,y&&(Xe=e[A].sub(M=e[w-2])._unit()._perp());for(var Be=A;Be<w;Be++)if(!(Ee=Be===w-1?y?e[A+1]:void 0:e[Be+1])||!e[Be].equals(Ee)){Xe&&(Ie=Xe),M&&(X=M),M=e[Be],Xe=Ee?Ee.sub(M)._unit()._perp():Ie;var ut=(Ie=Ie||Xe).add(Xe);ut.x===0&&ut.y===0||ut._unit();var It=Ie.x*Xe.x+Ie.y*Xe.y,Ht=ut.x*Xe.x+ut.y*Xe.y,Jt=Ht!==0?1/Ht:1/0,mr=2*Math.sqrt(2-2*Ht),Fr=Ht<qc&&X&&Ee,tn=Ie.x*Xe.y-Ie.y*Xe.x>0;if(Fr&&Be>A){var kn=M.dist(X);if(kn>2*O){var yn=M.sub(M.sub(X)._mult(O/kn)._round());this.updateDistance(X,yn),this.addCurrentVertex(yn,Ie,0,0,Z),X=yn}}var On=X&&Ee,xn=On?r:y?"butt":s;if(On&&xn==="round"&&(Jt<h?xn="miter":Jt<=2&&(xn="fakeround")),xn==="miter"&&Jt>u&&(xn="bevel"),xn==="bevel"&&(Jt>2&&(xn="flipbevel"),Jt<u&&(xn="miter")),X&&this.updateDistance(X,M),xn==="miter")ut._mult(Jt),this.addCurrentVertex(M,ut,0,0,Z);else if(xn==="flipbevel"){if(Jt>100)ut=Xe.mult(-1);else{var gi=Jt*Ie.add(Xe).mag()/Ie.sub(Xe).mag();ut._perp()._mult(gi*(tn?-1:1))}this.addCurrentVertex(M,ut,0,0,Z),this.addCurrentVertex(M,ut.mult(-1),0,0,Z)}else if(xn==="bevel"||xn==="fakeround"){var Hn=-Math.sqrt(Jt*Jt-1),In=tn?Hn:0,Pi=tn?0:Hn;if(X&&this.addCurrentVertex(M,Ie,In,Pi,Z),xn==="fakeround")for(var pi=Math.round(180*mr/Math.PI/20),Ui=1;Ui<pi;Ui++){var Fn=Ui/pi;if(Fn!==.5){var Ji=Fn-.5;Fn+=Fn*Ji*(Fn-1)*((1.0904+It*(It*(3.55645-1.43519*It)-3.2452))*Ji*Ji+(.848013+It*(.215638*It-1.06021)))}var Ra=Xe.sub(Ie)._mult(Fn)._add(Ie)._unit()._mult(tn?-1:1);this.addHalfVertex(M,Ra.x,Ra.y,!1,tn,0,Z)}Ee&&this.addCurrentVertex(M,Xe,-In,-Pi,Z)}else if(xn==="butt")this.addCurrentVertex(M,ut,0,0,Z);else if(xn==="square"){var Ka=X?1:-1;this.addCurrentVertex(M,ut,Ka,Ka,Z)}else xn==="round"&&(X&&(this.addCurrentVertex(M,Ie,0,0,Z),this.addCurrentVertex(M,Ie,1,1,Z,!0)),Ee&&(this.addCurrentVertex(M,Xe,-1,-1,Z,!0),this.addCurrentVertex(M,Xe,0,0,Z)));if(Fr&&Be<w-1){var Za=M.dist(Ee);if(Za>2*O){var Oa=M.add(Ee.sub(M)._mult(O/Za)._round());this.updateDistance(M,Oa),this.addCurrentVertex(Oa,Xe,0,0,Z),M=Oa}}}}},ra.prototype.addCurrentVertex=function(e,t,r,s,u,h){h===void 0&&(h=!1);var p=t.y*s-t.x,y=-t.y-t.x*s;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,h,!1,r,u),this.addHalfVertex(e,p,y,h,!0,-s,u),this.distance>ch/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,r,s,u,h))},ra.prototype.addHalfVertex=function(e,t,r,s,u,h,p){var y=.5*(this.lineClips?this.scaledDistance*(ch-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(s?1:0),(e.y<<1)+(u?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(h===0?0:h<0?-1:1)|(63&y)<<2,y>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var w=p.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,w),p.primitiveLength++),u?this.e2=w:this.e1=w},ra.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},ra.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},dn("LineBucket",ra,{omit:["layers","patternFeatures"]});var bl=new xi({"line-cap":new tr(J.layout_line["line-cap"]),"line-join":new or(J.layout_line["line-join"]),"line-miter-limit":new tr(J.layout_line["line-miter-limit"]),"line-round-limit":new tr(J.layout_line["line-round-limit"]),"line-sort-key":new or(J.layout_line["line-sort-key"])}),no={paint:new xi({"line-opacity":new or(J.paint_line["line-opacity"]),"line-color":new or(J.paint_line["line-color"]),"line-translate":new tr(J.paint_line["line-translate"]),"line-translate-anchor":new tr(J.paint_line["line-translate-anchor"]),"line-width":new or(J.paint_line["line-width"]),"line-gap-width":new or(J.paint_line["line-gap-width"]),"line-offset":new or(J.paint_line["line-offset"]),"line-blur":new or(J.paint_line["line-blur"]),"line-dasharray":new Ci(J.paint_line["line-dasharray"]),"line-pattern":new jn(J.paint_line["line-pattern"]),"line-gradient":new Ni(J.paint_line["line-gradient"])}),layout:bl},ys=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,s){return s=new $(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),e.prototype.possiblyEvaluate.call(this,r,s)},t.prototype.evaluate=function(r,s,u,h){return s=wt({},s,{zoom:Math.floor(s.zoom)}),e.prototype.evaluate.call(this,r,s,u,h)},t}(or))(no.paint.properties["line-width"].specification);ys.useIntegerZoom=!0;var Nh=function(e){function t(r){e.call(this,r,no),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof ja,this.gradientVersion=(this.gradientVersion+1)%dt)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,s){e.prototype.recalculate.call(this,r,s),this.paint._values["line-floorwidth"]=ys.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new ra(r)},t.prototype.queryRadius=function(r){var s=r,u=Vh(Fs("line-width",this,s),Fs("line-gap-width",this,s)),h=Fs("line-offset",this,s);return u/2+Math.abs(h)+Wa(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,s,u,h,p,y,w){var A=nu(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,w),M=w/2*Vh(this.paint.get("line-width").evaluate(s,u),this.paint.get("line-gap-width").evaluate(s,u)),O=this.paint.get("line-offset").evaluate(s,u);return O&&(h=function(Z,X){for(var Ee=[],Ie=new Le(0,0),Xe=0;Xe<Z.length;Xe++){for(var Be=Z[Xe],ut=[],It=0;It<Be.length;It++){var Ht=Be[It],Jt=Be[It+1],mr=It===0?Ie:Ht.sub(Be[It-1])._unit()._perp(),Fr=It===Be.length-1?Ie:Jt.sub(Ht)._unit()._perp(),tn=mr._add(Fr)._unit();tn._mult(1/(tn.x*Fr.x+tn.y*Fr.y)),ut.push(tn._mult(X)._add(Ht))}Ee.push(ut)}return Ee}(h,O*w)),function(Z,X,Ee){for(var Ie=0;Ie<X.length;Ie++){var Xe=X[Ie];if(Z.length>=3){for(var Be=0;Be<Xe.length;Be++)if(ks(Z,Xe[Be]))return!0}if(ds(Z,Xe,Ee))return!0}return!1}(A,h,M)},t.prototype.isTileClipped=function(){return!0},t}(Ta);function Vh(e,t){return t>0?t+2*e:e}var mf=yi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),vf=yi([{name:"a_projected_pos",components:3,type:"Float32"}],4),yf=(yi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),yi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),hh=(yi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),yi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),gf=yi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function _f(e,t,r){return e.sections.forEach(function(s){s.text=function(u,h,p){var y=h.layout.get("text-transform").evaluate(p,{});return y==="uppercase"?u=u.toLocaleUpperCase():y==="lowercase"&&(u=u.toLocaleLowerCase()),I.applyArabicShaping&&(u=I.applyArabicShaping(u)),u}(s.text,t,r)}),e}yi([{name:"triangle",components:3,type:"Uint16"}]),yi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),yi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),yi([{type:"Float32",name:"offsetX"}]),yi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Ac={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Uh=function(e,t,r,s,u){var h,p,y=8*u-s-1,w=(1<<y)-1,A=w>>1,M=-7,O=r?u-1:0,Z=r?-1:1,X=e[t+O];for(O+=Z,h=X&(1<<-M)-1,X>>=-M,M+=y;M>0;h=256*h+e[t+O],O+=Z,M-=8);for(p=h&(1<<-M)-1,h>>=-M,M+=s;M>0;p=256*p+e[t+O],O+=Z,M-=8);if(h===0)h=1-A;else{if(h===w)return p?NaN:1/0*(X?-1:1);p+=Math.pow(2,s),h-=A}return(X?-1:1)*p*Math.pow(2,h-s)},Gh=function(e,t,r,s,u,h){var p,y,w,A=8*h-u-1,M=(1<<A)-1,O=M>>1,Z=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,X=s?0:h-1,Ee=s?1:-1,Ie=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(y=isNaN(t)?1:0,p=M):(p=Math.floor(Math.log(t)/Math.LN2),t*(w=Math.pow(2,-p))<1&&(p--,w*=2),(t+=p+O>=1?Z/w:Z*Math.pow(2,1-O))*w>=2&&(p++,w/=2),p+O>=M?(y=0,p=M):p+O>=1?(y=(t*w-1)*Math.pow(2,u),p+=O):(y=t*Math.pow(2,O-1)*Math.pow(2,u),p=0));u>=8;e[r+X]=255&y,X+=Ee,y/=256,u-=8);for(p=p<<u|y,A+=u;A>0;e[r+X]=255&p,X+=Ee,p/=256,A-=8);e[r+X-Ee]|=128*Ie},Cc=fa;function fa(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}fa.Varint=0,fa.Fixed64=1,fa.Bytes=2,fa.Fixed32=5;var fh=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Yu(e){return e.type===fa.Bytes?e.readVarint()+e.pos:e.pos+1}function cc(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function ph(e,t,r){var s=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(s);for(var u=r.pos-1;u>=e;u--)r.buf[u+s]=r.buf[u]}function xf(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function T(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function ie(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function Oe(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function Ut(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function pr(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function Bt(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function ir(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function _r(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function Tr(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Ir(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function Lr(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Or(e,t,r){e===1&&r.readMessage(Kr,t)}function Kr(e,t,r){if(e===3){var s=r.readMessage(Cr,{}),u=s.width,h=s.height,p=s.left,y=s.top,w=s.advance;t.push({id:s.id,bitmap:new zs({width:u+6,height:h+6},s.bitmap),metrics:{width:u,height:h,left:p,top:y,advance:w}})}}function Cr(e,t,r){e===1?t.id=r.readVarint():e===2?t.bitmap=r.readBytes():e===3?t.width=r.readVarint():e===4?t.height=r.readVarint():e===5?t.left=r.readSVarint():e===6?t.top=r.readSVarint():e===7&&(t.advance=r.readVarint())}function Mr(e){for(var t=0,r=0,s=0,u=e;s<u.length;s+=1){var h=u[s];t+=h.w*h.h,r=Math.max(r,h.w)}e.sort(function(Ie,Xe){return Xe.h-Ie.h});for(var p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],y=0,w=0,A=0,M=e;A<M.length;A+=1)for(var O=M[A],Z=p.length-1;Z>=0;Z--){var X=p[Z];if(!(O.w>X.w||O.h>X.h)){if(O.x=X.x,O.y=X.y,w=Math.max(w,O.y+O.h),y=Math.max(y,O.x+O.w),O.w===X.w&&O.h===X.h){var Ee=p.pop();Z<p.length&&(p[Z]=Ee)}else O.h===X.h?(X.x+=O.w,X.w-=O.w):O.w===X.w?(X.y+=O.h,X.h-=O.h):(p.push({x:X.x+O.w,y:X.y,w:X.w-O.w,h:O.h}),X.y+=O.h,X.h-=O.h);break}}return{w:y,h:w,fill:t/(y*w)||0}}fa.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var s=this.readVarint(),u=s>>3,h=this.pos;this.type=7&s,e(u,t,this),this.pos===h&&this.skip(s)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Tr(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=Lr(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Tr(this.buf,this.pos)+4294967296*Tr(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Tr(this.buf,this.pos)+4294967296*Lr(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=Uh(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Uh(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,s=this.buf;return t=127&(r=s[this.pos++]),r<128?t:(t|=(127&(r=s[this.pos++]))<<7,r<128?t:(t|=(127&(r=s[this.pos++]))<<14,r<128?t:(t|=(127&(r=s[this.pos++]))<<21,r<128?t:function(u,h,p){var y,w,A=p.buf;if(y=(112&(w=A[p.pos++]))>>4,w<128||(y|=(127&(w=A[p.pos++]))<<3,w<128)||(y|=(127&(w=A[p.pos++]))<<10,w<128)||(y|=(127&(w=A[p.pos++]))<<17,w<128)||(y|=(127&(w=A[p.pos++]))<<24,w<128)||(y|=(1&(w=A[p.pos++]))<<31,w<128))return cc(u,y,h);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=s[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&fh?function(r,s,u){return fh.decode(r.subarray(s,u))}(this.buf,t,e):function(r,s,u){for(var h="",p=s;p<u;){var y,w,A,M=r[p],O=null,Z=M>239?4:M>223?3:M>191?2:1;if(p+Z>u)break;Z===1?M<128&&(O=M):Z===2?(192&(y=r[p+1]))==128&&(O=(31&M)<<6|63&y)<=127&&(O=null):Z===3?(w=r[p+2],(192&(y=r[p+1]))==128&&(192&w)==128&&((O=(15&M)<<12|(63&y)<<6|63&w)<=2047||O>=55296&&O<=57343)&&(O=null)):Z===4&&(w=r[p+2],A=r[p+3],(192&(y=r[p+1]))==128&&(192&w)==128&&(192&A)==128&&((O=(15&M)<<18|(63&y)<<12|(63&w)<<6|63&A)<=65535||O>=1114112)&&(O=null)),O===null?(O=65533,Z=1):O>65535&&(O-=65536,h+=String.fromCharCode(O>>>10&1023|55296),O=56320|1023&O),h+=String.fromCharCode(O),p+=Z}return h}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==fa.Bytes)return e.push(this.readVarint(t));var r=Yu(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==fa.Bytes)return e.push(this.readSVarint());var t=Yu(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==fa.Bytes)return e.push(this.readBoolean());var t=Yu(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==fa.Bytes)return e.push(this.readFloat());var t=Yu(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==fa.Bytes)return e.push(this.readDouble());var t=Yu(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==fa.Bytes)return e.push(this.readFixed32());var t=Yu(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==fa.Bytes)return e.push(this.readSFixed32());var t=Yu(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==fa.Bytes)return e.push(this.readFixed64());var t=Yu(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==fa.Bytes)return e.push(this.readSFixed64());var t=Yu(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===fa.Varint)for(;this.buf[this.pos++]>127;);else if(t===fa.Bytes)this.pos=this.readVarint()+this.pos;else if(t===fa.Fixed32)this.pos+=4;else{if(t!==fa.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Ir(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Ir(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Ir(this.buf,-1&e,this.pos),Ir(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Ir(this.buf,-1&e,this.pos),Ir(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,r){var s,u;if(t>=0?(s=t%4294967296|0,u=t/4294967296|0):(u=~(-t/4294967296),4294967295^(s=~(-t%4294967296))?s=s+1|0:(s=0,u=u+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(h,p,y){y.buf[y.pos++]=127&h|128,h>>>=7,y.buf[y.pos++]=127&h|128,h>>>=7,y.buf[y.pos++]=127&h|128,h>>>=7,y.buf[y.pos++]=127&h|128,y.buf[y.pos]=127&(h>>>=7)}(s,0,r),function(h,p){var y=(7&h)<<4;p.buf[p.pos++]|=y|((h>>>=3)?128:0),h&&(p.buf[p.pos++]=127&h|((h>>>=7)?128:0),h&&(p.buf[p.pos++]=127&h|((h>>>=7)?128:0),h&&(p.buf[p.pos++]=127&h|((h>>>=7)?128:0),h&&(p.buf[p.pos++]=127&h|((h>>>=7)?128:0),h&&(p.buf[p.pos++]=127&h)))))}(u,r)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(s,u,h){for(var p,y,w=0;w<u.length;w++){if((p=u.charCodeAt(w))>55295&&p<57344){if(!y){p>56319||w+1===u.length?(s[h++]=239,s[h++]=191,s[h++]=189):y=p;continue}if(p<56320){s[h++]=239,s[h++]=191,s[h++]=189,y=p;continue}p=y-55296<<10|p-56320|65536,y=null}else y&&(s[h++]=239,s[h++]=191,s[h++]=189,y=null);p<128?s[h++]=p:(p<2048?s[h++]=p>>6|192:(p<65536?s[h++]=p>>12|224:(s[h++]=p>>18|240,s[h++]=p>>12&63|128),s[h++]=p>>6&63|128),s[h++]=63&p|128)}return h}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&ph(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),Gh(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Gh(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var s=this.pos-r;s>=128&&ph(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s},writeMessage:function(e,t,r){this.writeTag(e,fa.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,xf,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,T,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,Ut,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,ie,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,Oe,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,pr,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Bt,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,ir,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,_r,t)},writeBytesField:function(e,t){this.writeTag(e,fa.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,fa.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,fa.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,fa.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,fa.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,fa.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,fa.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,fa.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,fa.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,fa.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var ht=function(e,t){var r=t.pixelRatio,s=t.version,u=t.stretchX,h=t.stretchY,p=t.content;this.paddedRect=e,this.pixelRatio=r,this.stretchX=u,this.stretchY=h,this.content=p,this.version=s},Yt={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Yt.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Yt.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Yt.tlbr.get=function(){return this.tl.concat(this.br)},Yt.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(ht.prototype,Yt);var kr=function(e,t){var r={},s={};this.haveRenderCallbacks=[];var u=[];this.addImages(e,r,u),this.addImages(t,s,u);var h=Mr(u),p=new fo({width:h.w||1,height:h.h||1});for(var y in e){var w=e[y],A=r[y].paddedRect;fo.copy(w.data,p,{x:0,y:0},{x:A.x+1,y:A.y+1},w.data)}for(var M in t){var O=t[M],Z=s[M].paddedRect,X=Z.x+1,Ee=Z.y+1,Ie=O.data.width,Xe=O.data.height;fo.copy(O.data,p,{x:0,y:0},{x:X,y:Ee},O.data),fo.copy(O.data,p,{x:0,y:Xe-1},{x:X,y:Ee-1},{width:Ie,height:1}),fo.copy(O.data,p,{x:0,y:0},{x:X,y:Ee+Xe},{width:Ie,height:1}),fo.copy(O.data,p,{x:Ie-1,y:0},{x:X-1,y:Ee},{width:1,height:Xe}),fo.copy(O.data,p,{x:0,y:0},{x:X+Ie,y:Ee},{width:1,height:Xe})}this.image=p,this.iconPositions=r,this.patternPositions=s};kr.prototype.addImages=function(e,t,r){for(var s in e){var u=e[s],h={x:0,y:0,w:u.data.width+2,h:u.data.height+2};r.push(h),t[s]=new ht(h,u),u.hasRenderCallback&&this.haveRenderCallbacks.push(s)}},kr.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},kr.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var s=e.tl;r.update(t.data,void 0,{x:s[0],y:s[1]})}},dn("ImagePosition",ht),dn("ImageAtlas",kr);var Hr={horizontal:1,vertical:2,horizontalOnly:3},yr=function(){this.scale=1,this.fontStack="",this.imageName=null};yr.forText=function(e,t){var r=new yr;return r.scale=e||1,r.fontStack=t,r},yr.forImage=function(e){var t=new yr;return t.imageName=e,t};var zr=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function nn(e,t,r,s,u,h,p,y,w,A,M,O,Z,X,Ee,Ie){var Xe,Be=zr.fromFeature(e,u);O===Hr.vertical&&Be.verticalizePunctuation();var ut=I.processBidirectionalText,It=I.processStyledBidirectionalText;if(ut&&Be.sections.length===1){Xe=[];for(var Ht=0,Jt=ut(Be.toString(),rn(Be,A,h,t,s,X,Ee));Ht<Jt.length;Ht+=1){var mr=Jt[Ht],Fr=new zr;Fr.text=mr,Fr.sections=Be.sections;for(var tn=0;tn<mr.length;tn++)Fr.sectionIndex.push(0);Xe.push(Fr)}}else if(It){Xe=[];for(var kn=0,yn=It(Be.text,Be.sectionIndex,rn(Be,A,h,t,s,X,Ee));kn<yn.length;kn+=1){var On=yn[kn],xn=new zr;xn.text=On[0],xn.sectionIndex=On[1],xn.sections=Be.sections,Xe.push(xn)}}else Xe=function(In,Pi){for(var pi=[],Ui=In.text,Fn=0,Ji=0,Ra=Pi;Ji<Ra.length;Ji+=1){var Ka=Ra[Ji];pi.push(In.substring(Fn,Ka)),Fn=Ka}return Fn<Ui.length&&pi.push(In.substring(Fn,Ui.length)),pi}(Be,rn(Be,A,h,t,s,X,Ee));var gi=[],Hn={positionedLines:gi,text:Be.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:O,iconsInText:!1,verticalizable:!1};return function(In,Pi,pi,Ui,Fn,Ji,Ra,Ka,Za,Oa,Ja,Do){for(var Ro=0,ss=-17,Go=0,us=0,io=Ka==="right"?1:Ka==="left"?0:.5,jo=0,Ri=0,va=Fn;Ri<va.length;Ri+=1){var ca=va[Ri];ca.trim();var Zi=ca.getMaxScale(),gs=24*(Zi-1),ts={positionedGlyphs:[],lineOffset:0};In.positionedLines[jo]=ts;var ka=ts.positionedGlyphs,vo=0;if(ca.length()){for(var rs=0;rs<ca.length();rs++){var $i=ca.getSection(rs),El=ca.getSectionIndex(rs),iu=ca.getCharCode(rs),Sl=0,ao=null,Tl=null,zu=null,Hc=24,kc=!(Za===Hr.horizontal||!Ja&&!Gu(iu)||Ja&&(Ln[iu]||(Zl=iu,Zr.Arabic(Zl)||Zr["Arabic Supplement"](Zl)||Zr["Arabic Extended-A"](Zl)||Zr["Arabic Presentation Forms-A"](Zl)||Zr["Arabic Presentation Forms-B"](Zl))));if($i.imageName){var Wc=Ui[$i.imageName];if(!Wc)continue;zu=$i.imageName,In.iconsInText=In.iconsInText||!0,Tl=Wc.paddedRect;var ql=Wc.displaySize;$i.scale=24*$i.scale/Do,Sl=gs+(24-ql[1]*$i.scale),Hc=(ao={width:ql[0],height:ql[1],left:1,top:-3,advance:kc?ql[1]:ql[0]}).advance;var Xc=kc?ql[0]*$i.scale-24*Zi:ql[1]*$i.scale-24*Zi;Xc>0&&Xc>vo&&(vo=Xc)}else{var Zh=pi[$i.fontStack],Yc=Zh&&Zh[iu];if(Yc&&Yc.rect)Tl=Yc.rect,ao=Yc.metrics;else{var vh=Pi[$i.fontStack],Hh=vh&&vh[iu];if(!Hh)continue;ao=Hh.metrics}Sl=24*(Zi-$i.scale)}kc?(In.verticalizable=!0,ka.push({glyph:iu,imageName:zu,x:Ro,y:ss+Sl,vertical:kc,scale:$i.scale,fontStack:$i.fontStack,sectionIndex:El,metrics:ao,rect:Tl}),Ro+=Hc*$i.scale+Oa):(ka.push({glyph:iu,imageName:zu,x:Ro,y:ss+Sl,vertical:kc,scale:$i.scale,fontStack:$i.fontStack,sectionIndex:El,metrics:ao,rect:Tl}),Ro+=ao.advance*$i.scale+Oa)}ka.length!==0&&(Go=Math.max(Ro-Oa,Go),ui(ka,0,ka.length-1,io,vo)),Ro=0;var Wh=Ji*Zi+vo;ts.lineOffset=Math.max(vo,gs),ss+=Wh,us=Math.max(Wh,us),++jo}else ss+=Ji,++jo}var Zl,yh=ss- -17,Kc=an(Ra),fc=Kc.horizontalAlign,Jc=Kc.verticalAlign;(function(Xh,Yh,gh,_h,Kh,xh,bh,wh,Jh){var $c,$h=(Yh-gh)*Kh;$c=xh!==bh?-wh*_h- -17:(-_h*Jh+.5)*bh;for(var Qc=0,Eh=Xh;Qc<Eh.length;Qc+=1)for(var Pc=0,Sh=Eh[Qc].positionedGlyphs;Pc<Sh.length;Pc+=1){var eh=Sh[Pc];eh.x+=$h,eh.y+=$c}})(In.positionedLines,io,fc,Jc,Go,us,Ji,yh,Fn.length),In.top+=-Jc*yh,In.bottom=In.top+yh,In.left+=-fc*Go,In.right=In.left+Go}(Hn,t,r,s,Xe,p,y,w,O,A,Z,Ie),!function(In){for(var Pi=0,pi=In;Pi<pi.length;Pi+=1)if(pi[Pi].positionedGlyphs.length!==0)return!1;return!0}(gi)&&Hn}zr.fromFeature=function(e,t){for(var r=new zr,s=0;s<e.sections.length;s++){var u=e.sections[s];u.image?r.addImageSection(u):r.addTextSection(u,t)}return r},zr.prototype.length=function(){return this.text.length},zr.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},zr.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},zr.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},zr.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var s=e.charCodeAt(r+1)||null,u=e.charCodeAt(r-1)||null;t+=s&&Js(s)&&!Ac[e[r+1]]||u&&Js(u)&&!Ac[e[r-1]]||!Ac[e[r]]?e[r]:Ac[e[r]]}return t}(this.text)},zr.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Ln[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,s=this.text.length-1;s>=0&&s>=e&&Ln[this.text.charCodeAt(s)];s--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},zr.prototype.substring=function(e,t){var r=new zr;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},zr.prototype.toString=function(){return this.text},zr.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},zr.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(yr.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,s=0;s<e.text.length;++s)this.sectionIndex.push(r)},zr.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(yr.forImage(t)),this.sectionIndex.push(this.sections.length-1)):we("Reached maximum number of images 6401")}else we("Can't add FormattedSection with an empty image.")},zr.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Ln={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ar={};function lr(e,t,r,s,u,h){if(t.imageName){var p=s[t.imageName];return p?p.displaySize[0]*t.scale*24/h+u:0}var y=r[t.fontStack],w=y&&y[e];return w?w.metrics.advance*t.scale+u:0}function wn(e,t,r,s){var u=Math.pow(e-t,2);return s?e<t?u/2:2*u:u+Math.abs(r)*r}function Qr(e,t,r){var s=0;return e===10&&(s-=1e4),r&&(s+=150),e!==40&&e!==65288||(s+=50),t!==41&&t!==65289||(s+=50),s}function Pr(e,t,r,s,u,h){for(var p=null,y=wn(t,r,u,h),w=0,A=s;w<A.length;w+=1){var M=A[w],O=wn(t-M.x,r,u,h)+M.badness;O<=y&&(p=M,y=O)}return{index:e,x:t,priorBreak:p,badness:y}}function rn(e,t,r,s,u,h,p){if(h!=="point")return[];if(!e)return[];for(var y,w=[],A=function(Xe,Be,ut,It,Ht,Jt){for(var mr=0,Fr=0;Fr<Xe.length();Fr++){var tn=Xe.getSection(Fr);mr+=lr(Xe.getCharCode(Fr),tn,It,Ht,Be,Jt)}return mr/Math.max(1,Math.ceil(mr/ut))}(e,t,r,s,u,p),M=e.text.indexOf("\u200B")>=0,O=0,Z=0;Z<e.length();Z++){var X=e.getSection(Z),Ee=e.getCharCode(Z);if(Ln[Ee]||(O+=lr(Ee,X,s,u,t,p)),Z<e.length()-1){var Ie=!((y=Ee)<11904||!(Zr["Bopomofo Extended"](y)||Zr.Bopomofo(y)||Zr["CJK Compatibility Forms"](y)||Zr["CJK Compatibility Ideographs"](y)||Zr["CJK Compatibility"](y)||Zr["CJK Radicals Supplement"](y)||Zr["CJK Strokes"](y)||Zr["CJK Symbols and Punctuation"](y)||Zr["CJK Unified Ideographs Extension A"](y)||Zr["CJK Unified Ideographs"](y)||Zr["Enclosed CJK Letters and Months"](y)||Zr["Halfwidth and Fullwidth Forms"](y)||Zr.Hiragana(y)||Zr["Ideographic Description Characters"](y)||Zr["Kangxi Radicals"](y)||Zr["Katakana Phonetic Extensions"](y)||Zr.Katakana(y)||Zr["Vertical Forms"](y)||Zr["Yi Radicals"](y)||Zr["Yi Syllables"](y)));(ar[Ee]||Ie||X.imageName)&&w.push(Pr(Z+1,O,A,w,Qr(Ee,e.getCharCode(Z+1),Ie&&M),!1))}}return function Xe(Be){return Be?Xe(Be.priorBreak).concat(Be.index):[]}(Pr(e.length(),O,A,w,0,!0))}function an(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function ui(e,t,r,s,u){if(s||u)for(var h=e[r],p=(e[r].x+h.metrics.advance*h.scale)*s,y=t;y<=r;y++)e[y].x-=p,e[y].y+=u}function Yn(e,t,r,s,u,h){var p,y=e.image;if(y.content){var w=y.content,A=y.pixelRatio||1;p=[w[0]/A,w[1]/A,y.displaySize[0]-w[2]/A,y.displaySize[1]-w[3]/A]}var M,O,Z,X,Ee=t.left*h,Ie=t.right*h;r==="width"||r==="both"?(X=u[0]+Ee-s[3],O=u[0]+Ie+s[1]):O=(X=u[0]+(Ee+Ie-y.displaySize[0])/2)+y.displaySize[0];var Xe=t.top*h,Be=t.bottom*h;return r==="height"||r==="both"?(M=u[1]+Xe-s[0],Z=u[1]+Be+s[2]):Z=(M=u[1]+(Xe+Be-y.displaySize[1])/2)+y.displaySize[1],{image:y,top:M,right:O,bottom:Z,left:X,collisionPadding:p}}ar[10]=!0,ar[32]=!0,ar[38]=!0,ar[40]=!0,ar[41]=!0,ar[43]=!0,ar[45]=!0,ar[47]=!0,ar[173]=!0,ar[183]=!0,ar[8203]=!0,ar[8208]=!0,ar[8211]=!0,ar[8231]=!0;var en=function(e){function t(r,s,u,h){e.call(this,r,s),this.angle=u,h!==void 0&&(this.segment=h)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(Le);function ln(e,t){var r=t.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new $(e+1))};if(r.kind==="source")return{kind:"source"};for(var s=r.zoomStops,u=r.interpolationType,h=0;h<s.length&&s[h]<=e;)h++;for(var p=h=Math.max(0,h-1);p<s.length&&s[p]<e+1;)p++;p=Math.min(s.length-1,p);var y=s[h],w=s[p];return r.kind==="composite"?{kind:"composite",minZoom:y,maxZoom:w,interpolationType:u}:{kind:"camera",minZoom:y,maxZoom:w,minSize:r.evaluate(new $(y)),maxSize:r.evaluate(new $(w)),interpolationType:u}}function Gn(e,t,r){var s=t.uSize,u=r.lowerSize;return e.kind==="source"?u/128:e.kind==="composite"?Wi(u/128,r.upperSize/128,t.uSizeT):s}function ii(e,t){var r=0,s=0;if(e.kind==="constant")s=e.layoutSize;else if(e.kind!=="source"){var u=e.interpolationType,h=u?Dt(oe.interpolationFactor(u,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?s=Wi(e.minSize,e.maxSize,h):r=h}return{uSizeT:r,uSize:s}}dn("Anchor",en);var Ii=Object.freeze({__proto__:null,getSizeData:ln,evaluateSizeForFeature:Gn,evaluateSizeForZoom:ii,SIZE_PACK_FACTOR:128});function Da(e,t,r,s,u){if(t.segment===void 0)return!0;for(var h=t,p=t.segment+1,y=0;y>-r/2;){if(--p<0)return!1;y-=e[p].dist(h),h=e[p]}y+=e[p].dist(e[p+1]),p++;for(var w=[],A=0;y<r/2;){var M=e[p],O=e[p+1];if(!O)return!1;var Z=e[p-1].angleTo(M)-M.angleTo(O);for(Z=Math.abs((Z+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:y,angleDelta:Z}),A+=Z;y-w[0].distance>s;)A-=w.shift().angleDelta;if(A>u)return!1;p++,y+=M.dist(O)}return!0}function Va(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Si(e,t,r){return e?.6*t*r:0}function Po(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Aa(e,t,r,s,u,h){for(var p=Si(r,u,h),y=Po(r,s)*h,w=0,A=Va(e)/2,M=0;M<e.length-1;M++){var O=e[M],Z=e[M+1],X=O.dist(Z);if(w+X>A){var Ee=(A-w)/X,Ie=Wi(O.x,Z.x,Ee),Xe=Wi(O.y,Z.y,Ee),Be=new en(Ie,Xe,Z.angleTo(O),M);return Be._round(),!p||Da(e,Be,y,p,t)?Be:void 0}w+=X}}function bo(e,t,r,s,u,h,p,y,w){var A=Si(s,h,p),M=Po(s,u),O=M*p,Z=e[0].x===0||e[0].x===w||e[0].y===0||e[0].y===w;return t-O<t/4&&(t=O+t/4),function X(Ee,Ie,Xe,Be,ut,It,Ht,Jt,mr){for(var Fr=It/2,tn=Va(Ee),kn=0,yn=Ie-Xe,On=[],xn=0;xn<Ee.length-1;xn++){for(var gi=Ee[xn],Hn=Ee[xn+1],In=gi.dist(Hn),Pi=Hn.angleTo(gi);yn+Xe<kn+In;){var pi=((yn+=Xe)-kn)/In,Ui=Wi(gi.x,Hn.x,pi),Fn=Wi(gi.y,Hn.y,pi);if(Ui>=0&&Ui<mr&&Fn>=0&&Fn<mr&&yn-Fr>=0&&yn+Fr<=tn){var Ji=new en(Ui,Fn,Pi,xn);Ji._round(),Be&&!Da(Ee,Ji,It,Be,ut)||On.push(Ji)}}kn+=In}return Jt||On.length||Ht||(On=X(Ee,kn/2,Xe,Be,ut,It,Ht,!0,mr)),On}(e,Z?t/2*y%t:(M/2+2*h)*p*y%t,t,A,r,O,Z,!1,w)}function Xa(e,t,r,s,u){for(var h=[],p=0;p<e.length;p++)for(var y=e[p],w=void 0,A=0;A<y.length-1;A++){var M=y[A],O=y[A+1];M.x<t&&O.x<t||(M.x<t?M=new Le(t,M.y+(t-M.x)/(O.x-M.x)*(O.y-M.y))._round():O.x<t&&(O=new Le(t,M.y+(t-M.x)/(O.x-M.x)*(O.y-M.y))._round()),M.y<r&&O.y<r||(M.y<r?M=new Le(M.x+(r-M.y)/(O.y-M.y)*(O.x-M.x),r)._round():O.y<r&&(O=new Le(M.x+(r-M.y)/(O.y-M.y)*(O.x-M.x),r)._round()),M.x>=s&&O.x>=s||(M.x>=s?M=new Le(s,M.y+(s-M.x)/(O.x-M.x)*(O.y-M.y))._round():O.x>=s&&(O=new Le(s,M.y+(s-M.x)/(O.x-M.x)*(O.y-M.y))._round()),M.y>=u&&O.y>=u||(M.y>=u?M=new Le(M.x+(u-M.y)/(O.y-M.y)*(O.x-M.x),u)._round():O.y>=u&&(O=new Le(M.x+(u-M.y)/(O.y-M.y)*(O.x-M.x),u)._round()),w&&M.equals(w[w.length-1])||h.push(w=[M]),w.push(O)))))}return h}function wo(e,t,r,s){var u=[],h=e.image,p=h.pixelRatio,y=h.paddedRect.w-2,w=h.paddedRect.h-2,A=e.right-e.left,M=e.bottom-e.top,O=h.stretchX||[[0,y]],Z=h.stretchY||[[0,w]],X=function(Ui,Fn){return Ui+Fn[1]-Fn[0]},Ee=O.reduce(X,0),Ie=Z.reduce(X,0),Xe=y-Ee,Be=w-Ie,ut=0,It=Ee,Ht=0,Jt=Ie,mr=0,Fr=Xe,tn=0,kn=Be;if(h.content&&s){var yn=h.content;ut=po(O,0,yn[0]),Ht=po(Z,0,yn[1]),It=po(O,yn[0],yn[2]),Jt=po(Z,yn[1],yn[3]),mr=yn[0]-ut,tn=yn[1]-Ht,Fr=yn[2]-yn[0]-It,kn=yn[3]-yn[1]-Jt}var On=function(Ui,Fn,Ji,Ra){var Ka=Ua(Ui.stretch-ut,It,A,e.left),Za=li(Ui.fixed-mr,Fr,Ui.stretch,Ee),Oa=Ua(Fn.stretch-Ht,Jt,M,e.top),Ja=li(Fn.fixed-tn,kn,Fn.stretch,Ie),Do=Ua(Ji.stretch-ut,It,A,e.left),Ro=li(Ji.fixed-mr,Fr,Ji.stretch,Ee),ss=Ua(Ra.stretch-Ht,Jt,M,e.top),Go=li(Ra.fixed-tn,kn,Ra.stretch,Ie),us=new Le(Ka,Oa),io=new Le(Do,Oa),jo=new Le(Do,ss),Ri=new Le(Ka,ss),va=new Le(Za/p,Ja/p),ca=new Le(Ro/p,Go/p),Zi=t*Math.PI/180;if(Zi){var gs=Math.sin(Zi),ts=Math.cos(Zi),ka=[ts,-gs,gs,ts];us._matMult(ka),io._matMult(ka),Ri._matMult(ka),jo._matMult(ka)}var vo=Ui.stretch+Ui.fixed,rs=Fn.stretch+Fn.fixed;return{tl:us,tr:io,bl:Ri,br:jo,tex:{x:h.paddedRect.x+1+vo,y:h.paddedRect.y+1+rs,w:Ji.stretch+Ji.fixed-vo,h:Ra.stretch+Ra.fixed-rs},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:va,pixelOffsetBR:ca,minFontScaleX:Fr/p/A,minFontScaleY:kn/p/M,isSDF:r}};if(s&&(h.stretchX||h.stretchY))for(var xn=Vo(O,Xe,Ee),gi=Vo(Z,Be,Ie),Hn=0;Hn<xn.length-1;Hn++)for(var In=xn[Hn],Pi=xn[Hn+1],pi=0;pi<gi.length-1;pi++)u.push(On(In,gi[pi],Pi,gi[pi+1]));else u.push(On({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:y+1},{fixed:0,stretch:w+1}));return u}function po(e,t,r){for(var s=0,u=0,h=e;u<h.length;u+=1){var p=h[u];s+=Math.max(t,Math.min(r,p[1]))-Math.max(t,Math.min(r,p[0]))}return s}function Vo(e,t,r){for(var s=[{fixed:-1,stretch:0}],u=0,h=e;u<h.length;u+=1){var p=h[u],y=p[0],w=p[1],A=s[s.length-1];s.push({fixed:y-A.stretch,stretch:A.stretch}),s.push({fixed:y-A.stretch,stretch:A.stretch+(w-y)})}return s.push({fixed:t+1,stretch:r}),s}function Ua(e,t,r,s){return e/t*r+s}function li(e,t,r,s){return e-t*r/s}var mo=function(e,t,r,s,u,h,p,y,w,A){if(this.boxStartIndex=e.length,w){var M=h.top,O=h.bottom,Z=h.collisionPadding;Z&&(M-=Z[1],O+=Z[3]);var X=O-M;X>0&&(X=Math.max(10,X),this.circleDiameter=X)}else{var Ee=h.top*p-y,Ie=h.bottom*p+y,Xe=h.left*p-y,Be=h.right*p+y,ut=h.collisionPadding;if(ut&&(Xe-=ut[0]*p,Ee-=ut[1]*p,Be+=ut[2]*p,Ie+=ut[3]*p),A){var It=new Le(Xe,Ee),Ht=new Le(Be,Ee),Jt=new Le(Xe,Ie),mr=new Le(Be,Ie),Fr=A*Math.PI/180;It._rotate(Fr),Ht._rotate(Fr),Jt._rotate(Fr),mr._rotate(Fr),Xe=Math.min(It.x,Ht.x,Jt.x,mr.x),Be=Math.max(It.x,Ht.x,Jt.x,mr.x),Ee=Math.min(It.y,Ht.y,Jt.y,mr.y),Ie=Math.max(It.y,Ht.y,Jt.y,mr.y)}e.emplaceBack(t.x,t.y,Xe,Ee,Be,Ie,r,s,u)}this.boxEndIndex=e.length},Vi=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=Mo),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)};function Mo(e,t){return e<t?-1:e>t?1:0}function Zn(e,t,r){t===void 0&&(t=1),r===void 0&&(r=!1);for(var s=1/0,u=1/0,h=-1/0,p=-1/0,y=e[0],w=0;w<y.length;w++){var A=y[w];(!w||A.x<s)&&(s=A.x),(!w||A.y<u)&&(u=A.y),(!w||A.x>h)&&(h=A.x),(!w||A.y>p)&&(p=A.y)}var M=Math.min(h-s,p-u),O=M/2,Z=new Vi([],Ti);if(M===0)return new Le(s,u);for(var X=s;X<h;X+=M)for(var Ee=u;Ee<p;Ee+=M)Z.push(new Yi(X+O,Ee+O,O,e));for(var Ie=function(ut){for(var It=0,Ht=0,Jt=0,mr=ut[0],Fr=0,tn=mr.length,kn=tn-1;Fr<tn;kn=Fr++){var yn=mr[Fr],On=mr[kn],xn=yn.x*On.y-On.x*yn.y;Ht+=(yn.x+On.x)*xn,Jt+=(yn.y+On.y)*xn,It+=3*xn}return new Yi(Ht/It,Jt/It,0,ut)}(e),Xe=Z.length;Z.length;){var Be=Z.pop();(Be.d>Ie.d||!Ie.d)&&(Ie=Be,r&&console.log("found best %d after %d probes",Math.round(1e4*Be.d)/1e4,Xe)),Be.max-Ie.d<=t||(Z.push(new Yi(Be.p.x-(O=Be.h/2),Be.p.y-O,O,e)),Z.push(new Yi(Be.p.x+O,Be.p.y-O,O,e)),Z.push(new Yi(Be.p.x-O,Be.p.y+O,O,e)),Z.push(new Yi(Be.p.x+O,Be.p.y+O,O,e)),Xe+=4)}return r&&(console.log("num probes: "+Xe),console.log("best distance: "+Ie.d)),Ie.p}function Ti(e,t){return t.max-e.max}function Yi(e,t,r,s){this.p=new Le(e,t),this.h=r,this.d=function(u,h){for(var p=!1,y=1/0,w=0;w<h.length;w++)for(var A=h[w],M=0,O=A.length,Z=O-1;M<O;Z=M++){var X=A[M],Ee=A[Z];X.y>u.y!=Ee.y>u.y&&u.x<(Ee.x-X.x)*(u.y-X.y)/(Ee.y-X.y)+X.x&&(p=!p),y=Math.min(y,Hu(u,X,Ee))}return(p?1:-1)*Math.sqrt(y)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}Vi.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},Vi.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},Vi.prototype.peek=function(){return this.data[0]},Vi.prototype._up=function(e){for(var t=this.data,r=this.compare,s=t[e];e>0;){var u=e-1>>1,h=t[u];if(r(s,h)>=0)break;t[e]=h,e=u}t[e]=s},Vi.prototype._down=function(e){for(var t=this.data,r=this.compare,s=this.length>>1,u=t[e];e<s;){var h=1+(e<<1),p=t[h],y=h+1;if(y<this.length&&r(t[y],p)<0&&(h=y,p=t[y]),r(p,u)>=0)break;t[e]=p,e=h}t[e]=u};var Ya=Number.POSITIVE_INFINITY;function Ou(e,t){return t[1]!==Ya?function(r,s,u){var h=0,p=0;switch(s=Math.abs(s),u=Math.abs(u),r){case"top-right":case"top-left":case"top":p=u-7;break;case"bottom-right":case"bottom-left":case"bottom":p=7-u}switch(r){case"top-right":case"bottom-right":case"right":h=-s;break;case"top-left":case"bottom-left":case"left":h=s}return[h,p]}(e,t[0],t[1]):function(r,s){var u=0,h=0;s<0&&(s=0);var p=s/Math.sqrt(2);switch(r){case"top-right":case"top-left":h=p-7;break;case"bottom-right":case"bottom-left":h=7-p;break;case"bottom":h=7-s;break;case"top":h=s-7}switch(r){case"top-right":case"bottom-right":u=-p;break;case"top-left":case"bottom-left":u=p;break;case"left":u=s;break;case"right":u=-s}return[u,h]}(e,t[0])}function be(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function qt(e,t,r,s,u,h,p,y,w,A,M,O,Z,X,Ee){var Ie=function(Ht,Jt,mr,Fr,tn,kn,yn,On){for(var xn=Fr.layout.get("text-rotate").evaluate(kn,{})*Math.PI/180,gi=[],Hn=0,In=Jt.positionedLines;Hn<In.length;Hn+=1)for(var Pi=In[Hn],pi=0,Ui=Pi.positionedGlyphs;pi<Ui.length;pi+=1){var Fn=Ui[pi];if(Fn.rect){var Ji=Fn.rect||{},Ra=4,Ka=!0,Za=1,Oa=0,Ja=(tn||On)&&Fn.vertical,Do=Fn.metrics.advance*Fn.scale/2;if(On&&Jt.verticalizable&&(Oa=Pi.lineOffset/2-(Fn.imageName?-(24-Fn.metrics.width*Fn.scale)/2:24*(Fn.scale-1))),Fn.imageName){var Ro=yn[Fn.imageName];Ka=Ro.sdf,Ra=1/(Za=Ro.pixelRatio)}var ss=tn?[Fn.x+Do,Fn.y]:[0,0],Go=tn?[0,0]:[Fn.x+Do+mr[0],Fn.y+mr[1]-Oa],us=[0,0];Ja&&(us=Go,Go=[0,0]);var io=(Fn.metrics.left-Ra)*Fn.scale-Do+Go[0],jo=(-Fn.metrics.top-Ra)*Fn.scale+Go[1],Ri=io+Ji.w*Fn.scale/Za,va=jo+Ji.h*Fn.scale/Za,ca=new Le(io,jo),Zi=new Le(Ri,jo),gs=new Le(io,va),ts=new Le(Ri,va);if(Ja){var ka=new Le(-Do,Do- -17),vo=-Math.PI/2,rs=12-Do,$i=new Le(22-rs,-(Fn.imageName?rs:0)),El=new(Function.prototype.bind.apply(Le,[null].concat(us)));ca._rotateAround(vo,ka)._add($i)._add(El),Zi._rotateAround(vo,ka)._add($i)._add(El),gs._rotateAround(vo,ka)._add($i)._add(El),ts._rotateAround(vo,ka)._add($i)._add(El)}if(xn){var iu=Math.sin(xn),Sl=Math.cos(xn),ao=[Sl,-iu,iu,Sl];ca._matMult(ao),Zi._matMult(ao),gs._matMult(ao),ts._matMult(ao)}var Tl=new Le(0,0),zu=new Le(0,0);gi.push({tl:ca,tr:Zi,bl:gs,br:ts,tex:Ji,writingMode:Jt.writingMode,glyphOffset:ss,sectionIndex:Fn.sectionIndex,isSDF:Ka,pixelOffsetTL:Tl,pixelOffsetBR:zu,minFontScaleX:0,minFontScaleY:0})}}return gi}(0,r,y,u,h,p,s,e.allowVerticalPlacement),Xe=e.textSizeData,Be=null;Xe.kind==="source"?(Be=[128*u.layout.get("text-size").evaluate(p,{})])[0]>32640&&we(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Xe.kind==="composite"&&((Be=[128*X.compositeTextSizes[0].evaluate(p,{},Ee),128*X.compositeTextSizes[1].evaluate(p,{},Ee)])[0]>32640||Be[1]>32640)&&we(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,Ie,Be,y,h,p,A,t,w.lineStartIndex,w.lineLength,Z,Ee);for(var ut=0,It=M;ut<It.length;ut+=1)O[It[ut]]=e.text.placedSymbolArray.length-1;return 4*Ie.length}function At(e){for(var t in e)return e[t];return null}function gn(e,t,r,s){var u=e.compareText;if(t in u){for(var h=u[t],p=h.length-1;p>=0;p--)if(s.dist(h[p])<r)return!0}else u[t]=[];return u[t].push(s),!1}var ki=Bs.VectorTileFeature.types,de=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Y(e,t,r,s,u,h,p,y,w,A,M,O,Z){var X=y?Math.min(32640,Math.round(y[0])):0,Ee=y?Math.min(32640,Math.round(y[1])):0;e.emplaceBack(t,r,Math.round(32*s),Math.round(32*u),h,p,(X<<1)+(w?1:0),Ee,16*A,16*M,256*O,256*Z)}function Ue(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function ft(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(cl(r[t].text))return!0;return!1}var Ot=function(e){this.layoutVertexArray=new la,this.indexArray=new $s,this.programConfigurations=e,this.segments=new ee,this.dynamicLayoutVertexArray=new Zo,this.opacityVertexArray=new Rs,this.placedSymbolArray=new o};Ot.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Ot.prototype.upload=function(e,t,r,s){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,mf.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,vf.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,de,!0),this.opacityVertexBuffer.itemSize=1),(r||s)&&this.programConfigurations.upload(e))},Ot.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},dn("SymbolBuffers",Ot);var Ke=function(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new ee,this.collisionVertexArray=new Jo};Ke.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,yf.members,!0)},Ke.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},dn("CollisionBuffers",Ke);var Re=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(h){return h.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=os([]),this.placementViewportMatrix=os([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ln(this.zoom,t["text-size"]),this.iconSizeData=ln(this.zoom,t["icon-size"]);var r=this.layers[0].layout,s=r.get("symbol-sort-key"),u=r.get("symbol-z-order");this.canOverlap=r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey=u!=="viewport-y"&&s.constantOr(1)!==void 0,this.sortFeaturesByY=(u==="viewport-y"||u==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,r.get("symbol-placement")==="point"&&(this.writingModes=r.get("text-writing-mode").map(function(h){return Hr[h]})),this.stateDependentLayerIds=this.layers.filter(function(h){return h.isStateDependent()}).map(function(h){return h.id}),this.sourceID=e.sourceID};Re.prototype.createArrays=function(){this.text=new Ot(new Nn(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new Ot(new Nn(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new v,this.lineVertexArray=new x,this.symbolInstances=new d},Re.prototype.calculateGlyphDependencies=function(e,t,r,s,u){for(var h=0;h<e.length;h++)if(t[e.charCodeAt(h)]=!0,(r||s)&&u){var p=Ac[e.charAt(h)];p&&(t[p.charCodeAt(0)]=!0)}},Re.prototype.populate=function(e,t,r){var s=this.layers[0],u=s.layout,h=u.get("text-font"),p=u.get("text-field"),y=u.get("icon-image"),w=(p.value.kind!=="constant"||p.value.value instanceof ea&&!p.value.value.isEmpty()||p.value.value.toString().length>0)&&(h.value.kind!=="constant"||h.value.value.length>0),A=y.value.kind!=="constant"||!!y.value.value||Object.keys(y.parameters).length>0,M=u.get("symbol-sort-key");if(this.features=[],w||A){for(var O=t.iconDependencies,Z=t.glyphDependencies,X=t.availableImages,Ee=new $(this.zoom),Ie=0,Xe=e;Ie<Xe.length;Ie+=1){var Be=Xe[Ie],ut=Be.feature,It=Be.id,Ht=Be.index,Jt=Be.sourceLayerIndex,mr=s._featureFilter.needGeometry,Fr=Na(ut,mr);if(s._featureFilter.filter(Ee,Fr,r)){mr||(Fr.geometry=Ia(ut));var tn=void 0;if(w){var kn=s.getValueAndResolveTokens("text-field",Fr,r,X),yn=ea.factory(kn);ft(yn)&&(this.hasRTLText=!0),(!this.hasRTLText||Ql()==="unavailable"||this.hasRTLText&&I.isParsed())&&(tn=_f(yn,s,Fr))}var On=void 0;if(A){var xn=s.getValueAndResolveTokens("icon-image",Fr,r,X);On=xn instanceof zi?xn:zi.fromString(xn)}if(tn||On){var gi=this.sortFeaturesByKey?M.evaluate(Fr,{},r):void 0;if(this.features.push({id:It,text:tn,icon:On,index:Ht,sourceLayerIndex:Jt,geometry:Fr.geometry,properties:ut.properties,type:ki[ut.type],sortKey:gi}),On&&(O[On.name]=!0),tn){var Hn=h.evaluate(Fr,{},r).join(","),In=u.get("text-rotation-alignment")==="map"&&u.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Hr.vertical)>=0;for(var Pi=0,pi=tn.sections;Pi<pi.length;Pi+=1){var Ui=pi[Pi];if(Ui.image)O[Ui.image.name]=!0;else{var Fn=Ks(tn.toString()),Ji=Ui.fontStack||Hn,Ra=Z[Ji]=Z[Ji]||{};this.calculateGlyphDependencies(Ui.text,Ra,In,this.allowVerticalPlacement,Fn)}}}}}}u.get("symbol-placement")==="line"&&(this.features=function(Ka){var Za={},Oa={},Ja=[],Do=0;function Ro(ka){Ja.push(Ka[ka]),Do++}function ss(ka,vo,rs){var $i=Oa[ka];return delete Oa[ka],Oa[vo]=$i,Ja[$i].geometry[0].pop(),Ja[$i].geometry[0]=Ja[$i].geometry[0].concat(rs[0]),$i}function Go(ka,vo,rs){var $i=Za[vo];return delete Za[vo],Za[ka]=$i,Ja[$i].geometry[0].shift(),Ja[$i].geometry[0]=rs[0].concat(Ja[$i].geometry[0]),$i}function us(ka,vo,rs){var $i=rs?vo[0][vo[0].length-1]:vo[0][0];return ka+":"+$i.x+":"+$i.y}for(var io=0;io<Ka.length;io++){var jo=Ka[io],Ri=jo.geometry,va=jo.text?jo.text.toString():null;if(va){var ca=us(va,Ri),Zi=us(va,Ri,!0);if(ca in Oa&&Zi in Za&&Oa[ca]!==Za[Zi]){var gs=Go(ca,Zi,Ri),ts=ss(ca,Zi,Ja[gs].geometry);delete Za[ca],delete Oa[Zi],Oa[us(va,Ja[ts].geometry,!0)]=ts,Ja[gs].geometry=null}else ca in Oa?ss(ca,Zi,Ri):Zi in Za?Go(ca,Zi,Ri):(Ro(io),Za[ca]=Do-1,Oa[Zi]=Do-1)}else Ro(io)}return Ja.filter(function(ka){return ka.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Ka,Za){return Ka.sortKey-Za.sortKey})}},Re.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},Re.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Re.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Re.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Re.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Re.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Re.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(e.segment!==void 0){for(var s=e.dist(t[e.segment+1]),u=e.dist(t[e.segment]),h={},p=e.segment+1;p<t.length;p++)h[p]={x:t[p].x,y:t[p].y,tileUnitDistanceFromAnchor:s},p<t.length-1&&(s+=t[p+1].dist(t[p]));for(var y=e.segment||0;y>=0;y--)h[y]={x:t[y].x,y:t[y].y,tileUnitDistanceFromAnchor:u},y>0&&(u+=t[y-1].dist(t[y]));for(var w=0;w<t.length;w++){var A=h[w];this.lineVertexArray.emplaceBack(A.x,A.y,A.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},Re.prototype.addSymbols=function(e,t,r,s,u,h,p,y,w,A,M,O){for(var Z=e.indexArray,X=e.layoutVertexArray,Ee=e.segments.prepareSegment(4*t.length,X,Z,this.canOverlap?h.sortKey:void 0),Ie=this.glyphOffsetArray.length,Xe=Ee.vertexLength,Be=this.allowVerticalPlacement&&p===Hr.vertical?Math.PI/2:0,ut=h.text&&h.text.sections,It=0;It<t.length;It++){var Ht=t[It],Jt=Ht.tl,mr=Ht.tr,Fr=Ht.bl,tn=Ht.br,kn=Ht.tex,yn=Ht.pixelOffsetTL,On=Ht.pixelOffsetBR,xn=Ht.minFontScaleX,gi=Ht.minFontScaleY,Hn=Ht.glyphOffset,In=Ht.isSDF,Pi=Ht.sectionIndex,pi=Ee.vertexLength,Ui=Hn[1];Y(X,y.x,y.y,Jt.x,Ui+Jt.y,kn.x,kn.y,r,In,yn.x,yn.y,xn,gi),Y(X,y.x,y.y,mr.x,Ui+mr.y,kn.x+kn.w,kn.y,r,In,On.x,yn.y,xn,gi),Y(X,y.x,y.y,Fr.x,Ui+Fr.y,kn.x,kn.y+kn.h,r,In,yn.x,On.y,xn,gi),Y(X,y.x,y.y,tn.x,Ui+tn.y,kn.x+kn.w,kn.y+kn.h,r,In,On.x,On.y,xn,gi),Ue(e.dynamicLayoutVertexArray,y,Be),Z.emplaceBack(pi,pi+1,pi+2),Z.emplaceBack(pi+1,pi+2,pi+3),Ee.vertexLength+=4,Ee.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Hn[0]),It!==t.length-1&&Pi===t[It+1].sectionIndex||e.programConfigurations.populatePaintArrays(X.length,h,h.index,{},O,ut&&ut[Pi])}e.placedSymbolArray.emplaceBack(y.x,y.y,Ie,this.glyphOffsetArray.length-Ie,Xe,w,A,y.segment,r?r[0]:0,r?r[1]:0,s[0],s[1],p,0,!1,0,M)},Re.prototype._addCollisionDebugVertex=function(e,t,r,s,u,h){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,s,u,Math.round(h.x),Math.round(h.y))},Re.prototype.addCollisionDebugVertices=function(e,t,r,s,u,h,p){var y=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),w=y.vertexLength,A=u.layoutVertexArray,M=u.collisionVertexArray,O=p.anchorX,Z=p.anchorY;this._addCollisionDebugVertex(A,M,h,O,Z,new Le(e,t)),this._addCollisionDebugVertex(A,M,h,O,Z,new Le(r,t)),this._addCollisionDebugVertex(A,M,h,O,Z,new Le(r,s)),this._addCollisionDebugVertex(A,M,h,O,Z,new Le(e,s)),y.vertexLength+=4;var X=u.indexArray;X.emplaceBack(w,w+1),X.emplaceBack(w+1,w+2),X.emplaceBack(w+2,w+3),X.emplaceBack(w+3,w),y.primitiveLength+=4},Re.prototype.addDebugCollisionBoxes=function(e,t,r,s){for(var u=e;u<t;u++){var h=this.collisionBoxArray.get(u);this.addCollisionDebugVertices(h.x1,h.y1,h.x2,h.y2,s?this.textCollisionBox:this.iconCollisionBox,h.anchorPoint,r)}},Re.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ke(ps,hh.members,qu),this.iconCollisionBox=new Ke(ps,hh.members,qu);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Re.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,s,u,h,p,y,w){for(var A={},M=t;M<r;M++){var O=e.get(M);A.textBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},A.textFeatureIndex=O.featureIndex;break}for(var Z=s;Z<u;Z++){var X=e.get(Z);A.verticalTextBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},A.verticalTextFeatureIndex=X.featureIndex;break}for(var Ee=h;Ee<p;Ee++){var Ie=e.get(Ee);A.iconBox={x1:Ie.x1,y1:Ie.y1,x2:Ie.x2,y2:Ie.y2,anchorPointX:Ie.anchorPointX,anchorPointY:Ie.anchorPointY},A.iconFeatureIndex=Ie.featureIndex;break}for(var Xe=y;Xe<w;Xe++){var Be=e.get(Xe);A.verticalIconBox={x1:Be.x1,y1:Be.y1,x2:Be.x2,y2:Be.y2,anchorPointX:Be.anchorPointX,anchorPointY:Be.anchorPointY},A.verticalIconFeatureIndex=Be.featureIndex;break}return A},Re.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},Re.prototype.hasTextData=function(){return this.text.segments.get().length>0},Re.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Re.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Re.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Re.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Re.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),s=r.vertexStartIndex+4*r.numGlyphs,u=r.vertexStartIndex;u<s;u+=4)e.indexArray.emplaceBack(u,u+1,u+2),e.indexArray.emplaceBack(u+1,u+2,u+3)},Re.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),s=[],u=[],h=[],p=0;p<this.symbolInstances.length;++p){h.push(p);var y=this.symbolInstances.get(p);s.push(0|Math.round(t*y.anchorX+r*y.anchorY)),u.push(y.featureIndex)}return h.sort(function(w,A){return s[w]-s[A]||u[A]-u[w]}),h},Re.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Re.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,s=this.symbolInstanceIndexes;r<s.length;r+=1){var u=this.symbolInstances.get(s[r]);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach(function(h,p,y){h>=0&&y.indexOf(h)===p&&t.addIndicesForPlacedSymbol(t.text,h)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},dn("SymbolBucket",Re,{omit:["layers","collisionBoxArray","features","compareText"]}),Re.MAX_GLYPHS=65535,Re.addDynamicAttributes=Ue;var nt=new xi({"symbol-placement":new tr(J.layout_symbol["symbol-placement"]),"symbol-spacing":new tr(J.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new tr(J.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new or(J.layout_symbol["symbol-sort-key"]),"symbol-z-order":new tr(J.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new tr(J.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new tr(J.layout_symbol["icon-ignore-placement"]),"icon-optional":new tr(J.layout_symbol["icon-optional"]),"icon-rotation-alignment":new tr(J.layout_symbol["icon-rotation-alignment"]),"icon-size":new or(J.layout_symbol["icon-size"]),"icon-text-fit":new tr(J.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new tr(J.layout_symbol["icon-text-fit-padding"]),"icon-image":new or(J.layout_symbol["icon-image"]),"icon-rotate":new or(J.layout_symbol["icon-rotate"]),"icon-padding":new tr(J.layout_symbol["icon-padding"]),"icon-keep-upright":new tr(J.layout_symbol["icon-keep-upright"]),"icon-offset":new or(J.layout_symbol["icon-offset"]),"icon-anchor":new or(J.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new tr(J.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new tr(J.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new tr(J.layout_symbol["text-rotation-alignment"]),"text-field":new or(J.layout_symbol["text-field"]),"text-font":new or(J.layout_symbol["text-font"]),"text-size":new or(J.layout_symbol["text-size"]),"text-max-width":new or(J.layout_symbol["text-max-width"]),"text-line-height":new tr(J.layout_symbol["text-line-height"]),"text-letter-spacing":new or(J.layout_symbol["text-letter-spacing"]),"text-justify":new or(J.layout_symbol["text-justify"]),"text-radial-offset":new or(J.layout_symbol["text-radial-offset"]),"text-variable-anchor":new tr(J.layout_symbol["text-variable-anchor"]),"text-anchor":new or(J.layout_symbol["text-anchor"]),"text-max-angle":new tr(J.layout_symbol["text-max-angle"]),"text-writing-mode":new tr(J.layout_symbol["text-writing-mode"]),"text-rotate":new or(J.layout_symbol["text-rotate"]),"text-padding":new tr(J.layout_symbol["text-padding"]),"text-keep-upright":new tr(J.layout_symbol["text-keep-upright"]),"text-transform":new or(J.layout_symbol["text-transform"]),"text-offset":new or(J.layout_symbol["text-offset"]),"text-allow-overlap":new tr(J.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new tr(J.layout_symbol["text-ignore-placement"]),"text-optional":new tr(J.layout_symbol["text-optional"])}),se={paint:new xi({"icon-opacity":new or(J.paint_symbol["icon-opacity"]),"icon-color":new or(J.paint_symbol["icon-color"]),"icon-halo-color":new or(J.paint_symbol["icon-halo-color"]),"icon-halo-width":new or(J.paint_symbol["icon-halo-width"]),"icon-halo-blur":new or(J.paint_symbol["icon-halo-blur"]),"icon-translate":new tr(J.paint_symbol["icon-translate"]),"icon-translate-anchor":new tr(J.paint_symbol["icon-translate-anchor"]),"text-opacity":new or(J.paint_symbol["text-opacity"]),"text-color":new or(J.paint_symbol["text-color"],{runtimeType:Yr,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new or(J.paint_symbol["text-halo-color"]),"text-halo-width":new or(J.paint_symbol["text-halo-width"]),"text-halo-blur":new or(J.paint_symbol["text-halo-blur"]),"text-translate":new tr(J.paint_symbol["text-translate"]),"text-translate-anchor":new tr(J.paint_symbol["text-translate-anchor"])}),layout:nt},Ve=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:cn,this.defaultValue=e};Ve.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},Ve.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},Ve.prototype.outputDefined=function(){return!1},Ve.prototype.serialize=function(){return null},dn("FormatSectionOverride",Ve,{omit:["defaultValue"]});var ye=function(e){function t(r){e.call(this,r,se)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,s){if(e.prototype.recalculate.call(this,r,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var u=this.layout.get("text-writing-mode");if(u){for(var h=[],p=0,y=u;p<y.length;p+=1){var w=y[p];h.indexOf(w)<0&&h.push(w)}this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,s,u,h){var p=this.layout.get(r).evaluate(s,{},u,h),y=this._unevaluatedLayout._values[r];return y.isDataDriven()||lu(y.value)||!p?p:function(w,A){return A.replace(/{([^{}]+)}/g,function(M,O){return O in w?String(w[O]):""})}(s.properties,p)},t.prototype.createBucket=function(r){return new Re(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,s=se.paint.overridableProperties;r<s.length;r+=1){var u=s[r];if(t.hasPaintOverride(this.layout,u)){var h,p=this.paint.get(u),y=new Ve(p),w=new Su(y,p.property.specification);h=p.value.kind==="constant"||p.value.kind==="source"?new hu("source",w):new Ls("composite",w,p.value.zoomStops,p.value._interpolationType),this.paint._values[u]=new Jr(p.property,h,p.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,s,u){return!(!this.layout||s.isDataDriven()||u.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,s){var u=r.get("text-field"),h=se.paint.properties[s],p=!1,y=function(M){for(var O=0,Z=M;O<Z.length;O+=1)if(h.overrides&&h.overrides.hasOverride(Z[O]))return void(p=!0)};if(u.value.kind==="constant"&&u.value.value instanceof ea)y(u.value.value.sections);else if(u.value.kind==="source"){var w=function(M){p||(M instanceof ya&&Di(M.value)===Oi?y(M.value.sections):M instanceof wa?y(M.sections):M.eachChild(w))},A=u.value;A._styleExpression&&w(A._styleExpression.expression)}return p},t}(Ta),pt={paint:new xi({"background-color":new tr(J.paint_background["background-color"]),"background-pattern":new Ci(J.paint_background["background-pattern"]),"background-opacity":new tr(J.paint_background["background-opacity"])})},Ct=function(e){function t(r){e.call(this,r,pt)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ta),xr={paint:new xi({"raster-opacity":new tr(J.paint_raster["raster-opacity"]),"raster-hue-rotate":new tr(J.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new tr(J.paint_raster["raster-brightness-min"]),"raster-brightness-max":new tr(J.paint_raster["raster-brightness-max"]),"raster-saturation":new tr(J.paint_raster["raster-saturation"]),"raster-contrast":new tr(J.paint_raster["raster-contrast"]),"raster-resampling":new tr(J.paint_raster["raster-resampling"]),"raster-fade-duration":new tr(J.paint_raster["raster-fade-duration"])})},Wr=function(e){function t(r){e.call(this,r,xr)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ta),Xr=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(Ta),un={circle:ec,heatmap:Lc,hillshade:ah,fill:Sc,"fill-extrusion":Ru,line:Nh,symbol:ye,background:Ct,raster:Wr},Vr=Fe.HTMLImageElement,Sn=Fe.HTMLCanvasElement,pn=Fe.HTMLVideoElement,En=Fe.ImageData,bn=Fe.ImageBitmap,_n=function(e,t,r,s){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,s)};_n.prototype.update=function(e,t,r){var s=e.width,u=e.height,h=!(this.size&&this.size[0]===s&&this.size[1]===u||r),p=this.context,y=p.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),y.bindTexture(y.TEXTURE_2D,this.texture),p.pixelStoreUnpackFlipY.set(!1),p.pixelStoreUnpack.set(1),p.pixelStoreUnpackPremultiplyAlpha.set(this.format===y.RGBA&&(!t||t.premultiply!==!1)),h)this.size=[s,u],e instanceof Vr||e instanceof Sn||e instanceof pn||e instanceof En||bn&&e instanceof bn?y.texImage2D(y.TEXTURE_2D,0,this.format,this.format,y.UNSIGNED_BYTE,e):y.texImage2D(y.TEXTURE_2D,0,this.format,s,u,0,this.format,y.UNSIGNED_BYTE,e.data);else{var w=r||{x:0,y:0},A=w.x,M=w.y;e instanceof Vr||e instanceof Sn||e instanceof pn||e instanceof En||bn&&e instanceof bn?y.texSubImage2D(y.TEXTURE_2D,0,A,M,y.RGBA,y.UNSIGNED_BYTE,e):y.texSubImage2D(y.TEXTURE_2D,0,A,M,s,u,y.RGBA,y.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&y.generateMipmap(y.TEXTURE_2D)},_n.prototype.bind=function(e,t,r){var s=this.context.gl;s.bindTexture(s.TEXTURE_2D,this.texture),r!==s.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=s.LINEAR),e!==this.filter&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,t),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,t),this.wrap=t)},_n.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},_n.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Un=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};Un.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},Un.prototype.remove=function(){delete this._channel,this._callback=function(){}};var aa=function(e,t,r){this.target=e,this.parent=t,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},mt(["receive","process"],this),this.invoker=new Un(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=V()?e:Fe};function Lo(e,t,r){var s=2*Math.PI*6378137/256/Math.pow(2,r);return[e*s-2*Math.PI*6378137/2,t*s-2*Math.PI*6378137/2]}aa.prototype.send=function(e,t,r,s,u){var h=this;u===void 0&&(u=!1);var p=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[p]=r);var y=U(this.globalScope)?void 0:[];return this.target.postMessage({id:p,type:e,hasCallback:!!r,targetMapId:s,mustQueue:u,sourceMapId:this.mapId,data:Ko(t,y)},y),{cancel:function(){r&&delete h.callbacks[p],h.target.postMessage({id:p,type:"<cancel>",targetMapId:s,sourceMapId:h.mapId})}}},aa.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[r];var s=this.cancelCallbacks[r];delete this.cancelCallbacks[r],s&&s()}else V()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},aa.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},aa.prototype.processTask=function(e,t){var r=this;if(t.type==="<response>"){var s=this.callbacks[e];delete this.callbacks[e],s&&(t.error?s(Oo(t.error)):s(null,Oo(t.data)))}else{var u=!1,h=U(this.globalScope)?void 0:[],p=t.hasCallback?function(M,O){u=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:M?Ko(M):null,data:Ko(O,h)},h)}:function(M){u=!0},y=null,w=Oo(t.data);if(this.parent[t.type])y=this.parent[t.type](t.sourceMapId,w,p);else if(this.parent.getWorkerSource){var A=t.type.split(".");y=this.parent.getWorkerSource(t.sourceMapId,A[0],w.source)[A[1]](w,p)}else p(new Error("Could not find function "+t.type));!u&&y&&y.cancel&&(this.cancelCallbacks[e]=y.cancel)}},aa.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var ma=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};ma.prototype.setNorthEast=function(e){return this._ne=e instanceof Ki?new Ki(e.lng,e.lat):Ki.convert(e),this},ma.prototype.setSouthWest=function(e){return this._sw=e instanceof Ki?new Ki(e.lng,e.lat):Ki.convert(e),this},ma.prototype.extend=function(e){var t,r,s=this._sw,u=this._ne;if(e instanceof Ki)t=e,r=e;else{if(!(e instanceof ma))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ma.convert(e)):this.extend(Ki.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return s||u?(s.lng=Math.min(t.lng,s.lng),s.lat=Math.min(t.lat,s.lat),u.lng=Math.max(r.lng,u.lng),u.lat=Math.max(r.lat,u.lat)):(this._sw=new Ki(t.lng,t.lat),this._ne=new Ki(r.lng,r.lat)),this},ma.prototype.getCenter=function(){return new Ki((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},ma.prototype.getSouthWest=function(){return this._sw},ma.prototype.getNorthEast=function(){return this._ne},ma.prototype.getNorthWest=function(){return new Ki(this.getWest(),this.getNorth())},ma.prototype.getSouthEast=function(){return new Ki(this.getEast(),this.getSouth())},ma.prototype.getWest=function(){return this._sw.lng},ma.prototype.getSouth=function(){return this._sw.lat},ma.prototype.getEast=function(){return this._ne.lng},ma.prototype.getNorth=function(){return this._ne.lat},ma.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},ma.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},ma.prototype.isEmpty=function(){return!(this._sw&&this._ne)},ma.prototype.contains=function(e){var t=Ki.convert(e),r=t.lng,s=t.lat,u=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&u},ma.convert=function(e){return!e||e instanceof ma?e:new ma(e)};var Ki=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ki.prototype.wrap=function(){return new Ki(Er(this.lng,-180,180),this.lat)},Ki.prototype.toArray=function(){return[this.lng,this.lat]},Ki.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ki.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,s=e.lat*t,u=Math.sin(r)*Math.sin(s)+Math.cos(r)*Math.cos(s)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(u,1))},Ki.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new ma(new Ki(this.lng-r,this.lat-t),new Ki(this.lng+r,this.lat+t))},Ki.convert=function(e){if(e instanceof Ki)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Ki(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Ki(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Fu=2*Math.PI*63710088e-1;function es(e){return Fu*Math.cos(e*Math.PI/180)}function bu(e){return(180+e)/360}function Ns(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function dh(e,t){return e/es(t)}function Vs(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var wl=function(e,t,r){r===void 0&&(r=0),this.x=+e,this.y=+t,this.z=+r};wl.fromLngLat=function(e,t){t===void 0&&(t=0);var r=Ki.convert(e);return new wl(bu(r.lng),Ns(r.lat),dh(t,r.lat))},wl.prototype.toLngLat=function(){return new Ki(360*this.x-180,Vs(this.y))},wl.prototype.toAltitude=function(){return this.z*es(Vs(this.y))},wl.prototype.meterInMercatorCoordinateUnits=function(){return 1/Fu*(e=Vs(this.y),1/Math.cos(e*Math.PI/180));var e};var Ic=function(e,t,r){this.z=e,this.x=t,this.y=r,this.key=mh(0,e,e,t,r)};Ic.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Ic.prototype.url=function(e,t){var r,s,u,h,p,y=(s=this.y,u=this.z,h=Lo(256*(r=this.x),256*(s=Math.pow(2,u)-s-1),u),p=Lo(256*(r+1),256*(s+1),u),h[0]+","+h[1]+","+p[0]+","+p[1]),w=function(A,M,O){for(var Z,X="",Ee=A;Ee>0;Ee--)X+=(M&(Z=1<<Ee-1)?1:0)+(O&Z?2:0);return X}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",w).replace("{bbox-epsg-3857}",y)},Ic.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new Le(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},Ic.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Df=function(e,t){this.wrap=e,this.canonical=t,this.key=mh(e,t.z,t.z,t.x,t.y)},Eo=function(e,t,r,s,u){this.overscaledZ=e,this.wrap=t,this.canonical=new Ic(r,+s,+u),this.key=mh(t,e,r,s,u)};function mh(e,t,r,s,u){(e*=2)<0&&(e=-1*e-1);var h=1<<r;return(h*h*e+h*u+s).toString(36)+r.toString(36)+t.toString(36)}Eo.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Eo.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Eo(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Eo(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Eo.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?mh(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):mh(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},Eo.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Eo.prototype.children=function(e){if(this.overscaledZ>=e)return[new Eo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,s=2*this.canonical.y;return[new Eo(t,this.wrap,t,r,s),new Eo(t,this.wrap,t,r+1,s),new Eo(t,this.wrap,t,r,s+1),new Eo(t,this.wrap,t,r+1,s+1)]},Eo.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Eo.prototype.wrapped=function(){return new Eo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Eo.prototype.unwrapTo=function(e){return new Eo(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Eo.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Eo.prototype.toUnwrapped=function(){return new Df(this.wrap,this.canonical)},Eo.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Eo.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new wl(e.x-this.wrap,e.y))},dn("CanonicalTileID",Ic),dn("OverscaledTileID",Eo,{omit:["posMatrix"]});var Gl=function(e,t,r){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&r!=="mapbox"&&r!=="terrarium")return we('"'+r+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var s=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=r||"mapbox";for(var u=0;u<s;u++)this.data[this._idx(-1,u)]=this.data[this._idx(0,u)],this.data[this._idx(s,u)]=this.data[this._idx(s-1,u)],this.data[this._idx(u,-1)]=this.data[this._idx(u,0)],this.data[this._idx(u,s)]=this.data[this._idx(u,s-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(s,-1)]=this.data[this._idx(s-1,0)],this.data[this._idx(-1,s)]=this.data[this._idx(0,s-1)],this.data[this._idx(s,s)]=this.data[this._idx(s-1,s-1)]};Gl.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),s=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(r[s],r[s+1],r[s+2])},Gl.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Gl.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Gl.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},Gl.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},Gl.prototype.getPixels=function(){return new fo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Gl.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var s=t*this.dim,u=t*this.dim+this.dim,h=r*this.dim,p=r*this.dim+this.dim;switch(t){case-1:s=u-1;break;case 1:u=s+1}switch(r){case-1:h=p-1;break;case 1:p=h+1}for(var y=-t*this.dim,w=-r*this.dim,A=h;A<p;A++)for(var M=s;M<u;M++)this.data[this._idx(M,A)]=e.data[this._idx(M+y,A+w)]},dn("DEMData",Gl);var jh=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}};jh.prototype.encode=function(e){return this._stringToNumber[e]},jh.prototype.decode=function(e){return this._numberToString[e]};var qh=function(e,t,r,s,u){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=s,this.properties=e.properties,this.id=u},bf={geometry:{configurable:!0}};bf.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},bf.geometry.set=function(e){this._geometry=e},qh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(qh.prototype,bf);var Zc=function(){this.state={},this.stateChanges={},this.deletedStates={}};Zc.prototype.updateState=function(e,t,r){var s=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][s]=this.stateChanges[e][s]||{},wt(this.stateChanges[e][s],r),this.deletedStates[e]===null)for(var u in this.deletedStates[e]={},this.state[e])u!==s&&(this.deletedStates[e][u]=null);else if(this.deletedStates[e]&&this.deletedStates[e][s]===null)for(var h in this.deletedStates[e][s]={},this.state[e][s])r[h]||(this.deletedStates[e][s][h]=null);else for(var p in r)this.deletedStates[e]&&this.deletedStates[e][s]&&this.deletedStates[e][s][p]===null&&delete this.deletedStates[e][s][p]},Zc.prototype.removeFeatureState=function(e,t,r){if(this.deletedStates[e]!==null){var s=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&t!==void 0)this.deletedStates[e][s]!==null&&(this.deletedStates[e][s]=this.deletedStates[e][s]||{},this.deletedStates[e][s][r]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][s])for(r in this.deletedStates[e][s]={},this.stateChanges[e][s])this.deletedStates[e][s][r]=null;else this.deletedStates[e][s]=null;else this.deletedStates[e]=null}},Zc.prototype.getState=function(e,t){var r=String(t),s=wt({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var u=this.deletedStates[e][t];if(u===null)return{};for(var h in u)delete s[h]}return s},Zc.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},Zc.prototype.coalesceChanges=function(e,t){var r={};for(var s in this.stateChanges){this.state[s]=this.state[s]||{};var u={};for(var h in this.stateChanges[s])this.state[s][h]||(this.state[s][h]={}),wt(this.state[s][h],this.stateChanges[s][h]),u[h]=this.state[s][h];r[s]=u}for(var p in this.deletedStates){this.state[p]=this.state[p]||{};var y={};if(this.deletedStates[p]===null)for(var w in this.state[p])y[w]={},this.state[p][w]={};else for(var A in this.deletedStates[p]){if(this.deletedStates[p][A]===null)this.state[p][A]={};else for(var M=0,O=Object.keys(this.deletedStates[p][A]);M<O.length;M+=1)delete this.state[p][A][O[M]];y[A]=this.state[p][A]}r[p]=r[p]||{},wt(r[p],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(var Z in e)e[Z].setFeatureState(r,t)};var jl=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Yo(8192,16,0),this.grid3D=new Yo(8192,16,0),this.featureIndexArray=new F,this.promoteId=t};function Rf(e,t,r,s,u){return Te(e,function(h,p){var y=t instanceof Tn?t.get(p):null;return y&&y.evaluate?y.evaluate(r,s,u):y})}function Of(e){for(var t=1/0,r=1/0,s=-1/0,u=-1/0,h=0,p=e;h<p.length;h+=1){var y=p[h];t=Math.min(t,y.x),r=Math.min(r,y.y),s=Math.max(s,y.x),u=Math.max(u,y.y)}return{minX:t,minY:r,maxX:s,maxY:u}}function sp(e,t){return t-e}jl.prototype.insert=function(e,t,r,s,u,h){var p=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,s,u);for(var y=h?this.grid3D:this.grid,w=0;w<t.length;w++){for(var A=t[w],M=[1/0,1/0,-1/0,-1/0],O=0;O<A.length;O++){var Z=A[O];M[0]=Math.min(M[0],Z.x),M[1]=Math.min(M[1],Z.y),M[2]=Math.max(M[2],Z.x),M[3]=Math.max(M[3],Z.y)}M[0]<8192&&M[1]<8192&&M[2]>=0&&M[3]>=0&&y.insert(p,M[0],M[1],M[2],M[3])}},jl.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Bs.VectorTile(new Cc(this.rawTileData)).layers,this.sourceLayerCoder=new jh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},jl.prototype.query=function(e,t,r,s){var u=this;this.loadVTLayers();for(var h=e.params||{},p=8192/e.tileSize/e.scale,y=Nu(h.filter),w=e.queryGeometry,A=e.queryPadding*p,M=Of(w),O=this.grid.query(M.minX-A,M.minY-A,M.maxX+A,M.maxY+A),Z=Of(e.cameraQueryGeometry),X=this.grid3D.query(Z.minX-A,Z.minY-A,Z.maxX+A,Z.maxY+A,function(Ht,Jt,mr,Fr){return function(tn,kn,yn,On,xn){for(var gi=0,Hn=tn;gi<Hn.length;gi+=1){var In=Hn[gi];if(kn<=In.x&&yn<=In.y&&On>=In.x&&xn>=In.y)return!0}var Pi=[new Le(kn,yn),new Le(kn,xn),new Le(On,xn),new Le(On,yn)];if(tn.length>2){for(var pi=0,Ui=Pi;pi<Ui.length;pi+=1)if(ks(tn,Ui[pi]))return!0}for(var Fn=0;Fn<tn.length-1;Fn++)if(Wu(tn[Fn],tn[Fn+1],Pi))return!0;return!1}(e.cameraQueryGeometry,Ht-A,Jt-A,mr+A,Fr+A)}),Ee=0,Ie=X;Ee<Ie.length;Ee+=1)O.push(Ie[Ee]);O.sort(sp);for(var Xe,Be={},ut=function(Ht){var Jt=O[Ht];if(Jt!==Xe){Xe=Jt;var mr=u.featureIndexArray.get(Jt),Fr=null;u.loadMatchingFeature(Be,mr.bucketIndex,mr.sourceLayerIndex,mr.featureIndex,y,h.layers,h.availableImages,t,r,s,function(tn,kn,yn){return Fr||(Fr=Ia(tn)),kn.queryIntersectsFeature(w,tn,yn,Fr,u.z,e.transform,p,e.pixelPosMatrix)})}},It=0;It<O.length;It++)ut(It);return Be},jl.prototype.loadMatchingFeature=function(e,t,r,s,u,h,p,y,w,A,M){var O=this.bucketLayerIDs[t];if(!h||function(tn,kn){for(var yn=0;yn<tn.length;yn++)if(kn.indexOf(tn[yn])>=0)return!0;return!1}(h,O)){var Z=this.sourceLayerCoder.decode(r),X=this.vtLayers[Z].feature(s);if(u.needGeometry){var Ee=Na(X,!0);if(!u.filter(new $(this.tileID.overscaledZ),Ee,this.tileID.canonical))return}else if(!u.filter(new $(this.tileID.overscaledZ),X))return;for(var Ie=this.getId(X,Z),Xe=0;Xe<O.length;Xe++){var Be=O[Xe];if(!(h&&h.indexOf(Be)<0)){var ut=y[Be];if(ut){var It={};Ie!==void 0&&A&&(It=A.getState(ut.sourceLayer||"_geojsonTileLayer",Ie));var Ht=wt({},w[Be]);Ht.paint=Rf(Ht.paint,ut.paint,X,It,p),Ht.layout=Rf(Ht.layout,ut.layout,X,It,p);var Jt=!M||M(X,ut,It);if(Jt){var mr=new qh(X,this.z,this.x,this.y,Ie);mr.layer=Ht;var Fr=e[Be];Fr===void 0&&(Fr=e[Be]=[]),Fr.push({featureIndex:s,feature:mr,intersectionZ:Jt})}}}}}},jl.prototype.lookupSymbolFeatures=function(e,t,r,s,u,h,p,y){var w={};this.loadVTLayers();for(var A=Nu(u),M=0,O=e;M<O.length;M+=1)this.loadMatchingFeature(w,r,s,O[M],A,h,p,y,t);return w},jl.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var s=0,u=r[t];s<u.length;s+=1)if(e===u[s])return!0;return!1},jl.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&typeof(r=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(r=Number(r)),r},dn("FeatureIndex",jl,{omit:["rawTileData","sourceLayerCoder"]});var Uo=function(e,t){this.tileID=e,this.uid=Et(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Uo.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<He.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Uo.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Uo.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var s in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(A,M){var O={};if(!M)return O;for(var Z=function(){var Ie=Ee[X],Xe=Ie.layerIds.map(function(It){return M.getLayer(It)}).filter(Boolean);if(Xe.length!==0){Ie.layers=Xe,Ie.stateDependentLayerIds&&(Ie.stateDependentLayers=Ie.stateDependentLayerIds.map(function(It){return Xe.filter(function(Ht){return Ht.id===It})[0]}));for(var Be=0,ut=Xe;Be<ut.length;Be+=1)O[ut[Be].id]=Ie}},X=0,Ee=A;X<Ee.length;X+=1)Z();return O}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var u=this.buckets[s];if(u instanceof Re){if(this.hasSymbolBuckets=!0,!r)break;u.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var h in this.buckets){var p=this.buckets[h];if(p instanceof Re&&p.hasRTLText){this.hasRTLText=!0,I.isLoading()||I.isLoaded()||Ql()!=="deferred"||g();break}}for(var y in this.queryPadding=0,this.buckets){var w=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(y).queryRadius(w))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new a},Uo.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Uo.prototype.getBucket=function(e){return this.buckets[e.id]},Uo.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var s=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new _n(e,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new _n(e,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)},Uo.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Uo.prototype.queryRenderedFeatures=function(e,t,r,s,u,h,p,y,w,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:s,cameraQueryGeometry:u,scale:h,tileSize:this.tileSize,pixelPosMatrix:A,transform:y,params:p,queryPadding:this.queryPadding*w},e,t,r):{}},Uo.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var s=r.loadVTLayers(),u=t?t.sourceLayer:"",h=s._geojsonTileLayer||s[u];if(h)for(var p=Nu(t&&t.filter),y=this.tileID.canonical,w=y.z,A=y.x,M=y.y,O={z:w,x:A,y:M},Z=0;Z<h.length;Z++){var X=h.feature(Z);if(p.needGeometry){var Ee=Na(X,!0);if(!p.filter(new $(this.tileID.overscaledZ),Ee,this.tileID.canonical))continue}else if(!p.filter(new $(this.tileID.overscaledZ),X))continue;var Ie=r.getId(X,u),Xe=new qh(X,w,A,M,Ie);Xe.tile=O,e.push(Xe)}}},Uo.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Uo.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Uo.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=pe(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var s=Date.now(),u=!1;if(this.expirationTime>s)u=!1;else if(t)if(this.expirationTime<t)u=!0;else{var h=this.expirationTime-t;h?this.expirationTime=s+Math.max(h,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Uo.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Uo.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var r=this.latestFeatureIndex.loadVTLayers();for(var s in this.buckets)if(t.style.hasLayer(s)){var u=this.buckets[s],h=u.layers[0].sourceLayer||"_geojsonTileLayer",p=r[h],y=e[h];if(p&&y&&Object.keys(y).length!==0){u.update(y,p,this.imageAtlas&&this.imageAtlas.patternPositions||{});var w=t&&t.style&&t.style.getLayer(s);w&&(this.queryPadding=Math.max(this.queryPadding,w.queryRadius(u)))}}}},Uo.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Uo.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<He.now()},Uo.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Uo.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=He.now()+e},Uo.prototype.setDependencies=function(e,t){for(var r={},s=0,u=t;s<u.length;s+=1)r[u[s]]=!0;this.dependencies[e]=r},Uo.prototype.hasDependency=function(e,t){for(var r=0,s=e;r<s.length;r+=1){var u=this.dependencies[s[r]];if(u){for(var h=0,p=t;h<p.length;h+=1)if(u[p[h]])return!0}}return!1};var hc=Fe.performance,Ff=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},hc.mark(this._marks.start)};Ff.prototype.finish=function(){hc.mark(this._marks.end);var e=hc.getEntriesByName(this._marks.measure);return e.length===0&&(hc.measure(this._marks.measure,this._marks.start,this._marks.end),e=hc.getEntriesByName(this._marks.measure),hc.clearMarks(this._marks.start),hc.clearMarks(this._marks.end),hc.clearMeasures(this._marks.measure)),e},l.Actor=aa,l.AlphaImage=zs,l.CanonicalTileID=Ic,l.CollisionBoxArray=a,l.Color=vi,l.DEMData=Gl,l.DataConstantProperty=tr,l.DictionaryCoder=jh,l.EXTENT=8192,l.ErrorEvent=Ne,l.EvaluationParameters=$,l.Event=xe,l.Evented=Qe,l.FeatureIndex=jl,l.FillBucket=vs,l.FillExtrusionBucket=xu,l.ImageAtlas=kr,l.ImagePosition=ht,l.LineBucket=ra,l.LngLat=Ki,l.LngLatBounds=ma,l.MercatorCoordinate=wl,l.ONE_EM=24,l.OverscaledTileID=Eo,l.Point=Le,l.Point$1=Le,l.Properties=xi,l.Protobuf=Cc,l.RGBAImage=fo,l.RequestManager=Gr,l.RequestPerformance=Ff,l.ResourceType=Nr,l.SegmentVector=ee,l.SourceFeatureState=Zc,l.StructArrayLayout1ui2=Ol,l.StructArrayLayout2f1f2i16=as,l.StructArrayLayout2i4=si,l.StructArrayLayout3ui6=$s,l.StructArrayLayout4i8=ha,l.SymbolBucket=Re,l.Texture=_n,l.Tile=Uo,l.Transitionable=tt,l.Uniform1f=Ur,l.Uniform1i=Sr,l.Uniform2f=Br,l.Uniform3f=hn,l.Uniform4f=Pn,l.UniformColor=Mn,l.UniformMatrix4f=Ei,l.UnwrappedTileID=Df,l.ValidationError=Me,l.WritingMode=Hr,l.ZoomHistory=Rl,l.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},l.addDynamicAttributes=Ue,l.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var s=e.length,u=new Array(e.length),h=null;e.forEach(function(p,y){t(p,function(w,A){w&&(h=w),u[y]=A,--s==0&&r(h,u)})})},l.bezier=nr,l.bindAll=mt,l.browser=He,l.cacheEntryPossiblyAdded=function(e){++wr>ve&&(e.getActor().send("enforceCacheSizeLimit",he),wr=0)},l.clamp=Dt,l.clearTileCache=function(e){var t=Fe.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},l.clipLine=Xa,l.clone=function(e){var t=new qi(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},l.clone$1=me,l.clone$2=function(e){var t=new qi(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},l.collisionCircleLayout=gf,l.config=We,l.create=function(){var e=new qi(16);return qi!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},l.create$1=function(){var e=new qi(9);return qi!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},l.create$2=function(){var e=new qi(4);return qi!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},l.createCommonjsModule=Vt,l.createExpression=cu,l.createLayout=yi,l.createStyleLayer=function(e){return e.type==="custom"?new Xr(e):new un[e.type](e)},l.cross=function(e,t,r){var s=t[0],u=t[1],h=t[2],p=r[0],y=r[1],w=r[2];return e[0]=u*w-h*y,e[1]=h*p-s*w,e[2]=s*y-u*p,e},l.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var s=0;s<t.length;s++)if(!e(t[s],r[s]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(var u in t)if(!e(t[u],r[u]))return!1;return!0}return t===r},l.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},l.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},l.ease=dr,l.emitValidationErrors=Uu,l.endsWith=k,l.enforceCacheSizeLimit=function(e){it(),R&&R.then(function(t){t.keys().then(function(r){for(var s=0;s<r.length-e;s++)t.delete(r[s])})})},l.evaluateSizeForFeature=Gn,l.evaluateSizeForZoom=ii,l.evaluateVariableOffset=Ou,l.evented=hl,l.extend=wt,l.featureFilter=Nu,l.filterObject=Se,l.fromRotation=function(e,t){var r=Math.sin(t),s=Math.cos(t);return e[0]=s,e[1]=r,e[2]=0,e[3]=-r,e[4]=s,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},l.getAnchorAlignment=an,l.getAnchorJustification=be,l.getArrayBuffer=Li,l.getImage=N,l.getJSON=function(e,t){return Mi(wt(e,{type:"json"}),t)},l.getRTLTextPluginStatus=Ql,l.getReferrer=jr,l.getVideo=function(e,t){var r,s,u=Fe.document.createElement("video");u.muted=!0,u.onloadstart=function(){t(null,u)};for(var h=0;h<e.length;h++){var p=Fe.document.createElement("source");r=e[h],s=void 0,(s=Fe.document.createElement("a")).href=r,(s.protocol!==Fe.document.location.protocol||s.host!==Fe.document.location.host)&&(u.crossOrigin="Anonymous"),p.src=e[h],u.appendChild(p)}return{cancel:function(){}}},l.identity=os,l.invert=function(e,t){var r=t[0],s=t[1],u=t[2],h=t[3],p=t[4],y=t[5],w=t[6],A=t[7],M=t[8],O=t[9],Z=t[10],X=t[11],Ee=t[12],Ie=t[13],Xe=t[14],Be=t[15],ut=r*y-s*p,It=r*w-u*p,Ht=r*A-h*p,Jt=s*w-u*y,mr=s*A-h*y,Fr=u*A-h*w,tn=M*Ie-O*Ee,kn=M*Xe-Z*Ee,yn=M*Be-X*Ee,On=O*Xe-Z*Ie,xn=O*Be-X*Ie,gi=Z*Be-X*Xe,Hn=ut*gi-It*xn+Ht*On+Jt*yn-mr*kn+Fr*tn;return Hn?(e[0]=(y*gi-w*xn+A*On)*(Hn=1/Hn),e[1]=(u*xn-s*gi-h*On)*Hn,e[2]=(Ie*Fr-Xe*mr+Be*Jt)*Hn,e[3]=(Z*mr-O*Fr-X*Jt)*Hn,e[4]=(w*yn-p*gi-A*kn)*Hn,e[5]=(r*gi-u*yn+h*kn)*Hn,e[6]=(Xe*Ht-Ee*Fr-Be*It)*Hn,e[7]=(M*Fr-Z*Ht+X*It)*Hn,e[8]=(p*xn-y*yn+A*tn)*Hn,e[9]=(s*yn-r*xn-h*tn)*Hn,e[10]=(Ee*mr-Ie*Ht+Be*ut)*Hn,e[11]=(O*Ht-M*mr-X*ut)*Hn,e[12]=(y*kn-p*On-w*tn)*Hn,e[13]=(r*On-s*kn+u*tn)*Hn,e[14]=(Ie*It-Ee*Jt-Xe*ut)*Hn,e[15]=(M*Jt-O*It+Z*ut)*Hn,e):null},l.isChar=Zr,l.isMapboxURL=er,l.keysDifference=function(e,t){var r=[];for(var s in e)s in t||r.push(s);return r},l.makeRequest=Mi,l.mapObject=Te,l.mercatorXfromLng=bu,l.mercatorYfromLat=Ns,l.mercatorZfromAltitude=dh,l.mul=Fl,l.multiply=No,l.mvt=Bs,l.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},l.normalize=function(e,t){var r=t[0],s=t[1],u=t[2],h=r*r+s*s+u*u;return h>0&&(h=1/Math.sqrt(h)),e[0]=t[0]*h,e[1]=t[1]*h,e[2]=t[2]*h,e},l.number=Wi,l.offscreenCanvasSupported=Dr,l.ortho=function(e,t,r,s,u,h,p){var y=1/(t-r),w=1/(s-u),A=1/(h-p);return e[0]=-2*y,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*w,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*A,e[11]=0,e[12]=(t+r)*y,e[13]=(u+s)*w,e[14]=(p+h)*A,e[15]=1,e},l.parseGlyphPBF=function(e){return new Cc(e).readFields(Or,[])},l.pbf=Cc,l.performSymbolLayout=function(e,t,r,s,u,h,p){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var y=e.layers[0].layout,w=e.layers[0]._unevaluatedLayout._values,A={};if(e.textSizeData.kind==="composite"){var M=e.textSizeData,O=M.maxZoom;A.compositeTextSizes=[w["text-size"].possiblyEvaluate(new $(M.minZoom),p),w["text-size"].possiblyEvaluate(new $(O),p)]}if(e.iconSizeData.kind==="composite"){var Z=e.iconSizeData,X=Z.maxZoom;A.compositeIconSizes=[w["icon-size"].possiblyEvaluate(new $(Z.minZoom),p),w["icon-size"].possiblyEvaluate(new $(X),p)]}A.layoutTextSize=w["text-size"].possiblyEvaluate(new $(e.zoom+1),p),A.layoutIconSize=w["icon-size"].possiblyEvaluate(new $(e.zoom+1),p),A.textMaxSize=w["text-size"].possiblyEvaluate(new $(18));for(var Ee=24*y.get("text-line-height"),Ie=y.get("text-rotation-alignment")==="map"&&y.get("symbol-placement")!=="point",Xe=y.get("text-keep-upright"),Be=y.get("text-size"),ut=function(){var Jt=Ht[It],mr=y.get("text-font").evaluate(Jt,{},p).join(","),Fr=Be.evaluate(Jt,{},p),tn=A.layoutTextSize.evaluate(Jt,{},p),kn=A.layoutIconSize.evaluate(Jt,{},p),yn={horizontal:{},vertical:void 0},On=Jt.text,xn=[0,0];if(On){var gi=On.toString(),Hn=24*y.get("text-letter-spacing").evaluate(Jt,{},p),In=function(Ri){for(var va=0,ca=Ri;va<ca.length;va+=1)if(Zi=ca[va].charCodeAt(0),Zr.Arabic(Zi)||Zr["Arabic Supplement"](Zi)||Zr["Arabic Extended-A"](Zi)||Zr["Arabic Presentation Forms-A"](Zi)||Zr["Arabic Presentation Forms-B"](Zi))return!1;var Zi;return!0}(gi)?Hn:0,Pi=y.get("text-anchor").evaluate(Jt,{},p),pi=y.get("text-variable-anchor");if(!pi){var Ui=y.get("text-radial-offset").evaluate(Jt,{},p);xn=Ui?Ou(Pi,[24*Ui,Ya]):y.get("text-offset").evaluate(Jt,{},p).map(function(Ri){return 24*Ri})}var Fn=Ie?"center":y.get("text-justify").evaluate(Jt,{},p),Ji=y.get("symbol-placement"),Ra=Ji==="point"?24*y.get("text-max-width").evaluate(Jt,{},p):0,Ka=function(){e.allowVerticalPlacement&&Ks(gi)&&(yn.vertical=nn(On,t,r,u,mr,Ra,Ee,Pi,"left",In,xn,Hr.vertical,!0,Ji,tn,Fr))};if(!Ie&&pi){for(var Za=Fn==="auto"?pi.map(function(Ri){return be(Ri)}):[Fn],Oa=!1,Ja=0;Ja<Za.length;Ja++){var Do=Za[Ja];if(!yn.horizontal[Do])if(Oa)yn.horizontal[Do]=yn.horizontal[0];else{var Ro=nn(On,t,r,u,mr,Ra,Ee,"center",Do,In,xn,Hr.horizontal,!1,Ji,tn,Fr);Ro&&(yn.horizontal[Do]=Ro,Oa=Ro.positionedLines.length===1)}}Ka()}else{Fn==="auto"&&(Fn=be(Pi));var ss=nn(On,t,r,u,mr,Ra,Ee,Pi,Fn,In,xn,Hr.horizontal,!1,Ji,tn,Fr);ss&&(yn.horizontal[Fn]=ss),Ka(),Ks(gi)&&Ie&&Xe&&(yn.vertical=nn(On,t,r,u,mr,Ra,Ee,Pi,Fn,In,xn,Hr.vertical,!1,Ji,tn,Fr))}}var Go=void 0,us=!1;if(Jt.icon&&Jt.icon.name){var io=s[Jt.icon.name];io&&(Go=function(Ri,va,ca){var Zi=an(ca),gs=va[0]-Ri.displaySize[0]*Zi.horizontalAlign,ts=va[1]-Ri.displaySize[1]*Zi.verticalAlign;return{image:Ri,top:ts,bottom:ts+Ri.displaySize[1],left:gs,right:gs+Ri.displaySize[0]}}(u[Jt.icon.name],y.get("icon-offset").evaluate(Jt,{},p),y.get("icon-anchor").evaluate(Jt,{},p)),us=io.sdf,e.sdfIcons===void 0?e.sdfIcons=io.sdf:e.sdfIcons!==io.sdf&&we("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(io.pixelRatio!==e.pixelRatio||y.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var jo=At(yn.horizontal)||yn.vertical;e.iconsInText=!!jo&&jo.iconsInText,(jo||Go)&&function(Ri,va,ca,Zi,gs,ts,ka,vo,rs,$i,El){var iu=ts.textMaxSize.evaluate(va,{});iu===void 0&&(iu=ka);var Sl,ao=Ri.layers[0].layout,Tl=ao.get("icon-offset").evaluate(va,{},El),zu=At(ca.horizontal),Hc=ka/24,kc=Ri.tilePixelRatio*Hc,Wc=Ri.tilePixelRatio*iu/24,ql=Ri.tilePixelRatio*vo,Xc=Ri.tilePixelRatio*ao.get("symbol-spacing"),Zh=ao.get("text-padding")*Ri.tilePixelRatio,Yc=ao.get("icon-padding")*Ri.tilePixelRatio,vh=ao.get("text-max-angle")/180*Math.PI,Hh=ao.get("text-rotation-alignment")==="map"&&ao.get("symbol-placement")!=="point",Wh=ao.get("icon-rotation-alignment")==="map"&&ao.get("symbol-placement")!=="point",Zl=ao.get("symbol-placement"),yh=Xc/2,Kc=ao.get("icon-text-fit");Zi&&Kc!=="none"&&(Ri.allowVerticalPlacement&&ca.vertical&&(Sl=Yn(Zi,ca.vertical,Kc,ao.get("icon-text-fit-padding"),Tl,Hc)),zu&&(Zi=Yn(Zi,zu,Kc,ao.get("icon-text-fit-padding"),Tl,Hc)));var fc=function(up,Th){Th.x<0||Th.x>=8192||Th.y<0||Th.y>=8192||function(oo,Ku,lp,pc,Tf,Nf,Qh,Al,ef,Ah,tf,rf,Af,Vf,Ch,Uf,Gf,jf,qf,Zf,au,nf,Hf,Cl,cp){var Wf,Mc,th,rh,nh,ih=oo.addToLineVertexArray(Ku,lp),Xf=0,Yf=0,Kf=0,Jf=0,Cf=-1,If=-1,Hl={},$f=_e(""),kf=0,Pf=0;if(Al._unevaluatedLayout.getValue("text-radial-offset")===void 0?(kf=(Wf=Al.layout.get("text-offset").evaluate(au,{},Cl).map(function(kh){return 24*kh}))[0],Pf=Wf[1]):(kf=24*Al.layout.get("text-radial-offset").evaluate(au,{},Cl),Pf=Ya),oo.allowVerticalPlacement&&pc.vertical){var Qf=Al.layout.get("text-rotate").evaluate(au,{},Cl)+90;rh=new mo(ef,Ku,Ah,tf,rf,pc.vertical,Af,Vf,Ch,Qf),Qh&&(nh=new mo(ef,Ku,Ah,tf,rf,Qh,Gf,jf,Ch,Qf))}if(Tf){var Mf=Al.layout.get("icon-rotate").evaluate(au,{}),ep=Al.layout.get("icon-text-fit")!=="none",tp=wo(Tf,Mf,Hf,ep),Lf=Qh?wo(Qh,Mf,Hf,ep):void 0;th=new mo(ef,Ku,Ah,tf,rf,Tf,Gf,jf,!1,Mf),Xf=4*tp.length;var rp=oo.iconSizeData,Ih=null;rp.kind==="source"?(Ih=[128*Al.layout.get("icon-size").evaluate(au,{})])[0]>32640&&we(oo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):rp.kind==="composite"&&((Ih=[128*nf.compositeIconSizes[0].evaluate(au,{},Cl),128*nf.compositeIconSizes[1].evaluate(au,{},Cl)])[0]>32640||Ih[1]>32640)&&we(oo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),oo.addSymbols(oo.icon,tp,Ih,Zf,qf,au,!1,Ku,ih.lineStartIndex,ih.lineLength,-1,Cl),Cf=oo.icon.placedSymbolArray.length-1,Lf&&(Yf=4*Lf.length,oo.addSymbols(oo.icon,Lf,Ih,Zf,qf,au,Hr.vertical,Ku,ih.lineStartIndex,ih.lineLength,-1,Cl),If=oo.icon.placedSymbolArray.length-1)}for(var np in pc.horizontal){var af=pc.horizontal[np];if(!Mc){$f=_e(af.text);var hp=Al.layout.get("text-rotate").evaluate(au,{},Cl);Mc=new mo(ef,Ku,Ah,tf,rf,af,Af,Vf,Ch,hp)}var ip=af.positionedLines.length===1;if(Kf+=qt(oo,Ku,af,Nf,Al,Ch,au,Uf,ih,pc.vertical?Hr.horizontal:Hr.horizontalOnly,ip?Object.keys(pc.horizontal):[np],Hl,Cf,nf,Cl),ip)break}pc.vertical&&(Jf+=qt(oo,Ku,pc.vertical,Nf,Al,Ch,au,Uf,ih,Hr.vertical,["vertical"],Hl,If,nf,Cl));var fp=Mc?Mc.boxStartIndex:oo.collisionBoxArray.length,pp=Mc?Mc.boxEndIndex:oo.collisionBoxArray.length,dp=rh?rh.boxStartIndex:oo.collisionBoxArray.length,mp=rh?rh.boxEndIndex:oo.collisionBoxArray.length,vp=th?th.boxStartIndex:oo.collisionBoxArray.length,yp=th?th.boxEndIndex:oo.collisionBoxArray.length,gp=nh?nh.boxStartIndex:oo.collisionBoxArray.length,_p=nh?nh.boxEndIndex:oo.collisionBoxArray.length,Il=-1,of=function(kh,op){return kh&&kh.circleDiameter?Math.max(kh.circleDiameter,op):op};Il=of(Mc,Il),Il=of(rh,Il),Il=of(th,Il);var ap=(Il=of(nh,Il))>-1?1:0;ap&&(Il*=cp/24),oo.glyphOffsetArray.length>=Re.MAX_GLYPHS&&we("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),au.sortKey!==void 0&&oo.addToSortKeyRanges(oo.symbolInstances.length,au.sortKey),oo.symbolInstances.emplaceBack(Ku.x,Ku.y,Hl.right>=0?Hl.right:-1,Hl.center>=0?Hl.center:-1,Hl.left>=0?Hl.left:-1,Hl.vertical||-1,Cf,If,$f,fp,pp,dp,mp,vp,yp,gp,_p,Ah,Kf,Jf,Xf,Yf,ap,0,Af,kf,Pf,Il)}(Ri,Th,up,ca,Zi,gs,Sl,Ri.layers[0],Ri.collisionBoxArray,va.index,va.sourceLayerIndex,Ri.index,kc,Zh,Hh,rs,ql,Yc,Wh,Tl,va,ts,$i,El,ka)};if(Zl==="line")for(var Jc=0,Xh=Xa(va.geometry,0,0,8192,8192);Jc<Xh.length;Jc+=1)for(var Yh=Xh[Jc],gh=0,_h=bo(Yh,Xc,vh,ca.vertical||zu,Zi,24,Wc,Ri.overscaling,8192);gh<_h.length;gh+=1){var Kh=_h[gh];zu&&gn(Ri,zu.text,yh,Kh)||fc(Yh,Kh)}else if(Zl==="line-center")for(var xh=0,bh=va.geometry;xh<bh.length;xh+=1){var wh=bh[xh];if(wh.length>1){var Jh=Aa(wh,vh,ca.vertical||zu,Zi,24,Wc);Jh&&fc(wh,Jh)}}else if(va.type==="Polygon")for(var $c=0,$h=bc(va.geometry,0);$c<$h.length;$c+=1){var Qc=$h[$c],Eh=Zn(Qc,16);fc(Qc[0],new en(Eh.x,Eh.y,0))}else if(va.type==="LineString")for(var Pc=0,Sh=va.geometry;Pc<Sh.length;Pc+=1){var eh=Sh[Pc];fc(eh,new en(eh[0].x,eh[0].y,0))}else if(va.type==="Point")for(var wf=0,zf=va.geometry;wf<zf.length;wf+=1)for(var Ef=0,Bf=zf[wf];Ef<Bf.length;Ef+=1){var Sf=Bf[Ef];fc([Sf],new en(Sf.x,Sf.y,0))}}(e,Jt,yn,Go,s,A,tn,kn,xn,us,p)},It=0,Ht=e.features;It<Ht.length;It+=1)ut();h&&e.generateCollisionDebugBuffers()},l.perspective=function(e,t,r,s,u){var h,p=1/Math.tan(t/2);return e[0]=p/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=p,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,u!=null&&u!==1/0?(e[10]=(u+s)*(h=1/(s-u)),e[14]=2*u*s*h):(e[10]=-1,e[14]=-2*s),e},l.pick=function(e,t){for(var r={},s=0;s<t.length;s++){var u=t[s];u in e&&(r[u]=e[u])}return r},l.plugin=I,l.polygonIntersectsPolygon=tu,l.postMapLoadEvent=te,l.postTurnstileEvent=Ye,l.potpack=Mr,l.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],l.register=dn,l.registerForPluginStateChange=function(e){return e({pluginStatus:lo,pluginURL:fs}),hl.on("pluginStateChange",e),e},l.renderColorRamp=vc,l.rotate=function(e,t,r){var s=t[0],u=t[1],h=t[2],p=t[3],y=Math.sin(r),w=Math.cos(r);return e[0]=s*w+h*y,e[1]=u*w+p*y,e[2]=s*-y+h*w,e[3]=u*-y+p*w,e},l.rotateX=function(e,t,r){var s=Math.sin(r),u=Math.cos(r),h=t[4],p=t[5],y=t[6],w=t[7],A=t[8],M=t[9],O=t[10],Z=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=h*u+A*s,e[5]=p*u+M*s,e[6]=y*u+O*s,e[7]=w*u+Z*s,e[8]=A*u-h*s,e[9]=M*u-p*s,e[10]=O*u-y*s,e[11]=Z*u-w*s,e},l.rotateZ=function(e,t,r){var s=Math.sin(r),u=Math.cos(r),h=t[0],p=t[1],y=t[2],w=t[3],A=t[4],M=t[5],O=t[6],Z=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=h*u+A*s,e[1]=p*u+M*s,e[2]=y*u+O*s,e[3]=w*u+Z*s,e[4]=A*u-h*s,e[5]=M*u-p*s,e[6]=O*u-y*s,e[7]=Z*u-w*s,e},l.scale=function(e,t,r){var s=r[0],u=r[1],h=r[2];return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*u,e[5]=t[5]*u,e[6]=t[6]*u,e[7]=t[7]*u,e[8]=t[8]*h,e[9]=t[9]*h,e[10]=t[10]*h,e[11]=t[11]*h,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},l.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},l.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},l.setCacheLimits=function(e,t){he=e,ve=t},l.setRTLTextPlugin=function(e,t,r){if(r===void 0&&(r=!1),lo==="deferred"||lo==="loading"||lo==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");fs=He.resolveURL(e),lo="deferred",Cs=t,ju(),r||g()},l.sphericalToCartesian=function(e){var t=e[0],r=e[1],s=e[2];return r+=90,r*=Math.PI/180,s*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(s),y:t*Math.sin(r)*Math.sin(s),z:t*Math.cos(s)}},l.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},l.styleSpec=J,l.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},l.symbolSize=Ii,l.transformMat3=function(e,t,r){var s=t[0],u=t[1],h=t[2];return e[0]=s*r[0]+u*r[3]+h*r[6],e[1]=s*r[1]+u*r[4]+h*r[7],e[2]=s*r[2]+u*r[5]+h*r[8],e},l.transformMat4=zl,l.translate=function(e,t,r){var s,u,h,p,y,w,A,M,O,Z,X,Ee,Ie=r[0],Xe=r[1],Be=r[2];return t===e?(e[12]=t[0]*Ie+t[4]*Xe+t[8]*Be+t[12],e[13]=t[1]*Ie+t[5]*Xe+t[9]*Be+t[13],e[14]=t[2]*Ie+t[6]*Xe+t[10]*Be+t[14],e[15]=t[3]*Ie+t[7]*Xe+t[11]*Be+t[15]):(u=t[1],h=t[2],p=t[3],y=t[4],w=t[5],A=t[6],M=t[7],O=t[8],Z=t[9],X=t[10],Ee=t[11],e[0]=s=t[0],e[1]=u,e[2]=h,e[3]=p,e[4]=y,e[5]=w,e[6]=A,e[7]=M,e[8]=O,e[9]=Z,e[10]=X,e[11]=Ee,e[12]=s*Ie+y*Xe+O*Be+t[12],e[13]=u*Ie+w*Xe+Z*Be+t[13],e[14]=h*Ie+A*Xe+X*Be+t[14],e[15]=p*Ie+M*Xe+Ee*Be+t[15]),e},l.triggerPluginCompletionEvent=$l,l.uniqueId=Et,l.validateCustomStyleLayer=function(e){var t=[],r=e.id;return r===void 0&&t.push({message:"layers."+r+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},l.validateLight=dc,l.validateStyle=Pu,l.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},l.vectorTile=Bs,l.version="1.13.2",l.warnOnce=we,l.webpSupported=xt,l.window=Fe,l.wrap=Er}),Ze(["./shared"],function(l){"use strict";function Vt(L){var N=typeof L;if(N==="number"||N==="boolean"||N==="string"||L==null)return JSON.stringify(L);if(Array.isArray(L)){for(var H="[",ne=0,xe=L;ne<xe.length;ne+=1)H+=Vt(xe[ne])+",";return H+"]"}for(var Ne=Object.keys(L).sort(),Qe="{",J=0;J<Ne.length;J++)Qe+=JSON.stringify(Ne[J])+":"+Vt(L[Ne[J]])+",";return Qe+"}"}function ge(L){for(var N="",H=0,ne=l.refProperties;H<ne.length;H+=1)N+="/"+Vt(L[ne[H]]);return N}var Mt=function(L){this.keyCache={},L&&this.replace(L)};Mt.prototype.replace=function(L){this._layerConfigs={},this._layers={},this.update(L,[])},Mt.prototype.update=function(L,N){for(var H=this,ne=0,xe=L;ne<xe.length;ne+=1){var Ne=xe[ne];this._layerConfigs[Ne.id]=Ne;var Qe=this._layers[Ne.id]=l.createStyleLayer(Ne);Qe._featureFilter=l.featureFilter(Qe.filter),this.keyCache[Ne.id]&&delete this.keyCache[Ne.id]}for(var J=0,Me=N;J<Me.length;J+=1){var bt=Me[J];delete this.keyCache[bt],delete this._layerConfigs[bt],delete this._layers[bt]}this.familiesBySource={};for(var gr=0,zt=function(qr,Yr){for(var $n={},$r=0;$r<qr.length;$r++){var hi=Yr&&Yr[qr[$r].id]||ge(qr[$r]);Yr&&(Yr[qr[$r].id]=hi);var Oi=$n[hi];Oi||(Oi=$n[hi]=[]),Oi.push(qr[$r])}var Qn=[];for(var fi in $n)Qn.push($n[fi]);return Qn}(l.values(this._layerConfigs),this.keyCache);gr<zt.length;gr+=1){var Nt=zt[gr].map(function(qr){return H._layers[qr.id]}),br=Nt[0];if(br.visibility!=="none"){var vn=br.source||"",cn=this.familiesBySource[vn];cn||(cn=this.familiesBySource[vn]={});var Lt=br.sourceLayer||"_geojsonTileLayer",on=cn[Lt];on||(on=cn[Lt]=[]),on.push(Nt)}}};var Le=function(L){var N={},H=[];for(var ne in L){var xe=L[ne],Ne=N[ne]={};for(var Qe in xe){var J=xe[+Qe];if(J&&J.bitmap.width!==0&&J.bitmap.height!==0){var Me={x:0,y:0,w:J.bitmap.width+2,h:J.bitmap.height+2};H.push(Me),Ne[Qe]={rect:Me,metrics:J.metrics}}}}var bt=l.potpack(H),gr=new l.AlphaImage({width:bt.w||1,height:bt.h||1});for(var zt in L){var Nt=L[zt];for(var br in Nt){var vn=Nt[+br];if(vn&&vn.bitmap.width!==0&&vn.bitmap.height!==0){var cn=N[zt][br].rect;l.AlphaImage.copy(vn.bitmap,gr,{x:0,y:0},{x:cn.x+1,y:cn.y+1},vn.bitmap)}}}this.image=gr,this.positions=N};l.register("GlyphAtlas",Le);var Tt=function(L){this.tileID=new l.OverscaledTileID(L.tileID.overscaledZ,L.tileID.wrap,L.tileID.canonical.z,L.tileID.canonical.x,L.tileID.canonical.y),this.uid=L.uid,this.zoom=L.zoom,this.pixelRatio=L.pixelRatio,this.tileSize=L.tileSize,this.source=L.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=L.showCollisionBoxes,this.collectResourceTiming=!!L.collectResourceTiming,this.returnDependencies=!!L.returnDependencies,this.promoteId=L.promoteId};function Fe(L,N,H){for(var ne=new l.EvaluationParameters(N),xe=0,Ne=L;xe<Ne.length;xe+=1)Ne[xe].recalculate(ne,H)}function dt(L,N){var H=l.getArrayBuffer(L.request,function(ne,xe,Ne,Qe){ne?N(ne):xe&&N(null,{vectorTile:new l.vectorTile.VectorTile(new l.pbf(xe)),rawData:xe,cacheControl:Ne,expires:Qe})});return function(){H.cancel(),N()}}Tt.prototype.parse=function(L,N,H,ne,xe){var Ne=this;this.status="parsing",this.data=L,this.collisionBoxArray=new l.CollisionBoxArray;var Qe=new l.DictionaryCoder(Object.keys(L.layers).sort()),J=new l.FeatureIndex(this.tileID,this.promoteId);J.bucketLayerIDs=[];var Me,bt,gr,zt,Nt={},br={featureIndex:J,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:H},vn=N.familiesBySource[this.source];for(var cn in vn){var Lt=L.layers[cn];if(Lt){Lt.version===1&&l.warnOnce('Vector tile source "'+this.source+'" layer "'+cn+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var on=Qe.encode(cn),qr=[],Yr=0;Yr<Lt.length;Yr++){var $n=Lt.feature(Yr),$r=J.getId($n,cn);qr.push({feature:$n,id:$r,index:Yr,sourceLayerIndex:on})}for(var hi=0,Oi=vn[cn];hi<Oi.length;hi+=1){var Qn=Oi[hi],fi=Qn[0];fi.minzoom&&this.zoom<Math.floor(fi.minzoom)||fi.maxzoom&&this.zoom>=fi.maxzoom||fi.visibility!=="none"&&(Fe(Qn,this.zoom,H),(Nt[fi.id]=fi.createBucket({index:J.bucketLayerIDs.length,layers:Qn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:on,sourceID:this.source})).populate(qr,br,this.tileID.canonical),J.bucketLayerIDs.push(Qn.map(function(_i){return _i.id})))}}}var ei=l.mapObject(br.glyphDependencies,function(_i){return Object.keys(_i).map(Number)});Object.keys(ei).length?ne.send("getGlyphs",{uid:this.uid,stacks:ei},function(_i,di){Me||(Me=_i,bt=di,Qi.call(Ne))}):bt={};var zn=Object.keys(br.iconDependencies);zn.length?ne.send("getImages",{icons:zn,source:this.source,tileID:this.tileID,type:"icons"},function(_i,di){Me||(Me=_i,gr=di,Qi.call(Ne))}):gr={};var Wn=Object.keys(br.patternDependencies);function Qi(){if(Me)return xe(Me);if(bt&&gr&&zt){var _i=new Le(bt),di=new l.ImageAtlas(gr,zt);for(var vi in Nt){var oa=Nt[vi];oa instanceof l.SymbolBucket?(Fe(oa.layers,this.zoom,H),l.performSymbolLayout(oa,bt,_i.positions,gr,di.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):oa.hasPattern&&(oa instanceof l.LineBucket||oa instanceof l.FillBucket||oa instanceof l.FillExtrusionBucket)&&(Fe(oa.layers,this.zoom,H),oa.addFeatures(br,this.tileID.canonical,di.patternPositions))}this.status="done",xe(null,{buckets:l.values(Nt).filter(function(ns){return!ns.isEmpty()}),featureIndex:J,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:_i.image,imageAtlas:di,glyphMap:this.returnDependencies?bt:null,iconMap:this.returnDependencies?gr:null,glyphPositions:this.returnDependencies?_i.positions:null})}}Wn.length?ne.send("getImages",{icons:Wn,source:this.source,tileID:this.tileID,type:"patterns"},function(_i,di){Me||(Me=_i,zt=di,Qi.call(Ne))}):zt={},Qi.call(this)};var nr=function(L,N,H,ne){this.actor=L,this.layerIndex=N,this.availableImages=H,this.loadVectorData=ne||dt,this.loading={},this.loaded={}};nr.prototype.loadTile=function(L,N){var H=this,ne=L.uid;this.loading||(this.loading={});var xe=!!(L&&L.request&&L.request.collectResourceTiming)&&new l.RequestPerformance(L.request),Ne=this.loading[ne]=new Tt(L);Ne.abort=this.loadVectorData(L,function(Qe,J){if(delete H.loading[ne],Qe||!J)return Ne.status="done",H.loaded[ne]=Ne,N(Qe);var Me=J.rawData,bt={};J.expires&&(bt.expires=J.expires),J.cacheControl&&(bt.cacheControl=J.cacheControl);var gr={};if(xe){var zt=xe.finish();zt&&(gr.resourceTiming=JSON.parse(JSON.stringify(zt)))}Ne.vectorTile=J.vectorTile,Ne.parse(J.vectorTile,H.layerIndex,H.availableImages,H.actor,function(Nt,br){if(Nt||!br)return N(Nt);N(null,l.extend({rawTileData:Me.slice(0)},br,bt,gr))}),H.loaded=H.loaded||{},H.loaded[ne]=Ne})},nr.prototype.reloadTile=function(L,N){var H=this,ne=this.loaded,xe=L.uid,Ne=this;if(ne&&ne[xe]){var Qe=ne[xe];Qe.showCollisionBoxes=L.showCollisionBoxes;var J=function(Me,bt){var gr=Qe.reloadCallback;gr&&(delete Qe.reloadCallback,Qe.parse(Qe.vectorTile,Ne.layerIndex,H.availableImages,Ne.actor,gr)),N(Me,bt)};Qe.status==="parsing"?Qe.reloadCallback=J:Qe.status==="done"&&(Qe.vectorTile?Qe.parse(Qe.vectorTile,this.layerIndex,this.availableImages,this.actor,J):J())}},nr.prototype.abortTile=function(L,N){var H=this.loading,ne=L.uid;H&&H[ne]&&H[ne].abort&&(H[ne].abort(),delete H[ne]),N()},nr.prototype.removeTile=function(L,N){var H=this.loaded,ne=L.uid;H&&H[ne]&&delete H[ne],N()};var dr=l.window.ImageBitmap,Dt=function(){this.loaded={}};function Er(L,N){if(L.length!==0){wt(L[0],N);for(var H=1;H<L.length;H++)wt(L[H],!N)}}function wt(L,N){for(var H=0,ne=0,xe=L.length,Ne=xe-1;ne<xe;Ne=ne++)H+=(L[ne][0]-L[Ne][0])*(L[Ne][1]+L[ne][1]);H>=0!=!!N&&L.reverse()}Dt.prototype.loadTile=function(L,N){var H=L.uid,ne=L.encoding,xe=L.rawImageData,Ne=dr&&xe instanceof dr?this.getImageData(xe):xe,Qe=new l.DEMData(H,Ne,ne);this.loaded=this.loaded||{},this.loaded[H]=Qe,N(null,Qe)},Dt.prototype.getImageData=function(L){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(L.width,L.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=L.width,this.offscreenCanvas.height=L.height,this.offscreenCanvasContext.drawImage(L,0,0,L.width,L.height);var N=this.offscreenCanvasContext.getImageData(-1,-1,L.width+2,L.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new l.RGBAImage({width:N.width,height:N.height},N.data)},Dt.prototype.removeTile=function(L){var N=this.loaded,H=L.uid;N&&N[H]&&delete N[H]};var fr=l.vectorTile.VectorTileFeature.prototype.toGeoJSON,Et=function(L){this._feature=L,this.extent=l.EXTENT,this.type=L.type,this.properties=L.tags,"id"in L&&!isNaN(L.id)&&(this.id=parseInt(L.id,10))};Et.prototype.loadGeometry=function(){if(this._feature.type===1){for(var L=[],N=0,H=this._feature.geometry;N<H.length;N+=1){var ne=H[N];L.push([new l.Point$1(ne[0],ne[1])])}return L}for(var xe=[],Ne=0,Qe=this._feature.geometry;Ne<Qe.length;Ne+=1){for(var J=[],Me=0,bt=Qe[Ne];Me<bt.length;Me+=1){var gr=bt[Me];J.push(new l.Point$1(gr[0],gr[1]))}xe.push(J)}return xe},Et.prototype.toGeoJSON=function(L,N,H){return fr.call(this,L,N,H)};var vr=function(L){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=L.length,this._features=L};vr.prototype.feature=function(L){return new Et(this._features[L])};var kt=l.vectorTile.VectorTileFeature,mt=k;function k(L,N){this.options=N||{},this.features=L,this.length=L.length}function Te(L,N){this.id=typeof L.id=="number"?L.id:void 0,this.type=L.type,this.rawGeometry=L.type===1?[L.geometry]:L.geometry,this.properties=L.tags,this.extent=N||4096}k.prototype.feature=function(L){return new Te(this.features[L],this.options.extent)},Te.prototype.loadGeometry=function(){var L=this.rawGeometry;this.geometry=[];for(var N=0;N<L.length;N++){for(var H=L[N],ne=[],xe=0;xe<H.length;xe++)ne.push(new l.Point$1(H[xe][0],H[xe][1]));this.geometry.push(ne)}return this.geometry},Te.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var L=this.geometry,N=1/0,H=-1/0,ne=1/0,xe=-1/0,Ne=0;Ne<L.length;Ne++)for(var Qe=L[Ne],J=0;J<Qe.length;J++){var Me=Qe[J];N=Math.min(N,Me.x),H=Math.max(H,Me.x),ne=Math.min(ne,Me.y),xe=Math.max(xe,Me.y)}return[N,ne,H,xe]},Te.prototype.toGeoJSON=kt.prototype.toGeoJSON;var Se=De,me=mt;function De(L){var N=new l.pbf;return function(H,ne){for(var xe in H.layers)ne.writeMessage(3,we,H.layers[xe])}(L,N),N.finish()}function we(L,N){var H;N.writeVarintField(15,L.version||1),N.writeStringField(1,L.name||""),N.writeVarintField(5,L.extent||4096);var ne={keys:[],values:[],keycache:{},valuecache:{}};for(H=0;H<L.length;H++)ne.feature=L.feature(H),N.writeMessage(2,ze,ne);var xe=ne.keys;for(H=0;H<xe.length;H++)N.writeStringField(3,xe[H]);var Ne=ne.values;for(H=0;H<Ne.length;H++)N.writeMessage(4,U,Ne[H])}function ze(L,N){var H=L.feature;H.id!==void 0&&N.writeVarintField(1,H.id),N.writeMessage(2,Qt,L),N.writeVarintField(3,H.type),N.writeMessage(4,P,H)}function Qt(L,N){var H=L.feature,ne=L.keys,xe=L.values,Ne=L.keycache,Qe=L.valuecache;for(var J in H.properties){var Me=Ne[J];Me===void 0&&(ne.push(J),Ne[J]=Me=ne.length-1),N.writeVarint(Me);var bt=H.properties[J],gr=typeof bt;gr!=="string"&&gr!=="boolean"&&gr!=="number"&&(bt=JSON.stringify(bt));var zt=gr+":"+bt,Nt=Qe[zt];Nt===void 0&&(xe.push(bt),Qe[zt]=Nt=xe.length-1),N.writeVarint(Nt)}}function V(L,N){return(N<<3)+(7&L)}function pe(L){return L<<1^L>>31}function P(L,N){for(var H=L.loadGeometry(),ne=L.type,xe=0,Ne=0,Qe=H.length,J=0;J<Qe;J++){var Me=H[J],bt=1;ne===1&&(bt=Me.length),N.writeVarint(V(1,bt));for(var gr=ne===3?Me.length-1:Me.length,zt=0;zt<gr;zt++){zt===1&&ne!==1&&N.writeVarint(V(2,gr-1));var Nt=Me[zt].x-xe,br=Me[zt].y-Ne;N.writeVarint(pe(Nt)),N.writeVarint(pe(br)),xe+=Nt,Ne+=br}ne===3&&N.writeVarint(V(7,1))}}function U(L,N){var H=typeof L;H==="string"?N.writeStringField(1,L):H==="boolean"?N.writeBooleanField(7,L):H==="number"&&(L%1!=0?N.writeDoubleField(3,L):L<0?N.writeSVarintField(6,L):N.writeVarintField(5,L))}function B(L,N,H,ne){E(L,H,ne),E(N,2*H,2*ne),E(N,2*H+1,2*ne+1)}function E(L,N,H){var ne=L[N];L[N]=L[H],L[H]=ne}function D(L,N,H,ne){var xe=L-H,Ne=N-ne;return xe*xe+Ne*Ne}Se.fromVectorTileJs=De,Se.fromGeojsonVt=function(L,N){N=N||{};var H={};for(var ne in L)H[ne]=new mt(L[ne].features,N),H[ne].name=ne,H[ne].version=N.version,H[ne].extent=N.extent;return De({layers:H})},Se.GeoJSONWrapper=me;var q=function(L){return L[0]},Q=function(L){return L[1]},Ae=function(L,N,H,ne,xe){N===void 0&&(N=q),H===void 0&&(H=Q),ne===void 0&&(ne=64),xe===void 0&&(xe=Float64Array),this.nodeSize=ne,this.points=L;for(var Ne=L.length<65536?Uint16Array:Uint32Array,Qe=this.ids=new Ne(L.length),J=this.coords=new xe(2*L.length),Me=0;Me<L.length;Me++)Qe[Me]=Me,J[2*Me]=N(L[Me]),J[2*Me+1]=H(L[Me]);(function bt(gr,zt,Nt,br,vn,cn){if(!(vn-br<=Nt)){var Lt=br+vn>>1;(function on(qr,Yr,$n,$r,hi,Oi){for(;hi>$r;){if(hi-$r>600){var Qn=hi-$r+1,fi=$n-$r+1,ei=Math.log(Qn),zn=.5*Math.exp(2*ei/3),Wn=.5*Math.sqrt(ei*zn*(Qn-zn)/Qn)*(fi-Qn/2<0?-1:1);on(qr,Yr,$n,Math.max($r,Math.floor($n-fi*zn/Qn+Wn)),Math.min(hi,Math.floor($n+(Qn-fi)*zn/Qn+Wn)),Oi)}var Qi=Yr[2*$n+Oi],_i=$r,di=hi;for(B(qr,Yr,$r,$n),Yr[2*hi+Oi]>Qi&&B(qr,Yr,$r,hi);_i<di;){for(B(qr,Yr,_i,di),_i++,di--;Yr[2*_i+Oi]<Qi;)_i++;for(;Yr[2*di+Oi]>Qi;)di--}Yr[2*$r+Oi]===Qi?B(qr,Yr,$r,di):B(qr,Yr,++di,hi),di<=$n&&($r=di+1),$n<=di&&(hi=di-1)}})(gr,zt,Lt,br,vn,cn%2),bt(gr,zt,Nt,br,Lt-1,cn+1),bt(gr,zt,Nt,Lt+1,vn,cn+1)}})(Qe,J,ne,0,Qe.length-1,0)};Ae.prototype.range=function(L,N,H,ne){return function(xe,Ne,Qe,J,Me,bt,gr){for(var zt,Nt,br=[0,xe.length-1,0],vn=[];br.length;){var cn=br.pop(),Lt=br.pop(),on=br.pop();if(Lt-on<=gr)for(var qr=on;qr<=Lt;qr++)Nt=Ne[2*qr+1],(zt=Ne[2*qr])>=Qe&&zt<=Me&&Nt>=J&&Nt<=bt&&vn.push(xe[qr]);else{var Yr=Math.floor((on+Lt)/2);Nt=Ne[2*Yr+1],(zt=Ne[2*Yr])>=Qe&&zt<=Me&&Nt>=J&&Nt<=bt&&vn.push(xe[Yr]);var $n=(cn+1)%2;(cn===0?Qe<=zt:J<=Nt)&&(br.push(on),br.push(Yr-1),br.push($n)),(cn===0?Me>=zt:bt>=Nt)&&(br.push(Yr+1),br.push(Lt),br.push($n))}}return vn}(this.ids,this.coords,L,N,H,ne,this.nodeSize)},Ae.prototype.within=function(L,N,H){return function(ne,xe,Ne,Qe,J,Me){for(var bt=[0,ne.length-1,0],gr=[],zt=J*J;bt.length;){var Nt=bt.pop(),br=bt.pop(),vn=bt.pop();if(br-vn<=Me)for(var cn=vn;cn<=br;cn++)D(xe[2*cn],xe[2*cn+1],Ne,Qe)<=zt&&gr.push(ne[cn]);else{var Lt=Math.floor((vn+br)/2),on=xe[2*Lt],qr=xe[2*Lt+1];D(on,qr,Ne,Qe)<=zt&&gr.push(ne[Lt]);var Yr=(Nt+1)%2;(Nt===0?Ne-J<=on:Qe-J<=qr)&&(bt.push(vn),bt.push(Lt-1),bt.push(Yr)),(Nt===0?Ne+J>=on:Qe+J>=qr)&&(bt.push(Lt+1),bt.push(br),bt.push(Yr))}}return gr}(this.ids,this.coords,L,N,H,this.nodeSize)};var ct={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(L){return L}},ke=function(L){this.options=Ar(Object.create(ct),L),this.trees=new Array(this.options.maxZoom+1)};function He(L,N,H,ne,xe){return{x:L,y:N,zoom:1/0,id:H,parentId:-1,numPoints:ne,properties:xe}}function We(L,N){var H=L.geometry.coordinates,ne=H[1];return{x:Gt(H[0]),y:Rt(ne),zoom:1/0,index:N,parentId:-1}}function xt(L){return{type:"Feature",id:L.id,properties:jt(L),geometry:{type:"Point",coordinates:[(ne=L.x,360*(ne-.5)),(N=L.y,H=(180-360*N)*Math.PI/180,360*Math.atan(Math.exp(H))/Math.PI-90)]}};var N,H,ne}function jt(L){var N=L.numPoints,H=N>=1e4?Math.round(N/1e3)+"k":N>=1e3?Math.round(N/100)/10+"k":N;return Ar(Ar({},L.properties),{cluster:!0,cluster_id:L.id,point_count:N,point_count_abbreviated:H})}function Gt(L){return L/360+.5}function Rt(L){var N=Math.sin(L*Math.PI/180),H=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return H<0?0:H>1?1:H}function Ar(L,N){for(var H in N)L[H]=N[H];return L}function Gr(L){return L.x}function er(L){return L.y}function $e(L,N,H,ne,xe,Ne){var Qe=xe-H,J=Ne-ne;if(Qe!==0||J!==0){var Me=((L-H)*Qe+(N-ne)*J)/(Qe*Qe+J*J);Me>1?(H=xe,ne=Ne):Me>0&&(H+=Qe*Me,ne+=J*Me)}return(Qe=L-H)*Qe+(J=N-ne)*J}function rt(L,N,H,ne){var xe={id:L===void 0?null:L,type:N,geometry:H,tags:ne,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ne){var Qe=Ne.geometry,J=Ne.type;if(J==="Point"||J==="MultiPoint"||J==="LineString")Wt(Ne,Qe);else if(J==="Polygon"||J==="MultiLineString")for(var Me=0;Me<Qe.length;Me++)Wt(Ne,Qe[Me]);else if(J==="MultiPolygon")for(Me=0;Me<Qe.length;Me++)for(var bt=0;bt<Qe[Me].length;bt++)Wt(Ne,Qe[Me][bt])}(xe),xe}function Wt(L,N){for(var H=0;H<N.length;H+=3)L.minX=Math.min(L.minX,N[H]),L.minY=Math.min(L.minY,N[H+1]),L.maxX=Math.max(L.maxX,N[H]),L.maxY=Math.max(L.maxY,N[H+1])}function Kt(L,N,H,ne){if(N.geometry){var xe=N.geometry.coordinates,Ne=N.geometry.type,Qe=Math.pow(H.tolerance/((1<<H.maxZoom)*H.extent),2),J=[],Me=N.id;if(H.promoteId?Me=N.properties[H.promoteId]:H.generateId&&(Me=ne||0),Ne==="Point")ur(xe,J);else if(Ne==="MultiPoint")for(var bt=0;bt<xe.length;bt++)ur(xe[bt],J);else if(Ne==="LineString")ae(xe,J,Qe,!1);else if(Ne==="MultiLineString"){if(H.lineMetrics){for(bt=0;bt<xe.length;bt++)ae(xe[bt],J=[],Qe,!1),L.push(rt(Me,"LineString",J,N.properties));return}z(xe,J,Qe,!1)}else if(Ne==="Polygon")z(xe,J,Qe,!0);else{if(Ne!=="MultiPolygon"){if(Ne==="GeometryCollection"){for(bt=0;bt<N.geometry.geometries.length;bt++)Kt(L,{id:Me,geometry:N.geometry.geometries[bt],properties:N.properties},H,ne);return}throw new Error("Input data is not a valid GeoJSON object.")}for(bt=0;bt<xe.length;bt++){var gr=[];z(xe[bt],gr,Qe,!0),J.push(gr)}}L.push(rt(Me,Ne,J,N.properties))}}function ur(L,N){N.push(R(L[0])),N.push(j(L[1])),N.push(0)}function ae(L,N,H,ne){for(var xe,Ne,Qe=0,J=0;J<L.length;J++){var Me=R(L[J][0]),bt=j(L[J][1]);N.push(Me),N.push(bt),N.push(0),J>0&&(Qe+=ne?(xe*bt-Me*Ne)/2:Math.sqrt(Math.pow(Me-xe,2)+Math.pow(bt-Ne,2))),xe=Me,Ne=bt}var gr=N.length-3;N[2]=1,function zt(Nt,br,vn,cn){for(var Lt,on=cn,qr=vn-br>>1,Yr=vn-br,$n=Nt[br],$r=Nt[br+1],hi=Nt[vn],Oi=Nt[vn+1],Qn=br+3;Qn<vn;Qn+=3){var fi=$e(Nt[Qn],Nt[Qn+1],$n,$r,hi,Oi);if(fi>on)Lt=Qn,on=fi;else if(fi===on){var ei=Math.abs(Qn-qr);ei<Yr&&(Lt=Qn,Yr=ei)}}on>cn&&(Lt-br>3&&zt(Nt,br,Lt,cn),Nt[Lt+2]=on,vn-Lt>3&&zt(Nt,Lt,vn,cn))}(N,0,gr,H),N[gr+2]=1,N.size=Math.abs(Qe),N.start=0,N.end=N.size}function z(L,N,H,ne){for(var xe=0;xe<L.length;xe++){var Ne=[];ae(L[xe],Ne,H,ne),N.push(Ne)}}function R(L){return L/360+.5}function j(L){var N=Math.sin(L*Math.PI/180),H=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return H<0?0:H>1?1:H}function b(L,N,H,ne,xe,Ne,Qe,J){if(ne/=N,Ne>=(H/=N)&&Qe<ne)return L;if(Qe<H||Ne>=ne)return null;for(var Me=[],bt=0;bt<L.length;bt++){var gr=L[bt],zt=gr.geometry,Nt=gr.type,br=xe===0?gr.minX:gr.minY,vn=xe===0?gr.maxX:gr.maxY;if(br>=H&&vn<ne)Me.push(gr);else if(!(vn<H||br>=ne)){var cn=[];if(Nt==="Point"||Nt==="MultiPoint")ce(zt,cn,H,ne,xe);else if(Nt==="LineString")Ye(zt,cn,H,ne,xe,!1,J.lineMetrics);else if(Nt==="MultiLineString")te(zt,cn,H,ne,xe,!1);else if(Nt==="Polygon")te(zt,cn,H,ne,xe,!0);else if(Nt==="MultiPolygon")for(var Lt=0;Lt<zt.length;Lt++){var on=[];te(zt[Lt],on,H,ne,xe,!0),on.length&&cn.push(on)}if(cn.length){if(J.lineMetrics&&Nt==="LineString"){for(Lt=0;Lt<cn.length;Lt++)Me.push(rt(gr.id,Nt,cn[Lt],gr.tags));continue}Nt!=="LineString"&&Nt!=="MultiLineString"||(cn.length===1?(Nt="LineString",cn=cn[0]):Nt="MultiLineString"),Nt!=="Point"&&Nt!=="MultiPoint"||(Nt=cn.length===3?"Point":"MultiPoint"),Me.push(rt(gr.id,Nt,cn,gr.tags))}}}return Me.length?Me:null}function ce(L,N,H,ne,xe){for(var Ne=0;Ne<L.length;Ne+=3){var Qe=L[Ne+xe];Qe>=H&&Qe<=ne&&(N.push(L[Ne]),N.push(L[Ne+1]),N.push(L[Ne+2]))}}function Ye(L,N,H,ne,xe,Ne,Qe){for(var J,Me,bt=Pt(L),gr=xe===0?ve:it,zt=L.start,Nt=0;Nt<L.length-3;Nt+=3){var br=L[Nt],vn=L[Nt+1],cn=L[Nt+2],Lt=L[Nt+3],on=L[Nt+4],qr=xe===0?br:vn,Yr=xe===0?Lt:on,$n=!1;Qe&&(J=Math.sqrt(Math.pow(br-Lt,2)+Math.pow(vn-on,2))),qr<H?Yr>H&&(Me=gr(bt,br,vn,Lt,on,H),Qe&&(bt.start=zt+J*Me)):qr>ne?Yr<ne&&(Me=gr(bt,br,vn,Lt,on,ne),Qe&&(bt.start=zt+J*Me)):he(bt,br,vn,cn),Yr<H&&qr>=H&&(Me=gr(bt,br,vn,Lt,on,H),$n=!0),Yr>ne&&qr<=ne&&(Me=gr(bt,br,vn,Lt,on,ne),$n=!0),!Ne&&$n&&(Qe&&(bt.end=zt+J*Me),N.push(bt),bt=Pt(L)),Qe&&(zt+=J)}var $r=L.length-3;br=L[$r],vn=L[$r+1],cn=L[$r+2],(qr=xe===0?br:vn)>=H&&qr<=ne&&he(bt,br,vn,cn),$r=bt.length-3,Ne&&$r>=3&&(bt[$r]!==bt[0]||bt[$r+1]!==bt[1])&&he(bt,bt[0],bt[1],bt[2]),bt.length&&N.push(bt)}function Pt(L){var N=[];return N.size=L.size,N.start=L.start,N.end=L.end,N}function te(L,N,H,ne,xe,Ne){for(var Qe=0;Qe<L.length;Qe++)Ye(L[Qe],N,H,ne,xe,Ne,!1)}function he(L,N,H,ne){L.push(N),L.push(H),L.push(ne)}function ve(L,N,H,ne,xe,Ne){var Qe=(Ne-N)/(ne-N);return L.push(Ne),L.push(H+(xe-H)*Qe),L.push(1),Qe}function it(L,N,H,ne,xe,Ne){var Qe=(Ne-H)/(xe-H);return L.push(N+(ne-N)*Qe),L.push(Ne),L.push(1),Qe}function at(L,N){for(var H=[],ne=0;ne<L.length;ne++){var xe,Ne=L[ne],Qe=Ne.type;if(Qe==="Point"||Qe==="MultiPoint"||Qe==="LineString")xe=fe(Ne.geometry,N);else if(Qe==="MultiLineString"||Qe==="Polygon"){xe=[];for(var J=0;J<Ne.geometry.length;J++)xe.push(fe(Ne.geometry[J],N))}else if(Qe==="MultiPolygon")for(xe=[],J=0;J<Ne.geometry.length;J++){for(var Me=[],bt=0;bt<Ne.geometry[J].length;bt++)Me.push(fe(Ne.geometry[J][bt],N));xe.push(Me)}H.push(rt(Ne.id,Qe,xe,Ne.tags))}return H}function fe(L,N){var H=[];H.size=L.size,L.start!==void 0&&(H.start=L.start,H.end=L.end);for(var ne=0;ne<L.length;ne+=3)H.push(L[ne]+N,L[ne+1],L[ne+2]);return H}function wr(L,N){if(L.transformed)return L;var H,ne,xe,Ne=1<<L.z,Qe=L.x,J=L.y;for(H=0;H<L.features.length;H++){var Me=L.features[H],bt=Me.geometry,gr=Me.type;if(Me.geometry=[],gr===1)for(ne=0;ne<bt.length;ne+=2)Me.geometry.push(Dr(bt[ne],bt[ne+1],N,Ne,Qe,J));else for(ne=0;ne<bt.length;ne++){var zt=[];for(xe=0;xe<bt[ne].length;xe+=2)zt.push(Dr(bt[ne][xe],bt[ne][xe+1],N,Ne,Qe,J));Me.geometry.push(zt)}}return L.transformed=!0,L}function Dr(L,N,H,ne,xe,Ne){return[Math.round(H*(L*ne-xe)),Math.round(H*(N*ne-Ne))]}function Nr(L,N,H,ne,xe){for(var Ne=N===xe.maxZoom?0:xe.tolerance/((1<<N)*xe.extent),Qe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:H,y:ne,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},J=0;J<L.length;J++){Qe.numFeatures++,yt(Qe,L[J],Ne,xe);var Me=L[J].minX,bt=L[J].minY,gr=L[J].maxX,zt=L[J].maxY;Me<Qe.minX&&(Qe.minX=Me),bt<Qe.minY&&(Qe.minY=bt),gr>Qe.maxX&&(Qe.maxX=gr),zt>Qe.maxY&&(Qe.maxY=zt)}return Qe}function yt(L,N,H,ne){var xe=N.geometry,Ne=N.type,Qe=[];if(Ne==="Point"||Ne==="MultiPoint")for(var J=0;J<xe.length;J+=3)Qe.push(xe[J]),Qe.push(xe[J+1]),L.numPoints++,L.numSimplified++;else if(Ne==="LineString")jr(Qe,xe,L,H,!1,!1);else if(Ne==="MultiLineString"||Ne==="Polygon")for(J=0;J<xe.length;J++)jr(Qe,xe[J],L,H,Ne==="Polygon",J===0);else if(Ne==="MultiPolygon")for(var Me=0;Me<xe.length;Me++){var bt=xe[Me];for(J=0;J<bt.length;J++)jr(Qe,bt[J],L,H,!0,J===0)}if(Qe.length){var gr=N.tags||null;if(Ne==="LineString"&&ne.lineMetrics){for(var zt in gr={},N.tags)gr[zt]=N.tags[zt];gr.mapbox_clip_start=xe.start/xe.size,gr.mapbox_clip_end=xe.end/xe.size}var Nt={geometry:Qe,type:Ne==="Polygon"||Ne==="MultiPolygon"?3:Ne==="LineString"||Ne==="MultiLineString"?2:1,tags:gr};N.id!==null&&(Nt.id=N.id),L.features.push(Nt)}}function jr(L,N,H,ne,xe,Ne){var Qe=ne*ne;if(ne>0&&N.size<(xe?Qe:ne))H.numPoints+=N.length/3;else{for(var J=[],Me=0;Me<N.length;Me+=3)(ne===0||N[Me+2]>Qe)&&(H.numSimplified++,J.push(N[Me]),J.push(N[Me+1])),H.numPoints++;xe&&function(bt,gr){for(var zt=0,Nt=0,br=bt.length,vn=br-2;Nt<br;vn=Nt,Nt+=2)zt+=(bt[Nt]-bt[vn])*(bt[Nt+1]+bt[vn+1]);if(zt>0===gr)for(Nt=0,br=bt.length;Nt<br/2;Nt+=2){var cn=bt[Nt],Lt=bt[Nt+1];bt[Nt]=bt[br-2-Nt],bt[Nt+1]=bt[br-1-Nt],bt[br-2-Nt]=cn,bt[br-1-Nt]=Lt}}(J,Ne),L.push(J)}}function Dn(L,N){var H=(N=this.options=function(xe,Ne){for(var Qe in Ne)xe[Qe]=Ne[Qe];return xe}(Object.create(this.options),N)).debug;if(H&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");var ne=function(xe,Ne){var Qe=[];if(xe.type==="FeatureCollection")for(var J=0;J<xe.features.length;J++)Kt(Qe,xe.features[J],Ne,J);else Kt(Qe,xe.type==="Feature"?xe:{geometry:xe},Ne);return Qe}(L,N);this.tiles={},this.tileCoords=[],H&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ne=function(xe,Ne){var Qe=Ne.buffer/Ne.extent,J=xe,Me=b(xe,1,-1-Qe,Qe,0,-1,2,Ne),bt=b(xe,1,1-Qe,2+Qe,0,-1,2,Ne);return(Me||bt)&&(J=b(xe,1,-Qe,1+Qe,0,-1,2,Ne)||[],Me&&(J=at(Me,1).concat(J)),bt&&(J=J.concat(at(bt,-1)))),J}(ne,N)).length&&this.splitTile(ne,0,0,0),H&&(ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ai(L,N,H){return 32*((1<<L)*H+N)+L}function Mi(L,N){var H=L.tileID.canonical;if(!this._geoJSONIndex)return N(null,null);var ne=this._geoJSONIndex.getTile(H.z,H.x,H.y);if(!ne)return N(null,null);var xe=new vr(ne.features),Ne=Se(xe);Ne.byteOffset===0&&Ne.byteLength===Ne.buffer.byteLength||(Ne=new Uint8Array(Ne)),N(null,{vectorTile:xe,rawData:Ne.buffer})}ke.prototype.load=function(L){var N=this.options,H=N.log,ne=N.minZoom,xe=N.maxZoom,Ne=N.nodeSize;H&&console.time("total time");var Qe="prepare "+L.length+" points";H&&console.time(Qe),this.points=L;for(var J=[],Me=0;Me<L.length;Me++)L[Me].geometry&&J.push(We(L[Me],Me));this.trees[xe+1]=new Ae(J,Gr,er,Ne,Float32Array),H&&console.timeEnd(Qe);for(var bt=xe;bt>=ne;bt--){var gr=+Date.now();J=this._cluster(J,bt),this.trees[bt]=new Ae(J,Gr,er,Ne,Float32Array),H&&console.log("z%d: %d clusters in %dms",bt,J.length,+Date.now()-gr)}return H&&console.timeEnd("total time"),this},ke.prototype.getClusters=function(L,N){var H=((L[0]+180)%360+360)%360-180,ne=Math.max(-90,Math.min(90,L[1])),xe=L[2]===180?180:((L[2]+180)%360+360)%360-180,Ne=Math.max(-90,Math.min(90,L[3]));if(L[2]-L[0]>=360)H=-180,xe=180;else if(H>xe){var Qe=this.getClusters([H,ne,180,Ne],N),J=this.getClusters([-180,ne,xe,Ne],N);return Qe.concat(J)}for(var Me=this.trees[this._limitZoom(N)],bt=[],gr=0,zt=Me.range(Gt(H),Rt(Ne),Gt(xe),Rt(ne));gr<zt.length;gr+=1){var Nt=Me.points[zt[gr]];bt.push(Nt.numPoints?xt(Nt):this.points[Nt.index])}return bt},ke.prototype.getChildren=function(L){var N=this._getOriginId(L),H=this._getOriginZoom(L),ne="No cluster with the specified id.",xe=this.trees[H];if(!xe)throw new Error(ne);var Ne=xe.points[N];if(!Ne)throw new Error(ne);for(var Qe=this.options.radius/(this.options.extent*Math.pow(2,H-1)),J=[],Me=0,bt=xe.within(Ne.x,Ne.y,Qe);Me<bt.length;Me+=1){var gr=xe.points[bt[Me]];gr.parentId===L&&J.push(gr.numPoints?xt(gr):this.points[gr.index])}if(J.length===0)throw new Error(ne);return J},ke.prototype.getLeaves=function(L,N,H){var ne=[];return this._appendLeaves(ne,L,N=N||10,H=H||0,0),ne},ke.prototype.getTile=function(L,N,H){var ne=this.trees[this._limitZoom(L)],xe=Math.pow(2,L),Ne=this.options,Qe=Ne.radius/Ne.extent,J=(H-Qe)/xe,Me=(H+1+Qe)/xe,bt={features:[]};return this._addTileFeatures(ne.range((N-Qe)/xe,J,(N+1+Qe)/xe,Me),ne.points,N,H,xe,bt),N===0&&this._addTileFeatures(ne.range(1-Qe/xe,J,1,Me),ne.points,xe,H,xe,bt),N===xe-1&&this._addTileFeatures(ne.range(0,J,Qe/xe,Me),ne.points,-1,H,xe,bt),bt.features.length?bt:null},ke.prototype.getClusterExpansionZoom=function(L){for(var N=this._getOriginZoom(L)-1;N<=this.options.maxZoom;){var H=this.getChildren(L);if(N++,H.length!==1)break;L=H[0].properties.cluster_id}return N},ke.prototype._appendLeaves=function(L,N,H,ne,xe){for(var Ne=0,Qe=this.getChildren(N);Ne<Qe.length;Ne+=1){var J=Qe[Ne],Me=J.properties;if(Me&&Me.cluster?xe+Me.point_count<=ne?xe+=Me.point_count:xe=this._appendLeaves(L,Me.cluster_id,H,ne,xe):xe<ne?xe++:L.push(J),L.length===H)break}return xe},ke.prototype._addTileFeatures=function(L,N,H,ne,xe,Ne){for(var Qe=0,J=L;Qe<J.length;Qe+=1){var Me=N[J[Qe]],bt=Me.numPoints,gr={type:1,geometry:[[Math.round(this.options.extent*(Me.x*xe-H)),Math.round(this.options.extent*(Me.y*xe-ne))]],tags:bt?jt(Me):this.points[Me.index].properties},zt=void 0;bt?zt=Me.id:this.options.generateId?zt=Me.index:this.points[Me.index].id&&(zt=this.points[Me.index].id),zt!==void 0&&(gr.id=zt),Ne.features.push(gr)}},ke.prototype._limitZoom=function(L){return Math.max(this.options.minZoom,Math.min(+L,this.options.maxZoom+1))},ke.prototype._cluster=function(L,N){for(var H=[],ne=this.options,xe=ne.reduce,Ne=ne.minPoints,Qe=ne.radius/(ne.extent*Math.pow(2,N)),J=0;J<L.length;J++){var Me=L[J];if(!(Me.zoom<=N)){Me.zoom=N;for(var bt=this.trees[N+1],gr=bt.within(Me.x,Me.y,Qe),zt=Me.numPoints||1,Nt=zt,br=0,vn=gr;br<vn.length;br+=1){var cn=bt.points[vn[br]];cn.zoom>N&&(Nt+=cn.numPoints||1)}if(Nt>=Ne){for(var Lt=Me.x*zt,on=Me.y*zt,qr=xe&&zt>1?this._map(Me,!0):null,Yr=(J<<5)+(N+1)+this.points.length,$n=0,$r=gr;$n<$r.length;$n+=1){var hi=bt.points[$r[$n]];if(!(hi.zoom<=N)){hi.zoom=N;var Oi=hi.numPoints||1;Lt+=hi.x*Oi,on+=hi.y*Oi,hi.parentId=Yr,xe&&(qr||(qr=this._map(Me,!0)),xe(qr,this._map(hi)))}}Me.parentId=Yr,H.push(He(Lt/Nt,on/Nt,Yr,Nt,qr))}else if(H.push(Me),Nt>1)for(var Qn=0,fi=gr;Qn<fi.length;Qn+=1){var ei=bt.points[fi[Qn]];ei.zoom<=N||(ei.zoom=N,H.push(ei))}}}return H},ke.prototype._getOriginId=function(L){return L-this.points.length>>5},ke.prototype._getOriginZoom=function(L){return(L-this.points.length)%32},ke.prototype._map=function(L,N){if(L.numPoints)return N?Ar({},L.properties):L.properties;var H=this.points[L.index].properties,ne=this.options.map(H);return N&&ne===H?Ar({},ne):ne},Dn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Dn.prototype.splitTile=function(L,N,H,ne,xe,Ne,Qe){for(var J=[L,N,H,ne],Me=this.options,bt=Me.debug;J.length;){ne=J.pop(),H=J.pop(),N=J.pop(),L=J.pop();var gr=1<<N,zt=ai(N,H,ne),Nt=this.tiles[zt];if(!Nt&&(bt>1&&console.time("creation"),Nt=this.tiles[zt]=Nr(L,N,H,ne,Me),this.tileCoords.push({z:N,x:H,y:ne}),bt)){bt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,H,ne,Nt.numFeatures,Nt.numPoints,Nt.numSimplified),console.timeEnd("creation"));var br="z"+N;this.stats[br]=(this.stats[br]||0)+1,this.total++}if(Nt.source=L,xe){if(N===Me.maxZoom||N===xe)continue;var vn=1<<xe-N;if(H!==Math.floor(Ne/vn)||ne!==Math.floor(Qe/vn))continue}else if(N===Me.indexMaxZoom||Nt.numPoints<=Me.indexMaxPoints)continue;if(Nt.source=null,L.length!==0){bt>1&&console.time("clipping");var cn,Lt,on,qr,Yr,$n,$r=.5*Me.buffer/Me.extent,hi=.5-$r,Oi=.5+$r,Qn=1+$r;cn=Lt=on=qr=null,Yr=b(L,gr,H-$r,H+Oi,0,Nt.minX,Nt.maxX,Me),$n=b(L,gr,H+hi,H+Qn,0,Nt.minX,Nt.maxX,Me),L=null,Yr&&(cn=b(Yr,gr,ne-$r,ne+Oi,1,Nt.minY,Nt.maxY,Me),Lt=b(Yr,gr,ne+hi,ne+Qn,1,Nt.minY,Nt.maxY,Me),Yr=null),$n&&(on=b($n,gr,ne-$r,ne+Oi,1,Nt.minY,Nt.maxY,Me),qr=b($n,gr,ne+hi,ne+Qn,1,Nt.minY,Nt.maxY,Me),$n=null),bt>1&&console.timeEnd("clipping"),J.push(cn||[],N+1,2*H,2*ne),J.push(Lt||[],N+1,2*H,2*ne+1),J.push(on||[],N+1,2*H+1,2*ne),J.push(qr||[],N+1,2*H+1,2*ne+1)}}},Dn.prototype.getTile=function(L,N,H){var ne=this.options,xe=ne.extent,Ne=ne.debug;if(L<0||L>24)return null;var Qe=1<<L,J=ai(L,N=(N%Qe+Qe)%Qe,H);if(this.tiles[J])return wr(this.tiles[J],xe);Ne>1&&console.log("drilling down to z%d-%d-%d",L,N,H);for(var Me,bt=L,gr=N,zt=H;!Me&&bt>0;)bt--,gr=Math.floor(gr/2),zt=Math.floor(zt/2),Me=this.tiles[ai(bt,gr,zt)];return Me&&Me.source?(Ne>1&&console.log("found parent tile z%d-%d-%d",bt,gr,zt),Ne>1&&console.time("drilling down"),this.splitTile(Me.source,bt,gr,zt,L,N,H),Ne>1&&console.timeEnd("drilling down"),this.tiles[J]?wr(this.tiles[J],xe):null):null};var Li=function(L){function N(H,ne,xe,Ne){L.call(this,H,ne,xe,Mi),Ne&&(this.loadGeoJSON=Ne)}return L&&(N.__proto__=L),(N.prototype=Object.create(L&&L.prototype)).constructor=N,N.prototype.loadData=function(H,ne){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=ne,this._pendingLoadDataParams=H,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},N.prototype._loadData=function(){var H=this;if(this._pendingCallback&&this._pendingLoadDataParams){var ne=this._pendingCallback,xe=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Ne=!!(xe&&xe.request&&xe.request.collectResourceTiming)&&new l.RequestPerformance(xe.request);this.loadGeoJSON(xe,function(Qe,J){if(Qe||!J)return ne(Qe);if(typeof J!="object")return ne(new Error("Input data given to '"+xe.source+"' is not a valid GeoJSON object."));(function Nt(br,vn){var cn,Lt=br&&br.type;if(Lt==="FeatureCollection")for(cn=0;cn<br.features.length;cn++)Nt(br.features[cn],vn);else if(Lt==="GeometryCollection")for(cn=0;cn<br.geometries.length;cn++)Nt(br.geometries[cn],vn);else if(Lt==="Feature")Nt(br.geometry,vn);else if(Lt==="Polygon")Er(br.coordinates,vn);else if(Lt==="MultiPolygon")for(cn=0;cn<br.coordinates.length;cn++)Er(br.coordinates[cn],vn);return br})(J,!0);try{if(xe.filter){var Me=l.createExpression(xe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Me.result==="error")throw new Error(Me.value.map(function(Nt){return Nt.key+": "+Nt.message}).join(", "));var bt=J.features.filter(function(Nt){return Me.value.evaluate({zoom:0},Nt)});J={type:"FeatureCollection",features:bt}}H._geoJSONIndex=xe.cluster?new ke(function(Nt){var br=Nt.superclusterOptions,vn=Nt.clusterProperties;if(!vn||!br)return br;for(var cn={},Lt={},on={accumulated:null,zoom:0},qr={properties:null},Yr=Object.keys(vn),$n=0,$r=Yr;$n<$r.length;$n+=1){var hi=$r[$n],Oi=vn[hi],Qn=Oi[0],fi=l.createExpression(Oi[1]),ei=l.createExpression(typeof Qn=="string"?[Qn,["accumulated"],["get",hi]]:Qn);cn[hi]=fi.value,Lt[hi]=ei.value}return br.map=function(zn){qr.properties=zn;for(var Wn={},Qi=0,_i=Yr;Qi<_i.length;Qi+=1){var di=_i[Qi];Wn[di]=cn[di].evaluate(on,qr)}return Wn},br.reduce=function(zn,Wn){qr.properties=Wn;for(var Qi=0,_i=Yr;Qi<_i.length;Qi+=1){var di=_i[Qi];on.accumulated=zn[di],zn[di]=Lt[di].evaluate(on,qr)}},br}(xe)).load(J.features):function(Nt,br){return new Dn(Nt,br)}(J,xe.geojsonVtOptions)}catch(Nt){return ne(Nt)}H.loaded={};var gr={};if(Ne){var zt=Ne.finish();zt&&(gr.resourceTiming={},gr.resourceTiming[xe.source]=JSON.parse(JSON.stringify(zt)))}ne(null,gr)})}},N.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},N.prototype.reloadTile=function(H,ne){var xe=this.loaded;return xe&&xe[H.uid]?L.prototype.reloadTile.call(this,H,ne):this.loadTile(H,ne)},N.prototype.loadGeoJSON=function(H,ne){if(H.request)l.getJSON(H.request,ne);else{if(typeof H.data!="string")return ne(new Error("Input data given to '"+H.source+"' is not a valid GeoJSON object."));try{return ne(null,JSON.parse(H.data))}catch(xe){return ne(new Error("Input data given to '"+H.source+"' is not a valid GeoJSON object."))}}},N.prototype.removeSource=function(H,ne){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ne()},N.prototype.getClusterExpansionZoom=function(H,ne){try{ne(null,this._geoJSONIndex.getClusterExpansionZoom(H.clusterId))}catch(xe){ne(xe)}},N.prototype.getClusterChildren=function(H,ne){try{ne(null,this._geoJSONIndex.getChildren(H.clusterId))}catch(xe){ne(xe)}},N.prototype.getClusterLeaves=function(H,ne){try{ne(null,this._geoJSONIndex.getLeaves(H.clusterId,H.limit,H.offset))}catch(xe){ne(xe)}},N}(nr),Kn=function(L){var N=this;this.self=L,this.actor=new l.Actor(L,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:nr,geojson:Li},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(H,ne){if(N.workerSourceTypes[H])throw new Error('Worker source with name "'+H+'" already registered.');N.workerSourceTypes[H]=ne},this.self.registerRTLTextPlugin=function(H){if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=H.applyArabicShaping,l.plugin.processBidirectionalText=H.processBidirectionalText,l.plugin.processStyledBidirectionalText=H.processStyledBidirectionalText}};return Kn.prototype.setReferrer=function(L,N){this.referrer=N},Kn.prototype.setImages=function(L,N,H){for(var ne in this.availableImages[L]=N,this.workerSources[L]){var xe=this.workerSources[L][ne];for(var Ne in xe)xe[Ne].availableImages=N}H()},Kn.prototype.setLayers=function(L,N,H){this.getLayerIndex(L).replace(N),H()},Kn.prototype.updateLayers=function(L,N,H){this.getLayerIndex(L).update(N.layers,N.removedIds),H()},Kn.prototype.loadTile=function(L,N,H){this.getWorkerSource(L,N.type,N.source).loadTile(N,H)},Kn.prototype.loadDEMTile=function(L,N,H){this.getDEMWorkerSource(L,N.source).loadTile(N,H)},Kn.prototype.reloadTile=function(L,N,H){this.getWorkerSource(L,N.type,N.source).reloadTile(N,H)},Kn.prototype.abortTile=function(L,N,H){this.getWorkerSource(L,N.type,N.source).abortTile(N,H)},Kn.prototype.removeTile=function(L,N,H){this.getWorkerSource(L,N.type,N.source).removeTile(N,H)},Kn.prototype.removeDEMTile=function(L,N){this.getDEMWorkerSource(L,N.source).removeTile(N)},Kn.prototype.removeSource=function(L,N,H){if(this.workerSources[L]&&this.workerSources[L][N.type]&&this.workerSources[L][N.type][N.source]){var ne=this.workerSources[L][N.type][N.source];delete this.workerSources[L][N.type][N.source],ne.removeSource!==void 0?ne.removeSource(N,H):H()}},Kn.prototype.loadWorkerSource=function(L,N,H){try{this.self.importScripts(N.url),H()}catch(ne){H(ne.toString())}},Kn.prototype.syncRTLPluginState=function(L,N,H){try{l.plugin.setState(N);var ne=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&ne!=null){this.self.importScripts(ne);var xe=l.plugin.isParsed();H(xe?void 0:new Error("RTL Text Plugin failed to import scripts from "+ne),xe)}}catch(Ne){H(Ne.toString())}},Kn.prototype.getAvailableImages=function(L){var N=this.availableImages[L];return N||(N=[]),N},Kn.prototype.getLayerIndex=function(L){var N=this.layerIndexes[L];return N||(N=this.layerIndexes[L]=new Mt),N},Kn.prototype.getWorkerSource=function(L,N,H){var ne=this;return this.workerSources[L]||(this.workerSources[L]={}),this.workerSources[L][N]||(this.workerSources[L][N]={}),this.workerSources[L][N][H]||(this.workerSources[L][N][H]=new this.workerSourceTypes[N]({send:function(xe,Ne,Qe){ne.actor.send(xe,Ne,Qe,L)}},this.getLayerIndex(L),this.getAvailableImages(L))),this.workerSources[L][N][H]},Kn.prototype.getDEMWorkerSource=function(L,N){return this.demWorkerSources[L]||(this.demWorkerSources[L]={}),this.demWorkerSources[L][N]||(this.demWorkerSources[L][N]=new Dt),this.demWorkerSources[L][N]},Kn.prototype.enforceCacheSizeLimit=function(L,N){l.enforceCacheSizeLimit(N)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Kn(self)),Kn}),Ze(["./shared"],function(l){"use strict";var Vt=l.createCommonjsModule(function(n){function a(f){return!i(f)}function i(f){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var v,x,C=new Blob([""],{type:"text/javascript"}),F=URL.createObjectURL(C);try{x=new Worker(F),v=!0}catch(K){v=!1}return x&&x.terminate(),URL.revokeObjectURL(F),v}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var v=document.createElement("canvas");v.width=v.height=1;var x=v.getContext("2d");if(!x)return!1;var C=x.getImageData(0,0,1,1);return C&&C.width===v.width}()?(o[d=f&&f.failIfMajorPerformanceCaveat]===void 0&&(o[d]=function(v){var x=function(F){var K=document.createElement("canvas"),ee=Object.create(a.webGLContextAttributes);return ee.failIfMajorPerformanceCaveat=F,K.probablySupportsContext?K.probablySupportsContext("webgl",ee)||K.probablySupportsContext("experimental-webgl",ee):K.supportsContext?K.supportsContext("webgl",ee)||K.supportsContext("experimental-webgl",ee):K.getContext("webgl",ee)||K.getContext("experimental-webgl",ee)}(v);if(!x)return!1;var C=x.createShader(x.VERTEX_SHADER);return!(!C||x.isContextLost())&&(x.shaderSource(C,"void main() {}"),x.compileShader(C),x.getShaderParameter(C,x.COMPILE_STATUS)===!0)}(d)),o[d]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var d}n.exports?n.exports=a:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=a,window.mapboxgl.notSupportedReason=i);var o={};a.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),ge={create:function(n,a,i){var o=l.window.document.createElement(n);return a!==void 0&&(o.className=a),i&&i.appendChild(o),o},createNS:function(n,a){return l.window.document.createElementNS(n,a)}},Mt=l.window.document&&l.window.document.documentElement.style;function Le(n){if(!Mt)return n[0];for(var a=0;a<n.length;a++)if(n[a]in Mt)return n[a];return n[0]}var Tt,Fe=Le(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);ge.disableDrag=function(){Mt&&Fe&&(Tt=Mt[Fe],Mt[Fe]="none")},ge.enableDrag=function(){Mt&&Fe&&(Mt[Fe]=Tt)};var dt=Le(["transform","WebkitTransform"]);ge.setTransform=function(n,a){n.style[dt]=a};var nr=!1;try{var dr=Object.defineProperty({},"passive",{get:function(){nr=!0}});l.window.addEventListener("test",dr,dr),l.window.removeEventListener("test",dr,dr)}catch(n){nr=!1}ge.addEventListener=function(n,a,i,o){o===void 0&&(o={}),n.addEventListener(a,i,"passive"in o&&nr?o:o.capture)},ge.removeEventListener=function(n,a,i,o){o===void 0&&(o={}),n.removeEventListener(a,i,"passive"in o&&nr?o:o.capture)};var Dt=function(n){n.preventDefault(),n.stopPropagation(),l.window.removeEventListener("click",Dt,!0)};function Er(n){var a=n.userImage;return!!(a&&a.render&&a.render())&&(n.data.replace(new Uint8Array(a.data.buffer)),!0)}ge.suppressClick=function(){l.window.addEventListener("click",Dt,!0),l.window.setTimeout(function(){l.window.removeEventListener("click",Dt,!0)},0)},ge.mousePos=function(n,a){var i=n.getBoundingClientRect();return new l.Point(a.clientX-i.left-n.clientLeft,a.clientY-i.top-n.clientTop)},ge.touchPos=function(n,a){for(var i=n.getBoundingClientRect(),o=[],f=0;f<a.length;f++)o.push(new l.Point(a[f].clientX-i.left-n.clientLeft,a[f].clientY-i.top-n.clientTop));return o},ge.mouseButton=function(n){return l.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&l.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},ge.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var wt=function(n){function a(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.isLoaded=function(){return this.loaded},a.prototype.setLoaded=function(i){if(this.loaded!==i&&(this.loaded=i,i)){for(var o=0,f=this.requestors;o<f.length;o+=1){var d=f[o];this._notify(d.ids,d.callback)}this.requestors=[]}},a.prototype.getImage=function(i){return this.images[i]},a.prototype.addImage=function(i,o){this._validate(i,o)&&(this.images[i]=o)},a.prototype._validate=function(i,o){var f=!0;return this._validateStretch(o.stretchX,o.data&&o.data.width)||(this.fire(new l.ErrorEvent(new Error('Image "'+i+'" has invalid "stretchX" value'))),f=!1),this._validateStretch(o.stretchY,o.data&&o.data.height)||(this.fire(new l.ErrorEvent(new Error('Image "'+i+'" has invalid "stretchY" value'))),f=!1),this._validateContent(o.content,o)||(this.fire(new l.ErrorEvent(new Error('Image "'+i+'" has invalid "content" value'))),f=!1),f},a.prototype._validateStretch=function(i,o){if(!i)return!0;for(var f=0,d=0,v=i;d<v.length;d+=1){var x=v[d];if(x[0]<f||x[1]<x[0]||o<x[1])return!1;f=x[1]}return!0},a.prototype._validateContent=function(i,o){return!(i&&(i.length!==4||i[0]<0||o.data.width<i[0]||i[1]<0||o.data.height<i[1]||i[2]<0||o.data.width<i[2]||i[3]<0||o.data.height<i[3]||i[2]<i[0]||i[3]<i[1]))},a.prototype.updateImage=function(i,o){o.version=this.images[i].version+1,this.images[i]=o,this.updatedImages[i]=!0},a.prototype.removeImage=function(i){var o=this.images[i];delete this.images[i],delete this.patterns[i],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()},a.prototype.listImages=function(){return Object.keys(this.images)},a.prototype.getImages=function(i,o){var f=!0;if(!this.isLoaded())for(var d=0,v=i;d<v.length;d+=1)this.images[v[d]]||(f=!1);this.isLoaded()||f?this._notify(i,o):this.requestors.push({ids:i,callback:o})},a.prototype._notify=function(i,o){for(var f={},d=0,v=i;d<v.length;d+=1){var x=v[d];this.images[x]||this.fire(new l.Event("styleimagemissing",{id:x}));var C=this.images[x];C?f[x]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:Boolean(C.userImage&&C.userImage.render)}:l.warnOnce('Image "'+x+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}o(null,f)},a.prototype.getPixelSize=function(){var i=this.atlasImage;return{width:i.width,height:i.height}},a.prototype.getPattern=function(i){var o=this.patterns[i],f=this.getImage(i);if(!f)return null;if(o&&o.position.version===f.version)return o.position;if(o)o.position.version=f.version;else{var d={w:f.data.width+2,h:f.data.height+2,x:0,y:0},v=new l.ImagePosition(d,f);this.patterns[i]={bin:d,position:v}}return this._updatePatternAtlas(),this.patterns[i].position},a.prototype.bind=function(i){var o=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.Texture(i,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)},a.prototype._updatePatternAtlas=function(){var i=[];for(var o in this.patterns)i.push(this.patterns[o].bin);var f=l.potpack(i),d=f.w,v=f.h,x=this.atlasImage;for(var C in x.resize({width:d||1,height:v||1}),this.patterns){var F=this.patterns[C].bin,K=F.x+1,ee=F.y+1,re=this.images[C].data,Pe=re.width,Ce=re.height;l.RGBAImage.copy(re,x,{x:0,y:0},{x:K,y:ee},{width:Pe,height:Ce}),l.RGBAImage.copy(re,x,{x:0,y:Ce-1},{x:K,y:ee-1},{width:Pe,height:1}),l.RGBAImage.copy(re,x,{x:0,y:0},{x:K,y:ee+Ce},{width:Pe,height:1}),l.RGBAImage.copy(re,x,{x:Pe-1,y:0},{x:K-1,y:ee},{width:1,height:Ce}),l.RGBAImage.copy(re,x,{x:0,y:0},{x:K+Pe,y:ee},{width:1,height:Ce})}this.dirty=!0},a.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},a.prototype.dispatchRenderCallbacks=function(i){for(var o=0,f=i;o<f.length;o+=1){var d=f[o];if(!this.callbackDispatchedThisFrame[d]){this.callbackDispatchedThisFrame[d]=!0;var v=this.images[d];Er(v)&&this.updateImage(d,v)}}},a}(l.Evented),fr=kt,Et=kt,vr=1e20;function kt(n,a,i,o,f,d){this.fontSize=n||24,this.buffer=a===void 0?3:a,this.cutoff=o||.25,this.fontFamily=f||"sans-serif",this.fontWeight=d||"normal",this.radius=i||8;var v=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=v,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(v*v),this.gridInner=new Float64Array(v*v),this.f=new Float64Array(v),this.d=new Float64Array(v),this.z=new Float64Array(v+1),this.v=new Int16Array(v),this.middle=Math.round(v/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function mt(n,a,i,o,f,d,v){for(var x=0;x<a;x++){for(var C=0;C<i;C++)o[C]=n[C*a+x];for(k(o,f,d,v,i),C=0;C<i;C++)n[C*a+x]=f[C]}for(C=0;C<i;C++){for(x=0;x<a;x++)o[x]=n[C*a+x];for(k(o,f,d,v,a),x=0;x<a;x++)n[C*a+x]=Math.sqrt(f[x])}}function k(n,a,i,o,f){i[0]=0,o[0]=-vr,o[1]=+vr;for(var d=1,v=0;d<f;d++){for(var x=(n[d]+d*d-(n[i[v]]+i[v]*i[v]))/(2*d-2*i[v]);x<=o[v];)v--,x=(n[d]+d*d-(n[i[v]]+i[v]*i[v]))/(2*d-2*i[v]);i[++v]=d,o[v]=x,o[v+1]=+vr}for(d=0,v=0;d<f;d++){for(;o[v+1]<d;)v++;a[d]=(d-i[v])*(d-i[v])+n[i[v]]}}kt.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var a=this.ctx.getImageData(0,0,this.size,this.size),i=new Uint8ClampedArray(this.size*this.size),o=0;o<this.size*this.size;o++){var f=a.data[4*o+3]/255;this.gridOuter[o]=f===1?0:f===0?vr:Math.pow(Math.max(0,.5-f),2),this.gridInner[o]=f===1?vr:f===0?0:Math.pow(Math.max(0,f-.5),2)}for(mt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),mt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),o=0;o<this.size*this.size;o++)i[o]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[o]-this.gridInner[o])/this.radius+this.cutoff))));return i},fr.default=Et;var Te=function(n,a){this.requestManager=n,this.localIdeographFontFamily=a,this.entries={}};Te.prototype.setURL=function(n){this.url=n},Te.prototype.getGlyphs=function(n,a){var i=this,o=[];for(var f in n)for(var d=0,v=n[f];d<v.length;d+=1)o.push({stack:f,id:v[d]});l.asyncAll(o,function(x,C){var F=x.stack,K=x.id,ee=i.entries[F];ee||(ee=i.entries[F]={glyphs:{},requests:{},ranges:{}});var re=ee.glyphs[K];if(re===void 0){if(re=i._tinySDF(ee,F,K))return ee.glyphs[K]=re,void C(null,{stack:F,id:K,glyph:re});var Pe=Math.floor(K/256);if(256*Pe>65535)C(new Error("glyphs > 65535 not supported"));else if(ee.ranges[Pe])C(null,{stack:F,id:K,glyph:re});else{var Ce=ee.requests[Pe];Ce||(Ce=ee.requests[Pe]=[],Te.loadGlyphRange(F,Pe,i.url,i.requestManager,function(qe,_e){if(_e){for(var Ge in _e)i._doesCharSupportLocalGlyph(+Ge)||(ee.glyphs[+Ge]=_e[+Ge]);ee.ranges[Pe]=!0}for(var et=0,St=Ce;et<St.length;et+=1)(0,St[et])(qe,_e);delete ee.requests[Pe]})),Ce.push(function(qe,_e){qe?C(qe):_e&&C(null,{stack:F,id:K,glyph:_e[K]||null})})}}else C(null,{stack:F,id:K,glyph:re})},function(x,C){if(x)a(x);else if(C){for(var F={},K=0,ee=C;K<ee.length;K+=1){var re=ee[K],Pe=re.stack,Ce=re.id,qe=re.glyph;(F[Pe]||(F[Pe]={}))[Ce]=qe&&{id:qe.id,bitmap:qe.bitmap.clone(),metrics:qe.metrics}}a(null,F)}})},Te.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(l.isChar["CJK Unified Ideographs"](n)||l.isChar["Hangul Syllables"](n)||l.isChar.Hiragana(n)||l.isChar.Katakana(n))},Te.prototype._tinySDF=function(n,a,i){var o=this.localIdeographFontFamily;if(o&&this._doesCharSupportLocalGlyph(i)){var f=n.tinySDF;if(!f){var d="400";/bold/i.test(a)?d="900":/medium/i.test(a)?d="500":/light/i.test(a)&&(d="200"),f=n.tinySDF=new Te.TinySDF(24,3,8,.25,o,d)}return{id:i,bitmap:new l.AlphaImage({width:30,height:30},f.draw(String.fromCharCode(i))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Te.loadGlyphRange=function(n,a,i,o,f){var d=256*a,v=d+255,x=o.transformRequest(o.normalizeGlyphsURL(i).replace("{fontstack}",n).replace("{range}",d+"-"+v),l.ResourceType.Glyphs);l.getArrayBuffer(x,function(C,F){if(C)f(C);else if(F){for(var K={},ee=0,re=l.parseGlyphPBF(F);ee<re.length;ee+=1){var Pe=re[ee];K[Pe.id]=Pe}f(null,K)}})},Te.TinySDF=fr;var Se=function(){this.specification=l.styleSpec.light.position};Se.prototype.possiblyEvaluate=function(n,a){return l.sphericalToCartesian(n.expression.evaluate(a))},Se.prototype.interpolate=function(n,a,i){return{x:l.number(n.x,a.x,i),y:l.number(n.y,a.y,i),z:l.number(n.z,a.z,i)}};var me=new l.Properties({anchor:new l.DataConstantProperty(l.styleSpec.light.anchor),position:new Se,color:new l.DataConstantProperty(l.styleSpec.light.color),intensity:new l.DataConstantProperty(l.styleSpec.light.intensity)}),De=function(n){function a(i){n.call(this),this._transitionable=new l.Transitionable(me),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getLight=function(){return this._transitionable.serialize()},a.prototype.setLight=function(i,o){if(o===void 0&&(o={}),!this._validate(l.validateLight,i,o))for(var f in i){var d=i[f];l.endsWith(f,"-transition")?this._transitionable.setTransition(f.slice(0,-"-transition".length),d):this._transitionable.setValue(f,d)}},a.prototype.updateTransitions=function(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)},a.prototype.hasTransition=function(){return this._transitioning.hasTransition()},a.prototype.recalculate=function(i){this.properties=this._transitioning.possiblyEvaluate(i)},a.prototype._validate=function(i,o,f){return(!f||f.validate!==!1)&&l.emitValidationErrors(this,i.call(l.validateStyle,l.extend({value:o,style:{glyphs:!0,sprite:!0},styleSpec:l.styleSpec})))},a}(l.Evented),we=function(n,a){this.width=n,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};we.prototype.getDash=function(n,a){var i=n.join(",")+String(a);return this.dashEntry[i]||(this.dashEntry[i]=this.addDash(n,a)),this.dashEntry[i]},we.prototype.getDashRanges=function(n,a,i){var o=[],f=n.length%2==1?-n[n.length-1]*i:0,d=n[0]*i,v=!0;o.push({left:f,right:d,isDash:v,zeroLength:n[0]===0});for(var x=n[0],C=1;C<n.length;C++){var F=n[C];o.push({left:f=x*i,right:d=(x+=F)*i,isDash:v=!v,zeroLength:F===0})}return o},we.prototype.addRoundDash=function(n,a,i){for(var o=a/2,f=-i;f<=i;f++)for(var d=this.width*(this.nextRow+i+f),v=0,x=n[v],C=0;C<this.width;C++){C/x.right>1&&(x=n[++v]);var F=Math.abs(C-x.left),K=Math.abs(C-x.right),ee=Math.min(F,K),re=void 0,Pe=f/i*(o+1);if(x.isDash){var Ce=o-Math.abs(Pe);re=Math.sqrt(ee*ee+Ce*Ce)}else re=o-Math.sqrt(ee*ee+Pe*Pe);this.data[d+C]=Math.max(0,Math.min(255,re+128))}},we.prototype.addRegularDash=function(n){for(var a=n.length-1;a>=0;--a){var i=n[a],o=n[a+1];i.zeroLength?n.splice(a,1):o&&o.isDash===i.isDash&&(o.left=i.left,n.splice(a,1))}var f=n[0],d=n[n.length-1];f.isDash===d.isDash&&(f.left=d.left-this.width,d.right=f.right+this.width);for(var v=this.width*this.nextRow,x=0,C=n[x],F=0;F<this.width;F++){F/C.right>1&&(C=n[++x]);var K=Math.abs(F-C.left),ee=Math.abs(F-C.right),re=Math.min(K,ee);this.data[v+F]=Math.max(0,Math.min(255,(C.isDash?re:-re)+128))}},we.prototype.addDash=function(n,a){var i=a?7:0,o=2*i+1;if(this.nextRow+o>this.height)return l.warnOnce("LineAtlas out of space"),null;for(var f=0,d=0;d<n.length;d++)f+=n[d];if(f!==0){var v=this.width/f,x=this.getDashRanges(n,this.width,v);a?this.addRoundDash(x,v,i):this.addRegularDash(x)}var C={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:f};return this.nextRow+=o,this.dirty=!0,C},we.prototype.bind=function(n){var a=n.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))};var ze=function n(a,i){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=l.uniqueId();for(var o=this.workerPool.acquire(this.id),f=0;f<o.length;f++){var d=new n.Actor(o[f],i,this.id);d.name="Worker "+f,this.actors.push(d)}};function Qt(n,a,i){var o=function(f,d){if(f)return i(f);if(d){var v=l.pick(l.extend(d,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);d.vector_layers&&(v.vectorLayers=d.vector_layers,v.vectorLayerIds=v.vectorLayers.map(function(x){return x.id})),v.tiles=a.canonicalizeTileset(v,n.url),i(null,v)}};return n.url?l.getJSON(a.transformRequest(a.normalizeSourceURL(n.url),l.ResourceType.Source),o):l.browser.frame(function(){return o(null,n)})}ze.prototype.broadcast=function(n,a,i){l.asyncAll(this.actors,function(o,f){o.send(n,a,f)},i=i||function(){})},ze.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},ze.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},ze.Actor=l.Actor;var V=function(n,a,i){this.bounds=l.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=a||0,this.maxzoom=i||24};V.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},V.prototype.contains=function(n){var a=Math.pow(2,n.z),i=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*a),o=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*a),f=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*a),d=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*a);return n.x>=i&&n.x<f&&n.y>=o&&n.y<d};var pe=function(n){function a(i,o,f,d){if(n.call(this),this.id=i,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(o,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var i=this;this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Qt(this._options,this.map._requestManager,function(o,f){i._tileJSONRequest=null,i._loaded=!0,o?i.fire(new l.ErrorEvent(o)):f&&(l.extend(i,f),f.bounds&&(i.tileBounds=new V(f.bounds,i.minzoom,i.maxzoom)),l.postTurnstileEvent(f.tiles,i.map._requestManager._customAccessToken),l.postMapLoadEvent(f.tiles,i.map._getMapId(),i.map._requestManager._skuToken,i.map._requestManager._customAccessToken),i.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),i.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.hasTile=function(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)},a.prototype.onAdd=function(i){this.map=i,this.load()},a.prototype.setSourceProperty=function(i){this._tileJSONRequest&&this._tileJSONRequest.cancel(),i(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},a.prototype.setTiles=function(i){var o=this;return this.setSourceProperty(function(){o._options.tiles=i}),this},a.prototype.setUrl=function(i){var o=this;return this.setSourceProperty(function(){o.url=i,o._options.url=i}),this},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return l.extend({},this._options)},a.prototype.loadTile=function(i,o){var f=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme)),d={request:this.map._requestManager.transformRequest(f,l.ResourceType.Tile),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:l.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function v(x,C){return delete i.request,i.aborted?o(null):x&&x.status!==404?o(x):(C&&C.resourceTiming&&(i.resourceTiming=C.resourceTiming),this.map._refreshExpiredTiles&&C&&i.setExpiryData(C),i.loadVectorData(C,this.map.painter),l.cacheEntryPossiblyAdded(this.dispatcher),o(null),void(i.reloadCallback&&(this.loadTile(i,i.reloadCallback),i.reloadCallback=null)))}d.request.collectResourceTiming=this._collectResourceTiming,i.actor&&i.state!=="expired"?i.state==="loading"?i.reloadCallback=o:i.request=i.actor.send("reloadTile",d,v.bind(this)):(i.actor=this.dispatcher.getActor(),i.request=i.actor.send("loadTile",d,v.bind(this)))},a.prototype.abortTile=function(i){i.request&&(i.request.cancel(),delete i.request),i.actor&&i.actor.send("abortTile",{uid:i.uid,type:this.type,source:this.id},void 0)},a.prototype.unloadTile=function(i){i.unloadVectorData(),i.actor&&i.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id},void 0)},a.prototype.hasTransition=function(){return!1},a}(l.Evented),P=function(n){function a(i,o,f,d){n.call(this),this.id=i,this.dispatcher=f,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},o),l.extend(this,l.pick(o,["url","scheme","tileSize"]))}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var i=this;this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Qt(this._options,this.map._requestManager,function(o,f){i._tileJSONRequest=null,i._loaded=!0,o?i.fire(new l.ErrorEvent(o)):f&&(l.extend(i,f),f.bounds&&(i.tileBounds=new V(f.bounds,i.minzoom,i.maxzoom)),l.postTurnstileEvent(f.tiles),l.postMapLoadEvent(f.tiles,i.map._getMapId(),i.map._requestManager._skuToken),i.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),i.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.onAdd=function(i){this.map=i,this.load()},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return l.extend({},this._options)},a.prototype.hasTile=function(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)},a.prototype.loadTile=function(i,o){var f=this,d=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);i.request=l.getImage(this.map._requestManager.transformRequest(d,l.ResourceType.Tile),function(v,x){if(delete i.request,i.aborted)i.state="unloaded",o(null);else if(v)i.state="errored",o(v);else if(x){f.map._refreshExpiredTiles&&i.setExpiryData(x),delete x.cacheControl,delete x.expires;var C=f.map.painter.context,F=C.gl;i.texture=f.map.painter.getTileTexture(x.width),i.texture?i.texture.update(x,{useMipmap:!0}):(i.texture=new l.Texture(C,x,F.RGBA,{useMipmap:!0}),i.texture.bind(F.LINEAR,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST),C.extTextureFilterAnisotropic&&F.texParameterf(F.TEXTURE_2D,C.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C.extTextureFilterAnisotropicMax)),i.state="loaded",l.cacheEntryPossiblyAdded(f.dispatcher),o(null)}})},a.prototype.abortTile=function(i,o){i.request&&(i.request.cancel(),delete i.request),o()},a.prototype.unloadTile=function(i,o){i.texture&&this.map.painter.saveTileTexture(i.texture),o()},a.prototype.hasTransition=function(){return!1},a}(l.Evented),U=function(n){function a(i,o,f,d){n.call(this,i,o,f,d),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},a.prototype.loadTile=function(i,o){var f=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function d(v,x){v&&(i.state="errored",o(v)),x&&(i.dem=x,i.needsHillshadePrepare=!0,i.state="loaded",o(null))}i.request=l.getImage(this.map._requestManager.transformRequest(f,l.ResourceType.Tile),function(v,x){if(delete i.request,i.aborted)i.state="unloaded",o(null);else if(v)i.state="errored",o(v);else if(x){this.map._refreshExpiredTiles&&i.setExpiryData(x),delete x.cacheControl,delete x.expires;var C=l.window.ImageBitmap&&x instanceof l.window.ImageBitmap&&l.offscreenCanvasSupported()?x:l.browser.getImageData(x,1),F={uid:i.uid,coord:i.tileID,source:this.id,rawImageData:C,encoding:this.encoding};i.actor&&i.state!=="expired"||(i.actor=this.dispatcher.getActor(),i.actor.send("loadDEMTile",F,d.bind(this)))}}.bind(this)),i.neighboringTiles=this._getNeighboringTiles(i.tileID)},a.prototype._getNeighboringTiles=function(i){var o=i.canonical,f=Math.pow(2,o.z),d=(o.x-1+f)%f,v=o.x===0?i.wrap-1:i.wrap,x=(o.x+1+f)%f,C=o.x+1===f?i.wrap+1:i.wrap,F={};return F[new l.OverscaledTileID(i.overscaledZ,v,o.z,d,o.y).key]={backfilled:!1},F[new l.OverscaledTileID(i.overscaledZ,C,o.z,x,o.y).key]={backfilled:!1},o.y>0&&(F[new l.OverscaledTileID(i.overscaledZ,v,o.z,d,o.y-1).key]={backfilled:!1},F[new l.OverscaledTileID(i.overscaledZ,i.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},F[new l.OverscaledTileID(i.overscaledZ,C,o.z,x,o.y-1).key]={backfilled:!1}),o.y+1<f&&(F[new l.OverscaledTileID(i.overscaledZ,v,o.z,d,o.y+1).key]={backfilled:!1},F[new l.OverscaledTileID(i.overscaledZ,i.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},F[new l.OverscaledTileID(i.overscaledZ,C,o.z,x,o.y+1).key]={backfilled:!1}),F},a.prototype.unloadTile=function(i){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&i.actor.send("removeDEMTile",{uid:i.uid,source:this.id})},a}(P),B=function(n){function a(i,o,f,d){n.call(this),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=f.getActor(),this.setEventedParent(d),this._data=o.data,this._options=l.extend({},o),this._collectResourceTiming=o.collectResourceTiming,this._resourceTiming=[],o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;var v=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*v,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*v,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?Math.min(o.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:l.EXTENT,radius:(o.clusterRadius||50)*v,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var i=this;this.fire(new l.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(o){if(o)i.fire(new l.ErrorEvent(o));else{var f={dataType:"source",sourceDataType:"metadata"};i._collectResourceTiming&&i._resourceTiming&&i._resourceTiming.length>0&&(f.resourceTiming=i._resourceTiming,i._resourceTiming=[]),i.fire(new l.Event("data",f))}})},a.prototype.onAdd=function(i){this.map=i,this.load()},a.prototype.setData=function(i){var o=this;return this._data=i,this.fire(new l.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(f){if(f)o.fire(new l.ErrorEvent(f));else{var d={dataType:"source",sourceDataType:"content"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(d.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new l.Event("data",d))}}),this},a.prototype.getClusterExpansionZoom=function(i,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:i,source:this.id},o),this},a.prototype.getClusterChildren=function(i,o){return this.actor.send("geojson.getClusterChildren",{clusterId:i,source:this.id},o),this},a.prototype.getClusterLeaves=function(i,o,f,d){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:i,limit:o,offset:f},d),this},a.prototype._updateWorkerData=function(i){var o=this;this._loaded=!1;var f=l.extend({},this.workerOptions),d=this._data;typeof d=="string"?(f.request=this.map._requestManager.transformRequest(l.browser.resolveURL(d),l.ResourceType.Source),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(d),this.actor.send(this.type+".loadData",f,function(v,x){o._removed||x&&x.abandoned||(o._loaded=!0,x&&x.resourceTiming&&x.resourceTiming[o.id]&&(o._resourceTiming=x.resourceTiming[o.id].slice(0)),o.actor.send(o.type+".coalesce",{source:f.source},null),i(v))})},a.prototype.loaded=function(){return this._loaded},a.prototype.loadTile=function(i,o){var f=this,d=i.actor?"reloadTile":"loadTile";i.actor=this.actor,i.request=this.actor.send(d,{type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:l.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(v,x){return delete i.request,i.unloadVectorData(),i.aborted?o(null):v?o(v):(i.loadVectorData(x,f.map.painter,d==="reloadTile"),o(null))})},a.prototype.abortTile=function(i){i.request&&(i.request.cancel(),delete i.request),i.aborted=!0},a.prototype.unloadTile=function(i){i.unloadVectorData(),this.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id})},a.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},a.prototype.serialize=function(){return l.extend({},this._options,{type:this.type,data:this._data})},a.prototype.hasTransition=function(){return!1},a}(l.Evented),E=l.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),D=function(n){function a(i,o,f,d){n.call(this),this.id=i,this.dispatcher=f,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=o}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(i,o){var f=this;this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,l.getImage(this.map._requestManager.transformRequest(this.url,l.ResourceType.Image),function(d,v){f._loaded=!0,d?f.fire(new l.ErrorEvent(d)):v&&(f.image=v,i&&(f.coordinates=i),o&&o(),f._finishLoading())})},a.prototype.loaded=function(){return this._loaded},a.prototype.updateImage=function(i){var o=this;return this.image&&i.url?(this.options.url=i.url,this.load(i.coordinates,function(){o.texture=null}),this):this},a.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))},a.prototype.onAdd=function(i){this.map=i,this.load()},a.prototype.setCoordinates=function(i){var o=this;this.coordinates=i;var f=i.map(l.MercatorCoordinate.fromLngLat);this.tileID=function(v){for(var x=1/0,C=1/0,F=-1/0,K=-1/0,ee=0,re=v;ee<re.length;ee+=1){var Pe=re[ee];x=Math.min(x,Pe.x),C=Math.min(C,Pe.y),F=Math.max(F,Pe.x),K=Math.max(K,Pe.y)}var Ce=Math.max(F-x,K-C),qe=Math.max(0,Math.floor(-Math.log(Ce)/Math.LN2)),_e=Math.pow(2,qe);return new l.CanonicalTileID(qe,Math.floor((x+F)/2*_e),Math.floor((C+K)/2*_e))}(f),this.minzoom=this.maxzoom=this.tileID.z;var d=f.map(function(v){return o.tileID.getTilePoint(v)._round()});return this._boundsArray=new l.StructArrayLayout4i8,this._boundsArray.emplaceBack(d[0].x,d[0].y,0,0),this._boundsArray.emplaceBack(d[1].x,d[1].y,l.EXTENT,0),this._boundsArray.emplaceBack(d[3].x,d[3].y,0,l.EXTENT),this._boundsArray.emplaceBack(d[2].x,d[2].y,l.EXTENT,l.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this},a.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var i=this.map.painter.context,o=i.gl;for(var f in this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,E.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new l.Texture(i,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE)),this.tiles){var d=this.tiles[f];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture)}}},a.prototype.loadTile=function(i,o){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},o(null)):(i.state="errored",o(null))},a.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return!1},a}(l.Evented),q=function(n){function a(i,o,f,d){n.call(this,i,o,f,d),this.roundZoom=!0,this.type="video",this.options=o}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var i=this;this._loaded=!1;var o=this.options;this.urls=[];for(var f=0,d=o.urls;f<d.length;f+=1)this.urls.push(this.map._requestManager.transformRequest(d[f],l.ResourceType.Source).url);l.getVideo(this.urls,function(v,x){i._loaded=!0,v?i.fire(new l.ErrorEvent(v)):x&&(i.video=x,i.video.loop=!0,i.video.addEventListener("playing",function(){i.map.triggerRepaint()}),i.map&&i.video.play(),i._finishLoading())})},a.prototype.pause=function(){this.video&&this.video.pause()},a.prototype.play=function(){this.video&&this.video.play()},a.prototype.seek=function(i){if(this.video){var o=this.video.seekable;i<o.start(0)||i>o.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+o.start(0)+" and "+o.end(0)+"-second mark."))):this.video.currentTime=i}},a.prototype.getVideo=function(){return this.video},a.prototype.onAdd=function(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},a.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var i=this.map.painter.context,o=i.gl;for(var f in this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,E.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new l.Texture(i,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE)),this.tiles){var d=this.tiles[f];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this.video&&!this.video.paused},a}(D),Q=function(n){function a(i,o,f,d){n.call(this,i,o,f,d),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(function(v){return!Array.isArray(v)||v.length!==2||v.some(function(x){return typeof x!="number"})})||this.fire(new l.ErrorEvent(new l.ValidationError("sources."+i,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError("sources."+i,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new l.ErrorEvent(new l.ValidationError("sources."+i,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof l.window.HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError("sources."+i,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError("sources."+i,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof l.window.HTMLCanvasElement?this.options.canvas:l.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},a.prototype.getCanvas=function(){return this.canvas},a.prototype.onAdd=function(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()},a.prototype.onRemove=function(){this.pause()},a.prototype.prepare=function(){var i=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,i=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,i=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var o=this.map.painter.context,f=o.gl;for(var d in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,E.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(i||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l.Texture(o,this.canvas,f.RGBA,{premultiply:!0}),this.tiles){var v=this.tiles[d];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this._playing},a.prototype._hasInvalidDimensions=function(){for(var i=0,o=[this.canvas.width,this.canvas.height];i<o.length;i+=1){var f=o[i];if(isNaN(f)||f<=0)return!0}return!1},a}(D),Ae={vector:pe,raster:P,"raster-dem":U,geojson:B,video:q,image:D,canvas:Q};function ct(n,a){var i=l.identity([]);return l.translate(i,i,[1,1,0]),l.scale(i,i,[.5*n.width,.5*n.height,1]),l.multiply(i,i,n.calculatePosMatrix(a.toUnwrapped()))}function ke(n,a,i,o,f,d){var v=function(qe,_e,Ge){if(qe)for(var et=0,St=qe;et<St.length;et+=1){var $t=_e[St[et]];if($t&&$t.source===Ge&&$t.type==="fill-extrusion")return!0}else for(var Zt in _e){var rr=_e[Zt];if(rr.source===Ge&&rr.type==="fill-extrusion")return!0}return!1}(f&&f.layers,a,n.id),x=d.maxPitchScaleFactor(),C=n.tilesIn(o,x,v);C.sort(He);for(var F=[],K=0,ee=C;K<ee.length;K+=1){var re=ee[K];F.push({wrappedTileID:re.tileID.wrapped().key,queryResults:re.tile.queryRenderedFeatures(a,i,n._state,re.queryGeometry,re.cameraQueryGeometry,re.scale,f,d,x,ct(n.transform,re.tileID))})}var Pe=function(qe){for(var _e={},Ge={},et=0,St=qe;et<St.length;et+=1){var $t=St[et],Zt=$t.queryResults,rr=$t.wrappedTileID,Sr=Ge[rr]=Ge[rr]||{};for(var Ur in Zt)for(var Br=Zt[Ur],hn=Sr[Ur]=Sr[Ur]||{},Pn=_e[Ur]=_e[Ur]||[],Mn=0,Rn=Br;Mn<Rn.length;Mn+=1){var Ei=Rn[Mn];hn[Ei.featureIndex]||(hn[Ei.featureIndex]=!0,Pn.push(Ei))}}return _e}(F);for(var Ce in Pe)Pe[Ce].forEach(function(qe){var _e=qe.feature,Ge=n.getFeatureState(_e.layer["source-layer"],_e.id);_e.source=_e.layer.source,_e.layer["source-layer"]&&(_e.sourceLayer=_e.layer["source-layer"]),_e.state=Ge});return Pe}function He(n,a){var i=n.tileID,o=a.tileID;return i.overscaledZ-o.overscaledZ||i.canonical.y-o.canonical.y||i.wrap-o.wrap||i.canonical.x-o.canonical.x}var We=function(n,a){this.max=n,this.onRemove=a,this.reset()};We.prototype.reset=function(){for(var n in this.data)for(var a=0,i=this.data[n];a<i.length;a+=1){var o=i[a];o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value)}return this.data={},this.order=[],this},We.prototype.add=function(n,a,i){var o=this,f=n.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);var d={value:a,timeout:void 0};if(i!==void 0&&(d.timeout=setTimeout(function(){o.remove(n,d)},i)),this.data[f].push(d),this.order.push(f),this.order.length>this.max){var v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this},We.prototype.has=function(n){return n.wrapped().key in this.data},We.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},We.prototype._getAndRemoveByKey=function(n){var a=this.data[n].shift();return a.timeout&&clearTimeout(a.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),a.value},We.prototype.getByKey=function(n){var a=this.data[n];return a?a[0].value:null},We.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},We.prototype.remove=function(n,a){if(!this.has(n))return this;var i=n.wrapped().key,o=a===void 0?0:this.data[i].indexOf(a),f=this.data[i][o];return this.data[i].splice(o,1),f.timeout&&clearTimeout(f.timeout),this.data[i].length===0&&delete this.data[i],this.onRemove(f.value),this.order.splice(this.order.indexOf(i),1),this},We.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},We.prototype.filter=function(n){var a=[];for(var i in this.data)for(var o=0,f=this.data[i];o<f.length;o+=1){var d=f[o];n(d.value)||a.push(d)}for(var v=0,x=a;v<x.length;v+=1){var C=x[v];this.remove(C.value.tileID,C)}};var xt=function(n,a,i){this.context=n;var o=n.gl;this.buffer=o.createBuffer(),this.dynamicDraw=Boolean(i),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),o.bufferData(o.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?o.DYNAMIC_DRAW:o.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer};xt.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},xt.prototype.updateData=function(n){var a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},xt.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var jt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Gt=function(n,a,i,o){this.length=a.length,this.attributes=i,this.itemSize=a.bytesPerElement,this.dynamicDraw=o,this.context=n;var f=n.gl;this.buffer=f.createBuffer(),n.bindVertexBuffer.set(this.buffer),f.bufferData(f.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer};Gt.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Gt.prototype.updateData=function(n){var a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,n.arrayBuffer)},Gt.prototype.enableAttributes=function(n,a){for(var i=0;i<this.attributes.length;i++){var o=a.attributes[this.attributes[i].name];o!==void 0&&n.enableVertexAttribArray(o)}},Gt.prototype.setVertexAttribPointers=function(n,a,i){for(var o=0;o<this.attributes.length;o++){var f=this.attributes[o],d=a.attributes[f.name];d!==void 0&&n.vertexAttribPointer(d,f.components,n[jt[f.type]],!1,this.itemSize,f.offset+this.itemSize*(i||0))}},Gt.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Rt=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Rt.prototype.get=function(){return this.current},Rt.prototype.set=function(n){},Rt.prototype.getDefault=function(){return this.default},Rt.prototype.setDefault=function(){this.set(this.default)};var Ar=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return l.Color.transparent},a.prototype.set=function(i){var o=this.current;(i.r!==o.r||i.g!==o.g||i.b!==o.b||i.a!==o.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)},a}(Rt),Gr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 1},a.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)},a}(Rt),er=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 0},a.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)},a}(Rt),$e=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return[!0,!0,!0,!0]},a.prototype.set=function(i){var o=this.current;(i[0]!==o[0]||i[1]!==o[1]||i[2]!==o[2]||i[3]!==o[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)},a}(Rt),rt=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!0},a.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)},a}(Rt),Wt=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 255},a.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)},a}(Rt),Kt=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},a.prototype.set=function(i){var o=this.current;(i.func!==o.func||i.ref!==o.ref||i.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)},a}(Rt),ur=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]},a.prototype.set=function(i){var o=this.current;(i[0]!==o[0]||i[1]!==o[1]||i[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)},a}(Rt),ae=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(i){if(i!==this.current||this.dirty){var o=this.gl;i?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=i,this.dirty=!1}},a}(Rt),z=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return[0,1]},a.prototype.set=function(i){var o=this.current;(i[0]!==o[0]||i[1]!==o[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)},a}(Rt),R=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(i){if(i!==this.current||this.dirty){var o=this.gl;i?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=i,this.dirty=!1}},a}(Rt),j=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.LESS},a.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)},a}(Rt),b=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(i){if(i!==this.current||this.dirty){var o=this.gl;i?o.enable(o.BLEND):o.disable(o.BLEND),this.current=i,this.dirty=!1}},a}(Rt),ce=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var i=this.gl;return[i.ONE,i.ZERO]},a.prototype.set=function(i){var o=this.current;(i[0]!==o[0]||i[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)},a}(Rt),Ye=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return l.Color.transparent},a.prototype.set=function(i){var o=this.current;(i.r!==o.r||i.g!==o.g||i.b!==o.b||i.a!==o.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)},a}(Rt),Pt=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.FUNC_ADD},a.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)},a}(Rt),te=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(i){if(i!==this.current||this.dirty){var o=this.gl;i?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=i,this.dirty=!1}},a}(Rt),he=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.BACK},a.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)},a}(Rt),ve=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.CCW},a.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)},a}(Rt),it=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)},a}(Rt),at=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.TEXTURE0},a.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)},a}(Rt),fe=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]},a.prototype.set=function(i){var o=this.current;(i[0]!==o[0]||i[1]!==o[1]||i[2]!==o[2]||i[3]!==o[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)},a}(Rt),wr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(i){if(i!==this.current||this.dirty){var o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,i),this.current=i,this.dirty=!1}},a}(Rt),Dr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(i){if(i!==this.current||this.dirty){var o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,i),this.current=i,this.dirty=!1}},a}(Rt),Nr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(i){if(i!==this.current||this.dirty){var o=this.gl;o.bindTexture(o.TEXTURE_2D,i),this.current=i,this.dirty=!1}},a}(Rt),yt=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(i){if(i!==this.current||this.dirty){var o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}},a}(Rt),jr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(i){var o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1},a}(Rt),Dn=function(n){function a(i){n.call(this,i),this.vao=i.extVertexArrayObject}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(i){this.vao&&(i!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(i),this.current=i,this.dirty=!1)},a}(Rt),ai=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 4},a.prototype.set=function(i){if(i!==this.current||this.dirty){var o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}},a}(Rt),Mi=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(i){if(i!==this.current||this.dirty){var o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}},a}(Rt),Li=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(i){if(i!==this.current||this.dirty){var o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}},a}(Rt),Kn=function(n){function a(i,o){n.call(this,i),this.context=i,this.parent=o}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a}(Rt),L=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.setDirty=function(){this.dirty=!0},a.prototype.set=function(i){if(i!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}},a}(Kn),N=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.set=function(i){if(i!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,i),this.current=i,this.dirty=!1}},a}(Kn),H=function(n,a,i,o){this.context=n,this.width=a,this.height=i;var f=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new L(n,f),o&&(this.depthAttachment=new N(n,f))};H.prototype.destroy=function(){var n=this.context.gl,a=this.colorAttachment.get();if(a&&n.deleteTexture(a),this.depthAttachment){var i=this.depthAttachment.get();i&&n.deleteRenderbuffer(i)}n.deleteFramebuffer(this.framebuffer)};var ne=function(n,a,i){this.func=n,this.mask=a,this.range=i};ne.ReadOnly=!1,ne.ReadWrite=!0,ne.disabled=new ne(519,ne.ReadOnly,[0,1]);var xe=function(n,a,i,o,f,d){this.test=n,this.ref=a,this.mask=i,this.fail=o,this.depthFail=f,this.pass=d};xe.disabled=new xe({func:519,mask:0},0,0,7680,7680,7680);var Ne=function(n,a,i){this.blendFunction=n,this.blendColor=a,this.mask=i};Ne.disabled=new Ne(Ne.Replace=[1,0],l.Color.transparent,[!1,!1,!1,!1]),Ne.unblended=new Ne(Ne.Replace,l.Color.transparent,[!0,!0,!0,!0]),Ne.alphaBlended=new Ne([1,771],l.Color.transparent,[!0,!0,!0,!0]);var Qe=function(n,a,i){this.enable=n,this.mode=a,this.frontFace=i};Qe.disabled=new Qe(!1,1029,2305),Qe.backCCW=new Qe(!0,1029,2305);var J=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ar(this),this.clearDepth=new Gr(this),this.clearStencil=new er(this),this.colorMask=new $e(this),this.depthMask=new rt(this),this.stencilMask=new Wt(this),this.stencilFunc=new Kt(this),this.stencilOp=new ur(this),this.stencilTest=new ae(this),this.depthRange=new z(this),this.depthTest=new R(this),this.depthFunc=new j(this),this.blend=new b(this),this.blendFunc=new ce(this),this.blendColor=new Ye(this),this.blendEquation=new Pt(this),this.cullFace=new te(this),this.cullFaceSide=new he(this),this.frontFace=new ve(this),this.program=new it(this),this.activeTexture=new at(this),this.viewport=new fe(this),this.bindFramebuffer=new wr(this),this.bindRenderbuffer=new Dr(this),this.bindTexture=new Nr(this),this.bindVertexBuffer=new yt(this),this.bindElementBuffer=new jr(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Dn(this),this.pixelStoreUnpack=new ai(this),this.pixelStoreUnpackPremultiplyAlpha=new Mi(this),this.pixelStoreUnpackFlipY=new Li(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};J.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},J.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},J.prototype.createIndexBuffer=function(n,a){return new xt(this,n,a)},J.prototype.createVertexBuffer=function(n,a,i){return new Gt(this,n,a,i)},J.prototype.createRenderbuffer=function(n,a,i){var o=this.gl,f=o.createRenderbuffer();return this.bindRenderbuffer.set(f),o.renderbufferStorage(o.RENDERBUFFER,n,a,i),this.bindRenderbuffer.set(null),f},J.prototype.createFramebuffer=function(n,a,i){return new H(this,n,a,i)},J.prototype.clear=function(n){var a=n.color,i=n.depth,o=this.gl,f=0;a&&(f|=o.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),i!==void 0&&(f|=o.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),o.clear(f)},J.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},J.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},J.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},J.prototype.setColorMode=function(n){l.deepEqual(n.blendFunction,Ne.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},J.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Me=function(n){function a(i,o,f){var d=this;n.call(this),this.id=i,this.dispatcher=f,this.on("data",function(v){v.dataType==="source"&&v.sourceDataType==="metadata"&&(d._sourceLoaded=!0),d._sourceLoaded&&!d._paused&&v.dataType==="source"&&v.sourceDataType==="content"&&(d.reload(),d.transform&&d.update(d.transform))}),this.on("error",function(){d._sourceErrored=!0}),this._source=function(v,x,C,F){var K=new Ae[x.type](v,x,C,F);if(K.id!==v)throw new Error("Expected Source id to be "+v+" instead of "+K.id);return l.bindAll(["load","abort","unload","serialize","prepare"],K),K}(i,o,f,this),this._tiles={},this._cache=new We(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new l.SourceFeatureState}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.onAdd=function(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(i)},a.prototype.onRemove=function(i){this._source&&this._source.onRemove&&this._source.onRemove(i)},a.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var i in this._tiles){var o=this._tiles[i];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0},a.prototype.getSource=function(){return this._source},a.prototype.pause=function(){this._paused=!0},a.prototype.resume=function(){if(this._paused){var i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform)}},a.prototype._loadTile=function(i,o){return this._source.loadTile(i,o)},a.prototype._unloadTile=function(i){if(this._source.unloadTile)return this._source.unloadTile(i,function(){})},a.prototype._abortTile=function(i){if(this._source.abortTile)return this._source.abortTile(i,function(){})},a.prototype.serialize=function(){return this._source.serialize()},a.prototype.prepare=function(i){for(var o in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var f=this._tiles[o];f.upload(i),f.prepare(this.map.style.imageManager)}},a.prototype.getIds=function(){return l.values(this._tiles).map(function(i){return i.tileID}).sort(bt).map(function(i){return i.key})},a.prototype.getRenderableIds=function(i){var o=this,f=[];for(var d in this._tiles)this._isIdRenderable(d,i)&&f.push(this._tiles[d]);return i?f.sort(function(v,x){var C=v.tileID,F=x.tileID,K=new l.Point(C.canonical.x,C.canonical.y)._rotate(o.transform.angle),ee=new l.Point(F.canonical.x,F.canonical.y)._rotate(o.transform.angle);return C.overscaledZ-F.overscaledZ||ee.y-K.y||ee.x-K.x}).map(function(v){return v.tileID.key}):f.map(function(v){return v.tileID}).sort(bt).map(function(v){return v.key})},a.prototype.hasRenderableParent=function(i){var o=this.findLoadedParent(i,0);return!!o&&this._isIdRenderable(o.tileID.key)},a.prototype._isIdRenderable=function(i,o){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(o||!this._tiles[i].holdingForFade())},a.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var i in this._cache.reset(),this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(i,"reloading")},a.prototype._reloadTile=function(i,o){var f=this._tiles[i];f&&(f.state!=="loading"&&(f.state=o),this._loadTile(f,this._tileLoaded.bind(this,f,i,o)))},a.prototype._tileLoaded=function(i,o,f,d){if(d)return i.state="errored",void(d.status!==404?this._source.fire(new l.ErrorEvent(d,{tile:i})):this.update(this.transform));i.timeAdded=l.browser.now(),f==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(o,i),this.getSource().type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),this._source.fire(new l.Event("data",{dataType:"source",tile:i,coord:i.tileID}))},a.prototype._backfillDEM=function(i){for(var o=this.getRenderableIds(),f=0;f<o.length;f++){var d=o[f];if(i.neighboringTiles&&i.neighboringTiles[d]){var v=this.getTileByID(d);x(i,v),x(v,i)}}function x(C,F){C.needsHillshadePrepare=!0;var K=F.tileID.canonical.x-C.tileID.canonical.x,ee=F.tileID.canonical.y-C.tileID.canonical.y,re=Math.pow(2,C.tileID.canonical.z),Pe=F.tileID.key;K===0&&ee===0||Math.abs(ee)>1||(Math.abs(K)>1&&(Math.abs(K+re)===1?K+=re:Math.abs(K-re)===1&&(K-=re)),F.dem&&C.dem&&(C.dem.backfillBorder(F.dem,K,ee),C.neighboringTiles&&C.neighboringTiles[Pe]&&(C.neighboringTiles[Pe].backfilled=!0)))}},a.prototype.getTile=function(i){return this.getTileByID(i.key)},a.prototype.getTileByID=function(i){return this._tiles[i]},a.prototype._retainLoadedChildren=function(i,o,f,d){for(var v in this._tiles){var x=this._tiles[v];if(!(d[v]||!x.hasData()||x.tileID.overscaledZ<=o||x.tileID.overscaledZ>f)){for(var C=x.tileID;x&&x.tileID.overscaledZ>o+1;){var F=x.tileID.scaledTo(x.tileID.overscaledZ-1);(x=this._tiles[F.key])&&x.hasData()&&(C=F)}for(var K=C;K.overscaledZ>o;)if(i[(K=K.scaledTo(K.overscaledZ-1)).key]){d[C.key]=C;break}}}},a.prototype.findLoadedParent=function(i,o){if(i.key in this._loadedParentTiles){var f=this._loadedParentTiles[i.key];return f&&f.tileID.overscaledZ>=o?f:null}for(var d=i.overscaledZ-1;d>=o;d--){var v=i.scaledTo(d),x=this._getLoadedTile(v);if(x)return x}},a.prototype._getLoadedTile=function(i){var o=this._tiles[i.key];return o&&o.hasData()?o:this._cache.getByKey(i.wrapped().key)},a.prototype.updateCacheSize=function(i){var o=Math.ceil(i.width/this._source.tileSize)+1,f=Math.ceil(i.height/this._source.tileSize)+1,d=Math.floor(o*f*5),v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(v)},a.prototype.handleWrapJump=function(i){var o=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,o){var f={};for(var d in this._tiles){var v=this._tiles[d];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+o),f[v.tileID.key]=v}for(var x in this._tiles=f,this._timers)clearTimeout(this._timers[x]),delete this._timers[x];for(var C in this._tiles)this._setTileReloadTimer(C,this._tiles[C])}},a.prototype.update=function(i){var o=this;if(this.transform=i,this._sourceLoaded&&!this._paused){var f;this.updateCacheSize(i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?f=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Sr){return new l.OverscaledTileID(Sr.canonical.z,Sr.wrap,Sr.canonical.z,Sr.canonical.x,Sr.canonical.y)}):(f=i.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(f=f.filter(function(Sr){return o._source.hasTile(Sr)}))):f=[];var d=i.coveringZoomLevel(this._source),v=Math.max(d-a.maxOverzooming,this._source.minzoom),x=Math.max(d+a.maxUnderzooming,this._source.minzoom),C=this._updateRetainedTiles(f,d);if(gr(this._source.type)){for(var F={},K={},ee=0,re=Object.keys(C);ee<re.length;ee+=1){var Pe=re[ee],Ce=C[Pe],qe=this._tiles[Pe];if(qe&&!(qe.fadeEndTime&&qe.fadeEndTime<=l.browser.now())){var _e=this.findLoadedParent(Ce,v);_e&&(this._addTile(_e.tileID),F[_e.tileID.key]=_e.tileID),K[Pe]=Ce}}for(var Ge in this._retainLoadedChildren(K,d,x,C),F)C[Ge]||(this._coveredTiles[Ge]=!0,C[Ge]=F[Ge])}for(var et in C)this._tiles[et].clearFadeHold();for(var St=0,$t=l.keysDifference(this._tiles,C);St<$t.length;St+=1){var Zt=$t[St],rr=this._tiles[Zt];rr.hasSymbolBuckets&&!rr.holdingForFade()?rr.setHoldDuration(this.map._fadeDuration):rr.hasSymbolBuckets&&!rr.symbolFadeFinished()||this._removeTile(Zt)}this._updateLoadedParentTileCache()}},a.prototype.releaseSymbolFadeTiles=function(){for(var i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(i)},a.prototype._updateRetainedTiles=function(i,o){for(var f={},d={},v=Math.max(o-a.maxOverzooming,this._source.minzoom),x=Math.max(o+a.maxUnderzooming,this._source.minzoom),C={},F=0,K=i;F<K.length;F+=1){var ee=K[F],re=this._addTile(ee);f[ee.key]=ee,re.hasData()||o<this._source.maxzoom&&(C[ee.key]=ee)}this._retainLoadedChildren(C,o,x,f);for(var Pe=0,Ce=i;Pe<Ce.length;Pe+=1){var qe=Ce[Pe],_e=this._tiles[qe.key];if(!_e.hasData()){if(o+1>this._source.maxzoom){var Ge=qe.children(this._source.maxzoom)[0],et=this.getTile(Ge);if(et&&et.hasData()){f[Ge.key]=Ge;continue}}else{var St=qe.children(this._source.maxzoom);if(f[St[0].key]&&f[St[1].key]&&f[St[2].key]&&f[St[3].key])continue}for(var $t=_e.wasRequested(),Zt=qe.overscaledZ-1;Zt>=v;--Zt){var rr=qe.scaledTo(Zt);if(d[rr.key]||(d[rr.key]=!0,!(_e=this.getTile(rr))&&$t&&(_e=this._addTile(rr)),_e&&(f[rr.key]=rr,$t=_e.wasRequested(),_e.hasData())))break}}}return f},a.prototype._updateLoadedParentTileCache=function(){for(var i in this._loadedParentTiles={},this._tiles){for(var o=[],f=void 0,d=this._tiles[i].tileID;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){f=this._loadedParentTiles[d.key];break}o.push(d.key);var v=d.scaledTo(d.overscaledZ-1);if(f=this._getLoadedTile(v))break;d=v}for(var x=0,C=o;x<C.length;x+=1)this._loadedParentTiles[C[x]]=f}},a.prototype._addTile=function(i){var o=this._tiles[i.key];if(o)return o;(o=this._cache.getAndRemove(i))&&(this._setTileReloadTimer(i.key,o),o.tileID=i,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,o)));var f=Boolean(o);return f||(o=new l.Tile(i,this._source.tileSize*i.overscaleFactor()),this._loadTile(o,this._tileLoaded.bind(this,o,i.key,o.state))),o?(o.uses++,this._tiles[i.key]=o,f||this._source.fire(new l.Event("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o):null},a.prototype._setTileReloadTimer=function(i,o){var f=this;i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);var d=o.getExpiryTimeout();d&&(this._timers[i]=setTimeout(function(){f._reloadTile(i,"expired"),delete f._timers[i]},d))},a.prototype._removeTile=function(i){var o=this._tiles[i];o&&(o.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))},a.prototype.clearTiles=function(){for(var i in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(i);this._cache.reset()},a.prototype.tilesIn=function(i,o,f){var d=this,v=[],x=this.transform;if(!x)return v;for(var C=f?x.getCameraQueryGeometry(i):i,F=i.map(function(Zt){return x.pointCoordinate(Zt)}),K=C.map(function(Zt){return x.pointCoordinate(Zt)}),ee=this.getIds(),re=1/0,Pe=1/0,Ce=-1/0,qe=-1/0,_e=0,Ge=K;_e<Ge.length;_e+=1){var et=Ge[_e];re=Math.min(re,et.x),Pe=Math.min(Pe,et.y),Ce=Math.max(Ce,et.x),qe=Math.max(qe,et.y)}for(var St=function(Zt){var rr=d._tiles[ee[Zt]];if(!rr.holdingForFade()){var Sr=rr.tileID,Ur=Math.pow(2,x.zoom-rr.tileID.overscaledZ),Br=o*rr.queryPadding*l.EXTENT/rr.tileSize/Ur,hn=[Sr.getTilePoint(new l.MercatorCoordinate(re,Pe)),Sr.getTilePoint(new l.MercatorCoordinate(Ce,qe))];if(hn[0].x-Br<l.EXTENT&&hn[0].y-Br<l.EXTENT&&hn[1].x+Br>=0&&hn[1].y+Br>=0){var Pn=F.map(function(Rn){return Sr.getTilePoint(Rn)}),Mn=K.map(function(Rn){return Sr.getTilePoint(Rn)});v.push({tile:rr,tileID:Sr,queryGeometry:Pn,cameraQueryGeometry:Mn,scale:Ur})}}},$t=0;$t<ee.length;$t++)St($t);return v},a.prototype.getVisibleCoordinates=function(i){for(var o=this,f=this.getRenderableIds(i).map(function(C){return o._tiles[C].tileID}),d=0,v=f;d<v.length;d+=1){var x=v[d];x.posMatrix=this.transform.calculatePosMatrix(x.toUnwrapped())}return f},a.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(gr(this._source.type))for(var i in this._tiles){var o=this._tiles[i];if(o.fadeEndTime!==void 0&&o.fadeEndTime>=l.browser.now())return!0}return!1},a.prototype.setFeatureState=function(i,o,f){this._state.updateState(i=i||"_geojsonTileLayer",o,f)},a.prototype.removeFeatureState=function(i,o,f){this._state.removeFeatureState(i=i||"_geojsonTileLayer",o,f)},a.prototype.getFeatureState=function(i,o){return this._state.getState(i=i||"_geojsonTileLayer",o)},a.prototype.setDependencies=function(i,o,f){var d=this._tiles[i];d&&d.setDependencies(o,f)},a.prototype.reloadTilesForDependencies=function(i,o){for(var f in this._tiles)this._tiles[f].hasDependency(i,o)&&this._reloadTile(f,"reloading");this._cache.filter(function(d){return!d.hasDependency(i,o)})},a}(l.Evented);function bt(n,a){var i=Math.abs(2*n.wrap)-+(n.wrap<0),o=Math.abs(2*a.wrap)-+(a.wrap<0);return n.overscaledZ-a.overscaledZ||o-i||a.canonical.y-n.canonical.y||a.canonical.x-n.canonical.x}function gr(n){return n==="raster"||n==="image"||n==="video"}function zt(){return new l.window.Worker(Mu.workerUrl)}Me.maxOverzooming=10,Me.maxUnderzooming=3;var Nt="mapboxgl_preloaded_worker_pool",br=function(){this.active={}};br.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<br.workerCount;)this.workers.push(new zt);return this.active[n]=!0,this.workers.slice()},br.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)},br.prototype.isPreloaded=function(){return!!this.active[Nt]},br.prototype.numActive=function(){return Object.keys(this.active).length};var vn,cn=Math.floor(l.browser.hardwareConcurrency/2);function Lt(){return vn||(vn=new br),vn}function on(n,a){var i={};for(var o in n)o!=="ref"&&(i[o]=n[o]);return l.refProperties.forEach(function(f){f in a&&(i[f]=a[f])}),i}function qr(n){n=n.slice();for(var a=Object.create(null),i=0;i<n.length;i++)a[n[i].id]=n[i];for(var o=0;o<n.length;o++)"ref"in n[o]&&(n[o]=on(n[o],a[n[o].ref]));return n}br.workerCount=Math.max(Math.min(cn,6),1);var Yr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function $n(n,a,i){i.push({command:Yr.addSource,args:[n,a[n]]})}function $r(n,a,i){a.push({command:Yr.removeSource,args:[n]}),i[n]=!0}function hi(n,a,i,o){$r(n,i,o),$n(n,a,i)}function Oi(n,a,i){var o;for(o in n[i])if(n[i].hasOwnProperty(o)&&o!=="data"&&!l.deepEqual(n[i][o],a[i][o]))return!1;for(o in a[i])if(a[i].hasOwnProperty(o)&&o!=="data"&&!l.deepEqual(n[i][o],a[i][o]))return!1;return!0}function Qn(n,a,i,o,f,d){var v;for(v in a=a||{},n=n||{})n.hasOwnProperty(v)&&(l.deepEqual(n[v],a[v])||i.push({command:d,args:[o,v,a[v],f]}));for(v in a)a.hasOwnProperty(v)&&!n.hasOwnProperty(v)&&(l.deepEqual(n[v],a[v])||i.push({command:d,args:[o,v,a[v],f]}))}function fi(n){return n.id}function ei(n,a){return n[a.id]=a,n}var zn=function(n,a){this.reset(n,a)};zn.prototype.reset=function(n,a){this.points=n||[],this._distances=[0];for(var i=1;i<this.points.length;i++)this._distances[i]=this._distances[i-1]+this.points[i].dist(this.points[i-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding},zn.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=l.clamp(n,0,1);for(var a=1,i=this._distances[a],o=n*this.paddedLength+this.padding;i<o&&a<this._distances.length;)i=this._distances[++a];var f=a-1,d=this._distances[f],v=i-d,x=v>0?(o-d)/v:0;return this.points[f].mult(1-x).add(this.points[a].mult(x))};var Wn=function(n,a,i){var o=this.boxCells=[],f=this.circleCells=[];this.xCellCount=Math.ceil(n/i),this.yCellCount=Math.ceil(a/i);for(var d=0;d<this.xCellCount*this.yCellCount;d++)o.push([]),f.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=a,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0};function Qi(n,a,i,o,f){var d=l.create();return a?(l.scale(d,d,[1/f,1/f,1]),i||l.rotateZ(d,d,o.angle)):l.multiply(d,o.labelPlaneMatrix,n),d}function _i(n,a,i,o,f){if(a){var d=l.clone(n);return l.scale(d,d,[f,f,1]),i||l.rotateZ(d,d,-o.angle),d}return o.glCoordMatrix}function di(n,a){var i=[n.x,n.y,0,1];na(i,i,a);var o=i[3];return{point:new l.Point(i[0]/o,i[1]/o),signedDistanceFromCamera:o}}function vi(n,a){return .5+n/a*.5}function oa(n,a){var i=n[0]/n[3],o=n[1]/n[3];return i>=-a[0]&&i<=a[0]&&o>=-a[1]&&o<=a[1]}function ns(n,a,i,o,f,d,v,x){var C=o?n.textSizeData:n.iconSizeData,F=l.evaluateSizeForZoom(C,i.transform.zoom),K=[256/i.width*2+1,256/i.height*2+1],ee=o?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;ee.clear();for(var re=n.lineVertexArray,Pe=o?n.text.placedSymbolArray:n.icon.placedSymbolArray,Ce=i.transform.width/i.transform.height,qe=!1,_e=0;_e<Pe.length;_e++){var Ge=Pe.get(_e);if(Ge.hidden||Ge.writingMode===l.WritingMode.vertical&&!qe)ya(Ge.numGlyphs,ee);else{qe=!1;var et=[Ge.anchorX,Ge.anchorY,0,1];if(l.transformMat4(et,et,a),oa(et,K)){var St=vi(i.transform.cameraToCenterDistance,et[3]),$t=l.evaluateSizeForFeature(C,F,Ge),Zt=v?$t/St:$t*St,rr=new l.Point(Ge.anchorX,Ge.anchorY),Sr=di(rr,f).point,Ur={},Br=yo(Ge,Zt,!1,x,a,f,d,n.glyphOffsetArray,re,ee,Sr,rr,Ur,Ce);qe=Br.useVertical,(Br.notEnoughRoom||qe||Br.needsFlipping&&yo(Ge,Zt,!0,x,a,f,d,n.glyphOffsetArray,re,ee,Sr,rr,Ur,Ce).notEnoughRoom)&&ya(Ge.numGlyphs,ee)}else ya(Ge.numGlyphs,ee)}}o?n.text.dynamicLayoutVertexBuffer.updateData(ee):n.icon.dynamicLayoutVertexBuffer.updateData(ee)}function ea(n,a,i,o,f,d,v,x,C,F,K){var ee=x.glyphStartIndex+x.numGlyphs,re=x.lineStartIndex,Pe=x.lineStartIndex+x.lineLength,Ce=a.getoffsetX(x.glyphStartIndex),qe=a.getoffsetX(ee-1),_e=Di(n*Ce,i,o,f,d,v,x.segment,re,Pe,C,F,K);if(!_e)return null;var Ge=Di(n*qe,i,o,f,d,v,x.segment,re,Pe,C,F,K);return Ge?{first:_e,last:Ge}:null}function zi(n,a,i,o){return n===l.WritingMode.horizontal&&Math.abs(i.y-a.y)>Math.abs(i.x-a.x)*o?{useVertical:!0}:(n===l.WritingMode.vertical?a.y<i.y:a.x>i.x)?{needsFlipping:!0}:null}function yo(n,a,i,o,f,d,v,x,C,F,K,ee,re,Pe){var Ce,qe=a/24,_e=n.lineOffsetX*qe,Ge=n.lineOffsetY*qe;if(n.numGlyphs>1){var et=n.glyphStartIndex+n.numGlyphs,St=n.lineStartIndex,$t=n.lineStartIndex+n.lineLength,Zt=ea(qe,x,_e,Ge,i,K,ee,n,C,d,re);if(!Zt)return{notEnoughRoom:!0};var rr=di(Zt.first.point,v).point,Sr=di(Zt.last.point,v).point;if(o&&!i){var Ur=zi(n.writingMode,rr,Sr,Pe);if(Ur)return Ur}Ce=[Zt.first];for(var Br=n.glyphStartIndex+1;Br<et-1;Br++)Ce.push(Di(qe*x.getoffsetX(Br),_e,Ge,i,K,ee,n.segment,St,$t,C,d,re));Ce.push(Zt.last)}else{if(o&&!i){var hn=di(ee,f).point,Pn=n.lineStartIndex+n.segment+1,Mn=new l.Point(C.getx(Pn),C.gety(Pn)),Rn=di(Mn,f),Ei=Rn.signedDistanceFromCamera>0?Rn.point:$a(ee,Mn,hn,1,f),fn=zi(n.writingMode,hn,Ei,Pe);if(fn)return fn}var Jn=Di(qe*x.getoffsetX(n.glyphStartIndex),_e,Ge,i,K,ee,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,C,d,re);if(!Jn)return{notEnoughRoom:!0};Ce=[Jn]}for(var ni=0,qn=Ce;ni<qn.length;ni+=1){var Bn=qn[ni];l.addDynamicAttributes(F,Bn.point,Bn.angle)}return{}}function $a(n,a,i,o,f){var d=di(n.add(n.sub(a)._unit()),f).point,v=i.sub(d);return i.add(v._mult(o/v.mag()))}function Di(n,a,i,o,f,d,v,x,C,F,K,ee){var re=o?n-a:n+a,Pe=re>0?1:-1,Ce=0;o&&(Pe*=-1,Ce=Math.PI),Pe<0&&(Ce+=Math.PI);for(var qe=Pe>0?x+v:x+v+1,_e=f,Ge=f,et=0,St=0,$t=Math.abs(re),Zt=[];et+St<=$t;){if((qe+=Pe)<x||qe>=C)return null;if(Ge=_e,Zt.push(_e),(_e=ee[qe])===void 0){var rr=new l.Point(F.getx(qe),F.gety(qe)),Sr=di(rr,K);if(Sr.signedDistanceFromCamera>0)_e=ee[qe]=Sr.point;else{var Ur=qe-Pe;_e=$a(et===0?d:new l.Point(F.getx(Ur),F.gety(Ur)),rr,Ge,$t-et+1,K)}}et+=St,St=Ge.dist(_e)}var Br=($t-et)/St,hn=_e.sub(Ge),Pn=hn.mult(Br)._add(Ge);Pn._add(hn._unit()._perp()._mult(i*Pe));var Mn=Ce+Math.atan2(_e.y-Ge.y,_e.x-Ge.x);return Zt.push(Pn),{point:Pn,angle:Mn,path:Zt}}Wn.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Wn.prototype.insert=function(n,a,i,o,f){this._forEachCell(a,i,o,f,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(a),this.bboxes.push(i),this.bboxes.push(o),this.bboxes.push(f)},Wn.prototype.insertCircle=function(n,a,i,o){this._forEachCell(a-o,i-o,a+o,i+o,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(a),this.circles.push(i),this.circles.push(o)},Wn.prototype._insertBoxCell=function(n,a,i,o,f,d){this.boxCells[f].push(d)},Wn.prototype._insertCircleCell=function(n,a,i,o,f,d){this.circleCells[f].push(d)},Wn.prototype._query=function(n,a,i,o,f,d){if(i<0||n>this.width||o<0||a>this.height)return!f&&[];var v=[];if(n<=0&&a<=0&&this.width<=i&&this.height<=o){if(f)return!0;for(var x=0;x<this.boxKeys.length;x++)v.push({key:this.boxKeys[x],x1:this.bboxes[4*x],y1:this.bboxes[4*x+1],x2:this.bboxes[4*x+2],y2:this.bboxes[4*x+3]});for(var C=0;C<this.circleKeys.length;C++){var F=this.circles[3*C],K=this.circles[3*C+1],ee=this.circles[3*C+2];v.push({key:this.circleKeys[C],x1:F-ee,y1:K-ee,x2:F+ee,y2:K+ee})}return d?v.filter(d):v}return this._forEachCell(n,a,i,o,this._queryCell,v,{hitTest:f,seenUids:{box:{},circle:{}}},d),f?v.length>0:v},Wn.prototype._queryCircle=function(n,a,i,o,f){var d=n-i,v=n+i,x=a-i,C=a+i;if(v<0||d>this.width||C<0||x>this.height)return!o&&[];var F=[];return this._forEachCell(d,x,v,C,this._queryCellCircle,F,{hitTest:o,circle:{x:n,y:a,radius:i},seenUids:{box:{},circle:{}}},f),o?F.length>0:F},Wn.prototype.query=function(n,a,i,o,f){return this._query(n,a,i,o,!1,f)},Wn.prototype.hitTest=function(n,a,i,o,f){return this._query(n,a,i,o,!0,f)},Wn.prototype.hitTestCircle=function(n,a,i,o){return this._queryCircle(n,a,i,!0,o)},Wn.prototype._queryCell=function(n,a,i,o,f,d,v,x){var C=v.seenUids,F=this.boxCells[f];if(F!==null)for(var K=this.bboxes,ee=0,re=F;ee<re.length;ee+=1){var Pe=re[ee];if(!C.box[Pe]){C.box[Pe]=!0;var Ce=4*Pe;if(n<=K[Ce+2]&&a<=K[Ce+3]&&i>=K[Ce+0]&&o>=K[Ce+1]&&(!x||x(this.boxKeys[Pe]))){if(v.hitTest)return d.push(!0),!0;d.push({key:this.boxKeys[Pe],x1:K[Ce],y1:K[Ce+1],x2:K[Ce+2],y2:K[Ce+3]})}}}var qe=this.circleCells[f];if(qe!==null)for(var _e=this.circles,Ge=0,et=qe;Ge<et.length;Ge+=1){var St=et[Ge];if(!C.circle[St]){C.circle[St]=!0;var $t=3*St;if(this._circleAndRectCollide(_e[$t],_e[$t+1],_e[$t+2],n,a,i,o)&&(!x||x(this.circleKeys[St]))){if(v.hitTest)return d.push(!0),!0;var Zt=_e[$t],rr=_e[$t+1],Sr=_e[$t+2];d.push({key:this.circleKeys[St],x1:Zt-Sr,y1:rr-Sr,x2:Zt+Sr,y2:rr+Sr})}}}},Wn.prototype._queryCellCircle=function(n,a,i,o,f,d,v,x){var C=v.circle,F=v.seenUids,K=this.boxCells[f];if(K!==null)for(var ee=this.bboxes,re=0,Pe=K;re<Pe.length;re+=1){var Ce=Pe[re];if(!F.box[Ce]){F.box[Ce]=!0;var qe=4*Ce;if(this._circleAndRectCollide(C.x,C.y,C.radius,ee[qe+0],ee[qe+1],ee[qe+2],ee[qe+3])&&(!x||x(this.boxKeys[Ce])))return d.push(!0),!0}}var _e=this.circleCells[f];if(_e!==null)for(var Ge=this.circles,et=0,St=_e;et<St.length;et+=1){var $t=St[et];if(!F.circle[$t]){F.circle[$t]=!0;var Zt=3*$t;if(this._circlesCollide(Ge[Zt],Ge[Zt+1],Ge[Zt+2],C.x,C.y,C.radius)&&(!x||x(this.circleKeys[$t])))return d.push(!0),!0}}},Wn.prototype._forEachCell=function(n,a,i,o,f,d,v,x){for(var C=this._convertToXCellCoord(n),F=this._convertToYCellCoord(a),K=this._convertToXCellCoord(i),ee=this._convertToYCellCoord(o),re=C;re<=K;re++)for(var Pe=F;Pe<=ee;Pe++)if(f.call(this,n,a,i,o,this.xCellCount*Pe+re,d,v,x))return},Wn.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},Wn.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},Wn.prototype._circlesCollide=function(n,a,i,o,f,d){var v=o-n,x=f-a,C=i+d;return C*C>v*v+x*x},Wn.prototype._circleAndRectCollide=function(n,a,i,o,f,d,v){var x=(d-o)/2,C=Math.abs(n-(o+x));if(C>x+i)return!1;var F=(v-f)/2,K=Math.abs(a-(f+F));if(K>F+i)return!1;if(C<=x||K<=F)return!0;var ee=C-x,re=K-F;return ee*ee+re*re<=i*i};var So=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ya(n,a){for(var i=0;i<n;i++){var o=a.length;a.resize(o+4),a.float32.set(So,3*o)}}function na(n,a,i){var o=a[0],f=a[1];return n[0]=i[0]*o+i[4]*f+i[12],n[1]=i[1]*o+i[5]*f+i[13],n[3]=i[3]*o+i[7]*f+i[15],n}var ga=function(n,a,i){a===void 0&&(a=new Wn(n.width+200,n.height+200,25)),i===void 0&&(i=new Wn(n.width+200,n.height+200,25)),this.transform=n,this.grid=a,this.ignoredGrid=i,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function Bi(n,a,i){return a*(l.EXTENT/(n.tileSize*Math.pow(2,i-n.tileID.overscaledZ)))}ga.prototype.placeCollisionBox=function(n,a,i,o,f){var d=this.projectAndGetPerspectiveRatio(o,n.anchorPointX,n.anchorPointY),v=i*d.perspectiveRatio,x=n.x1*v+d.point.x,C=n.y1*v+d.point.y,F=n.x2*v+d.point.x,K=n.y2*v+d.point.y;return!this.isInsideGrid(x,C,F,K)||!a&&this.grid.hitTest(x,C,F,K,f)?{box:[],offscreen:!1}:{box:[x,C,F,K],offscreen:this.isOffscreen(x,C,F,K)}},ga.prototype.placeCollisionCircles=function(n,a,i,o,f,d,v,x,C,F,K,ee,re){var Pe=[],Ce=new l.Point(a.anchorX,a.anchorY),qe=di(Ce,d),_e=vi(this.transform.cameraToCenterDistance,qe.signedDistanceFromCamera),Ge=(F?f/_e:f*_e)/l.ONE_EM,et=di(Ce,v).point,St=ea(Ge,o,a.lineOffsetX*Ge,a.lineOffsetY*Ge,!1,et,Ce,a,i,v,{}),$t=!1,Zt=!1,rr=!0;if(St){for(var Sr=.5*ee*_e+re,Ur=new l.Point(-100,-100),Br=new l.Point(this.screenRightBoundary,this.screenBottomBoundary),hn=new zn,Pn=St.first,Mn=St.last,Rn=[],Ei=Pn.path.length-1;Ei>=1;Ei--)Rn.push(Pn.path[Ei]);for(var fn=1;fn<Mn.path.length;fn++)Rn.push(Mn.path[fn]);var Jn=2.5*Sr;if(x){var ni=Rn.map(function(ds){return di(ds,x)});Rn=ni.some(function(ds){return ds.signedDistanceFromCamera<=0})?[]:ni.map(function(ds){return ds.point})}var qn=[];if(Rn.length>0){for(var Bn=Rn[0].clone(),oi=Rn[0].clone(),Vn=1;Vn<Rn.length;Vn++)Bn.x=Math.min(Bn.x,Rn[Vn].x),Bn.y=Math.min(Bn.y,Rn[Vn].y),oi.x=Math.max(oi.x,Rn[Vn].x),oi.y=Math.max(oi.y,Rn[Vn].y);qn=Bn.x>=Ur.x&&oi.x<=Br.x&&Bn.y>=Ur.y&&oi.y<=Br.y?[Rn]:oi.x<Ur.x||Bn.x>Br.x||oi.y<Ur.y||Bn.y>Br.y?[]:l.clipLine([Rn],Ur.x,Ur.y,Br.x,Br.y)}for(var Nn=0,Ha=qn;Nn<Ha.length;Nn+=1){var Ca;hn.reset(Ha[Nn],.25*Sr),Ca=hn.length<=.5*Sr?1:Math.ceil(hn.paddedLength/Jn)+1;for(var co=0;co<Ca;co++){var ho=co/Math.max(Ca-1,1),Ia=hn.lerp(ho),Na=Ia.x+100,Qo=Ia.y+100;Pe.push(Na,Qo,Sr,0);var zo=Na-Sr,tu=Qo-Sr,Bo=Na+Sr,Is=Qo+Sr;if(rr=rr&&this.isOffscreen(zo,tu,Bo,Is),Zt=Zt||this.isInsideGrid(zo,tu,Bo,Is),!n&&this.grid.hitTestCircle(Na,Qo,Sr,K)&&($t=!0,!C))return{circles:[],offscreen:!1,collisionDetected:$t}}}}return{circles:!C&&$t||!Zt?[]:Pe,offscreen:rr,collisionDetected:$t}},ga.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var a=[],i=1/0,o=1/0,f=-1/0,d=-1/0,v=0,x=n;v<x.length;v+=1){var C=x[v],F=new l.Point(C.x+100,C.y+100);i=Math.min(i,F.x),o=Math.min(o,F.y),f=Math.max(f,F.x),d=Math.max(d,F.y),a.push(F)}for(var K={},ee={},re=0,Pe=this.grid.query(i,o,f,d).concat(this.ignoredGrid.query(i,o,f,d));re<Pe.length;re+=1){var Ce=Pe[re],qe=Ce.key;if(K[qe.bucketInstanceId]===void 0&&(K[qe.bucketInstanceId]={}),!K[qe.bucketInstanceId][qe.featureIndex]){var _e=[new l.Point(Ce.x1,Ce.y1),new l.Point(Ce.x2,Ce.y1),new l.Point(Ce.x2,Ce.y2),new l.Point(Ce.x1,Ce.y2)];l.polygonIntersectsPolygon(a,_e)&&(K[qe.bucketInstanceId][qe.featureIndex]=!0,ee[qe.bucketInstanceId]===void 0&&(ee[qe.bucketInstanceId]=[]),ee[qe.bucketInstanceId].push(qe.featureIndex))}}return ee},ga.prototype.insertCollisionBox=function(n,a,i,o,f){(a?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:o,collisionGroupID:f},n[0],n[1],n[2],n[3])},ga.prototype.insertCollisionCircles=function(n,a,i,o,f){for(var d=a?this.ignoredGrid:this.grid,v={bucketInstanceId:i,featureIndex:o,collisionGroupID:f},x=0;x<n.length;x+=4)d.insertCircle(v,n[x],n[x+1],n[x+2])},ga.prototype.projectAndGetPerspectiveRatio=function(n,a,i){var o=[a,i,0,1];return na(o,o,n),{point:new l.Point((o[0]/o[3]+1)/2*this.transform.width+100,(-o[1]/o[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/o[3]*.5}},ga.prototype.isOffscreen=function(n,a,i,o){return i<100||n>=this.screenRightBoundary||o<100||a>this.screenBottomBoundary},ga.prototype.isInsideGrid=function(n,a,i,o){return i>=0&&n<this.gridRightBoundary&&o>=0&&a<this.gridBottomBoundary},ga.prototype.getViewportMatrix=function(){var n=l.identity([]);return l.translate(n,n,[-100,-100,0]),n};var wa=function(n,a,i,o){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?a:-a))):o&&i?1:0,this.placed=i};wa.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Qa=function(n,a,i,o,f){this.text=new wa(n?n.text:null,a,i,f),this.icon=new wa(n?n.icon:null,a,o,f)};Qa.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var _s=function(n,a,i){this.text=n,this.icon=a,this.skipFade=i},Ga=function(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]},eo=function(n,a,i,o,f){this.bucketInstanceId=n,this.featureIndex=a,this.sourceLayerIndex=i,this.bucketIndex=o,this.tileID=f},Hi=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function Pa(n,a,i,o,f){var d=l.getAnchorAlignment(n),v=-(d.horizontalAlign-.5)*a,x=-(d.verticalAlign-.5)*i,C=l.evaluateVariableOffset(n,o);return new l.Point(v+C[0]*f,x+C[1]*f)}function go(n,a,i,o,f,d){var v=n.x1,x=n.x2,C=n.y1,F=n.y2,K=n.anchorPointX,ee=n.anchorPointY,re=new l.Point(a,i);return o&&re._rotate(f?d:-d),{x1:v+re.x,y1:C+re.y,x2:x+re.x,y2:F+re.y,anchorPointX:K,anchorPointY:ee}}Hi.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var a=++this.maxGroupID;this.collisionGroups[n]={ID:a,predicate:function(i){return i.collisionGroupID===a}}}return this.collisionGroups[n]};var Ma=function(n,a,i,o){this.transform=n.clone(),this.collisionIndex=new ga(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=a,this.retainedQueryData={},this.collisionGroups=new Hi(i),this.collisionCircleArrays={},this.prevPlacement=o,o&&(o.prevPlacement=void 0),this.placedOrientations={}};function ls(n,a,i,o,f){n.emplaceBack(a?1:0,i?1:0,o||0,f||0),n.emplaceBack(a?1:0,i?1:0,o||0,f||0),n.emplaceBack(a?1:0,i?1:0,o||0,f||0),n.emplaceBack(a?1:0,i?1:0,o||0,f||0)}Ma.prototype.getBucketParts=function(n,a,i,o){var f=i.getBucket(a),d=i.latestFeatureIndex;if(f&&d&&a.id===f.layerIds[0]){var v=i.collisionBoxArray,x=f.layers[0].layout,C=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),F=i.tileSize/l.EXTENT,K=this.transform.calculatePosMatrix(i.tileID.toUnwrapped()),ee=x.get("text-pitch-alignment")==="map",re=x.get("text-rotation-alignment")==="map",Pe=Bi(i,1,this.transform.zoom),Ce=Qi(K,ee,re,this.transform,Pe),qe=null;if(ee){var _e=_i(K,ee,re,this.transform,Pe);qe=l.multiply([],this.transform.labelPlaneMatrix,_e)}this.retainedQueryData[f.bucketInstanceId]=new eo(f.bucketInstanceId,d,f.sourceLayerIndex,f.index,i.tileID);var Ge={bucket:f,layout:x,posMatrix:K,textLabelPlaneMatrix:Ce,labelToScreenMatrix:qe,scale:C,textPixelRatio:F,holdingForFade:i.holdingForFade(),collisionBoxArray:v,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(f.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(f.sourceID)};if(o)for(var et=0,St=f.sortKeyRanges;et<St.length;et+=1){var $t=St[et];n.push({sortKey:$t.sortKey,symbolInstanceStart:$t.symbolInstanceStart,symbolInstanceEnd:$t.symbolInstanceEnd,parameters:Ge})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:f.symbolInstances.length,parameters:Ge})}},Ma.prototype.attemptAnchorPlacement=function(n,a,i,o,f,d,v,x,C,F,K,ee,re,Pe,Ce){var qe,_e=[ee.textOffset0,ee.textOffset1],Ge=Pa(n,i,o,_e,f),et=this.collisionIndex.placeCollisionBox(go(a,Ge.x,Ge.y,d,v,this.transform.angle),K,x,C,F.predicate);if(!Ce||this.collisionIndex.placeCollisionBox(go(Ce,Ge.x,Ge.y,d,v,this.transform.angle),K,x,C,F.predicate).box.length!==0)return et.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[ee.crossTileID]&&this.prevPlacement.placements[ee.crossTileID]&&this.prevPlacement.placements[ee.crossTileID].text&&(qe=this.prevPlacement.variableOffsets[ee.crossTileID].anchor),this.variableOffsets[ee.crossTileID]={textOffset:_e,width:i,height:o,anchor:n,textBoxScale:f,prevAnchor:qe},this.markUsedJustification(re,n,ee,Pe),re.allowVerticalPlacement&&(this.markUsedOrientation(re,Pe,ee),this.placedOrientations[ee.crossTileID]=Pe),{shift:Ge,placedGlyphBoxes:et}):void 0},Ma.prototype.placeLayerBucketPart=function(n,a,i){var o=this,f=n.parameters,d=f.bucket,v=f.layout,x=f.posMatrix,C=f.textLabelPlaneMatrix,F=f.labelToScreenMatrix,K=f.textPixelRatio,ee=f.holdingForFade,re=f.collisionBoxArray,Pe=f.partiallyEvaluatedTextSize,Ce=f.collisionGroup,qe=v.get("text-optional"),_e=v.get("icon-optional"),Ge=v.get("text-allow-overlap"),et=v.get("icon-allow-overlap"),St=v.get("text-rotation-alignment")==="map",$t=v.get("text-pitch-alignment")==="map",Zt=v.get("icon-text-fit")!=="none",rr=v.get("symbol-z-order")==="viewport-y",Sr=Ge&&(et||!d.hasIconData()||_e),Ur=et&&(Ge||!d.hasTextData()||qe);!d.collisionArrays&&re&&d.deserializeCollisionBoxes(re);var Br=function(fn,Jn){if(!a[fn.crossTileID])if(ee)o.placements[fn.crossTileID]=new _s(!1,!1,!1);else{var ni,qn=!1,Bn=!1,oi=!0,Vn=null,Nn={box:null,offscreen:null},Ha={box:null,offscreen:null},Ca=null,co=null,ho=0,Ia=0,Na=0;Jn.textFeatureIndex?ho=Jn.textFeatureIndex:fn.useRuntimeCollisionCircles&&(ho=fn.featureIndex),Jn.verticalTextFeatureIndex&&(Ia=Jn.verticalTextFeatureIndex);var Qo=Jn.textBox;if(Qo){var zo=function(qi){var os=l.WritingMode.horizontal;if(d.allowVerticalPlacement&&!qi&&o.prevPlacement){var No=o.prevPlacement.placedOrientations[fn.crossTileID];No&&(o.placedOrientations[fn.crossTileID]=No,o.markUsedOrientation(d,os=No,fn))}return os},tu=function(qi,os){if(d.allowVerticalPlacement&&fn.numVerticalGlyphVertices>0&&Jn.verticalTextBox)for(var No=0,_u=d.writingModes;No<_u.length&&(_u[No]===l.WritingMode.vertical?(Nn=os(),Ha=Nn):Nn=qi(),!(Nn&&Nn.box&&Nn.box.length));No+=1);else Nn=qi()};if(v.get("text-variable-anchor")){var Bo=v.get("text-variable-anchor");if(o.prevPlacement&&o.prevPlacement.variableOffsets[fn.crossTileID]){var Is=o.prevPlacement.variableOffsets[fn.crossTileID];Bo.indexOf(Is.anchor)>0&&(Bo=Bo.filter(function(qi){return qi!==Is.anchor})).unshift(Is.anchor)}var ds=function(qi,os,No){for(var _u=qi.x2-qi.x1,Fl=qi.y2-qi.y1,zl=fn.textBoxScale,ec=Zt&&!et?os:null,ms={box:[],offscreen:!1},vl=Ge?2*Bo.length:Bo.length,Ps=0;Ps<vl;++Ps){var Lu=o.attemptAnchorPlacement(Bo[Ps%Bo.length],qi,_u,Fl,zl,St,$t,K,x,Ce,Ps>=Bo.length,fn,d,No,ec);if(Lu&&(ms=Lu.placedGlyphBoxes)&&ms.box&&ms.box.length){qn=!0,Vn=Lu.shift;break}}return ms};tu(function(){return ds(Qo,Jn.iconBox,l.WritingMode.horizontal)},function(){var qi=Jn.verticalTextBox;return d.allowVerticalPlacement&&!(Nn&&Nn.box&&Nn.box.length)&&fn.numVerticalGlyphVertices>0&&qi?ds(qi,Jn.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null}}),Nn&&(qn=Nn.box,oi=Nn.offscreen);var dl=zo(Nn&&Nn.box);if(!qn&&o.prevPlacement){var Zu=o.prevPlacement.variableOffsets[fn.crossTileID];Zu&&(o.variableOffsets[fn.crossTileID]=Zu,o.markUsedJustification(d,Zu.anchor,fn,dl))}}else{var ru=function(qi,os){var No=o.collisionIndex.placeCollisionBox(qi,Ge,K,x,Ce.predicate);return No&&No.box&&No.box.length&&(o.markUsedOrientation(d,os,fn),o.placedOrientations[fn.crossTileID]=os),No};tu(function(){return ru(Qo,l.WritingMode.horizontal)},function(){var qi=Jn.verticalTextBox;return d.allowVerticalPlacement&&fn.numVerticalGlyphVertices>0&&qi?ru(qi,l.WritingMode.vertical):{box:null,offscreen:null}}),zo(Nn&&Nn.box&&Nn.box.length)}}if(qn=(ni=Nn)&&ni.box&&ni.box.length>0,oi=ni&&ni.offscreen,fn.useRuntimeCollisionCircles){var Hu=d.text.placedSymbolArray.get(fn.centerJustifiedTextSymbolIndex),ml=l.evaluateSizeForFeature(d.textSizeData,Pe,Hu),ks=v.get("text-padding");Ca=o.collisionIndex.placeCollisionCircles(Ge,Hu,d.lineVertexArray,d.glyphOffsetArray,ml,x,C,F,i,$t,Ce.predicate,fn.collisionCircleDiameter,ks),qn=Ge||Ca.circles.length>0&&!Ca.collisionDetected,oi=oi&&Ca.offscreen}if(Jn.iconFeatureIndex&&(Na=Jn.iconFeatureIndex),Jn.iconBox){var Wu=function(qi){var os=Zt&&Vn?go(qi,Vn.x,Vn.y,St,$t,o.transform.angle):qi;return o.collisionIndex.placeCollisionBox(os,et,K,x,Ce.predicate)};Bn=Ha&&Ha.box&&Ha.box.length&&Jn.verticalIconBox?(co=Wu(Jn.verticalIconBox)).box.length>0:(co=Wu(Jn.iconBox)).box.length>0,oi=oi&&co.offscreen}var Fs=qe||fn.numHorizontalGlyphVertices===0&&fn.numVerticalGlyphVertices===0,Wa=_e||fn.numIconVertices===0;if(Fs||Wa?Wa?Fs||(Bn=Bn&&qn):qn=Bn&&qn:Bn=qn=Bn&&qn,qn&&ni&&ni.box&&o.collisionIndex.insertCollisionBox(ni.box,v.get("text-ignore-placement"),d.bucketInstanceId,Ha&&Ha.box&&Ia?Ia:ho,Ce.ID),Bn&&co&&o.collisionIndex.insertCollisionBox(co.box,v.get("icon-ignore-placement"),d.bucketInstanceId,Na,Ce.ID),Ca&&(qn&&o.collisionIndex.insertCollisionCircles(Ca.circles,v.get("text-ignore-placement"),d.bucketInstanceId,ho,Ce.ID),i)){var nu=d.bucketInstanceId,yu=o.collisionCircleArrays[nu];yu===void 0&&(yu=o.collisionCircleArrays[nu]=new Ga);for(var gu=0;gu<Ca.circles.length;gu+=4)yu.circles.push(Ca.circles[gu+0]),yu.circles.push(Ca.circles[gu+1]),yu.circles.push(Ca.circles[gu+2]),yu.circles.push(Ca.collisionDetected?1:0)}o.placements[fn.crossTileID]=new _s(qn||Sr,Bn||Ur,oi||d.justReloaded),a[fn.crossTileID]=!0}};if(rr)for(var hn=d.getSortedSymbolIndexes(this.transform.angle),Pn=hn.length-1;Pn>=0;--Pn){var Mn=hn[Pn];Br(d.symbolInstances.get(Mn),d.collisionArrays[Mn])}else for(var Rn=n.symbolInstanceStart;Rn<n.symbolInstanceEnd;Rn++)Br(d.symbolInstances.get(Rn),d.collisionArrays[Rn]);if(i&&d.bucketInstanceId in this.collisionCircleArrays){var Ei=this.collisionCircleArrays[d.bucketInstanceId];l.invert(Ei.invProjMatrix,x),Ei.viewportMatrix=this.collisionIndex.getViewportMatrix()}d.justReloaded=!1},Ma.prototype.markUsedJustification=function(n,a,i,o){var f;f=o===l.WritingMode.vertical?i.verticalPlacedTextSymbolIndex:{left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex}[l.getAnchorJustification(a)];for(var d=0,v=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];d<v.length;d+=1){var x=v[d];x>=0&&(n.text.placedSymbolArray.get(x).crossTileID=f>=0&&x!==f?0:i.crossTileID)}},Ma.prototype.markUsedOrientation=function(n,a,i){for(var o=a===l.WritingMode.horizontal||a===l.WritingMode.horizontalOnly?a:0,f=a===l.WritingMode.vertical?a:0,d=0,v=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];d<v.length;d+=1)n.text.placedSymbolArray.get(v[d]).placedOrientation=o;i.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=f)},Ma.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var a=this.prevPlacement,i=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;var o=a?a.symbolFadeChange(n):1,f=a?a.opacities:{},d=a?a.variableOffsets:{},v=a?a.placedOrientations:{};for(var x in this.placements){var C=this.placements[x],F=f[x];F?(this.opacities[x]=new Qa(F,o,C.text,C.icon),i=i||C.text!==F.text.placed||C.icon!==F.icon.placed):(this.opacities[x]=new Qa(null,o,C.text,C.icon,C.skipFade),i=i||C.text||C.icon)}for(var K in f){var ee=f[K];if(!this.opacities[K]){var re=new Qa(ee,o,!1,!1);re.isHidden()||(this.opacities[K]=re,i=i||ee.text.placed||ee.icon.placed)}}for(var Pe in d)this.variableOffsets[Pe]||!this.opacities[Pe]||this.opacities[Pe].isHidden()||(this.variableOffsets[Pe]=d[Pe]);for(var Ce in v)this.placedOrientations[Ce]||!this.opacities[Ce]||this.opacities[Ce].isHidden()||(this.placedOrientations[Ce]=v[Ce]);i?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:n)},Ma.prototype.updateLayerOpacities=function(n,a){for(var i={},o=0,f=a;o<f.length;o+=1){var d=f[o],v=d.getBucket(n);v&&d.latestFeatureIndex&&n.id===v.layerIds[0]&&this.updateBucketOpacities(v,i,d.collisionBoxArray)}},Ma.prototype.updateBucketOpacities=function(n,a,i){var o=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var f=n.layers[0].layout,d=new Qa(null,0,!1,!1,!0),v=f.get("text-allow-overlap"),x=f.get("icon-allow-overlap"),C=f.get("text-variable-anchor"),F=f.get("text-rotation-alignment")==="map",K=f.get("text-pitch-alignment")==="map",ee=f.get("icon-text-fit")!=="none",re=new Qa(null,0,v&&(x||!n.hasIconData()||f.get("icon-optional")),x&&(v||!n.hasTextData()||f.get("text-optional")),!0);!n.collisionArrays&&i&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(i);for(var Pe=function(Ge,et,St){for(var $t=0;$t<et/4;$t++)Ge.opacityVertexArray.emplaceBack(St)},Ce=function(Ge){var et=n.symbolInstances.get(Ge),St=et.numHorizontalGlyphVertices,$t=et.numVerticalGlyphVertices,Zt=et.crossTileID,rr=o.opacities[Zt];a[Zt]?rr=d:rr||(o.opacities[Zt]=rr=re),a[Zt]=!0;var Sr=et.numIconVertices>0,Ur=o.placedOrientations[et.crossTileID],Br=Ur===l.WritingMode.vertical,hn=Ur===l.WritingMode.horizontal||Ur===l.WritingMode.horizontalOnly;if(St>0||$t>0){var Pn=An(rr.text);Pe(n.text,St,Br?mi:Pn),Pe(n.text,$t,hn?mi:Pn);var Mn=rr.text.isHidden();[et.rightJustifiedTextSymbolIndex,et.centerJustifiedTextSymbolIndex,et.leftJustifiedTextSymbolIndex].forEach(function(Nn){Nn>=0&&(n.text.placedSymbolArray.get(Nn).hidden=Mn||Br?1:0)}),et.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(et.verticalPlacedTextSymbolIndex).hidden=Mn||hn?1:0);var Rn=o.variableOffsets[et.crossTileID];Rn&&o.markUsedJustification(n,Rn.anchor,et,Ur);var Ei=o.placedOrientations[et.crossTileID];Ei&&(o.markUsedJustification(n,"left",et,Ei),o.markUsedOrientation(n,Ei,et))}if(Sr){var fn=An(rr.icon),Jn=!(ee&&et.verticalPlacedIconSymbolIndex&&Br);et.placedIconSymbolIndex>=0&&(Pe(n.icon,et.numIconVertices,Jn?fn:mi),n.icon.placedSymbolArray.get(et.placedIconSymbolIndex).hidden=rr.icon.isHidden()),et.verticalPlacedIconSymbolIndex>=0&&(Pe(n.icon,et.numVerticalIconVertices,Jn?mi:fn),n.icon.placedSymbolArray.get(et.verticalPlacedIconSymbolIndex).hidden=rr.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var ni=n.collisionArrays[Ge];if(ni){var qn=new l.Point(0,0);if(ni.textBox||ni.verticalTextBox){var Bn=!0;if(C){var oi=o.variableOffsets[Zt];oi?(qn=Pa(oi.anchor,oi.width,oi.height,oi.textOffset,oi.textBoxScale),F&&qn._rotate(K?o.transform.angle:-o.transform.angle)):Bn=!1}ni.textBox&&ls(n.textCollisionBox.collisionVertexArray,rr.text.placed,!Bn||Br,qn.x,qn.y),ni.verticalTextBox&&ls(n.textCollisionBox.collisionVertexArray,rr.text.placed,!Bn||hn,qn.x,qn.y)}var Vn=Boolean(!hn&&ni.verticalIconBox);ni.iconBox&&ls(n.iconCollisionBox.collisionVertexArray,rr.icon.placed,Vn,ee?qn.x:0,ee?qn.y:0),ni.verticalIconBox&&ls(n.iconCollisionBox.collisionVertexArray,rr.icon.placed,!Vn,ee?qn.x:0,ee?qn.y:0)}}},qe=0;qe<n.symbolInstances.length;qe++)Ce(qe);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var _e=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=_e.invProjMatrix,n.placementViewportMatrix=_e.viewportMatrix,n.collisionCircleArray=_e.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},Ma.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Ma.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},Ma.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},Ma.prototype.stillRecent=function(n,a){var i=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*i>n},Ma.prototype.setStale=function(){this.stale=!0};var ou=Math.pow(2,25),_o=Math.pow(2,24),W=Math.pow(2,17),ue=Math.pow(2,16),Je=Math.pow(2,9),Ft=Math.pow(2,8),Rr=Math.pow(2,1);function An(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var a=n.placed?1:0,i=Math.floor(127*n.opacity);return i*ou+a*_o+i*W+a*ue+i*Je+a*Ft+i*Rr+a}var mi=0,_a=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};_a.prototype.continuePlacement=function(n,a,i,o,f){for(var d=this._bucketParts;this._currentTileIndex<n.length;)if(a.getBucketParts(d,o,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,f())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,d.sort(function(v,x){return v.sortKey-x.sortKey}));this._currentPartIndex<d.length;)if(a.placeLayerBucketPart(d[this._currentPartIndex],this._seenCrossTileIDs,i),this._currentPartIndex++,f())return!0;return!1};var sa=function(n,a,i,o,f,d,v){this.placement=new Ma(n,f,d,v),this._currentPlacementIndex=a.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=o,this._done=!1};sa.prototype.isDone=function(){return this._done},sa.prototype.continuePlacement=function(n,a,i){for(var o=this,f=l.browser.now(),d=function(){var C=l.browser.now()-f;return!o._forceFullPlacement&&C>2};this._currentPlacementIndex>=0;){var v=a[n[this._currentPlacementIndex]],x=this.placement.collisionIndex.transform.zoom;if(v.type==="symbol"&&(!v.minzoom||v.minzoom<=x)&&(!v.maxzoom||v.maxzoom>x)){if(this._inProgressLayer||(this._inProgressLayer=new _a(v)),this._inProgressLayer.continuePlacement(i[v.source],this.placement,this._showCollisionBoxes,v,d))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},sa.prototype.commit=function(n){return this.placement.commit(n),this.placement};var xa=512/l.EXTENT/2,Fa=function(n,a,i){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=i;for(var o=0;o<a.length;o++){var f=a.get(o),d=f.key;this.indexedSymbolInstances[d]||(this.indexedSymbolInstances[d]=[]),this.indexedSymbolInstances[d].push({crossTileID:f.crossTileID,coord:this.getScaledCoordinates(f,n)})}};Fa.prototype.getScaledCoordinates=function(n,a){var i=xa/Math.pow(2,a.canonical.z-this.tileID.canonical.z);return{x:Math.floor((a.canonical.x*l.EXTENT+n.anchorX)*i),y:Math.floor((a.canonical.y*l.EXTENT+n.anchorY)*i)}},Fa.prototype.findMatches=function(n,a,i){for(var o=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z),f=0;f<n.length;f++){var d=n.get(f);if(!d.crossTileID){var v=this.indexedSymbolInstances[d.key];if(v)for(var x=this.getScaledCoordinates(d,a),C=0,F=v;C<F.length;C+=1){var K=F[C];if(Math.abs(K.coord.x-x.x)<=o&&Math.abs(K.coord.y-x.y)<=o&&!i[K.crossTileID]){i[K.crossTileID]=!0,d.crossTileID=K.crossTileID;break}}}}};var To=function(){this.maxCrossTileID=0};To.prototype.generate=function(){return++this.maxCrossTileID};var so=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};so.prototype.handleWrapJump=function(n){var a=Math.round((n-this.lng)/360);if(a!==0)for(var i in this.indexes){var o=this.indexes[i],f={};for(var d in o){var v=o[d];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+a),f[v.tileID.key]=v}this.indexes[i]=f}this.lng=n},so.prototype.addBucket=function(n,a,i){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var o=0;o<a.symbolInstances.length;o++)a.symbolInstances.get(o).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var f=this.usedCrossTileIDs[n.overscaledZ];for(var d in this.indexes){var v=this.indexes[d];if(Number(d)>n.overscaledZ)for(var x in v){var C=v[x];C.tileID.isChildOf(n)&&C.findMatches(a.symbolInstances,n,f)}else{var F=v[n.scaledTo(Number(d)).key];F&&F.findMatches(a.symbolInstances,n,f)}}for(var K=0;K<a.symbolInstances.length;K++){var ee=a.symbolInstances.get(K);ee.crossTileID||(ee.crossTileID=i.generate(),f[ee.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Fa(n,a.symbolInstances,a.bucketInstanceId),!0},so.prototype.removeBucketCrossTileIDs=function(n,a){for(var i in a.indexedSymbolInstances)for(var o=0,f=a.indexedSymbolInstances[i];o<f.length;o+=1)delete this.usedCrossTileIDs[n][f[o].crossTileID]},so.prototype.removeStaleBuckets=function(n){var a=!1;for(var i in this.indexes){var o=this.indexes[i];for(var f in o)n[o[f].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,o[f]),delete o[f],a=!0)}return a};var za=function(){this.layerIndexes={},this.crossTileIDs=new To,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};za.prototype.addLayer=function(n,a,i){var o=this.layerIndexes[n.id];o===void 0&&(o=this.layerIndexes[n.id]=new so);var f=!1,d={};o.handleWrapJump(i);for(var v=0,x=a;v<x.length;v+=1){var C=x[v],F=C.getBucket(n);F&&n.id===F.layerIds[0]&&(F.bucketInstanceId||(F.bucketInstanceId=++this.maxBucketInstanceId),o.addBucket(C.tileID,F,this.crossTileIDs)&&(f=!0),d[F.bucketInstanceId]=!0)}return o.removeStaleBuckets(d)&&(f=!0),f},za.prototype.pruneUnusedLayers=function(n){var a={};for(var i in n.forEach(function(o){a[o]=!0}),this.layerIndexes)a[i]||delete this.layerIndexes[i]};var xo=function(n,a){return l.emitValidationErrors(n,a&&a.filter(function(i){return i.identifier!=="source.canvas"}))},uo=l.pick(Yr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ho=l.pick(Yr,["setCenter","setZoom","setBearing","setPitch"]),is=function(){var n={},a=l.styleSpec.$version;for(var i in l.styleSpec.$root){var o,f=l.styleSpec.$root[i];f.required&&(o=i==="version"?a:f.type==="array"?[]:{})!=null&&(n[i]=o)}return n}(),ja=function(n){function a(i,o){var f=this;o===void 0&&(o={}),n.call(this),this.map=i,this.dispatcher=new ze(Lt(),this),this.imageManager=new wt,this.imageManager.setEventedParent(this),this.glyphManager=new Te(i._requestManager,o.localIdeographFontFamily),this.lineAtlas=new we(256,512),this.crossTileSymbolIndex=new za,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());var d=this;this._rtlTextPluginCallback=a.registerForPluginStateChange(function(v){d.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:v.pluginStatus,pluginURL:v.pluginURL},function(x,C){if(l.triggerPluginCompletionEvent(x),C&&C.every(function(K){return K}))for(var F in d.sourceCaches)d.sourceCaches[F].reload()})}),this.on("data",function(v){if(v.dataType==="source"&&v.sourceDataType==="metadata"){var x=f.sourceCaches[v.sourceId];if(x){var C=x.getSource();if(C&&C.vectorLayerIds)for(var F in f._layers){var K=f._layers[F];K.source===C.id&&f._validateLayer(K)}}}})}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.loadURL=function(i,o){var f=this;o===void 0&&(o={}),this.fire(new l.Event("dataloading",{dataType:"style"}));var d=typeof o.validate=="boolean"?o.validate:!l.isMapboxURL(i);i=this.map._requestManager.normalizeStyleURL(i,o.accessToken);var v=this.map._requestManager.transformRequest(i,l.ResourceType.Style);this._request=l.getJSON(v,function(x,C){f._request=null,x?f.fire(new l.ErrorEvent(x)):C&&f._load(C,d)})},a.prototype.loadJSON=function(i,o){var f=this;o===void 0&&(o={}),this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.browser.frame(function(){f._request=null,f._load(i,o.validate!==!1)})},a.prototype.loadEmpty=function(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(is,!1)},a.prototype._load=function(i,o){if(!o||!xo(this,l.validateStyle(i))){for(var f in this._loaded=!0,this.stylesheet=i,i.sources)this.addSource(f,i.sources[f],{validate:!1});i.sprite?this._loadSprite(i.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(i.glyphs);var d=qr(this.stylesheet.layers);this._order=d.map(function(F){return F.id}),this._layers={},this._serializedLayers={};for(var v=0,x=d;v<x.length;v+=1){var C=x[v];(C=l.createStyleLayer(C)).setEventedParent(this,{layer:{id:C.id}}),this._layers[C.id]=C,this._serializedLayers[C.id]=C.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new De(this.stylesheet.light),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}},a.prototype._loadSprite=function(i){var o=this;this._spriteRequest=function(f,d,v){var x,C,F,K=l.browser.devicePixelRatio>1?"@2x":"",ee=l.getJSON(d.transformRequest(d.normalizeSpriteURL(f,K,".json"),l.ResourceType.SpriteJSON),function(Ce,qe){ee=null,F||(F=Ce,x=qe,Pe())}),re=l.getImage(d.transformRequest(d.normalizeSpriteURL(f,K,".png"),l.ResourceType.SpriteImage),function(Ce,qe){re=null,F||(F=Ce,C=qe,Pe())});function Pe(){if(F)v(F);else if(x&&C){var Ce=l.browser.getImageData(C),qe={};for(var _e in x){var Ge=x[_e],et=Ge.width,St=Ge.height,$t=Ge.x,Zt=Ge.y,rr=Ge.sdf,Sr=Ge.pixelRatio,Ur=Ge.stretchX,Br=Ge.stretchY,hn=Ge.content,Pn=new l.RGBAImage({width:et,height:St});l.RGBAImage.copy(Ce,Pn,{x:$t,y:Zt},{x:0,y:0},{width:et,height:St}),qe[_e]={data:Pn,pixelRatio:Sr,sdf:rr,stretchX:Ur,stretchY:Br,content:hn}}v(null,qe)}}return{cancel:function(){ee&&(ee.cancel(),ee=null),re&&(re.cancel(),re=null)}}}(i,this.map._requestManager,function(f,d){if(o._spriteRequest=null,f)o.fire(new l.ErrorEvent(f));else if(d)for(var v in d)o.imageManager.addImage(v,d[v]);o.imageManager.setLoaded(!0),o._availableImages=o.imageManager.listImages(),o.dispatcher.broadcast("setImages",o._availableImages),o.fire(new l.Event("data",{dataType:"style"}))})},a.prototype._validateLayer=function(i){var o=this.sourceCaches[i.source];if(o){var f=i.sourceLayer;if(f){var d=o.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(f)===-1)&&this.fire(new l.ErrorEvent(new Error('Source layer "'+f+'" does not exist on source "'+d.id+'" as specified by style layer "'+i.id+'"')))}}},a.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()},a.prototype._serializeLayers=function(i){for(var o=[],f=0,d=i;f<d.length;f+=1){var v=this._layers[d[f]];v.type!=="custom"&&o.push(v.serialize())}return o},a.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var i in this.sourceCaches)if(this.sourceCaches[i].hasTransition())return!0;for(var o in this._layers)if(this._layers[o].hasTransition())return!0;return!1},a.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},a.prototype.update=function(i){if(this._loaded){var o=this._changed;if(this._changed){var f=Object.keys(this._updatedLayers),d=Object.keys(this._removedLayers);for(var v in(f.length||d.length)&&this._updateWorkerLayers(f,d),this._updatedSources){var x=this._updatedSources[v];x==="reload"?this._reloadSource(v):x==="clear"&&this._clearSource(v)}for(var C in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[C].updateTransitions(i);this.light.updateTransitions(i),this._resetUpdates()}var F={};for(var K in this.sourceCaches){var ee=this.sourceCaches[K];F[K]=ee.used,ee.used=!1}for(var re=0,Pe=this._order;re<Pe.length;re+=1){var Ce=this._layers[Pe[re]];Ce.recalculate(i,this._availableImages),!Ce.isHidden(i.zoom)&&Ce.source&&(this.sourceCaches[Ce.source].used=!0)}for(var qe in F){var _e=this.sourceCaches[qe];F[qe]!==_e.used&&_e.fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:qe}))}this.light.recalculate(i),this.z=i.zoom,o&&this.fire(new l.Event("data",{dataType:"style"}))}},a.prototype._updateTilesForChangedImages=function(){var i=Object.keys(this._changedImages);if(i.length){for(var o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}},a.prototype._updateWorkerLayers=function(i,o){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(i),removedIds:o})},a.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},a.prototype.setState=function(i){var o=this;if(this._checkLoaded(),xo(this,l.validateStyle(i)))return!1;(i=l.clone$1(i)).layers=qr(i.layers);var f=function(v,x){if(!v)return[{command:Yr.setStyle,args:[x]}];var C=[];try{if(!l.deepEqual(v.version,x.version))return[{command:Yr.setStyle,args:[x]}];l.deepEqual(v.center,x.center)||C.push({command:Yr.setCenter,args:[x.center]}),l.deepEqual(v.zoom,x.zoom)||C.push({command:Yr.setZoom,args:[x.zoom]}),l.deepEqual(v.bearing,x.bearing)||C.push({command:Yr.setBearing,args:[x.bearing]}),l.deepEqual(v.pitch,x.pitch)||C.push({command:Yr.setPitch,args:[x.pitch]}),l.deepEqual(v.sprite,x.sprite)||C.push({command:Yr.setSprite,args:[x.sprite]}),l.deepEqual(v.glyphs,x.glyphs)||C.push({command:Yr.setGlyphs,args:[x.glyphs]}),l.deepEqual(v.transition,x.transition)||C.push({command:Yr.setTransition,args:[x.transition]}),l.deepEqual(v.light,x.light)||C.push({command:Yr.setLight,args:[x.light]});var F={},K=[];(function(re,Pe,Ce,qe){var _e;for(_e in Pe=Pe||{},re=re||{})re.hasOwnProperty(_e)&&(Pe.hasOwnProperty(_e)||$r(_e,Ce,qe));for(_e in Pe)Pe.hasOwnProperty(_e)&&(re.hasOwnProperty(_e)?l.deepEqual(re[_e],Pe[_e])||(re[_e].type==="geojson"&&Pe[_e].type==="geojson"&&Oi(re,Pe,_e)?Ce.push({command:Yr.setGeoJSONSourceData,args:[_e,Pe[_e].data]}):hi(_e,Pe,Ce,qe)):$n(_e,Pe,Ce))})(v.sources,x.sources,K,F);var ee=[];v.layers&&v.layers.forEach(function(re){F[re.source]?C.push({command:Yr.removeLayer,args:[re.id]}):ee.push(re)}),C=C.concat(K),function(re,Pe,Ce){Pe=Pe||[];var qe,_e,Ge,et,St,$t,Zt,rr=(re=re||[]).map(fi),Sr=Pe.map(fi),Ur=re.reduce(ei,{}),Br=Pe.reduce(ei,{}),hn=rr.slice(),Pn=Object.create(null);for(qe=0,_e=0;qe<rr.length;qe++)Br.hasOwnProperty(Ge=rr[qe])?_e++:(Ce.push({command:Yr.removeLayer,args:[Ge]}),hn.splice(hn.indexOf(Ge,_e),1));for(qe=0,_e=0;qe<Sr.length;qe++)hn[hn.length-1-qe]!==(Ge=Sr[Sr.length-1-qe])&&(Ur.hasOwnProperty(Ge)?(Ce.push({command:Yr.removeLayer,args:[Ge]}),hn.splice(hn.lastIndexOf(Ge,hn.length-_e),1)):_e++,Ce.push({command:Yr.addLayer,args:[Br[Ge],$t=hn[hn.length-qe]]}),hn.splice(hn.length-qe,0,Ge),Pn[Ge]=!0);for(qe=0;qe<Sr.length;qe++)if(et=Ur[Ge=Sr[qe]],St=Br[Ge],!Pn[Ge]&&!l.deepEqual(et,St))if(l.deepEqual(et.source,St.source)&&l.deepEqual(et["source-layer"],St["source-layer"])&&l.deepEqual(et.type,St.type)){for(Zt in Qn(et.layout,St.layout,Ce,Ge,null,Yr.setLayoutProperty),Qn(et.paint,St.paint,Ce,Ge,null,Yr.setPaintProperty),l.deepEqual(et.filter,St.filter)||Ce.push({command:Yr.setFilter,args:[Ge,St.filter]}),l.deepEqual(et.minzoom,St.minzoom)&&l.deepEqual(et.maxzoom,St.maxzoom)||Ce.push({command:Yr.setLayerZoomRange,args:[Ge,St.minzoom,St.maxzoom]}),et)et.hasOwnProperty(Zt)&&Zt!=="layout"&&Zt!=="paint"&&Zt!=="filter"&&Zt!=="metadata"&&Zt!=="minzoom"&&Zt!=="maxzoom"&&(Zt.indexOf("paint.")===0?Qn(et[Zt],St[Zt],Ce,Ge,Zt.slice(6),Yr.setPaintProperty):l.deepEqual(et[Zt],St[Zt])||Ce.push({command:Yr.setLayerProperty,args:[Ge,Zt,St[Zt]]}));for(Zt in St)St.hasOwnProperty(Zt)&&!et.hasOwnProperty(Zt)&&Zt!=="layout"&&Zt!=="paint"&&Zt!=="filter"&&Zt!=="metadata"&&Zt!=="minzoom"&&Zt!=="maxzoom"&&(Zt.indexOf("paint.")===0?Qn(et[Zt],St[Zt],Ce,Ge,Zt.slice(6),Yr.setPaintProperty):l.deepEqual(et[Zt],St[Zt])||Ce.push({command:Yr.setLayerProperty,args:[Ge,Zt,St[Zt]]}))}else Ce.push({command:Yr.removeLayer,args:[Ge]}),$t=hn[hn.lastIndexOf(Ge)+1],Ce.push({command:Yr.addLayer,args:[St,$t]})}(ee,x.layers,C)}catch(re){console.warn("Unable to compute style diff:",re),C=[{command:Yr.setStyle,args:[x]}]}return C}(this.serialize(),i).filter(function(v){return!(v.command in Ho)});if(f.length===0)return!1;var d=f.filter(function(v){return!(v.command in uo)});if(d.length>0)throw new Error("Unimplemented: "+d.map(function(v){return v.command}).join(", ")+".");return f.forEach(function(v){v.command!=="setTransition"&&o[v.command].apply(o,v.args)}),this.stylesheet=i,!0},a.prototype.addImage=function(i,o){if(this.getImage(i))return this.fire(new l.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(i,o),this._afterImageUpdated(i)},a.prototype.updateImage=function(i,o){this.imageManager.updateImage(i,o)},a.prototype.getImage=function(i){return this.imageManager.getImage(i)},a.prototype.removeImage=function(i){if(!this.getImage(i))return this.fire(new l.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(i),this._afterImageUpdated(i)},a.prototype._afterImageUpdated=function(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))},a.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},a.prototype.addSource=function(i,o,f){var d=this;if(f===void 0&&(f={}),this._checkLoaded(),this.sourceCaches[i]!==void 0)throw new Error("There is already a source with this ID");if(!o.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(o).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(l.validateStyle.source,"sources."+i,o,null,f))){this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);var v=this.sourceCaches[i]=new Me(i,o,this.dispatcher);v.style=this,v.setEventedParent(this,function(){return{isSourceLoaded:d.loaded(),source:v.serialize(),sourceId:i}}),v.onAdd(this.map),this._changed=!0}},a.prototype.removeSource=function(i){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error("There is no source with this ID");for(var o in this._layers)if(this._layers[o].source===i)return this.fire(new l.ErrorEvent(new Error('Source "'+i+'" cannot be removed while layer "'+o+'" is using it.')));var f=this.sourceCaches[i];delete this.sourceCaches[i],delete this._updatedSources[i],f.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:i})),f.setEventedParent(null),f.clearTiles(),f.onRemove&&f.onRemove(this.map),this._changed=!0},a.prototype.setGeoJSONSourceData=function(i,o){this._checkLoaded(),this.sourceCaches[i].getSource().setData(o),this._changed=!0},a.prototype.getSource=function(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()},a.prototype.addLayer=function(i,o,f){f===void 0&&(f={}),this._checkLoaded();var d=i.id;if(this.getLayer(d))this.fire(new l.ErrorEvent(new Error('Layer with id "'+d+'" already exists on this map')));else{var v;if(i.type==="custom"){if(xo(this,l.validateCustomStyleLayer(i)))return;v=l.createStyleLayer(i)}else{if(typeof i.source=="object"&&(this.addSource(d,i.source),i=l.clone$1(i),i=l.extend(i,{source:d})),this._validate(l.validateStyle.layer,"layers."+d,i,{arrayIndex:-1},f))return;v=l.createStyleLayer(i),this._validateLayer(v),v.setEventedParent(this,{layer:{id:d}}),this._serializedLayers[v.id]=v.serialize()}var x=o?this._order.indexOf(o):this._order.length;if(o&&x===-1)this.fire(new l.ErrorEvent(new Error('Layer with id "'+o+'" does not exist on this map.')));else{if(this._order.splice(x,0,d),this._layerOrderChanged=!0,this._layers[d]=v,this._removedLayers[d]&&v.source&&v.type!=="custom"){var C=this._removedLayers[d];delete this._removedLayers[d],C.type!==v.type?this._updatedSources[v.source]="clear":(this._updatedSources[v.source]="reload",this.sourceCaches[v.source].pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map)}}},a.prototype.moveLayer=function(i,o){if(this._checkLoaded(),this._changed=!0,this._layers[i]){if(i!==o){var f=this._order.indexOf(i);this._order.splice(f,1);var d=o?this._order.indexOf(o):this._order.length;o&&d===-1?this.fire(new l.ErrorEvent(new Error('Layer with id "'+o+'" does not exist on this map.'))):(this._order.splice(d,0,i),this._layerOrderChanged=!0)}}else this.fire(new l.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be moved.")))},a.prototype.removeLayer=function(i){this._checkLoaded();var o=this._layers[i];if(o){o.setEventedParent(null);var f=this._order.indexOf(i);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=o,delete this._layers[i],delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],o.onRemove&&o.onRemove(this.map)}else this.fire(new l.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be removed.")))},a.prototype.getLayer=function(i){return this._layers[i]},a.prototype.hasLayer=function(i){return i in this._layers},a.prototype.setLayerZoomRange=function(i,o,f){this._checkLoaded();var d=this.getLayer(i);d?d.minzoom===o&&d.maxzoom===f||(o!=null&&(d.minzoom=o),f!=null&&(d.maxzoom=f),this._updateLayer(d)):this.fire(new l.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot have zoom extent.")))},a.prototype.setFilter=function(i,o,f){f===void 0&&(f={}),this._checkLoaded();var d=this.getLayer(i);if(d){if(!l.deepEqual(d.filter,o))return o==null?(d.filter=void 0,void this._updateLayer(d)):void(this._validate(l.validateStyle.filter,"layers."+d.id+".filter",o,null,f)||(d.filter=l.clone$1(o),this._updateLayer(d)))}else this.fire(new l.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be filtered.")))},a.prototype.getFilter=function(i){return l.clone$1(this.getLayer(i).filter)},a.prototype.setLayoutProperty=function(i,o,f,d){d===void 0&&(d={}),this._checkLoaded();var v=this.getLayer(i);v?l.deepEqual(v.getLayoutProperty(o),f)||(v.setLayoutProperty(o,f,d),this._updateLayer(v)):this.fire(new l.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getLayoutProperty=function(i,o){var f=this.getLayer(i);if(f)return f.getLayoutProperty(o);this.fire(new l.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style.")))},a.prototype.setPaintProperty=function(i,o,f,d){d===void 0&&(d={}),this._checkLoaded();var v=this.getLayer(i);v?l.deepEqual(v.getPaintProperty(o),f)||(v.setPaintProperty(o,f,d)&&this._updateLayer(v),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new l.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getPaintProperty=function(i,o){return this.getLayer(i).getPaintProperty(o)},a.prototype.setFeatureState=function(i,o){this._checkLoaded();var f=i.source,d=i.sourceLayer,v=this.sourceCaches[f];if(v!==void 0){var x=v.getSource().type;x==="geojson"&&d?this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||d?(i.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),v.setFeatureState(d,i.id,o)):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error("The source '"+f+"' does not exist in the map's style.")))},a.prototype.removeFeatureState=function(i,o){this._checkLoaded();var f=i.source,d=this.sourceCaches[f];if(d!==void 0){var v=d.getSource().type,x=v==="vector"?i.sourceLayer:void 0;v!=="vector"||x?o&&typeof i.id!="string"&&typeof i.id!="number"?this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(x,i.id,o):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error("The source '"+f+"' does not exist in the map's style.")))},a.prototype.getFeatureState=function(i){this._checkLoaded();var o=i.source,f=i.sourceLayer,d=this.sourceCaches[o];if(d!==void 0){if(d.getSource().type!=="vector"||f)return i.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),d.getFeatureState(f,i.id);this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error("The source '"+o+"' does not exist in the map's style.")))},a.prototype.getTransition=function(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},a.prototype.serialize=function(){return l.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:l.mapObject(this.sourceCaches,function(i){return i.serialize()}),layers:this._serializeLayers(this._order)},function(i){return i!==void 0})},a.prototype._updateLayer=function(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&this.sourceCaches[i.source].getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._changed=!0},a.prototype._flattenAndSortRenderedFeatures=function(i){for(var o=this,f=function(Ur){return o._layers[Ur].type==="fill-extrusion"},d={},v=[],x=this._order.length-1;x>=0;x--){var C=this._order[x];if(f(C)){d[C]=x;for(var F=0,K=i;F<K.length;F+=1){var ee=K[F][C];if(ee)for(var re=0,Pe=ee;re<Pe.length;re+=1)v.push(Pe[re])}}}v.sort(function(Ur,Br){return Br.intersectionZ-Ur.intersectionZ});for(var Ce=[],qe=this._order.length-1;qe>=0;qe--){var _e=this._order[qe];if(f(_e))for(var Ge=v.length-1;Ge>=0;Ge--){var et=v[Ge].feature;if(d[et.layer.id]<qe)break;Ce.push(et),v.pop()}else for(var St=0,$t=i;St<$t.length;St+=1){var Zt=$t[St][_e];if(Zt)for(var rr=0,Sr=Zt;rr<Sr.length;rr+=1)Ce.push(Sr[rr].feature)}}return Ce},a.prototype.queryRenderedFeatures=function(i,o,f){o&&o.filter&&this._validate(l.validateStyle.filter,"queryRenderedFeatures.filter",o.filter,null,o);var d={};if(o&&o.layers){if(!Array.isArray(o.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var v=0,x=o.layers;v<x.length;v+=1){var C=x[v],F=this._layers[C];if(!F)return this.fire(new l.ErrorEvent(new Error("The layer '"+C+"' does not exist in the map's style and cannot be queried for features."))),[];d[F.source]=!0}}var K=[];for(var ee in o.availableImages=this._availableImages,this.sourceCaches)o.layers&&!d[ee]||K.push(ke(this.sourceCaches[ee],this._layers,this._serializedLayers,i,o,f));return this.placement&&K.push(function(re,Pe,Ce,qe,_e,Ge,et){for(var St={},$t=Ge.queryRenderedSymbols(qe),Zt=[],rr=0,Sr=Object.keys($t).map(Number);rr<Sr.length;rr+=1)Zt.push(et[Sr[rr]]);Zt.sort(He);for(var Ur=function(){var Rn=hn[Br],Ei=Rn.featureIndex.lookupSymbolFeatures($t[Rn.bucketInstanceId],Pe,Rn.bucketIndex,Rn.sourceLayerIndex,_e.filter,_e.layers,_e.availableImages,re);for(var fn in Ei){var Jn=St[fn]=St[fn]||[],ni=Ei[fn];ni.sort(function(oi,Vn){var Nn=Rn.featureSortOrder;if(Nn){var Ha=Nn.indexOf(oi.featureIndex);return Nn.indexOf(Vn.featureIndex)-Ha}return Vn.featureIndex-oi.featureIndex});for(var qn=0,Bn=ni;qn<Bn.length;qn+=1)Jn.push(Bn[qn])}},Br=0,hn=Zt;Br<hn.length;Br+=1)Ur();var Pn=function(Rn){St[Rn].forEach(function(Ei){var fn=Ei.feature,Jn=Ce[re[Rn].source].getFeatureState(fn.layer["source-layer"],fn.id);fn.source=fn.layer.source,fn.layer["source-layer"]&&(fn.sourceLayer=fn.layer["source-layer"]),fn.state=Jn})};for(var Mn in St)Pn(Mn);return St}(this._layers,this._serializedLayers,this.sourceCaches,i,o,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(K)},a.prototype.querySourceFeatures=function(i,o){o&&o.filter&&this._validate(l.validateStyle.filter,"querySourceFeatures.filter",o.filter,null,o);var f=this.sourceCaches[i];return f?function(d,v){for(var x=d.getRenderableIds().map(function(Pe){return d.getTileByID(Pe)}),C=[],F={},K=0;K<x.length;K++){var ee=x[K],re=ee.tileID.canonical.key;F[re]||(F[re]=!0,ee.querySourceFeatures(C,v))}return C}(f,o):[]},a.prototype.addSourceType=function(i,o,f){return a.getSourceType(i)?f(new Error('A source type called "'+i+'" already exists.')):(a.setSourceType(i,o),o.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:o.workerSourceURL},f):f(null,null))},a.prototype.getLight=function(){return this.light.getLight()},a.prototype.setLight=function(i,o){o===void 0&&(o={}),this._checkLoaded();var f=this.light.getLight(),d=!1;for(var v in i)if(!l.deepEqual(i[v],f[v])){d=!0;break}if(d){var x={now:l.browser.now(),transition:l.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,o),this.light.updateTransitions(x)}},a.prototype._validate=function(i,o,f,d,v){return v===void 0&&(v={}),(!v||v.validate!==!1)&&xo(this,i.call(l.validateStyle,l.extend({key:o,style:this.serialize(),value:f,styleSpec:l.styleSpec},d)))},a.prototype._remove=function(){for(var i in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[i].setEventedParent(null);for(var o in this.sourceCaches)this.sourceCaches[o].clearTiles(),this.sourceCaches[o].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},a.prototype._clearSource=function(i){this.sourceCaches[i].clearTiles()},a.prototype._reloadSource=function(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()},a.prototype._updateSources=function(i){for(var o in this.sourceCaches)this.sourceCaches[o].update(i)},a.prototype._generateCollisionBoxes=function(){for(var i in this.sourceCaches)this._reloadSource(i)},a.prototype._updatePlacement=function(i,o,f,d,v){v===void 0&&(v=!1);for(var x=!1,C=!1,F={},K=0,ee=this._order;K<ee.length;K+=1){var re=this._layers[ee[K]];if(re.type==="symbol"){if(!F[re.source]){var Pe=this.sourceCaches[re.source];F[re.source]=Pe.getRenderableIds(!0).map(function(et){return Pe.getTileByID(et)}).sort(function(et,St){return St.tileID.overscaledZ-et.tileID.overscaledZ||(et.tileID.isLessThan(St.tileID)?-1:1)})}var Ce=this.crossTileSymbolIndex.addLayer(re,F[re.source],i.center.lng);x=x||Ce}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((v=v||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.browser.now(),i.zoom))&&(this.pauseablePlacement=new sa(i,this._order,v,o,f,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,F),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.browser.now()),C=!0),x&&this.pauseablePlacement.placement.setStale()),C||x)for(var qe=0,_e=this._order;qe<_e.length;qe+=1){var Ge=this._layers[_e[qe]];Ge.type==="symbol"&&this.placement.updateLayerOpacities(Ge,F[Ge.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.browser.now())},a.prototype._releaseSymbolFadeTiles=function(){for(var i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()},a.prototype.getImages=function(i,o,f){this.imageManager.getImages(o.icons,f),this._updateTilesForChangedImages();var d=this.sourceCaches[o.source];d&&d.setDependencies(o.tileID.key,o.type,o.icons)},a.prototype.getGlyphs=function(i,o,f){this.glyphManager.getGlyphs(o.stacks,f)},a.prototype.getResource=function(i,o,f){return l.makeRequest(o,f)},a}(l.Evented);ja.getSourceType=function(n){return Ae[n]},ja.setSourceType=function(n,a){Ae[n]=a},ja.registerForPluginStateChange=l.registerForPluginStateChange;var Wi=l.createLayout([{name:"a_pos",type:"Int16",components:2}]),qa=bi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Bu=bi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ju=bi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),su=bi(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),$u=bi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),wu=bi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),uu=bi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),cs=bi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Us=bi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),c=bi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),m=bi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),S=bi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),_=bi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),G=bi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),oe=bi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),je=bi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),lt=bi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),gt=bi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),hr=bi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),cr=bi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Cn=bi(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Xn=bi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),sn=bi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Ai=bi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Fi=bi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Gi=bi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function bi(n,a){var i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,o=a.match(/attribute ([\w]+) ([\w]+)/g),f=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),d=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=d?d.concat(f):f,x={};return{fragmentSource:n=n.replace(i,function(C,F,K,ee,re){return x[re]=!0,F==="define"?`
#ifndef HAS_UNIFORM_u_`+re+`
varying `+K+" "+ee+" "+re+`;
#else
uniform `+K+" "+ee+" u_"+re+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+re+`
    `+K+" "+ee+" "+re+" = u_"+re+`;
#endif
`}),vertexSource:a=a.replace(i,function(C,F,K,ee,re){var Pe=ee==="float"?"vec2":"vec4",Ce=re.match(/color/)?"color":Pe;return x[re]?F==="define"?`
#ifndef HAS_UNIFORM_u_`+re+`
uniform lowp float u_`+re+`_t;
attribute `+K+" "+Pe+" a_"+re+`;
varying `+K+" "+ee+" "+re+`;
#else
uniform `+K+" "+ee+" u_"+re+`;
#endif
`:Ce==="vec4"?`
#ifndef HAS_UNIFORM_u_`+re+`
    `+re+" = a_"+re+`;
#else
    `+K+" "+ee+" "+re+" = u_"+re+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+re+`
    `+re+" = unpack_mix_"+Ce+"(a_"+re+", u_"+re+`_t);
#else
    `+K+" "+ee+" "+re+" = u_"+re+`;
#endif
`:F==="define"?`
#ifndef HAS_UNIFORM_u_`+re+`
uniform lowp float u_`+re+`_t;
attribute `+K+" "+Pe+" a_"+re+`;
#else
uniform `+K+" "+ee+" u_"+re+`;
#endif
`:Ce==="vec4"?`
#ifndef HAS_UNIFORM_u_`+re+`
    `+K+" "+ee+" "+re+" = a_"+re+`;
#else
    `+K+" "+ee+" "+re+" = u_"+re+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+re+`
    `+K+" "+ee+" "+re+" = unpack_mix_"+Ce+"(a_"+re+", u_"+re+`_t);
#else
    `+K+" "+ee+" "+re+" = u_"+re+`;
#endif
`}),staticAttributes:o,staticUniforms:v}}var Ao=Object.freeze({__proto__:null,prelude:qa,background:Bu,backgroundPattern:Ju,circle:su,clippingMask:$u,heatmap:wu,heatmapTexture:uu,collisionBox:cs,collisionCircle:Us,debug:c,fill:m,fillOutline:S,fillOutlinePattern:_,fillPattern:G,fillExtrusion:oe,fillExtrusionPattern:je,hillshadePrepare:lt,hillshade:gt,line:hr,lineGradient:cr,linePattern:Cn,lineSDF:Xn,raster:sn,symbolIcon:Ai,symbolSDF:Fi,symbolTextAndIcon:Gi}),hs=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Gs(n){for(var a=[],i=0;i<n.length;i++)if(n[i]!==null){var o=n[i].split(" ");a.push(o.pop())}return a}hs.prototype.bind=function(n,a,i,o,f,d,v,x){this.context=n;for(var C=this.boundPaintVertexBuffers.length!==o.length,F=0;!C&&F<o.length;F++)this.boundPaintVertexBuffers[F]!==o[F]&&(C=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===a&&this.boundLayoutVertexBuffer===i&&!C&&this.boundIndexBuffer===f&&this.boundVertexOffset===d&&this.boundDynamicVertexBuffer===v&&this.boundDynamicVertexBuffer2===x?(n.bindVertexArrayOES.set(this.vao),v&&v.bind(),f&&f.dynamicDraw&&f.bind(),x&&x.bind()):this.freshBind(a,i,o,f,d,v,x)},hs.prototype.freshBind=function(n,a,i,o,f,d,v){var x,C=n.numAttributes,F=this.context,K=F.gl;if(F.extVertexArrayObject)this.vao&&this.destroy(),this.vao=F.extVertexArrayObject.createVertexArrayOES(),F.bindVertexArrayOES.set(this.vao),x=0,this.boundProgram=n,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=o,this.boundVertexOffset=f,this.boundDynamicVertexBuffer=d,this.boundDynamicVertexBuffer2=v;else{x=F.currentNumAttributes||0;for(var ee=C;ee<x;ee++)K.disableVertexAttribArray(ee)}a.enableAttributes(K,n);for(var re=0,Pe=i;re<Pe.length;re+=1)Pe[re].enableAttributes(K,n);d&&d.enableAttributes(K,n),v&&v.enableAttributes(K,n),a.bind(),a.setVertexAttribPointers(K,n,f);for(var Ce=0,qe=i;Ce<qe.length;Ce+=1){var _e=qe[Ce];_e.bind(),_e.setVertexAttribPointers(K,n,f)}d&&(d.bind(),d.setVertexAttribPointers(K,n,f)),o&&o.bind(),v&&(v.bind(),v.setVertexAttribPointers(K,n,f)),F.currentNumAttributes=C},hs.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Qu=function(n,a,i,o,f,d){var v=n.gl;this.program=v.createProgram();for(var x=Gs(i.staticAttributes),C=o?o.getBinderAttributes():[],F=x.concat(C),K=i.staticUniforms?Gs(i.staticUniforms):[],ee=o?o.getBinderUniforms():[],re=[],Pe=0,Ce=K.concat(ee);Pe<Ce.length;Pe+=1){var qe=Ce[Pe];re.indexOf(qe)<0&&re.push(qe)}var _e=o?o.defines():[];d&&_e.push("#define OVERDRAW_INSPECTOR;");var Ge=_e.concat(qa.fragmentSource,i.fragmentSource).join(`
`),et=_e.concat(qa.vertexSource,i.vertexSource).join(`
`),St=v.createShader(v.FRAGMENT_SHADER);if(v.isContextLost())this.failedToCreate=!0;else{v.shaderSource(St,Ge),v.compileShader(St),v.attachShader(this.program,St);var $t=v.createShader(v.VERTEX_SHADER);if(v.isContextLost())this.failedToCreate=!0;else{v.shaderSource($t,et),v.compileShader($t),v.attachShader(this.program,$t),this.attributes={};var Zt={};this.numAttributes=F.length;for(var rr=0;rr<this.numAttributes;rr++)F[rr]&&(v.bindAttribLocation(this.program,rr,F[rr]),this.attributes[F[rr]]=rr);v.linkProgram(this.program),v.deleteShader($t),v.deleteShader(St);for(var Sr=0;Sr<re.length;Sr++){var Ur=re[Sr];if(Ur&&!Zt[Ur]){var Br=v.getUniformLocation(this.program,Ur);Br&&(Zt[Ur]=Br)}}this.fixedUniforms=f(n,Zt),this.binderUniforms=o?o.getUniforms(n,Zt):[]}}};function Ms(n,a,i){var o=1/Bi(i,1,a.transform.tileZoom),f=Math.pow(2,i.tileID.overscaledZ),d=i.tileSize*Math.pow(2,a.transform.tileZoom)/f,v=d*(i.tileID.canonical.x+i.tileID.wrap*f),x=d*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[o,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[v>>16,x>>16],u_pixel_coord_lower:[65535&v,65535&x]}}Qu.prototype.draw=function(n,a,i,o,f,d,v,x,C,F,K,ee,re,Pe,Ce,qe){var _e,Ge=n.gl;if(!this.failedToCreate){for(var et in n.program.set(this.program),n.setDepthMode(i),n.setStencilMode(o),n.setColorMode(f),n.setCullFace(d),this.fixedUniforms)this.fixedUniforms[et].set(v[et]);Pe&&Pe.setUniforms(n,this.binderUniforms,ee,{zoom:re});for(var St=(_e={},_e[Ge.LINES]=2,_e[Ge.TRIANGLES]=3,_e[Ge.LINE_STRIP]=1,_e)[a],$t=0,Zt=K.get();$t<Zt.length;$t+=1){var rr=Zt[$t],Sr=rr.vaos||(rr.vaos={});(Sr[x]||(Sr[x]=new hs)).bind(n,this,C,Pe?Pe.getPaintVertexBuffers():[],F,rr.vertexOffset,Ce,qe),Ge.drawElements(a,rr.primitiveLength*St,Ge.UNSIGNED_SHORT,rr.primitiveOffset*St*2)}}};var Eu=function(n,a,i,o){var f=a.style.light,d=f.properties.get("position"),v=[d.x,d.y,d.z],x=l.create$1();f.properties.get("anchor")==="viewport"&&l.fromRotation(x,-a.transform.angle),l.transformMat3(v,v,x);var C=f.properties.get("color");return{u_matrix:n,u_lightpos:v,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+i,u_opacity:o}},xs=function(n,a,i,o,f,d,v){return l.extend(Eu(n,a,i,o),Ms(d,a,v),{u_height_factor:-Math.pow(2,f.overscaledZ)/v.tileSize/8})},bs=function(n){return{u_matrix:n}},ws=function(n,a,i,o){return l.extend(bs(n),Ms(i,a,o))},Ea=function(n,a){return{u_matrix:n,u_world:a}},kl=function(n,a,i,o,f){return l.extend(ws(n,a,i,o),{u_world:f})},el=function(n,a,i,o){var f,d,v=n.transform;if(o.paint.get("circle-pitch-alignment")==="map"){var x=Bi(i,1,v.zoom);f=!0,d=[x,x]}else f=!1,d=v.pixelsToGLUnits;return{u_camera_to_center_distance:v.cameraToCenterDistance,u_scale_with_map:+(o.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(a.posMatrix,i,o.paint.get("circle-translate"),o.paint.get("circle-translate-anchor")),u_pitch_with_map:+f,u_device_pixel_ratio:l.browser.devicePixelRatio,u_extrude_scale:d}},Co=function(n,a,i){var o=Bi(i,1,a.zoom),f=Math.pow(2,a.zoom-i.tileID.overscaledZ),d=i.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:a.cameraToCenterDistance,u_pixels_to_tile_units:o,u_extrude_scale:[a.pixelsToGLUnits[0]/(o*f),a.pixelsToGLUnits[1]/(o*f)],u_overscale_factor:d}},tl=function(n,a,i){return{u_matrix:n,u_inv_matrix:a,u_camera_to_center_distance:i.cameraToCenterDistance,u_viewport_size:[i.width,i.height]}},Es=function(n,a,i){return i===void 0&&(i=1),{u_matrix:n,u_color:a,u_overlay:0,u_overlay_scale:i}},Wo=function(n){return{u_matrix:n}},rl=function(n,a,i,o){return{u_matrix:n,u_extrude_scale:Bi(a,1,i),u_intensity:o}},js=function(n,a,i){var o=n.transform;return{u_matrix:Pl(n,a,i),u_ratio:1/Bi(a,1,o.zoom),u_device_pixel_ratio:l.browser.devicePixelRatio,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},Xi=function(n,a,i,o){return l.extend(js(n,a,i),{u_image:0,u_image_height:o})},qs=function(n,a,i,o){var f=n.transform,d=Zs(a,f);return{u_matrix:Pl(n,a,i),u_texsize:a.imageAtlasTexture.size,u_ratio:1/Bi(a,1,f.zoom),u_device_pixel_ratio:l.browser.devicePixelRatio,u_image:0,u_scale:[d,o.fromScale,o.toScale],u_fade:o.t,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},Wl=function(n,a,i,o,f){var d=n.lineAtlas,v=Zs(a,n.transform),x=i.layout.get("line-cap")==="round",C=d.getDash(o.from,x),F=d.getDash(o.to,x),K=C.width*f.fromScale,ee=F.width*f.toScale;return l.extend(js(n,a,i),{u_patternscale_a:[v/K,-C.height/2],u_patternscale_b:[v/ee,-F.height/2],u_sdfgamma:d.width/(256*Math.min(K,ee)*l.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:C.y,u_tex_y_b:F.y,u_mix:f.t})};function Zs(n,a){return 1/Bi(n,1,a.tileZoom)}function Pl(n,a,i){return n.translatePosMatrix(a.tileID.posMatrix,a,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}var Xl=function(n,a,i,o,f){return{u_matrix:n,u_tl_parent:a,u_scale_parent:i,u_buffer_scale:1,u_fade_t:o.mix,u_opacity:o.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(v=f.paint.get("raster-saturation"),v>0?1-1/(1.001-v):-v),u_contrast_factor:(d=f.paint.get("raster-contrast"),d>0?1/(1-d):1+d),u_spin_weights:Yl(f.paint.get("raster-hue-rotate"))};var d,v};function Yl(n){n*=Math.PI/180;var a=Math.sin(n),i=Math.cos(n);return[(2*i+1)/3,(-Math.sqrt(3)*a-i+1)/3,(Math.sqrt(3)*a-i+1)/3]}var nl,Su=function(n,a,i,o,f,d,v,x,C,F){var K=f.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:K.cameraToCenterDistance,u_pitch:K.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:K.width/K.height,u_fade_change:f.options.fadeDuration?f.symbolFadeChange:1,u_matrix:d,u_label_plane_matrix:v,u_coord_matrix:x,u_is_text:+C,u_pitch_with_map:+o,u_texsize:F,u_texture:0}},lu=function(n,a,i,o,f,d,v,x,C,F,K){var ee=f.transform;return l.extend(Su(n,a,i,o,f,d,v,x,C,F),{u_gamma_scale:o?Math.cos(ee._pitch)*ee.cameraToCenterDistance:1,u_device_pixel_ratio:l.browser.devicePixelRatio,u_is_halo:+K})},cu=function(n,a,i,o,f,d,v,x,C,F){return l.extend(lu(n,a,i,o,f,d,v,x,!0,C,!0),{u_texsize_icon:F,u_texture_icon:1})},hu=function(n,a,i){return{u_matrix:n,u_opacity:a,u_color:i}},Ls=function(n,a,i,o,f,d){return l.extend(function(v,x,C,F){var K=C.imageManager.getPattern(v.from.toString()),ee=C.imageManager.getPattern(v.to.toString()),re=C.imageManager.getPixelSize(),Pe=re.width,Ce=re.height,qe=Math.pow(2,F.tileID.overscaledZ),_e=F.tileSize*Math.pow(2,C.transform.tileZoom)/qe,Ge=_e*(F.tileID.canonical.x+F.tileID.wrap*qe),et=_e*F.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:K.tl,u_pattern_br_a:K.br,u_pattern_tl_b:ee.tl,u_pattern_br_b:ee.br,u_texsize:[Pe,Ce],u_mix:x.t,u_pattern_size_a:K.displaySize,u_pattern_size_b:ee.displaySize,u_scale_a:x.fromScale,u_scale_b:x.toScale,u_tile_units_to_pixels:1/Bi(F,1,C.transform.tileZoom),u_pixel_coord_upper:[Ge>>16,et>>16],u_pixel_coord_lower:[65535&Ge,65535&et]}}(o,d,i,f),{u_matrix:n,u_opacity:a})},fu={fillExtrusion:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_lightpos:new l.Uniform3f(n,a.u_lightpos),u_lightintensity:new l.Uniform1f(n,a.u_lightintensity),u_lightcolor:new l.Uniform3f(n,a.u_lightcolor),u_vertical_gradient:new l.Uniform1f(n,a.u_vertical_gradient),u_opacity:new l.Uniform1f(n,a.u_opacity)}},fillExtrusionPattern:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_lightpos:new l.Uniform3f(n,a.u_lightpos),u_lightintensity:new l.Uniform1f(n,a.u_lightintensity),u_lightcolor:new l.Uniform3f(n,a.u_lightcolor),u_vertical_gradient:new l.Uniform1f(n,a.u_vertical_gradient),u_height_factor:new l.Uniform1f(n,a.u_height_factor),u_image:new l.Uniform1i(n,a.u_image),u_texsize:new l.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new l.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new l.Uniform3f(n,a.u_scale),u_fade:new l.Uniform1f(n,a.u_fade),u_opacity:new l.Uniform1f(n,a.u_opacity)}},fill:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix)}},fillPattern:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_image:new l.Uniform1i(n,a.u_image),u_texsize:new l.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new l.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new l.Uniform3f(n,a.u_scale),u_fade:new l.Uniform1f(n,a.u_fade)}},fillOutline:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_world:new l.Uniform2f(n,a.u_world)}},fillOutlinePattern:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_world:new l.Uniform2f(n,a.u_world),u_image:new l.Uniform1i(n,a.u_image),u_texsize:new l.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new l.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new l.Uniform3f(n,a.u_scale),u_fade:new l.Uniform1f(n,a.u_fade)}},circle:function(n,a){return{u_camera_to_center_distance:new l.Uniform1f(n,a.u_camera_to_center_distance),u_scale_with_map:new l.Uniform1i(n,a.u_scale_with_map),u_pitch_with_map:new l.Uniform1i(n,a.u_pitch_with_map),u_extrude_scale:new l.Uniform2f(n,a.u_extrude_scale),u_device_pixel_ratio:new l.Uniform1f(n,a.u_device_pixel_ratio),u_matrix:new l.UniformMatrix4f(n,a.u_matrix)}},collisionBox:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_camera_to_center_distance:new l.Uniform1f(n,a.u_camera_to_center_distance),u_pixels_to_tile_units:new l.Uniform1f(n,a.u_pixels_to_tile_units),u_extrude_scale:new l.Uniform2f(n,a.u_extrude_scale),u_overscale_factor:new l.Uniform1f(n,a.u_overscale_factor)}},collisionCircle:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_inv_matrix:new l.UniformMatrix4f(n,a.u_inv_matrix),u_camera_to_center_distance:new l.Uniform1f(n,a.u_camera_to_center_distance),u_viewport_size:new l.Uniform2f(n,a.u_viewport_size)}},debug:function(n,a){return{u_color:new l.UniformColor(n,a.u_color),u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_overlay:new l.Uniform1i(n,a.u_overlay),u_overlay_scale:new l.Uniform1f(n,a.u_overlay_scale)}},clippingMask:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix)}},heatmap:function(n,a){return{u_extrude_scale:new l.Uniform1f(n,a.u_extrude_scale),u_intensity:new l.Uniform1f(n,a.u_intensity),u_matrix:new l.UniformMatrix4f(n,a.u_matrix)}},heatmapTexture:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_world:new l.Uniform2f(n,a.u_world),u_image:new l.Uniform1i(n,a.u_image),u_color_ramp:new l.Uniform1i(n,a.u_color_ramp),u_opacity:new l.Uniform1f(n,a.u_opacity)}},hillshade:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_image:new l.Uniform1i(n,a.u_image),u_latrange:new l.Uniform2f(n,a.u_latrange),u_light:new l.Uniform2f(n,a.u_light),u_shadow:new l.UniformColor(n,a.u_shadow),u_highlight:new l.UniformColor(n,a.u_highlight),u_accent:new l.UniformColor(n,a.u_accent)}},hillshadePrepare:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_image:new l.Uniform1i(n,a.u_image),u_dimension:new l.Uniform2f(n,a.u_dimension),u_zoom:new l.Uniform1f(n,a.u_zoom),u_unpack:new l.Uniform4f(n,a.u_unpack)}},line:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_ratio:new l.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new l.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(n,a.u_units_to_pixels)}},lineGradient:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_ratio:new l.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new l.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(n,a.u_units_to_pixels),u_image:new l.Uniform1i(n,a.u_image),u_image_height:new l.Uniform1f(n,a.u_image_height)}},linePattern:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_texsize:new l.Uniform2f(n,a.u_texsize),u_ratio:new l.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new l.Uniform1f(n,a.u_device_pixel_ratio),u_image:new l.Uniform1i(n,a.u_image),u_units_to_pixels:new l.Uniform2f(n,a.u_units_to_pixels),u_scale:new l.Uniform3f(n,a.u_scale),u_fade:new l.Uniform1f(n,a.u_fade)}},lineSDF:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_ratio:new l.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new l.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(n,a.u_units_to_pixels),u_patternscale_a:new l.Uniform2f(n,a.u_patternscale_a),u_patternscale_b:new l.Uniform2f(n,a.u_patternscale_b),u_sdfgamma:new l.Uniform1f(n,a.u_sdfgamma),u_image:new l.Uniform1i(n,a.u_image),u_tex_y_a:new l.Uniform1f(n,a.u_tex_y_a),u_tex_y_b:new l.Uniform1f(n,a.u_tex_y_b),u_mix:new l.Uniform1f(n,a.u_mix)}},raster:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_tl_parent:new l.Uniform2f(n,a.u_tl_parent),u_scale_parent:new l.Uniform1f(n,a.u_scale_parent),u_buffer_scale:new l.Uniform1f(n,a.u_buffer_scale),u_fade_t:new l.Uniform1f(n,a.u_fade_t),u_opacity:new l.Uniform1f(n,a.u_opacity),u_image0:new l.Uniform1i(n,a.u_image0),u_image1:new l.Uniform1i(n,a.u_image1),u_brightness_low:new l.Uniform1f(n,a.u_brightness_low),u_brightness_high:new l.Uniform1f(n,a.u_brightness_high),u_saturation_factor:new l.Uniform1f(n,a.u_saturation_factor),u_contrast_factor:new l.Uniform1f(n,a.u_contrast_factor),u_spin_weights:new l.Uniform3f(n,a.u_spin_weights)}},symbolIcon:function(n,a){return{u_is_size_zoom_constant:new l.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new l.Uniform1f(n,a.u_size_t),u_size:new l.Uniform1f(n,a.u_size),u_camera_to_center_distance:new l.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new l.Uniform1f(n,a.u_pitch),u_rotate_symbol:new l.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new l.Uniform1f(n,a.u_fade_change),u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new l.Uniform1i(n,a.u_is_text),u_pitch_with_map:new l.Uniform1i(n,a.u_pitch_with_map),u_texsize:new l.Uniform2f(n,a.u_texsize),u_texture:new l.Uniform1i(n,a.u_texture)}},symbolSDF:function(n,a){return{u_is_size_zoom_constant:new l.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new l.Uniform1f(n,a.u_size_t),u_size:new l.Uniform1f(n,a.u_size),u_camera_to_center_distance:new l.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new l.Uniform1f(n,a.u_pitch),u_rotate_symbol:new l.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new l.Uniform1f(n,a.u_fade_change),u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new l.Uniform1i(n,a.u_is_text),u_pitch_with_map:new l.Uniform1i(n,a.u_pitch_with_map),u_texsize:new l.Uniform2f(n,a.u_texsize),u_texture:new l.Uniform1i(n,a.u_texture),u_gamma_scale:new l.Uniform1f(n,a.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(n,a.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(n,a.u_is_halo)}},symbolTextAndIcon:function(n,a){return{u_is_size_zoom_constant:new l.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new l.Uniform1f(n,a.u_size_t),u_size:new l.Uniform1f(n,a.u_size),u_camera_to_center_distance:new l.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new l.Uniform1f(n,a.u_pitch),u_rotate_symbol:new l.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new l.Uniform1f(n,a.u_fade_change),u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new l.Uniform1i(n,a.u_is_text),u_pitch_with_map:new l.Uniform1i(n,a.u_pitch_with_map),u_texsize:new l.Uniform2f(n,a.u_texsize),u_texsize_icon:new l.Uniform2f(n,a.u_texsize_icon),u_texture:new l.Uniform1i(n,a.u_texture),u_texture_icon:new l.Uniform1i(n,a.u_texture_icon),u_gamma_scale:new l.Uniform1f(n,a.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(n,a.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(n,a.u_is_halo)}},background:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_opacity:new l.Uniform1f(n,a.u_opacity),u_color:new l.UniformColor(n,a.u_color)}},backgroundPattern:function(n,a){return{u_matrix:new l.UniformMatrix4f(n,a.u_matrix),u_opacity:new l.Uniform1f(n,a.u_opacity),u_image:new l.Uniform1i(n,a.u_image),u_pattern_tl_a:new l.Uniform2f(n,a.u_pattern_tl_a),u_pattern_br_a:new l.Uniform2f(n,a.u_pattern_br_a),u_pattern_tl_b:new l.Uniform2f(n,a.u_pattern_tl_b),u_pattern_br_b:new l.Uniform2f(n,a.u_pattern_br_b),u_texsize:new l.Uniform2f(n,a.u_texsize),u_mix:new l.Uniform1f(n,a.u_mix),u_pattern_size_a:new l.Uniform2f(n,a.u_pattern_size_a),u_pattern_size_b:new l.Uniform2f(n,a.u_pattern_size_b),u_scale_a:new l.Uniform1f(n,a.u_scale_a),u_scale_b:new l.Uniform1f(n,a.u_scale_b),u_pixel_coord_upper:new l.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(n,a.u_pixel_coord_lower),u_tile_units_to_pixels:new l.Uniform1f(n,a.u_tile_units_to_pixels)}}};function Hs(n,a,i,o,f,d,v){for(var x=n.context,C=x.gl,F=n.useProgram("collisionBox"),K=[],ee=0,re=0,Pe=0;Pe<o.length;Pe++){var Ce=o[Pe],qe=a.getTile(Ce),_e=qe.getBucket(i);if(_e){var Ge=Ce.posMatrix;f[0]===0&&f[1]===0||(Ge=n.translatePosMatrix(Ce.posMatrix,qe,f,d));var et=v?_e.textCollisionBox:_e.iconCollisionBox,St=_e.collisionCircleArray;if(St.length>0){var $t=l.create(),Zt=Ge;l.mul($t,_e.placementInvProjMatrix,n.transform.glCoordMatrix),l.mul($t,$t,_e.placementViewportMatrix),K.push({circleArray:St,circleOffset:re,transform:Zt,invTransform:$t}),re=ee+=St.length/4}et&&F.draw(x,C.LINES,ne.disabled,xe.disabled,n.colorModeForRenderPass(),Qe.disabled,Co(Ge,n.transform,qe),i.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,null,n.transform.zoom,null,null,et.collisionVertexBuffer)}}if(v&&K.length){var rr=n.useProgram("collisionCircle"),Sr=new l.StructArrayLayout2f1f2i16;Sr.resize(4*ee),Sr._trim();for(var Ur=0,Br=0,hn=K;Br<hn.length;Br+=1)for(var Pn=hn[Br],Mn=0;Mn<Pn.circleArray.length/4;Mn++){var Rn=4*Mn,Ei=Pn.circleArray[Rn+0],fn=Pn.circleArray[Rn+1],Jn=Pn.circleArray[Rn+2],ni=Pn.circleArray[Rn+3];Sr.emplace(Ur++,Ei,fn,Jn,ni,0),Sr.emplace(Ur++,Ei,fn,Jn,ni,1),Sr.emplace(Ur++,Ei,fn,Jn,ni,2),Sr.emplace(Ur++,Ei,fn,Jn,ni,3)}(!nl||nl.length<2*ee)&&(nl=function(Ca){var co=2*Ca,ho=new l.StructArrayLayout3ui6;ho.resize(co),ho._trim();for(var Ia=0;Ia<co;Ia++){var Na=6*Ia;ho.uint16[Na+0]=4*Ia+0,ho.uint16[Na+1]=4*Ia+1,ho.uint16[Na+2]=4*Ia+2,ho.uint16[Na+3]=4*Ia+2,ho.uint16[Na+4]=4*Ia+3,ho.uint16[Na+5]=4*Ia+0}return ho}(ee));for(var qn=x.createIndexBuffer(nl,!0),Bn=x.createVertexBuffer(Sr,l.collisionCircleLayout.members,!0),oi=0,Vn=K;oi<Vn.length;oi+=1){var Nn=Vn[oi],Ha=tl(Nn.transform,Nn.invTransform,n.transform);rr.draw(x,C.TRIANGLES,ne.disabled,xe.disabled,n.colorModeForRenderPass(),Qe.disabled,Ha,i.id,Bn,qn,l.SegmentVector.simpleSegment(0,2*Nn.circleOffset,Nn.circleArray.length,Nn.circleArray.length/2),null,n.transform.zoom,null,null,null)}Bn.destroy(),qn.destroy()}}var Xo=l.identity(new Float32Array(16));function il(n,a,i,o,f,d){var v=l.getAnchorAlignment(n),x=-(v.horizontalAlign-.5)*a,C=-(v.verticalAlign-.5)*i,F=l.evaluateVariableOffset(n,o);return new l.Point((x/f+F[0])*d,(C/f+F[1])*d)}function al(n,a,i,o,f,d,v,x,C,F,K){var ee=n.text.placedSymbolArray,re=n.text.dynamicLayoutVertexArray,Pe=n.icon.dynamicLayoutVertexArray,Ce={};re.clear();for(var qe=0;qe<ee.length;qe++){var _e=ee.get(qe),Ge=_e.hidden||!_e.crossTileID||n.allowVerticalPlacement&&!_e.placedOrientation?null:o[_e.crossTileID];if(Ge){var et=new l.Point(_e.anchorX,_e.anchorY),St=di(et,i?x:v),$t=vi(d.cameraToCenterDistance,St.signedDistanceFromCamera),Zt=f.evaluateSizeForFeature(n.textSizeData,F,_e)*$t/l.ONE_EM;i&&(Zt*=n.tilePixelRatio/C);for(var rr=il(Ge.anchor,Ge.width,Ge.height,Ge.textOffset,Ge.textBoxScale,Zt),Sr=i?di(et.add(rr),v).point:St.point.add(a?rr.rotate(-d.angle):rr),Ur=n.allowVerticalPlacement&&_e.placedOrientation===l.WritingMode.vertical?Math.PI/2:0,Br=0;Br<_e.numGlyphs;Br++)l.addDynamicAttributes(re,Sr,Ur);K&&_e.associatedIconIndex>=0&&(Ce[_e.associatedIconIndex]={shiftedAnchor:Sr,angle:Ur})}else ya(_e.numGlyphs,re)}if(K){Pe.clear();for(var hn=n.icon.placedSymbolArray,Pn=0;Pn<hn.length;Pn++){var Mn=hn.get(Pn);if(Mn.hidden)ya(Mn.numGlyphs,Pe);else{var Rn=Ce[Pn];if(Rn)for(var Ei=0;Ei<Mn.numGlyphs;Ei++)l.addDynamicAttributes(Pe,Rn.shiftedAnchor,Rn.angle);else ya(Mn.numGlyphs,Pe)}}n.icon.dynamicLayoutVertexBuffer.updateData(Pe)}n.text.dynamicLayoutVertexBuffer.updateData(re)}function Ml(n,a,i){return i.iconsInText&&a?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function Ws(n,a,i,o,f,d,v,x,C,F,K,ee){for(var re=n.context,Pe=re.gl,Ce=n.transform,qe=x==="map",_e=C==="map",Ge=qe&&i.layout.get("symbol-placement")!=="point",et=qe&&!_e&&!Ge,St=i.layout.get("symbol-sort-key").constantOr(1)!==void 0,$t=!1,Zt=n.depthModeForSublayer(0,ne.ReadOnly),rr=i.layout.get("text-variable-anchor"),Sr=[],Ur=0,Br=o;Ur<Br.length;Ur+=1){var hn=Br[Ur],Pn=a.getTile(hn),Mn=Pn.getBucket(i);if(Mn){var Rn=f?Mn.text:Mn.icon;if(Rn&&Rn.segments.get().length){var Ei=Rn.programConfigurations.get(i.id),fn=f||Mn.sdfIcons,Jn=f?Mn.textSizeData:Mn.iconSizeData,ni=_e||Ce.pitch!==0,qn=n.useProgram(Ml(fn,f,Mn),Ei),Bn=l.evaluateSizeForZoom(Jn,Ce.zoom),oi=void 0,Vn=[0,0],Nn=void 0,Ha=void 0,Ca=null,co=void 0;if(f)Nn=Pn.glyphAtlasTexture,Ha=Pe.LINEAR,oi=Pn.glyphAtlasTexture.size,Mn.iconsInText&&(Vn=Pn.imageAtlasTexture.size,Ca=Pn.imageAtlasTexture,co=ni||n.options.rotating||n.options.zooming||Jn.kind==="composite"||Jn.kind==="camera"?Pe.LINEAR:Pe.NEAREST);else{var ho=i.layout.get("icon-size").constantOr(0)!==1||Mn.iconsNeedLinear;Nn=Pn.imageAtlasTexture,Ha=fn||n.options.rotating||n.options.zooming||ho||ni?Pe.LINEAR:Pe.NEAREST,oi=Pn.imageAtlasTexture.size}var Ia=Bi(Pn,1,n.transform.zoom),Na=Qi(hn.posMatrix,_e,qe,n.transform,Ia),Qo=_i(hn.posMatrix,_e,qe,n.transform,Ia),zo=rr&&Mn.hasTextData(),tu=i.layout.get("icon-text-fit")!=="none"&&zo&&Mn.hasIconData();Ge&&ns(Mn,hn.posMatrix,n,f,Na,Qo,_e,F);var Bo=n.translatePosMatrix(hn.posMatrix,Pn,d,v),Is=Ge||f&&rr||tu?Xo:Na,ds=n.translatePosMatrix(Qo,Pn,d,v,!0),dl=fn&&i.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Zu={program:qn,buffers:Rn,uniformValues:fn?Mn.iconsInText?cu(Jn.kind,Bn,et,_e,n,Bo,Is,ds,oi,Vn):lu(Jn.kind,Bn,et,_e,n,Bo,Is,ds,f,oi,!0):Su(Jn.kind,Bn,et,_e,n,Bo,Is,ds,f,oi),atlasTexture:Nn,atlasTextureIcon:Ca,atlasInterpolation:Ha,atlasInterpolationIcon:co,isSDF:fn,hasHalo:dl};if(St&&Mn.canOverlap){$t=!0;for(var ru=0,Hu=Rn.segments.get();ru<Hu.length;ru+=1){var ml=Hu[ru];Sr.push({segments:new l.SegmentVector([ml]),sortKey:ml.sortKey,state:Zu})}}else Sr.push({segments:Rn.segments,sortKey:0,state:Zu})}}}$t&&Sr.sort(function(yu,gu){return yu.sortKey-gu.sortKey});for(var ks=0,Wu=Sr;ks<Wu.length;ks+=1){var Fs=Wu[ks],Wa=Fs.state;if(re.activeTexture.set(Pe.TEXTURE0),Wa.atlasTexture.bind(Wa.atlasInterpolation,Pe.CLAMP_TO_EDGE),Wa.atlasTextureIcon&&(re.activeTexture.set(Pe.TEXTURE1),Wa.atlasTextureIcon&&Wa.atlasTextureIcon.bind(Wa.atlasInterpolationIcon,Pe.CLAMP_TO_EDGE)),Wa.isSDF){var nu=Wa.uniformValues;Wa.hasHalo&&(nu.u_is_halo=1,Tu(Wa.buffers,Fs.segments,i,n,Wa.program,Zt,K,ee,nu)),nu.u_is_halo=0}Tu(Wa.buffers,Fs.segments,i,n,Wa.program,Zt,K,ee,Wa.uniformValues)}}function Tu(n,a,i,o,f,d,v,x,C){var F=o.context;f.draw(F,F.gl.TRIANGLES,d,v,x,Qe.disabled,C,i.id,n.layoutVertexBuffer,n.indexBuffer,a,i.paint,o.transform.zoom,n.programConfigurations.get(i.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function Au(n,a,i,o,f,d,v){var x,C,F,K,ee,re=n.context.gl,Pe=i.paint.get("fill-pattern"),Ce=Pe&&Pe.constantOr(1),qe=i.getCrossfadeParameters();v?(C=Ce&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",x=re.LINES):(C=Ce?"fillPattern":"fill",x=re.TRIANGLES);for(var _e=0,Ge=o;_e<Ge.length;_e+=1){var et=Ge[_e],St=a.getTile(et);if(!Ce||St.patternsLoaded()){var $t=St.getBucket(i);if($t){var Zt=$t.programConfigurations.get(i.id),rr=n.useProgram(C,Zt);Ce&&(n.context.activeTexture.set(re.TEXTURE0),St.imageAtlasTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),Zt.updatePaintBuffers(qe));var Sr=Pe.constantOr(null);if(Sr&&St.imageAtlas){var Ur=St.imageAtlas,Br=Ur.patternPositions[Sr.to.toString()],hn=Ur.patternPositions[Sr.from.toString()];Br&&hn&&Zt.setConstantPatternPositions(Br,hn)}var Pn=n.translatePosMatrix(et.posMatrix,St,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(v){K=$t.indexBuffer2,ee=$t.segments2;var Mn=[re.drawingBufferWidth,re.drawingBufferHeight];F=C==="fillOutlinePattern"&&Ce?kl(Pn,n,qe,St,Mn):Ea(Pn,Mn)}else K=$t.indexBuffer,ee=$t.segments,F=Ce?ws(Pn,n,qe,St):bs(Pn);rr.draw(n.context,x,f,n.stencilModeForClipping(et),d,Qe.disabled,F,i.id,$t.layoutVertexBuffer,K,ee,i.paint,n.transform.zoom,Zt)}}}}function ol(n,a,i,o,f,d,v){for(var x=n.context,C=x.gl,F=i.paint.get("fill-extrusion-pattern"),K=F.constantOr(1),ee=i.getCrossfadeParameters(),re=i.paint.get("fill-extrusion-opacity"),Pe=0,Ce=o;Pe<Ce.length;Pe+=1){var qe=Ce[Pe],_e=a.getTile(qe),Ge=_e.getBucket(i);if(Ge){var et=Ge.programConfigurations.get(i.id),St=n.useProgram(K?"fillExtrusionPattern":"fillExtrusion",et);K&&(n.context.activeTexture.set(C.TEXTURE0),_e.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),et.updatePaintBuffers(ee));var $t=F.constantOr(null);if($t&&_e.imageAtlas){var Zt=_e.imageAtlas,rr=Zt.patternPositions[$t.to.toString()],Sr=Zt.patternPositions[$t.from.toString()];rr&&Sr&&et.setConstantPatternPositions(rr,Sr)}var Ur=n.translatePosMatrix(qe.posMatrix,_e,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),Br=i.paint.get("fill-extrusion-vertical-gradient"),hn=K?xs(Ur,n,Br,re,qe,ee,_e):Eu(Ur,n,Br,re);St.draw(x,x.gl.TRIANGLES,f,d,v,Qe.backCCW,hn,i.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ge.segments,i.paint,n.transform.zoom,et)}}}function Nu(n,a,i,o,f,d){var v=n.context,x=v.gl,C=a.fbo;if(C){var F=n.useProgram("hillshade");v.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,C.colorAttachment.get());var K=function(ee,re,Pe){var Ce=Pe.paint.get("hillshade-shadow-color"),qe=Pe.paint.get("hillshade-highlight-color"),_e=Pe.paint.get("hillshade-accent-color"),Ge=Pe.paint.get("hillshade-illumination-direction")*(Math.PI/180);Pe.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ge-=ee.transform.angle);var et,St,$t,Zt=!ee.options.moving;return{u_matrix:ee.transform.calculatePosMatrix(re.tileID.toUnwrapped(),Zt),u_image:0,u_latrange:(et=re.tileID,St=Math.pow(2,et.canonical.z),$t=et.canonical.y,[new l.MercatorCoordinate(0,$t/St).toLngLat().lat,new l.MercatorCoordinate(0,($t+1)/St).toLngLat().lat]),u_light:[Pe.paint.get("hillshade-exaggeration"),Ge],u_shadow:Ce,u_highlight:qe,u_accent:_e}}(n,a,i);F.draw(v,x.TRIANGLES,o,f,d,Qe.disabled,K,i.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function Kl(n,a,i,o,f,d){var v=n.context,x=v.gl,C=a.dem;if(C&&C.data){var F=C.dim,K=C.stride,ee=C.getPixels();if(v.activeTexture.set(x.TEXTURE1),v.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||n.getTileTexture(K),a.demTexture){var re=a.demTexture;re.update(ee,{premultiply:!1}),re.bind(x.NEAREST,x.CLAMP_TO_EDGE)}else a.demTexture=new l.Texture(v,ee,x.RGBA,{premultiply:!1}),a.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE);v.activeTexture.set(x.TEXTURE0);var Pe=a.fbo;if(!Pe){var Ce=new l.Texture(v,{width:F,height:F,data:null},x.RGBA);Ce.bind(x.LINEAR,x.CLAMP_TO_EDGE),(Pe=a.fbo=v.createFramebuffer(F,F,!0)).colorAttachment.set(Ce.texture)}v.bindFramebuffer.set(Pe.framebuffer),v.viewport.set([0,0,F,F]),n.useProgram("hillshadePrepare").draw(v,x.TRIANGLES,o,f,d,Qe.disabled,function(qe,_e){var Ge=_e.stride,et=l.create();return l.ortho(et,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(et,et,[0,-l.EXTENT,0]),{u_matrix:et,u_image:1,u_dimension:[Ge,Ge],u_zoom:qe.overscaledZ,u_unpack:_e.getUnpackVector()}}(a.tileID,C),i.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function Cu(n,a,i,o,f){var d=o.paint.get("raster-fade-duration");if(d>0){var v=l.browser.now(),x=(v-n.timeAdded)/d,C=a?(v-a.timeAdded)/d:-1,F=i.getSource(),K=f.coveringZoomLevel({tileSize:F.tileSize,roundZoom:F.roundZoom}),ee=!a||Math.abs(a.tileID.overscaledZ-K)>Math.abs(n.tileID.overscaledZ-K),re=ee&&n.refreshedUponExpiration?1:l.clamp(ee?x:1-C,0,1);return n.refreshedUponExpiration&&x>=1&&(n.refreshedUponExpiration=!1),a?{opacity:1,mix:1-re}:{opacity:re,mix:0}}return{opacity:1,mix:0}}var Xs=new l.Color(1,0,0,1),sl=new l.Color(0,1,0,1),ul=new l.Color(0,0,1,1),Ys=new l.Color(1,0,1,1),Ll=new l.Color(0,1,1,1);function Dl(n,a,i,o){pu(n,0,a+i/2,n.transform.width,i,o)}function ll(n,a,i,o){pu(n,a-i/2,0,i,n.transform.height,o)}function pu(n,a,i,o,f,d){var v=n.context,x=v.gl;x.enable(x.SCISSOR_TEST),x.scissor(a*l.browser.devicePixelRatio,i*l.browser.devicePixelRatio,o*l.browser.devicePixelRatio,f*l.browser.devicePixelRatio),v.clear({color:d}),x.disable(x.SCISSOR_TEST)}function Jl(n,a,i){var o=n.context,f=o.gl,d=i.posMatrix,v=n.useProgram("debug"),x=ne.disabled,C=xe.disabled,F=n.colorModeForRenderPass();o.activeTexture.set(f.TEXTURE0),n.emptyTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE),v.draw(o,f.LINE_STRIP,x,C,F,Qe.disabled,Es(d,l.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var K=a.getTileByID(i.key).latestRawTileData,ee=Math.floor((K&&K.byteLength||0)/1024),re=a.getTile(i).tileSize,Pe=512/Math.min(re,512)*(i.overscaledZ/n.transform.zoom)*.5,Ce=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(Ce+=" => "+i.overscaledZ),function(qe,_e){qe.initDebugOverlayCanvas();var Ge=qe.debugOverlayCanvas,et=qe.context.gl,St=qe.debugOverlayCanvas.getContext("2d");St.clearRect(0,0,Ge.width,Ge.height),St.shadowColor="white",St.shadowBlur=2,St.lineWidth=1.5,St.strokeStyle="white",St.textBaseline="top",St.font="bold 36px Open Sans, sans-serif",St.fillText(_e,5,5),St.strokeText(_e,5,5),qe.debugOverlayTexture.update(Ge),qe.debugOverlayTexture.bind(et.LINEAR,et.CLAMP_TO_EDGE)}(n,Ce+" "+ee+"kb"),v.draw(o,f.TRIANGLES,x,C,Ne.alphaBlended,Qe.disabled,Es(d,l.Color.transparent,Pe),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var du={symbol:function(n,a,i,o,f){if(n.renderPass==="translucent"){var d=xe.disabled,v=n.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(x,C,F,K,ee,re,Pe){for(var Ce=C.transform,qe=ee==="map",_e=re==="map",Ge=0,et=x;Ge<et.length;Ge+=1){var St=et[Ge],$t=K.getTile(St),Zt=$t.getBucket(F);if(Zt&&Zt.text&&Zt.text.segments.get().length){var rr=l.evaluateSizeForZoom(Zt.textSizeData,Ce.zoom),Sr=Bi($t,1,C.transform.zoom),Ur=Qi(St.posMatrix,_e,qe,C.transform,Sr),Br=F.layout.get("icon-text-fit")!=="none"&&Zt.hasIconData();if(rr){var hn=Math.pow(2,Ce.zoom-$t.tileID.overscaledZ);al(Zt,qe,_e,Pe,l.symbolSize,Ce,Ur,St.posMatrix,hn,rr,Br)}}}}(o,n,i,a,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),f),i.paint.get("icon-opacity").constantOr(1)!==0&&Ws(n,a,i,o,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),d,v),i.paint.get("text-opacity").constantOr(1)!==0&&Ws(n,a,i,o,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),d,v),a.map.showCollisionBoxes&&(Hs(n,a,i,o,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),Hs(n,a,i,o,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))}},circle:function(n,a,i,o){if(n.renderPass==="translucent"){var f=i.paint.get("circle-opacity"),d=i.paint.get("circle-stroke-width"),v=i.paint.get("circle-stroke-opacity"),x=i.layout.get("circle-sort-key").constantOr(1)!==void 0;if(f.constantOr(1)!==0||d.constantOr(1)!==0&&v.constantOr(1)!==0){for(var C=n.context,F=C.gl,K=n.depthModeForSublayer(0,ne.ReadOnly),ee=xe.disabled,re=n.colorModeForRenderPass(),Pe=[],Ce=0;Ce<o.length;Ce++){var qe=o[Ce],_e=a.getTile(qe),Ge=_e.getBucket(i);if(Ge){var et=Ge.programConfigurations.get(i.id),St={programConfiguration:et,program:n.useProgram("circle",et),layoutVertexBuffer:Ge.layoutVertexBuffer,indexBuffer:Ge.indexBuffer,uniformValues:el(n,qe,_e,i)};if(x)for(var $t=0,Zt=Ge.segments.get();$t<Zt.length;$t+=1){var rr=Zt[$t];Pe.push({segments:new l.SegmentVector([rr]),sortKey:rr.sortKey,state:St})}else Pe.push({segments:Ge.segments,sortKey:0,state:St})}}x&&Pe.sort(function(Pn,Mn){return Pn.sortKey-Mn.sortKey});for(var Sr=0,Ur=Pe;Sr<Ur.length;Sr+=1){var Br=Ur[Sr],hn=Br.state;hn.program.draw(C,F.TRIANGLES,K,ee,re,Qe.disabled,hn.uniformValues,i.id,hn.layoutVertexBuffer,hn.indexBuffer,Br.segments,i.paint,n.transform.zoom,hn.programConfiguration)}}}},heatmap:function(n,a,i,o){if(i.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var f=n.context,d=f.gl,v=xe.disabled,x=new Ne([d.ONE,d.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(Pe,Ce,qe){var _e=Pe.gl;Pe.activeTexture.set(_e.TEXTURE1),Pe.viewport.set([0,0,Ce.width/4,Ce.height/4]);var Ge=qe.heatmapFbo;if(Ge)_e.bindTexture(_e.TEXTURE_2D,Ge.colorAttachment.get()),Pe.bindFramebuffer.set(Ge.framebuffer);else{var et=_e.createTexture();_e.bindTexture(_e.TEXTURE_2D,et),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_WRAP_S,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_WRAP_T,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_MIN_FILTER,_e.LINEAR),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_MAG_FILTER,_e.LINEAR),Ge=qe.heatmapFbo=Pe.createFramebuffer(Ce.width/4,Ce.height/4,!1),function(St,$t,Zt,rr){var Sr=St.gl;Sr.texImage2D(Sr.TEXTURE_2D,0,Sr.RGBA,$t.width/4,$t.height/4,0,Sr.RGBA,St.extRenderToTextureHalfFloat?St.extTextureHalfFloat.HALF_FLOAT_OES:Sr.UNSIGNED_BYTE,null),rr.colorAttachment.set(Zt)}(Pe,Ce,et,Ge)}})(f,n,i),f.clear({color:l.Color.transparent});for(var C=0;C<o.length;C++){var F=o[C];if(!a.hasRenderableParent(F)){var K=a.getTile(F),ee=K.getBucket(i);if(ee){var re=ee.programConfigurations.get(i.id);n.useProgram("heatmap",re).draw(f,d.TRIANGLES,ne.disabled,v,x,Qe.disabled,rl(F.posMatrix,K,n.transform.zoom,i.paint.get("heatmap-intensity")),i.id,ee.layoutVertexBuffer,ee.indexBuffer,ee.segments,i.paint,n.transform.zoom,re)}}}f.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(Pe,Ce){var qe=Pe.context,_e=qe.gl,Ge=Ce.heatmapFbo;if(Ge){qe.activeTexture.set(_e.TEXTURE0),_e.bindTexture(_e.TEXTURE_2D,Ge.colorAttachment.get()),qe.activeTexture.set(_e.TEXTURE1);var et=Ce.colorRampTexture;et||(et=Ce.colorRampTexture=new l.Texture(qe,Ce.colorRamp,_e.RGBA)),et.bind(_e.LINEAR,_e.CLAMP_TO_EDGE),Pe.useProgram("heatmapTexture").draw(qe,_e.TRIANGLES,ne.disabled,xe.disabled,Pe.colorModeForRenderPass(),Qe.disabled,function(St,$t,Zt,rr){var Sr=l.create();l.ortho(Sr,0,St.width,St.height,0,0,1);var Ur=St.context.gl;return{u_matrix:Sr,u_world:[Ur.drawingBufferWidth,Ur.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:$t.paint.get("heatmap-opacity")}}(Pe,Ce),Ce.id,Pe.viewportBuffer,Pe.quadTriangleIndexBuffer,Pe.viewportSegments,Ce.paint,Pe.transform.zoom)}}(n,i))},line:function(n,a,i,o){if(n.renderPass==="translucent"){var f=i.paint.get("line-opacity"),d=i.paint.get("line-width");if(f.constantOr(1)!==0&&d.constantOr(1)!==0)for(var v=n.depthModeForSublayer(0,ne.ReadOnly),x=n.colorModeForRenderPass(),C=i.paint.get("line-dasharray"),F=i.paint.get("line-pattern"),K=F.constantOr(1),ee=i.paint.get("line-gradient"),re=i.getCrossfadeParameters(),Pe=K?"linePattern":C?"lineSDF":ee?"lineGradient":"line",Ce=n.context,qe=Ce.gl,_e=!0,Ge=0,et=o;Ge<et.length;Ge+=1){var St=et[Ge],$t=a.getTile(St);if(!K||$t.patternsLoaded()){var Zt=$t.getBucket(i);if(Zt){var rr=Zt.programConfigurations.get(i.id),Sr=n.context.program.get(),Ur=n.useProgram(Pe,rr),Br=_e||Ur.program!==Sr,hn=F.constantOr(null);if(hn&&$t.imageAtlas){var Pn=$t.imageAtlas,Mn=Pn.patternPositions[hn.to.toString()],Rn=Pn.patternPositions[hn.from.toString()];Mn&&Rn&&rr.setConstantPatternPositions(Mn,Rn)}var Ei=K?qs(n,$t,i,re):C?Wl(n,$t,i,C,re):ee?Xi(n,$t,i,Zt.lineClipsArray.length):js(n,$t,i);if(K)Ce.activeTexture.set(qe.TEXTURE0),$t.imageAtlasTexture.bind(qe.LINEAR,qe.CLAMP_TO_EDGE),rr.updatePaintBuffers(re);else if(C&&(Br||n.lineAtlas.dirty))Ce.activeTexture.set(qe.TEXTURE0),n.lineAtlas.bind(Ce);else if(ee){var fn=Zt.gradients[i.id],Jn=fn.texture;if(i.gradientVersion!==fn.version){var ni=256;if(i.stepInterpolant){var qn=a.getSource().maxzoom,Bn=St.canonical.z===qn?Math.ceil(1<<n.transform.maxZoom-St.canonical.z):1;ni=l.clamp(l.nextPowerOfTwo(Zt.maxLineLength/l.EXTENT*1024*Bn),256,Ce.maxTextureSize)}fn.gradient=l.renderColorRamp({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:ni,image:fn.gradient||void 0,clips:Zt.lineClipsArray}),fn.texture?fn.texture.update(fn.gradient):fn.texture=new l.Texture(Ce,fn.gradient,qe.RGBA),fn.version=i.gradientVersion,Jn=fn.texture}Ce.activeTexture.set(qe.TEXTURE0),Jn.bind(i.stepInterpolant?qe.NEAREST:qe.LINEAR,qe.CLAMP_TO_EDGE)}Ur.draw(Ce,qe.TRIANGLES,v,n.stencilModeForClipping(St),x,Qe.disabled,Ei,i.id,Zt.layoutVertexBuffer,Zt.indexBuffer,Zt.segments,i.paint,n.transform.zoom,rr,Zt.layoutVertexBuffer2),_e=!1}}}}},fill:function(n,a,i,o){var f=i.paint.get("fill-color"),d=i.paint.get("fill-opacity");if(d.constantOr(1)!==0){var v=n.colorModeForRenderPass(),x=i.paint.get("fill-pattern"),C=n.opaquePassEnabledForLayer()&&!x.constantOr(1)&&f.constantOr(l.Color.transparent).a===1&&d.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===C){var F=n.depthModeForSublayer(1,n.renderPass==="opaque"?ne.ReadWrite:ne.ReadOnly);Au(n,a,i,o,F,v,!1)}if(n.renderPass==="translucent"&&i.paint.get("fill-antialias")){var K=n.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,ne.ReadOnly);Au(n,a,i,o,K,v,!0)}}},"fill-extrusion":function(n,a,i,o){var f=i.paint.get("fill-extrusion-opacity");if(f!==0&&n.renderPass==="translucent"){var d=new ne(n.context.gl.LEQUAL,ne.ReadWrite,n.depthRangeFor3D);if(f!==1||i.paint.get("fill-extrusion-pattern").constantOr(1))ol(n,a,i,o,d,xe.disabled,Ne.disabled),ol(n,a,i,o,d,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var v=n.colorModeForRenderPass();ol(n,a,i,o,d,xe.disabled,v)}}},hillshade:function(n,a,i,o){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var f=n.context,d=n.depthModeForSublayer(0,ne.ReadOnly),v=n.colorModeForRenderPass(),x=n.renderPass==="translucent"?n.stencilConfigForOverlap(o):[{},o],C=x[0],F=0,K=x[1];F<K.length;F+=1){var ee=K[F],re=a.getTile(ee);re.needsHillshadePrepare&&n.renderPass==="offscreen"?Kl(n,re,i,d,xe.disabled,v):n.renderPass==="translucent"&&Nu(n,re,i,d,C[ee.overscaledZ],v)}f.viewport.set([0,0,n.width,n.height])}},raster:function(n,a,i,o){if(n.renderPass==="translucent"&&i.paint.get("raster-opacity")!==0&&o.length)for(var f=n.context,d=f.gl,v=a.getSource(),x=n.useProgram("raster"),C=n.colorModeForRenderPass(),F=v instanceof D?[{},o]:n.stencilConfigForOverlap(o),K=F[0],ee=F[1],re=ee[ee.length-1].overscaledZ,Pe=!n.options.moving,Ce=0,qe=ee;Ce<qe.length;Ce+=1){var _e=qe[Ce],Ge=n.depthModeForSublayer(_e.overscaledZ-re,i.paint.get("raster-opacity")===1?ne.ReadWrite:ne.ReadOnly,d.LESS),et=a.getTile(_e),St=n.transform.calculatePosMatrix(_e.toUnwrapped(),Pe);et.registerFadeDuration(i.paint.get("raster-fade-duration"));var $t=a.findLoadedParent(_e,0),Zt=Cu(et,$t,a,i,n.transform),rr=void 0,Sr=void 0,Ur=i.paint.get("raster-resampling")==="nearest"?d.NEAREST:d.LINEAR;f.activeTexture.set(d.TEXTURE0),et.texture.bind(Ur,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),f.activeTexture.set(d.TEXTURE1),$t?($t.texture.bind(Ur,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),rr=Math.pow(2,$t.tileID.overscaledZ-et.tileID.overscaledZ),Sr=[et.tileID.canonical.x*rr%1,et.tileID.canonical.y*rr%1]):et.texture.bind(Ur,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST);var Br=Xl(St,Sr||[0,0],rr||1,Zt,i);v instanceof D?x.draw(f,d.TRIANGLES,Ge,xe.disabled,C,Qe.disabled,Br,i.id,v.boundsBuffer,n.quadTriangleIndexBuffer,v.boundsSegments):x.draw(f,d.TRIANGLES,Ge,K[_e.overscaledZ],C,Qe.disabled,Br,i.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,a,i){var o=i.paint.get("background-color"),f=i.paint.get("background-opacity");if(f!==0){var d=n.context,v=d.gl,x=n.transform,C=x.tileSize,F=i.paint.get("background-pattern");if(!n.isPatternMissing(F)){var K=!F&&o.a===1&&f===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===K){var ee=xe.disabled,re=n.depthModeForSublayer(0,K==="opaque"?ne.ReadWrite:ne.ReadOnly),Pe=n.colorModeForRenderPass(),Ce=n.useProgram(F?"backgroundPattern":"background"),qe=x.coveringTiles({tileSize:C});F&&(d.activeTexture.set(v.TEXTURE0),n.imageManager.bind(n.context));for(var _e=i.getCrossfadeParameters(),Ge=0,et=qe;Ge<et.length;Ge+=1){var St=et[Ge],$t=n.transform.calculatePosMatrix(St.toUnwrapped()),Zt=F?Ls($t,f,n,F,{tileID:St,tileSize:C},_e):hu($t,f,o);Ce.draw(d,v.TRIANGLES,re,ee,Pe,Qe.disabled,Zt,i.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,a,i){for(var o=0;o<i.length;o++)Jl(n,a,i[o])},custom:function(n,a,i){var o=n.context,f=i.implementation;if(n.renderPass==="offscreen"){var d=f.prerender;d&&(n.setCustomLayerDefaults(),o.setColorMode(n.colorModeForRenderPass()),d.call(f,o.gl,n.transform.customLayerMatrix()),o.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),o.setColorMode(n.colorModeForRenderPass()),o.setStencilMode(xe.disabled);var v=f.renderingMode==="3d"?new ne(n.context.gl.LEQUAL,ne.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,ne.ReadOnly);o.setDepthMode(v),f.render(o.gl,n.transform.customLayerMatrix()),o.setDirty(),n.setBaseState(),o.bindFramebuffer.set(null)}}},pa=function(n,a){this.context=new J(n),this.transform=a,this._tileTextures={},this.setup(),this.numSublayers=Me.maxUnderzooming+Me.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new za,this.gpuTimers={}};pa.prototype.resize=function(n,a){if(this.width=n*l.browser.devicePixelRatio,this.height=a*l.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var i=0,o=this.style._order;i<o.length;i+=1)this.style._layers[o[i]].resize()},pa.prototype.setup=function(){var n=this.context,a=new l.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(l.EXTENT,0),a.emplaceBack(0,l.EXTENT),a.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(a,Wi.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);var i=new l.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(l.EXTENT,0),i.emplaceBack(0,l.EXTENT),i.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=n.createVertexBuffer(i,Wi.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);var o=new l.StructArrayLayout4i8;o.emplaceBack(0,0,0,0),o.emplaceBack(l.EXTENT,0,l.EXTENT,0),o.emplaceBack(0,l.EXTENT,0,l.EXTENT),o.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(o,E.members),this.rasterBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);var f=new l.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(1,0),f.emplaceBack(0,1),f.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(f,Wi.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);var d=new l.StructArrayLayout1ui2;d.emplaceBack(0),d.emplaceBack(1),d.emplaceBack(3),d.emplaceBack(2),d.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(d);var v=new l.StructArrayLayout3ui6;v.emplaceBack(0,1,2),v.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(v),this.emptyTexture=new l.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var x=this.context.gl;this.stencilClearMode=new xe({func:x.ALWAYS,mask:0},0,255,x.ZERO,x.ZERO,x.ZERO)},pa.prototype.clearStencil=function(){var n=this.context,a=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var i=l.create();l.ortho(i,0,this.width,this.height,0,0,1),l.scale(i,i,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,a.TRIANGLES,ne.disabled,this.stencilClearMode,Ne.disabled,Qe.disabled,Wo(i),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},pa.prototype._renderTileClippingMasks=function(n,a){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&a&&a.length){this.currentStencilSource=n.source;var i=this.context,o=i.gl;this.nextStencilID+a.length>256&&this.clearStencil(),i.setColorMode(Ne.disabled),i.setDepthMode(ne.disabled);var f=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var d=0,v=a;d<v.length;d+=1){var x=v[d],C=this._tileClippingMaskIDs[x.key]=this.nextStencilID++;f.draw(i,o.TRIANGLES,ne.disabled,new xe({func:o.ALWAYS,mask:0},C,255,o.KEEP,o.KEEP,o.REPLACE),Ne.disabled,Qe.disabled,Wo(x.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},pa.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,a=this.context.gl;return new xe({func:a.NOTEQUAL,mask:255},n,255,a.KEEP,a.KEEP,a.REPLACE)},pa.prototype.stencilModeForClipping=function(n){var a=this.context.gl;return new xe({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,a.KEEP,a.KEEP,a.REPLACE)},pa.prototype.stencilConfigForOverlap=function(n){var a,i=this.context.gl,o=n.sort(function(C,F){return F.overscaledZ-C.overscaledZ}),f=o[o.length-1].overscaledZ,d=o[0].overscaledZ-f+1;if(d>1){this.currentStencilSource=void 0,this.nextStencilID+d>256&&this.clearStencil();for(var v={},x=0;x<d;x++)v[x+f]=new xe({func:i.GEQUAL,mask:255},x+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=d,[v,o]}return[(a={},a[f]=xe.disabled,a),o]},pa.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new Ne([n.CONSTANT_COLOR,n.ONE],new l.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ne.unblended:Ne.alphaBlended},pa.prototype.depthModeForSublayer=function(n,a,i){if(!this.opaquePassEnabledForLayer())return ne.disabled;var o=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new ne(i||this.context.gl.LEQUAL,a,[o,o])},pa.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},pa.prototype.render=function(n,a){var i=this;this.style=n,this.options=a,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(l.browser.now()),this.imageManager.beginFrame();var o=this.style._order,f=this.style.sourceCaches;for(var d in f){var v=f[d];v.used&&v.prepare(this.context)}var x,C,F={},K={},ee={};for(var re in f){var Pe=f[re];F[re]=Pe.getVisibleCoordinates(),K[re]=F[re].slice().reverse(),ee[re]=Pe.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Ce=0;Ce<o.length;Ce++)if(this.style._layers[o[Ce]].is3D()){this.opaquePassCutoff=Ce;break}this.renderPass="offscreen";for(var qe=0,_e=o;qe<_e.length;qe+=1){var Ge=this.style._layers[_e[qe]];if(Ge.hasOffscreenPass()&&!Ge.isHidden(this.transform.zoom)){var et=K[Ge.source];(Ge.type==="custom"||et.length)&&this.renderLayer(this,f[Ge.source],Ge,et)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=o.length-1;this.currentLayer>=0;this.currentLayer--){var St=this.style._layers[o[this.currentLayer]],$t=f[St.source],Zt=F[St.source];this._renderTileClippingMasks(St,Zt),this.renderLayer(this,$t,St,Zt)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<o.length;this.currentLayer++){var rr=this.style._layers[o[this.currentLayer]],Sr=f[rr.source],Ur=(rr.type==="symbol"?ee:K)[rr.source];this._renderTileClippingMasks(rr,F[rr.source]),this.renderLayer(this,Sr,rr,Ur)}this.options.showTileBoundaries&&(l.values(this.style._layers).forEach(function(Br){Br.source&&!Br.isHidden(i.transform.zoom)&&(Br.source!==(C&&C.id)&&(C=i.style.sourceCaches[Br.source]),(!x||x.getSource().maxzoom<C.getSource().maxzoom)&&(x=C))}),x&&du.debug(this,x,x.getVisibleCoordinates())),this.options.showPadding&&function(Br){var hn=Br.transform.padding;Dl(Br,Br.transform.height-(hn.top||0),3,Xs),Dl(Br,hn.bottom||0,3,sl),ll(Br,hn.left||0,3,ul),ll(Br,Br.transform.width-(hn.right||0),3,Ys);var Pn=Br.transform.centerPoint;(function(Mn,Rn,Ei,fn){pu(Mn,Rn-1,Ei-10,2,20,fn),pu(Mn,Rn-10,Ei-1,20,2,fn)})(Br,Pn.x,Br.transform.height-Pn.y,Ll)}(this),this.context.setDefault()},pa.prototype.renderLayer=function(n,a,i,o){i.isHidden(this.transform.zoom)||(i.type==="background"||i.type==="custom"||o.length)&&(this.id=i.id,this.gpuTimingStart(i),du[i.type](n,a,i,o,this.style.placement.variableOffsets),this.gpuTimingEnd())},pa.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var a=this.context.extTimerQuery,i=this.gpuTimers[n.id];i||(i=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),i.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,i.query)}},pa.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},pa.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},pa.prototype.queryGpuTimers=function(n){var a={};for(var i in n){var o=n[i],f=this.context.extTimerQuery,d=f.getQueryObjectEXT(o.query,f.QUERY_RESULT_EXT)/1e6;f.deleteQueryEXT(o.query),a[i]=d}return a},pa.prototype.translatePosMatrix=function(n,a,i,o,f){if(!i[0]&&!i[1])return n;var d=f?o==="map"?this.transform.angle:0:o==="viewport"?-this.transform.angle:0;if(d){var v=Math.sin(d),x=Math.cos(d);i=[i[0]*x-i[1]*v,i[0]*v+i[1]*x]}var C=[f?i[0]:Bi(a,i[0],this.transform.zoom),f?i[1]:Bi(a,i[1],this.transform.zoom),0],F=new Float32Array(16);return l.translate(F,n,C),F},pa.prototype.saveTileTexture=function(n){var a=this._tileTextures[n.size[0]];a?a.push(n):this._tileTextures[n.size[0]]=[n]},pa.prototype.getTileTexture=function(n){var a=this._tileTextures[n];return a&&a.length>0?a.pop():null},pa.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var a=this.imageManager.getPattern(n.from.toString()),i=this.imageManager.getPattern(n.to.toString());return!a||!i},pa.prototype.useProgram=function(n,a){this.cache=this.cache||{};var i=""+n+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[i]||(this.cache[i]=new Qu(this.context,n,Ao[n],a,fu[n],this._showOverdrawInspector)),this.cache[i]},pa.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},pa.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},pa.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=l.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},pa.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Iu=function(n,a){this.points=n,this.planes=a};Iu.fromInvProjectionMatrix=function(n,a,i){var o=Math.pow(2,i),f=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(v){return l.transformMat4([],v,n)}).map(function(v){return l.scale$1([],v,1/v[3]/a*o)}),d=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(v){var x=l.sub([],f[v[0]],f[v[1]]),C=l.sub([],f[v[2]],f[v[1]]),F=l.normalize([],l.cross([],x,C)),K=-l.dot(F,f[v[1]]);return F.concat(K)});return new Iu(f,d)};var mu=function(n,a){this.min=n,this.max=a,this.center=l.scale$2([],l.add([],this.min,this.max),.5)};mu.prototype.quadrant=function(n){for(var a=[n%2==0,n<2],i=l.clone$2(this.min),o=l.clone$2(this.max),f=0;f<a.length;f++)i[f]=a[f]?this.min[f]:this.center[f],o[f]=a[f]?this.center[f]:this.max[f];return o[2]=this.max[2],new mu(i,o)},mu.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},mu.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},mu.prototype.intersects=function(n){for(var a=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],i=!0,o=0;o<n.planes.length;o++){for(var f=n.planes[o],d=0,v=0;v<a.length;v++)d+=l.dot$1(f,a[v])>=0;if(d===0)return 0;d!==a.length&&(i=!1)}if(i)return 2;for(var x=0;x<3;x++){for(var C=Number.MAX_VALUE,F=-Number.MAX_VALUE,K=0;K<n.points.length;K++){var ee=n.points[K][x]-this.min[x];C=Math.min(C,ee),F=Math.max(F,ee)}if(F<0||C>this.max[x]-this.min[x])return 0}return 1};var Ss=function(n,a,i,o){if(n===void 0&&(n=0),a===void 0&&(a=0),i===void 0&&(i=0),o===void 0&&(o=0),isNaN(n)||n<0||isNaN(a)||a<0||isNaN(i)||i<0||isNaN(o)||o<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=a,this.left=i,this.right=o};Ss.prototype.interpolate=function(n,a,i){return a.top!=null&&n.top!=null&&(this.top=l.number(n.top,a.top,i)),a.bottom!=null&&n.bottom!=null&&(this.bottom=l.number(n.bottom,a.bottom,i)),a.left!=null&&n.left!=null&&(this.left=l.number(n.left,a.left,i)),a.right!=null&&n.right!=null&&(this.right=l.number(n.right,a.right,i)),this},Ss.prototype.getCenter=function(n,a){var i=l.clamp((this.left+n-this.right)/2,0,n),o=l.clamp((this.top+a-this.bottom)/2,0,a);return new l.Point(i,o)},Ss.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},Ss.prototype.clone=function(){return new Ss(this.top,this.bottom,this.left,this.right)},Ss.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var wi=function(n,a,i,o,f){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=f===void 0||f,this._minZoom=n||0,this._maxZoom=a||22,this._minPitch=i==null?0:i,this._maxPitch=o==null?60:o,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ss,this._posMatrixCache={},this._alignedPosMatrixCache={}},ia={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};wi.prototype.clone=function(){var n=new wi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},ia.minZoom.get=function(){return this._minZoom},ia.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},ia.maxZoom.get=function(){return this._maxZoom},ia.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},ia.minPitch.get=function(){return this._minPitch},ia.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},ia.maxPitch.get=function(){return this._maxPitch},ia.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},ia.renderWorldCopies.get=function(){return this._renderWorldCopies},ia.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},ia.worldSize.get=function(){return this.tileSize*this.scale},ia.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},ia.size.get=function(){return new l.Point(this.width,this.height)},ia.bearing.get=function(){return-this.angle/Math.PI*180},ia.bearing.set=function(n){var a=-l.wrap(n,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=l.create$2(),l.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},ia.pitch.get=function(){return this._pitch/Math.PI*180},ia.pitch.set=function(n){var a=l.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())},ia.fov.get=function(){return this._fov/Math.PI*180},ia.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},ia.zoom.get=function(){return this._zoom},ia.zoom.set=function(n){var a=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())},ia.center.get=function(){return this._center},ia.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},ia.padding.get=function(){return this._edgeInsets.toJSON()},ia.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},ia.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},wi.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},wi.prototype.interpolatePadding=function(n,a,i){this._unmodified=!1,this._edgeInsets.interpolate(n,a,i),this._constrain(),this._calcMatrices()},wi.prototype.coveringZoomLevel=function(n){var a=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,a)},wi.prototype.getVisibleUnwrappedCoordinates=function(n){var a=[new l.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var i=this.pointCoordinate(new l.Point(0,0)),o=this.pointCoordinate(new l.Point(this.width,0)),f=this.pointCoordinate(new l.Point(this.width,this.height)),d=this.pointCoordinate(new l.Point(0,this.height)),v=Math.floor(Math.min(i.x,o.x,f.x,d.x)),x=Math.floor(Math.max(i.x,o.x,f.x,d.x)),C=v-1;C<=x+1;C++)C!==0&&a.push(new l.UnwrappedTileID(C,n));return a},wi.prototype.coveringTiles=function(n){var a=this.coveringZoomLevel(n),i=a;if(n.minzoom!==void 0&&a<n.minzoom)return[];n.maxzoom!==void 0&&a>n.maxzoom&&(a=n.maxzoom);var o=l.MercatorCoordinate.fromLngLat(this.center),f=Math.pow(2,a),d=[f*o.x,f*o.y,0],v=Iu.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a),x=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(x=a);var C=function(Br){return{aabb:new mu([Br*f,0,0],[(Br+1)*f,f,0]),zoom:0,x:0,y:0,wrap:Br,fullyVisible:!1}},F=[],K=[],ee=a,re=n.reparseOverscaled?i:a;if(this._renderWorldCopies)for(var Pe=1;Pe<=3;Pe++)F.push(C(-Pe)),F.push(C(Pe));for(F.push(C(0));F.length>0;){var Ce=F.pop(),qe=Ce.x,_e=Ce.y,Ge=Ce.fullyVisible;if(!Ge){var et=Ce.aabb.intersects(v);if(et===0)continue;Ge=et===2}var St=Ce.aabb.distanceX(d),$t=Ce.aabb.distanceY(d),Zt=Math.max(Math.abs(St),Math.abs($t));if(Ce.zoom===ee||Zt>3+(1<<ee-Ce.zoom)-2&&Ce.zoom>=x)K.push({tileID:new l.OverscaledTileID(Ce.zoom===ee?re:Ce.zoom,Ce.wrap,Ce.zoom,qe,_e),distanceSq:l.sqrLen([d[0]-.5-qe,d[1]-.5-_e])});else for(var rr=0;rr<4;rr++){var Sr=(qe<<1)+rr%2,Ur=(_e<<1)+(rr>>1);F.push({aabb:Ce.aabb.quadrant(rr),zoom:Ce.zoom+1,x:Sr,y:Ur,wrap:Ce.wrap,fullyVisible:Ge})}}return K.sort(function(Br,hn){return Br.distanceSq-hn.distanceSq}).map(function(Br){return Br.tileID})},wi.prototype.resize=function(n,a){this.width=n,this.height=a,this.pixelsToGLUnits=[2/n,-2/a],this._constrain(),this._calcMatrices()},ia.unmodified.get=function(){return this._unmodified},wi.prototype.zoomScale=function(n){return Math.pow(2,n)},wi.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},wi.prototype.project=function(n){var a=l.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.Point(l.mercatorXfromLng(n.lng)*this.worldSize,l.mercatorYfromLat(a)*this.worldSize)},wi.prototype.unproject=function(n){return new l.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},ia.point.get=function(){return this.project(this.center)},wi.prototype.setLocationAtPoint=function(n,a){var i=this.pointCoordinate(a),o=this.pointCoordinate(this.centerPoint),f=this.locationCoordinate(n),d=new l.MercatorCoordinate(f.x-(i.x-o.x),f.y-(i.y-o.y));this.center=this.coordinateLocation(d),this._renderWorldCopies&&(this.center=this.center.wrap())},wi.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},wi.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},wi.prototype.locationCoordinate=function(n){return l.MercatorCoordinate.fromLngLat(n)},wi.prototype.coordinateLocation=function(n){return n.toLngLat()},wi.prototype.pointCoordinate=function(n){var a=[n.x,n.y,0,1],i=[n.x,n.y,1,1];l.transformMat4(a,a,this.pixelMatrixInverse),l.transformMat4(i,i,this.pixelMatrixInverse);var o=a[3],f=i[3],d=a[1]/o,v=i[1]/f,x=a[2]/o,C=i[2]/f,F=x===C?0:(0-x)/(C-x);return new l.MercatorCoordinate(l.number(a[0]/o,i[0]/f,F)/this.worldSize,l.number(d,v,F)/this.worldSize)},wi.prototype.coordinatePoint=function(n){var a=[n.x*this.worldSize,n.y*this.worldSize,0,1];return l.transformMat4(a,a,this.pixelMatrix),new l.Point(a[0]/a[3],a[1]/a[3])},wi.prototype.getBounds=function(){return new l.LngLatBounds().extend(this.pointLocation(new l.Point(0,0))).extend(this.pointLocation(new l.Point(this.width,0))).extend(this.pointLocation(new l.Point(this.width,this.height))).extend(this.pointLocation(new l.Point(0,this.height)))},wi.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new l.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},wi.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},wi.prototype.calculatePosMatrix=function(n,a){a===void 0&&(a=!1);var i=n.key,o=a?this._alignedPosMatrixCache:this._posMatrixCache;if(o[i])return o[i];var f=n.canonical,d=this.worldSize/this.zoomScale(f.z),v=f.x+Math.pow(2,f.z)*n.wrap,x=l.identity(new Float64Array(16));return l.translate(x,x,[v*d,f.y*d,0]),l.scale(x,x,[d/l.EXTENT,d/l.EXTENT,1]),l.multiply(x,a?this.alignedProjMatrix:this.projMatrix,x),o[i]=new Float32Array(x),o[i]},wi.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},wi.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,a,i,o,f=-90,d=90,v=-180,x=180,C=this.size,F=this._unmodified;if(this.latRange){var K=this.latRange;f=l.mercatorYfromLat(K[1])*this.worldSize,n=(d=l.mercatorYfromLat(K[0])*this.worldSize)-f<C.y?C.y/(d-f):0}if(this.lngRange){var ee=this.lngRange;v=l.mercatorXfromLng(ee[0])*this.worldSize,a=(x=l.mercatorXfromLng(ee[1])*this.worldSize)-v<C.x?C.x/(x-v):0}var re=this.point,Pe=Math.max(a||0,n||0);if(Pe)return this.center=this.unproject(new l.Point(a?(x+v)/2:re.x,n?(d+f)/2:re.y)),this.zoom+=this.scaleZoom(Pe),this._unmodified=F,void(this._constraining=!1);if(this.latRange){var Ce=re.y,qe=C.y/2;Ce-qe<f&&(o=f+qe),Ce+qe>d&&(o=d-qe)}if(this.lngRange){var _e=re.x,Ge=C.x/2;_e-Ge<v&&(i=v+Ge),_e+Ge>x&&(i=x-Ge)}i===void 0&&o===void 0||(this.center=this.unproject(new l.Point(i!==void 0?i:re.x,o!==void 0?o:re.y))),this._unmodified=F,this._constraining=!1}},wi.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var a=Math.PI/2+this._pitch,i=this._fov*(.5+n.y/this.height),o=Math.sin(i)*this.cameraToCenterDistance/Math.sin(l.clamp(Math.PI-a-i,.01,Math.PI-.01)),f=this.point,d=f.x,v=f.y,x=1.01*(Math.cos(Math.PI/2-this._pitch)*o+this.cameraToCenterDistance),C=this.height/50,F=new Float64Array(16);l.perspective(F,this._fov,this.width/this.height,C,x),F[8]=2*-n.x/this.width,F[9]=2*n.y/this.height,l.scale(F,F,[1,-1,1]),l.translate(F,F,[0,0,-this.cameraToCenterDistance]),l.rotateX(F,F,this._pitch),l.rotateZ(F,F,this.angle),l.translate(F,F,[-d,-v,0]),this.mercatorMatrix=l.scale([],F,[this.worldSize,this.worldSize,this.worldSize]),l.scale(F,F,[1,1,l.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=F,this.invProjMatrix=l.invert([],this.projMatrix);var K=this.width%2/2,ee=this.height%2/2,re=Math.cos(this.angle),Pe=Math.sin(this.angle),Ce=d-Math.round(d)+re*K+Pe*ee,qe=v-Math.round(v)+re*ee+Pe*K,_e=new Float64Array(F);if(l.translate(_e,_e,[Ce>.5?Ce-1:Ce,qe>.5?qe-1:qe,0]),this.alignedProjMatrix=_e,F=l.create(),l.scale(F,F,[this.width/2,-this.height/2,1]),l.translate(F,F,[1,-1,0]),this.labelPlaneMatrix=F,F=l.create(),l.scale(F,F,[1,-1,1]),l.translate(F,F,[-1,-1,0]),l.scale(F,F,[2/this.width,2/this.height,1]),this.glCoordMatrix=F,this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(F=l.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=F,this._posMatrixCache={},this._alignedPosMatrixCache={}}},wi.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new l.Point(0,0)),a=[n.x*this.worldSize,n.y*this.worldSize,0,1];return l.transformMat4(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance},wi.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.Point(0,n))},wi.prototype.getCameraQueryGeometry=function(n){var a=this.getCameraPoint();if(n.length===1)return[n[0],a];for(var i=a.x,o=a.y,f=a.x,d=a.y,v=0,x=n;v<x.length;v+=1){var C=x[v];i=Math.min(i,C.x),o=Math.min(o,C.y),f=Math.max(f,C.x),d=Math.max(d,C.y)}return[new l.Point(i,o),new l.Point(f,o),new l.Point(f,d),new l.Point(i,d),new l.Point(i,o)]},Object.defineProperties(wi.prototype,ia);var Io=function(n){var a,i,o,f;this._hashName=n&&encodeURIComponent(n),l.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(a=this._updateHashUnthrottled.bind(this),i=!1,o=null,f=function(){o=null,i&&(a(),o=setTimeout(f,300),i=!1)},function(){return i=!0,o||f(),o})};Io.prototype.addTo=function(n){return this._map=n,l.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Io.prototype.remove=function(){return l.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Io.prototype.getHashString=function(n){var a=this._map.getCenter(),i=Math.round(100*this._map.getZoom())/100,o=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),f=Math.pow(10,o),d=Math.round(a.lng*f)/f,v=Math.round(a.lat*f)/f,x=this._map.getBearing(),C=this._map.getPitch(),F="";if(F+=n?"/"+d+"/"+v+"/"+i:i+"/"+v+"/"+d,(x||C)&&(F+="/"+Math.round(10*x)/10),C&&(F+="/"+Math.round(C)),this._hashName){var K=this._hashName,ee=!1,re=l.window.location.hash.slice(1).split("&").map(function(Pe){var Ce=Pe.split("=")[0];return Ce===K?(ee=!0,Ce+"="+F):Pe}).filter(function(Pe){return Pe});return ee||re.push(K+"="+F),"#"+re.join("&")}return"#"+F},Io.prototype._getCurrentHash=function(){var n,a=this,i=l.window.location.hash.replace("#","");return this._hashName?(i.split("&").map(function(o){return o.split("=")}).forEach(function(o){o[0]===a._hashName&&(n=o)}),(n&&n[1]||"").split("/")):i.split("/")},Io.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(i){return isNaN(i)})){var a=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:a,pitch:+(n[4]||0)}),!0}return!1},Io.prototype._updateHashUnthrottled=function(){var n=l.window.location.href.replace(/(#.+)?$/,this.getHashString());try{l.window.history.replaceState(l.window.history.state,null,n)}catch(a){}};var ku={linearity:.3,easing:l.bezier(0,0,.3,1)},qo=l.extend({deceleration:2500,maxSpeed:1400},ku),Pu=l.extend({deceleration:20,maxSpeed:1400},ku),dc=l.extend({deceleration:1e3,maxSpeed:360},ku),mc=l.extend({deceleration:1e3,maxSpeed:90},ku),Vu=function(n){this._map=n,this.clear()};function Uu(n,a){(!n.duration||n.duration<a.duration)&&(n.duration=a.duration,n.easing=a.easing)}function Yo(n,a,i){var o=i.maxSpeed,f=i.linearity,d=i.deceleration,v=l.clamp(n*f/(a/1e3),-o,o),x=Math.abs(v)/(d*f);return{easing:i.easing,duration:1e3*x,amount:v*(x/2)}}Vu.prototype.clear=function(){this._inertiaBuffer=[]},Vu.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.browser.now(),settings:n})},Vu.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,a=l.browser.now();n.length>0&&a-n[0].time>160;)n.shift()},Vu.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var a={zoom:0,bearing:0,pitch:0,pan:new l.Point(0,0),pinchAround:void 0,around:void 0},i=0,o=this._inertiaBuffer;i<o.length;i+=1){var f=o[i].settings;a.zoom+=f.zoomDelta||0,a.bearing+=f.bearingDelta||0,a.pitch+=f.pitchDelta||0,f.panDelta&&a.pan._add(f.panDelta),f.around&&(a.around=f.around),f.pinchAround&&(a.pinchAround=f.pinchAround)}var d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(a.pan.mag()){var x=Yo(a.pan.mag(),d,l.extend({},qo,n||{}));v.offset=a.pan.mult(x.amount/a.pan.mag()),v.center=this._map.transform.center,Uu(v,x)}if(a.zoom){var C=Yo(a.zoom,d,Pu);v.zoom=this._map.transform.zoom+C.amount,Uu(v,C)}if(a.bearing){var F=Yo(a.bearing,d,dc);v.bearing=this._map.transform.bearing+l.clamp(F.amount,-179,179),Uu(v,F)}if(a.pitch){var K=Yo(a.pitch,d,mc);v.pitch=this._map.transform.pitch+K.amount,Uu(v,K)}if(v.zoom||v.bearing){var ee=a.pinchAround===void 0?a.around:a.pinchAround;v.around=ee?this._map.unproject(ee):this._map.getCenter()}return this.clear(),l.extend(v,{noMoveStart:!0})}};var Sa=function(n){function a(o,f,d,v){v===void 0&&(v={});var x=ge.mousePos(f.getCanvasContainer(),d),C=f.unproject(x);n.call(this,o,l.extend({point:x,lngLat:C,originalEvent:d},v)),this._defaultPrevented=!1,this.target=f}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var i={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,i),a}(l.Event),Ts=function(n){function a(o,f,d){var v=o==="touchend"?d.changedTouches:d.touches,x=ge.touchPos(f.getCanvasContainer(),v),C=x.map(function(ee){return f.unproject(ee)}),F=x.reduce(function(ee,re,Pe,Ce){return ee.add(re.div(Ce.length))},new l.Point(0,0)),K=f.unproject(F);n.call(this,o,{points:x,point:F,lngLats:C,lngLat:K,originalEvent:d}),this._defaultPrevented=!1}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var i={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,i),a}(l.Event),As=function(n){function a(o,f,d){n.call(this,o,{originalEvent:d}),this._defaultPrevented=!1}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var i={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,i),a}(l.Event),Ba=function(n,a){this._map=n,this._clickTolerance=a.clickTolerance};Ba.prototype.reset=function(){delete this._mousedownPos},Ba.prototype.wheel=function(n){return this._firePreventable(new As(n.type,this._map,n))},Ba.prototype.mousedown=function(n,a){return this._mousedownPos=a,this._firePreventable(new Sa(n.type,this._map,n))},Ba.prototype.mouseup=function(n){this._map.fire(new Sa(n.type,this._map,n))},Ba.prototype.click=function(n,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new Sa(n.type,this._map,n))},Ba.prototype.dblclick=function(n){return this._firePreventable(new Sa(n.type,this._map,n))},Ba.prototype.mouseover=function(n){this._map.fire(new Sa(n.type,this._map,n))},Ba.prototype.mouseout=function(n){this._map.fire(new Sa(n.type,this._map,n))},Ba.prototype.touchstart=function(n){return this._firePreventable(new Ts(n.type,this._map,n))},Ba.prototype.touchmove=function(n){this._map.fire(new Ts(n.type,this._map,n))},Ba.prototype.touchend=function(n){this._map.fire(new Ts(n.type,this._map,n))},Ba.prototype.touchcancel=function(n){this._map.fire(new Ts(n.type,this._map,n))},Ba.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},Ba.prototype.isEnabled=function(){return!0},Ba.prototype.isActive=function(){return!1},Ba.prototype.enable=function(){},Ba.prototype.disable=function(){};var dn=function(n){this._map=n};dn.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},dn.prototype.mousemove=function(n){this._map.fire(new Sa(n.type,this._map,n))},dn.prototype.mousedown=function(){this._delayContextMenu=!0},dn.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Sa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},dn.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Sa(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},dn.prototype.isEnabled=function(){return!0},dn.prototype.isActive=function(){return!1},dn.prototype.enable=function(){},dn.prototype.disable=function(){};var da=function(n,a){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=a.clickTolerance||1};function Ds(n,a){for(var i={},o=0;o<n.length;o++)i[n[o].identifier]=a[o];return i}da.prototype.isEnabled=function(){return!!this._enabled},da.prototype.isActive=function(){return!!this._active},da.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},da.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},da.prototype.mousedown=function(n,a){this.isEnabled()&&n.shiftKey&&n.button===0&&(ge.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)},da.prototype.mousemoveWindow=function(n,a){if(this._active){var i=a;if(!(this._lastPos.equals(i)||!this._box&&i.dist(this._startPos)<this._clickTolerance)){var o=this._startPos;this._lastPos=i,this._box||(this._box=ge.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var f=Math.min(o.x,i.x),d=Math.max(o.x,i.x),v=Math.min(o.y,i.y),x=Math.max(o.y,i.y);ge.setTransform(this._box,"translate("+f+"px,"+v+"px)"),this._box.style.width=d-f+"px",this._box.style.height=x-v+"px"}}},da.prototype.mouseupWindow=function(n,a){var i=this;if(this._active&&n.button===0){var o=this._startPos,f=a;if(this.reset(),ge.suppressClick(),o.x!==f.x||o.y!==f.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(d){return d.fitScreenCoordinates(o,f,i._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},da.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},da.prototype.blur=function(){this.reset()},da.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(ge.remove(this._box),this._box=null),ge.enableDrag(),delete this._startPos,delete this._lastPos},da.prototype._fireEvent=function(n,a){return this._map.fire(new l.Event(n,{originalEvent:a}))};var vu=function(n){this.reset(),this.numTouches=n.numTouches};vu.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},vu.prototype.touchstart=function(n,a,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),i.length===this.numTouches&&(this.centroid=function(o){for(var f=new l.Point(0,0),d=0,v=o;d<v.length;d+=1)f._add(v[d]);return f.div(o.length)}(a),this.touches=Ds(i,a)))},vu.prototype.touchmove=function(n,a,i){if(!this.aborted&&this.centroid){var o=Ds(i,a);for(var f in this.touches){var d=o[f];(!d||d.dist(this.touches[f])>30)&&(this.aborted=!0)}}},vu.prototype.touchend=function(n,a,i){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),i.length===0){var o=!this.aborted&&this.centroid;if(this.reset(),o)return o}};var Ko=function(n){this.singleTap=new vu(n),this.numTaps=n.numTaps,this.reset()};Ko.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Ko.prototype.touchstart=function(n,a,i){this.singleTap.touchstart(n,a,i)},Ko.prototype.touchmove=function(n,a,i){this.singleTap.touchmove(n,a,i)},Ko.prototype.touchend=function(n,a,i){var o=this.singleTap.touchend(n,a,i);if(o){var f=n.timeStamp-this.lastTime<500,d=!this.lastTap||this.lastTap.dist(o)<30;if(f&&d||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=o,this.count===this.numTaps)return this.reset(),o}};var Oo=function(){this._zoomIn=new Ko({numTouches:1,numTaps:2}),this._zoomOut=new Ko({numTouches:2,numTaps:1}),this.reset()};Oo.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Oo.prototype.touchstart=function(n,a,i){this._zoomIn.touchstart(n,a,i),this._zoomOut.touchstart(n,a,i)},Oo.prototype.touchmove=function(n,a,i){this._zoomIn.touchmove(n,a,i),this._zoomOut.touchmove(n,a,i)},Oo.prototype.touchend=function(n,a,i){var o=this,f=this._zoomIn.touchend(n,a,i),d=this._zoomOut.touchend(n,a,i);return f?(this._active=!0,n.preventDefault(),setTimeout(function(){return o.reset()},0),{cameraAnimation:function(v){return v.easeTo({duration:300,zoom:v.getZoom()+1,around:v.unproject(f)},{originalEvent:n})}}):d?(this._active=!0,n.preventDefault(),setTimeout(function(){return o.reset()},0),{cameraAnimation:function(v){return v.easeTo({duration:300,zoom:v.getZoom()-1,around:v.unproject(d)},{originalEvent:n})}}):void 0},Oo.prototype.touchcancel=function(){this.reset()},Oo.prototype.enable=function(){this._enabled=!0},Oo.prototype.disable=function(){this._enabled=!1,this.reset()},Oo.prototype.isEnabled=function(){return this._enabled},Oo.prototype.isActive=function(){return this._active};var Rl={0:1,2:2},Zr=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};Zr.prototype.blur=function(){this.reset()},Zr.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Zr.prototype._correctButton=function(n,a){return!1},Zr.prototype._move=function(n,a){return{}},Zr.prototype.mousedown=function(n,a){if(!this._lastPoint){var i=ge.mouseButton(n);this._correctButton(n,i)&&(this._lastPoint=a,this._eventButton=i)}},Zr.prototype.mousemoveWindow=function(n,a){var i=this._lastPoint;if(i){if(n.preventDefault(),function(o,f){var d=Rl[f];return o.buttons===void 0||(o.buttons&d)!==d}(n,this._eventButton))this.reset();else if(this._moved||!(a.dist(i)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(i,a)}},Zr.prototype.mouseupWindow=function(n){this._lastPoint&&ge.mouseButton(n)===this._eventButton&&(this._moved&&ge.suppressClick(),this.reset())},Zr.prototype.enable=function(){this._enabled=!0},Zr.prototype.disable=function(){this._enabled=!1,this.reset()},Zr.prototype.isEnabled=function(){return this._enabled},Zr.prototype.isActive=function(){return this._active};var Ks=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.mousedown=function(i,o){n.prototype.mousedown.call(this,i,o),this._lastPoint&&(this._active=!0)},a.prototype._correctButton=function(i,o){return o===0&&!i.ctrlKey},a.prototype._move=function(i,o){return{around:o,panDelta:o.sub(i)}},a}(Zr),Gu=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype._correctButton=function(i,o){return o===0&&i.ctrlKey||o===2},a.prototype._move=function(i,o){var f=.8*(o.x-i.x);if(f)return this._active=!0,{bearingDelta:f}},a.prototype.contextmenu=function(i){i.preventDefault()},a}(Zr),Js=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype._correctButton=function(i,o){return o===0&&i.ctrlKey||o===2},a.prototype._move=function(i,o){var f=-.5*(o.y-i.y);if(f)return this._active=!0,{pitchDelta:f}},a.prototype.contextmenu=function(i){i.preventDefault()},a}(Zr),ua=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};ua.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new l.Point(0,0)},ua.prototype.touchstart=function(n,a,i){return this._calculateTransform(n,a,i)},ua.prototype.touchmove=function(n,a,i){if(this._active&&!(i.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,a,i)},ua.prototype.touchend=function(n,a,i){this._calculateTransform(n,a,i),this._active&&i.length<this._minTouches&&this.reset()},ua.prototype.touchcancel=function(){this.reset()},ua.prototype._calculateTransform=function(n,a,i){i.length>0&&(this._active=!0);var o=Ds(i,a),f=new l.Point(0,0),d=new l.Point(0,0),v=0;for(var x in o){var C=o[x],F=this._touches[x];F&&(f._add(C),d._add(C.sub(F)),v++,o[x]=C)}if(this._touches=o,!(v<this._minTouches)&&d.mag()){var K=d.div(v);if(this._sum._add(K),!(this._sum.mag()<this._clickTolerance))return{around:f.div(v),panDelta:K}}},ua.prototype.enable=function(){this._enabled=!0},ua.prototype.disable=function(){this._enabled=!1,this.reset()},ua.prototype.isEnabled=function(){return this._enabled},ua.prototype.isActive=function(){return this._active};var ko=function(){this.reset()};function cl(n,a,i){for(var o=0;o<n.length;o++)if(n[o].identifier===i)return a[o]}function Cs(n,a){return Math.log(n/a)/Math.LN2}ko.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},ko.prototype._start=function(n){},ko.prototype._move=function(n,a,i){return{}},ko.prototype.touchstart=function(n,a,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([a[0],a[1]]))},ko.prototype.touchmove=function(n,a,i){if(this._firstTwoTouches){n.preventDefault();var o=this._firstTwoTouches,f=o[1],d=cl(i,a,o[0]),v=cl(i,a,f);if(d&&v){var x=this._aroundCenter?null:d.add(v).div(2);return this._move([d,v],x,n)}}},ko.prototype.touchend=function(n,a,i){if(this._firstTwoTouches){var o=this._firstTwoTouches,f=o[1],d=cl(i,a,o[0]),v=cl(i,a,f);d&&v||(this._active&&ge.suppressClick(),this.reset())}},ko.prototype.touchcancel=function(){this.reset()},ko.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},ko.prototype.disable=function(){this._enabled=!1,this.reset()},ko.prototype.isEnabled=function(){return this._enabled},ko.prototype.isActive=function(){return this._active};var lo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},a.prototype._start=function(i){this._startDistance=this._distance=i[0].dist(i[1])},a.prototype._move=function(i,o){var f=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(Cs(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Cs(this._distance,f),pinchAround:o}},a}(ko);function fs(n,a){return 180*n.angleWith(a)/Math.PI}var $l=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},a.prototype._start=function(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])},a.prototype._move=function(i,o){var f=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:fs(this._vector,f),pinchAround:o}},a.prototype._isBelowThreshold=function(i){this._minDiameter=Math.min(this._minDiameter,i.mag());var o=25/(Math.PI*this._minDiameter)*360,f=fs(i,this._startVector);return Math.abs(f)<o},a}(ko);function ju(n){return Math.abs(n.y)>Math.abs(n.x)}var hl=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},a.prototype._start=function(i){this._lastPoints=i,ju(i[0].sub(i[1]))&&(this._valid=!1)},a.prototype._move=function(i,o,f){var d=i[0].sub(this._lastPoints[0]),v=i[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(d,v,f.timeStamp),this._valid)return this._lastPoints=i,this._active=!0,{pitchDelta:(d.y+v.y)/2*-.5}},a.prototype.gestureBeginsVertically=function(i,o,f){if(this._valid!==void 0)return this._valid;var d=i.mag()>=2,v=o.mag()>=2;if(d||v){if(!d||!v)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;var x=i.y>0==o.y>0;return ju(i)&&ju(o)&&x}},a}(ko),Ql={panStep:100,bearingStep:15,pitchStep:10},g=function(){var n=Ql;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function I(n){return n*(2-n)}g.prototype.blur=function(){this.reset()},g.prototype.reset=function(){this._active=!1},g.prototype.keydown=function(n){var a=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var i=0,o=0,f=0,d=0,v=0;switch(n.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:n.shiftKey?o=-1:(n.preventDefault(),d=-1);break;case 39:n.shiftKey?o=1:(n.preventDefault(),d=1);break;case 38:n.shiftKey?f=1:(n.preventDefault(),v=-1);break;case 40:n.shiftKey?f=-1:(n.preventDefault(),v=1);break;default:return}return this._rotationDisabled&&(o=0,f=0),{cameraAnimation:function(x){var C=x.getZoom();x.easeTo({duration:300,easeId:"keyboardHandler",easing:I,zoom:i?Math.round(C)+i*(n.shiftKey?2:1):C,bearing:x.getBearing()+o*a._bearingStep,pitch:x.getPitch()+f*a._pitchStep,offset:[-d*a._panStep,-v*a._panStep],center:x.getCenter()},{originalEvent:n})}}}},g.prototype.enable=function(){this._enabled=!0},g.prototype.disable=function(){this._enabled=!1,this.reset()},g.prototype.isEnabled=function(){return this._enabled},g.prototype.isActive=function(){return this._active},g.prototype.disableRotation=function(){this._rotationDisabled=!0},g.prototype.enableRotation=function(){this._rotationDisabled=!1};var $=function(n,a){this._map=n,this._el=n.getCanvasContainer(),this._handler=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,l.bindAll(["_onTimeout"],this)};$.prototype.setZoomRate=function(n){this._defaultZoomRate=n},$.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},$.prototype.isEnabled=function(){return!!this._enabled},$.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},$.prototype.isZooming=function(){return!!this._zooming},$.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},$.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},$.prototype.wheel=function(n){if(this.isEnabled()){var a=n.deltaMode===l.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,i=l.browser.now(),o=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,a!==0&&a%4.000244140625==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":o>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(o*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),n.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=n,this._delta-=a,this._active||this._start(n)),n.preventDefault()}},$.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},$.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var a=ge.mousePos(this._el,n);this._around=l.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(a)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},$.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var a=this._map.transform;if(this._delta!==0){var i=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,o=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&o!==0&&(o=1/o);var f=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(f*o))),this._type==="wheel"&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var d,v=typeof this._targetZoom=="number"?this._targetZoom:a.zoom,x=this._startZoom,C=this._easing,F=!1;if(this._type==="wheel"&&x&&C){var K=Math.min((l.browser.now()-this._lastWheelEventTime)/200,1),ee=C(K);d=l.number(x,v,ee),K<1?this._frameId||(this._frameId=!0):F=!0}else d=v,F=!0;return this._active=!0,F&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!F,zoomDelta:d-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},$.prototype._smoothOutEasing=function(n){var a=l.ease;if(this._prevEase){var i=this._prevEase,o=(l.browser.now()-i.start)/i.duration,f=i.easing(o+.01)-i.easing(o),d=.27/Math.sqrt(f*f+1e-4)*.01,v=Math.sqrt(.0729-d*d);a=l.bezier(d,v,.25,1)}return this._prevEase={start:l.browser.now(),duration:n,easing:a},a},$.prototype.blur=function(){this.reset()},$.prototype.reset=function(){this._active=!1};var le=function(n,a){this._clickZoom=n,this._tapZoom=a};le.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},le.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},le.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},le.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var st=function(){this.reset()};st.prototype.reset=function(){this._active=!1},st.prototype.blur=function(){this.reset()},st.prototype.dblclick=function(n,a){return n.preventDefault(),{cameraAnimation:function(i){i.easeTo({duration:300,zoom:i.getZoom()+(n.shiftKey?-1:1),around:i.unproject(a)},{originalEvent:n})}}},st.prototype.enable=function(){this._enabled=!0},st.prototype.disable=function(){this._enabled=!1,this.reset()},st.prototype.isEnabled=function(){return this._enabled},st.prototype.isActive=function(){return this._active};var tt=function(){this._tap=new Ko({numTouches:1,numTaps:1}),this.reset()};tt.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},tt.prototype.touchstart=function(n,a,i){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?i.length>0&&(this._swipePoint=a[0],this._swipeTouch=i[0].identifier):this._tap.touchstart(n,a,i))},tt.prototype.touchmove=function(n,a,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;var o=a[0],f=o.y-this._swipePoint.y;return this._swipePoint=o,n.preventDefault(),this._active=!0,{zoomDelta:f/128}}}else this._tap.touchmove(n,a,i)},tt.prototype.touchend=function(n,a,i){this._tapTime?this._swipePoint&&i.length===0&&this.reset():this._tap.touchend(n,a,i)&&(this._tapTime=n.timeStamp)},tt.prototype.touchcancel=function(){this.reset()},tt.prototype.enable=function(){this._enabled=!0},tt.prototype.disable=function(){this._enabled=!1,this.reset()},tt.prototype.isEnabled=function(){return this._enabled},tt.prototype.isActive=function(){return this._active};var _t=function(n,a,i){this._el=n,this._mousePan=a,this._touchPan=i};_t.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},_t.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},_t.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},_t.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Xt=function(n,a,i){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=a,this._mousePitch=i};Xt.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Xt.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Xt.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Xt.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var sr=function(n,a,i,o){this._el=n,this._touchZoom=a,this._touchRotate=i,this._tapDragZoom=o,this._rotationDisabled=!1,this._enabled=!0};sr.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},sr.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},sr.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},sr.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},sr.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},sr.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Jr=function(n){return n.zoom||n.drag||n.pitch||n.rotate},Tn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a}(l.Event);function tr(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var or=function(n,a){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Vu(n),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a),l.bindAll(["handleEvent","handleWindowEvent"],this);var i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[l.window.document,"mousemove",{capture:!0}],[l.window.document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[l.window,"blur",void 0]];for(var o=0,f=this._listeners;o<f.length;o+=1){var d=f[o],v=d[0];ge.addEventListener(v,d[1],v===l.window.document?this.handleWindowEvent:this.handleEvent,d[2])}};or.prototype.destroy=function(){for(var n=0,a=this._listeners;n<a.length;n+=1){var i=a[n],o=i[0];ge.removeEventListener(o,i[1],o===l.window.document?this.handleWindowEvent:this.handleEvent,i[2])}},or.prototype._addDefaultHandlers=function(n){var a=this._map,i=a.getCanvasContainer();this._add("mapEvent",new Ba(a,n));var o=a.boxZoom=new da(a,n);this._add("boxZoom",o);var f=new Oo,d=new st;a.doubleClickZoom=new le(d,f),this._add("tapZoom",f),this._add("clickZoom",d);var v=new tt;this._add("tapDragZoom",v);var x=a.touchPitch=new hl;this._add("touchPitch",x);var C=new Gu(n),F=new Js(n);a.dragRotate=new Xt(n,C,F),this._add("mouseRotate",C,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]);var K=new Ks(n),ee=new ua(n);a.dragPan=new _t(i,K,ee),this._add("mousePan",K),this._add("touchPan",ee,["touchZoom","touchRotate"]);var re=new $l,Pe=new lo;a.touchZoomRotate=new sr(i,Pe,re,v),this._add("touchRotate",re,["touchPan","touchZoom"]),this._add("touchZoom",Pe,["touchPan","touchRotate"]);var Ce=a.scrollZoom=new $(a,this);this._add("scrollZoom",Ce,["mousePan"]);var qe=a.keyboard=new g;this._add("keyboard",qe),this._add("blockableMapEvent",new dn(a));for(var _e=0,Ge=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];_e<Ge.length;_e+=1){var et=Ge[_e];n.interactive&&n[et]&&a[et].enable(n[et])}},or.prototype._add=function(n,a,i){this._handlers.push({handlerName:n,handler:a,allowed:i}),this._handlersById[n]=a},or.prototype.stop=function(n){if(!this._updatingCamera){for(var a=0,i=this._handlers;a<i.length;a+=1)i[a].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},or.prototype.isActive=function(){for(var n=0,a=this._handlers;n<a.length;n+=1)if(a[n].handler.isActive())return!0;return!1},or.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},or.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},or.prototype.isMoving=function(){return Boolean(Jr(this._eventsInProgress))||this.isZooming()},or.prototype._blockedByActive=function(n,a,i){for(var o in n)if(o!==i&&(!a||a.indexOf(o)<0))return!0;return!1},or.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},or.prototype._getMapTouches=function(n){for(var a=[],i=0,o=n;i<o.length;i+=1){var f=o[i];this._el.contains(f.target)&&a.push(f)}return a},or.prototype.handleEvent=function(n,a){this._updatingCamera=!0;for(var i=n.type==="renderFrame"?void 0:n,o={needsRenderFrame:!1},f={},d={},v=n.touches?this._getMapTouches(n.touches):void 0,x=v?ge.touchPos(this._el,v):ge.mousePos(this._el,n),C=0,F=this._handlers;C<F.length;C+=1){var K=F[C],ee=K.handlerName,re=K.handler,Pe=K.allowed;if(re.isEnabled()){var Ce=void 0;this._blockedByActive(d,Pe,ee)?re.reset():re[a||n.type]&&(Ce=re[a||n.type](n,x,v),this.mergeHandlerResult(o,f,Ce,ee,i),Ce&&Ce.needsRenderFrame&&this._triggerRenderFrame()),(Ce||re.isActive())&&(d[ee]=re)}}var qe={};for(var _e in this._previousActiveHandlers)d[_e]||(qe[_e]=i);this._previousActiveHandlers=d,(Object.keys(qe).length||tr(o))&&(this._changes.push([o,f,qe]),this._triggerRenderFrame()),(Object.keys(d).length||tr(o))&&this._map._stop(!0),this._updatingCamera=!1;var Ge=o.cameraAnimation;Ge&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Ge(this._map))},or.prototype.mergeHandlerResult=function(n,a,i,o,f){if(i){l.extend(n,i);var d={handlerName:o,originalEvent:i.originalEvent||f};i.zoomDelta!==void 0&&(a.zoom=d),i.panDelta!==void 0&&(a.drag=d),i.pitchDelta!==void 0&&(a.pitch=d),i.bearingDelta!==void 0&&(a.rotate=d)}},or.prototype._applyChanges=function(){for(var n={},a={},i={},o=0,f=this._changes;o<f.length;o+=1){var d=f[o],v=d[0],x=d[1],C=d[2];v.panDelta&&(n.panDelta=(n.panDelta||new l.Point(0,0))._add(v.panDelta)),v.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+v.pitchDelta),v.around!==void 0&&(n.around=v.around),v.pinchAround!==void 0&&(n.pinchAround=v.pinchAround),v.noInertia&&(n.noInertia=v.noInertia),l.extend(a,x),l.extend(i,C)}this._updateMapTransform(n,a,i),this._changes=[]},or.prototype._updateMapTransform=function(n,a,i){var o=this._map,f=o.transform;if(!tr(n))return this._fireEvents(a,i,!0);var d=n.panDelta,v=n.zoomDelta,x=n.bearingDelta,C=n.pitchDelta,F=n.around,K=n.pinchAround;K!==void 0&&(F=K),o._stop(!0),F=F||o.transform.centerPoint;var ee=f.pointLocation(d?F.sub(d):F);x&&(f.bearing+=x),C&&(f.pitch+=C),v&&(f.zoom+=v),f.setLocationAtPoint(ee,F),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(a,i,!0)},or.prototype._fireEvents=function(n,a,i){var o=this,f=Jr(this._eventsInProgress),d=Jr(n),v={};for(var x in n)this._eventsInProgress[x]||(v[x+"start"]=n[x].originalEvent),this._eventsInProgress[x]=n[x];for(var C in!f&&d&&this._fireEvent("movestart",d.originalEvent),v)this._fireEvent(C,v[C]);for(var F in d&&this._fireEvent("move",d.originalEvent),n)this._fireEvent(F,n[F].originalEvent);var K,ee={};for(var re in this._eventsInProgress){var Pe=this._eventsInProgress[re],Ce=Pe.handlerName,qe=Pe.originalEvent;this._handlersById[Ce].isActive()||(delete this._eventsInProgress[re],ee[re+"end"]=K=a[Ce]||qe)}for(var _e in ee)this._fireEvent(_e,ee[_e]);var Ge=Jr(this._eventsInProgress);if(i&&(f||d)&&!Ge){this._updatingCamera=!0;var et=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),St=function($t){return $t!==0&&-o._bearingSnap<$t&&$t<o._bearingSnap};et?(St(et.bearing||this._map.getBearing())&&(et.bearing=0),this._map.easeTo(et,{originalEvent:K})):(this._map.fire(new l.Event("moveend",{originalEvent:K})),St(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},or.prototype._fireEvent=function(n,a){this._map.fire(new l.Event(n,a?{originalEvent:a}:{}))},or.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(a){delete n._frameId,n.handleEvent(new Tn("renderFrame",{timeStamp:a})),n._applyChanges()})},or.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var jn=function(n){function a(i,o){n.call(this),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=o.bearingSnap,l.bindAll(["_renderFrameCallback"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getCenter=function(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)},a.prototype.setCenter=function(i,o){return this.jumpTo({center:i},o)},a.prototype.panBy=function(i,o,f){return i=l.Point.convert(i).mult(-1),this.panTo(this.transform.center,l.extend({offset:i},o),f)},a.prototype.panTo=function(i,o,f){return this.easeTo(l.extend({center:i},o),f)},a.prototype.getZoom=function(){return this.transform.zoom},a.prototype.setZoom=function(i,o){return this.jumpTo({zoom:i},o),this},a.prototype.zoomTo=function(i,o,f){return this.easeTo(l.extend({zoom:i},o),f)},a.prototype.zoomIn=function(i,o){return this.zoomTo(this.getZoom()+1,i,o),this},a.prototype.zoomOut=function(i,o){return this.zoomTo(this.getZoom()-1,i,o),this},a.prototype.getBearing=function(){return this.transform.bearing},a.prototype.setBearing=function(i,o){return this.jumpTo({bearing:i},o),this},a.prototype.getPadding=function(){return this.transform.padding},a.prototype.setPadding=function(i,o){return this.jumpTo({padding:i},o),this},a.prototype.rotateTo=function(i,o,f){return this.easeTo(l.extend({bearing:i},o),f)},a.prototype.resetNorth=function(i,o){return this.rotateTo(0,l.extend({duration:1e3},i),o),this},a.prototype.resetNorthPitch=function(i,o){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},i),o),this},a.prototype.snapToNorth=function(i,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,o):this},a.prototype.getPitch=function(){return this.transform.pitch},a.prototype.setPitch=function(i,o){return this.jumpTo({pitch:i},o),this},a.prototype.cameraForBounds=function(i,o){i=l.LngLatBounds.convert(i);var f=o&&o.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),f,o)},a.prototype._cameraForBoxAndBearing=function(i,o,f,d){var v={top:0,bottom:0,right:0,left:0};if(typeof(d=l.extend({padding:v,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){var x=d.padding;d.padding={top:x,bottom:x,right:x,left:x}}d.padding=l.extend(v,d.padding);var C=this.transform,F=C.padding,K=C.project(l.LngLat.convert(i)),ee=C.project(l.LngLat.convert(o)),re=K.rotate(-f*Math.PI/180),Pe=ee.rotate(-f*Math.PI/180),Ce=new l.Point(Math.max(re.x,Pe.x),Math.max(re.y,Pe.y)),qe=new l.Point(Math.min(re.x,Pe.x),Math.min(re.y,Pe.y)),_e=Ce.sub(qe),Ge=(C.width-(F.left+F.right+d.padding.left+d.padding.right))/_e.x,et=(C.height-(F.top+F.bottom+d.padding.top+d.padding.bottom))/_e.y;if(!(et<0||Ge<0)){var St=Math.min(C.scaleZoom(C.scale*Math.min(Ge,et)),d.maxZoom),$t=typeof d.offset.x=="number"?new l.Point(d.offset.x,d.offset.y):l.Point.convert(d.offset),Zt=new l.Point((d.padding.left-d.padding.right)/2,(d.padding.top-d.padding.bottom)/2).rotate(f*Math.PI/180),rr=$t.add(Zt).mult(C.scale/C.zoomScale(St));return{center:C.unproject(K.add(ee).div(2).sub(rr)),zoom:St,bearing:f}}l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},a.prototype.fitBounds=function(i,o,f){return this._fitInternal(this.cameraForBounds(i,o),o,f)},a.prototype.fitScreenCoordinates=function(i,o,f,d,v){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.Point.convert(i)),this.transform.pointLocation(l.Point.convert(o)),f,d),d,v)},a.prototype._fitInternal=function(i,o,f){return i?(delete(o=l.extend(i,o)).padding,o.linear?this.easeTo(o,f):this.flyTo(o,f)):this},a.prototype.jumpTo=function(i,o){this.stop();var f=this.transform,d=!1,v=!1,x=!1;return"zoom"in i&&f.zoom!==+i.zoom&&(d=!0,f.zoom=+i.zoom),i.center!==void 0&&(f.center=l.LngLat.convert(i.center)),"bearing"in i&&f.bearing!==+i.bearing&&(v=!0,f.bearing=+i.bearing),"pitch"in i&&f.pitch!==+i.pitch&&(x=!0,f.pitch=+i.pitch),i.padding==null||f.isPaddingEqual(i.padding)||(f.padding=i.padding),this.fire(new l.Event("movestart",o)).fire(new l.Event("move",o)),d&&this.fire(new l.Event("zoomstart",o)).fire(new l.Event("zoom",o)).fire(new l.Event("zoomend",o)),v&&this.fire(new l.Event("rotatestart",o)).fire(new l.Event("rotate",o)).fire(new l.Event("rotateend",o)),x&&this.fire(new l.Event("pitchstart",o)).fire(new l.Event("pitch",o)).fire(new l.Event("pitchend",o)),this.fire(new l.Event("moveend",o))},a.prototype.easeTo=function(i,o){var f=this;this._stop(!1,i.easeId),((i=l.extend({offset:[0,0],duration:500,easing:l.ease},i)).animate===!1||!i.essential&&l.browser.prefersReducedMotion)&&(i.duration=0);var d=this.transform,v=this.getZoom(),x=this.getBearing(),C=this.getPitch(),F=this.getPadding(),K="zoom"in i?+i.zoom:v,ee="bearing"in i?this._normalizeBearing(i.bearing,x):x,re="pitch"in i?+i.pitch:C,Pe="padding"in i?i.padding:d.padding,Ce=l.Point.convert(i.offset),qe=d.centerPoint.add(Ce),_e=d.pointLocation(qe),Ge=l.LngLat.convert(i.center||_e);this._normalizeCenter(Ge);var et,St,$t=d.project(_e),Zt=d.project(Ge).sub($t),rr=d.zoomScale(K-v);i.around&&(et=l.LngLat.convert(i.around),St=d.locationPoint(et));var Sr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||K!==v,this._rotating=this._rotating||x!==ee,this._pitching=this._pitching||re!==C,this._padding=!d.isPaddingEqual(Pe),this._easeId=i.easeId,this._prepareEase(o,i.noMoveStart,Sr),this._ease(function(Ur){if(f._zooming&&(d.zoom=l.number(v,K,Ur)),f._rotating&&(d.bearing=l.number(x,ee,Ur)),f._pitching&&(d.pitch=l.number(C,re,Ur)),f._padding&&(d.interpolatePadding(F,Pe,Ur),qe=d.centerPoint.add(Ce)),et)d.setLocationAtPoint(et,St);else{var Br=d.zoomScale(d.zoom-v),hn=K>v?Math.min(2,rr):Math.max(.5,rr),Pn=Math.pow(hn,1-Ur),Mn=d.unproject($t.add(Zt.mult(Ur*Pn)).mult(Br));d.setLocationAtPoint(d.renderWorldCopies?Mn.wrap():Mn,qe)}f._fireMoveEvents(o)},function(Ur){f._afterEase(o,Ur)},i),this},a.prototype._prepareEase=function(i,o,f){f===void 0&&(f={}),this._moving=!0,o||f.moving||this.fire(new l.Event("movestart",i)),this._zooming&&!f.zooming&&this.fire(new l.Event("zoomstart",i)),this._rotating&&!f.rotating&&this.fire(new l.Event("rotatestart",i)),this._pitching&&!f.pitching&&this.fire(new l.Event("pitchstart",i))},a.prototype._fireMoveEvents=function(i){this.fire(new l.Event("move",i)),this._zooming&&this.fire(new l.Event("zoom",i)),this._rotating&&this.fire(new l.Event("rotate",i)),this._pitching&&this.fire(new l.Event("pitch",i))},a.prototype._afterEase=function(i,o){if(!this._easeId||!o||this._easeId!==o){delete this._easeId;var f=this._zooming,d=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new l.Event("zoomend",i)),d&&this.fire(new l.Event("rotateend",i)),v&&this.fire(new l.Event("pitchend",i)),this.fire(new l.Event("moveend",i))}},a.prototype.flyTo=function(i,o){var f=this;if(!i.essential&&l.browser.prefersReducedMotion){var d=l.pick(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(d,o)}this.stop(),i=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.ease},i);var v=this.transform,x=this.getZoom(),C=this.getBearing(),F=this.getPitch(),K=this.getPadding(),ee="zoom"in i?l.clamp(+i.zoom,v.minZoom,v.maxZoom):x,re="bearing"in i?this._normalizeBearing(i.bearing,C):C,Pe="pitch"in i?+i.pitch:F,Ce="padding"in i?i.padding:v.padding,qe=v.zoomScale(ee-x),_e=l.Point.convert(i.offset),Ge=v.centerPoint.add(_e),et=v.pointLocation(Ge),St=l.LngLat.convert(i.center||et);this._normalizeCenter(St);var $t=v.project(et),Zt=v.project(St).sub($t),rr=i.curve,Sr=Math.max(v.width,v.height),Ur=Sr/qe,Br=Zt.mag();if("minZoom"in i){var hn=l.clamp(Math.min(i.minZoom,x,ee),v.minZoom,v.maxZoom),Pn=Sr/v.zoomScale(hn-x);rr=Math.sqrt(Pn/Br*2)}var Mn=rr*rr;function Rn(Vn){var Nn=(Ur*Ur-Sr*Sr+(Vn?-1:1)*Mn*Mn*Br*Br)/(2*(Vn?Ur:Sr)*Mn*Br);return Math.log(Math.sqrt(Nn*Nn+1)-Nn)}function Ei(Vn){return(Math.exp(Vn)-Math.exp(-Vn))/2}function fn(Vn){return(Math.exp(Vn)+Math.exp(-Vn))/2}var Jn=Rn(0),ni=function(Vn){return fn(Jn)/fn(Jn+rr*Vn)},qn=function(Vn){return Sr*((fn(Jn)*(Ei(Nn=Jn+rr*Vn)/fn(Nn))-Ei(Jn))/Mn)/Br;var Nn},Bn=(Rn(1)-Jn)/rr;if(Math.abs(Br)<1e-6||!isFinite(Bn)){if(Math.abs(Sr-Ur)<1e-6)return this.easeTo(i,o);var oi=Ur<Sr?-1:1;Bn=Math.abs(Math.log(Ur/Sr))/rr,qn=function(){return 0},ni=function(Vn){return Math.exp(oi*rr*Vn)}}return i.duration="duration"in i?+i.duration:1e3*Bn/("screenSpeed"in i?+i.screenSpeed/rr:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=C!==re,this._pitching=Pe!==F,this._padding=!v.isPaddingEqual(Ce),this._prepareEase(o,!1),this._ease(function(Vn){var Nn=Vn*Bn,Ha=1/ni(Nn);v.zoom=Vn===1?ee:x+v.scaleZoom(Ha),f._rotating&&(v.bearing=l.number(C,re,Vn)),f._pitching&&(v.pitch=l.number(F,Pe,Vn)),f._padding&&(v.interpolatePadding(K,Ce,Vn),Ge=v.centerPoint.add(_e));var Ca=Vn===1?St:v.unproject($t.add(Zt.mult(qn(Nn))).mult(Ha));v.setLocationAtPoint(v.renderWorldCopies?Ca.wrap():Ca,Ge),f._fireMoveEvents(o)},function(){return f._afterEase(o)},i),this},a.prototype.isEasing=function(){return!!this._easeFrameId},a.prototype.stop=function(){return this._stop()},a.prototype._stop=function(i,o){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,o)}if(!i){var d=this.handlers;d&&d.stop(!1)}return this},a.prototype._ease=function(i,o,f){f.animate===!1||f.duration===0?(i(1),o()):(this._easeStart=l.browser.now(),this._easeOptions=f,this._onEaseFrame=i,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},a.prototype._renderFrameCallback=function(){var i=Math.min((l.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},a.prototype._normalizeBearing=function(i,o){i=l.wrap(i,-180,180);var f=Math.abs(i-o);return Math.abs(i-360-o)<f&&(i-=360),Math.abs(i+360-o)<f&&(i+=360),i},a.prototype._normalizeCenter=function(i){var o=this.transform;if(o.renderWorldCopies&&!o.lngRange){var f=i.lng-o.center.lng;i.lng+=f>180?-360:f<-180?360:0}},a}(l.Evented),Ci=function(n){n===void 0&&(n={}),this.options=n,l.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Ci.prototype.getDefaultPosition=function(){return"bottom-right"},Ci.prototype.onAdd=function(n){var a=this.options&&this.options.compact;return this._map=n,this._container=ge.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ge.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ge.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),a&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),a===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Ci.prototype.onRemove=function(){ge.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Ci.prototype._setElementTitle=function(n,a){var i=this._map._getUIString("AttributionControl."+a);n.title=i,n.setAttribute("aria-label",i)},Ci.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Ci.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||l.config.ACCESS_TOKEN}];if(n){var i=a.reduce(function(o,f,d){return f.value&&(o+=f.key+"="+f.value+(d<a.length-1?"&":"")),o},"?");n.href=l.config.FEEDBACK_URL+"/"+i+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},Ci.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Ci.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(x){return typeof x!="string"?"":x})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var a=this._map.style.stylesheet;this.styleOwner=a.owner,this.styleId=a.id}var i=this._map.style.sourceCaches;for(var o in i){var f=i[o];if(f.used){var d=f.getSource();d.attribution&&n.indexOf(d.attribution)<0&&n.push(d.attribution)}}n.sort(function(x,C){return x.length-C.length});var v=(n=n.filter(function(x,C){for(var F=C+1;F<n.length;F++)if(n[F].indexOf(x)>=0)return!1;return!0})).join(" | ");v!==this._attribHTML&&(this._attribHTML=v,n.length?(this._innerContainer.innerHTML=v,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Ci.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Ni=function(){l.bindAll(["_updateLogo"],this),l.bindAll(["_updateCompact"],this)};Ni.prototype.onAdd=function(n){this._map=n,this._container=ge.create("div","mapboxgl-ctrl");var a=ge.create("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Ni.prototype.onRemove=function(){ge.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Ni.prototype.getDefaultPosition=function(){return"bottom-left"},Ni.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Ni.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var a in n)if(n[a].getSource().mapbox_logo)return!0;return!1}},Ni.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var a=n[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("mapboxgl-compact"):a.classList.remove("mapboxgl-compact")}};var xi=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};xi.prototype.add=function(n){var a=++this._id;return this._queue.push({callback:n,id:a,cancelled:!1}),a},xi.prototype.remove=function(n){for(var a=this._currentlyRunning,i=0,o=a?this._queue.concat(a):this._queue;i<o.length;i+=1){var f=o[i];if(f.id===n)return void(f.cancelled=!0)}},xi.prototype.run=function(n){n===void 0&&(n=0);var a=this._currentlyRunning=this._queue;this._queue=[];for(var i=0,o=a;i<o.length;i+=1){var f=o[i];if(!f.cancelled&&(f.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},xi.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ta={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},to=l.window.HTMLImageElement,La=l.window.HTMLElement,ti=l.window.ImageBitmap,yi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Fo=function(n){function a(o){var f=this;if((o=l.extend({},yi,o)).minZoom!=null&&o.maxZoom!=null&&o.minZoom>o.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(o.minPitch!=null&&o.maxPitch!=null&&o.minPitch>o.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(o.minPitch!=null&&o.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(o.maxPitch!=null&&o.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var d=new wi(o.minZoom,o.maxZoom,o.minPitch,o.maxPitch,o.renderWorldCopies);if(n.call(this,d,o),this._interactive=o.interactive,this._maxTileCacheSize=o.maxTileCacheSize,this._failIfMajorPerformanceCaveat=o.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=o.preserveDrawingBuffer,this._antialias=o.antialias,this._trackResize=o.trackResize,this._bearingSnap=o.bearingSnap,this._refreshExpiredTiles=o.refreshExpiredTiles,this._fadeDuration=o.fadeDuration,this._crossSourceCollisions=o.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=o.collectResourceTiming,this._renderTaskQueue=new xi,this._controls=[],this._mapId=l.uniqueId(),this._locale=l.extend({},Ta,o.locale),this._clickTolerance=o.clickTolerance,this._requestManager=new l.RequestManager(o.transformRequest,o.accessToken),typeof o.container=="string"){if(this._container=l.window.document.getElementById(o.container),!this._container)throw new Error("Container '"+o.container+"' not found.")}else{if(!(o.container instanceof La))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=o.container}if(o.maxBounds&&this.setMaxBounds(o.maxBounds),l.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return f._update(!1)}),this.on("moveend",function(){return f._update(!1)}),this.on("zoom",function(){return f._update(!0)}),l.window!==void 0&&(l.window.addEventListener("online",this._onWindowOnline,!1),l.window.addEventListener("resize",this._onWindowResize,!1),l.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new or(this,o),this._hash=o.hash&&new Io(typeof o.hash=="string"&&o.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:o.center,zoom:o.zoom,bearing:o.bearing,pitch:o.pitch}),o.bounds&&(this.resize(),this.fitBounds(o.bounds,l.extend({},o.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=o.localIdeographFontFamily,o.style&&this.setStyle(o.style,{localIdeographFontFamily:o.localIdeographFontFamily}),o.attributionControl&&this.addControl(new Ci({customAttribution:o.customAttribution})),this.addControl(new Ni,o.logoPosition),this.on("style.load",function(){f.transform.unmodified&&f.jumpTo(f.style.stylesheet)}),this.on("data",function(v){f._update(v.dataType==="style"),f.fire(new l.Event(v.dataType+"data",v))}),this.on("dataloading",function(v){f.fire(new l.Event(v.dataType+"dataloading",v))})}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var i={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return a.prototype._getMapId=function(){return this._mapId},a.prototype.addControl=function(o,f){if(f===void 0&&(f=o.getDefaultPosition?o.getDefaultPosition():"top-right"),!o||!o.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var d=o.onAdd(this);this._controls.push(o);var v=this._controlPositions[f];return f.indexOf("bottom")!==-1?v.insertBefore(d,v.firstChild):v.appendChild(d),this},a.prototype.removeControl=function(o){if(!o||!o.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var f=this._controls.indexOf(o);return f>-1&&this._controls.splice(f,1),o.onRemove(this),this},a.prototype.hasControl=function(o){return this._controls.indexOf(o)>-1},a.prototype.resize=function(o){var f=this._containerDimensions(),d=f[0],v=f[1];if(d===this.transform.width&&v===this.transform.height)return this;this._resizeCanvas(d,v),this.transform.resize(d,v),this.painter.resize(d,v);var x=!this._moving;return x&&this.fire(new l.Event("movestart",o)).fire(new l.Event("move",o)),this.fire(new l.Event("resize",o)),x&&this.fire(new l.Event("moveend",o)),this},a.prototype.getBounds=function(){return this.transform.getBounds()},a.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},a.prototype.setMaxBounds=function(o){return this.transform.setMaxBounds(l.LngLatBounds.convert(o)),this._update()},a.prototype.setMinZoom=function(o){if((o=o==null?-2:o)>=-2&&o<=this.transform.maxZoom)return this.transform.minZoom=o,this._update(),this.getZoom()<o&&this.setZoom(o),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},a.prototype.getMinZoom=function(){return this.transform.minZoom},a.prototype.setMaxZoom=function(o){if((o=o==null?22:o)>=this.transform.minZoom)return this.transform.maxZoom=o,this._update(),this.getZoom()>o&&this.setZoom(o),this;throw new Error("maxZoom must be greater than the current minZoom")},a.prototype.getMaxZoom=function(){return this.transform.maxZoom},a.prototype.setMinPitch=function(o){if((o=o==null?0:o)<0)throw new Error("minPitch must be greater than or equal to 0");if(o>=0&&o<=this.transform.maxPitch)return this.transform.minPitch=o,this._update(),this.getPitch()<o&&this.setPitch(o),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},a.prototype.getMinPitch=function(){return this.transform.minPitch},a.prototype.setMaxPitch=function(o){if((o=o==null?60:o)>60)throw new Error("maxPitch must be less than or equal to 60");if(o>=this.transform.minPitch)return this.transform.maxPitch=o,this._update(),this.getPitch()>o&&this.setPitch(o),this;throw new Error("maxPitch must be greater than the current minPitch")},a.prototype.getMaxPitch=function(){return this.transform.maxPitch},a.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},a.prototype.setRenderWorldCopies=function(o){return this.transform.renderWorldCopies=o,this._update()},a.prototype.project=function(o){return this.transform.locationPoint(l.LngLat.convert(o))},a.prototype.unproject=function(o){return this.transform.pointLocation(l.Point.convert(o))},a.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},a.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},a.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},a.prototype._createDelegatedListener=function(o,f,d){var v,x=this;if(o==="mouseenter"||o==="mouseover"){var C=!1;return{layer:f,listener:d,delegates:{mousemove:function(K){var ee=x.getLayer(f)?x.queryRenderedFeatures(K.point,{layers:[f]}):[];ee.length?C||(C=!0,d.call(x,new Sa(o,x,K.originalEvent,{features:ee}))):C=!1},mouseout:function(){C=!1}}}}if(o==="mouseleave"||o==="mouseout"){var F=!1;return{layer:f,listener:d,delegates:{mousemove:function(K){(x.getLayer(f)?x.queryRenderedFeatures(K.point,{layers:[f]}):[]).length?F=!0:F&&(F=!1,d.call(x,new Sa(o,x,K.originalEvent)))},mouseout:function(K){F&&(F=!1,d.call(x,new Sa(o,x,K.originalEvent)))}}}}return{layer:f,listener:d,delegates:(v={},v[o]=function(K){var ee=x.getLayer(f)?x.queryRenderedFeatures(K.point,{layers:[f]}):[];ee.length&&(K.features=ee,d.call(x,K),delete K.features)},v)}},a.prototype.on=function(o,f,d){if(d===void 0)return n.prototype.on.call(this,o,f);var v=this._createDelegatedListener(o,f,d);for(var x in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[o]=this._delegatedListeners[o]||[],this._delegatedListeners[o].push(v),v.delegates)this.on(x,v.delegates[x]);return this},a.prototype.once=function(o,f,d){if(d===void 0)return n.prototype.once.call(this,o,f);var v=this._createDelegatedListener(o,f,d);for(var x in v.delegates)this.once(x,v.delegates[x]);return this},a.prototype.off=function(o,f,d){var v=this;return d===void 0?n.prototype.off.call(this,o,f):(this._delegatedListeners&&this._delegatedListeners[o]&&function(x){for(var C=x[o],F=0;F<C.length;F++){var K=C[F];if(K.layer===f&&K.listener===d){for(var ee in K.delegates)v.off(ee,K.delegates[ee]);return C.splice(F,1),v}}}(this._delegatedListeners),this)},a.prototype.queryRenderedFeatures=function(o,f){if(!this.style)return[];var d;if(f!==void 0||o===void 0||o instanceof l.Point||Array.isArray(o)||(f=o,o=void 0),f=f||{},(o=o||[[0,0],[this.transform.width,this.transform.height]])instanceof l.Point||typeof o[0]=="number")d=[l.Point.convert(o)];else{var v=l.Point.convert(o[0]),x=l.Point.convert(o[1]);d=[v,new l.Point(x.x,v.y),x,new l.Point(v.x,x.y),v]}return this.style.queryRenderedFeatures(d,f,this.transform)},a.prototype.querySourceFeatures=function(o,f){return this.style.querySourceFeatures(o,f)},a.prototype.setStyle=function(o,f){return(f=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},f)).diff!==!1&&f.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&o?(this._diffStyle(o,f),this):(this._localIdeographFontFamily=f.localIdeographFontFamily,this._updateStyle(o,f))},a.prototype._getUIString=function(o){var f=this._locale[o];if(f==null)throw new Error("Missing UI string '"+o+"'");return f},a.prototype._updateStyle=function(o,f){return this.style&&(this.style.setEventedParent(null),this.style._remove()),o?(this.style=new ja(this,f||{}),this.style.setEventedParent(this,{style:this.style}),typeof o=="string"?this.style.loadURL(o):this.style.loadJSON(o),this):(delete this.style,this)},a.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new ja(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},a.prototype._diffStyle=function(o,f){var d=this;if(typeof o=="string"){var v=this._requestManager.normalizeStyleURL(o),x=this._requestManager.transformRequest(v,l.ResourceType.Style);l.getJSON(x,function(C,F){C?d.fire(new l.ErrorEvent(C)):F&&d._updateDiff(F,f)})}else typeof o=="object"&&this._updateDiff(o,f)},a.prototype._updateDiff=function(o,f){try{this.style.setState(o)&&this._update(!0)}catch(d){l.warnOnce("Unable to perform style diff: "+(d.message||d.error||d)+".  Rebuilding the style from scratch."),this._updateStyle(o,f)}},a.prototype.getStyle=function(){if(this.style)return this.style.serialize()},a.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():l.warnOnce("There is no style added to the map.")},a.prototype.addSource=function(o,f){return this._lazyInitEmptyStyle(),this.style.addSource(o,f),this._update(!0)},a.prototype.isSourceLoaded=function(o){var f=this.style&&this.style.sourceCaches[o];if(f!==void 0)return f.loaded();this.fire(new l.ErrorEvent(new Error("There is no source with ID '"+o+"'")))},a.prototype.areTilesLoaded=function(){var o=this.style&&this.style.sourceCaches;for(var f in o){var d=o[f]._tiles;for(var v in d){var x=d[v];if(x.state!=="loaded"&&x.state!=="errored")return!1}}return!0},a.prototype.addSourceType=function(o,f,d){return this._lazyInitEmptyStyle(),this.style.addSourceType(o,f,d)},a.prototype.removeSource=function(o){return this.style.removeSource(o),this._update(!0)},a.prototype.getSource=function(o){return this.style.getSource(o)},a.prototype.addImage=function(o,f,d){d===void 0&&(d={});var v=d.pixelRatio;v===void 0&&(v=1);var x=d.sdf;x===void 0&&(x=!1);var C=d.stretchX,F=d.stretchY,K=d.content;if(this._lazyInitEmptyStyle(),f instanceof to||ti&&f instanceof ti){var ee=l.browser.getImageData(f);this.style.addImage(o,{data:new l.RGBAImage({width:ee.width,height:ee.height},ee.data),pixelRatio:v,stretchX:C,stretchY:F,content:K,sdf:x,version:0})}else{if(f.width===void 0||f.height===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var re=f;this.style.addImage(o,{data:new l.RGBAImage({width:f.width,height:f.height},new Uint8Array(f.data)),pixelRatio:v,stretchX:C,stretchY:F,content:K,sdf:x,version:0,userImage:re}),re.onAdd&&re.onAdd(this,o)}},a.prototype.updateImage=function(o,f){var d=this.style.getImage(o);if(!d)return this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var v=f instanceof to||ti&&f instanceof ti?l.browser.getImageData(f):f,x=v.width,C=v.height,F=v.data;return x===void 0||C===void 0?this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):x!==d.data.width||C!==d.data.height?this.fire(new l.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(d.data.replace(F,!(f instanceof to||ti&&f instanceof ti)),void this.style.updateImage(o,d))},a.prototype.hasImage=function(o){return o?!!this.style.getImage(o):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)},a.prototype.removeImage=function(o){this.style.removeImage(o)},a.prototype.loadImage=function(o,f){l.getImage(this._requestManager.transformRequest(o,l.ResourceType.Image),f)},a.prototype.listImages=function(){return this.style.listImages()},a.prototype.addLayer=function(o,f){return this._lazyInitEmptyStyle(),this.style.addLayer(o,f),this._update(!0)},a.prototype.moveLayer=function(o,f){return this.style.moveLayer(o,f),this._update(!0)},a.prototype.removeLayer=function(o){return this.style.removeLayer(o),this._update(!0)},a.prototype.getLayer=function(o){return this.style.getLayer(o)},a.prototype.setLayerZoomRange=function(o,f,d){return this.style.setLayerZoomRange(o,f,d),this._update(!0)},a.prototype.setFilter=function(o,f,d){return d===void 0&&(d={}),this.style.setFilter(o,f,d),this._update(!0)},a.prototype.getFilter=function(o){return this.style.getFilter(o)},a.prototype.setPaintProperty=function(o,f,d,v){return v===void 0&&(v={}),this.style.setPaintProperty(o,f,d,v),this._update(!0)},a.prototype.getPaintProperty=function(o,f){return this.style.getPaintProperty(o,f)},a.prototype.setLayoutProperty=function(o,f,d,v){return v===void 0&&(v={}),this.style.setLayoutProperty(o,f,d,v),this._update(!0)},a.prototype.getLayoutProperty=function(o,f){return this.style.getLayoutProperty(o,f)},a.prototype.setLight=function(o,f){return f===void 0&&(f={}),this._lazyInitEmptyStyle(),this.style.setLight(o,f),this._update(!0)},a.prototype.getLight=function(){return this.style.getLight()},a.prototype.setFeatureState=function(o,f){return this.style.setFeatureState(o,f),this._update()},a.prototype.removeFeatureState=function(o,f){return this.style.removeFeatureState(o,f),this._update()},a.prototype.getFeatureState=function(o){return this.style.getFeatureState(o)},a.prototype.getContainer=function(){return this._container},a.prototype.getCanvasContainer=function(){return this._canvasContainer},a.prototype.getCanvas=function(){return this._canvas},a.prototype._containerDimensions=function(){var o=0,f=0;return this._container&&(o=this._container.clientWidth||400,f=this._container.clientHeight||300),[o,f]},a.prototype._detectMissingCSS=function(){l.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&l.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},a.prototype._setupContainer=function(){var o=this._container;o.classList.add("mapboxgl-map"),(this._missingCSSCanary=ge.create("div","mapboxgl-canary",o)).style.visibility="hidden",this._detectMissingCSS();var f=this._canvasContainer=ge.create("div","mapboxgl-canvas-container",o);this._interactive&&f.classList.add("mapboxgl-interactive"),this._canvas=ge.create("canvas","mapboxgl-canvas",f),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var d=this._containerDimensions();this._resizeCanvas(d[0],d[1]);var v=this._controlContainer=ge.create("div","mapboxgl-control-container",o),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(C){x[C]=ge.create("div","mapboxgl-ctrl-"+C,v)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},a.prototype._resizeCanvas=function(o,f){var d=l.browser.devicePixelRatio||1;this._canvas.width=d*o,this._canvas.height=d*f,this._canvas.style.width=o+"px",this._canvas.style.height=f+"px"},a.prototype._setupPainter=function(){var o=l.extend({},Vt.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),f=this._canvas.getContext("webgl",o)||this._canvas.getContext("experimental-webgl",o);f?(this.painter=new pa(f,this.transform),l.webpSupported.testSupport(f)):this.fire(new l.ErrorEvent(new Error("Failed to initialize WebGL")))},a.prototype._contextLost=function(o){o.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:o}))},a.prototype._contextRestored=function(o){this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:o}))},a.prototype._onMapScroll=function(o){if(o.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},a.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},a.prototype._update=function(o){return this.style?(this._styleDirty=this._styleDirty||o,this._sourcesDirty=!0,this.triggerRepaint(),this):this},a.prototype._requestRenderFrame=function(o){return this._update(),this._renderTaskQueue.add(o)},a.prototype._cancelRenderFrame=function(o){this._renderTaskQueue.remove(o)},a.prototype._render=function(o){var f,d=this,v=0,x=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(f=x.createQueryEXT(),x.beginQueryEXT(x.TIME_ELAPSED_EXT,f),v=l.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(o),!this._removed){var C=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var F=this.transform.zoom,K=l.browser.now();this.style.zoomHistory.update(F,K);var ee=new l.EvaluationParameters(F,{now:K,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),re=ee.crossFadingFactor();re===1&&re===this._crossFadingFactor||(C=!0,this._crossFadingFactor=re),this.style.update(ee)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new l.Event("load"))),this.style&&(this.style.hasTransitions()||C)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Pe=l.browser.now()-v;x.endQueryEXT(x.TIME_ELAPSED_EXT,f),setTimeout(function(){var _e=x.getQueryObjectEXT(f,x.QUERY_RESULT_EXT)/1e6;x.deleteQueryEXT(f),d.fire(new l.Event("gpu-timing-frame",{cpuTime:Pe,gpuTime:_e}))},50)}if(this.listens("gpu-timing-layer")){var Ce=this.painter.collectGpuTimers();setTimeout(function(){var _e=d.painter.queryGpuTimers(Ce);d.fire(new l.Event("gpu-timing-layer",{layerTimes:_e}))},50)}var qe=this._sourcesDirty||this._styleDirty||this._placementDirty;return qe||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.Event("idle")),!this._loaded||this._fullyLoaded||qe||(this._fullyLoaded=!0),this}},a.prototype.remove=function(){this._hash&&this._hash.remove();for(var o=0,f=this._controls;o<f.length;o+=1)f[o].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),l.window!==void 0&&(l.window.removeEventListener("resize",this._onWindowResize,!1),l.window.removeEventListener("orientationchange",this._onWindowResize,!1),l.window.removeEventListener("online",this._onWindowOnline,!1));var d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),si(this._canvasContainer),si(this._controlContainer),si(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new l.Event("remove"))},a.prototype.triggerRepaint=function(){var o=this;this.style&&!this._frame&&(this._frame=l.browser.frame(function(f){o._frame=null,o._render(f)}))},a.prototype._onWindowOnline=function(){this._update()},a.prototype._onWindowResize=function(o){this._trackResize&&this.resize({originalEvent:o})._update()},i.showTileBoundaries.get=function(){return!!this._showTileBoundaries},i.showTileBoundaries.set=function(o){this._showTileBoundaries!==o&&(this._showTileBoundaries=o,this._update())},i.showPadding.get=function(){return!!this._showPadding},i.showPadding.set=function(o){this._showPadding!==o&&(this._showPadding=o,this._update())},i.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},i.showCollisionBoxes.set=function(o){this._showCollisionBoxes!==o&&(this._showCollisionBoxes=o,o?this.style._generateCollisionBoxes():this._update())},i.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},i.showOverdrawInspector.set=function(o){this._showOverdrawInspector!==o&&(this._showOverdrawInspector=o,this._update())},i.repaint.get=function(){return!!this._repaint},i.repaint.set=function(o){this._repaint!==o&&(this._repaint=o,this.triggerRepaint())},i.vertices.get=function(){return!!this._vertices},i.vertices.set=function(o){this._vertices=o,this._update()},a.prototype._setCacheLimits=function(o,f){l.setCacheLimits(o,f)},i.version.get=function(){return l.version},Object.defineProperties(a.prototype,i),a}(jn);function si(n){n.parentNode&&n.parentNode.removeChild(n)}var ha={showCompass:!0,showZoom:!0,visualizePitch:!1},ba=function(n){var a=this;this.options=l.extend({},ha,n),this._container=ge.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(i){return i.preventDefault()}),this.options.showZoom&&(l.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(i){return a._map.zoomIn({},{originalEvent:i})}),ge.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(i){return a._map.zoomOut({},{originalEvent:i})}),ge.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(l.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(i){a.options.visualizePitch?a._map.resetNorthPitch({},{originalEvent:i}):a._map.resetNorth({},{originalEvent:i})}),this._compassIcon=ge.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ba.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),a=n===this._map.getMaxZoom(),i=n===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=i,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",i.toString())},ba.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},ba.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ji(this._map,this._compass,this.options.visualizePitch)),this._container},ba.prototype.onRemove=function(){ge.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ba.prototype._createButton=function(n,a){var i=ge.create("button",n,this._container);return i.type="button",i.addEventListener("click",a),i},ba.prototype._setButtonTitle=function(n,a){var i=this._map._getUIString("NavigationControl."+a);n.title=i,n.setAttribute("aria-label",i)};var ji=function(n,a,i){i===void 0&&(i=!1),this._clickTolerance=10,this.element=a,this.mouseRotate=new Gu({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,i&&(this.mousePitch=new Js({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),l.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),ge.addEventListener(a,"mousedown",this.mousedown),ge.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),ge.addEventListener(a,"touchmove",this.touchmove),ge.addEventListener(a,"touchend",this.touchend),ge.addEventListener(a,"touchcancel",this.reset)};function ri(n,a,i){if(n=new l.LngLat(n.lng,n.lat),a){var o=new l.LngLat(n.lng-360,n.lat),f=new l.LngLat(n.lng+360,n.lat),d=i.locationPoint(n).distSqr(a);i.locationPoint(o).distSqr(a)<d?n=o:i.locationPoint(f).distSqr(a)<d&&(n=f)}for(;Math.abs(n.lng-i.center.lng)>180;){var v=i.locationPoint(n);if(v.x>=0&&v.y>=0&&v.x<=i.width&&v.y<=i.height)break;n.lng>i.center.lng?n.lng-=360:n.lng+=360}return n}ji.prototype.down=function(n,a){this.mouseRotate.mousedown(n,a),this.mousePitch&&this.mousePitch.mousedown(n,a),ge.disableDrag()},ji.prototype.move=function(n,a){var i=this.map,o=this.mouseRotate.mousemoveWindow(n,a);if(o&&o.bearingDelta&&i.setBearing(i.getBearing()+o.bearingDelta),this.mousePitch){var f=this.mousePitch.mousemoveWindow(n,a);f&&f.pitchDelta&&i.setPitch(i.getPitch()+f.pitchDelta)}},ji.prototype.off=function(){var n=this.element;ge.removeEventListener(n,"mousedown",this.mousedown),ge.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),ge.removeEventListener(n,"touchmove",this.touchmove),ge.removeEventListener(n,"touchend",this.touchend),ge.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},ji.prototype.offTemp=function(){ge.enableDrag(),ge.removeEventListener(l.window,"mousemove",this.mousemove),ge.removeEventListener(l.window,"mouseup",this.mouseup)},ji.prototype.mousedown=function(n){this.down(l.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),ge.mousePos(this.element,n)),ge.addEventListener(l.window,"mousemove",this.mousemove),ge.addEventListener(l.window,"mouseup",this.mouseup)},ji.prototype.mousemove=function(n){this.move(n,ge.mousePos(this.element,n))},ji.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},ji.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ge.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},ji.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=ge.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},ji.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},ji.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var ta={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function la(n,a,i){var o=n.classList;for(var f in ta)o.remove("mapboxgl-"+i+"-anchor-"+f);o.add("mapboxgl-"+i+"-anchor-"+a)}var Zo,Rs=function(n){function a(i,o){if(n.call(this),(i instanceof l.window.HTMLElement||o)&&(i=l.extend({element:i},o)),l.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,i&&i.element)this._element=i.element,this._offset=l.Point.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=ge.create("div"),this._element.setAttribute("aria-label","Map marker");var f=ge.createNS("http://www.w3.org/2000/svg","svg");f.setAttributeNS(null,"display","block"),f.setAttributeNS(null,"height","41px"),f.setAttributeNS(null,"width","27px"),f.setAttributeNS(null,"viewBox","0 0 27 41");var d=ge.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"stroke","none"),d.setAttributeNS(null,"stroke-width","1"),d.setAttributeNS(null,"fill","none"),d.setAttributeNS(null,"fill-rule","evenodd");var v=ge.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"fill-rule","nonzero");var x=ge.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"transform","translate(3.0, 29.0)"),x.setAttributeNS(null,"fill","#000000");for(var C=0,F=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];C<F.length;C+=1){var K=F[C],ee=ge.createNS("http://www.w3.org/2000/svg","ellipse");ee.setAttributeNS(null,"opacity","0.04"),ee.setAttributeNS(null,"cx","10.5"),ee.setAttributeNS(null,"cy","5.80029008"),ee.setAttributeNS(null,"rx",K.rx),ee.setAttributeNS(null,"ry",K.ry),x.appendChild(ee)}var re=ge.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"fill",this._color);var Pe=ge.createNS("http://www.w3.org/2000/svg","path");Pe.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),re.appendChild(Pe);var Ce=ge.createNS("http://www.w3.org/2000/svg","g");Ce.setAttributeNS(null,"opacity","0.25"),Ce.setAttributeNS(null,"fill","#000000");var qe=ge.createNS("http://www.w3.org/2000/svg","path");qe.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Ce.appendChild(qe);var _e=ge.createNS("http://www.w3.org/2000/svg","g");_e.setAttributeNS(null,"transform","translate(6.0, 7.0)"),_e.setAttributeNS(null,"fill","#FFFFFF");var Ge=ge.createNS("http://www.w3.org/2000/svg","g");Ge.setAttributeNS(null,"transform","translate(8.0, 8.0)");var et=ge.createNS("http://www.w3.org/2000/svg","circle");et.setAttributeNS(null,"fill","#000000"),et.setAttributeNS(null,"opacity","0.25"),et.setAttributeNS(null,"cx","5.5"),et.setAttributeNS(null,"cy","5.5"),et.setAttributeNS(null,"r","5.4999962");var St=ge.createNS("http://www.w3.org/2000/svg","circle");St.setAttributeNS(null,"fill","#FFFFFF"),St.setAttributeNS(null,"cx","5.5"),St.setAttributeNS(null,"cy","5.5"),St.setAttributeNS(null,"r","5.4999962"),Ge.appendChild(et),Ge.appendChild(St),v.appendChild(x),v.appendChild(re),v.appendChild(Ce),v.appendChild(_e),v.appendChild(Ge),f.appendChild(v),f.setAttributeNS(null,"height",41*this._scale+"px"),f.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(f),this._offset=l.Point.convert(i&&i.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function($t){$t.preventDefault()}),this._element.addEventListener("mousedown",function($t){$t.preventDefault()}),la(this._element,this._anchor,"marker"),this._popup=null}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.addTo=function(i){return this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},a.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ge.remove(this._element),this._popup&&this._popup.remove(),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(i){return this._lngLat=l.LngLat.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},a.prototype.getElement=function(){return this._element},a.prototype.setPopup=function(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){var o=Math.sqrt(Math.pow(13.5,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[o,-1*(24.6+o)],"bottom-right":[-o,-1*(24.6+o)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=i,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},a.prototype._onKeyPress=function(i){var o=i.code,f=i.charCode||i.keyCode;o!=="Space"&&o!=="Enter"&&f!==32&&f!==13||this.togglePopup()},a.prototype._onMapClick=function(i){var o=i.originalEvent.target,f=this._element;this._popup&&(o===f||f.contains(o))&&this.togglePopup()},a.prototype.getPopup=function(){return this._popup},a.prototype.togglePopup=function(){var i=this._popup;return i?(i.isOpen()?i.remove():i.addTo(this._map),this):this},a.prototype._update=function(i){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ri(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var o="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?o="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(o="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var f="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?f="rotateX(0deg)":this._pitchAlignment==="map"&&(f="rotateX("+this._map.getPitch()+"deg)"),i&&i.type!=="moveend"||(this._pos=this._pos.round()),ge.setTransform(this._element,ta[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+f+" "+o)}},a.prototype.getOffset=function(){return this._offset},a.prototype.setOffset=function(i){return this._offset=l.Point.convert(i),this._update(),this},a.prototype._onMove=function(i){if(!this._isDragging){var o=this._clickTolerance||this._map._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=o}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag")))},a.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.Event("dragend")),this._state="inactive"},a.prototype._addDragHandler=function(i){this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._offset),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},a.prototype.setDraggable=function(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},a.prototype.isDraggable=function(){return this._draggable},a.prototype.setRotation=function(i){return this._rotation=i||0,this._update(),this},a.prototype.getRotation=function(){return this._rotation},a.prototype.setRotationAlignment=function(i){return this._rotationAlignment=i||"auto",this._update(),this},a.prototype.getRotationAlignment=function(){return this._rotationAlignment},a.prototype.setPitchAlignment=function(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this},a.prototype.getPitchAlignment=function(){return this._pitchAlignment},a}(l.Evented),Os={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},ps=0,as=!1,Jo=function(n){function a(i){n.call(this),this.options=l.extend({},Os,i),l.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.onAdd=function(i){var o;return this._map=i,this._container=ge.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),o=this._setupUI,Zo!==void 0?o(Zo):l.window.navigator.permissions!==void 0?l.window.navigator.permissions.query({name:"geolocation"}).then(function(f){o(Zo=f.state!=="denied")}):o(Zo=!!l.window.navigator.geolocation),this._container},a.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(l.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ge.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ps=0,as=!1},a.prototype._isOutOfMapMaxBounds=function(i){var o=this._map.getMaxBounds(),f=i.coords;return o&&(f.longitude<o.getWest()||f.longitude>o.getEast()||f.latitude<o.getSouth()||f.latitude>o.getNorth())},a.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},a.prototype._onSuccess=function(i){if(this._map){if(this._isOutOfMapMaxBounds(i))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",i)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=i,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(i),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(i),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("geolocate",i)),this._finish()}},a.prototype._updateCamera=function(i){var o=new l.LngLat(i.coords.longitude,i.coords.latitude),f=i.coords.accuracy,d=this._map.getBearing(),v=l.extend({bearing:d},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(f),v,{geolocateSource:!0})},a.prototype._updateMarker=function(i){if(i){var o=new l.LngLat(i.coords.longitude,i.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=i.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},a.prototype._updateCircleRadius=function(){var i=this._map._container.clientHeight/2,o=this._map.unproject([0,i]),f=this._map.unproject([1,i]),d=o.distanceTo(f),v=Math.ceil(2*this._accuracy/d);this._circleElement.style.width=v+"px",this._circleElement.style.height=v+"px"},a.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},a.prototype._onError=function(i){if(this._map){if(this.options.trackUserLocation)if(i.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(i.code===3&&as)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("error",i)),this._finish()}},a.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},a.prototype._setupUI=function(i){var o=this;if(this._container.addEventListener("contextmenu",function(v){return v.preventDefault()}),this._geolocateButton=ge.create("button","mapboxgl-ctrl-geolocate",this._container),ge.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",i===!1){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var f=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=f,this._geolocateButton.setAttribute("aria-label",f)}else{var d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ge.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Rs(this._dotElement),this._circleElement=ge.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Rs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(v){v.geolocateSource||o._watchState!=="ACTIVE_LOCK"||v.originalEvent&&v.originalEvent.type==="resize"||(o._watchState="BACKGROUND",o._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),o._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),o.fire(new l.Event("trackuserlocationend")))})},a.prototype.trigger=function(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ps--,as=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var i;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++ps>1?(i={maximumAge:6e5,timeout:0},as=!0):(i=this.options.positionOptions,as=!1),this._geolocationWatchID=l.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,i)}}else l.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},a.prototype._clearWatch=function(){l.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},a}(l.Evented),$s={maxWidth:100,unit:"metric"},Qs=function(n){this.options=l.extend({},$s,n),l.bindAll(["_onMove","setUnit"],this)};function fl(n,a,i){var o=i&&i.maxWidth||100,f=n._container.clientHeight/2,d=n.unproject([0,f]),v=n.unproject([o,f]),x=d.distanceTo(v);if(i&&i.unit==="imperial"){var C=3.2808*x;C>5280?eu(a,o,C/5280,n._getUIString("ScaleControl.Miles")):eu(a,o,C,n._getUIString("ScaleControl.Feet"))}else i&&i.unit==="nautical"?eu(a,o,x/1852,n._getUIString("ScaleControl.NauticalMiles")):x>=1e3?eu(a,o,x/1e3,n._getUIString("ScaleControl.Kilometers")):eu(a,o,x,n._getUIString("ScaleControl.Meters"))}function eu(n,a,i,o){var f,d,v,x=(f=i,(d=Math.pow(10,(""+Math.floor(f)).length-1))*(v=(v=f/d)>=10?10:v>=5?5:v>=3?3:v>=2?2:v>=1?1:function(C){var F=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*F)/F}(v)));n.style.width=a*(x/i)+"px",n.innerHTML=x+"&nbsp;"+o}Qs.prototype.getDefaultPosition=function(){return"bottom-left"},Qs.prototype._onMove=function(){fl(this._map,this._container,this.options)},Qs.prototype.onAdd=function(n){return this._map=n,this._container=ge.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Qs.prototype.onRemove=function(){ge.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Qs.prototype.setUnit=function(n){this.options.unit=n,fl(this._map,this._container,this.options)};var $o=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof l.window.HTMLElement?this._container=n.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),l.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in l.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in l.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in l.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in l.window.document&&(this._fullscreenchange="MSFullscreenChange")};$o.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=ge.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",l.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},$o.prototype.onRemove=function(){ge.remove(this._controlContainer),this._map=null,l.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},$o.prototype._checkFullscreenSupport=function(){return!!(l.window.document.fullscreenEnabled||l.window.document.mozFullScreenEnabled||l.window.document.msFullscreenEnabled||l.window.document.webkitFullscreenEnabled)},$o.prototype._setupUI=function(){var n=this._fullscreenButton=ge.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);ge.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),l.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},$o.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},$o.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},$o.prototype._isFullscreen=function(){return this._fullscreen},$o.prototype._changeIcon=function(){(l.window.document.fullscreenElement||l.window.document.mozFullScreenElement||l.window.document.webkitFullscreenElement||l.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},$o.prototype._onClickFullscreen=function(){this._isFullscreen()?l.window.document.exitFullscreen?l.window.document.exitFullscreen():l.window.document.mozCancelFullScreen?l.window.document.mozCancelFullScreen():l.window.document.msExitFullscreen?l.window.document.msExitFullscreen():l.window.document.webkitCancelFullScreen&&l.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var pl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},qu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Ol=function(n){function a(i){n.call(this),this.options=l.extend(Object.create(pl),i),l.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.addTo=function(i){return this._map&&this.remove(),this._map=i,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new l.Event("open")),this},a.prototype.isOpen=function(){return!!this._map},a.prototype.remove=function(){return this._content&&ge.remove(this._content),this._container&&(ge.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.Event("close")),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(i){return this._lngLat=l.LngLat.convert(i),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},a.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},a.prototype.getElement=function(){return this._container},a.prototype.setText=function(i){return this.setDOMContent(l.window.document.createTextNode(i))},a.prototype.setHTML=function(i){var o,f=l.window.document.createDocumentFragment(),d=l.window.document.createElement("body");for(d.innerHTML=i;o=d.firstChild;)f.appendChild(o);return this.setDOMContent(f)},a.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},a.prototype.setMaxWidth=function(i){return this.options.maxWidth=i,this._update(),this},a.prototype.setDOMContent=function(i){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ge.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(i),this._createCloseButton(),this._update(),this._focusFirstElement(),this},a.prototype.addClassName=function(i){this._container&&this._container.classList.add(i)},a.prototype.removeClassName=function(i){this._container&&this._container.classList.remove(i)},a.prototype.setOffset=function(i){return this.options.offset=i,this._update(),this},a.prototype.toggleClassName=function(i){if(this._container)return this._container.classList.toggle(i)},a.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=ge.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},a.prototype._onMouseUp=function(i){this._update(i.point)},a.prototype._onMouseMove=function(i){this._update(i.point)},a.prototype._onDrag=function(i){this._update(i.point)},a.prototype._update=function(i){var o=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=ge.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=ge.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(ee){return o._container.classList.add(ee)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ri(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||i)){var f=this._pos=this._trackPointer&&i?i:this._map.project(this._lngLat),d=this.options.anchor,v=function ee(re){if(re){if(typeof re=="number"){var Pe=Math.round(Math.sqrt(.5*Math.pow(re,2)));return{center:new l.Point(0,0),top:new l.Point(0,re),"top-left":new l.Point(Pe,Pe),"top-right":new l.Point(-Pe,Pe),bottom:new l.Point(0,-re),"bottom-left":new l.Point(Pe,-Pe),"bottom-right":new l.Point(-Pe,-Pe),left:new l.Point(re,0),right:new l.Point(-re,0)}}if(re instanceof l.Point||Array.isArray(re)){var Ce=l.Point.convert(re);return{center:Ce,top:Ce,"top-left":Ce,"top-right":Ce,bottom:Ce,"bottom-left":Ce,"bottom-right":Ce,left:Ce,right:Ce}}return{center:l.Point.convert(re.center||[0,0]),top:l.Point.convert(re.top||[0,0]),"top-left":l.Point.convert(re["top-left"]||[0,0]),"top-right":l.Point.convert(re["top-right"]||[0,0]),bottom:l.Point.convert(re.bottom||[0,0]),"bottom-left":l.Point.convert(re["bottom-left"]||[0,0]),"bottom-right":l.Point.convert(re["bottom-right"]||[0,0]),left:l.Point.convert(re.left||[0,0]),right:l.Point.convert(re.right||[0,0])}}return ee(new l.Point(0,0))}(this.options.offset);if(!d){var x,C=this._container.offsetWidth,F=this._container.offsetHeight;x=f.y+v.bottom.y<F?["top"]:f.y>this._map.transform.height-F?["bottom"]:[],f.x<C/2?x.push("left"):f.x>this._map.transform.width-C/2&&x.push("right"),d=x.length===0?"bottom":x.join("-")}var K=f.add(v[d]).round();ge.setTransform(this._container,ta[d]+" translate("+K.x+"px,"+K.y+"px)"),la(this._container,d,"popup")}},a.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var i=this._container.querySelector(qu);i&&i.focus()}},a.prototype._onClose=function(){this.remove()},a}(l.Evented),Mu={version:l.version,supported:Vt,setRTLTextPlugin:l.setRTLTextPlugin,getRTLTextPluginStatus:l.getRTLTextPluginStatus,Map:Fo,NavigationControl:ba,GeolocateControl:Jo,AttributionControl:Ci,ScaleControl:Qs,FullscreenControl:$o,Popup:Ol,Marker:Rs,Style:ja,LngLat:l.LngLat,LngLatBounds:l.LngLatBounds,Point:l.Point,MercatorCoordinate:l.MercatorCoordinate,Evented:l.Evented,config:l.config,prewarm:function(){Lt().acquire(Nt)},clearPrewarmedResources:function(){var n=vn;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(Nt),vn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return l.config.ACCESS_TOKEN},set accessToken(n){l.config.ACCESS_TOKEN=n},get baseApiUrl(){return l.config.API_URL},set baseApiUrl(n){l.config.API_URL=n},get workerCount(){return br.workerCount},set workerCount(n){br.workerCount=n},get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){l.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){l.clearTileCache(n)},workerUrl:""};return Mu}),vt})},3614:function(ci,mn,ot){"use strict";ci.exports=Ze;var vt=ot(80645);function Ze(V){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(V)?V:new Uint8Array(V||0),this.pos=0,this.type=0,this.length=this.buf.length}Ze.Varint=0,Ze.Fixed64=1,Ze.Bytes=2,Ze.Fixed32=5;var l=(1<<16)*(1<<16),Vt=1/l,ge=12,Mt=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");Ze.prototype={destroy:function(){this.buf=null},readFields:function(V,pe,P){for(P=P||this.length;this.pos<P;){var U=this.readVarint(),B=U>>3,E=this.pos;this.type=U&7,V(B,pe,this),this.pos===E&&this.skip(U)}return pe},readMessage:function(V,pe){return this.readFields(V,pe,this.readVarint()+this.pos)},readFixed32:function(){var V=Se(this.buf,this.pos);return this.pos+=4,V},readSFixed32:function(){var V=De(this.buf,this.pos);return this.pos+=4,V},readFixed64:function(){var V=Se(this.buf,this.pos)+Se(this.buf,this.pos+4)*l;return this.pos+=8,V},readSFixed64:function(){var V=Se(this.buf,this.pos)+De(this.buf,this.pos+4)*l;return this.pos+=8,V},readFloat:function(){var V=vt.read(this.buf,this.pos,!0,23,4);return this.pos+=4,V},readDouble:function(){var V=vt.read(this.buf,this.pos,!0,52,8);return this.pos+=8,V},readVarint:function(V){var pe=this.buf,P,U;return U=pe[this.pos++],P=U&127,U<128||(U=pe[this.pos++],P|=(U&127)<<7,U<128)||(U=pe[this.pos++],P|=(U&127)<<14,U<128)||(U=pe[this.pos++],P|=(U&127)<<21,U<128)?P:(U=pe[this.pos],P|=(U&15)<<28,Le(P,V,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var V=this.readVarint();return V%2==1?(V+1)/-2:V/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var V=this.readVarint()+this.pos,pe=this.pos;return this.pos=V,V-pe>=ge&&Mt?ze(this.buf,pe,V):we(this.buf,pe,V)},readBytes:function(){var V=this.readVarint()+this.pos,pe=this.buf.subarray(this.pos,V);return this.pos=V,pe},readPackedVarint:function(V,pe){if(this.type!==Ze.Bytes)return V.push(this.readVarint(pe));var P=Tt(this);for(V=V||[];this.pos<P;)V.push(this.readVarint(pe));return V},readPackedSVarint:function(V){if(this.type!==Ze.Bytes)return V.push(this.readSVarint());var pe=Tt(this);for(V=V||[];this.pos<pe;)V.push(this.readSVarint());return V},readPackedBoolean:function(V){if(this.type!==Ze.Bytes)return V.push(this.readBoolean());var pe=Tt(this);for(V=V||[];this.pos<pe;)V.push(this.readBoolean());return V},readPackedFloat:function(V){if(this.type!==Ze.Bytes)return V.push(this.readFloat());var pe=Tt(this);for(V=V||[];this.pos<pe;)V.push(this.readFloat());return V},readPackedDouble:function(V){if(this.type!==Ze.Bytes)return V.push(this.readDouble());var pe=Tt(this);for(V=V||[];this.pos<pe;)V.push(this.readDouble());return V},readPackedFixed32:function(V){if(this.type!==Ze.Bytes)return V.push(this.readFixed32());var pe=Tt(this);for(V=V||[];this.pos<pe;)V.push(this.readFixed32());return V},readPackedSFixed32:function(V){if(this.type!==Ze.Bytes)return V.push(this.readSFixed32());var pe=Tt(this);for(V=V||[];this.pos<pe;)V.push(this.readSFixed32());return V},readPackedFixed64:function(V){if(this.type!==Ze.Bytes)return V.push(this.readFixed64());var pe=Tt(this);for(V=V||[];this.pos<pe;)V.push(this.readFixed64());return V},readPackedSFixed64:function(V){if(this.type!==Ze.Bytes)return V.push(this.readSFixed64());var pe=Tt(this);for(V=V||[];this.pos<pe;)V.push(this.readSFixed64());return V},skip:function(V){var pe=V&7;if(pe===Ze.Varint)for(;this.buf[this.pos++]>127;);else if(pe===Ze.Bytes)this.pos=this.readVarint()+this.pos;else if(pe===Ze.Fixed32)this.pos+=4;else if(pe===Ze.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+pe)},writeTag:function(V,pe){this.writeVarint(V<<3|pe)},realloc:function(V){for(var pe=this.length||16;pe<this.pos+V;)pe*=2;if(pe!==this.length){var P=new Uint8Array(pe);P.set(this.buf),this.buf=P,this.length=pe}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(V){this.realloc(4),me(this.buf,V,this.pos),this.pos+=4},writeSFixed32:function(V){this.realloc(4),me(this.buf,V,this.pos),this.pos+=4},writeFixed64:function(V){this.realloc(8),me(this.buf,V&-1,this.pos),me(this.buf,Math.floor(V*Vt),this.pos+4),this.pos+=8},writeSFixed64:function(V){this.realloc(8),me(this.buf,V&-1,this.pos),me(this.buf,Math.floor(V*Vt),this.pos+4),this.pos+=8},writeVarint:function(V){if(V=+V||0,V>268435455||V<0){dt(V,this);return}this.realloc(4),this.buf[this.pos++]=V&127|(V>127?128:0),!(V<=127)&&(this.buf[this.pos++]=(V>>>=7)&127|(V>127?128:0),!(V<=127)&&(this.buf[this.pos++]=(V>>>=7)&127|(V>127?128:0),!(V<=127)&&(this.buf[this.pos++]=V>>>7&127)))},writeSVarint:function(V){this.writeVarint(V<0?-V*2-1:V*2)},writeBoolean:function(V){this.writeVarint(Boolean(V))},writeString:function(V){V=String(V),this.realloc(V.length*4),this.pos++;var pe=this.pos;this.pos=Qt(this.buf,V,this.pos);var P=this.pos-pe;P>=128&&Dt(pe,P,this),this.pos=pe-1,this.writeVarint(P),this.pos+=P},writeFloat:function(V){this.realloc(4),vt.write(this.buf,V,this.pos,!0,23,4),this.pos+=4},writeDouble:function(V){this.realloc(8),vt.write(this.buf,V,this.pos,!0,52,8),this.pos+=8},writeBytes:function(V){var pe=V.length;this.writeVarint(pe),this.realloc(pe);for(var P=0;P<pe;P++)this.buf[this.pos++]=V[P]},writeRawMessage:function(V,pe){this.pos++;var P=this.pos;V(pe,this);var U=this.pos-P;U>=128&&Dt(P,U,this),this.pos=P-1,this.writeVarint(U),this.pos+=U},writeMessage:function(V,pe,P){this.writeTag(V,Ze.Bytes),this.writeRawMessage(pe,P)},writePackedVarint:function(V,pe){pe.length&&this.writeMessage(V,Er,pe)},writePackedSVarint:function(V,pe){pe.length&&this.writeMessage(V,wt,pe)},writePackedBoolean:function(V,pe){pe.length&&this.writeMessage(V,vr,pe)},writePackedFloat:function(V,pe){pe.length&&this.writeMessage(V,fr,pe)},writePackedDouble:function(V,pe){pe.length&&this.writeMessage(V,Et,pe)},writePackedFixed32:function(V,pe){pe.length&&this.writeMessage(V,kt,pe)},writePackedSFixed32:function(V,pe){pe.length&&this.writeMessage(V,mt,pe)},writePackedFixed64:function(V,pe){pe.length&&this.writeMessage(V,k,pe)},writePackedSFixed64:function(V,pe){pe.length&&this.writeMessage(V,Te,pe)},writeBytesField:function(V,pe){this.writeTag(V,Ze.Bytes),this.writeBytes(pe)},writeFixed32Field:function(V,pe){this.writeTag(V,Ze.Fixed32),this.writeFixed32(pe)},writeSFixed32Field:function(V,pe){this.writeTag(V,Ze.Fixed32),this.writeSFixed32(pe)},writeFixed64Field:function(V,pe){this.writeTag(V,Ze.Fixed64),this.writeFixed64(pe)},writeSFixed64Field:function(V,pe){this.writeTag(V,Ze.Fixed64),this.writeSFixed64(pe)},writeVarintField:function(V,pe){this.writeTag(V,Ze.Varint),this.writeVarint(pe)},writeSVarintField:function(V,pe){this.writeTag(V,Ze.Varint),this.writeSVarint(pe)},writeStringField:function(V,pe){this.writeTag(V,Ze.Bytes),this.writeString(pe)},writeFloatField:function(V,pe){this.writeTag(V,Ze.Fixed32),this.writeFloat(pe)},writeDoubleField:function(V,pe){this.writeTag(V,Ze.Fixed64),this.writeDouble(pe)},writeBooleanField:function(V,pe){this.writeVarintField(V,Boolean(pe))}};function Le(V,pe,P){var U=P.buf,B,E;if(E=U[P.pos++],B=(E&112)>>4,E<128||(E=U[P.pos++],B|=(E&127)<<3,E<128)||(E=U[P.pos++],B|=(E&127)<<10,E<128)||(E=U[P.pos++],B|=(E&127)<<17,E<128)||(E=U[P.pos++],B|=(E&127)<<24,E<128)||(E=U[P.pos++],B|=(E&1)<<31,E<128))return Fe(V,B,pe);throw new Error("Expected varint not more than 10 bytes")}function Tt(V){return V.type===Ze.Bytes?V.readVarint()+V.pos:V.pos+1}function Fe(V,pe,P){return P?pe*4294967296+(V>>>0):(pe>>>0)*4294967296+(V>>>0)}function dt(V,pe){var P,U;if(V>=0?(P=V%4294967296|0,U=V/4294967296|0):(P=~(-V%4294967296),U=~(-V/4294967296),P^4294967295?P=P+1|0:(P=0,U=U+1|0)),V>=18446744073709552e3||V<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");pe.realloc(10),nr(P,U,pe),dr(U,pe)}function nr(V,pe,P){P.buf[P.pos++]=V&127|128,V>>>=7,P.buf[P.pos++]=V&127|128,V>>>=7,P.buf[P.pos++]=V&127|128,V>>>=7,P.buf[P.pos++]=V&127|128,V>>>=7,P.buf[P.pos]=V&127}function dr(V,pe){var P=(V&7)<<4;pe.buf[pe.pos++]|=P|((V>>>=3)?128:0),!!V&&(pe.buf[pe.pos++]=V&127|((V>>>=7)?128:0),!!V&&(pe.buf[pe.pos++]=V&127|((V>>>=7)?128:0),!!V&&(pe.buf[pe.pos++]=V&127|((V>>>=7)?128:0),!!V&&(pe.buf[pe.pos++]=V&127|((V>>>=7)?128:0),!!V&&(pe.buf[pe.pos++]=V&127)))))}function Dt(V,pe,P){var U=pe<=16383?1:pe<=2097151?2:pe<=268435455?3:Math.floor(Math.log(pe)/(Math.LN2*7));P.realloc(U);for(var B=P.pos-1;B>=V;B--)P.buf[B+U]=P.buf[B]}function Er(V,pe){for(var P=0;P<V.length;P++)pe.writeVarint(V[P])}function wt(V,pe){for(var P=0;P<V.length;P++)pe.writeSVarint(V[P])}function fr(V,pe){for(var P=0;P<V.length;P++)pe.writeFloat(V[P])}function Et(V,pe){for(var P=0;P<V.length;P++)pe.writeDouble(V[P])}function vr(V,pe){for(var P=0;P<V.length;P++)pe.writeBoolean(V[P])}function kt(V,pe){for(var P=0;P<V.length;P++)pe.writeFixed32(V[P])}function mt(V,pe){for(var P=0;P<V.length;P++)pe.writeSFixed32(V[P])}function k(V,pe){for(var P=0;P<V.length;P++)pe.writeFixed64(V[P])}function Te(V,pe){for(var P=0;P<V.length;P++)pe.writeSFixed64(V[P])}function Se(V,pe){return(V[pe]|V[pe+1]<<8|V[pe+2]<<16)+V[pe+3]*16777216}function me(V,pe,P){V[P]=pe,V[P+1]=pe>>>8,V[P+2]=pe>>>16,V[P+3]=pe>>>24}function De(V,pe){return(V[pe]|V[pe+1]<<8|V[pe+2]<<16)+(V[pe+3]<<24)}function we(V,pe,P){for(var U="",B=pe;B<P;){var E=V[B],D=null,q=E>239?4:E>223?3:E>191?2:1;if(B+q>P)break;var Q,Ae,ct;q===1?E<128&&(D=E):q===2?(Q=V[B+1],(Q&192)==128&&(D=(E&31)<<6|Q&63,D<=127&&(D=null))):q===3?(Q=V[B+1],Ae=V[B+2],(Q&192)==128&&(Ae&192)==128&&(D=(E&15)<<12|(Q&63)<<6|Ae&63,(D<=2047||D>=55296&&D<=57343)&&(D=null))):q===4&&(Q=V[B+1],Ae=V[B+2],ct=V[B+3],(Q&192)==128&&(Ae&192)==128&&(ct&192)==128&&(D=(E&15)<<18|(Q&63)<<12|(Ae&63)<<6|ct&63,(D<=65535||D>=1114112)&&(D=null))),D===null?(D=65533,q=1):D>65535&&(D-=65536,U+=String.fromCharCode(D>>>10&1023|55296),D=56320|D&1023),U+=String.fromCharCode(D),B+=q}return U}function ze(V,pe,P){return Mt.decode(V.subarray(pe,P))}function Qt(V,pe,P){for(var U=0,B,E;U<pe.length;U++){if(B=pe.charCodeAt(U),B>55295&&B<57344)if(E)if(B<56320){V[P++]=239,V[P++]=191,V[P++]=189,E=B;continue}else B=E-55296<<10|B-56320|65536,E=null;else{B>56319||U+1===pe.length?(V[P++]=239,V[P++]=191,V[P++]=189):E=B;continue}else E&&(V[P++]=239,V[P++]=191,V[P++]=189,E=null);B<128?V[P++]=B:(B<2048?V[P++]=B>>6|192:(B<65536?V[P++]=B>>12|224:(V[P++]=B>>18|240,V[P++]=B>>12&63|128),V[P++]=B>>6&63|128),V[P++]=B&63|128)}return P}},32676:function(ci,mn,ot){var vt=ot(34155);(function(Ze,l){ci.exports=l()})(this,function(){"use strict";function Ze(ae,z){if(!(ae instanceof z))throw new TypeError("Cannot call a class as a function")}function l(ae,z){for(var R=0;R<z.length;R++){var j=z[R];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(ae,j.key,j)}}function Vt(ae,z,R){return z&&l(ae.prototype,z),R&&l(ae,R),ae}/**
 * splaytree v3.1.0
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */var ge=function(){function ae(z,R){this.next=null,this.key=z,this.data=R,this.left=null,this.right=null}return ae}();function Mt(ae,z){return ae>z?1:ae<z?-1:0}function Le(ae,z,R){for(var j=new ge(null,null),b=j,ce=j;;){var Ye=R(ae,z.key);if(Ye<0){if(z.left===null)break;if(R(ae,z.left.key)<0){var Pt=z.left;if(z.left=Pt.right,Pt.right=z,z=Pt,z.left===null)break}ce.left=z,ce=z,z=z.left}else if(Ye>0){if(z.right===null)break;if(R(ae,z.right.key)>0){var Pt=z.right;if(z.right=Pt.left,Pt.left=z,z=Pt,z.right===null)break}b.right=z,b=z,z=z.right}else break}return b.right=z.left,ce.left=z.right,z.left=j.right,z.right=j.left,z}function Tt(ae,z,R,j){var b=new ge(ae,z);if(R===null)return b.left=b.right=null,b;R=Le(ae,R,j);var ce=j(ae,R.key);return ce<0?(b.left=R.left,b.right=R,R.left=null):ce>=0&&(b.right=R.right,b.left=R,R.right=null),b}function Fe(ae,z,R){var j=null,b=null;if(z){z=Le(ae,z,R);var ce=R(z.key,ae);ce===0?(j=z.left,b=z.right):ce<0?(b=z.right,z.right=null,j=z):(j=z.left,z.left=null,b=z)}return{left:j,right:b}}function dt(ae,z,R){return z===null?ae:(ae===null||(z=Le(ae.key,z,R),z.left=ae),z)}function nr(ae,z,R,j,b){if(ae){j(""+z+(R?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+b(ae)+`
`);var ce=z+(R?"    ":"\u2502   ");ae.left&&nr(ae.left,ce,!1,j,b),ae.right&&nr(ae.right,ce,!0,j,b)}}var dr=function(){function ae(z){z===void 0&&(z=Mt),this._root=null,this._size=0,this._comparator=z}return ae.prototype.insert=function(z,R){return this._size++,this._root=Tt(z,R,this._root,this._comparator)},ae.prototype.add=function(z,R){var j=new ge(z,R);this._root===null&&(j.left=j.right=null,this._size++,this._root=j);var b=this._comparator,ce=Le(z,this._root,b),Ye=b(z,ce.key);return Ye===0?this._root=ce:(Ye<0?(j.left=ce.left,j.right=ce,ce.left=null):Ye>0&&(j.right=ce.right,j.left=ce,ce.right=null),this._size++,this._root=j),this._root},ae.prototype.remove=function(z){this._root=this._remove(z,this._root,this._comparator)},ae.prototype._remove=function(z,R,j){var b;if(R===null)return null;R=Le(z,R,j);var ce=j(z,R.key);return ce===0?(R.left===null?b=R.right:(b=Le(z,R.left,j),b.right=R.right),this._size--,b):R},ae.prototype.pop=function(){var z=this._root;if(z){for(;z.left;)z=z.left;return this._root=Le(z.key,this._root,this._comparator),this._root=this._remove(z.key,this._root,this._comparator),{key:z.key,data:z.data}}return null},ae.prototype.findStatic=function(z){for(var R=this._root,j=this._comparator;R;){var b=j(z,R.key);if(b===0)return R;b<0?R=R.left:R=R.right}return null},ae.prototype.find=function(z){return this._root&&(this._root=Le(z,this._root,this._comparator),this._comparator(z,this._root.key)!==0)?null:this._root},ae.prototype.contains=function(z){for(var R=this._root,j=this._comparator;R;){var b=j(z,R.key);if(b===0)return!0;b<0?R=R.left:R=R.right}return!1},ae.prototype.forEach=function(z,R){for(var j=this._root,b=[],ce=!1;!ce;)j!==null?(b.push(j),j=j.left):b.length!==0?(j=b.pop(),z.call(R,j),j=j.right):ce=!0;return this},ae.prototype.range=function(z,R,j,b){for(var ce=[],Ye=this._comparator,Pt=this._root,te;ce.length!==0||Pt;)if(Pt)ce.push(Pt),Pt=Pt.left;else{if(Pt=ce.pop(),te=Ye(Pt.key,R),te>0)break;if(Ye(Pt.key,z)>=0&&j.call(b,Pt))return this;Pt=Pt.right}return this},ae.prototype.keys=function(){var z=[];return this.forEach(function(R){var j=R.key;return z.push(j)}),z},ae.prototype.values=function(){var z=[];return this.forEach(function(R){var j=R.data;return z.push(j)}),z},ae.prototype.min=function(){return this._root?this.minNode(this._root).key:null},ae.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},ae.prototype.minNode=function(z){if(z===void 0&&(z=this._root),z)for(;z.left;)z=z.left;return z},ae.prototype.maxNode=function(z){if(z===void 0&&(z=this._root),z)for(;z.right;)z=z.right;return z},ae.prototype.at=function(z){for(var R=this._root,j=!1,b=0,ce=[];!j;)if(R)ce.push(R),R=R.left;else if(ce.length>0){if(R=ce.pop(),b===z)return R;b++,R=R.right}else j=!0;return null},ae.prototype.next=function(z){var R=this._root,j=null;if(z.right){for(j=z.right;j.left;)j=j.left;return j}for(var b=this._comparator;R;){var ce=b(z.key,R.key);if(ce===0)break;ce<0?(j=R,R=R.left):R=R.right}return j},ae.prototype.prev=function(z){var R=this._root,j=null;if(z.left!==null){for(j=z.left;j.right;)j=j.right;return j}for(var b=this._comparator;R;){var ce=b(z.key,R.key);if(ce===0)break;ce<0?R=R.left:(j=R,R=R.right)}return j},ae.prototype.clear=function(){return this._root=null,this._size=0,this},ae.prototype.toList=function(){return wt(this._root)},ae.prototype.load=function(z,R,j){R===void 0&&(R=[]),j===void 0&&(j=!1);var b=z.length,ce=this._comparator;if(j&&vr(z,R,0,b-1,ce),this._root===null)this._root=Dt(z,R,0,b),this._size=b;else{var Ye=Et(this.toList(),Er(z,R),ce);b=this._size+b,this._root=fr({head:Ye},0,b)}return this},ae.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(ae.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(ae.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),ae.prototype.toString=function(z){z===void 0&&(z=function(b){return String(b.key)});var R=[];return nr(this._root,"",!0,function(j){return R.push(j)},z),R.join("")},ae.prototype.update=function(z,R,j){var b=this._comparator,ce=Fe(z,this._root,b),Ye=ce.left,Pt=ce.right;b(z,R)<0?Pt=Tt(R,j,Pt,b):Ye=Tt(R,j,Ye,b),this._root=dt(Ye,Pt,b)},ae.prototype.split=function(z){return Fe(z,this._root,this._comparator)},ae}();function Dt(ae,z,R,j){var b=j-R;if(b>0){var ce=R+Math.floor(b/2),Ye=ae[ce],Pt=z[ce],te=new ge(Ye,Pt);return te.left=Dt(ae,z,R,ce),te.right=Dt(ae,z,ce+1,j),te}return null}function Er(ae,z){for(var R=new ge(null,null),j=R,b=0;b<ae.length;b++)j=j.next=new ge(ae[b],z[b]);return j.next=null,R.next}function wt(ae){for(var z=ae,R=[],j=!1,b=new ge(null,null),ce=b;!j;)z?(R.push(z),z=z.left):R.length>0?(z=ce=ce.next=R.pop(),z=z.right):j=!0;return ce.next=null,b.next}function fr(ae,z,R){var j=R-z;if(j>0){var b=z+Math.floor(j/2),ce=fr(ae,z,b),Ye=ae.head;return Ye.left=ce,ae.head=ae.head.next,Ye.right=fr(ae,b+1,R),Ye}return null}function Et(ae,z,R){for(var j=new ge(null,null),b=j,ce=ae,Ye=z;ce!==null&&Ye!==null;)R(ce.key,Ye.key)<0?(b.next=ce,ce=ce.next):(b.next=Ye,Ye=Ye.next),b=b.next;return ce!==null?b.next=ce:Ye!==null&&(b.next=Ye),j.next}function vr(ae,z,R,j,b){if(!(R>=j)){for(var ce=ae[R+j>>1],Ye=R-1,Pt=j+1;;){do Ye++;while(b(ae[Ye],ce)<0);do Pt--;while(b(ae[Pt],ce)>0);if(Ye>=Pt)break;var te=ae[Ye];ae[Ye]=ae[Pt],ae[Pt]=te,te=z[Ye],z[Ye]=z[Pt],z[Pt]=te}vr(ae,z,R,Pt,b),vr(ae,z,Pt+1,j,b)}}var kt=function(z,R){return z.ll.x<=R.x&&R.x<=z.ur.x&&z.ll.y<=R.y&&R.y<=z.ur.y},mt=function(z,R){if(R.ur.x<z.ll.x||z.ur.x<R.ll.x||R.ur.y<z.ll.y||z.ur.y<R.ll.y)return null;var j=z.ll.x<R.ll.x?R.ll.x:z.ll.x,b=z.ur.x<R.ur.x?z.ur.x:R.ur.x,ce=z.ll.y<R.ll.y?R.ll.y:z.ll.y,Ye=z.ur.y<R.ur.y?z.ur.y:R.ur.y;return{ll:{x:j,y:ce},ur:{x:b,y:Ye}}},k=Number.EPSILON;k===void 0&&(k=Math.pow(2,-52));var Te=k*k,Se=function(z,R){if(-k<z&&z<k&&-k<R&&R<k)return 0;var j=z-R;return j*j<Te*z*R?0:z<R?-1:1},me=function(){function ae(){Ze(this,ae),this.reset()}return Vt(ae,[{key:"reset",value:function(){this.xRounder=new De,this.yRounder=new De}},{key:"round",value:function(R,j){return{x:this.xRounder.round(R),y:this.yRounder.round(j)}}}]),ae}(),De=function(){function ae(){Ze(this,ae),this.tree=new dr,this.round(0)}return Vt(ae,[{key:"round",value:function(R){var j=this.tree.add(R),b=this.tree.prev(j);if(b!==null&&Se(j.key,b.key)===0)return this.tree.remove(R),b.key;var ce=this.tree.next(j);return ce!==null&&Se(j.key,ce.key)===0?(this.tree.remove(R),ce.key):R}}]),ae}(),we=new me,ze=function(z,R){return z.x*R.y-z.y*R.x},Qt=function(z,R){return z.x*R.x+z.y*R.y},V=function(z,R,j){var b={x:R.x-z.x,y:R.y-z.y},ce={x:j.x-z.x,y:j.y-z.y},Ye=ze(b,ce);return Se(Ye,0)},pe=function(z){return Math.sqrt(Qt(z,z))},P=function(z,R,j){var b={x:R.x-z.x,y:R.y-z.y},ce={x:j.x-z.x,y:j.y-z.y};return ze(ce,b)/pe(ce)/pe(b)},U=function(z,R,j){var b={x:R.x-z.x,y:R.y-z.y},ce={x:j.x-z.x,y:j.y-z.y};return Qt(ce,b)/pe(ce)/pe(b)},B=function(z,R,j){return R.y===0?null:{x:z.x+R.x/R.y*(j-z.y),y:j}},E=function(z,R,j){return R.x===0?null:{x:j,y:z.y+R.y/R.x*(j-z.x)}},D=function(z,R,j,b){if(R.x===0)return E(j,b,z.x);if(b.x===0)return E(z,R,j.x);if(R.y===0)return B(j,b,z.y);if(b.y===0)return B(z,R,j.y);var ce=ze(R,b);if(ce==0)return null;var Ye={x:j.x-z.x,y:j.y-z.y},Pt=ze(Ye,R)/ce,te=ze(Ye,b)/ce,he=z.x+te*R.x,ve=j.x+Pt*b.x,it=z.y+te*R.y,at=j.y+Pt*b.y,fe=(he+ve)/2,wr=(it+at)/2;return{x:fe,y:wr}},q=function(){Vt(ae,null,[{key:"compare",value:function(R,j){var b=ae.comparePoints(R.point,j.point);return b!==0?b:(R.point!==j.point&&R.link(j),R.isLeft!==j.isLeft?R.isLeft?1:-1:Ae.compare(R.segment,j.segment))}},{key:"comparePoints",value:function(R,j){return R.x<j.x?-1:R.x>j.x?1:R.y<j.y?-1:R.y>j.y?1:0}}]);function ae(z,R){Ze(this,ae),z.events===void 0?z.events=[this]:z.events.push(this),this.point=z,this.isLeft=R}return Vt(ae,[{key:"link",value:function(R){if(R.point===this.point)throw new Error("Tried to link already linked events");for(var j=R.point.events,b=0,ce=j.length;b<ce;b++){var Ye=j[b];this.point.events.push(Ye),Ye.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var R=this.point.events.length,j=0;j<R;j++){var b=this.point.events[j];if(b.segment.consumedBy===void 0)for(var ce=j+1;ce<R;ce++){var Ye=this.point.events[ce];Ye.consumedBy===void 0&&b.otherSE.point.events===Ye.otherSE.point.events&&b.segment.consume(Ye.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var R=[],j=0,b=this.point.events.length;j<b;j++){var ce=this.point.events[j];ce!==this&&!ce.segment.ringOut&&ce.segment.isInResult()&&R.push(ce)}return R}},{key:"getLeftmostComparator",value:function(R){var j=this,b=new Map,ce=function(Pt){var te=Pt.otherSE;b.set(Pt,{sine:P(j.point,R.point,te.point),cosine:U(j.point,R.point,te.point)})};return function(Ye,Pt){b.has(Ye)||ce(Ye),b.has(Pt)||ce(Pt);var te=b.get(Ye),he=te.sine,ve=te.cosine,it=b.get(Pt),at=it.sine,fe=it.cosine;return he>=0&&at>=0?ve<fe?1:ve>fe?-1:0:he<0&&at<0?ve<fe?-1:ve>fe?1:0:at<he?-1:at>he?1:0}}}]),ae}(),Q=0,Ae=function(){Vt(ae,null,[{key:"compare",value:function(R,j){var b=R.leftSE.point.x,ce=j.leftSE.point.x,Ye=R.rightSE.point.x,Pt=j.rightSE.point.x;if(Pt<b)return 1;if(Ye<ce)return-1;var te=R.leftSE.point.y,he=j.leftSE.point.y,ve=R.rightSE.point.y,it=j.rightSE.point.y;if(b<ce){if(he<te&&he<ve)return 1;if(he>te&&he>ve)return-1;var at=R.comparePoint(j.leftSE.point);if(at<0)return 1;if(at>0)return-1;var fe=j.comparePoint(R.rightSE.point);return fe!==0?fe:-1}if(b>ce){if(te<he&&te<it)return-1;if(te>he&&te>it)return 1;var wr=j.comparePoint(R.leftSE.point);if(wr!==0)return wr;var Dr=R.comparePoint(j.rightSE.point);return Dr<0?1:Dr>0?-1:1}if(te<he)return-1;if(te>he)return 1;if(Ye<Pt){var Nr=j.comparePoint(R.rightSE.point);if(Nr!==0)return Nr}if(Ye>Pt){var yt=R.comparePoint(j.rightSE.point);if(yt<0)return 1;if(yt>0)return-1}if(Ye!==Pt){var jr=ve-te,Dn=Ye-b,ai=it-he,Mi=Pt-ce;if(jr>Dn&&ai<Mi)return 1;if(jr<Dn&&ai>Mi)return-1}return Ye>Pt?1:Ye<Pt||ve<it?-1:ve>it?1:R.id<j.id?-1:R.id>j.id?1:0}}]);function ae(z,R,j,b){Ze(this,ae),this.id=++Q,this.leftSE=z,z.segment=this,z.otherSE=R,this.rightSE=R,R.segment=this,R.otherSE=z,this.rings=j,this.windings=b}return Vt(ae,[{key:"replaceRightSE",value:function(R){this.rightSE=R,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var R=this.leftSE.point.y,j=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:R<j?R:j},ur:{x:this.rightSE.point.x,y:R>j?R:j}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(R){return R.x===this.leftSE.point.x&&R.y===this.leftSE.point.y||R.x===this.rightSE.point.x&&R.y===this.rightSE.point.y}},{key:"comparePoint",value:function(R){if(this.isAnEndpoint(R))return 0;var j=this.leftSE.point,b=this.rightSE.point,ce=this.vector();if(j.x===b.x)return R.x===j.x?0:R.x<j.x?1:-1;var Ye=(R.y-j.y)/ce.y,Pt=j.x+Ye*ce.x;if(R.x===Pt)return 0;var te=(R.x-j.x)/ce.x,he=j.y+te*ce.y;return R.y===he?0:R.y<he?-1:1}},{key:"getIntersection",value:function(R){var j=this.bbox(),b=R.bbox(),ce=mt(j,b);if(ce===null)return null;var Ye=this.leftSE.point,Pt=this.rightSE.point,te=R.leftSE.point,he=R.rightSE.point,ve=kt(j,te)&&this.comparePoint(te)===0,it=kt(b,Ye)&&R.comparePoint(Ye)===0,at=kt(j,he)&&this.comparePoint(he)===0,fe=kt(b,Pt)&&R.comparePoint(Pt)===0;if(it&&ve)return fe&&!at?Pt:!fe&&at?he:null;if(it)return at&&Ye.x===he.x&&Ye.y===he.y?null:Ye;if(ve)return fe&&Pt.x===te.x&&Pt.y===te.y?null:te;if(fe&&at)return null;if(fe)return Pt;if(at)return he;var wr=D(Ye,this.vector(),te,R.vector());return wr===null||!kt(ce,wr)?null:we.round(wr.x,wr.y)}},{key:"split",value:function(R){var j=[],b=R.events!==void 0,ce=new q(R,!0),Ye=new q(R,!1),Pt=this.rightSE;this.replaceRightSE(Ye),j.push(Ye),j.push(ce);var te=new ae(ce,Pt,this.rings.slice(),this.windings.slice());return q.comparePoints(te.leftSE.point,te.rightSE.point)>0&&te.swapEvents(),q.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),b&&(ce.checkForConsuming(),Ye.checkForConsuming()),j}},{key:"swapEvents",value:function(){var R=this.rightSE;this.rightSE=this.leftSE,this.leftSE=R,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var j=0,b=this.windings.length;j<b;j++)this.windings[j]*=-1}},{key:"consume",value:function(R){for(var j=this,b=R;j.consumedBy;)j=j.consumedBy;for(;b.consumedBy;)b=b.consumedBy;var ce=ae.compare(j,b);if(ce!==0){if(ce>0){var Ye=j;j=b,b=Ye}if(j.prev===b){var Pt=j;j=b,b=Pt}for(var te=0,he=b.rings.length;te<he;te++){var ve=b.rings[te],it=b.windings[te],at=j.rings.indexOf(ve);at===-1?(j.rings.push(ve),j.windings.push(it)):j.windings[at]+=it}b.rings=null,b.windings=null,b.consumedBy=j,b.leftSE.consumedBy=j.leftSE,b.rightSE.consumedBy=j.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var R=this.prev.consumedBy||this.prev;this._beforeState=R.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var R=this.beforeState();this._afterState={rings:R.rings.slice(0),windings:R.windings.slice(0),multiPolys:[]};for(var j=this._afterState.rings,b=this._afterState.windings,ce=this._afterState.multiPolys,Ye=0,Pt=this.rings.length;Ye<Pt;Ye++){var te=this.rings[Ye],he=this.windings[Ye],ve=j.indexOf(te);ve===-1?(j.push(te),b.push(he)):b[ve]+=he}for(var it=[],at=[],fe=0,wr=j.length;fe<wr;fe++)if(b[fe]!==0){var Dr=j[fe],Nr=Dr.poly;if(at.indexOf(Nr)===-1)if(Dr.isExterior)it.push(Nr);else{at.indexOf(Nr)===-1&&at.push(Nr);var yt=it.indexOf(Dr.poly);yt!==-1&&it.splice(yt,1)}}for(var jr=0,Dn=it.length;jr<Dn;jr++){var ai=it[jr].multiPoly;ce.indexOf(ai)===-1&&ce.push(ai)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var R=this.beforeState().multiPolys,j=this.afterState().multiPolys;switch(er.type){case"union":{var b=R.length===0,ce=j.length===0;this._isInResult=b!==ce;break}case"intersection":{var Ye,Pt;R.length<j.length?(Ye=R.length,Pt=j.length):(Ye=j.length,Pt=R.length),this._isInResult=Pt===er.numMultiPolys&&Ye<Pt;break}case"xor":{var te=Math.abs(R.length-j.length);this._isInResult=te%2==1;break}case"difference":{var he=function(it){return it.length===1&&it[0].isSubject};this._isInResult=he(R)!==he(j);break}default:throw new Error("Unrecognized operation type found ".concat(er.type))}return this._isInResult}}],[{key:"fromRing",value:function(R,j,b){var ce,Ye,Pt,te=q.comparePoints(R,j);if(te<0)ce=R,Ye=j,Pt=1;else if(te>0)ce=j,Ye=R,Pt=-1;else throw new Error("Tried to create degenerate segment at [".concat(R.x,", ").concat(R.y,"]"));var he=new q(ce,!0),ve=new q(Ye,!1);return new ae(he,ve,[b],[Pt])}}]),ae}(),ct=function(){function ae(z,R,j){if(Ze(this,ae),!Array.isArray(z)||z.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=R,this.isExterior=j,this.segments=[],typeof z[0][0]!="number"||typeof z[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var b=we.round(z[0][0],z[0][1]);this.bbox={ll:{x:b.x,y:b.y},ur:{x:b.x,y:b.y}};for(var ce=b,Ye=1,Pt=z.length;Ye<Pt;Ye++){if(typeof z[Ye][0]!="number"||typeof z[Ye][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var te=we.round(z[Ye][0],z[Ye][1]);te.x===ce.x&&te.y===ce.y||(this.segments.push(Ae.fromRing(ce,te,this)),te.x<this.bbox.ll.x&&(this.bbox.ll.x=te.x),te.y<this.bbox.ll.y&&(this.bbox.ll.y=te.y),te.x>this.bbox.ur.x&&(this.bbox.ur.x=te.x),te.y>this.bbox.ur.y&&(this.bbox.ur.y=te.y),ce=te)}(b.x!==ce.x||b.y!==ce.y)&&this.segments.push(Ae.fromRing(ce,b,this))}return Vt(ae,[{key:"getSweepEvents",value:function(){for(var R=[],j=0,b=this.segments.length;j<b;j++){var ce=this.segments[j];R.push(ce.leftSE),R.push(ce.rightSE)}return R}}]),ae}(),ke=function(){function ae(z,R){if(Ze(this,ae),!Array.isArray(z))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new ct(z[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var j=1,b=z.length;j<b;j++){var ce=new ct(z[j],this,!1);ce.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=ce.bbox.ll.x),ce.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=ce.bbox.ll.y),ce.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=ce.bbox.ur.x),ce.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=ce.bbox.ur.y),this.interiorRings.push(ce)}this.multiPoly=R}return Vt(ae,[{key:"getSweepEvents",value:function(){for(var R=this.exteriorRing.getSweepEvents(),j=0,b=this.interiorRings.length;j<b;j++)for(var ce=this.interiorRings[j].getSweepEvents(),Ye=0,Pt=ce.length;Ye<Pt;Ye++)R.push(ce[Ye]);return R}}]),ae}(),He=function(){function ae(z,R){if(Ze(this,ae),!Array.isArray(z))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof z[0][0][0]=="number"&&(z=[z])}catch(Ye){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var j=0,b=z.length;j<b;j++){var ce=new ke(z[j],this);ce.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=ce.bbox.ll.x),ce.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=ce.bbox.ll.y),ce.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=ce.bbox.ur.x),ce.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=ce.bbox.ur.y),this.polys.push(ce)}this.isSubject=R}return Vt(ae,[{key:"getSweepEvents",value:function(){for(var R=[],j=0,b=this.polys.length;j<b;j++)for(var ce=this.polys[j].getSweepEvents(),Ye=0,Pt=ce.length;Ye<Pt;Ye++)R.push(ce[Ye]);return R}}]),ae}(),We=function(){Vt(ae,null,[{key:"factory",value:function(R){for(var j=[],b=0,ce=R.length;b<ce;b++){var Ye=R[b];if(!(!Ye.isInResult()||Ye.ringOut)){for(var Pt=null,te=Ye.leftSE,he=Ye.rightSE,ve=[te],it=te.point,at=[];Pt=te,te=he,ve.push(te),te.point!==it;)for(;;){var fe=te.getAvailableLinkedEvents();if(fe.length===0){var wr=ve[0].point,Dr=ve[ve.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(wr.x,",")+" ".concat(wr.y,"]. Last matching segment found ends at")+" [".concat(Dr.x,", ").concat(Dr.y,"]."))}if(fe.length===1){he=fe[0].otherSE;break}for(var Nr=null,yt=0,jr=at.length;yt<jr;yt++)if(at[yt].point===te.point){Nr=yt;break}if(Nr!==null){var Dn=at.splice(Nr)[0],ai=ve.splice(Dn.index);ai.unshift(ai[0].otherSE),j.push(new ae(ai.reverse()));continue}at.push({index:ve.length,point:te.point});var Mi=te.getLeftmostComparator(Pt);he=fe.sort(Mi)[0].otherSE;break}j.push(new ae(ve))}}return j}}]);function ae(z){Ze(this,ae),this.events=z;for(var R=0,j=z.length;R<j;R++)z[R].segment.ringOut=this;this.poly=null}return Vt(ae,[{key:"getGeom",value:function(){for(var R=this.events[0].point,j=[R],b=1,ce=this.events.length-1;b<ce;b++){var Ye=this.events[b].point,Pt=this.events[b+1].point;V(Ye,R,Pt)!==0&&(j.push(Ye),R=Ye)}if(j.length===1)return null;var te=j[0],he=j[1];V(te,R,he)===0&&j.shift(),j.push(j[0]);for(var ve=this.isExteriorRing()?1:-1,it=this.isExteriorRing()?0:j.length-1,at=this.isExteriorRing()?j.length:-1,fe=[],wr=it;wr!=at;wr+=ve)fe.push([j[wr].x,j[wr].y]);return fe}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var R=this.enclosingRing();this._isExteriorRing=R?!R.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var R=this.events[0],j=1,b=this.events.length;j<b;j++){var ce=this.events[j];q.compare(R,ce)>0&&(R=ce)}for(var Ye=R.segment.prevInResult(),Pt=Ye?Ye.prevInResult():null;;){if(!Ye)return null;if(!Pt)return Ye.ringOut;if(Pt.ringOut!==Ye.ringOut)return Pt.ringOut.enclosingRing()!==Ye.ringOut?Ye.ringOut:Ye.ringOut.enclosingRing();Ye=Pt.prevInResult(),Pt=Ye?Ye.prevInResult():null}}}]),ae}(),xt=function(){function ae(z){Ze(this,ae),this.exteriorRing=z,z.poly=this,this.interiorRings=[]}return Vt(ae,[{key:"addInterior",value:function(R){this.interiorRings.push(R),R.poly=this}},{key:"getGeom",value:function(){var R=[this.exteriorRing.getGeom()];if(R[0]===null)return null;for(var j=0,b=this.interiorRings.length;j<b;j++){var ce=this.interiorRings[j].getGeom();ce!==null&&R.push(ce)}return R}}]),ae}(),jt=function(){function ae(z){Ze(this,ae),this.rings=z,this.polys=this._composePolys(z)}return Vt(ae,[{key:"getGeom",value:function(){for(var R=[],j=0,b=this.polys.length;j<b;j++){var ce=this.polys[j].getGeom();ce!==null&&R.push(ce)}return R}},{key:"_composePolys",value:function(R){for(var j=[],b=0,ce=R.length;b<ce;b++){var Ye=R[b];if(!Ye.poly)if(Ye.isExteriorRing())j.push(new xt(Ye));else{var Pt=Ye.enclosingRing();Pt.poly||j.push(new xt(Pt)),Pt.poly.addInterior(Ye)}}return j}}]),ae}(),Gt=function(){function ae(z){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ae.compare;Ze(this,ae),this.queue=z,this.tree=new dr(R),this.segments=[]}return Vt(ae,[{key:"process",value:function(R){var j=R.segment,b=[];if(R.consumedBy)return R.isLeft?this.queue.remove(R.otherSE):this.tree.remove(j),b;var ce=R.isLeft?this.tree.insert(j):this.tree.find(j);if(!ce)throw new Error("Unable to find segment #".concat(j.id," ")+"[".concat(j.leftSE.point.x,", ").concat(j.leftSE.point.y,"] -> ")+"[".concat(j.rightSE.point.x,", ").concat(j.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var Ye=ce,Pt=ce,te=void 0,he=void 0;te===void 0;)Ye=this.tree.prev(Ye),Ye===null?te=null:Ye.key.consumedBy===void 0&&(te=Ye.key);for(;he===void 0;)Pt=this.tree.next(Pt),Pt===null?he=null:Pt.key.consumedBy===void 0&&(he=Pt.key);if(R.isLeft){var ve=null;if(te){var it=te.getIntersection(j);if(it!==null&&(j.isAnEndpoint(it)||(ve=it),!te.isAnEndpoint(it)))for(var at=this._splitSafely(te,it),fe=0,wr=at.length;fe<wr;fe++)b.push(at[fe])}var Dr=null;if(he){var Nr=he.getIntersection(j);if(Nr!==null&&(j.isAnEndpoint(Nr)||(Dr=Nr),!he.isAnEndpoint(Nr)))for(var yt=this._splitSafely(he,Nr),jr=0,Dn=yt.length;jr<Dn;jr++)b.push(yt[jr])}if(ve!==null||Dr!==null){var ai=null;if(ve===null)ai=Dr;else if(Dr===null)ai=ve;else{var Mi=q.comparePoints(ve,Dr);ai=Mi<=0?ve:Dr}this.queue.remove(j.rightSE),b.push(j.rightSE);for(var Li=j.split(ai),Kn=0,L=Li.length;Kn<L;Kn++)b.push(Li[Kn])}b.length>0?(this.tree.remove(j),b.push(R)):(this.segments.push(j),j.prev=te)}else{if(te&&he){var N=te.getIntersection(he);if(N!==null){if(!te.isAnEndpoint(N))for(var H=this._splitSafely(te,N),ne=0,xe=H.length;ne<xe;ne++)b.push(H[ne]);if(!he.isAnEndpoint(N))for(var Ne=this._splitSafely(he,N),Qe=0,J=Ne.length;Qe<J;Qe++)b.push(Ne[Qe])}}this.tree.remove(j)}return b}},{key:"_splitSafely",value:function(R,j){this.tree.remove(R);var b=R.rightSE;this.queue.remove(b);var ce=R.split(j);return ce.push(b),R.consumedBy===void 0&&this.tree.insert(R),ce}}]),ae}(),Rt=typeof vt!="undefined"&&{NODE_ENV:"production"}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Ar=typeof vt!="undefined"&&{NODE_ENV:"production"}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,Gr=function(){function ae(){Ze(this,ae)}return Vt(ae,[{key:"run",value:function(R,j,b){er.type=R,we.reset();for(var ce=[new He(j,!0)],Ye=0,Pt=b.length;Ye<Pt;Ye++)ce.push(new He(b[Ye],!1));if(er.numMultiPolys=ce.length,er.type==="difference")for(var te=ce[0],he=1;he<ce.length;)mt(ce[he].bbox,te.bbox)!==null?he++:ce.splice(he,1);if(er.type==="intersection"){for(var ve=0,it=ce.length;ve<it;ve++)for(var at=ce[ve],fe=ve+1,wr=ce.length;fe<wr;fe++)if(mt(at.bbox,ce[fe].bbox)===null)return[]}for(var Dr=new dr(q.compare),Nr=0,yt=ce.length;Nr<yt;Nr++)for(var jr=ce[Nr].getSweepEvents(),Dn=0,ai=jr.length;Dn<ai;Dn++)if(Dr.insert(jr[Dn]),Dr.size>Rt)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var Mi=new Gt(Dr),Li=Dr.size,Kn=Dr.pop();Kn;){var L=Kn.key;if(Dr.size===Li){var N=L.segment;throw new Error("Unable to pop() ".concat(L.isLeft?"left":"right"," SweepEvent ")+"[".concat(L.point.x,", ").concat(L.point.y,"] from segment #").concat(N.id," ")+"[".concat(N.leftSE.point.x,", ").concat(N.leftSE.point.y,"] -> ")+"[".concat(N.rightSE.point.x,", ").concat(N.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(Dr.size>Rt)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(Mi.segments.length>Ar)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var H=Mi.process(L),ne=0,xe=H.length;ne<xe;ne++){var Ne=H[ne];Ne.consumedBy===void 0&&Dr.insert(Ne)}Li=Dr.size,Kn=Dr.pop()}we.reset();var Qe=We.factory(Mi.segments),J=new jt(Qe);return J.getGeom()}}]),ae}(),er=new Gr,$e=function(z){for(var R=arguments.length,j=new Array(R>1?R-1:0),b=1;b<R;b++)j[b-1]=arguments[b];return er.run("union",z,j)},rt=function(z){for(var R=arguments.length,j=new Array(R>1?R-1:0),b=1;b<R;b++)j[b-1]=arguments[b];return er.run("intersection",z,j)},Wt=function(z){for(var R=arguments.length,j=new Array(R>1?R-1:0),b=1;b<R;b++)j[b-1]=arguments[b];return er.run("xor",z,j)},Kt=function(z){for(var R=arguments.length,j=new Array(R>1?R-1:0),b=1;b<R;b++)j[b-1]=arguments[b];return er.run("difference",z,j)},ur={union:$e,intersection:rt,xor:Wt,difference:Kt};return ur})},69848:function(ci){(function(mn,ot){ci.exports=ot()})(this,function(){"use strict";function mn(Se,me,De,we,ze,Qt){if(!(ze-we<=De)){var V=we+ze>>1;ot(Se,me,V,we,ze,Qt%2),mn(Se,me,De,we,V-1,Qt+1),mn(Se,me,De,V+1,ze,Qt+1)}}function ot(Se,me,De,we,ze,Qt){for(;ze>we;){if(ze-we>600){var V=ze-we+1,pe=De-we+1,P=Math.log(V),U=.5*Math.exp(2*P/3),B=.5*Math.sqrt(P*U*(V-U)/V)*(pe-V/2<0?-1:1),E=Math.max(we,Math.floor(De-pe*U/V+B)),D=Math.min(ze,Math.floor(De+(V-pe)*U/V+B));ot(Se,me,De,E,D,Qt)}var q=me[2*De+Qt],Q=we,Ae=ze;for(vt(Se,me,we,De),me[2*ze+Qt]>q&&vt(Se,me,we,ze);Q<Ae;){for(vt(Se,me,Q,Ae),Q++,Ae--;me[2*Q+Qt]<q;)Q++;for(;me[2*Ae+Qt]>q;)Ae--}me[2*we+Qt]===q?vt(Se,me,we,Ae):(Ae++,vt(Se,me,Ae,ze)),Ae<=De&&(we=Ae+1),De<=Ae&&(ze=Ae-1)}}function vt(Se,me,De,we){Ze(Se,De,we),Ze(me,2*De,2*we),Ze(me,2*De+1,2*we+1)}function Ze(Se,me,De){var we=Se[me];Se[me]=Se[De],Se[De]=we}function l(Se,me,De,we,ze,Qt,V){for(var pe=[0,Se.length-1,0],P=[],U,B;pe.length;){var E=pe.pop(),D=pe.pop(),q=pe.pop();if(D-q<=V){for(var Q=q;Q<=D;Q++)U=me[2*Q],B=me[2*Q+1],U>=De&&U<=ze&&B>=we&&B<=Qt&&P.push(Se[Q]);continue}var Ae=Math.floor((q+D)/2);U=me[2*Ae],B=me[2*Ae+1],U>=De&&U<=ze&&B>=we&&B<=Qt&&P.push(Se[Ae]);var ct=(E+1)%2;(E===0?De<=U:we<=B)&&(pe.push(q),pe.push(Ae-1),pe.push(ct)),(E===0?ze>=U:Qt>=B)&&(pe.push(Ae+1),pe.push(D),pe.push(ct))}return P}function Vt(Se,me,De,we,ze,Qt){for(var V=[0,Se.length-1,0],pe=[],P=ze*ze;V.length;){var U=V.pop(),B=V.pop(),E=V.pop();if(B-E<=Qt){for(var D=E;D<=B;D++)ge(me[2*D],me[2*D+1],De,we)<=P&&pe.push(Se[D]);continue}var q=Math.floor((E+B)/2),Q=me[2*q],Ae=me[2*q+1];ge(Q,Ae,De,we)<=P&&pe.push(Se[q]);var ct=(U+1)%2;(U===0?De-ze<=Q:we-ze<=Ae)&&(V.push(E),V.push(q-1),V.push(ct)),(U===0?De+ze>=Q:we+ze>=Ae)&&(V.push(q+1),V.push(B),V.push(ct))}return pe}function ge(Se,me,De,we){var ze=Se-De,Qt=me-we;return ze*ze+Qt*Qt}var Mt=function(Se){return Se[0]},Le=function(Se){return Se[1]},Tt=function(me,De,we,ze,Qt){De===void 0&&(De=Mt),we===void 0&&(we=Le),ze===void 0&&(ze=64),Qt===void 0&&(Qt=Float64Array),this.nodeSize=ze,this.points=me;for(var V=me.length<65536?Uint16Array:Uint32Array,pe=this.ids=new V(me.length),P=this.coords=new Qt(me.length*2),U=0;U<me.length;U++)pe[U]=U,P[2*U]=De(me[U]),P[2*U+1]=we(me[U]);mn(pe,P,ze,0,pe.length-1,0)};Tt.prototype.range=function(me,De,we,ze){return l(this.ids,this.coords,me,De,we,ze,this.nodeSize)},Tt.prototype.within=function(me,De,we){return Vt(this.ids,this.coords,me,De,we,this.nodeSize)};var Fe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Se){return Se}},dt=Math.fround||function(Se){return function(me){return Se[0]=+me,Se[0]}}(new Float32Array(1)),nr=function(me){this.options=mt(Object.create(Fe),me),this.trees=new Array(this.options.maxZoom+1)};nr.prototype.load=function(me){var De=this.options,we=De.log,ze=De.minZoom,Qt=De.maxZoom,V=De.nodeSize;we&&console.time("total time");var pe="prepare "+me.length+" points";we&&console.time(pe),this.points=me;for(var P=[],U=0;U<me.length;U++)!me[U].geometry||P.push(Dt(me[U],U));this.trees[Qt+1]=new Tt(P,k,Te,V,Float32Array),we&&console.timeEnd(pe);for(var B=Qt;B>=ze;B--){var E=+Date.now();P=this._cluster(P,B),this.trees[B]=new Tt(P,k,Te,V,Float32Array),we&&console.log("z%d: %d clusters in %dms",B,P.length,+Date.now()-E)}return we&&console.timeEnd("total time"),this},nr.prototype.getClusters=function(me,De){var we=((me[0]+180)%360+360)%360-180,ze=Math.max(-90,Math.min(90,me[1])),Qt=me[2]===180?180:((me[2]+180)%360+360)%360-180,V=Math.max(-90,Math.min(90,me[3]));if(me[2]-me[0]>=360)we=-180,Qt=180;else if(we>Qt){var pe=this.getClusters([we,ze,180,V],De),P=this.getClusters([-180,ze,Qt,V],De);return pe.concat(P)}for(var U=this.trees[this._limitZoom(De)],B=U.range(fr(we),Et(V),fr(Qt),Et(ze)),E=[],D=0,q=B;D<q.length;D+=1){var Q=q[D],Ae=U.points[Q];E.push(Ae.numPoints?Er(Ae):this.points[Ae.index])}return E},nr.prototype.getChildren=function(me){var De=this._getOriginId(me),we=this._getOriginZoom(me),ze="No cluster with the specified id.",Qt=this.trees[we];if(!Qt)throw new Error(ze);var V=Qt.points[De];if(!V)throw new Error(ze);for(var pe=this.options.radius/(this.options.extent*Math.pow(2,we-1)),P=Qt.within(V.x,V.y,pe),U=[],B=0,E=P;B<E.length;B+=1){var D=E[B],q=Qt.points[D];q.parentId===me&&U.push(q.numPoints?Er(q):this.points[q.index])}if(U.length===0)throw new Error(ze);return U},nr.prototype.getLeaves=function(me,De,we){De=De||10,we=we||0;var ze=[];return this._appendLeaves(ze,me,De,we,0),ze},nr.prototype.getTile=function(me,De,we){var ze=this.trees[this._limitZoom(me)],Qt=Math.pow(2,me),V=this.options,pe=V.extent,P=V.radius,U=P/pe,B=(we-U)/Qt,E=(we+1+U)/Qt,D={features:[]};return this._addTileFeatures(ze.range((De-U)/Qt,B,(De+1+U)/Qt,E),ze.points,De,we,Qt,D),De===0&&this._addTileFeatures(ze.range(1-U/Qt,B,1,E),ze.points,Qt,we,Qt,D),De===Qt-1&&this._addTileFeatures(ze.range(0,B,U/Qt,E),ze.points,-1,we,Qt,D),D.features.length?D:null},nr.prototype.getClusterExpansionZoom=function(me){for(var De=this._getOriginZoom(me)-1;De<=this.options.maxZoom;){var we=this.getChildren(me);if(De++,we.length!==1)break;me=we[0].properties.cluster_id}return De},nr.prototype._appendLeaves=function(me,De,we,ze,Qt){for(var V=this.getChildren(De),pe=0,P=V;pe<P.length;pe+=1){var U=P[pe],B=U.properties;if(B&&B.cluster?Qt+B.point_count<=ze?Qt+=B.point_count:Qt=this._appendLeaves(me,B.cluster_id,we,ze,Qt):Qt<ze?Qt++:me.push(U),me.length===we)break}return Qt},nr.prototype._addTileFeatures=function(me,De,we,ze,Qt,V){for(var pe=0,P=me;pe<P.length;pe+=1){var U=P[pe],B=De[U],E=B.numPoints,D=void 0,q=void 0,Q=void 0;if(E)D=wt(B),q=B.x,Q=B.y;else{var Ae=this.points[B.index];D=Ae.properties,q=fr(Ae.geometry.coordinates[0]),Q=Et(Ae.geometry.coordinates[1])}var ct={type:1,geometry:[[Math.round(this.options.extent*(q*Qt-we)),Math.round(this.options.extent*(Q*Qt-ze))]],tags:D},ke=void 0;E?ke=B.id:this.options.generateId?ke=B.index:this.points[B.index].id&&(ke=this.points[B.index].id),ke!==void 0&&(ct.id=ke),V.features.push(ct)}},nr.prototype._limitZoom=function(me){return Math.max(this.options.minZoom,Math.min(Math.floor(+me),this.options.maxZoom+1))},nr.prototype._cluster=function(me,De){for(var we=[],ze=this.options,Qt=ze.radius,V=ze.extent,pe=ze.reduce,P=ze.minPoints,U=Qt/(V*Math.pow(2,De)),B=0;B<me.length;B++){var E=me[B];if(!(E.zoom<=De)){E.zoom=De;for(var D=this.trees[De+1],q=D.within(E.x,E.y,U),Q=E.numPoints||1,Ae=Q,ct=0,ke=q;ct<ke.length;ct+=1){var He=ke[ct],We=D.points[He];We.zoom>De&&(Ae+=We.numPoints||1)}if(Ae>Q&&Ae>=P){for(var xt=E.x*Q,jt=E.y*Q,Gt=pe&&Q>1?this._map(E,!0):null,Rt=(B<<5)+(De+1)+this.points.length,Ar=0,Gr=q;Ar<Gr.length;Ar+=1){var er=Gr[Ar],$e=D.points[er];if(!($e.zoom<=De)){$e.zoom=De;var rt=$e.numPoints||1;xt+=$e.x*rt,jt+=$e.y*rt,$e.parentId=Rt,pe&&(Gt||(Gt=this._map(E,!0)),pe(Gt,this._map($e)))}}E.parentId=Rt,we.push(dr(xt/Ae,jt/Ae,Rt,Ae,Gt))}else if(we.push(E),Ae>1)for(var Wt=0,Kt=q;Wt<Kt.length;Wt+=1){var ur=Kt[Wt],ae=D.points[ur];ae.zoom<=De||(ae.zoom=De,we.push(ae))}}}return we},nr.prototype._getOriginId=function(me){return me-this.points.length>>5},nr.prototype._getOriginZoom=function(me){return(me-this.points.length)%32},nr.prototype._map=function(me,De){if(me.numPoints)return De?mt({},me.properties):me.properties;var we=this.points[me.index].properties,ze=this.options.map(we);return De&&ze===we?mt({},ze):ze};function dr(Se,me,De,we,ze){return{x:dt(Se),y:dt(me),zoom:Infinity,id:De,parentId:-1,numPoints:we,properties:ze}}function Dt(Se,me){var De=Se.geometry.coordinates,we=De[0],ze=De[1];return{x:dt(fr(we)),y:dt(Et(ze)),zoom:Infinity,index:me,parentId:-1}}function Er(Se){return{type:"Feature",id:Se.id,properties:wt(Se),geometry:{type:"Point",coordinates:[vr(Se.x),kt(Se.y)]}}}function wt(Se){var me=Se.numPoints,De=me>=1e4?Math.round(me/1e3)+"k":me>=1e3?Math.round(me/100)/10+"k":me;return mt(mt({},Se.properties),{cluster:!0,cluster_id:Se.id,point_count:me,point_count_abbreviated:De})}function fr(Se){return Se/360+.5}function Et(Se){var me=Math.sin(Se*Math.PI/180),De=.5-.25*Math.log((1+me)/(1-me))/Math.PI;return De<0?0:De>1?1:De}function vr(Se){return(Se-.5)*360}function kt(Se){var me=(180-Se*360)*Math.PI/180;return 360*Math.atan(Math.exp(me))/Math.PI-90}function mt(Se,me){for(var De in me)Se[De]=me[De];return Se}function k(Se){return Se.x}function Te(Se){return Se.y}return nr})},81458:function(ci,mn,ot){"use strict";ot.d(mn,{Z:function(){return ct}});var vt=ot(6610),Ze=ot(5991),l=ot(46070),Vt=ot(77608),ge=ot(10379),Mt=ot(63349),Le=ot(28481),Tt=ot(98333);function Fe(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function dt(ke,He){var We=Tt.fF([],He,ke);return Tt.bA(We,We,1/We[3]),We}function nr(ke,He){var We=ke%He;return We<0?He+We:We}function dr(ke,He,We){return We*He+(1-We)*ke}var Dt=ot(85975),Er=ot(31437),wt=ot(77160);function fr(ke,He){if(!ke)throw new Error(He||"viewport-mercator-project: assertion failed.")}var Et=Math.PI,vr=Et/4,kt=Et/180,mt=180/Et,k=512,Te=4003e4,Se=1.5;function me(ke){return Math.pow(2,ke)}function De(ke){return Math.log2(ke)}function we(ke,He){var We=(0,Le.Z)(ke,2),xt=We[0],jt=We[1];fr(Number.isFinite(xt)&&Number.isFinite(He)),fr(Number.isFinite(jt)&&jt>=-90&&jt<=90,"invalid latitude"),He*=k;var Gt=xt*kt,Rt=jt*kt,Ar=He*(Gt+Et)/(2*Et),Gr=He*(Et-Math.log(Math.tan(vr+Rt*.5)))/(2*Et);return[Ar,Gr]}function ze(ke,He){var We=(0,Le.Z)(ke,2),xt=We[0],jt=We[1];He*=k;var Gt=xt/He*(2*Et)-Et,Rt=2*(Math.atan(Math.exp(Et-jt/He*(2*Et)))-vr);return[Gt*mt,Rt*mt]}function Qt(ke){var He=ke.latitude;assert(Number.isFinite(He));var We=Math.cos(He*kt);return De(Te*We)-9}function V(ke){var He=ke.latitude,We=ke.longitude,xt=ke.zoom,jt=ke.scale,Gt=ke.highPrecision,Rt=Gt===void 0?!1:Gt;jt=jt!==void 0?jt:me(xt),fr(Number.isFinite(He)&&Number.isFinite(We)&&Number.isFinite(jt));var Ar={},Gr=k*jt,er=Math.cos(He*kt),$e=Gr/360,rt=$e/er,Wt=Gr/Te/er;if(Ar.pixelsPerMeter=[Wt,-Wt,Wt],Ar.metersPerPixel=[1/Wt,-1/Wt,1/Wt],Ar.pixelsPerDegree=[$e,-rt,Wt],Ar.degreesPerPixel=[1/$e,-1/rt,1/Wt],Rt){var Kt=kt*Math.tan(He*kt)/er,ur=$e*Kt/2,ae=Gr/Te*Kt,z=ae/rt*Wt;Ar.pixelsPerDegree2=[0,-ur,ae],Ar.pixelsPerMeter2=[z,0,z]}return Ar}function pe(ke,He){var We=_slicedToArray(ke,3),xt=We[0],jt=We[1],Gt=We[2],Rt=_slicedToArray(He,3),Ar=Rt[0],Gr=Rt[1],er=Rt[2],$e=1,rt=V({longitude:xt,latitude:jt,scale:$e,highPrecision:!0}),Wt=rt.pixelsPerMeter,Kt=rt.pixelsPerMeter2,ur=we(ke,$e);ur[0]+=Ar*(Wt[0]+Kt[0]*Gr),ur[1]+=Gr*(Wt[1]+Kt[1]*Gr);var ae=ze(ur,$e),z=(Gt||0)+(er||0);return Number.isFinite(Gt)||Number.isFinite(er)?[ae[0],ae[1],z]:ae}function P(ke){var He=ke.height,We=ke.pitch,xt=ke.bearing,jt=ke.altitude,Gt=ke.center,Rt=Gt===void 0?null:Gt,Ar=ke.flipY,Gr=Ar===void 0?!1:Ar,er=Fe();return Dt.translate(er,er,[0,0,-jt]),Dt.scale(er,er,[1,1,1/He]),Dt.rotateX(er,er,-We*kt),Dt.rotateZ(er,er,xt*kt),Gr&&Dt.scale(er,er,[1,-1,1]),Rt&&Dt.translate(er,er,wt.negate([],Rt)),er}function U(ke){var He=ke.width,We=ke.height,xt=ke.altitude,jt=xt===void 0?Se:xt,Gt=ke.pitch,Rt=Gt===void 0?0:Gt,Ar=ke.nearZMultiplier,Gr=Ar===void 0?1:Ar,er=ke.farZMultiplier,$e=er===void 0?1:er,rt=Rt*kt,Wt=Math.atan(.5/jt),Kt=Math.sin(Wt)*jt/Math.sin(Math.PI/2-rt-Wt),ur=Math.cos(Math.PI/2-rt)*Kt+jt;return{fov:2*Math.atan(We/2/jt),aspect:He/We,focalDistance:jt,near:Gr,far:ur*$e}}function B(ke){var He=ke.width,We=ke.height,xt=ke.pitch,jt=ke.altitude,Gt=ke.nearZMultiplier,Rt=ke.farZMultiplier,Ar=U({width:He,height:We,altitude:jt,pitch:xt,nearZMultiplier:Gt,farZMultiplier:Rt}),Gr=Ar.fov,er=Ar.aspect,$e=Ar.near,rt=Ar.far,Wt=Dt.perspective([],Gr,er,$e,rt);return Wt}function E(ke,He){var We=(0,Le.Z)(ke,3),xt=We[0],jt=We[1],Gt=We[2],Rt=Gt===void 0?0:Gt;return fr(Number.isFinite(xt)&&Number.isFinite(jt)&&Number.isFinite(Rt)),dt(He,[xt,jt,Rt,1])}function D(ke,He){var We=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,xt=(0,Le.Z)(ke,3),jt=xt[0],Gt=xt[1],Rt=xt[2];if(fr(Number.isFinite(jt)&&Number.isFinite(Gt),"invalid pixel coordinate"),Number.isFinite(Rt)){var Ar=dt(He,[jt,Gt,Rt,1]);return Ar}var Gr=dt(He,[jt,Gt,0,1]),er=dt(He,[jt,Gt,1,1]),$e=Gr[2],rt=er[2],Wt=$e===rt?0:((We||0)-$e)/(rt-$e);return Er.t7([],Gr,er,Wt)}var q=Fe(),Q=function(){function ke(){var He=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},We=He.width,xt=He.height,jt=He.viewMatrix,Gt=jt===void 0?q:jt,Rt=He.projectionMatrix,Ar=Rt===void 0?q:Rt;(0,vt.Z)(this,ke),this.width=We||1,this.height=xt||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=Gt,this.projectionMatrix=Ar;var Gr=Fe();Dt.multiply(Gr,Gr,this.projectionMatrix),Dt.multiply(Gr,Gr,this.viewMatrix),this.viewProjectionMatrix=Gr;var er=Fe();Dt.scale(er,er,[this.width/2,-this.height/2,1]),Dt.translate(er,er,[1,-1,0]),Dt.multiply(er,er,this.viewProjectionMatrix);var $e=Dt.invert(Fe(),er);if(!$e)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=er,this.pixelUnprojectionMatrix=$e,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,Ze.Z)(ke,[{key:"equals",value:function(We){return We instanceof ke?We.width===this.width&&We.height===this.height&&Dt.equals(We.projectionMatrix,this.projectionMatrix)&&Dt.equals(We.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(We){var xt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},jt=xt.topLeft,Gt=jt===void 0?!0:jt,Rt=this.projectPosition(We),Ar=E(Rt,this.pixelProjectionMatrix),Gr=(0,Le.Z)(Ar,2),er=Gr[0],$e=Gr[1],rt=Gt?$e:this.height-$e;return We.length===2?[er,rt]:[er,rt,Ar[2]]}},{key:"unproject",value:function(We){var xt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},jt=xt.topLeft,Gt=jt===void 0?!0:jt,Rt=xt.targetZ,Ar=(0,Le.Z)(We,3),Gr=Ar[0],er=Ar[1],$e=Ar[2],rt=Gt?er:this.height-er,Wt=Rt&&Rt*this.pixelsPerMeter,Kt=D([Gr,rt,$e],this.pixelUnprojectionMatrix,Wt),ur=this.unprojectPosition(Kt),ae=(0,Le.Z)(ur,3),z=ae[0],R=ae[1],j=ae[2];return Number.isFinite($e)?[z,R,j]:Number.isFinite(Rt)?[z,R,Rt]:[z,R]}},{key:"projectPosition",value:function(We){var xt=this.projectFlat(We),jt=(0,Le.Z)(xt,2),Gt=jt[0],Rt=jt[1],Ar=(We[2]||0)*this.pixelsPerMeter;return[Gt,Rt,Ar]}},{key:"unprojectPosition",value:function(We){var xt=this.unprojectFlat(We),jt=(0,Le.Z)(xt,2),Gt=jt[0],Rt=jt[1],Ar=(We[2]||0)/this.pixelsPerMeter;return[Gt,Rt,Ar]}},{key:"projectFlat",value:function(We){var xt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return We}},{key:"unprojectFlat",value:function(We){var xt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return We}}]),ke}();function Ae(ke){var He=ke.width,We=ke.height,xt=ke.bounds,jt=ke.minExtent,Gt=jt===void 0?0:jt,Rt=ke.maxZoom,Ar=Rt===void 0?24:Rt,Gr=ke.padding,er=Gr===void 0?0:Gr,$e=ke.offset,rt=$e===void 0?[0,0]:$e,Wt=(0,Le.Z)(xt,2),Kt=(0,Le.Z)(Wt[0],2),ur=Kt[0],ae=Kt[1],z=(0,Le.Z)(Wt[1],2),R=z[0],j=z[1];if(Number.isFinite(er)){var b=er;er={top:b,bottom:b,left:b,right:b}}else fr(Number.isFinite(er.top)&&Number.isFinite(er.bottom)&&Number.isFinite(er.left)&&Number.isFinite(er.right));var ce=new ct({width:He,height:We,longitude:0,latitude:0,zoom:0}),Ye=ce.project([ur,j]),Pt=ce.project([R,ae]),te=[Math.max(Math.abs(Pt[0]-Ye[0]),Gt),Math.max(Math.abs(Pt[1]-Ye[1]),Gt)],he=[He-er.left-er.right-Math.abs(rt[0])*2,We-er.top-er.bottom-Math.abs(rt[1])*2];fr(he[0]>0&&he[1]>0);var ve=he[0]/te[0],it=he[1]/te[1],at=(er.right-er.left)/2/ve,fe=(er.bottom-er.top)/2/it,wr=[(Pt[0]+Ye[0])/2+at,(Pt[1]+Ye[1])/2+fe],Dr=ce.unproject(wr),Nr=ce.zoom+Math.log2(Math.abs(Math.min(ve,it)));return{longitude:Dr[0],latitude:Dr[1],zoom:Math.min(Nr,Ar)}}var ct=function(ke){(0,ge.Z)(He,ke);function He(){var We,xt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},jt=xt.width,Gt=xt.height,Rt=xt.latitude,Ar=Rt===void 0?0:Rt,Gr=xt.longitude,er=Gr===void 0?0:Gr,$e=xt.zoom,rt=$e===void 0?0:$e,Wt=xt.pitch,Kt=Wt===void 0?0:Wt,ur=xt.bearing,ae=ur===void 0?0:ur,z=xt.altitude,R=z===void 0?1.5:z,j=xt.nearZMultiplier,b=xt.farZMultiplier;(0,vt.Z)(this,He),jt=jt||1,Gt=Gt||1;var ce=me(rt);R=Math.max(.75,R);var Ye=we([er,Ar],ce);Ye[2]=0;var Pt=B({width:jt,height:Gt,pitch:Kt,bearing:ae,altitude:R,nearZMultiplier:j||1/Gt,farZMultiplier:b||1.01}),te=P({height:Gt,center:Ye,pitch:Kt,bearing:ae,altitude:R,flipY:!0});return We=(0,l.Z)(this,(0,Vt.Z)(He).call(this,{width:jt,height:Gt,viewMatrix:te,projectionMatrix:Pt})),We.latitude=Ar,We.longitude=er,We.zoom=rt,We.pitch=Kt,We.bearing=ae,We.altitude=R,We.scale=ce,We.center=Ye,We.pixelsPerMeter=V((0,Mt.Z)((0,Mt.Z)(We))).pixelsPerMeter[2],Object.freeze((0,Mt.Z)((0,Mt.Z)(We))),We}return(0,Ze.Z)(He,[{key:"projectFlat",value:function(xt){var jt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return we(xt,jt)}},{key:"unprojectFlat",value:function(xt){var jt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return ze(xt,jt)}},{key:"getMapCenterByLngLatPosition",value:function(xt){var jt=xt.lngLat,Gt=xt.pos,Rt=D(Gt,this.pixelUnprojectionMatrix),Ar=we(jt,this.scale),Gr=Er.IH([],Ar,Er.tk([],Rt)),er=Er.IH([],this.center,Gr);return ze(er,this.scale)}},{key:"getLocationAtPoint",value:function(xt){var jt=xt.lngLat,Gt=xt.pos;return this.getMapCenterByLngLatPosition({lngLat:jt,pos:Gt})}},{key:"fitBounds",value:function(xt){var jt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Gt=this.width,Rt=this.height,Ar=Ae(Object.assign({width:Gt,height:Rt,bounds:xt},jt)),Gr=Ar.longitude,er=Ar.latitude,$e=Ar.zoom;return new He({width:Gt,height:Rt,longitude:Gr,latitude:er,zoom:$e})}}]),He}(Q)},63797:function(ci,mn,ot){"use strict";ot.d(mn,{qH:function(){return pe},ez:function(){return Wt}});function vt(te,he){if(!te)throw new Error(he||"web worker helper assertion failed.")}var Ze={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,document:typeof document!="undefined"&&document},l=Ze.self||Ze.window||{},Vt=Ze.window||Ze.self||{},ge=Ze.self||Ze.window||{},Mt=Ze.document||{},Le=typeof importScripts=="function",Tt=typeof window!="undefined"&&typeof window.orientation!="undefined",Fe=function(){function te(he,ve){var it=this;this.name=he,this.workerThread=ve,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise(function(at,fe){it.resolve=at,it.reject=fe})}return te.prototype.postMessage=function(he,ve){this.workerThread.postMessage({source:"Main thread",type:he,payload:ve})},te.prototype.done=function(he){vt(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(he)},te.prototype.error=function(he){vt(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(he)},te}(),dt=Fe,nr=new Map;function dr(te){vt(te.source&&!te.url||!te.source&&te.url);var he=nr.get(te.source||te.url);return he||(te.url&&(he=Dt(te.url),nr.set(te.url,he)),te.source&&(he=Er(te.source),nr.set(te.source,he))),vt(he),he}function Dt(te){if(!te.startsWith("http"))return te;var he=wt(te);return Er(he)}function Er(te){var he=new Blob([te],{type:"application/javascript"});return URL.createObjectURL(he)}function wt(te){return`try {
  importScripts('`+te+`');
} catch (error) {
  console.error(error);
  throw error;
}`}function fr(te,he,ve){he===void 0&&(he=!0);var it=ve||new Set;if(te){if(Et(te))it.add(te);else if(Et(te.buffer))it.add(te.buffer);else if(!ArrayBuffer.isView(te)){if(he&&typeof te=="object")for(var at in te)fr(te[at],he,it)}}return ve===void 0?Array.from(it):[]}function Et(te){return te?te instanceof ArrayBuffer||typeof MessagePort!="undefined"&&te instanceof MessagePort||typeof ImageBitmap!="undefined"&&te instanceof ImageBitmap||typeof OffscreenCanvas!="undefined"&&te instanceof OffscreenCanvas:!1}var vr=function(){},kt=function(){function te(he){this.terminated=!1,this.loadableURL="";var ve=he.name,it=he.source,at=he.url;vt(it||at),this.name=ve,this.source=it,this.url=at,this.onMessage=vr,this.onError=function(fe){return console.log(fe)},this.worker=this.createBrowserWorker()}return te.isSupported=function(){return typeof Worker!="undefined"},te.prototype.destroy=function(){this.onMessage=vr,this.onError=vr,this.worker.terminate(),this.terminated=!0},Object.defineProperty(te.prototype,"isRunning",{get:function(){return Boolean(this.onMessage)},enumerable:!1,configurable:!0}),te.prototype.postMessage=function(he,ve){ve=ve||fr(he),this.worker.postMessage(he,ve)},te.prototype.getErrorFromErrorEvent=function(he){var ve="Failed to load ";return ve+="worker "+this.name+" from "+this.url+". ",he.message&&(ve+=he.message+" in "),he.lineno&&(ve+=":"+he.lineno+":"+he.colno),new Error(ve)},te.prototype.createBrowserWorker=function(){var he=this;this.loadableURL=dr({source:this.source,url:this.url});var ve=new Worker(this.loadableURL,{name:this.name});return ve.onmessage=function(it){it.data?he.onMessage(it.data):he.onError(new Error("No data received"))},ve.onerror=function(it){he.onError(he.getErrorFromErrorEvent(it)),he.terminated=!0},ve.onmessageerror=function(it){return console.error("worker "+he.name+", message error: "+it)},ve},te}(),mt=kt,k=function(){return k=Object.assign||function(te){for(var he,ve=1,it=arguments.length;ve<it;ve++){he=arguments[ve];for(var at in he)Object.prototype.hasOwnProperty.call(he,at)&&(te[at]=he[at])}return te},k.apply(this,arguments)},Te=function(te,he,ve,it){function at(fe){return fe instanceof ve?fe:new ve(function(wr){wr(fe)})}return new(ve||(ve=Promise))(function(fe,wr){function Dr(jr){try{yt(it.next(jr))}catch(Dn){wr(Dn)}}function Nr(jr){try{yt(it.throw(jr))}catch(Dn){wr(Dn)}}function yt(jr){jr.done?fe(jr.value):at(jr.value).then(Dr,Nr)}yt((it=it.apply(te,he||[])).next())})},Se=function(te,he){var ve={label:0,sent:function(){if(fe[0]&1)throw fe[1];return fe[1]},trys:[],ops:[]},it,at,fe,wr;return wr={next:Dr(0),throw:Dr(1),return:Dr(2)},typeof Symbol=="function"&&(wr[Symbol.iterator]=function(){return this}),wr;function Dr(yt){return function(jr){return Nr([yt,jr])}}function Nr(yt){if(it)throw new TypeError("Generator is already executing.");for(;ve;)try{if(it=1,at&&(fe=yt[0]&2?at.return:yt[0]?at.throw||((fe=at.return)&&fe.call(at),0):at.next)&&!(fe=fe.call(at,yt[1])).done)return fe;switch(at=0,fe&&(yt=[yt[0]&2,fe.value]),yt[0]){case 0:case 1:fe=yt;break;case 4:return ve.label++,{value:yt[1],done:!1};case 5:ve.label++,at=yt[1],yt=[0];continue;case 7:yt=ve.ops.pop(),ve.trys.pop();continue;default:if(fe=ve.trys,!(fe=fe.length>0&&fe[fe.length-1])&&(yt[0]===6||yt[0]===2)){ve=0;continue}if(yt[0]===3&&(!fe||yt[1]>fe[0]&&yt[1]<fe[3])){ve.label=yt[1];break}if(yt[0]===6&&ve.label<fe[1]){ve.label=fe[1],fe=yt;break}if(fe&&ve.label<fe[2]){ve.label=fe[2],ve.ops.push(yt);break}fe[2]&&ve.ops.pop(),ve.trys.pop();continue}yt=he.call(te,ve)}catch(jr){yt=[6,jr],at=0}finally{it=fe=0}if(yt[0]&5)throw yt[1];return{value:yt[0]?yt[1]:void 0,done:!0}}},me=function(){function te(he){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=he.source,this.url=he.url,this.setProps(he)}return te.prototype.destroy=function(){this.idleQueue.forEach(function(he){return he.destroy()}),this.isDestroyed=!0},te.prototype.setProps=function(he){this.props=k(k({},this.props),he),he.name!==void 0&&(this.name=he.name),he.maxConcurrency!==void 0&&(this.maxConcurrency=he.maxConcurrency),he.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=he.maxMobileConcurrency),he.reuseWorkers!==void 0&&(this.reuseWorkers=he.reuseWorkers),he.onDebug!==void 0&&(this.onDebug=he.onDebug)},te.prototype.startJob=function(he,ve,it){return ve===void 0&&(ve=function(at,fe,wr){return at.done(wr)}),it===void 0&&(it=function(at,fe){return at.error(fe)}),Te(this,void 0,void 0,function(){var at,fe=this;return Se(this,function(wr){switch(wr.label){case 0:return at=new Promise(function(Dr){return fe.jobQueue.push({name:he,onMessage:ve,onError:it,onStart:Dr}),fe}),this.startQueuedJob(),[4,at];case 1:return[2,wr.sent()]}})})},te.prototype.startQueuedJob=function(){return Te(this,void 0,void 0,function(){var he,ve,it;return Se(this,function(at){switch(at.label){case 0:if(!this.jobQueue.length)return[2];if(he=this.getAvailableWorker(),!he)return[2];if(ve=this.jobQueue.shift(),!ve)return[3,4];this.onDebug({message:"Starting job",name:ve.name,backlog:this.jobQueue.length,workerThread:he}),it=new dt(ve.name,he),he.onMessage=function(fe){return ve.onMessage(it,fe.type,fe.payload)},he.onError=function(fe){return ve.onError(it,fe)},ve.onStart(it),at.label=1;case 1:return at.trys.push([1,,3,4]),[4,it.result];case 2:return at.sent(),[3,4];case 3:return this.returnWorkerToQueue(he),[7];case 4:return[2]}})})},te.prototype.returnWorkerToQueue=function(he){var ve=this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency();ve?(he.destroy(),this.count--):this.idleQueue.push(he),this.isDestroyed||this.startQueuedJob()},te.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var he=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new mt({name:he,source:this.source,url:this.url})}return null},te.prototype.getMaxConcurrency=function(){return Tt?this.maxMobileConcurrency:this.maxConcurrency},te}(),De=me,we=function(){return we=Object.assign||function(te){for(var he,ve=1,it=arguments.length;ve<it;ve++){he=arguments[ve];for(var at in he)Object.prototype.hasOwnProperty.call(he,at)&&(te[at]=he[at])}return te},we.apply(this,arguments)},ze=function(te){var he=typeof Symbol=="function"&&Symbol.iterator,ve=he&&te[he],it=0;if(ve)return ve.call(te);if(te&&typeof te.length=="number")return{next:function(){return te&&it>=te.length&&(te=void 0),{value:te&&te[it++],done:!te}}};throw new TypeError(he?"Object is not iterable.":"Symbol.iterator is not defined.")},Qt={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},V=function(){function te(he){this.workerPools=new Map,this.props=we({},Qt),this.setProps(he),this.workerPools=new Map}return te.isSupported=function(){return mt.isSupported()},te.getWorkerFarm=function(he){return he===void 0&&(he={}),te.workerFarm=te.workerFarm||new te({}),te.workerFarm.setProps(he),te.workerFarm},te.prototype.destroy=function(){var he,ve;try{for(var it=ze(this.workerPools.values()),at=it.next();!at.done;at=it.next()){var fe=at.value;fe.destroy()}}catch(wr){he={error:wr}}finally{try{at&&!at.done&&(ve=it.return)&&ve.call(it)}finally{if(he)throw he.error}}},te.prototype.setProps=function(he){var ve,it;this.props=we(we({},this.props),he);try{for(var at=ze(this.workerPools.values()),fe=at.next();!fe.done;fe=at.next()){var wr=fe.value;wr.setProps(this.getWorkerPoolProps())}}catch(Dr){ve={error:Dr}}finally{try{fe&&!fe.done&&(it=at.return)&&it.call(at)}finally{if(ve)throw ve.error}}},te.prototype.getWorkerPool=function(he){var ve=he.name,it=he.source,at=he.url,fe=this.workerPools.get(ve);return fe||(fe=new De({name:ve,source:it,url:at}),fe.setProps(this.getWorkerPoolProps()),this.workerPools.set(ve,fe)),fe},te.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}},te}(),pe=V,P=new Map,U=function(){function te(){}return Object.defineProperty(te,"onmessage",{set:function(he){self.onmessage=function(ve){if(!!E(ve)){var it=ve.data,at=it.type,fe=it.payload;he(at,fe)}}},enumerable:!1,configurable:!0}),te.addEventListener=function(he){var ve=P.get(he);ve||(ve=function(it){if(!!E(it)){var at=it.data,fe=at.type,wr=at.payload;he(fe,wr)}}),self.addEventListener("message",ve)},te.removeEventListener=function(he){var ve=P.get(he);P.delete(he),self.removeEventListener("message",ve)},te.postMessage=function(he,ve){if(self){var it={source:"Worker thread",type:he,payload:ve},at=fr(ve);self.postMessage(it,at)}},te}(),B=U;function E(te){var he=te.type,ve=te.data;return he==="message"&&ve&&typeof ve.source=="string"&&ve.source==="Main thread"}function D(te){return JSON.parse(q(te))}function q(te){var he=new Set;return JSON.stringify(te,function(ve,it){if(typeof it=="object"&&it!==null){if(he.has(it))try{return JSON.parse(JSON.stringify(it))}catch(at){return}he.add(it)}return it})}function Q(te){return""+te.name}function Ae(te,he){he===void 0&&(he={});var ve=he[te.id]||{},it=te.name+".worker.js",at=ve.workerUrl;return he._workerType==="test"&&(at=te.module+"/dist/"+it),at||(at="https://unpkg.com/"+te.module+"/dist/"+it),assert(at),at}var ct=function(te,he,ve,it){function at(fe){return fe instanceof ve?fe:new ve(function(wr){wr(fe)})}return new(ve||(ve=Promise))(function(fe,wr){function Dr(jr){try{yt(it.next(jr))}catch(Dn){wr(Dn)}}function Nr(jr){try{yt(it.throw(jr))}catch(Dn){wr(Dn)}}function yt(jr){jr.done?fe(jr.value):at(jr.value).then(Dr,Nr)}yt((it=it.apply(te,he||[])).next())})},ke=function(te,he){var ve={label:0,sent:function(){if(fe[0]&1)throw fe[1];return fe[1]},trys:[],ops:[]},it,at,fe,wr;return wr={next:Dr(0),throw:Dr(1),return:Dr(2)},typeof Symbol=="function"&&(wr[Symbol.iterator]=function(){return this}),wr;function Dr(yt){return function(jr){return Nr([yt,jr])}}function Nr(yt){if(it)throw new TypeError("Generator is already executing.");for(;ve;)try{if(it=1,at&&(fe=yt[0]&2?at.return:yt[0]?at.throw||((fe=at.return)&&fe.call(at),0):at.next)&&!(fe=fe.call(at,yt[1])).done)return fe;switch(at=0,fe&&(yt=[yt[0]&2,fe.value]),yt[0]){case 0:case 1:fe=yt;break;case 4:return ve.label++,{value:yt[1],done:!1};case 5:ve.label++,at=yt[1],yt=[0];continue;case 7:yt=ve.ops.pop(),ve.trys.pop();continue;default:if(fe=ve.trys,!(fe=fe.length>0&&fe[fe.length-1])&&(yt[0]===6||yt[0]===2)){ve=0;continue}if(yt[0]===3&&(!fe||yt[1]>fe[0]&&yt[1]<fe[3])){ve.label=yt[1];break}if(yt[0]===6&&ve.label<fe[1]){ve.label=fe[1],fe=yt;break}if(fe&&ve.label<fe[2]){ve.label=fe[2],ve.ops.push(yt);break}fe[2]&&ve.ops.pop(),ve.trys.pop();continue}yt=he.call(te,ve)}catch(jr){yt=[6,jr],at=0}finally{it=fe=0}if(yt[0]&5)throw yt[1];return{value:yt[0]?yt[1]:void 0,done:!0}}};function He(te,he){return WorkerFarm.isSupported()?te.worker&&(he==null?void 0:he.worker):!1}function We(te,he,ve,it){return ve===void 0&&(ve={}),it===void 0&&(it={}),ct(this,void 0,void 0,function(){var at,fe,wr,Dr,Nr,yt,jr,Dn;return ke(this,function(ai){switch(ai.label){case 0:return at=getWorkerName(te),fe=getWorkerURL(te,ve),wr=WorkerFarm.getWorkerFarm(ve),Dr=wr.getWorkerPool({name:at,url:fe}),Nr=ve.jobName||te.name,[4,Dr.startJob(Nr,xt.bind(null,it))];case 1:return yt=ai.sent(),jr=removeNontransferableOptions(ve),yt.postMessage("process",{input:he,options:jr}),[4,yt.result];case 2:return Dn=ai.sent(),[2,Dn.result]}})})}function xt(te,he,ve,it){return ct(this,void 0,void 0,function(){var at,fe,wr,Dr,Nr,yt,jr;return ke(this,function(Dn){switch(Dn.label){case 0:switch(at=ve,at){case"done":return[3,1];case"error":return[3,2];case"process":return[3,3]}return[3,8];case 1:return he.done(it),[3,9];case 2:return he.error(new Error(it.error)),[3,9];case 3:fe=it.id,wr=it.input,Dr=it.options,Dn.label=4;case 4:return Dn.trys.push([4,6,,7]),te.process?[4,te.process(wr,Dr)]:(he.postMessage("error",{id:fe,error:"Worker not set up to process on main thread"}),[2]);case 5:return Nr=Dn.sent(),he.postMessage("done",{id:fe,result:Nr}),[3,7];case 6:return yt=Dn.sent(),jr=yt instanceof Error?yt.message:"unknown error",he.postMessage("error",{id:fe,error:jr}),[3,7];case 7:return[3,9];case 8:console.warn("process-on-worker: unknown message "+ve),Dn.label=9;case 9:return[2]}})})}var jt=function(){function te(){this._values=[],this._settlers=[],this._closed=!1}return te.prototype[Symbol.asyncIterator]=function(){return this},te.prototype.push=function(he){return this.enqueue(he)},te.prototype.enqueue=function(he){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var ve=this._settlers.shift();he instanceof Error?ve.reject(he):ve.resolve({value:he})}else this._values.push(he)},te.prototype.close=function(){for(;this._settlers.length>0;){var he=this._settlers.shift();he.resolve({done:!0})}this._closed=!0},te.prototype.next=function(){var he=this;if(this._values.length>0){var ve=this._values.shift();return ve instanceof Error?Promise.reject(ve):Promise.resolve({done:!1,value:ve})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise(function(it,at){he._settlers.push({resolve:it,reject:at})})},te}(),Gt=jt,Rt=function(te,he,ve,it){function at(fe){return fe instanceof ve?fe:new ve(function(wr){wr(fe)})}return new(ve||(ve=Promise))(function(fe,wr){function Dr(jr){try{yt(it.next(jr))}catch(Dn){wr(Dn)}}function Nr(jr){try{yt(it.throw(jr))}catch(Dn){wr(Dn)}}function yt(jr){jr.done?fe(jr.value):at(jr.value).then(Dr,Nr)}yt((it=it.apply(te,he||[])).next())})},Ar=function(te,he){var ve={label:0,sent:function(){if(fe[0]&1)throw fe[1];return fe[1]},trys:[],ops:[]},it,at,fe,wr;return wr={next:Dr(0),throw:Dr(1),return:Dr(2)},typeof Symbol=="function"&&(wr[Symbol.iterator]=function(){return this}),wr;function Dr(yt){return function(jr){return Nr([yt,jr])}}function Nr(yt){if(it)throw new TypeError("Generator is already executing.");for(;ve;)try{if(it=1,at&&(fe=yt[0]&2?at.return:yt[0]?at.throw||((fe=at.return)&&fe.call(at),0):at.next)&&!(fe=fe.call(at,yt[1])).done)return fe;switch(at=0,fe&&(yt=[yt[0]&2,fe.value]),yt[0]){case 0:case 1:fe=yt;break;case 4:return ve.label++,{value:yt[1],done:!1};case 5:ve.label++,at=yt[1],yt=[0];continue;case 7:yt=ve.ops.pop(),ve.trys.pop();continue;default:if(fe=ve.trys,!(fe=fe.length>0&&fe[fe.length-1])&&(yt[0]===6||yt[0]===2)){ve=0;continue}if(yt[0]===3&&(!fe||yt[1]>fe[0]&&yt[1]<fe[3])){ve.label=yt[1];break}if(yt[0]===6&&ve.label<fe[1]){ve.label=fe[1],fe=yt;break}if(fe&&ve.label<fe[2]){ve.label=fe[2],ve.ops.push(yt);break}fe[2]&&ve.ops.pop(),ve.trys.pop();continue}yt=he.call(te,ve)}catch(jr){yt=[6,jr],at=0}finally{it=fe=0}if(yt[0]&5)throw yt[1];return{value:yt[0]?yt[1]:void 0,done:!0}}},Gr=function(te){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var he=te[Symbol.asyncIterator],ve;return he?he.call(te):(te=typeof __values=="function"?__values(te):te[Symbol.iterator](),ve={},it("next"),it("throw"),it("return"),ve[Symbol.asyncIterator]=function(){return this},ve);function it(fe){ve[fe]=te[fe]&&function(wr){return new Promise(function(Dr,Nr){wr=te[fe](wr),at(Dr,Nr,wr.done,wr.value)})}}function at(fe,wr,Dr,Nr){Promise.resolve(Nr).then(function(yt){fe({value:yt,done:Dr})},wr)}},er=0,$e,rt;function Wt(te,he){var ve=this;if(typeof self!="undefined"){var it={process:Kt};B.onmessage=function(at,fe){return Rt(ve,void 0,void 0,function(){var wr,Dr,Nr,yt,jr,Dn,ai,Mi,Li,Kn,L;return Ar(this,function(N){switch(N.label){case 0:switch(N.trys.push([0,19,,20]),wr=at,wr){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!te)throw new Error("Worker does not support atomic processing");return[4,te(fe.input,fe.options||{},it)];case 2:return Dr=N.sent(),B.postMessage("done",{result:Dr}),[3,18];case 3:if(!he)throw new Error("Worker does not support batched processing");$e=new Gt,rt=fe.options||{},Nr=he($e,rt,it),N.label=4;case 4:N.trys.push([4,9,10,15]),yt=Gr(Nr),N.label=5;case 5:return[4,yt.next()];case 6:if(jr=N.sent(),!!jr.done)return[3,8];Dn=jr.value,B.postMessage("output-batch",{result:Dn}),N.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return ai=N.sent(),Kn={error:ai},[3,15];case 10:return N.trys.push([10,,13,14]),jr&&!jr.done&&(L=yt.return)?[4,L.call(yt)]:[3,12];case 11:N.sent(),N.label=12;case 12:return[3,14];case 13:if(Kn)throw Kn.error;return[7];case 14:return[7];case 15:return B.postMessage("done",{}),[3,18];case 16:return $e.push(fe.input),[3,18];case 17:return $e.close(),[3,18];case 18:return[3,20];case 19:return Mi=N.sent(),Li=Mi instanceof Error?Mi.message:"",B.postMessage("error",{error:Li}),[3,20];case 20:return[2]}})})}}}function Kt(te,he){return he===void 0&&(he={}),new Promise(function(ve,it){var at=er++,fe=function(Dr,Nr){if(Nr.id===at)switch(Dr){case"done":B.removeEventListener(fe),ve(Nr.result);break;case"error":B.removeEventListener(fe),it(Nr.error);break;default:}};B.addEventListener(fe);var wr={id:at,input:te,options:he};B.postMessage("process",wr)})}var ur=function(te,he,ve,it){function at(fe){return fe instanceof ve?fe:new ve(function(wr){wr(fe)})}return new(ve||(ve=Promise))(function(fe,wr){function Dr(jr){try{yt(it.next(jr))}catch(Dn){wr(Dn)}}function Nr(jr){try{yt(it.throw(jr))}catch(Dn){wr(Dn)}}function yt(jr){jr.done?fe(jr.value):at(jr.value).then(Dr,Nr)}yt((it=it.apply(te,he||[])).next())})},ae=function(te,he){var ve={label:0,sent:function(){if(fe[0]&1)throw fe[1];return fe[1]},trys:[],ops:[]},it,at,fe,wr;return wr={next:Dr(0),throw:Dr(1),return:Dr(2)},typeof Symbol=="function"&&(wr[Symbol.iterator]=function(){return this}),wr;function Dr(yt){return function(jr){return Nr([yt,jr])}}function Nr(yt){if(it)throw new TypeError("Generator is already executing.");for(;ve;)try{if(it=1,at&&(fe=yt[0]&2?at.return:yt[0]?at.throw||((fe=at.return)&&fe.call(at),0):at.next)&&!(fe=fe.call(at,yt[1])).done)return fe;switch(at=0,fe&&(yt=[yt[0]&2,fe.value]),yt[0]){case 0:case 1:fe=yt;break;case 4:return ve.label++,{value:yt[1],done:!1};case 5:ve.label++,at=yt[1],yt=[0];continue;case 7:yt=ve.ops.pop(),ve.trys.pop();continue;default:if(fe=ve.trys,!(fe=fe.length>0&&fe[fe.length-1])&&(yt[0]===6||yt[0]===2)){ve=0;continue}if(yt[0]===3&&(!fe||yt[1]>fe[0]&&yt[1]<fe[3])){ve.label=yt[1];break}if(yt[0]===6&&ve.label<fe[1]){ve.label=fe[1],fe=yt;break}if(fe&&ve.label<fe[2]){ve.label=fe[2],ve.ops.push(yt);break}fe[2]&&ve.ops.pop(),ve.trys.pop();continue}yt=he.call(te,ve)}catch(jr){yt=[6,jr],at=0}finally{it=fe=0}if(yt[0]&5)throw yt[1];return{value:yt[0]?yt[1]:void 0,done:!0}}},z={};function R(te,he,ve){return he===void 0&&(he=null),ve===void 0&&(ve={}),ur(this,void 0,void 0,function(){return ae(this,function(it){switch(it.label){case 0:return he&&(te=j(te,he,ve)),z[te]=z[te]||b(te),[4,z[te]];case 1:return[2,it.sent()]}})})}function j(te,he,ve){if(te.startsWith("http"))return te;var it=ve.modules||{};return it[te]?it[te]:ve.CDN?(assert(ve.CDN.startsWith("http")),ve.CDN+"/"+he+"/dist/libs/"+te):isWorker?"../src/libs/"+te:"modules/"+he+"/src/libs/"+te}function b(te){return ur(this,void 0,void 0,function(){var he,ve,it;return ae(this,function(at){switch(at.label){case 0:return te.endsWith("wasm")?[4,fetch(te)]:[3,3];case 1:return he=at.sent(),[4,he.arrayBuffer()];case 2:return[2,at.sent()];case 3:return isWorker?[2,importScripts(te)]:[4,fetch(te)];case 4:return ve=at.sent(),[4,ve.text()];case 5:return it=at.sent(),[2,ce(it,te)]}})})}function ce(te,he){if(isWorker)return eval.call(global,te),null;var ve=document.createElement("script");ve.id=he;try{ve.appendChild(document.createTextNode(te))}catch(it){ve.text=te}return document.body.appendChild(ve),null}var Ye="0.0.3",Pt={id:"null",name:"null",module:"web-worker-helper",options:{}}}}]);
