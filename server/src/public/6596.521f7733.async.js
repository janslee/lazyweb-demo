var eI=(Se,N,w)=>new Promise((k,D)=>{var F=me=>{try{X(w.next(me))}catch(K){D(K)}},U=me=>{try{X(w.throw(me))}catch(K){D(K)}},X=me=>me.done?k(me.value):Promise.resolve(me.value).then(F,U);X((w=w.apply(Se,N)).next())});(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[6596],{3422:function(Se,N,w){"use strict";w.d(N,{Z:function(){return FQ}});var k={};w.r(k),w.d(k,{Container:function(){return po},Contribution:function(){return Mi},DefaultContributionProvider:function(){return Ci},GlobalContainer:function(){return J},Module:function(){return Nr},OptionSymbol:function(){return Nn},Provider:function(){return vi},Syringe:function(){return L},SyringeModule:function(){return ai},Utils:function(){return he},contrib:function(){return wr},decorate:function(){return R.GW},inject:function(){return St},injectable:function(){return at},named:function(){return sr},optional:function(){return R.jt},postConstruct:function(){return R.zY},register:function(){return pi},registerSideOption:function(){return Vr},singleton:function(){return Yt},transient:function(){return Cn},unmanaged:function(){return R.NT}});var D={};w.r(D),w.d(D,{async:function(){return U5},block:function(){return N5},circle:function(){return Y_},circlePlus:function(){return V5},classic:function(){return R5},cross:function(){return B5},diamond:function(){return I5},ellipse:function(){return H5},path:function(){return G5}});var F={};w.r(F),w.d(F,{annotations:function(){return C5},atConnectionLength:function(){return Q5},atConnectionLengthIgnoreGradient:function(){return q5},atConnectionLengthKeepGradient:function(){return K_},atConnectionRatio:function(){return eB},atConnectionRatioIgnoreGradient:function(){return J5},atConnectionRatioKeepGradient:function(){return q_},connection:function(){return K5},displayEmpty:function(){return E5},eol:function(){return w5},fill:function(){return g5},filter:function(){return O5},html:function(){return P5},lineHeight:function(){return y5},port:function(){return D5},ref:function(){return J6},refCx:function(){return i5},refCy:function(){return o5},refD:function(){return c5},refDKeepOffset:function(){return s5},refDResetOffset:function(){return B_},refDx:function(){return Q6},refDy:function(){return e5},refHeight:function(){return G_},refHeight2:function(){return p5},refPoints:function(){return u5},refPointsKeepOffset:function(){return a5},refPointsResetOffset:function(){return z_},refR:function(){return l5},refRCircumscribed:function(){return r5},refRInscribed:function(){return F_},refRx:function(){return t5},refRy:function(){return n5},refWidth:function(){return L_},refWidth2:function(){return f5},refX:function(){return k_},refX2:function(){return d5},refY:function(){return I_},refY2:function(){return h5},resetOffset:function(){return T5},sourceMarker:function(){return W5},stroke:function(){return m5},style:function(){return M5},targetMarker:function(){return Z5},text:function(){return H_},textPath:function(){return x5},textVerticalAnchor:function(){return b5},textWrap:function(){return v5},title:function(){return S5},vertexMarker:function(){return X5},xAlign:function(){return _5},yAlign:function(){return A5}});var U={};w.r(U),w.d(U,{dot:function(){return tB},doubleMesh:function(){return iB},fixedDot:function(){return nB},mesh:function(){return rB}});var X={};w.r(X),w.d(X,{blur:function(){return aB},brightness:function(){return pB},contrast:function(){return gB},dropShadow:function(){return lB},grayScale:function(){return cB},highlight:function(){return sB},hueRotate:function(){return hB},invert:function(){return fB},outline:function(){return oB},saturate:function(){return dB},sepia:function(){return uB}});var me={};w.r(me),w.d(me,{flipX:function(){return J_},flipXY:function(){return eA},flipY:function(){return Q_},watermark:function(){return mB}});var K={};w.r(K),w.d(K,{className:function(){return vB},opacity:function(){return yB},stroke:function(){return xB}});var q={};w.r(q),w.d(q,{absolute:function(){return CB},bottom:function(){return PB},ellipse:function(){return wB},ellipseSpread:function(){return EB},left:function(){return AB},line:function(){return _B},right:function(){return TB},top:function(){return MB}});var ae={};w.r(ae),w.d(ae,{bottom:function(){return IB},inside:function(){return FB},insideOriented:function(){return BB},left:function(){return NB},manual:function(){return DB},outside:function(){return LB},outsideOriented:function(){return GB},radial:function(){return zB},radialOriented:function(){return UB},right:function(){return RB},top:function(){return kB}});var ee={};w.r(ee),w.d(ee,{noop:function(){return HB},pinAbsolute:function(){return XB},pinRelative:function(){return ZB}});var V={};w.r(V),w.d(V,{bottom:function(){return oz},bottomLeft:function(){return uz},bottomRight:function(){return dz},center:function(){return rz},left:function(){return sz},midSide:function(){return pz},nodeCenter:function(){return fz},orth:function(){return hz},right:function(){return az},top:function(){return iz},topLeft:function(){return lz},topRight:function(){return cz}});var W={};w.r(W),w.d(W,{closest:function(){return vz},length:function(){return mz},orth:function(){return yz},ratio:function(){return gz}});var ce={};w.r(ce),w.d(ce,{anchor:function(){return Ez},bbox:function(){return bA},boundary:function(){return Cz},rect:function(){return xz}});var B={};w.r(B),w.d(B,{er:function(){return Vz},loop:function(){return jz},manhattan:function(){return NA},metro:function(){return Uz},normal:function(){return Sz},oneSide:function(){return _z},orth:function(){return wA}});var se={};w.r(se),w.d(se,{jumpover:function(){return Jz},loop:function(){return $z},normal:function(){return Hz},rounded:function(){return Wz},smooth:function(){return Zz}});var j={};w.r(j),w.d(j,{ConnectorNode:function(){return tJ},DataIONode:function(){return nJ},DatabaseNode:function(){return iJ},DecisionNode:function(){return eJ},DelayNode:function(){return gJ},DisplayNode:function(){return vJ},DocumentNode:function(){return aJ},ExtractNode:function(){return uJ},HardDiskNode:function(){return oJ},InternalStorageNode:function(){return CJ},ManualInputNode:function(){return fJ},ManualOperationNode:function(){return mJ},MergeNode:function(){return dJ},MultiDocumentNode:function(){return lJ},NoteLeftNode:function(){return bJ},NoteRightNode:function(){return xJ},OffPageLinkNode:function(){return yJ},OrNode:function(){return hJ},PredefinedProcessNode:function(){return cJ},PreparationNode:function(){return pJ},ProcessNode:function(){return Qq},StroedDataNode:function(){return sJ},TerminalNode:function(){return rJ},TextNode:function(){return wJ}});var b=w(67294),R=w(86700),Me=w(34155);function re(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function ve(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?re(Object(t),!0).forEach(function(n){At(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):re(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function ht(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ht=function(e){return typeof e}:ht=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ht(r)}function A(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Oe(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Ue(r,e,t){return e&&Oe(r.prototype,e),t&&Oe(r,t),r}function At(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Xt(r){return On(r)||le(r)||Fn(r)||qn()}function On(r){if(Array.isArray(r))return hr(r)}function le(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Fn(r,e){if(!!r){if(typeof r=="string")return hr(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return hr(r,e)}}function hr(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function qn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var pr;(function(r){(function(e){var t=typeof w.g=="object"?w.g:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),n=i(r);typeof t.Reflect=="undefined"?t.Reflect=r:n=i(t.Reflect,n),e(n);function i(o,s){return function(a,l){typeof o[a]!="function"&&Object.defineProperty(o,a,{configurable:!0,writable:!0,value:l}),s&&s(a,l)}}})(function(e){var t=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",i=n&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",o=n&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",s=typeof Object.create=="function",a={__proto__:[]}instanceof Array,l=!s&&!a,c={create:s?function(){return Bu(Object.create(null))}:a?function(){return Bu({__proto__:null})}:function(){return Bu({})},has:l?function(qe,Ot){return t.call(qe,Ot)}:function(qe,Ot){return Ot in qe},get:l?function(qe,Ot){return t.call(qe,Ot)?qe[Ot]:void 0}:function(qe,Ot){return qe[Ot]}},u=Object.getPrototypeOf(Function),d=typeof Me=="object"&&{NODE_ENV:"production"}&&{NODE_ENV:"production"}.REFLECT_METADATA_USE_MAP_POLYFILL==="true",h=!d&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:gs(),f=!d&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:hh(),p=!d&&typeof WeakMap=="function"?WeakMap:Tp(),g=new p;function v(qe,Ot,Jt,hn){if(gn(Jt)){if(!ci(qe))throw new TypeError;if(!ui(Ot))throw new TypeError;return fe(qe,Ot)}else{if(!ci(qe))throw new TypeError;if(!Nt(Ot))throw new TypeError;if(!Nt(hn)&&!gn(hn)&&!si(hn))throw new TypeError;return si(hn)&&(hn=void 0),Jt=Gn(Jt),Ae(qe,Ot,Jt,hn)}}e("decorate",v);function y(qe,Ot){function Jt(hn,$n){if(!Nt(hn))throw new TypeError;if(!gn($n)&&!Aa($n))throw new TypeError;Kt(qe,Ot,hn,$n)}return Jt}e("metadata",y);function x(qe,Ot,Jt,hn){if(!Nt(Jt))throw new TypeError;return gn(hn)||(hn=Gn(hn)),Kt(qe,Ot,Jt,hn)}e("defineMetadata",x);function E(qe,Ot,Jt){if(!Nt(Ot))throw new TypeError;return gn(Jt)||(Jt=Gn(Jt)),ct(qe,Ot,Jt)}e("hasMetadata",E);function T(qe,Ot,Jt){if(!Nt(Ot))throw new TypeError;return gn(Jt)||(Jt=Gn(Jt)),bt(qe,Ot,Jt)}e("hasOwnMetadata",T);function P(qe,Ot,Jt){if(!Nt(Ot))throw new TypeError;return gn(Jt)||(Jt=Gn(Jt)),Pe(qe,Ot,Jt)}e("getMetadata",P);function z(qe,Ot,Jt){if(!Nt(Ot))throw new TypeError;return gn(Jt)||(Jt=Gn(Jt)),tt(qe,Ot,Jt)}e("getOwnMetadata",z);function $(qe,Ot){if(!Nt(qe))throw new TypeError;return gn(Ot)||(Ot=Gn(Ot)),tn(qe,Ot)}e("getMetadataKeys",$);function ne(qe,Ot){if(!Nt(qe))throw new TypeError;return gn(Ot)||(Ot=Gn(Ot)),Bn(qe,Ot)}e("getOwnMetadataKeys",ne);function De(qe,Ot,Jt){if(!Nt(Ot))throw new TypeError;gn(Jt)||(Jt=Gn(Jt));var hn=de(Ot,Jt,!1);if(gn(hn)||!hn.delete(qe))return!1;if(hn.size>0)return!0;var $n=g.get(Ot);return $n.delete(Jt),$n.size>0||g.delete(Ot),!0}e("deleteMetadata",De);function fe(qe,Ot){for(var Jt=qe.length-1;Jt>=0;--Jt){var hn=qe[Jt],$n=hn(Ot);if(!gn($n)&&!si($n)){if(!ui($n))throw new TypeError;Ot=$n}}return Ot}function Ae(qe,Ot,Jt,hn){for(var $n=qe.length-1;$n>=0;--$n){var bn=qe[$n],yr=bn(Ot,Jt,hn);if(!gn(yr)&&!si(yr)){if(!Nt(yr))throw new TypeError;hn=yr}}return hn}function de(qe,Ot,Jt){var hn=g.get(qe);if(gn(hn)){if(!Jt)return;hn=new h,g.set(qe,hn)}var $n=hn.get(Ot);if(gn($n)){if(!Jt)return;$n=new h,hn.set(Ot,$n)}return $n}function ct(qe,Ot,Jt){var hn=bt(qe,Ot,Jt);if(hn)return!0;var $n=dh(Ot);return si($n)?!1:ct(qe,$n,Jt)}function bt(qe,Ot,Jt){var hn=de(Ot,Jt,!1);return gn(hn)?!1:Pn(hn.has(qe))}function Pe(qe,Ot,Jt){var hn=bt(qe,Ot,Jt);if(hn)return tt(qe,Ot,Jt);var $n=dh(Ot);if(!si($n))return Pe(qe,$n,Jt)}function tt(qe,Ot,Jt){var hn=de(Ot,Jt,!1);if(!gn(hn))return hn.get(qe)}function Kt(qe,Ot,Jt,hn){var $n=de(Jt,hn,!0);$n.set(qe,Ot)}function tn(qe,Ot){var Jt=Bn(qe,Ot),hn=dh(qe);if(hn===null)return Jt;var $n=tn(hn,Ot);if($n.length<=0)return Jt;if(Jt.length<=0)return $n;for(var bn=new f,yr=[],zr=0,Tn=Jt;zr<Tn.length;zr++){var ti=Tn[zr],Kr=bn.has(ti);Kr||(bn.add(ti),yr.push(ti))}for(var Eo=0,zu=$n;Eo<zu.length;Eo++){var ti=zu[Eo],Kr=bn.has(ti);Kr||(bn.add(ti),yr.push(ti))}return yr}function Bn(qe,Ot){var Jt=[],hn=de(qe,Ot,!1);if(gn(hn))return Jt;for(var $n=hn.keys(),bn=Gu($n),yr=0;;){var zr=Fu(bn);if(!zr)return Jt.length=yr,Jt;var Tn=Dc(zr);try{Jt[yr]=Tn}catch(ti){try{Pm(bn)}finally{throw ti}}yr++}}function cr(qe){if(qe===null)return 1;switch(typeof qe){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return qe===null?1:6;default:return 6}}function gn(qe){return qe===void 0}function si(qe){return qe===null}function xi(qe){return typeof qe=="symbol"}function Nt(qe){return typeof qe=="object"?qe!==null:typeof qe=="function"}function fn(qe,Ot){switch(cr(qe)){case 0:return qe;case 1:return qe;case 2:return qe;case 3:return qe;case 4:return qe;case 5:return qe}var Jt=Ot===3?"string":Ot===5?"number":"default",hn=Ta(qe,i);if(hn!==void 0){var $n=hn.call(qe,Jt);if(Nt($n))throw new TypeError;return $n}return Kn(qe,Jt==="default"?"number":Jt)}function Kn(qe,Ot){if(Ot==="string"){var Jt=qe.toString;if(Bo(Jt)){var hn=Jt.call(qe);if(!Nt(hn))return hn}var $n=qe.valueOf;if(Bo($n)){var hn=$n.call(qe);if(!Nt(hn))return hn}}else{var $n=qe.valueOf;if(Bo($n)){var hn=$n.call(qe);if(!Nt(hn))return hn}var bn=qe.toString;if(Bo(bn)){var hn=bn.call(qe);if(!Nt(hn))return hn}}throw new TypeError}function Pn(qe){return!!qe}function vr(qe){return""+qe}function Gn(qe){var Ot=fn(qe,3);return xi(Ot)?Ot:vr(Ot)}function ci(qe){return Array.isArray?Array.isArray(qe):qe instanceof Object?qe instanceof Array:Object.prototype.toString.call(qe)==="[object Array]"}function Bo(qe){return typeof qe=="function"}function ui(qe){return typeof qe=="function"}function Aa(qe){switch(cr(qe)){case 3:return!0;case 4:return!0;default:return!1}}function Ta(qe,Ot){var Jt=qe[Ot];if(Jt!=null){if(!Bo(Jt))throw new TypeError;return Jt}}function Gu(qe){var Ot=Ta(qe,o);if(!Bo(Ot))throw new TypeError;var Jt=Ot.call(qe);if(!Nt(Jt))throw new TypeError;return Jt}function Dc(qe){return qe.value}function Fu(qe){var Ot=qe.next();return Ot.done?!1:Ot}function Pm(qe){var Ot=qe.return;Ot&&Ot.call(qe)}function dh(qe){var Ot=Object.getPrototypeOf(qe);if(typeof qe!="function"||qe===u||Ot!==u)return Ot;var Jt=qe.prototype,hn=Jt&&Object.getPrototypeOf(Jt);if(hn==null||hn===Object.prototype)return Ot;var $n=hn.constructor;return typeof $n!="function"||$n===qe?Ot:$n}function gs(){var qe={},Ot=[],Jt=function(){function yr(zr,Tn,ti){this._index=0,this._keys=zr,this._values=Tn,this._selector=ti}return yr.prototype["@@iterator"]=function(){return this},yr.prototype[o]=function(){return this},yr.prototype.next=function(){var zr=this._index;if(zr>=0&&zr<this._keys.length){var Tn=this._selector(this._keys[zr],this._values[zr]);return zr+1>=this._keys.length?(this._index=-1,this._keys=Ot,this._values=Ot):this._index++,{value:Tn,done:!1}}return{value:void 0,done:!0}},yr.prototype.throw=function(zr){throw this._index>=0&&(this._index=-1,this._keys=Ot,this._values=Ot),zr},yr.prototype.return=function(zr){return this._index>=0&&(this._index=-1,this._keys=Ot,this._values=Ot),{value:zr,done:!0}},yr}();return function(){function yr(){this._keys=[],this._values=[],this._cacheKey=qe,this._cacheIndex=-2}return Object.defineProperty(yr.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),yr.prototype.has=function(zr){return this._find(zr,!1)>=0},yr.prototype.get=function(zr){var Tn=this._find(zr,!1);return Tn>=0?this._values[Tn]:void 0},yr.prototype.set=function(zr,Tn){var ti=this._find(zr,!0);return this._values[ti]=Tn,this},yr.prototype.delete=function(zr){var Tn=this._find(zr,!1);if(Tn>=0){for(var ti=this._keys.length,Kr=Tn+1;Kr<ti;Kr++)this._keys[Kr-1]=this._keys[Kr],this._values[Kr-1]=this._values[Kr];return this._keys.length--,this._values.length--,zr===this._cacheKey&&(this._cacheKey=qe,this._cacheIndex=-2),!0}return!1},yr.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=qe,this._cacheIndex=-2},yr.prototype.keys=function(){return new Jt(this._keys,this._values,hn)},yr.prototype.values=function(){return new Jt(this._keys,this._values,$n)},yr.prototype.entries=function(){return new Jt(this._keys,this._values,bn)},yr.prototype["@@iterator"]=function(){return this.entries()},yr.prototype[o]=function(){return this.entries()},yr.prototype._find=function(zr,Tn){return this._cacheKey!==zr&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=zr)),this._cacheIndex<0&&Tn&&(this._cacheIndex=this._keys.length,this._keys.push(zr),this._values.push(void 0)),this._cacheIndex},yr}();function hn(yr,zr){return yr}function $n(yr,zr){return zr}function bn(yr,zr){return[yr,zr]}}function hh(){return function(){function qe(){this._map=new h}return Object.defineProperty(qe.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),qe.prototype.has=function(Ot){return this._map.has(Ot)},qe.prototype.add=function(Ot){return this._map.set(Ot,Ot),this},qe.prototype.delete=function(Ot){return this._map.delete(Ot)},qe.prototype.clear=function(){this._map.clear()},qe.prototype.keys=function(){return this._map.keys()},qe.prototype.values=function(){return this._map.values()},qe.prototype.entries=function(){return this._map.entries()},qe.prototype["@@iterator"]=function(){return this.keys()},qe.prototype[o]=function(){return this.keys()},qe}()}function Tp(){var qe=16,Ot=c.create(),Jt=hn();return function(){function Tn(){this._key=hn()}return Tn.prototype.has=function(ti){var Kr=$n(ti,!1);return Kr!==void 0?c.has(Kr,this._key):!1},Tn.prototype.get=function(ti){var Kr=$n(ti,!1);return Kr!==void 0?c.get(Kr,this._key):void 0},Tn.prototype.set=function(ti,Kr){var Eo=$n(ti,!0);return Eo[this._key]=Kr,this},Tn.prototype.delete=function(ti){var Kr=$n(ti,!1);return Kr!==void 0?delete Kr[this._key]:!1},Tn.prototype.clear=function(){this._key=hn()},Tn}();function hn(){var Tn;do Tn="@@WeakMap@@"+zr();while(c.has(Ot,Tn));return Ot[Tn]=!0,Tn}function $n(Tn,ti){if(!t.call(Tn,Jt)){if(!ti)return;Object.defineProperty(Tn,Jt,{value:c.create()})}return Tn[Jt]}function bn(Tn,ti){for(var Kr=0;Kr<ti;++Kr)Tn[Kr]=Math.random()*255|0;return Tn}function yr(Tn){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(Tn)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(Tn)):bn(new Uint8Array(Tn),Tn):bn(new Array(Tn),Tn)}function zr(){var Tn=yr(qe);Tn[6]=Tn[6]&79|64,Tn[8]=Tn[8]&191|128;for(var ti="",Kr=0;Kr<qe;++Kr){var Eo=Tn[Kr];(Kr===4||Kr===6||Kr===8)&&(ti+="-"),Eo<16&&(ti+="0"),ti+=Eo.toString(16).toLowerCase()}return ti}}function Bu(qe){return qe.__=void 0,delete qe.__,qe}})})(pr||(pr={}));var L;(function(r){r.defineToken=function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{multiple:!0};return new r.DefinedToken(i,o)};var e=function i(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};A(this,i),this.prototype={},this.name=void 0,this.multiple=void 0,this.symbol=void 0;var a=s.multiple,l=a===void 0?!1:a;this.name=o,this.symbol=Symbol(this.name),this.multiple=l};r.DefinedToken=e;function t(i){return!!i&&ht(i)==="object"&&"id"in i&&"registry"in i}r.isModule=t;var n;(function(i){i.singleton="singleton",i.transient="transient"})(n=r.Lifecycle||(r.Lifecycle={})),r.ClassOptionSymbol=Symbol("SyringeClassOptionSymbol"),r.DefaultOption={lifecycle:n.transient}})(L||(L={}));var he;(function(r){function e(a){return a instanceof Array?a:a!==void 0?[a]:[]}r.maybeArrayToArray=e;function t(a){return!!(a&&typeof a=="function"&&"prototype"in a)}r.isClass=t;function n(a){return!!(a&&ht(a)==="object"&&"symbol"in a&&"multiple"in a)}r.isDefinedToken=n;function i(a){return!!(a&&ht(a)==="object"&&"token"in a)}r.isInjectOption=i;function o(a){return!!(a&&ht(a)==="object"&&"token"in a&&"named"in a)}r.isNamedToken=o;function s(a){return r.isDefinedToken(a)&&a.multiple}r.isMultipleEnabled=s})(he||(he={}));function lt(r){return r.inSingletonScope()}function Vt(r){return r.inTransientScope()}function et(r,e){return e.lifecycle===L.Lifecycle.singleton?lt(r):Vt(r)}function wt(r,e){r.whenTargetNamed($t(e))}function Qe(r,e){return e.container.bind(It(r))}function ft(r,e){var t=e.container.parent,n=t&&t.isBound(It(r));return e.container.isBound(It(r))&&!n?e.container.rebind(It(r)):e.container.bind(It(r))}function ut(r){return r&&ht(r)==="object"&&"container"in r&&"inversify"in r}function $t(r){return he.isDefinedToken(r)?r.symbol:r}function It(r){return he.isDefinedToken(r)?r.symbol:r}var on=new R.W2;function at(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=(0,R.b2)();return function(t){Reflect.defineMetadata(L.ClassOptionSymbol,ve(ve({},r),{},{target:t}),t),e(t)}}function Yt(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return at(ve(ve({},r),{},{lifecycle:L.Lifecycle.singleton}))}function Cn(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return at(ve(ve({},r),{},{lifecycle:L.Lifecycle.transient}))}function St(r){return(0,R.f3)(It(r))}function sr(r){return(0,R.t6)($t(r))}var Nn=Symbol("SyringeOptionSymbol"),Vr=function(e,t){Reflect.defineMetadata(Nn,e,t)};function an(r){var e=he.maybeArrayToArray(r.token),t=he.maybeArrayToArray(r.useClass),n=he.maybeArrayToArray(r.useDynamic),i=he.maybeArrayToArray(r.useFactory),o=he.maybeArrayToArray(r.contrib),s=r.lifecycle||L.Lifecycle.transient,a={token:e,useClass:t,lifecycle:o.length>0?L.Lifecycle.singleton:s,contrib:o,useDynamic:n,useFactory:i};return"useValue"in r&&(a.useValue=r.useValue),a}var br=function(){function r(e,t,n){A(this,r),this.token=void 0,this.rawToken=void 0,this.named=void 0,this.generalToken=void 0,this.option=void 0,this.context=void 0,this.mutiple=void 0,this.context=e,this.token=t,this.option=n,this.rawToken=he.isNamedToken(t)?t.token:t,this.named=he.isNamedToken(t)?t.named:void 0,this.mutiple=!!this.named||he.isMultipleEnabled(this.rawToken),this.generalToken=this.rawToken}return Ue(r,[{key:"resolve",value:function(){var t=this,n=this.context;!ut(n)||(this.mutiple?this.resolveMutilple(n):(this.resolveMono(n),!this.named&&this.option.contrib.length>0&&this.option.contrib.forEach(function(i){he.isMultipleEnabled(i)?Qe(i,n).toService(t.generalToken):ft(i,n).toService(t.generalToken)})))}},{key:"resolveMono",value:function(t){var n=this;if("useValue"in this.option)return ft(this.generalToken,t).toConstantValue(this.option.useValue);if(this.option.useDynamic.length>0){var i=this.option.useDynamic[this.option.useDynamic.length-1];return et(ft(this.generalToken,t).toDynamicValue(function(){return i({container:n.context})}),this.option)}if(this.option.useFactory.length>0){var o=this.option.useFactory[this.option.useFactory.length-1];return ft(this.generalToken,t).toFactory(function(){return o({container:n.context})})}if(this.option.useClass.length>0){var s=this.option.useClass[this.option.useClass.length-1];return et(ft(this.generalToken,t).to(s),this.option)}}},{key:"resolveMutilple",value:function(t){var n=this,i=this.option.useClass.map(function(l){return et(Qe(n.generalToken,t).to(l),n.option)}),o=this.option.useDynamic.map(function(l){return et(Qe(n.generalToken,t).toDynamicValue(function(){return l({container:n.context})}),n.option)}),s=this.option.useFactory.map(function(l){return Qe(n.generalToken,t).toFactory(function(){return l({container:n.context})})}),a="useValue"in this.option?Qe(this.generalToken,t).toConstantValue(this.option.useValue):void 0;this.named&&(i.forEach(function(l){return n.named&&wt(l,n.named)}),o.forEach(function(l){return n.named&&wt(l,n.named)}),s.forEach(function(l){return n.named&&wt(l,n.named)}),a&&wt(a,this.named))}}],[{key:"resolveTarget",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};try{try{var o=Reflect.getMetadata(Nn,n);o&&r.resolveOption(t,o)}catch(c){}if(he.isClass(n))if(!i.useClass)i.useClass=[n];else{var s=he.maybeArrayToArray(i.useClass);s.unshift(n),i.useClass=s}var a;try{a=Reflect.getMetadata(L.ClassOptionSymbol,n)}catch(c){}if(a=ve(ve({},a||{}),i),!a.token)a.token=[n];else{var l=he.maybeArrayToArray(a.token);l.unshift(n),a.token=l}r.resolveOption(t,a)}catch(c){}}},{key:"resolveOption",value:function(t,n){var i=an(ve(ve({},r.globalConfig),n));i.useClass.length===0&&i.useDynamic.length===0&&i.useFactory.length===0&&!("useValue"in i)||i.token.forEach(function(o){var s=new r(t,o,ve({},i));s.resolve()})}}]),r}();br.globalConfig=L.DefaultOption;var po=function(){function r(e){A(this,r),this.loadedModules=[],this.container=void 0,this.inversify=!0,this.parent=void 0,e?this.container=e:this.container=new R.W2}return Ue(r,[{key:"load",value:function(t,n){(n||!this.loadedModules.includes(t.id))&&(t.registry(this.register.bind(this),this.resolveContext()),this.loadedModules.push(t.id))}},{key:"remove",value:function(t){return this.container.unbind(It(t))}},{key:"get",value:function(t){return this.container.get(It(t))}},{key:"getNamed",value:function(t,n){return this.container.getNamed(It(t),$t(n))}},{key:"getAll",value:function(t){return this.container.getAll(It(t))}},{key:"getAllNamed",value:function(t,n){return this.container.getAllNamed(It(t),$t(n))}},{key:"isBound",value:function(t){return this.container.isBound(It(t))}},{key:"isBoundNamed",value:function(t,n){return this.container.isBoundNamed(It(t),$t(n))}},{key:"createChild",value:function(){var t=this.container.createChild(),n=new r(t);return n.parent=this,n}},{key:"register",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};he.isInjectOption(t)?br.resolveOption(this,t):br.resolveTarget(this,t,n)}},{key:"resolveContext",value:function(){return{container:this}}}],[{key:"config",value:function(t){br.globalConfig=t}}]),r}(),J=new po(on),pi=J.register.bind(J),vi=L.defineToken("ContributionProvider"),Ci=function(){function r(e,t,n){A(this,r),this.option={recursive:!1,cache:!0},this.services=void 0,this.serviceIdentifier=void 0,this.container=void 0,this.container=t,this.serviceIdentifier=e,n&&(this.option=ve(ve({},this.option),n))}return Ue(r,[{key:"setServices",value:function(t){for(var n=[],i=this.container;i;){if(i.isBound(this.serviceIdentifier)){var o=i.getAll(this.serviceIdentifier);n.push.apply(n,Xt(o))}i=t?i.parent:void 0}return n}},{key:"getContributions",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=ve(ve({},this.option),t),i=n.cache,o=n.recursive;return(!i||this.services===void 0)&&(this.services=this.setServices(!!o)),this.services}}]),r}();function _r(r,e){return{token:{token:vi,named:r},useDynamic:function(n){return new Ci(r,n.container,e)},lifecycle:L.Lifecycle.singleton}}function Ir(r,e,t){r({token:{token:vi,named:e},useDynamic:function(i){return new Ci(e,i.container,t)},lifecycle:L.Lifecycle.singleton})}var ai=function(){function r(e){A(this,r),this.id=void 0,this.baseRegistry=void 0,this.optionCollection=void 0,r.moduleId+=1,this.id=r.moduleId,this.baseRegistry=e}return Ue(r,[{key:"registry",get:function(){var t=this;return function(n,i){t.baseRegistry&&t.baseRegistry(n,i),t.optionCollection&&t.optionCollection.forEach(function(o){return n(o)})}}},{key:"options",get:function(){return this.optionCollection||(this.optionCollection=[]),this.optionCollection}},{key:"register",value:function(){for(var t=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return i.forEach(function(s){return t.options.push(s)}),this}},{key:"contribution",value:function(){for(var t=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return i.forEach(function(s){return t.options.push(_r(s))}),this}}]),r}();ai.moduleId=0;function Nr(r){return new ai(r)}var wr=function(e){return function(t,n,i){sr(e)(t,n,i),St(vi)(t,n,i)}},Mi;(function(r){r.Provider=vi,r.register=Ir})(Mi||(Mi={}));var zi;(function(r){let e;(function(n){n.TOP="top",n.BOTTOM="bottom",n.RIGHT="right",n.LEFT="left"})(e=r.AnchorGroup||(r.AnchorGroup={}));let t;(function(n){n.INPUT="input",n.OUTPUT="output"})(t=r.AnchorType||(r.AnchorType={}))})(zi||(zi={}));var S=w(70655),wi=w(94184),Cr=w.n(wi),sa=w(28660),Nc=w(19755),jr=w.n(Nc),zo=w(50450);let Di=!1,Ws=!1,aa=!1,Ka=!1,Fl=!1,io=!1,Ui=!1,gh=!1,mh=!1,Rc=!1,Bl=!1,vh=!1,yh=!1,bh=!1,$u=!1,Wu=!1;if(typeof navigator=="object"){const r=navigator.userAgent;Di=r.indexOf("Macintosh")>=0,Ws=!!r.match(/(iPad|iPhone|iPod)/g),aa=r.indexOf("Windows")>=0,Ka=r.indexOf("MSIE")>=0,Fl=!!r.match(/Trident\/7\./),io=!!r.match(/Edge\//),Ui=r.indexOf("Mozilla/")>=0&&r.indexOf("MSIE")<0&&r.indexOf("Edge/")<0,mh=r.indexOf("Chrome/")>=0&&r.indexOf("Edge/")<0,Rc=r.indexOf("Opera/")>=0||r.indexOf("OPR/")>=0,Bl=r.indexOf("Firefox/")>=0,vh=r.indexOf("AppleWebKit/")>=0&&r.indexOf("Chrome/")<0&&r.indexOf("Edge/")<0,typeof document=="object"&&(Wu=!document.createElementNS||`${document.createElementNS("http://www.w3.org/2000/svg","foreignObject")}`!="[object SVGForeignObjectElement]"||r.indexOf("Opera/")>=0)}if(typeof window=="object"&&(gh=window.chrome!=null&&window.chrome.app!=null&&window.chrome.app.runtime!=null,bh=window.PointerEvent!=null&&!Di),typeof document=="object"){yh="ontouchstart"in document.documentElement;try{const r=Object.defineProperty({},"passive",{get(){$u=!0}}),e=document.createElement("div");e.addEventListener&&e.addEventListener("click",()=>{},r)}catch(r){}}var _i;if(function(r){r.IS_MAC=Di,r.IS_IOS=Ws,r.IS_WINDOWS=aa,r.IS_IE=Ka,r.IS_IE11=Fl,r.IS_EDGE=io,r.IS_NETSCAPE=Ui,r.IS_CHROME_APP=gh,r.IS_CHROME=mh,r.IS_OPERA=Rc,r.IS_FIREFOX=Bl,r.IS_SAFARI=vh,r.SUPPORT_TOUCH=yh,r.SUPPORT_POINTER=bh,r.SUPPORT_PASSIVE=$u,r.NO_FOREIGNOBJECT=Wu,r.SUPPORT_FOREIGNOBJECT=!r.NO_FOREIGNOBJECT}(_i||(_i={})),function(r){function e(){const o=window.module;return o!=null&&o.hot!=null&&o.hot.status!=null?o.hot.status():"unkonwn"}r.getHMRStatus=e;function t(){return e()==="apply"}r.isApplyingHMR=t;const n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};function i(o){const s=document.createElement(n[o]||"div"),a=`on${o}`;let l=a in s;return l||(s.setAttribute(a,"return;"),l=typeof s[a]=="function"),l}r.isEventSupported=i}(_i||(_i={})),_i.SUPPORT_PASSIVE){jr().event.special.touchstart={setup(e,t,n){if(!this.addEventListener)return!1;this.addEventListener("touchstart",n,{passive:!0})}};const r=jr().event.special.mousewheel;if(r){const e=r.setup;r.setup=function(){const t=this.addEventListener;if(!t)return!1;this.addEventListener=(n,i)=>{t.call(this,n,i,{passive:!0})},e.call(this),this.addEventListener=t}}}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),function(r){r.forEach(e=>{Object.prototype.hasOwnProperty.call(e,"append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value(...t){const n=document.createDocumentFragment();t.forEach(i=>{const o=i instanceof Node;n.appendChild(o?i:document.createTextNode(String(i)))}),this.appendChild(n)}})})}([Element.prototype,Document.prototype,DocumentFragment.prototype]);var Lr=w(39350),xh=w(25069),qa=9007199254740991;function Ch(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=qa}var zl=Ch;function Zu(r){return r!=null&&zl(r.length)&&!(0,xh.Z)(r)}var Ds=Zu,Xu=w(22990),Np="__lodash_hash_undefined__";function wh(r){return this.__data__.set(r,Np),this}var Rp=wh;function Ul(r){return this.__data__.has(r)}var Eh=Ul;function Vl(r){var e=-1,t=r==null?0:r.length;for(this.__data__=new Xu.Z;++e<t;)this.add(r[e])}Vl.prototype.add=Vl.prototype.push=Rp,Vl.prototype.has=Eh;var kc=Vl;function Sh(r,e,t,n){for(var i=r.length,o=t+(n?1:-1);n?o--:++o<i;)if(e(r[o],o,r))return o;return-1}var kp=Sh;function Yu(r){return r!==r}var Ip=Yu;function Lp(r,e,t){for(var n=t-1,i=r.length;++n<i;)if(r[n]===e)return n;return-1}var _h=Lp;function Ah(r,e,t){return e===e?_h(r,e,t):kp(r,Ip,t)}var Ku=Ah;function Th(r,e){var t=r==null?0:r.length;return!!t&&Ku(r,e,0)>-1}var Mo=Th;function Ja(r,e,t){for(var n=-1,i=r==null?0:r.length;++n<i;)if(t(e,r[n]))return!0;return!1}var jl=Ja;function Gp(r,e){return r.has(e)}var Qa=Gp,la=w(20570),ms=w(56169),Ic=(0,la.Z)(ms.Z,"Set"),vs=Ic;function qu(){}var Mh=qu;function qo(r){var e=-1,t=Array(r.size);return r.forEach(function(n){t[++e]=n}),t}var Lc=qo,Hl=1/0,Fp=vs&&1/Lc(new vs([,-0]))[1]==Hl?function(r){return new vs(r)}:Mh,Bp=Fp,go=200;function $i(r,e,t){var n=-1,i=Mo,o=r.length,s=!0,a=[],l=a;if(t)s=!1,i=jl;else if(o>=go){var c=e?null:Bp(r);if(c)return Lc(c);s=!1,i=Qa,l=new kc}else l=e?[]:a;e:for(;++n<o;){var u=r[n],d=e?e(u):u;if(u=t||u!==0?u:0,s&&d===d){for(var h=l.length;h--;)if(l[h]===d)continue e;e&&l.push(d),a.push(u)}else i(l,d,t)||(l!==a&&l.push(d),a.push(u))}return a}var Ma=$i;function zp(r){return r&&r.length?Ma(r):[]}var Ju=zp;function Qu(r,e){for(var t=-1,n=e.length,i=r.length;++t<n;)r[i+t]=e[t];return r}var ca=Qu,Pa=w(5876),ys=w(26818),Po=w(23195),Ph="[object Arguments]";function Up(r){return(0,Po.Z)(r)&&(0,ys.Z)(r)==Ph}var Oh=Up,Gc=Object.prototype,Vp=Gc.hasOwnProperty,jp=Gc.propertyIsEnumerable,Hp=Oh(function(){return arguments}())?Oh:function(r){return(0,Po.Z)(r)&&Vp.call(r,"callee")&&!jp.call(r,"callee")},el=Hp,ua=Pa.Z?Pa.Z.isConcatSpreadable:void 0;function $p(r){return(0,Lr.Z)(r)||el(r)||!!(ua&&r&&r[ua])}var Wp=$p;function tl(r,e,t,n,i){var o=-1,s=r.length;for(t||(t=Wp),i||(i=[]);++o<s;){var a=r[o];e>0&&t(a)?e>1?tl(a,e-1,t,n,i):ca(i,a):n||(i[i.length]=a)}return i}var da=tl;function ed(r){return r}var Ns=ed;function Dh(r,e,t){switch(t.length){case 0:return r.call(e);case 1:return r.call(e,t[0]);case 2:return r.call(e,t[0],t[1]);case 3:return r.call(e,t[0],t[1],t[2])}return r.apply(e,t)}var nl=Dh,rl=Math.max;function ha(r,e,t){return e=rl(e===void 0?r.length-1:e,0),function(){for(var n=arguments,i=-1,o=rl(n.length-e,0),s=Array(o);++i<o;)s[i]=n[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=n[i];return a[e]=t(s),nl(r,this,a)}}var $l=ha;function Nh(r){return function(){return r}}var il=Nh,Rh=function(){try{var r=(0,la.Z)(Object,"defineProperty");return r({},"",{}),r}catch(e){}}(),ol=Rh,Zp=ol?function(r,e){return ol(r,"toString",{configurable:!0,enumerable:!1,value:il(e),writable:!0})}:Ns,Xp=Zp,Yp=800,m=16,C=Date.now;function _(r){var e=0,t=0;return function(){var n=C(),i=m-(n-t);if(t=n,i>0){if(++e>=Yp)return arguments[0]}else e=0;return r.apply(void 0,arguments)}}var M=_,I=M(Xp),G=I;function H(r,e){return G($l(r,e,Ns),r+"")}var Ee=H;function xe(r){return(0,Po.Z)(r)&&Ds(r)}var Ve=xe,nt=Ee(function(r){return Ma(da(r,1,Ve,!0))}),Ft=nt,Ze=w(97828),pt=4294967295,Rn=pt-1,ur=Math.floor,Mn=Math.min;function Wi(r,e,t,n){var i=0,o=r==null?0:r.length;if(o===0)return 0;e=t(e);for(var s=e!==e,a=e===null,l=(0,Ze.Z)(e),c=e===void 0;i<o;){var u=ur((i+o)/2),d=t(r[u]),h=d!==void 0,f=d===null,p=d===d,g=(0,Ze.Z)(d);if(s)var v=n||p;else c?v=p&&(n||h):a?v=p&&h&&(n||!f):l?v=p&&h&&!f&&(n||!g):f||g?v=!1:v=n?d<=e:d<e;v?i=u+1:o=u}return Mn(o,Rn)}var Ni=Wi,Uo=4294967295,Jn=Uo>>>1;function nr(r,e,t){var n=0,i=r==null?n:r.length;if(typeof e=="number"&&e===e&&i<=Jn){for(;n<i;){var o=n+i>>>1,s=r[o];s!==null&&!(0,Ze.Z)(s)&&(t?s<=e:s<e)?n=o+1:i=o}return i}return Ni(r,e,Ns,t)}var Vo=nr;function gr(r,e){return Vo(r,e)}var yi=gr,Rs=w(74941);function ks(){this.__data__=new Rs.Z,this.size=0}var Oo=ks;function Is(r){var e=this.__data__,t=e.delete(r);return this.size=e.size,t}var bs=Is;function mo(r){return this.__data__.get(r)}var Zs=mo;function jo(r){return this.__data__.has(r)}var Xs=jo,Wl=w(96686),Oa=200;function td(r,e){var t=this.__data__;if(t instanceof Rs.Z){var n=t.__data__;if(!Wl.Z||n.length<Oa-1)return n.push([r,e]),this.size=++t.size,this;t=this.__data__=new Xu.Z(n)}return t.set(r,e),this.size=t.size,this}var Jr=td;function Ho(r){var e=this.__data__=new Rs.Z(r);this.size=e.size}Ho.prototype.clear=Oo,Ho.prototype.delete=bs,Ho.prototype.get=Zs,Ho.prototype.has=Xs,Ho.prototype.set=Jr;var Ls=Ho;function Zl(r,e){for(var t=-1,n=r==null?0:r.length;++t<n;)if(e(r[t],t,r))return!0;return!1}var nd=Zl,Ys=1,rd=2;function Fc(r,e,t,n,i,o){var s=t&Ys,a=r.length,l=e.length;if(a!=l&&!(s&&l>a))return!1;var c=o.get(r),u=o.get(e);if(c&&u)return c==e&&u==r;var d=-1,h=!0,f=t&rd?new kc:void 0;for(o.set(r,e),o.set(e,r);++d<a;){var p=r[d],g=e[d];if(n)var v=s?n(g,p,d,e,r,o):n(p,g,d,r,e,o);if(v!==void 0){if(v)continue;h=!1;break}if(f){if(!nd(e,function(y,x){if(!Qa(f,x)&&(p===y||i(p,y,t,n,o)))return f.push(x)})){h=!1;break}}else if(!(p===g||i(p,g,t,n,o))){h=!1;break}}return o.delete(r),o.delete(e),h}var Bc=Fc,id=ms.Z.Uint8Array,Xl=id,Gs=w(52373);function kh(r){var e=-1,t=Array(r.size);return r.forEach(function(n,i){t[++e]=[i,n]}),t}var Ih=kh,Lh=1,sl=2,Gh="[object Boolean]",zc="[object Date]",$o="[object Error]",xs="[object Map]",Uc="[object Number]",al="[object RegExp]",Fh="[object Set]",Kp="[object String]",di="[object Symbol]",ll="[object ArrayBuffer]",Cs="[object DataView]",Jo=Pa.Z?Pa.Z.prototype:void 0,Yl=Jo?Jo.valueOf:void 0;function Vc(r,e,t,n,i,o,s){switch(t){case Cs:if(r.byteLength!=e.byteLength||r.byteOffset!=e.byteOffset)return!1;r=r.buffer,e=e.buffer;case ll:return!(r.byteLength!=e.byteLength||!o(new Xl(r),new Xl(e)));case Gh:case zc:case Uc:return(0,Gs.Z)(+r,+e);case $o:return r.name==e.name&&r.message==e.message;case al:case Kp:return r==e+"";case xs:var a=Ih;case Fh:var l=n&Lh;if(a||(a=Lc),r.size!=e.size&&!l)return!1;var c=s.get(r);if(c)return c==e;n|=sl,s.set(r,e);var u=Bc(a(r),a(e),n,i,o,s);return s.delete(r),u;case di:if(Yl)return Yl.call(r)==Yl.call(e)}return!1}var qp=Vc;function od(r,e,t){var n=e(r);return(0,Lr.Z)(r)?n:ca(n,t(r))}var jc=od;function fa(r,e){for(var t=-1,n=r==null?0:r.length,i=0,o=[];++t<n;){var s=r[t];e(s,t,r)&&(o[i++]=s)}return o}var Kl=fa;function Bh(){return[]}var pa=Bh,Hc=Object.prototype,sd=Hc.propertyIsEnumerable,zh=Object.getOwnPropertySymbols,$c=zh?function(r){return r==null?[]:(r=Object(r),Kl(zh(r),function(e){return sd.call(r,e)}))}:pa,ql=$c;function ad(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}var Jp=ad;function Q(){return!1}var we=Q,ke=typeof exports=="object"&&exports&&!exports.nodeType&&exports,mt=ke&&typeof module=="object"&&module&&!module.nodeType&&module,Be=mt&&mt.exports===ke,xt=Be?ms.Z.Buffer:void 0,zt=xt?xt.isBuffer:void 0,nn=zt||we,sn=nn,Wn=9007199254740991,Un=/^(?:0|[1-9]\d*)$/;function Xn(r,e){var t=typeof r;return e=e==null?Wn:e,!!e&&(t=="number"||t!="symbol"&&Un.test(r))&&r>-1&&r%1==0&&r<e}var xr=Xn,Zr="[object Arguments]",vn="[object Array]",Vi="[object Boolean]",vo="[object Date]",Zi="[object Error]",bi="[object Function]",cl="[object Map]",Jl="[object Number]",Qo="[object Object]",px="[object RegExp]",gx="[object Set]",Qp="[object String]",km="[object WeakMap]",mx="[object ArrayBuffer]",Im="[object DataView]",Lm="[object Float32Array]",vx="[object Float64Array]",Uh="[object Int8Array]",yx="[object Int16Array]",ul="[object Int32Array]",Vh="[object Uint8Array]",Gm="[object Uint8ClampedArray]",Fm="[object Uint16Array]",Bm="[object Uint32Array]",Ei={};Ei[Lm]=Ei[vx]=Ei[Uh]=Ei[yx]=Ei[ul]=Ei[Vh]=Ei[Gm]=Ei[Fm]=Ei[Bm]=!0,Ei[Zr]=Ei[vn]=Ei[mx]=Ei[Vi]=Ei[Im]=Ei[vo]=Ei[Zi]=Ei[bi]=Ei[cl]=Ei[Jl]=Ei[Qo]=Ei[px]=Ei[gx]=Ei[Qp]=Ei[km]=!1;function zm(r){return(0,Po.Z)(r)&&zl(r.length)&&!!Ei[(0,ys.Z)(r)]}var Um=zm;function Vm(r){return function(e){return r(e)}}var Ql=Vm,jm=w(48277),Fs=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Wc=Fs&&typeof module=="object"&&module&&!module.nodeType&&module,bx=Wc&&Wc.exports===Fs,Ks=bx&&jm.Z.process,eg=function(){try{var r=Wc&&Wc.require&&Wc.require("util").types;return r||Ks&&Ks.binding&&Ks.binding("util")}catch(e){}}(),as=eg,ld=as&&as.isTypedArray,Hm=ld?Ql(ld):Um,cd=Hm,$m=Object.prototype,Wm=$m.hasOwnProperty;function Zm(r,e){var t=(0,Lr.Z)(r),n=!t&&el(r),i=!t&&!n&&sn(r),o=!t&&!n&&!i&&cd(r),s=t||n||i||o,a=s?Jp(r.length,String):[],l=a.length;for(var c in r)(e||Wm.call(r,c))&&!(s&&(c=="length"||i&&(c=="offset"||c=="parent")||o&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||xr(c,l)))&&a.push(c);return a}var Xm=Zm,xx=Object.prototype;function Cx(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||xx;return r===t}var jh=Cx;function wx(r,e){return function(t){return r(e(t))}}var Ym=wx,Ex=Ym(Object.keys,Object),Km=Ex,qm=Object.prototype,Sx=qm.hasOwnProperty;function _x(r){if(!jh(r))return Km(r);var e=[];for(var t in Object(r))Sx.call(r,t)&&t!="constructor"&&e.push(t);return e}var Hh=_x;function $h(r){return Ds(r)?Xm(r):Hh(r)}var Zc=$h;function Ax(r){return jc(r,Zc,ql)}var tg=Ax,Tx=1,Mx=Object.prototype,Jm=Mx.hasOwnProperty;function Px(r,e,t,n,i,o){var s=t&Tx,a=tg(r),l=a.length,c=tg(e),u=c.length;if(l!=u&&!s)return!1;for(var d=l;d--;){var h=a[d];if(!(s?h in e:Jm.call(e,h)))return!1}var f=o.get(r),p=o.get(e);if(f&&p)return f==e&&p==r;var g=!0;o.set(r,e),o.set(e,r);for(var v=s;++d<l;){h=a[d];var y=r[h],x=e[h];if(n)var E=s?n(x,y,h,e,r,o):n(y,x,h,r,e,o);if(!(E===void 0?y===x||i(y,x,t,n,o):E)){g=!1;break}v||(v=h=="constructor")}if(g&&!v){var T=r.constructor,P=e.constructor;T!=P&&"constructor"in r&&"constructor"in e&&!(typeof T=="function"&&T instanceof T&&typeof P=="function"&&P instanceof P)&&(g=!1)}return o.delete(r),o.delete(e),g}var Ox=Px,Dx=(0,la.Z)(ms.Z,"DataView"),ng=Dx,Nx=(0,la.Z)(ms.Z,"Promise"),dl=Nx,Rx=(0,la.Z)(ms.Z,"WeakMap"),rg=Rx,ec=w(48723),Wh="[object Map]",kx="[object Object]",ig="[object Promise]",Qm="[object Set]",ev="[object WeakMap]",tv="[object DataView]",Ix=(0,ec.Z)(ng),Lx=(0,ec.Z)(Wl.Z),ud=(0,ec.Z)(dl),Gx=(0,ec.Z)(vs),Zh=(0,ec.Z)(rg),tc=ys.Z;(ng&&tc(new ng(new ArrayBuffer(1)))!=tv||Wl.Z&&tc(new Wl.Z)!=Wh||dl&&tc(dl.resolve())!=ig||vs&&tc(new vs)!=Qm||rg&&tc(new rg)!=ev)&&(tc=function(r){var e=(0,ys.Z)(r),t=e==kx?r.constructor:void 0,n=t?(0,ec.Z)(t):"";if(n)switch(n){case Ix:return tv;case Lx:return Wh;case ud:return ig;case Gx:return Qm;case Zh:return ev}return e});var qs=tc,Xc=1,nv="[object Arguments]",nc="[object Array]",dd="[object Object]",Yc=Object.prototype,Xh=Yc.hasOwnProperty;function og(r,e,t,n,i,o){var s=(0,Lr.Z)(r),a=(0,Lr.Z)(e),l=s?nc:qs(r),c=a?nc:qs(e);l=l==nv?dd:l,c=c==nv?dd:c;var u=l==dd,d=c==dd,h=l==c;if(h&&sn(r)){if(!sn(e))return!1;s=!0,u=!1}if(h&&!u)return o||(o=new Ls),s||cd(r)?Bc(r,e,t,n,i,o):qp(r,e,l,t,n,i,o);if(!(t&Xc)){var f=u&&Xh.call(r,"__wrapped__"),p=d&&Xh.call(e,"__wrapped__");if(f||p){var g=f?r.value():r,v=p?e.value():e;return o||(o=new Ls),i(g,v,t,n,o)}}return h?(o||(o=new Ls),Ox(r,e,t,n,i,o)):!1}var sg=og;function Yh(r,e,t,n,i){return r===e?!0:r==null||e==null||!(0,Po.Z)(r)&&!(0,Po.Z)(e)?r!==r&&e!==e:sg(r,e,t,n,Yh,i)}var hd=Yh,Kh=1,rv=2;function iv(r,e,t,n){var i=t.length,o=i,s=!n;if(r==null)return!o;for(r=Object(r);i--;){var a=t[i];if(s&&a[2]?a[1]!==r[a[0]]:!(a[0]in r))return!1}for(;++i<o;){a=t[i];var l=a[0],c=r[l],u=a[1];if(s&&a[2]){if(c===void 0&&!(l in r))return!1}else{var d=new Ls;if(n)var h=n(c,u,l,r,e,d);if(!(h===void 0?hd(u,c,Kh|rv,n,d):h))return!1}}return!0}var ov=iv,yo=w(89122);function sv(r){return r===r&&!(0,yo.Z)(r)}var qh=sv;function ag(r){for(var e=Zc(r),t=e.length;t--;){var n=e[t],i=r[n];e[t]=[n,i,qh(i)]}return e}var av=ag;function lv(r,e){return function(t){return t==null?!1:t[r]===e&&(e!==void 0||r in Object(t))}}var lg=lv;function cv(r){var e=av(r);return e.length==1&&e[0][2]?lg(e[0][0],e[0][1]):function(t){return t===r||ov(t,r,e)}}var cg=cv,uv=w(77398);function dv(r,e){return r!=null&&e in Object(r)}var ug=dv,fd=w(11855),pd=w(35429);function dg(r,e,t){e=(0,fd.Z)(e,r);for(var n=-1,i=e.length,o=!1;++n<i;){var s=(0,pd.Z)(e[n]);if(!(o=r!=null&&t(r,s)))break;r=r[s]}return o||++n!=i?o:(i=r==null?0:r.length,!!i&&zl(i)&&xr(s,i)&&((0,Lr.Z)(r)||el(r)))}var hg=dg;function hv(r,e){return r!=null&&hg(r,e,ug)}var Jh=hv,fg=w(8633),fv=1,pg=2;function gg(r,e){return(0,fg.Z)(r)&&qh(e)?lg((0,pd.Z)(r),e):function(t){var n=(0,uv.Z)(t,r);return n===void 0&&n===e?Jh(t,r):hd(e,n,fv|pg)}}var gd=gg;function pv(r){return function(e){return e==null?void 0:e[r]}}var md=pv,Js=w(23791);function vd(r){return function(e){return(0,Js.Z)(e,r)}}var rc=vd;function yd(r){return(0,fg.Z)(r)?md((0,pd.Z)(r)):rc(r)}var bd=yd;function ic(r){return typeof r=="function"?r:r==null?Ns:typeof r=="object"?(0,Lr.Z)(r)?gd(r[0],r[1]):cg(r):bd(r)}var Da=ic;function oc(r,e,t){return Ni(r,e,Da(t,2))}var Qh=oc,hl=w(86192);function xd(r){return function(e,t,n){for(var i=-1,o=Object(e),s=n(e),a=s.length;a--;){var l=s[r?a:++i];if(t(o[l],l,o)===!1)break}return e}}var mg=xd,vg=mg(),fl=vg;function Kc(r,e){return r&&fl(r,e,Zc)}var Fx=Kc;function Bx(r,e){return function(t,n){if(t==null)return t;if(!Ds(t))return r(t,n);for(var i=t.length,o=e?i:-1,s=Object(t);(e?o--:++o<i)&&n(s[o],o,s)!==!1;);return t}}var gv=Bx,mv=gv(Fx),yg=mv;function zx(r,e){var t=-1,n=Ds(r)?Array(r.length):[];return yg(r,function(i,o,s){n[++t]=e(i,o,s)}),n}var qc=zx;function Ux(r,e){var t=r.length;for(r.sort(e);t--;)r[t]=r[t].value;return r}var Vx=Ux;function jx(r,e){if(r!==e){var t=r!==void 0,n=r===null,i=r===r,o=(0,Ze.Z)(r),s=e!==void 0,a=e===null,l=e===e,c=(0,Ze.Z)(e);if(!a&&!c&&!o&&r>e||o&&s&&l&&!a&&!c||n&&s&&l||!t&&l||!i)return 1;if(!n&&!o&&!c&&r<e||c&&t&&i&&!n&&!o||a&&t&&i||!s&&i||!l)return-1}return 0}var vv=jx;function Hx(r,e,t){for(var n=-1,i=r.criteria,o=e.criteria,s=i.length,a=t.length;++n<s;){var l=vv(i[n],o[n]);if(l){if(n>=a)return l;var c=t[n];return l*(c=="desc"?-1:1)}}return r.index-e.index}var $x=Hx;function Wx(r,e,t){e.length?e=(0,hl.Z)(e,function(o){return(0,Lr.Z)(o)?function(s){return(0,Js.Z)(s,o.length===1?o[0]:o)}:o}):e=[Ns];var n=-1;e=(0,hl.Z)(e,Ql(Da));var i=qc(r,function(o,s,a){var l=(0,hl.Z)(e,function(c){return c(o)});return{criteria:l,index:++n,value:o}});return Vx(i,function(o,s){return $x(o,s,t)})}var Zx=Wx;function Xx(r,e,t){if(!(0,yo.Z)(t))return!1;var n=typeof e;return(n=="number"?Ds(t)&&xr(e,t.length):n=="string"&&e in t)?(0,Gs.Z)(t[e],r):!1}var sc=Xx,Yx=Ee(function(r,e){if(r==null)return[];var t=e.length;return t>1&&sc(r,e[0],e[1])?e=[]:t>2&&sc(e[0],e[1],e[2])&&(e=[e[0]]),Zx(r,da(e,1),[])}),bg=Yx;function Kx(r,e,t){e=="__proto__"&&ol?ol(r,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[e]=t}var ef=Kx;function xg(r,e,t,n){for(var i=-1,o=r==null?0:r.length;++i<o;){var s=r[i];e(n,s,t(s),r)}return n}var tf=xg;function nf(r,e,t,n){return yg(r,function(i,o,s){e(n,i,t(i),s)}),n}var rf=nf;function Cg(r,e){return function(t,n){var i=(0,Lr.Z)(t)?tf:rf,o=e?e():{};return i(t,r,Da(n,2),o)}}var of=Cg,sf=Object.prototype,af=sf.hasOwnProperty,wg=of(function(r,e,t){af.call(r,t)?r[t].push(e):ef(r,t,[e])}),Cd=wg,lf=200;function cf(r,e,t,n){var i=-1,o=Mo,s=!0,a=r.length,l=[],c=e.length;if(!a)return l;t&&(e=(0,hl.Z)(e,Ql(t))),n?(o=jl,s=!1):e.length>=lf&&(o=Qa,s=!1,e=new kc(e));e:for(;++i<a;){var u=r[i],d=t==null?u:t(u);if(u=n||u!==0?u:0,s&&d===d){for(var h=c;h--;)if(e[h]===d)continue e;l.push(u)}else o(e,d,n)||l.push(u)}return l}var wd=cf,Ed=Ee(function(r,e){return Ve(r)?wd(r,da(e,1,Ve,!0)):[]}),Sd=Ed;function _d(r,e,t){for(var n=-1,i=r.length;++n<i;){var o=r[n],s=e(o);if(s!=null&&(a===void 0?s===s&&!(0,Ze.Z)(s):t(s,a)))var a=s,l=o}return l}var Ad=_d;function yv(r,e){return r>e}var Td=yv;function ac(r){return r&&r.length?Ad(r,Ns,Td):void 0}var bv=ac;function xv(r,e,t){const n=Cv(r,t),i=Cv(e,t),o=i.free,s=n.keyIndex,a=i.keyIndex,l=[],c=[];let u=0,d,h,f=0;for(;u<r.length;){if(d=r[u],h=d[t],h)if(!a.hasOwnProperty(h))c.push(null);else{const T=a[h];c.push(e[T])}else{f+=1;const T=o[f];c.push(T||null)}u+=1}const p=c.slice(0);for(u=0;u<p.length;)p[u]===null?(y(u),E(u)):u+=1;let g=u=0;for(;u<e.length;){d=e[u],h=d[t];const T=p[g];if(T){const P=T[t];if(h===P)g+=1;else if(!s.hasOwnProperty(h))x(u,d);else{const z=p[g+1];z&&(z[t]===h?(y(u),E(g),g+=1):x(u,d))}}else x(u,d);u+=1}let v=p.length-g;for(;(g+=1)<p.length;)v-=1,y(v+u);function y(T){const P={index:T,type:0,item:null};l.push(P)}function x(T,P){const z={index:T,item:P,type:1};l.push(z)}function E(T){p.splice(T,1)}return{moves:l}}function Cv(r,e){const t={},n=[];for(let i=0,o=r.length;i<o;i+=1){const s=r[i],a=s[e];a?t[a]=i:n.push(s)}return{keyIndex:t,free:n}}var qx=Object.prototype,Jx=qx.hasOwnProperty;function pl(r,e){return r!=null&&Jx.call(r,e)}var wv=pl;function Ev(r,e){return r!=null&&hg(r,e,wv)}var Jc=Ev,Qx=Object.prototype,Sv=Qx.hasOwnProperty;function eC(r,e,t){var n=r[e];(!(Sv.call(r,e)&&(0,Gs.Z)(n,t))||t===void 0&&!(e in r))&&ef(r,e,t)}var Bs=eC;function _v(r,e,t,n){if(!(0,yo.Z)(r))return r;e=(0,fd.Z)(e,r);for(var i=-1,o=e.length,s=o-1,a=r;a!=null&&++i<o;){var l=(0,pd.Z)(e[i]),c=t;if(l==="__proto__"||l==="constructor"||l==="prototype")return r;if(i!=s){var u=a[l];c=n?n(u,l,a):void 0,c===void 0&&(c=(0,yo.Z)(u)?u:xr(e[i+1])?[]:{})}Bs(a,l,c),a=a[l]}return r}var Qc=_v;function gl(r,e,t){for(var n=-1,i=e.length,o={};++n<i;){var s=e[n],a=(0,Js.Z)(r,s);t(a,s)&&Qc(o,(0,fd.Z)(s,r),a)}return o}var Av=gl;function Eg(r,e){return Av(r,e,function(t,n){return Jh(r,n)})}var uf=Eg;function Tv(r){var e=r==null?0:r.length;return e?da(r,1):[]}var es=Tv;function ml(r){return G($l(r,void 0,es),r+"")}var ji=ml,ls=ji(function(r,e){return r==null?{}:uf(r,e)}),Sg=ls;function tC(r){return typeof r=="function"?r:Ns}var nC=tC;function rC(r){var e=[];if(r!=null)for(var t in Object(r))e.push(t);return e}var iC=rC,Mv=Object.prototype,oC=Mv.hasOwnProperty;function sC(r){if(!(0,yo.Z)(r))return iC(r);var e=jh(r),t=[];for(var n in r)n=="constructor"&&(e||!oC.call(r,n))||t.push(n);return t}var aC=sC;function lC(r){return Ds(r)?Xm(r,!0):aC(r)}var Na=lC;function Pv(r,e){return r==null?r:fl(r,nC(e),Na)}var cC=Pv;function Ov(r,e,t){(t!==void 0&&!(0,Gs.Z)(r[e],t)||t===void 0&&!(e in r))&&ef(r,e,t)}var _g=Ov,Dv=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Ag=Dv&&typeof module=="object"&&module&&!module.nodeType&&module,uC=Ag&&Ag.exports===Dv,O=uC?ms.Z.Buffer:void 0,Y=O?O.allocUnsafe:void 0;function ge(r,e){if(e)return r.slice();var t=r.length,n=Y?Y(t):new r.constructor(t);return r.copy(n),n}var $e=ge;function ot(r){var e=new r.constructor(r.byteLength);return new Xl(e).set(new Xl(r)),e}var He=ot;function Ke(r,e){var t=e?He(r.buffer):r.buffer;return new r.constructor(t,r.byteOffset,r.length)}var Et=Ke;function Dt(r,e){var t=-1,n=r.length;for(e||(e=Array(n));++t<n;)e[t]=r[t];return e}var Lt=Dt,Mt=Object.create,Ut=function(){function r(){}return function(e){if(!(0,yo.Z)(e))return{};if(Mt)return Mt(e);r.prototype=e;var t=new r;return r.prototype=void 0,t}}(),Wt=Ut,_t=Ym(Object.getPrototypeOf,Object),Bt=_t;function Le(r){return typeof r.constructor=="function"&&!jh(r)?Wt(Bt(r)):{}}var Ye=Le,Gt="[object Object]",Qt=Function.prototype,gt=Object.prototype,en=Qt.toString,yt=gt.hasOwnProperty,jt=en.call(Object);function vt(r){if(!(0,Po.Z)(r)||(0,ys.Z)(r)!=Gt)return!1;var e=Bt(r);if(e===null)return!0;var t=yt.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&en.call(t)==jt}var Rt=vt;function En(r,e){if(!(e==="constructor"&&typeof r[e]=="function")&&e!="__proto__")return r[e]}var zn=En;function Zt(r,e,t,n){var i=!t;t||(t={});for(var o=-1,s=e.length;++o<s;){var a=e[o],l=n?n(t[a],r[a],a,t,r):void 0;l===void 0&&(l=r[a]),i?ef(t,a,l):Bs(t,a,l)}return t}var Pt=Zt;function dt(r){return Pt(r,Na(r))}var kn=dt;function er(r,e,t,n,i,o,s){var a=zn(r,t),l=zn(e,t),c=s.get(l);if(c){_g(r,t,c);return}var u=o?o(a,l,t+"",r,e,s):void 0,d=u===void 0;if(d){var h=(0,Lr.Z)(l),f=!h&&sn(l),p=!h&&!f&&cd(l);u=l,h||f||p?(0,Lr.Z)(a)?u=a:Ve(a)?u=Lt(a):f?(d=!1,u=$e(l,!0)):p?(d=!1,u=Et(l,!0)):u=[]:Rt(l)||el(l)?(u=a,el(a)?u=kn(a):(!(0,yo.Z)(a)||(0,xh.Z)(a))&&(u=Ye(l))):d=!1}d&&(s.set(l,u),i(u,l,n,o,s),s.delete(l)),_g(r,t,u)}var ln=er;function ar(r,e,t,n,i){r!==e&&fl(e,function(o,s){if(i||(i=new Ls),(0,yo.Z)(o))ln(r,e,s,t,ar,n,i);else{var a=n?n(zn(r,s),o,s+"",r,e,i):void 0;a===void 0&&(a=o),_g(r,s,a)}},Na)}var Vn=ar;function rr(r){return Ee(function(e,t){var n=-1,i=t.length,o=i>1?t[i-1]:void 0,s=i>2?t[2]:void 0;for(o=r.length>3&&typeof o=="function"?(i--,o):void 0,s&&sc(t[0],t[1],s)&&(o=i<3?void 0:o,i=1),e=Object(e);++n<i;){var a=t[n];a&&r(e,a,n,o)}return e})}var Er=rr,Hi=Er(function(r,e,t){Vn(r,e,t)}),ir=Hi,mr=Er(function(r,e){Pt(e,Na(e),r)}),oo=mr;function gi(r,e){return hd(r,e)}var ri=gi,Xi="[object Map]",Yi="[object Set]",bo=Object.prototype,So=bo.hasOwnProperty;function Ri(r){if(r==null)return!0;if(Ds(r)&&((0,Lr.Z)(r)||typeof r=="string"||typeof r.splice=="function"||sn(r)||cd(r)||el(r)))return!r.length;var e=qs(r);if(e==Xi||e==Yi)return!r.size;if(jh(r))return!Hh(r).length;for(var t in r)if(So.call(r,t))return!1;return!0}var Qn=Ri;function _o(r,e){for(var t=-1,n=r==null?0:r.length;++t<n&&e(r[t],t,r)!==!1;);return r}var Hr=_o;function _n(r,e){return r&&Pt(e,Zc(e),r)}var fr=_n;function Ar(r,e){return r&&Pt(e,Na(e),r)}var ki=Ar;function ga(r,e){return Pt(r,ql(r),e)}var lc=ga,ue=Object.getOwnPropertySymbols,We=ue?function(r){for(var e=[];r;)ca(e,ql(r)),r=Bt(r);return e}:pa,je=We;function rn(r,e){return Pt(r,je(r),e)}var dr=rn;function ie(r){return jc(r,Na,je)}var Z=ie,be=Object.prototype,Ie=be.hasOwnProperty;function Ge(r){var e=r.length,t=new r.constructor(e);return e&&typeof r[0]=="string"&&Ie.call(r,"index")&&(t.index=r.index,t.input=r.input),t}var _e=Ge;function Ce(r,e){var t=e?He(r.buffer):r.buffer;return new r.constructor(t,r.byteOffset,r.byteLength)}var Ne=Ce,oe=/\w*$/;function ye(r){var e=new r.constructor(r.source,oe.exec(r));return e.lastIndex=r.lastIndex,e}var te=ye,Re=Pa.Z?Pa.Z.prototype:void 0,ze=Re?Re.valueOf:void 0;function rt(r){return ze?Object(ze.call(r)):{}}var st=rt,Je="[object Boolean]",kt="[object Date]",mn="[object Map]",tr="[object Number]",cn="[object RegExp]",An="[object Set]",Yn="[object String]",Gr="[object Symbol]",Pi="[object ArrayBuffer]",ts="[object DataView]",Tg="[object Float32Array]",zs="[object Float64Array]",Nv="[object Int8Array]",Qs="[object Int16Array]",Rv="[object Int32Array]",tI="[object Uint8Array]",nI="[object Uint8ClampedArray]",rI="[object Uint16Array]",iI="[object Uint32Array]";function oI(r,e,t){var n=r.constructor;switch(e){case Pi:return He(r);case Je:case kt:return new n(+r);case ts:return Ne(r,t);case Tg:case zs:case Nv:case Qs:case Rv:case tI:case nI:case rI:case iI:return Et(r,t);case mn:return new n;case tr:case Yn:return new n(r);case cn:return te(r);case An:return new n;case Gr:return st(r)}}var sI=oI,aI="[object Map]";function lI(r){return(0,Po.Z)(r)&&qs(r)==aI}var cI=lI,HE=as&&as.isMap,uI=HE?Ql(HE):cI,dI=uI,hI="[object Set]";function fI(r){return(0,Po.Z)(r)&&qs(r)==hI}var pI=fI,$E=as&&as.isSet,gI=$E?Ql($E):pI,mI=gI,vI=1,yI=2,bI=4,WE="[object Arguments]",xI="[object Array]",CI="[object Boolean]",wI="[object Date]",EI="[object Error]",ZE="[object Function]",SI="[object GeneratorFunction]",_I="[object Map]",AI="[object Number]",XE="[object Object]",TI="[object RegExp]",MI="[object Set]",PI="[object String]",OI="[object Symbol]",DI="[object WeakMap]",NI="[object ArrayBuffer]",RI="[object DataView]",kI="[object Float32Array]",II="[object Float64Array]",LI="[object Int8Array]",GI="[object Int16Array]",FI="[object Int32Array]",BI="[object Uint8Array]",zI="[object Uint8ClampedArray]",UI="[object Uint16Array]",VI="[object Uint32Array]",Oi={};Oi[WE]=Oi[xI]=Oi[NI]=Oi[RI]=Oi[CI]=Oi[wI]=Oi[kI]=Oi[II]=Oi[LI]=Oi[GI]=Oi[FI]=Oi[_I]=Oi[AI]=Oi[XE]=Oi[TI]=Oi[MI]=Oi[PI]=Oi[OI]=Oi[BI]=Oi[zI]=Oi[UI]=Oi[VI]=!0,Oi[EI]=Oi[ZE]=Oi[DI]=!1;function kv(r,e,t,n,i,o){var s,a=e&vI,l=e&yI,c=e&bI;if(t&&(s=i?t(r,n,i,o):t(r)),s!==void 0)return s;if(!(0,yo.Z)(r))return r;var u=(0,Lr.Z)(r);if(u){if(s=_e(r),!a)return Lt(r,s)}else{var d=qs(r),h=d==ZE||d==SI;if(sn(r))return $e(r,a);if(d==XE||d==WE||h&&!i){if(s=l||h?{}:Ye(r),!a)return l?dr(r,ki(s,r)):lc(r,fr(s,r))}else{if(!Oi[d])return i?r:{};s=sI(r,d,a)}}o||(o=new Ls);var f=o.get(r);if(f)return f;o.set(r,s),mI(r)?r.forEach(function(v){s.add(kv(v,e,t,v,r,o))}):dI(r)&&r.forEach(function(v,y){s.set(y,kv(v,e,t,y,r,o))});var p=c?l?Z:tg:l?Na:Zc,g=u?void 0:p(r);return Hr(g||r,function(v,y){g&&(y=v,v=r[y]),Bs(s,y,kv(v,e,t,y,r,o))}),s}var YE=kv,jI=4;function HI(r){return YE(r,jI)}var Mg=HI,$I=1,WI=4;function ZI(r){return YE(r,$I|WI)}var Ki=ZI,KE=Object.prototype,XI=KE.hasOwnProperty,YI=Ee(function(r,e){r=Object(r);var t=-1,n=e.length,i=n>2?e[2]:void 0;for(i&&sc(e[0],e[1],i)&&(n=1);++t<n;)for(var o=e[t],s=Na(o),a=-1,l=s.length;++a<l;){var c=s[a],u=r[c];(u===void 0||(0,Gs.Z)(u,KE[c])&&!XI.call(r,c))&&(r[c]=o[c])}return r}),KI=YI;function qE(r,e,t,n,i,o){return(0,yo.Z)(r)&&(0,yo.Z)(e)&&(o.set(e,r),Vn(r,e,void 0,qE,o),o.delete(e)),r}var qI=qE,JI=Er(function(r,e,t,n){Vn(r,e,t,n)}),QI=JI,eL=Ee(function(r){return r.push(void 0,qI),nl(QI,void 0,r)}),JE=eL;function QE(r,...e){e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{n!=="constructor"&&Object.defineProperty(r.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n))})})}const tL=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])};function nL(r,e){tL(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}class rL{}const iL=/^\s*class\s+/.test(`${rL}`)||/^\s*class\s*\{/.test(`${class{}}`);function dC(r,e){let t;return iL?t=class extends e{}:(t=function(){return e.apply(this,arguments)},nL(t,e)),Object.defineProperty(t,"name",{value:r}),t}function oL(r,e){return r!=null?r:e}function UQ(r,e,t){const n=r!=null?r[e]:null;return t!==void 0?oL(n,t):n}function VQ(r,e,t){let n=r!=null?r[e]:null;return n==null||(n=+n,Number.isNaN(n)||!Number.isFinite(n))?t:n}function jQ(r,e,t){const n=r!=null?r[e]:null;return n==null?t:!!n}function eS(r){return r==="__proto__"}function hC(r,e,t="/"){let n;const i=Array.isArray(e)?e:e.split(t);if(i.length)for(n=r;i.length;){const o=i.shift();if(Object(n)===n&&o&&o in n)n=n[o];else return}return n}function df(r,e,t,n="/"){const i=Array.isArray(e)?e:e.split(n),o=i.pop();if(o&&!eS(o)){let s=r;i.forEach(a=>{eS(a)||(s[a]==null&&(s[a]={}),s=s[a])}),s[o]=t}return r}function tS(r,e,t="/"){const n=Array.isArray(e)?e.slice():e.split(t),i=n.pop();if(i)if(n.length>0){const o=hC(r,n);o&&delete o[i]}else delete r[i];return r}function sL(r,e="/",t){const n={};Object.keys(r).forEach(i=>{const o=r[i];let s=typeof o=="object"||Array.isArray(o);if(s&&t&&t(o)&&(s=!1),s){const a=sL(o,e,t);Object.keys(a).forEach(l=>{n[i+e+l]=a[l]})}else n[i]=o});for(const i in r)!!Object.prototype.hasOwnProperty.call(r,i);return n}var aL="[object String]";function lL(r){return typeof r=="string"||!(0,Lr.Z)(r)&&(0,Po.Z)(r)&&(0,ys.Z)(r)==aL}var fC=lL,Wo=w(13633);function cL(r){return function(e){return r==null?void 0:r[e]}}var pC=cL,uL={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},dL=pC(uL),hL=dL,nS=/[&<>"']/g,fL=RegExp(nS.source);function pL(r){return r=(0,Wo.Z)(r),r&&fL.test(r)?r.replace(nS,hL):r}var gL=pL,mL={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},vL=pC(mL),yL=vL,rS=/&(?:amp|lt|gt|quot|#39);/g,bL=RegExp(rS.source);function xL(r){return r=(0,Wo.Z)(r),r&&bL.test(r)?r.replace(rS,yL):r}var HQ=xL;function CL(r,e,t){return r===r&&(t!==void 0&&(r=r<=t?r:t),e!==void 0&&(r=r>=e?r:e)),r}var Iv=CL,hf=w(43503),vl=w(98392);function wL(r,e,t){return r=(0,Wo.Z)(r),t=t==null?0:Iv((0,vl.Z)(t),0,r.length),e=(0,hf.Z)(e),r.slice(t,t+e.length)==e}var $Q=wL;function EL(r,e,t){r=(0,Wo.Z)(r),e=(0,hf.Z)(e);var n=r.length;t=t===void 0?n:Iv((0,vl.Z)(t),0,n);var i=t;return t-=e.length,t>=0&&r.slice(t,i)==e}var WQ=EL;function SL(r,e,t){var n=-1,i=r.length;e<0&&(e=-e>i?0:i+e),t=t>i?i:t,t<0&&(t+=i),i=e>t?0:t-e>>>0,e>>>=0;for(var o=Array(i);++n<i;)o[n]=r[n+e];return o}var _L=SL;function AL(r,e,t){var n=r.length;return t=t===void 0?n:t,!e&&t>=n?r:_L(r,e,t)}var Lv=AL,TL="\\ud800-\\udfff",ML="\\u0300-\\u036f",PL="\\ufe20-\\ufe2f",OL="\\u20d0-\\u20ff",DL=ML+PL+OL,NL="\\ufe0e\\ufe0f",RL="\\u200d",kL=RegExp("["+RL+TL+DL+NL+"]");function IL(r){return kL.test(r)}var ff=IL,LL="[object RegExp]";function GL(r){return(0,Po.Z)(r)&&(0,ys.Z)(r)==LL}var FL=GL,iS=as&&as.isRegExp,BL=iS?Ql(iS):FL,oS=BL;function zL(r){return r.split("")}var UL=zL,sS="\\ud800-\\udfff",VL="\\u0300-\\u036f",jL="\\ufe20-\\ufe2f",HL="\\u20d0-\\u20ff",$L=VL+jL+HL,WL="\\ufe0e\\ufe0f",ZL="["+sS+"]",gC="["+$L+"]",mC="\\ud83c[\\udffb-\\udfff]",XL="(?:"+gC+"|"+mC+")",aS="[^"+sS+"]",lS="(?:\\ud83c[\\udde6-\\uddff]){2}",cS="[\\ud800-\\udbff][\\udc00-\\udfff]",YL="\\u200d",uS=XL+"?",dS="["+WL+"]?",KL="(?:"+YL+"(?:"+[aS,lS,cS].join("|")+")"+dS+uS+")*",qL=dS+uS+KL,JL="(?:"+[aS+gC+"?",gC,lS,cS,ZL].join("|")+")",QL=RegExp(mC+"(?="+mC+")|"+JL+qL,"g");function eG(r){return r.match(QL)||[]}var tG=eG;function nG(r){return ff(r)?tG(r):UL(r)}var Gv=nG,rG=4294967295;function iG(r,e,t){return t&&typeof t!="number"&&sc(r,e,t)&&(e=t=void 0),t=t===void 0?rG:t>>>0,t?(r=(0,Wo.Z)(r),r&&(typeof e=="string"||e!=null&&!oS(e))&&(e=(0,hf.Z)(e),!e&&ff(r))?Lv(Gv(r),0,t):r.split(e,t)):[]}var ZQ=iG,oG=9007199254740991,sG=Math.floor;function aG(r,e){var t="";if(!r||e<1||e>oG)return t;do e%2&&(t+=r),e=sG(e/2),e&&(r+=r);while(e);return t}var vC=aG;function lG(r,e,t){return(t?sc(r,e,t):e===void 0)?e=1:e=(0,vl.Z)(e),vC((0,Wo.Z)(r),e)}var XQ=lG,cG=md("length"),uG=cG,hS="\\ud800-\\udfff",dG="\\u0300-\\u036f",hG="\\ufe20-\\ufe2f",fG="\\u20d0-\\u20ff",pG=dG+hG+fG,gG="\\ufe0e\\ufe0f",mG="["+hS+"]",yC="["+pG+"]",bC="\\ud83c[\\udffb-\\udfff]",vG="(?:"+yC+"|"+bC+")",fS="[^"+hS+"]",pS="(?:\\ud83c[\\udde6-\\uddff]){2}",gS="[\\ud800-\\udbff][\\udc00-\\udfff]",yG="\\u200d",mS=vG+"?",vS="["+gG+"]?",bG="(?:"+yG+"(?:"+[fS,pS,gS].join("|")+")"+vS+mS+")*",xG=vS+mS+bG,CG="(?:"+[fS+yC+"?",yC,pS,gS,mG].join("|")+")",yS=RegExp(bC+"(?="+bC+")|"+CG+xG,"g");function wG(r){for(var e=yS.lastIndex=0;yS.test(r);)++e;return e}var EG=wG;function SG(r){return ff(r)?EG(r):uG(r)}var Pg=SG,_G=Math.ceil;function AG(r,e){e=e===void 0?" ":(0,hf.Z)(e);var t=e.length;if(t<2)return t?vC(e,r):e;var n=vC(e,_G(r/Pg(e)));return ff(e)?Lv(Gv(n),0,r).join(""):n.slice(0,r)}var Fv=AG,TG=Math.ceil,MG=Math.floor;function PG(r,e,t){r=(0,Wo.Z)(r),e=(0,vl.Z)(e);var n=e?Pg(r):0;if(!e||n>=e)return r;var i=(e-n)/2;return Fv(MG(i),t)+r+Fv(TG(i),t)}var YQ=PG;function OG(r,e,t){r=(0,Wo.Z)(r),e=(0,vl.Z)(e);var n=e?Pg(r):0;return e&&n<e?r+Fv(e-n,t):r}var KQ=OG;function DG(r,e,t){r=(0,Wo.Z)(r),e=(0,vl.Z)(e);var n=e?Pg(r):0;return e&&n<e?Fv(e-n,t)+r:r}var qQ=DG,NG=30,RG="...",kG=/\w*$/;function IG(r,e){var t=NG,n=RG;if((0,yo.Z)(e)){var i="separator"in e?e.separator:i;t="length"in e?(0,vl.Z)(e.length):t,n="omission"in e?(0,hf.Z)(e.omission):n}r=(0,Wo.Z)(r);var o=r.length;if(ff(r)){var s=Gv(r);o=s.length}if(t>=o)return r;var a=t-Pg(n);if(a<1)return n;var l=s?Lv(s,0,a).join(""):r.slice(0,a);if(i===void 0)return l+n;if(s&&(a+=l.length-a),oS(i)){if(r.slice(a).search(i)){var c,u=l;for(i.global||(i=RegExp(i.source,(0,Wo.Z)(kG.exec(i))+"g")),i.lastIndex=0;c=i.exec(u);)var d=c.index;l=l.slice(0,d===void 0?a:d)}}else if(r.indexOf((0,hf.Z)(i),a)!=a){var h=l.lastIndexOf(i);h>-1&&(l=l.slice(0,h))}return l+n}var JQ=IG,LG=Er(function(r,e,t,n){Pt(e,Na(e),r,n)}),bS=LG,GG="[object DOMException]",FG="[object Error]";function BG(r){if(!(0,Po.Z)(r))return!1;var e=(0,ys.Z)(r);return e==FG||e==GG||typeof r.message=="string"&&typeof r.name=="string"&&!Rt(r)}var xS=BG,zG=Ee(function(r,e){try{return nl(r,void 0,e)}catch(t){return xS(t)?t:new Error(t)}}),UG=zG;function VG(r,e){return(0,hl.Z)(e,function(t){return r[t]})}var jG=VG,CS=Object.prototype,HG=CS.hasOwnProperty;function $G(r,e,t,n){return r===void 0||(0,Gs.Z)(r,CS[t])&&!HG.call(n,t)?e:r}var wS=$G,WG={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function ZG(r){return"\\"+WG[r]}var XG=ZG,YG=/<%=([\s\S]+?)%>/g,ES=YG,KG=/<%-([\s\S]+?)%>/g,qG=KG,JG=/<%([\s\S]+?)%>/g,QG=JG,e4={escape:qG,evaluate:QG,interpolate:ES,variable:"",imports:{_:{escape:gL}}},SS=e4,t4="Invalid `variable` option passed into `_.template`",n4=/\b__p \+= '';/g,r4=/\b(__p \+=) '' \+/g,i4=/(__e\(.*?\)|\b__t\)) \+\n'';/g,o4=/[()=,{}\[\]\/\s]/,s4=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Bv=/($^)/,a4=/['\n\r\u2028\u2029\\]/g,l4=Object.prototype,_S=l4.hasOwnProperty;function c4(r,e,t){var n=SS.imports._.templateSettings||SS;t&&sc(r,e,t)&&(e=void 0),r=(0,Wo.Z)(r),e=bS({},e,n,wS);var i=bS({},e.imports,n.imports,wS),o=Zc(i),s=jG(i,o),a,l,c=0,u=e.interpolate||Bv,d="__p += '",h=RegExp((e.escape||Bv).source+"|"+u.source+"|"+(u===ES?s4:Bv).source+"|"+(e.evaluate||Bv).source+"|$","g"),f=_S.call(e,"sourceURL")?"//# sourceURL="+(e.sourceURL+"").replace(/\s/g," ")+`
`:"";r.replace(h,function(v,y,x,E,T,P){return x||(x=E),d+=r.slice(c,P).replace(a4,XG),y&&(a=!0,d+=`' +
__e(`+y+`) +
'`),T&&(l=!0,d+=`';
`+T+`;
__p += '`),x&&(d+=`' +
((__t = (`+x+`)) == null ? '' : __t) +
'`),c=P+v.length,v}),d+=`';
`;var p=_S.call(e,"variable")&&e.variable;if(!p)d=`with (obj) {
`+d+`
}
`;else if(o4.test(p))throw new Error(t4);d=(l?d.replace(n4,""):d).replace(r4,"$1").replace(i4,"$1;"),d="function("+(p||"obj")+`) {
`+(p?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(a?", __e = _.escape":"")+(l?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+d+`return __p
}`;var g=UG(function(){return Function(o,f+"return "+d).apply(void 0,s)});if(g.source=d,xS(g))throw g;return g}var pf=c4,u4=0;function d4(r){var e=++u4;return(0,Wo.Z)(r)+e}var h4=d4;function QQ(r){let e=null;try{e=window.eval(r)}catch(t){}return e}function f4(r,e,t,n){var i=-1,o=r==null?0:r.length;for(n&&o&&(t=r[++i]);++i<o;)t=e(t,r[i],i,r);return t}var p4=f4,g4={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},m4=pC(g4),v4=m4,y4=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,b4="\\u0300-\\u036f",x4="\\ufe20-\\ufe2f",C4="\\u20d0-\\u20ff",w4=b4+x4+C4,E4="["+w4+"]",S4=RegExp(E4,"g");function _4(r){return r=(0,Wo.Z)(r),r&&r.replace(y4,v4).replace(S4,"")}var A4=_4,T4=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function M4(r){return r.match(T4)||[]}var P4=M4,O4=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function D4(r){return O4.test(r)}var N4=D4,AS="\\ud800-\\udfff",R4="\\u0300-\\u036f",k4="\\ufe20-\\ufe2f",I4="\\u20d0-\\u20ff",L4=R4+k4+I4,TS="\\u2700-\\u27bf",MS="a-z\\xdf-\\xf6\\xf8-\\xff",G4="\\xac\\xb1\\xd7\\xf7",F4="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",B4="\\u2000-\\u206f",z4=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",PS="A-Z\\xc0-\\xd6\\xd8-\\xde",U4="\\ufe0e\\ufe0f",OS=G4+F4+B4+z4,DS="['\u2019]",NS="["+OS+"]",V4="["+L4+"]",RS="\\d+",j4="["+TS+"]",kS="["+MS+"]",IS="[^"+AS+OS+RS+TS+MS+PS+"]",H4="\\ud83c[\\udffb-\\udfff]",$4="(?:"+V4+"|"+H4+")",W4="[^"+AS+"]",LS="(?:\\ud83c[\\udde6-\\uddff]){2}",GS="[\\ud800-\\udbff][\\udc00-\\udfff]",gf="["+PS+"]",Z4="\\u200d",FS="(?:"+kS+"|"+IS+")",X4="(?:"+gf+"|"+IS+")",BS="(?:"+DS+"(?:d|ll|m|re|s|t|ve))?",zS="(?:"+DS+"(?:D|LL|M|RE|S|T|VE))?",US=$4+"?",VS="["+U4+"]?",Y4="(?:"+Z4+"(?:"+[W4,LS,GS].join("|")+")"+VS+US+")*",K4="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",q4="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",J4=VS+US+Y4,Q4="(?:"+[j4,LS,GS].join("|")+")"+J4,eF=RegExp([gf+"?"+kS+"+"+BS+"(?="+[NS,gf,"$"].join("|")+")",X4+"+"+zS+"(?="+[NS,gf+FS,"$"].join("|")+")",gf+"?"+FS+"+"+BS,gf+"+"+zS,q4,K4,RS,Q4].join("|"),"g");function tF(r){return r.match(eF)||[]}var nF=tF;function rF(r,e,t){return r=(0,Wo.Z)(r),e=t?void 0:e,e===void 0?N4(r)?nF(r):P4(r):r.match(e)||[]}var iF=rF,oF="['\u2019]",sF=RegExp(oF,"g");function aF(r){return function(e){return p4(iF(A4(e).replace(sF,"")),r,"")}}var zv=aF;function lF(r){return function(e){e=(0,Wo.Z)(e);var t=ff(e)?Gv(e):void 0,n=t?t[0]:e.charAt(0),i=t?Lv(t,1).join(""):e.slice(1);return n[r]()+i}}var jS=lF,cF=jS("toUpperCase"),Og=cF,uF=zv(function(r,e,t){return r+(t?" ":"")+Og(e)}),HS=uF;function dF(r){return Og((0,Wo.Z)(r).toLowerCase())}var hF=dF,fF=zv(function(r,e,t){return e=e.toLowerCase(),r+(t?hF(e):e)}),Uv=fF,pF=zv(function(r,e,t){return r+(t?" ":"")+e.toUpperCase()}),gF=pF,mF=zv(function(r,e,t){return r+(t?" ":"")+e.toLowerCase()}),xC=mF,vF=jS("toLowerCase"),yF=vF;const Md=r=>{const e=Object.create(null);return t=>e[t]||(e[t]=r(t))},$S=Md(r=>r.replace(/\B([A-Z])/g,"-$1").toLowerCase()),CC=Md(r=>HS(Uv(r)).replace(/ /g,"")),eee=Md(r=>gF(r).replace(/ /g,"_")),tee=Md(r=>xC(r).replace(/ /g,".")),nee=Md(r=>xC(r).replace(/ /g,"/")),ree=Md(r=>Og(xC(r))),iee=Md(r=>HS(Uv(r)));function wC(r){let e=2166136261,t=!1,n=r;for(let i=0,o=n.length;i<o;i+=1){let s=n.charCodeAt(i);s>127&&!t&&(n=unescape(encodeURIComponent(n)),s=n.charCodeAt(i),t=!0),e^=s,e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24)}return e>>>0}function EC(){let r="";const e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";for(let t=0,n=e.length;t<n;t+=1){const i=e[t],o=Math.random()*16|0;r+=(i==="x"?o:i==="y"?o&3|8:i).toString(16)}return r}function WS(r,e={}){const t=jr().parseHTML(r,null,!1);return t.forEach(n=>{const i=n;if(i){const o=i.attributes;if(o)for(let s=0,a=o.length;s<a;s+=1){const l=o.item(s);if(l){const c=l.value.toLowerCase(),u=l.name.toLowerCase();(u.startsWith("on")||c.startsWith("javascript:")||c.startsWith("data:")||c.startsWith("vbscript:"))&&i.removeAttribute(u)}}}}),e.raw?t:jr()("<div/>").append(t).html()}function bF(r,e,t){const n=Math.min(2,Math.floor(r.length*.34));let i=Math.floor(r.length*.4)+1,o,s=!1;const a=r.toLowerCase();for(const l of e){const c=t(l);if(c!==void 0&&Math.abs(c.length-a.length)<=n){const u=c.toLowerCase();if(u===a){if(c===r)continue;return l}if(s||c.length<3)continue;const d=xF(a,u,i-1);if(d===void 0)continue;d<3?(s=!0,o=l):(i=d,o=l)}}return o}function xF(r,e,t){let n=new Array(e.length+1),i=new Array(e.length+1);const o=t+1;for(let a=0;a<=e.length;a+=1)n[a]=a;for(let a=1;a<=r.length;a+=1){const l=r.charCodeAt(a-1),c=a>t?a-t:1,u=e.length>t+a?t+a:e.length;i[0]=a;let d=a;for(let f=1;f<c;f+=1)i[f]=o;for(let f=c;f<=u;f+=1){const p=l===e.charCodeAt(f-1)?n[f-1]:Math.min(n[f]+1,i[f-1]+1,n[f-1]+2);i[f]=p,d=Math.min(d,p)}for(let f=u+1;f<=e.length;f+=1)i[f]=o;if(d>t)return;const h=n;n=i,i=h}const s=n[e.length];return s>t?void 0:s}var CF="[object Number]";function wF(r){return typeof r=="number"||(0,Po.Z)(r)&&(0,ys.Z)(r)==CF}var SC=wF;function EF(r){return SC(r)&&r!=+r}var oee=EF,SF=ms.Z.isFinite;function _F(r){return typeof r=="number"&&SF(r)}var see=_F;function AF(r){return typeof r=="number"&&r==(0,vl.Z)(r)}var TF=AF,ZS=9007199254740991;function MF(r){return TF(r)&&r>=-ZS&&r<=ZS}var aee=MF,mf=w(66279);function PF(r,e,t){return t===void 0&&(t=e,e=void 0),t!==void 0&&(t=(0,mf.Z)(t),t=t===t?t:0),e!==void 0&&(e=(0,mf.Z)(e),e=e===e?e:0),Iv((0,mf.Z)(r),e,t)}var ws=PF,OF=Math.max,DF=Math.min;function NF(r,e,t){return r>=DF(e,t)&&r<OF(e,t)}var RF=NF,XS=w(69354);function kF(r,e,t){return e=(0,XS.Z)(e),t===void 0?(t=e,e=0):t=(0,XS.Z)(t),r=(0,mf.Z)(r),RF(r,e,t)}var lee=kF,YS=9007199254740991;function IF(r){return r?Iv((0,vl.Z)(r),-YS,YS):r===0?r:0}var cee=IF,LF=/^\s+/,GF=ms.Z.parseInt;function FF(r,e,t){return t||e==null?e=0:e&&(e=+e),GF((0,Wo.Z)(r).replace(LF,""),e||0)}var uee=FF;const dee=r=>r&&r===r.window,BF=r=>!Array.isArray(r)&&r-parseFloat(r)+1>=0;function hee(r,e){return(r%e+e)%e}function fee(r,e){if(e==null)e=r==null?1:r,r=0;else if(e<r){const t=r;r=e,e=t}return Math.floor(Math.random()*(e-r+1)+r)}function yl(r){return typeof r=="string"&&r.slice(-1)==="%"}function Ra(r,e){if(r==null)return 0;let t;if(typeof r=="string"){if(t=parseFloat(r),yl(r)&&(t/=100,Number.isFinite(t)))return t*e}else t=r;return Number.isFinite(t)?t>0&&t<1?t*e:t:0}function zF(r,e){function t(s){const a=new RegExp(`(?:\\d+(?:\\.\\d+)*)(${s})$`).exec(r);return a?a[1]:null}const n=parseFloat(r);if(Number.isNaN(n))return null;let i;if(e==null)i="[A-Za-z]*";else if(Array.isArray(e)){if(e.length===0)return null;i=e.join("|")}else typeof e=="string"&&(i=e);const o=t(i);return o===null?null:{unit:o,value:n}}function Us(r){if(typeof r=="object"){let t=0,n=0,i=0,o=0;return r.vertical!=null&&Number.isFinite(r.vertical)&&(n=o=r.vertical),r.horizontal!=null&&Number.isFinite(r.horizontal)&&(i=t=r.horizontal),r.left!=null&&Number.isFinite(r.left)&&(t=r.left),r.top!=null&&Number.isFinite(r.top)&&(n=r.top),r.right!=null&&Number.isFinite(r.right)&&(i=r.right),r.bottom!=null&&Number.isFinite(r.bottom)&&(o=r.bottom),{top:n,right:i,bottom:o,left:t}}let e=0;return r!=null&&Number.isFinite(r)&&(e=r),{top:e,right:e,bottom:e,left:e}}var UF="Expected a function";function VF(r,e){var t;if(typeof e!="function")throw new TypeError(UF);return r=(0,vl.Z)(r),function(){return--r>0&&(t=e.apply(this,arguments)),r<=1&&(e=void 0),t}}var jF=VF;function HF(r){return jF(2,r)}var pee=HF,$F=function(){return ms.Z.Date.now()},_C=$F,WF="Expected a function",ZF=Math.max,XF=Math.min;function YF(r,e,t){var n,i,o,s,a,l,c=0,u=!1,d=!1,h=!0;if(typeof r!="function")throw new TypeError(WF);e=(0,mf.Z)(e)||0,(0,yo.Z)(t)&&(u=!!t.leading,d="maxWait"in t,o=d?ZF((0,mf.Z)(t.maxWait)||0,e):o,h="trailing"in t?!!t.trailing:h);function f(z){var $=n,ne=i;return n=i=void 0,c=z,s=r.apply(ne,$),s}function p(z){return c=z,a=setTimeout(y,e),u?f(z):s}function g(z){var $=z-l,ne=z-c,De=e-$;return d?XF(De,o-ne):De}function v(z){var $=z-l,ne=z-c;return l===void 0||$>=e||$<0||d&&ne>=o}function y(){var z=_C();if(v(z))return x(z);a=setTimeout(y,g(z))}function x(z){return a=void 0,h&&n?f(z):(n=i=void 0,s)}function E(){a!==void 0&&clearTimeout(a),c=0,n=l=i=a=void 0}function T(){return a===void 0?s:x(_C())}function P(){var z=_C(),$=v(z);if(n=arguments,i=this,l=z,$){if(a===void 0)return p(l);if(d)return clearTimeout(a),a=setTimeout(y,e),f(l)}return a===void 0&&(a=setTimeout(y,e)),s}return P.cancel=E,P.flush=T,P}var KS=YF,KF="Expected a function";function qF(r,e,t){if(typeof r!="function")throw new TypeError(KF);return setTimeout(function(){r.apply(void 0,t)},e)}var JF=qF,QF=Ee(function(r,e){return JF(r,1,e)}),e6=QF;function AC(r,e,t){if(t)switch(t.length){case 0:return r.call(e);case 1:return r.call(e,t[0]);case 2:return r.call(e,t[0],t[1]);case 3:return r.call(e,t[0],t[1],t[2]);case 4:return r.call(e,t[0],t[1],t[2],t[3]);case 5:return r.call(e,t[0],t[1],t[2],t[3],t[4]);case 6:return r.call(e,t[0],t[1],t[2],t[3],t[4],t[5]);default:return r.apply(e,t)}return r.call(e)}function dn(r,e,...t){return AC(r,e,t)}function t6(r,e){for(let t=0,n=r.length;t<n;t+=1)if(r[t]===e)return r.push(r.splice(t,1)[0])}function gee(r,e,t){const n=[],i={};return(...s)=>{let a=!1;const l=s.join("\u2400");return l in i?(a=!0,t6(n,l)):(n.length>=1e3&&delete i[n.shift()],n.push(l),i[l]=AC(r,e||null,s)),t?t(i[l],a):i[l]}}function n6(r){return typeof r=="object"&&r.then&&typeof r.then=="function"}function TC(r){return r!=null&&(r instanceof Promise||n6(r))}function MC(...r){const e=[];if(r.forEach(n=>{Array.isArray(n)?e.push(...n):e.push(n)}),e.some(n=>TC(n))){const n=e.map(i=>TC(i)?i:Promise.resolve(i!==!1));return Promise.all(n).then(i=>i.reduce((o,s)=>s!==!1&&o,!0))}return e.every(n=>n!==!1)}function r6(...r){const e=MC(r);return typeof e=="boolean"?Promise.resolve(e):e}const PC=/[\t\r\n\f]/g,OC=/\S+/g,vf=r=>` ${r} `;function yf(r){return r&&r.getAttribute&&r.getAttribute("class")||""}function Dg(r,e){if(r==null||e==null)return!1;const t=vf(yf(r)),n=vf(e);return r.nodeType===1?t.replace(PC," ").includes(n):!1}function Qr(r,e){if(!(r==null||e==null)){if(typeof e=="function")return Qr(r,e(yf(r)));if(typeof e=="string"&&r.nodeType===1){const t=e.match(OC)||[],n=vf(yf(r)).replace(PC," ");let i=t.reduce((o,s)=>o.indexOf(vf(s))<0?`${o}${s} `:o,n);i=i.trim(),n!==i&&r.setAttribute("class",i)}}}function ma(r,e){if(r!=null){if(typeof e=="function")return ma(r,e(yf(r)));if((!e||typeof e=="string")&&r.nodeType===1){const t=(e||"").match(OC)||[],n=vf(yf(r)).replace(PC," ");let i=t.reduce((o,s)=>{const a=vf(s);return o.indexOf(a)>-1?o.replace(a," "):o},n);i=e?i.trim():"",n!==i&&r.setAttribute("class",i)}}}function qS(r,e,t){if(!(r==null||e==null)){if(t!=null&&typeof e=="string"){t?Qr(r,e):ma(r,e);return}if(typeof e=="function")return qS(r,e(yf(r),t),t);typeof e=="string"&&(e.match(OC)||[]).forEach(i=>{Dg(r,i)?ma(r,i):Qr(r,i)})}}let JS=0;function i6(){return JS+=1,`v${JS}`}function Vv(r){return(r.id==null||r.id==="")&&(r.id=i6()),r.id}function Pd(r){return r==null?!1:typeof r.getScreenCTM=="function"&&r instanceof SVGElement}const qi={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},QS="1.1";function e_(r,e=document){return e.createElement(r)}function Ng(r,e=qi.xhtml,t=document){return t.createElementNS(e,r)}function Es(r,e=document){return Ng(r,qi.svg,e)}function jv(r){if(r){const t=`<svg xmlns="${qi.svg}" xmlns:xlink="${qi.xlink}" version="${QS}">${r}</svg>`,{documentElement:n}=t_(t,{async:!1});return n}const e=document.createElementNS(qi.svg,"svg");return e.setAttributeNS(qi.xmlns,"xmlns:xlink",qi.xlink),e.setAttribute("version",QS),e}function t_(r,e={}){let t;try{const n=new DOMParser;if(e.async!=null){const i=n;i.async=e.async}t=n.parseFromString(r,e.mimeType||"text/xml")}catch(n){t=void 0}if(!t||t.getElementsByTagName("parsererror").length)throw new Error(`Invalid XML: ${r}`);return t}function DC(r,e=!0){const t=r.nodeName;return e?t.toLowerCase():t.toUpperCase()}function NC(r){let e=0,t=r.previousSibling;for(;t;)t.nodeType===1&&(e+=1),t=t.previousSibling;return e}function o6(r,e){return r.querySelectorAll(e)}function RC(r,e){return r.querySelector(e)}function n_(r,e,t){const n=r.ownerSVGElement;let i=r.parentNode;for(;i&&i!==t&&i!==n;){if(Dg(i,e))return i;i=i.parentNode}return null}function kC(r,e){const t=e&&e.parentNode;return r===t||!!(t&&t.nodeType===1&&r.compareDocumentPosition(t)&16)}function bl(r){r.parentNode&&r.parentNode.removeChild(r)}function IC(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function Rg(r,e){(Array.isArray(e)?e:[e]).forEach(n=>{n!=null&&r.appendChild(n)})}function s6(r,e){const t=r.firstChild;return t?LC(t,e):Rg(r,e)}function LC(r,e){const t=r.parentNode;t&&(Array.isArray(e)?e:[e]).forEach(i=>{i!=null&&t.insertBefore(i,r)})}function a6(r,e){e!=null&&e.appendChild(r)}function Hv(r){try{return r instanceof HTMLElement}catch(e){return typeof r=="object"&&r.nodeType===1&&typeof r.style=="object"&&typeof r.ownerDocument=="object"}}function GC(r){return!r||!Hv(r)?!1:["a","button"].includes(DC(r))||r.getAttribute("role")==="button"||r.getAttribute("type")==="button"?!0:GC(r.parentNode)}function r_(r){if(DC(r)==="input"){const t=r.getAttribute("type");if(t==null||["text","password","number","email","search","tel","url"].includes(t))return!0}return!1}const i_=["viewBox","attributeName","attributeType","repeatCount"];function l6(r,e){return r.getAttribute(e)}function o_(r,e){const t=a_(e);t.ns?r.hasAttributeNS(t.ns,t.local)&&r.removeAttributeNS(t.ns,t.local):r.hasAttribute(e)&&r.removeAttribute(e)}function FC(r,e,t){if(t==null)return o_(r,e);const n=a_(e);n.ns&&typeof t=="string"?r.setAttributeNS(n.ns,e,t):e==="id"?r.id=`${t}`:r.setAttribute(e,`${t}`)}function s_(r,e){Object.keys(e).forEach(t=>{FC(r,t,e[t])})}function ei(r,e,t){if(e==null){const n=r.attributes,i={};for(let o=0;o<n.length;o+=1)i[n[o].name]=n[o].value;return i}if(typeof e=="string"&&t===void 0)return r.getAttribute(e);typeof e=="object"?s_(r,e):FC(r,e,t)}function a_(r){if(r.indexOf(":")!==-1){const e=r.split(":");return{ns:qi[e[0]],local:e[1]}}return{ns:null,local:r}}function kg(r){const e={};return Object.keys(r).forEach(t=>{const n=i_.includes(t)?t:$S(t);e[n]=r[t]}),e}function $v(r){const e={};return r.split(";").forEach(n=>{const i=n.trim();if(i){const o=i.split("=");o.length&&(e[o[0].trim()]=o[1]?o[1].trim():"")}}),e}function BC(r,e){return Object.keys(e).forEach(t=>{if(t==="class")r[t]=r[t]?`${r[t]} ${e[t]}`:e[t];else if(t==="style"){const n=typeof r[t]=="object",i=typeof e[t]=="object";let o,s;n&&i?(o=r[t],s=e[t]):n?(o=r[t],s=$v(e[t])):i?(o=$v(r[t]),s=e[t]):(o=$v(r[t]),s=$v(e[t])),r[t]=BC(o,s)}else r[t]=e[t]}),r}function c6(r,e,t={}){const n=t.offset||0,i=[],o=[];let s,a,l=null;for(let c=0;c<r.length;c+=1){s=o[c]=r[c];for(let u=0,d=e.length;u<d;u+=1){const h=e[u],f=h.start+n,p=h.end+n;c>=f&&c<p&&(typeof s=="string"?s=o[c]={t:r[c],attrs:h.attrs}:s.attrs=BC(BC({},s.attrs),h.attrs),t.includeAnnotationIndices&&(s.annotations==null&&(s.annotations=[]),s.annotations.push(u)))}a=o[c-1],a?yo.Z(s)&&yo.Z(a)?(l=l,JSON.stringify(s.attrs)===JSON.stringify(a.attrs)?l.t+=s.t:(i.push(l),l=s)):yo.Z(s)||yo.Z(a)?(l=l,i.push(l),l=s):l=(l||"")+s:l=s}return l!=null&&i.push(l),i}function mee(r,e){return r?r.filter(t=>t.start<e&&e<=t.end):[]}function vee(r,e,t){return r?r.filter(n=>e>=n.start&&e<n.end||t>n.start&&t<=n.end||n.start>=e&&n.end<t):[]}function yee(r,e,t){return r&&r.forEach(n=>{n.start<e&&n.end>=e?n.end+=t:n.start>=e&&(n.start+=t,n.end+=t)}),r}function u6(r){return r.replace(/ /g,"\xA0")}var l_;(function(r){r.emptyObject=Object.freeze({}),r.emptyArray=Object.freeze([]);function e(u){return u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"}r.isPrimitive=e;function t(u){return Array.isArray(u)}r.isArray=t;function n(u){return!e(u)&&!t(u)}r.isObject=n;function i(u,d){if(u===d)return!0;if(e(u)||e(d))return!1;const h=t(u),f=t(d);return h!==f?!1:h&&f?s(u,d):a(u,d)}r.deepEqual=i;function o(u){return e(u)?u:t(u)?l(u):c(u)}r.deepCopy=o;function s(u,d){if(u===d)return!0;if(u.length!==d.length)return!1;for(let h=0,f=u.length;h<f;h+=1)if(!i(u[h],d[h]))return!1;return!0}function a(u,d){if(u===d)return!0;for(const h in u)if(!(h in d))return!1;for(const h in d)if(!(h in u))return!1;for(const h in u)if(!i(u[h],d[h]))return!1;return!0}function l(u){const d=new Array(u.length);for(let h=0,f=u.length;h<f;h+=1)d[h]=o(u[h]);return d}function c(u){const d={};return Object.keys(u).forEach(h=>{d[h]=o(u[h])}),d}})(l_||(l_={}));var zC;(function(r){function e(c){const u="data:";return c.substr(0,u.length)===u}r.isDataUrl=e;function t(c,u){if(!c||e(c)){setTimeout(()=>u(null,c));return}const d=()=>{u(new Error(`Failed to load image: ${c}`))},h=window.FileReader?p=>{if(p.status===200){const g=new FileReader;g.onload=v=>{const y=v.target.result;u(null,y)},g.onerror=d,g.readAsDataURL(p.response)}else d()}:p=>{const g=v=>{const y=32768,x=[];for(let E=0;E<v.length;E+=y)x.push(String.fromCharCode.apply(null,v.subarray(E,E+y)));return x.join("")};if(p.status===200){let v=c.split(".").pop()||"png";v==="svg"&&(v="svg+xml");const y=`data:image/${v};base64,`,x=new Uint8Array(p.response),E=y+btoa(g(x));u(null,E)}else d()},f=new XMLHttpRequest;f.responseType=window.FileReader?"blob":"arraybuffer",f.open("GET",c,!0),f.addEventListener("error",d),f.addEventListener("load",()=>h(f)),f.send()}r.imageToDataUri=t;function n(c){let u=c.replace(/\s/g,"");u=decodeURIComponent(u);const d=u.indexOf(","),h=u.slice(0,d),f=h.split(":")[1].split(";")[0],p=u.slice(d+1);let g;h.indexOf("base64")>=0?g=atob(p):g=unescape(encodeURIComponent(p));const v=new Uint8Array(g.length);for(let y=0;y<g.length;y+=1)v[y]=g.charCodeAt(y);return new Blob([v],{type:f})}r.dataUriToBlob=n;function i(c,u){const d=window.navigator.msSaveBlob;if(d)d(c,u);else{const h=window.URL.createObjectURL(c),f=document.createElement("a");f.href=h,f.download=u,document.body.appendChild(f),f.click(),document.body.removeChild(f),window.URL.revokeObjectURL(h)}}r.downloadBlob=i;function o(c,u){const d=n(c);i(d,u)}r.downloadDataUri=o;function s(c){const u=c.match(/<svg[^>]*viewBox\s*=\s*(["']?)(.+?)\1[^>]*>/i);return u&&u[2]?u[2].replace(/\s+/," ").split(" "):null}function a(c){const u=parseFloat(c);return Number.isNaN(u)?null:u}function l(c,u={}){let d=null;const h=E=>(d==null&&(d=s(c)),d!=null?a(d[E]):null),f=E=>{const T=c.match(E);return T&&T[2]?a(T[2]):null};let p=u.width;if(p==null&&(p=f(/<svg[^>]*width\s*=\s*(["']?)(.+?)\1[^>]*>/i)),p==null&&(p=h(2)),p==null)throw new Error("Can not parse width from svg string");let g=u.height;if(g==null&&(g=f(/<svg[^>]*height\s*=\s*(["']?)(.+?)\1[^>]*>/i)),g==null&&(g=h(3)),g==null)throw new Error("Can not parse height from svg string");return`data:image/svg+xml,${encodeURIComponent(c).replace(/'/g,"%27").replace(/"/g,"%22")}`}r.svgToDataUrl=l})(zC||(zC={}));let Od;const d6={px(r){return r},mm(r){return Od*r},cm(r){return Od*r*10},in(r){return Od*r*25.4},pt(r){return Od*(25.4*r/72)},pc(r){return Od*(25.4*r/6)}};var UC;(function(r){function e(n,i,o){const s=jr()("<div/>").css({display:"inline-block",position:"absolute",left:-15e3,top:-15e3,width:n+(o||""),height:i+(o||"")}).appendTo(document.body),a={width:s.width()||0,height:s.height()||0};return s.remove(),a}r.measure=e;function t(n,i){Od==null&&(Od=e("1","1","mm").width);const o=i?d6[i]:null;return o?o(n):n}r.toPx=t})(UC||(UC={}));const VC=function(){let r;const e=window;if(e!=null&&(r=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame,r!=null&&(r=r.bind(e))),r==null){let t=0;r=n=>{const i=new Date().getTime(),o=Math.max(0,16-(i-t)),s=setTimeout(()=>{n(i+o)},o);return t=i+o,s}}return r}(),jC=function(){let r;const e=window;return e!=null&&(r=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.msCancelAnimationFrame||e.msCancelRequestAnimationFrame||e.oCancelAnimationFrame||e.oCancelRequestAnimationFrame||e.mozCancelAnimationFrame||e.mozCancelRequestAnimationFrame,r&&(r=r.bind(e))),r==null&&(r=clearTimeout),r}(),h6=/-(.)/g;function f6(r){return r.replace(h6,(e,t)=>t.toUpperCase())}const HC={},c_=["Webkit","ms","Moz","O"],u_=document?document.createElement("div").style:{};function p6(r){for(let e=0;e<c_.length;e+=1){const t=c_[e]+r;if(t in u_)return t}return null}function g6(r){const e=f6(r);if(HC[e]==null){const t=e.charAt(0).toUpperCase()+e.slice(1);HC[e]=e in u_?e:p6(t)}return HC[e]}function bee(r,e,t){const n=g6(e);n!=null&&(r[n]=t),r[e]=t}function $C(r,e){const t=r.ownerDocument&&r.ownerDocument.defaultView&&r.ownerDocument.defaultView.opener?r.ownerDocument.defaultView.getComputedStyle(r,null):window.getComputedStyle(r,null);return t&&e?t.getPropertyValue(e)||t[e]:t}function xee(r){const e=$C(r);return e!=null&&(e.overflow==="scroll"||e.overflow==="auto")}const Cee=function(){const r=document;return r.selection?function(){r.selection.empty()}:window.getSelection?function(){const e=window.getSelection();e&&(e.empty?e.empty():e.removeAllRanges&&e.removeAllRanges())}:function(){}}();var Rr;(function(r){function e(n){return 180*n/Math.PI%360}r.toDeg=e,r.toRad=function(n,i=!1){return(i?n:n%360)*Math.PI/180};function t(n){return n%360+(n<0?360:0)}r.normalize=t})(Rr||(Rr={}));function Dd(r,e=0){return Number.isInteger(r)?r:+r.toFixed(e)}function d_(r,e){let t,n;if(e==null?(n=r==null?1:r,t=0):(n=e,t=r==null?0:r),n<t){const i=t;t=n,n=i}return Math.floor(Math.random()*(n-t+1)+t)}function bf(r,e,t){return Number.isNaN(r)?NaN:Number.isNaN(e)||Number.isNaN(t)?0:e<t?r<e?e:r>t?t:r:r<t?t:r>e?e:r}function WC(r,e){return e*Math.round(r/e)}function h_(r,e){return e!=null&&r!=null&&e.x>=r.x&&e.x<=r.x+r.width&&e.y>=r.y&&e.y<=r.y+r.height}function f_(r,e){const t=r.x-e.x,n=r.y-e.y;return t*t+n*n}class eu{valueOf(){return this.toJSON()}toString(){return JSON.stringify(this.toJSON())}}class pe extends eu{constructor(e,t){super();this.x=e==null?0:e,this.y=t==null?0:t}get[Symbol.toStringTag](){return pe.toStringTag}round(e=0){return this.x=Dd(this.x,e),this.y=Dd(this.y,e),this}add(e,t){const n=pe.create(e,t);return this.x+=n.x,this.y+=n.y,this}update(e,t){const n=pe.create(e,t);return this.x=n.x,this.y=n.y,this}translate(e,t){const n=pe.create(e,t);return this.x+=n.x,this.y+=n.y,this}rotate(e,t){const n=pe.rotate(this,e,t);return this.x=n.x,this.y=n.y,this}scale(e,t,n=new pe){const i=pe.create(n);return this.x=i.x+e*(this.x-i.x),this.y=i.y+t*(this.y-i.y),this}closest(e){if(e.length===1)return pe.create(e[0]);let t=null,n=Infinity;return e.forEach(i=>{const o=this.squaredDistance(i);o<n&&(t=i,n=o)}),t?pe.create(t):null}distance(e){return Math.sqrt(this.squaredDistance(e))}squaredDistance(e){const t=pe.create(e),n=this.x-t.x,i=this.y-t.y;return n*n+i*i}manhattanDistance(e){const t=pe.create(e);return Math.abs(t.x-this.x)+Math.abs(t.y-this.y)}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)||.01}theta(e=new pe){const t=pe.create(e),n=-(t.y-this.y),i=t.x-this.x;let o=Math.atan2(n,i);return o<0&&(o=2*Math.PI+o),180*o/Math.PI}angleBetween(e,t){if(this.equals(e)||this.equals(t))return NaN;let n=this.theta(t)-this.theta(e);return n<0&&(n+=360),n}vectorAngle(e){return new pe(0,0).angleBetween(this,e)}toPolar(e){return this.update(pe.toPolar(this,e)),this}changeInAngle(e,t,n=new pe){return this.clone().translate(-e,-t).theta(n)-this.theta(n)}adhereToRect(e){return h_(e,this)||(this.x=Math.min(Math.max(this.x,e.x),e.x+e.width),this.y=Math.min(Math.max(this.y,e.y),e.y+e.height)),this}bearing(e){const t=pe.create(e),n=Rr.toRad(this.y),i=Rr.toRad(t.y),o=this.x,s=t.x,a=Rr.toRad(s-o),l=Math.sin(a)*Math.cos(i),c=Math.cos(n)*Math.sin(i)-Math.sin(n)*Math.cos(i)*Math.cos(a),u=Rr.toDeg(Math.atan2(l,c)),d=["NE","E","SE","S","SW","W","NW","N"];let h=u-22.5;return h<0&&(h+=360),h=parseInt(h/45,10),d[h]}cross(e,t){if(e!=null&&t!=null){const n=pe.create(e),i=pe.create(t);return(i.x-this.x)*(n.y-this.y)-(i.y-this.y)*(n.x-this.x)}return NaN}dot(e){const t=pe.create(e);return this.x*t.x+this.y*t.y}diff(e,t){if(typeof e=="number")return new pe(this.x-e,this.y-t);const n=pe.create(e);return new pe(this.x-n.x,this.y-n.y)}lerp(e,t){const n=pe.create(e);return new pe((1-t)*this.x+t*n.x,(1-t)*this.y+t*n.y)}normalize(e=1){const t=e/this.magnitude();return this.scale(t,t)}move(e,t){const n=pe.create(e),i=Rr.toRad(n.theta(this));return this.translate(Math.cos(i)*t,-Math.sin(i)*t)}reflection(e){return pe.create(e).move(this,this.distance(e))}snapToGrid(e,t){return this.x=WC(this.x,e),this.y=WC(this.y,t==null?e:t),this}equals(e){const t=pe.create(e);return t!=null&&t.x===this.x&&t.y===this.y}clone(){return pe.clone(this)}toJSON(){return pe.toJSON(this)}serialize(){return`${this.x} ${this.y}`}}(function(r){r.toStringTag=`X6.Geometry.${r.name}`;function e(t){if(t==null)return!1;if(t instanceof r)return!0;const n=t[Symbol.toStringTag],i=t;return(n==null||n===r.toStringTag)&&typeof i.x=="number"&&typeof i.y=="number"&&typeof i.toPolar=="function"}r.isPoint=e})(pe||(pe={})),function(r){function e(n){return n!=null&&typeof n=="object"&&typeof n.x=="number"&&typeof n.y=="number"}r.isPointLike=e;function t(n){return n!=null&&Array.isArray(n)&&n.length===2&&typeof n[0]=="number"&&typeof n[1]=="number"}r.isPointData=t}(pe||(pe={})),function(r){function e(d,h){return d==null||typeof d=="number"?new r(d,h):t(d)}r.create=e;function t(d){return r.isPoint(d)?new r(d.x,d.y):Array.isArray(d)?new r(d[0],d[1]):new r(d.x,d.y)}r.clone=t;function n(d){return r.isPoint(d)?{x:d.x,y:d.y}:Array.isArray(d)?{x:d[0],y:d[1]}:{x:d.x,y:d.y}}r.toJSON=n;function i(d,h,f=new r){let p=Math.abs(d*Math.cos(h)),g=Math.abs(d*Math.sin(h));const v=t(f),y=Rr.normalize(Rr.toDeg(h));return y<90?g=-g:y<180?(p=-p,g=-g):y<270&&(p=-p),new r(v.x+p,v.y+g)}r.fromPolar=i;function o(d,h=new r){const f=t(d),p=t(h),g=f.x-p.x,v=f.y-p.y;return new r(Math.sqrt(g*g+v*v),Rr.toRad(p.theta(f)))}r.toPolar=o;function s(d,h){return d===h?!0:d!=null&&h!=null?d.x===h.x&&d.y===h.y:!1}r.equals=s;function a(d,h){if(d==null&&h!=null||d!=null&&h==null||d!=null&&h!=null&&d.length!==h.length)return!1;if(d!=null&&h!=null){for(let f=0,p=d.length;f<p;f+=1)if(!s(d[f],h[f]))return!1}return!0}r.equalPoints=a;function l(d,h,f,p){return new r(d_(d,h),d_(f,p))}r.random=l;function c(d,h,f){const p=Rr.toRad(Rr.normalize(-h)),g=Math.sin(p),v=Math.cos(p);return u(d,v,g,f)}r.rotate=c;function u(d,h,f,p=new r){const g=t(d),v=t(p),y=g.x-v.x,x=g.y-v.y,E=y*h-x*f,T=x*h+y*f;return new r(E+v.x,T+v.y)}r.rotateEx=u}(pe||(pe={}));class Ht extends eu{constructor(e,t,n,i){super();this.x=e==null?0:e,this.y=t==null?0:t,this.width=n==null?0:n,this.height=i==null?0:i}get[Symbol.toStringTag](){return Ht.toStringTag}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get origin(){return new pe(this.x,this.y)}get topLeft(){return new pe(this.x,this.y)}get topCenter(){return new pe(this.x+this.width/2,this.y)}get topRight(){return new pe(this.x+this.width,this.y)}get center(){return new pe(this.x+this.width/2,this.y+this.height/2)}get bottomLeft(){return new pe(this.x,this.y+this.height)}get bottomCenter(){return new pe(this.x+this.width/2,this.y+this.height)}get bottomRight(){return new pe(this.x+this.width,this.y+this.height)}get corner(){return new pe(this.x+this.width,this.y+this.height)}get rightMiddle(){return new pe(this.x+this.width,this.y+this.height/2)}get leftMiddle(){return new pe(this.x,this.y+this.height/2)}get topLine(){return new xn(this.topLeft,this.topRight)}get rightLine(){return new xn(this.topRight,this.bottomRight)}get bottomLine(){return new xn(this.bottomLeft,this.bottomRight)}get leftLine(){return new xn(this.topLeft,this.bottomLeft)}getOrigin(){return this.origin}getTopLeft(){return this.topLeft}getTopCenter(){return this.topCenter}getTopRight(){return this.topRight}getCenter(){return this.center}getCenterX(){return this.x+this.width/2}getCenterY(){return this.y+this.height/2}getBottomLeft(){return this.bottomLeft}getBottomCenter(){return this.bottomCenter}getBottomRight(){return this.bottomRight}getCorner(){return this.corner}getRightMiddle(){return this.rightMiddle}getLeftMiddle(){return this.leftMiddle}getTopLine(){return this.topLine}getRightLine(){return this.rightLine}getBottomLine(){return this.bottomLine}getLeftLine(){return this.leftLine}bbox(e){if(!e)return this.clone();const t=Rr.toRad(e),n=Math.abs(Math.sin(t)),i=Math.abs(Math.cos(t)),o=this.width*i+this.height*n,s=this.width*n+this.height*i;return new Ht(this.x+(this.width-o)/2,this.y+(this.height-s)/2,o,s)}round(e=0){return this.x=Dd(this.x,e),this.y=Dd(this.y,e),this.width=Dd(this.width,e),this.height=Dd(this.height,e),this}add(e,t,n,i){const o=Ht.create(e,t,n,i),s=Math.min(this.x,o.x),a=Math.min(this.y,o.y),l=Math.max(this.x+this.width,o.x+o.width),c=Math.max(this.y+this.height,o.y+o.height);return this.x=s,this.y=a,this.width=l-s,this.height=c-a,this}update(e,t,n,i){const o=Ht.create(e,t,n,i);return this.x=o.x,this.y=o.y,this.width=o.width,this.height=o.height,this}inflate(e,t){const n=e,i=t!=null?t:e;return this.x-=n,this.y-=i,this.width+=2*n,this.height+=2*i,this}snapToGrid(e,t){const n=this.origin.snapToGrid(e,t),i=this.corner.snapToGrid(e,t);return this.x=n.x,this.y=n.y,this.width=i.x-n.x,this.height=i.y-n.y,this}translate(e,t){const n=pe.create(e,t);return this.x+=n.x,this.y+=n.y,this}scale(e,t,n=new pe){const i=this.origin.scale(e,t,n);return this.x=i.x,this.y=i.y,this.width*=e,this.height*=t,this}rotate(e,t=this.getCenter()){if(e!==0){const n=Rr.toRad(e),i=Math.cos(n),o=Math.sin(n);let s=this.getOrigin(),a=this.getTopRight(),l=this.getBottomRight(),c=this.getBottomLeft();s=pe.rotateEx(s,i,o,t),a=pe.rotateEx(a,i,o,t),l=pe.rotateEx(l,i,o,t),c=pe.rotateEx(c,i,o,t);const u=new Ht(s.x,s.y,0,0);u.add(a.x,a.y,0,0),u.add(l.x,l.y,0,0),u.add(c.x,c.y,0,0),this.update(u)}return this}rotate90(){const e=(this.width-this.height)/2;this.x+=e,this.y-=e;const t=this.width;return this.width=this.height,this.height=t,this}moveAndExpand(e){const t=Ht.clone(e);return this.x+=t.x||0,this.y+=t.y||0,this.width+=t.width||0,this.height+=t.height||0,this}getMaxScaleToFit(e,t=this.center){const n=Ht.clone(e),i=t.x,o=t.y;let s=Infinity,a=Infinity,l=Infinity,c=Infinity,u=Infinity,d=Infinity,h=Infinity,f=Infinity;const p=n.topLeft;p.x<i&&(s=(this.x-i)/(p.x-i)),p.y<o&&(u=(this.y-o)/(p.y-o));const g=n.bottomRight;g.x>i&&(a=(this.x+this.width-i)/(g.x-i)),g.y>o&&(d=(this.y+this.height-o)/(g.y-o));const v=n.topRight;v.x>i&&(l=(this.x+this.width-i)/(v.x-i)),v.y<o&&(h=(this.y-o)/(v.y-o));const y=n.bottomLeft;return y.x<i&&(c=(this.x-i)/(y.x-i)),y.y>o&&(f=(this.y+this.height-o)/(y.y-o)),{sx:Math.min(s,a,l,c),sy:Math.min(u,d,h,f)}}getMaxUniformScaleToFit(e,t=this.center){const n=this.getMaxScaleToFit(e,t);return Math.min(n.sx,n.sy)}containsPoint(e,t){return h_(this,pe.create(e,t))}containsRect(e,t,n,i){const o=Ht.create(e,t,n,i),s=this.x,a=this.y,l=this.width,c=this.height,u=o.x,d=o.y,h=o.width,f=o.height;return l===0||c===0||h===0||f===0?!1:u>=s&&d>=a&&u+h<=s+l&&d+f<=a+c}intersectsWithLine(e){const t=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],n=[],i=[];return t.forEach(o=>{const s=e.intersectsWithLine(o);s!==null&&i.indexOf(s.toString())<0&&(n.push(s),i.push(s.toString()))}),n.length>0?n:null}intersectsWithLineFromCenterToPoint(e,t){const n=pe.clone(e),i=this.center;let o=null;t!=null&&t!==0&&n.rotate(t,i);const s=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],a=new xn(i,n);for(let l=s.length-1;l>=0;l-=1){const c=s[l].intersectsWithLine(a);if(c!==null){o=c;break}}return o&&t!=null&&t!==0&&o.rotate(-t,i),o}intersectsWithRect(e,t,n,i){const o=Ht.create(e,t,n,i);if(!this.isIntersectWithRect(o))return null;const s=this.origin,a=this.corner,l=o.origin,c=o.corner,u=Math.max(s.x,l.x),d=Math.max(s.y,l.y);return new Ht(u,d,Math.min(a.x,c.x)-u,Math.min(a.y,c.y)-d)}isIntersectWithRect(e,t,n,i){const o=Ht.create(e,t,n,i),s=this.origin,a=this.corner,l=o.origin,c=o.corner;return!(c.x<=s.x||c.y<=s.y||l.x>=a.x||l.y>=a.y)}normalize(){let e=this.x,t=this.y,n=this.width,i=this.height;return this.width<0&&(e=this.x+this.width,n=-this.width),this.height<0&&(t=this.y+this.height,i=-this.height),this.x=e,this.y=t,this.width=n,this.height=i,this}union(e){const t=Ht.clone(e),n=this.origin,i=this.corner,o=t.origin,s=t.corner,a=Math.min(n.x,o.x),l=Math.min(n.y,o.y),c=Math.max(i.x,s.x),u=Math.max(i.y,s.y);return new Ht(a,l,c-a,u-l)}getNearestSideToPoint(e){const t=pe.clone(e),n=t.x-this.x,i=this.x+this.width-t.x,o=t.y-this.y,s=this.y+this.height-t.y;let a=n,l="left";return i<a&&(a=i,l="right"),o<a&&(a=o,l="top"),s<a&&(l="bottom"),l}getNearestPointToPoint(e){const t=pe.clone(e);if(this.containsPoint(t))switch(this.getNearestSideToPoint(t)){case"right":return new pe(this.x+this.width,t.y);case"left":return new pe(this.x,t.y);case"bottom":return new pe(t.x,this.y+this.height);case"top":return new pe(t.x,this.y);default:break}return t.adhereToRect(this)}equals(e){return e!=null&&e.x===this.x&&e.y===this.y&&e.width===this.width&&e.height===this.height}clone(){return new Ht(this.x,this.y,this.width,this.height)}toJSON(){return{x:this.x,y:this.y,width:this.width,height:this.height}}serialize(){return`${this.x} ${this.y} ${this.width} ${this.height}`}}(function(r){r.toStringTag=`X6.Geometry.${r.name}`;function e(t){if(t==null)return!1;if(t instanceof r)return!0;const n=t[Symbol.toStringTag],i=t;return(n==null||n===r.toStringTag)&&typeof i.x=="number"&&typeof i.y=="number"&&typeof i.width=="number"&&typeof i.height=="number"&&typeof i.inflate=="function"&&typeof i.moveAndExpand=="function"}r.isRectangle=e})(Ht||(Ht={})),function(r){function e(t){return t!=null&&typeof t=="object"&&typeof t.x=="number"&&typeof t.y=="number"&&typeof t.width=="number"&&typeof t.height=="number"}r.isRectangleLike=e}(Ht||(Ht={})),function(r){function e(s,a,l,c){return s==null||typeof s=="number"?new r(s,a,l,c):t(s)}r.create=e;function t(s){return r.isRectangle(s)?s.clone():Array.isArray(s)?new r(s[0],s[1],s[2],s[3]):new r(s.x,s.y,s.width,s.height)}r.clone=t;function n(s){return new r(0,0,s.width,s.height)}r.fromSize=n;function i(s,a){return new r(s.x,s.y,a.width,a.height)}r.fromPositionAndSize=i;function o(s){return new r(s.x-s.a,s.y-s.b,2*s.a,2*s.b)}r.fromEllipse=o}(Ht||(Ht={}));class xn extends eu{constructor(e,t,n,i){super();typeof e=="number"&&typeof t=="number"?(this.start=new pe(e,t),this.end=new pe(n,i)):(this.start=pe.create(e),this.end=pe.create(t))}get[Symbol.toStringTag](){return xn.toStringTag}get center(){return new pe((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)}getCenter(){return this.center}round(e=0){return this.start.round(e),this.end.round(e),this}translate(e,t){return typeof e=="number"?(this.start.translate(e,t),this.end.translate(e,t)):(this.start.translate(e),this.end.translate(e)),this}rotate(e,t){return this.start.rotate(e,t),this.end.rotate(e,t),this}scale(e,t,n){return this.start.scale(e,t,n),this.end.scale(e,t,n),this}length(){return Math.sqrt(this.squaredLength())}squaredLength(){const e=this.start.x-this.end.x,t=this.start.y-this.end.y;return e*e+t*t}setLength(e){const t=this.length();if(!t)return this;const n=e/t;return this.scale(n,n,this.start)}parallel(e){const t=this.clone();if(!t.isDifferentiable())return t;const{start:n,end:i}=t,o=n.clone().rotate(270,i),s=i.clone().rotate(90,n);return n.move(s,e),i.move(o,e),t}vector(){return new pe(this.end.x-this.start.x,this.end.y-this.start.y)}angle(){const e=new pe(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,e)}bbox(){const e=Math.min(this.start.x,this.end.x),t=Math.min(this.start.y,this.end.y),n=Math.max(this.start.x,this.end.x),i=Math.max(this.start.y,this.end.y);return new Ht(e,t,n-e,i-t)}bearing(){return this.start.bearing(this.end)}closestPoint(e){return this.pointAt(this.closestPointNormalizedLength(e))}closestPointLength(e){return this.closestPointNormalizedLength(e)*this.length()}closestPointTangent(e){return this.tangentAt(this.closestPointNormalizedLength(e))}closestPointNormalizedLength(e){const t=this.vector().dot(new xn(this.start,e).vector()),n=Math.min(1,Math.max(0,t/this.squaredLength()));return Number.isNaN(n)?0:n}pointAt(e){const t=this.start,n=this.end;return e<=0?t.clone():e>=1?n.clone():t.lerp(n,e)}pointAtLength(e){const t=this.start,n=this.end;let i=!0;e<0&&(i=!1,e=-e);const o=this.length();if(e>=o)return i?n.clone():t.clone();const s=(i?e:o-e)/o;return this.pointAt(s)}divideAt(e){const t=this.pointAt(e);return[new xn(this.start,t),new xn(t,this.end)]}divideAtLength(e){const t=this.pointAtLength(e);return[new xn(this.start,t),new xn(t,this.end)]}containsPoint(e){const t=this.start,n=this.end;if(t.cross(e,n)!==0)return!1;const i=this.length();return!(new xn(t,e).length()>i||new xn(e,n).length()>i)}intersect(e,t){const n=e.intersectsWithLine(this,t);return n?Array.isArray(n)?n:[n]:null}intersectsWithLine(e){const t=new pe(this.end.x-this.start.x,this.end.y-this.start.y),n=new pe(e.end.x-e.start.x,e.end.y-e.start.y),i=t.x*n.y-t.y*n.x,o=new pe(e.start.x-this.start.x,e.start.y-this.start.y),s=o.x*n.y-o.y*n.x,a=o.x*t.y-o.y*t.x;if(i===0||s*i<0||a*i<0)return null;if(i>0){if(s>i||a>i)return null}else if(s<i||a<i)return null;return new pe(this.start.x+s*t.x/i,this.start.y+s*t.y/i)}isDifferentiable(){return!this.start.equals(this.end)}pointOffset(e){const t=pe.clone(e),n=this.start,i=this.end;return((i.x-n.x)*(t.y-n.y)-(i.y-n.y)*(t.x-n.x))/this.length()}pointSquaredDistance(e,t){const n=pe.create(e,t);return this.closestPoint(n).squaredDistance(n)}pointDistance(e,t){const n=pe.create(e,t);return this.closestPoint(n).distance(n)}tangentAt(e){if(!this.isDifferentiable())return null;const t=this.start,n=this.end,i=this.pointAt(e),o=new xn(t,n);return o.translate(i.x-t.x,i.y-t.y),o}tangentAtLength(e){if(!this.isDifferentiable())return null;const t=this.start,n=this.end,i=this.pointAtLength(e),o=new xn(t,n);return o.translate(i.x-t.x,i.y-t.y),o}relativeCcw(e,t){const n=pe.create(e,t);let i=n.x-this.start.x,o=n.y-this.start.y;const s=this.end.x-this.start.x,a=this.end.y-this.start.y;let l=i*a-o*s;return l===0&&(l=i*s+o*a,l>0&&(i-=s,o-=a,l=i*s+o*a,l<0&&(l=0))),l<0?-1:l>0?1:0}equals(e){return e!=null&&this.start.x===e.start.x&&this.start.y===e.start.y&&this.end.x===e.end.x&&this.end.y===e.end.y}clone(){return new xn(this.start,this.end)}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.end.serialize()].join(" ")}}(function(r){r.toStringTag=`X6.Geometry.${r.name}`;function e(t){if(t==null)return!1;if(t instanceof r)return!0;const n=t[Symbol.toStringTag],i=t;try{if((n==null||n===r.toStringTag)&&pe.isPoint(i.start)&&pe.isPoint(i.end)&&typeof i.vector=="function"&&typeof i.bearing=="function"&&typeof i.parallel=="function"&&typeof i.intersect=="function")return!0}catch(o){return!1}return!1}r.isLine=e})(xn||(xn={}));class va extends eu{constructor(e,t,n,i){super();this.x=e==null?0:e,this.y=t==null?0:t,this.a=n==null?0:n,this.b=i==null?0:i}get[Symbol.toStringTag](){return va.toStringTag}get center(){return new pe(this.x,this.y)}bbox(){return Ht.fromEllipse(this)}getCenter(){return this.center}inflate(e,t){const n=e,i=t!=null?t:e;return this.a+=2*n,this.b+=2*i,this}normalizedDistance(e,t){const n=pe.create(e,t),i=n.x-this.x,o=n.y-this.y,s=this.a,a=this.b;return i*i/(s*s)+o*o/(a*a)}containsPoint(e,t){return this.normalizedDistance(e,t)<=1}intersectsWithLine(e){const t=[],n=this.a,i=this.b,o=e.start,s=e.end,a=e.vector(),l=o.diff(new pe(this.x,this.y)),c=new pe(a.x/(n*n),a.y/(i*i)),u=new pe(l.x/(n*n),l.y/(i*i)),d=a.dot(c),h=a.dot(u),f=l.dot(u)-1,p=h*h-d*f;if(p<0)return null;if(p>0){const g=Math.sqrt(p),v=(-h-g)/d,y=(-h+g)/d;if((v<0||v>1)&&(y<0||y>1))return null;v>=0&&v<=1&&t.push(o.lerp(s,v)),y>=0&&y<=1&&t.push(o.lerp(s,y))}else{const g=-h/d;if(g>=0&&g<=1)t.push(o.lerp(s,g));else return null}return t}intersectsWithLineFromCenterToPoint(e,t=0){const n=pe.clone(e);t&&n.rotate(t,this.getCenter());const i=n.x-this.x,o=n.y-this.y;let s;if(i===0)return s=this.bbox().getNearestPointToPoint(n),t?s.rotate(-t,this.getCenter()):s;const a=o/i,l=a*a,c=this.a*this.a,u=this.b*this.b;let d=Math.sqrt(1/(1/c+l/u));d=i<0?-d:d;const h=a*d;return s=new pe(this.x+d,this.y+h),t?s.rotate(-t,this.getCenter()):s}tangentTheta(e){const t=pe.clone(e),n=t.x,i=t.y,o=this.a,s=this.b,a=this.bbox().center,l=a.x,c=a.y,u=30,d=n>a.x+o/2,h=n<a.x-o/2;let f,p;return d||h?(p=n>a.x?i-u:i+u,f=o*o/(n-l)-o*o*(i-c)*(p-c)/(s*s*(n-l))+l):(f=i>a.y?n+u:n-u,p=s*s/(i-c)-s*s*(n-l)*(f-l)/(o*o*(i-c))+c),new pe(f,p).theta(t)}scale(e,t){return this.a*=e,this.b*=t,this}rotate(e,t){const n=Ht.fromEllipse(this);n.rotate(e,t);const i=va.fromRect(n);return this.a=i.a,this.b=i.b,this.x=i.x,this.y=i.y,this}translate(e,t){const n=pe.create(e,t);return this.x+=n.x,this.y+=n.y,this}equals(e){return e!=null&&e.x===this.x&&e.y===this.y&&e.a===this.a&&e.b===this.b}clone(){return new va(this.x,this.y,this.a,this.b)}toJSON(){return{x:this.x,y:this.y,a:this.a,b:this.b}}serialize(){return`${this.x} ${this.y} ${this.a} ${this.b}`}}(function(r){r.toStringTag=`X6.Geometry.${r.name}`;function e(t){if(t==null)return!1;if(t instanceof r)return!0;const n=t[Symbol.toStringTag],i=t;return(n==null||n===r.toStringTag)&&typeof i.x=="number"&&typeof i.y=="number"&&typeof i.a=="number"&&typeof i.b=="number"&&typeof i.inflate=="function"&&typeof i.normalizedDistance=="function"}r.isEllipse=e})(va||(va={})),function(r){function e(i,o,s,a){return i==null||typeof i=="number"?new r(i,o,s,a):t(i)}r.create=e;function t(i){return r.isEllipse(i)?i.clone():Array.isArray(i)?new r(i[0],i[1],i[2],i[3]):new r(i.x,i.y,i.a,i.b)}r.parse=t;function n(i){const o=i.center;return new r(o.x,o.y,i.width/2,i.height/2)}r.fromRect=n}(va||(va={}));class so extends eu{constructor(e){super();if(e!=null){if(typeof e=="string")return so.parse(e);this.points=e.map(t=>pe.create(t))}else this.points=[]}get[Symbol.toStringTag](){return so.toStringTag}get start(){return this.points.length===0?null:this.points[0]}get end(){return this.points.length===0?null:this.points[this.points.length-1]}scale(e,t,n=new pe){return this.points.forEach(i=>i.scale(e,t,n)),this}rotate(e,t){return this.points.forEach(n=>n.rotate(e,t)),this}translate(e,t){const n=pe.create(e,t);return this.points.forEach(i=>i.translate(n.x,n.y)),this}bbox(){if(this.points.length===0)return new Ht;let e=Infinity,t=-Infinity,n=Infinity,i=-Infinity;const o=this.points;for(let s=0,a=o.length;s<a;s+=1){const l=o[s],c=l.x,u=l.y;c<e&&(e=c),c>t&&(t=c),u<n&&(n=u),u>i&&(i=u)}return new Ht(e,n,t-e,i-n)}closestPoint(e){const t=this.closestPointLength(e);return this.pointAtLength(t)}closestPointLength(e){const t=this.points,n=t.length;if(n===0||n===1)return 0;let i=0,o=0,s=Infinity;for(let a=0,l=n-1;a<l;a+=1){const c=new xn(t[a],t[a+1]),u=c.length(),d=c.closestPointNormalizedLength(e),f=c.pointAt(d).squaredDistance(e);f<s&&(s=f,o=i+d*u),i+=u}return o}closestPointNormalizedLength(e){const t=this.closestPointLength(e);if(t===0)return 0;const n=this.length();return n===0?0:t/n}closestPointTangent(e){const t=this.closestPointLength(e);return this.tangentAtLength(t)}containsPoint(e){if(this.points.length===0)return!1;const t=pe.clone(e),n=t.x,i=t.y,o=this.points,s=o.length;let a=s-1,l=0;for(let c=0;c<s;c+=1){const u=o[a],d=o[c];if(t.equals(u))return!0;const h=new xn(u,d);if(h.containsPoint(e))return!0;if(i<=u.y&&i>d.y||i>u.y&&i<=d.y){const f=u.x-n>d.x-n?u.x-n:d.x-n;if(f>=0){const p=new pe(n+f,i),g=new xn(e,p);h.intersectsWithLine(g)&&(l+=1)}}a=c}return l%2==1}intersectsWithLine(e){const t=[];for(let n=0,i=this.points.length-1;n<i;n+=1){const o=this.points[n],s=this.points[n+1],a=e.intersectsWithLine(new xn(o,s));a&&t.push(a)}return t.length>0?t:null}isDifferentiable(){for(let e=0,t=this.points.length-1;e<t;e+=1){const n=this.points[e],i=this.points[e+1];if(new xn(n,i).isDifferentiable())return!0}return!1}length(){let e=0;for(let t=0,n=this.points.length-1;t<n;t+=1){const i=this.points[t],o=this.points[t+1];e+=i.distance(o)}return e}pointAt(e){const t=this.points,n=t.length;if(n===0)return null;if(n===1||e<=0)return t[0].clone();if(e>=1)return t[n-1].clone();const o=this.length()*e;return this.pointAtLength(o)}pointAtLength(e){const t=this.points,n=t.length;if(n===0)return null;if(n===1)return t[0].clone();let i=!0;e<0&&(i=!1,e=-e);let o=0;for(let a=0,l=n-1;a<l;a+=1){const c=i?a:l-1-a,u=t[c],d=t[c+1],h=new xn(u,d),f=u.distance(d);if(e<=o+f)return h.pointAtLength((i?1:-1)*(e-o));o+=f}return(i?t[n-1]:t[0]).clone()}tangentAt(e){const n=this.points.length;if(n===0||n===1)return null;e<0&&(e=0),e>1&&(e=1);const o=this.length()*e;return this.tangentAtLength(o)}tangentAtLength(e){const t=this.points,n=t.length;if(n===0||n===1)return null;let i=!0;e<0&&(i=!1,e=-e);let o,s=0;for(let a=0,l=n-1;a<l;a+=1){const c=i?a:l-1-a,u=t[c],d=t[c+1],h=new xn(u,d),f=u.distance(d);if(h.isDifferentiable()){if(e<=s+f)return h.tangentAtLength((i?1:-1)*(e-s));o=h}s+=f}if(o){const a=i?1:0;return o.tangentAt(a)}return null}simplify(e={}){const t=this.points;if(t.length<3)return this;const n=e.threshold||0;let i=0;for(;t[i+2];){const o=i,s=i+1,a=i+2,l=t[o],c=t[s],u=t[a];new xn(l,u).closestPoint(c).distance(c)<=n?t.splice(s,1):i+=1}return this}toHull(){const e=this.points,t=e.length;if(t===0)return new so;let n=e[0];for(let h=1;h<t;h+=1)(e[h].y<n.y||e[h].y===n.y&&e[h].x>n.x)&&(n=e[h]);const i=[];for(let h=0;h<t;h+=1){let f=n.theta(e[h]);f===0&&(f=360),i.push([e[h],h,f])}if(i.sort((h,f)=>{let p=h[2]-f[2];return p===0&&(p=f[1]-h[1]),p}),i.length>2){const h=i[i.length-1];i.unshift(h)}const o={},s=[],a=h=>`${h[0].toString()}@${h[1]}`;for(;i.length!==0;){const h=i.pop(),f=h[0];if(o[a(h)])continue;let p=!1;for(;!p;)if(s.length<2)s.push(h),p=!0;else{const g=s.pop(),v=g[0],y=s.pop(),x=y[0],E=x.cross(v,f);if(E<0)s.push(y),s.push(g),s.push(h),p=!0;else if(E===0){const T=1e-10,P=v.angleBetween(x,f);Math.abs(P-180)<T||v.equals(f)||x.equals(v)?(o[a(g)]=v,s.push(y)):Math.abs((P+1)%360-1)<T&&(s.push(y),i.push(g))}else o[a(g)]=v,s.push(y)}}s.length>2&&s.pop();let l,c=-1;for(let h=0,f=s.length;h<f;h+=1){const p=s[h][1];(l===void 0||p<l)&&(l=p,c=h)}let u=[];if(c>0){const h=s.slice(c),f=s.slice(0,c);u=h.concat(f)}else u=s;const d=[];for(let h=0,f=u.length;h<f;h+=1)d.push(u[h][0]);return new so(d)}equals(e){return e==null||e.points.length!==this.points.length?!1:e.points.every((t,n)=>t.equals(this.points[n]))}clone(){return new so(this.points.map(e=>e.clone()))}toJSON(){return this.points.map(e=>e.toJSON())}serialize(){return this.points.map(e=>`${e.x}, ${e.y}`).join(" ")}}(function(r){r.toStringTag=`X6.Geometry.${r.name}`;function e(t){if(t==null)return!1;if(t instanceof r)return!0;const n=t[Symbol.toStringTag],i=t;return(n==null||n===r.toStringTag)&&typeof i.toHull=="function"&&typeof i.simplify=="function"}r.isPolyline=e})(so||(so={})),function(r){function e(t){const n=t.trim();if(n==="")return new r;const i=[],o=n.split(/\s*,\s*|\s+/);for(let s=0,a=o.length;s<a;s+=2)i.push({x:+o[s],y:+o[s+1]});return new r(i)}r.parse=e}(so||(so={}));class Ji extends eu{constructor(e,t,n,i){super();this.PRECISION=3,this.start=pe.create(e),this.controlPoint1=pe.create(t),this.controlPoint2=pe.create(n),this.end=pe.create(i)}get[Symbol.toStringTag](){return Ji.toStringTag}bbox(){const e=this.start,t=this.controlPoint1,n=this.controlPoint2,i=this.end,o=e.x,s=e.y,a=t.x,l=t.y,c=n.x,u=n.y,d=i.x,h=i.y,f=[],p=[],g=[[],[]];let v,y,x,E,T,P,z,$;for(let Kt=0;Kt<2;Kt+=1){if(Kt===0?(y=6*o-12*a+6*c,v=-3*o+9*a-9*c+3*d,x=3*a-3*o):(y=6*s-12*l+6*u,v=-3*s+9*l-9*u+3*h,x=3*l-3*s),Math.abs(v)<1e-12){if(Math.abs(y)<1e-12)continue;E=-x/y,E>0&&E<1&&p.push(E);continue}z=y*y-4*x*v,$=Math.sqrt(z),!(z<0)&&(T=(-y+$)/(2*v),T>0&&T<1&&p.push(T),P=(-y-$)/(2*v),P>0&&P<1&&p.push(P))}let ne,De,fe,Ae=p.length;const de=Ae;for(;Ae;)Ae-=1,E=p[Ae],fe=1-E,ne=fe*fe*fe*o+3*fe*fe*E*a+3*fe*E*E*c+E*E*E*d,g[0][Ae]=ne,De=fe*fe*fe*s+3*fe*fe*E*l+3*fe*E*E*u+E*E*E*h,g[1][Ae]=De,f[Ae]={X:ne,Y:De};p[de]=0,p[de+1]=1,f[de]={X:o,Y:s},f[de+1]={X:d,Y:h},g[0][de]=o,g[1][de]=s,g[0][de+1]=d,g[1][de+1]=h,p.length=de+2,g[0].length=de+2,g[1].length=de+2,f.length=de+2;const ct=Math.min.apply(null,g[0]),bt=Math.min.apply(null,g[1]),Pe=Math.max.apply(null,g[0]),tt=Math.max.apply(null,g[1]);return new Ht(ct,bt,Pe-ct,tt-bt)}closestPoint(e,t={}){return this.pointAtT(this.closestPointT(e,t))}closestPointLength(e,t={}){const n=this.getOptions(t);return this.lengthAtT(this.closestPointT(e,n),n)}closestPointNormalizedLength(e,t={}){const n=this.getOptions(t),i=this.closestPointLength(e,n);if(!i)return 0;const o=this.length(n);return o===0?0:i/o}closestPointT(e,t={}){const n=this.getPrecision(t),i=this.getDivisions(t),o=Math.pow(10,-n);let s=null,a=0,l=0,c=0,u=0,d=0,h=null;const f=i.length;let p=f>0?1/f:0;for(i.forEach((g,v)=>{const y=g.start.distance(e),x=g.end.distance(e),E=y+x;(h==null||E<h)&&(s=g,a=v*p,l=(v+1)*p,c=y,u=x,h=E,d=g.endpointDistance())});;){const g=c?Math.abs(c-u)/c:0,v=u!=null?Math.abs(c-u)/u:0,y=g<o||v<o,x=c?c<d*o:!0,E=u?u<d*o:!0;if(y||(x||E))return c<=u?a:l;const P=s.divide(.5);p/=2;const z=P[0].start.distance(e),$=P[0].end.distance(e),ne=z+$,De=P[1].start.distance(e),fe=P[1].end.distance(e),Ae=De+fe;ne<=Ae?(s=P[0],l-=p,c=z,u=$):(s=P[1],a+=p,c=De,u=fe)}}closestPointTangent(e,t={}){return this.tangentAtT(this.closestPointT(e,t))}containsPoint(e,t={}){return this.toPolyline(t).containsPoint(e)}divideAt(e,t={}){if(e<=0)return this.divideAtT(0);if(e>=1)return this.divideAtT(1);const n=this.tAt(e,t);return this.divideAtT(n)}divideAtLength(e,t={}){const n=this.tAtLength(e,t);return this.divideAtT(n)}divide(e){return this.divideAtT(e)}divideAtT(e){const t=this.start,n=this.controlPoint1,i=this.controlPoint2,o=this.end;if(e<=0)return[new Ji(t,t,t,t),new Ji(t,n,i,o)];if(e>=1)return[new Ji(t,n,i,o),new Ji(o,o,o,o)];const s=this.getSkeletonPoints(e),a=s.startControlPoint1,l=s.startControlPoint2,c=s.divider,u=s.dividerControlPoint1,d=s.dividerControlPoint2;return[new Ji(t,a,l,c),new Ji(c,u,d,o)]}endpointDistance(){return this.start.distance(this.end)}getSkeletonPoints(e){const t=this.start,n=this.controlPoint1,i=this.controlPoint2,o=this.end;if(e<=0)return{startControlPoint1:t.clone(),startControlPoint2:t.clone(),divider:t.clone(),dividerControlPoint1:n.clone(),dividerControlPoint2:i.clone()};if(e>=1)return{startControlPoint1:n.clone(),startControlPoint2:i.clone(),divider:o.clone(),dividerControlPoint1:o.clone(),dividerControlPoint2:o.clone()};const s=new xn(t,n).pointAt(e),a=new xn(n,i).pointAt(e),l=new xn(i,o).pointAt(e),c=new xn(s,a).pointAt(e),u=new xn(a,l).pointAt(e),d=new xn(c,u).pointAt(e);return{startControlPoint1:s,startControlPoint2:c,divider:d,dividerControlPoint1:u,dividerControlPoint2:l}}getSubdivisions(e={}){const t=this.getPrecision(e);let n=[new Ji(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(t===0)return n;let i=this.endpointDistance();const o=Math.pow(10,-t);let s=0;for(;;){s+=1;const a=[];n.forEach(u=>{const d=u.divide(.5);a.push(d[0],d[1])});const l=a.reduce((u,d)=>u+d.endpointDistance(),0),c=l!==0?(l-i)/l:0;if(s>1&&c<o)return a;n=a,i=l}}length(e={}){return this.getDivisions(e).reduce((n,i)=>n+i.endpointDistance(),0)}lengthAtT(e,t={}){if(e<=0)return 0;const n=t.precision===void 0?this.PRECISION:t.precision;return this.divide(e)[0].length({precision:n})}pointAt(e,t={}){if(e<=0)return this.start.clone();if(e>=1)return this.end.clone();const n=this.tAt(e,t);return this.pointAtT(n)}pointAtLength(e,t={}){const n=this.tAtLength(e,t);return this.pointAtT(n)}pointAtT(e){return e<=0?this.start.clone():e>=1?this.end.clone():this.getSkeletonPoints(e).divider}isDifferentiable(){const e=this.start,t=this.controlPoint1,n=this.controlPoint2,i=this.end;return!(e.equals(t)&&t.equals(n)&&n.equals(i))}tangentAt(e,t={}){if(!this.isDifferentiable())return null;e<0?e=0:e>1&&(e=1);const n=this.tAt(e,t);return this.tangentAtT(n)}tangentAtLength(e,t={}){if(!this.isDifferentiable())return null;const n=this.tAtLength(e,t);return this.tangentAtT(n)}tangentAtT(e){if(!this.isDifferentiable())return null;e<0&&(e=0),e>1&&(e=1);const t=this.getSkeletonPoints(e),n=t.startControlPoint2,i=t.dividerControlPoint1,o=t.divider,s=new xn(n,i);return s.translate(o.x-n.x,o.y-n.y),s}getPrecision(e={}){return e.precision==null?this.PRECISION:e.precision}getDivisions(e={}){if(e.subdivisions!=null)return e.subdivisions;const t=this.getPrecision(e);return this.getSubdivisions({precision:t})}getOptions(e={}){const t=this.getPrecision(e),n=this.getDivisions(e);return{precision:t,subdivisions:n}}tAt(e,t={}){if(e<=0)return 0;if(e>=1)return 1;const n=this.getOptions(t),o=this.length(n)*e;return this.tAtLength(o,n)}tAtLength(e,t={}){let n=!0;e<0&&(n=!1,e=-e);const i=this.getPrecision(t),o=this.getDivisions(t),s={precision:i,subdivisions:o};let a=null,l,c,u=0,d=0,h=0;const f=o.length;let p=f>0?1/f:0;for(let y=0;y<f;y+=1){const x=n?y:f-1-y,E=o[y],T=E.endpointDistance();if(e<=h+T){a=E,l=x*p,c=(x+1)*p,u=n?e-h:T+h-e,d=n?T+h-e:e-h;break}h+=T}if(a==null)return n?1:0;const g=this.length(s),v=Math.pow(10,-i);for(;;){let y;if(y=g!==0?u/g:0,y<v)return l;if(y=g!==0?d/g:0,y<v)return c;let x,E;const T=a.divide(.5);p/=2;const P=T[0].endpointDistance(),z=T[1].endpointDistance();u<=P?(a=T[0],c-=p,x=u,E=P-x):(a=T[1],l+=p,x=u-P,E=z-x),u=x,d=E}}toPoints(e={}){const t=this.getDivisions(e),n=[t[0].start.clone()];return t.forEach(i=>n.push(i.end.clone())),n}toPolyline(e={}){return new so(this.toPoints(e))}scale(e,t,n){return this.start.scale(e,t,n),this.controlPoint1.scale(e,t,n),this.controlPoint2.scale(e,t,n),this.end.scale(e,t,n),this}rotate(e,t){return this.start.rotate(e,t),this.controlPoint1.rotate(e,t),this.controlPoint2.rotate(e,t),this.end.rotate(e,t),this}translate(e,t){return typeof e=="number"?(this.start.translate(e,t),this.controlPoint1.translate(e,t),this.controlPoint2.translate(e,t),this.end.translate(e,t)):(this.start.translate(e),this.controlPoint1.translate(e),this.controlPoint2.translate(e),this.end.translate(e)),this}equals(e){return e!=null&&this.start.equals(e.start)&&this.controlPoint1.equals(e.controlPoint1)&&this.controlPoint2.equals(e.controlPoint2)&&this.end.equals(e.end)}clone(){return new Ji(this.start,this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.controlPoint1.serialize(),this.controlPoint2.serialize(),this.end.serialize()].join(" ")}}(function(r){r.toStringTag=`X6.Geometry.${r.name}`;function e(t){if(t==null)return!1;if(t instanceof r)return!0;const n=t[Symbol.toStringTag],i=t;try{if((n==null||n===r.toStringTag)&&pe.isPoint(i.start)&&pe.isPoint(i.controlPoint1)&&pe.isPoint(i.controlPoint2)&&pe.isPoint(i.end)&&typeof i.toPoints=="function"&&typeof i.toPolyline=="function")return!0}catch(o){return!1}return!1}r.isCurve=e})(Ji||(Ji={})),function(r){function e(i){const o=i.length,s=[],a=[];let l=2;s[0]=i[0]/l;for(let c=1;c<o;c+=1)a[c]=1/l,l=(c<o-1?4:3.5)-a[c],s[c]=(i[c]-s[c-1])/l;for(let c=1;c<o;c+=1)s[o-c-1]-=a[o-c]*s[o-c];return s}function t(i){const o=i.map(h=>pe.clone(h)),s=[],a=[],l=o.length-1;if(l===1)return s[0]=new pe((2*o[0].x+o[1].x)/3,(2*o[0].y+o[1].y)/3),a[0]=new pe(2*s[0].x-o[0].x,2*s[0].y-o[0].y),[s,a];const c=[];for(let h=1;h<l-1;h+=1)c[h]=4*o[h].x+2*o[h+1].x;c[0]=o[0].x+2*o[1].x,c[l-1]=(8*o[l-1].x+o[l].x)/2;const u=e(c);for(let h=1;h<l-1;h+=1)c[h]=4*o[h].y+2*o[h+1].y;c[0]=o[0].y+2*o[1].y,c[l-1]=(8*o[l-1].y+o[l].y)/2;const d=e(c);for(let h=0;h<l;h+=1)s.push(new pe(u[h],d[h])),h<l-1?a.push(new pe(2*o[h+1].x-u[h+1],2*o[h+1].y-d[h+1])):a.push(new pe((o[l].x+u[l-1])/2,(o[l].y+d[l-1])/2));return[s,a]}function n(i){if(i==null||Array.isArray(i)&&i.length<2)throw new Error("At least 2 points are required");const o=t(i),s=[];for(let a=0,l=o[0].length;a<l;a+=1){const c=new pe(o[0][a].x,o[0][a].y),u=new pe(o[1][a].x,o[1][a].y);s.push(new r(i[a],c,u,i[a+1]))}return s}r.throughPoints=n}(Ji||(Ji={}));class Wv extends eu{constructor(){super(...arguments);this.isVisible=!0,this.isSegment=!0,this.isSubpathStart=!1}get end(){return this.endPoint}get start(){if(this.previousSegment==null)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path, or segment has not yet been added to a path.)");return this.previousSegment.end}closestPointT(e,t){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(e);throw new Error("Neither `closestPointT` nor `closestPointNormalizedLength` method is implemented.")}lengthAtT(e,t){if(e<=0)return 0;const n=this.length();return e>=1?n:n*e}divideAtT(e){if(this.divideAt)return this.divideAt(e);throw new Error("Neither `divideAtT` nor `divideAt` method is implemented.")}pointAtT(e){if(this.pointAt)return this.pointAt(e);throw new Error("Neither `pointAtT` nor `pointAt` method is implemented.")}tangentAtT(e){if(this.tangentAt)return this.tangentAt(e);throw new Error("Neither `tangentAtT` nor `tangentAt` method is implemented.")}}class cs extends Wv{constructor(e,t){super();xn.isLine(e)?this.endPoint=e.end.clone().round(2):this.endPoint=pe.create(e,t).round(2)}get type(){return"L"}get line(){return new xn(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(e){return this.line.closestPoint(e)}closestPointLength(e){return this.line.closestPointLength(e)}closestPointNormalizedLength(e){return this.line.closestPointNormalizedLength(e)}closestPointTangent(e){return this.line.closestPointTangent(e)}length(){return this.line.length()}divideAt(e){const t=this.line.divideAt(e);return[new cs(t[0]),new cs(t[1])]}divideAtLength(e){const t=this.line.divideAtLength(e);return[new cs(t[0]),new cs(t[1])]}getSubdivisions(){return[]}pointAt(e){return this.line.pointAt(e)}pointAtLength(e){return this.line.pointAtLength(e)}tangentAt(e){return this.line.tangentAt(e)}tangentAtLength(e){return this.line.tangentAtLength(e)}isDifferentiable(){return this.previousSegment==null?!1:!this.start.equals(this.end)}clone(){return new cs(this.end)}scale(e,t,n){return this.end.scale(e,t,n),this}rotate(e,t){return this.end.rotate(e,t),this}translate(e,t){return typeof e=="number"?this.end.translate(e,t):this.end.translate(e),this}equals(e){return this.type===e.type&&this.start.equals(e.start)&&this.end.equals(e.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){const e=this.end;return`${this.type} ${e.x} ${e.y}`}}(function(r){function e(...t){const n=t.length,i=t[0];if(xn.isLine(i))return new r(i);if(pe.isPointLike(i))return n===1?new r(i):t.map(s=>new r(s));if(n===2)return new r(+t[0],+t[1]);const o=[];for(let s=0;s<n;s+=2){const a=+t[s],l=+t[s+1];o.push(new r(a,l))}return o}r.create=e})(cs||(cs={}));class xf extends Wv{get end(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. MoveTo), or segment has not yet been added to a path.)");return this.subpathStartSegment.end}get type(){return"Z"}get line(){return new xn(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(e){return this.line.closestPoint(e)}closestPointLength(e){return this.line.closestPointLength(e)}closestPointNormalizedLength(e){return this.line.closestPointNormalizedLength(e)}closestPointTangent(e){return this.line.closestPointTangent(e)}length(){return this.line.length()}divideAt(e){const t=this.line.divideAt(e);return[t[1].isDifferentiable()?new cs(t[0]):this.clone(),new cs(t[1])]}divideAtLength(e){const t=this.line.divideAtLength(e);return[t[1].isDifferentiable()?new cs(t[0]):this.clone(),new cs(t[1])]}getSubdivisions(){return[]}pointAt(e){return this.line.pointAt(e)}pointAtLength(e){return this.line.pointAtLength(e)}tangentAt(e){return this.line.tangentAt(e)}tangentAtLength(e){return this.line.tangentAtLength(e)}isDifferentiable(){return!this.previousSegment||!this.subpathStartSegment?!1:!this.start.equals(this.end)}scale(){return this}rotate(){return this}translate(){return this}equals(e){return this.type===e.type&&this.start.equals(e.start)&&this.end.equals(e.end)}clone(){return new xf}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return this.type}}(function(r){function e(){return new r}r.create=e})(xf||(xf={}));class Cf extends Wv{constructor(e,t){super();this.isVisible=!1,this.isSubpathStart=!0,xn.isLine(e)||Ji.isCurve(e)?this.endPoint=e.end.clone().round(2):this.endPoint=pe.create(e,t).round(2)}get start(){throw new Error("Illegal access. Moveto segments should not need a start property.")}get type(){return"M"}bbox(){return null}closestPoint(){return this.end.clone()}closestPointLength(){return 0}closestPointNormalizedLength(){return 0}closestPointT(){return 1}closestPointTangent(){return null}length(){return 0}lengthAtT(){return 0}divideAt(){return[this.clone(),this.clone()]}divideAtLength(){return[this.clone(),this.clone()]}getSubdivisions(){return[]}pointAt(){return this.end.clone()}pointAtLength(){return this.end.clone()}pointAtT(){return this.end.clone()}tangentAt(){return null}tangentAtLength(){return null}tangentAtT(){return null}isDifferentiable(){return!1}scale(e,t,n){return this.end.scale(e,t,n),this}rotate(e,t){return this.end.rotate(e,t),this}translate(e,t){return typeof e=="number"?this.end.translate(e,t):this.end.translate(e),this}clone(){return new Cf(this.end)}equals(e){return this.type===e.type&&this.end.equals(e.end)}toJSON(){return{type:this.type,end:this.end.toJSON()}}serialize(){const e=this.end;return`${this.type} ${e.x} ${e.y}`}}(function(r){function e(...t){const n=t.length,i=t[0];if(xn.isLine(i))return new r(i);if(Ji.isCurve(i))return new r(i);if(pe.isPointLike(i)){if(n===1)return new r(i);const s=[];for(let a=0;a<n;a+=1)a===0?s.push(new r(t[a])):s.push(new cs(t[a]));return s}if(n===2)return new r(+t[0],+t[1]);const o=[];for(let s=0;s<n;s+=2){const a=+t[s],l=+t[s+1];s===0?o.push(new r(a,l)):o.push(new cs(a,l))}return o}r.create=e})(Cf||(Cf={}));class ya extends Wv{constructor(e,t,n,i,o,s){super();Ji.isCurve(e)?(this.controlPoint1=e.controlPoint1.clone().round(2),this.controlPoint2=e.controlPoint2.clone().round(2),this.endPoint=e.end.clone().round(2)):typeof e=="number"?(this.controlPoint1=new pe(e,t).round(2),this.controlPoint2=new pe(n,i).round(2),this.endPoint=new pe(o,s).round(2)):(this.controlPoint1=pe.create(e).round(2),this.controlPoint2=pe.create(t).round(2),this.endPoint=pe.create(n).round(2))}get type(){return"C"}get curve(){return new Ji(this.start,this.controlPoint1,this.controlPoint2,this.end)}bbox(){return this.curve.bbox()}closestPoint(e){return this.curve.closestPoint(e)}closestPointLength(e){return this.curve.closestPointLength(e)}closestPointNormalizedLength(e){return this.curve.closestPointNormalizedLength(e)}closestPointTangent(e){return this.curve.closestPointTangent(e)}length(){return this.curve.length()}divideAt(e,t={}){const n=this.curve.divideAt(e,t);return[new ya(n[0]),new ya(n[1])]}divideAtLength(e,t={}){const n=this.curve.divideAtLength(e,t);return[new ya(n[0]),new ya(n[1])]}divideAtT(e){const t=this.curve.divideAtT(e);return[new ya(t[0]),new ya(t[1])]}getSubdivisions(){return[]}pointAt(e){return this.curve.pointAt(e)}pointAtLength(e){return this.curve.pointAtLength(e)}tangentAt(e){return this.curve.tangentAt(e)}tangentAtLength(e){return this.curve.tangentAtLength(e)}isDifferentiable(){if(!this.previousSegment)return!1;const e=this.start,t=this.controlPoint1,n=this.controlPoint2,i=this.end;return!(e.equals(t)&&t.equals(n)&&n.equals(i))}scale(e,t,n){return this.controlPoint1.scale(e,t,n),this.controlPoint2.scale(e,t,n),this.end.scale(e,t,n),this}rotate(e,t){return this.controlPoint1.rotate(e,t),this.controlPoint2.rotate(e,t),this.end.rotate(e,t),this}translate(e,t){return typeof e=="number"?(this.controlPoint1.translate(e,t),this.controlPoint2.translate(e,t),this.end.translate(e,t)):(this.controlPoint1.translate(e),this.controlPoint2.translate(e),this.end.translate(e)),this}equals(e){return this.start.equals(e.start)&&this.end.equals(e.end)&&this.controlPoint1.equals(e.controlPoint1)&&this.controlPoint2.equals(e.controlPoint2)}clone(){return new ya(this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){const e=this.controlPoint1,t=this.controlPoint2,n=this.end;return[this.type,e.x,e.y,t.x,t.y,n.x,n.y].join(" ")}}(function(r){function e(...t){const n=t.length,i=t[0];if(Ji.isCurve(i))return new r(i);if(pe.isPointLike(i)){if(n===3)return new r(t[0],t[1],t[2]);const s=[];for(let a=0;a<n;a+=3)s.push(new r(t[a],t[a+1],t[a+2]));return s}if(n===6)return new r(t[0],t[1],t[2],t[3],t[4],t[5]);const o=[];for(let s=0;s<n;s+=6)o.push(new r(t[s],t[s+1],t[s+2],t[s+3],t[s+4],t[s+5]));return o}r.create=e})(ya||(ya={}));function Zv(r,e,t){return{x:r*Math.cos(t)-e*Math.sin(t),y:r*Math.sin(t)+e*Math.cos(t)}}function p_(r,e,t,n,i,o){const s=1/3,a=2/3;return[s*r+a*t,s*e+a*n,s*i+a*t,s*o+a*n,i,o]}function g_(r,e,t,n,i,o,s,a,l,c){const u=Math.PI*120/180,d=Math.PI/180*(+i||0);let h=[],f,p,g,v,y;if(c)p=c[0],g=c[1],v=c[2],y=c[3];else{f=Zv(r,e,-d),r=f.x,e=f.y,f=Zv(a,l,-d),a=f.x,l=f.y;const bt=(r-a)/2,Pe=(e-l)/2;let tt=bt*bt/(t*t)+Pe*Pe/(n*n);tt>1&&(tt=Math.sqrt(tt),t=tt*t,n=tt*n);const Kt=t*t,tn=n*n,Bn=(o===s?-1:1)*Math.sqrt(Math.abs((Kt*tn-Kt*Pe*Pe-tn*bt*bt)/(Kt*Pe*Pe+tn*bt*bt)));v=Bn*t*Pe/n+(r+a)/2,y=Bn*-n*bt/t+(e+l)/2,p=Math.asin((e-y)/n),g=Math.asin((l-y)/n),p=r<v?Math.PI-p:p,g=a<v?Math.PI-g:g,p<0&&(p=Math.PI*2+p),g<0&&(g=Math.PI*2+g),s&&p>g&&(p-=Math.PI*2),!s&&g>p&&(g-=Math.PI*2)}let x=g-p;if(Math.abs(x)>u){const bt=g,Pe=a,tt=l;g=p+u*(s&&g>p?1:-1),a=v+t*Math.cos(g),l=y+n*Math.sin(g),h=g_(a,l,t,n,i,0,s,Pe,tt,[g,bt,v,y])}x=g-p;const E=Math.cos(p),T=Math.sin(p),P=Math.cos(g),z=Math.sin(g),$=Math.tan(x/4),ne=4/3*(t*$),De=4/3*(n*$),fe=[r,e],Ae=[r+ne*T,e-De*E],de=[a+ne*z,l-De*P],ct=[a,l];if(Ae[0]=2*fe[0]-Ae[0],Ae[1]=2*fe[1]-Ae[1],c)return[Ae,de,ct].concat(h);{h=[Ae,de,ct].concat(h).join().split(",");const bt=[],Pe=h.length;for(let tt=0;tt<Pe;tt+=1)bt[tt]=tt%2?Zv(+h[tt-1],+h[tt],d).y:Zv(+h[tt],+h[tt+1],d).x;return bt}}function m6(r){if(!r)return null;const e=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,t=new RegExp(`([a-z])[${e},]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[${e}]*,?[${e}]*)+)`,"ig"),n=new RegExp(`(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[${e}]*,?[${e}]*`,"ig"),i={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},o=[];return r.replace(t,(s,a,l)=>{const c=[];let u=a.toLowerCase();l.replace(n,(h,f)=>(f&&c.push(+f),h)),u==="m"&&c.length>2&&(o.push([a,...c.splice(0,2)]),u="l",a=a==="m"?"l":"L");const d=i[u];for(;c.length>=d&&(o.push([a,...c.splice(0,d)]),!!d););return s}),o}function v6(r){const e=m6(r);if(!e||!e.length)return[["M",0,0]];let t=0,n=0,i=0,o=0;const s=[];for(let a=0,l=e.length;a<l;a+=1){const c=[];s.push(c);const u=e[a],d=u[0];if(d!==d.toUpperCase())switch(c[0]=d.toUpperCase(),c[0]){case"A":c[1]=u[1],c[2]=u[2],c[3]=u[3],c[4]=u[4],c[5]=u[5],c[6]=+u[6]+t,c[7]=+u[7]+n;break;case"V":c[1]=+u[1]+n;break;case"H":c[1]=+u[1]+t;break;case"M":i=+u[1]+t,o=+u[2]+n;for(let h=1,f=u.length;h<f;h+=1)c[h]=+u[h]+(h%2?t:n);break;default:for(let h=1,f=u.length;h<f;h+=1)c[h]=+u[h]+(h%2?t:n);break}else for(let h=0,f=u.length;h<f;h+=1)c[h]=u[h];switch(c[0]){case"Z":t=+i,n=+o;break;case"H":t=c[1];break;case"V":n=c[1];break;case"M":i=c[c.length-2],o=c[c.length-1],t=c[c.length-2],n=c[c.length-1];break;default:t=c[c.length-2],n=c[c.length-1];break}}return s}function y6(r){const e=v6(r),t={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function n(l,c,u){let d,h;if(!l)return["C",c.x,c.y,c.x,c.y,c.x,c.y];switch(l[0]in{T:1,Q:1}||(c.qx=null,c.qy=null),l[0]){case"M":c.X=l[1],c.Y=l[2];break;case"A":return parseFloat(l[1])===0||parseFloat(l[2])===0?["L",l[6],l[7]]:["C"].concat(g_.apply(0,[c.x,c.y].concat(l.slice(1))));case"S":return u==="C"||u==="S"?(d=c.x*2-c.bx,h=c.y*2-c.by):(d=c.x,h=c.y),["C",d,h].concat(l.slice(1));case"T":return u==="Q"||u==="T"?(c.qx=c.x*2-c.qx,c.qy=c.y*2-c.qy):(c.qx=c.x,c.qy=c.y),["C"].concat(p_(c.x,c.y,c.qx,c.qy,l[1],l[2]));case"Q":return c.qx=l[1],c.qy=l[2],["C"].concat(p_(c.x,c.y,l[1],l[2],l[3],l[4]));case"H":return["L"].concat(l[1],c.y);case"V":return["L"].concat(c.x,l[1]);case"L":break;case"Z":break;default:break}return l}function i(l,c){if(l[c].length>7){l[c].shift();const u=l[c];for(;u.length;)o[c]="A",c+=1,l.splice(c,0,["C"].concat(u.splice(0,6)));l.splice(c,1),a=e.length}}const o=[];let s="",a=e.length;for(let l=0;l<a;l+=1){let c="";e[l]&&(c=e[l][0]),c!=="C"&&(o[l]=c,l>0&&(s=o[l-1])),e[l]=n(e[l],t,s),o[l]!=="A"&&c==="C"&&(o[l]="C"),i(e,l);const u=e[l],d=u.length;t.x=u[d-2],t.y=u[d-1],t.bx=parseFloat(u[d-4])||t.x,t.by=parseFloat(u[d-3])||t.y}return(!e[0][0]||e[0][0]!=="M")&&e.unshift(["M",0,0]),e}function b6(r){return y6(r).map(e=>e.map(t=>typeof t=="string"?t:Dd(t,2))).join(",").split(",").join(" ")}const x6=new RegExp("^[\\s\\dLMCZz,.]*$");function C6(r){return typeof r!="string"?!1:x6.test(r)}function ZC(r,e){return(r%e+e)%e}function w6(r,e,t,n,i){const o=[],s=r[r.length-1],a=e!=null&&e>0,l=e||0;if(n&&a){r=r.slice();const d=r[0],h=new pe(s.x+(d.x-s.x)/2,s.y+(d.y-s.y)/2);r.splice(0,0,h)}let c=r[0],u=1;for(t?o.push("M",c.x,c.y):o.push("L",c.x,c.y);u<(n?r.length:r.length-1);){let d=r[ZC(u,r.length)],h=c.x-d.x,f=c.y-d.y;if(a&&(h!==0||f!==0)&&(i==null||i.indexOf(u-1)<0)){let p=Math.sqrt(h*h+f*f);const g=h*Math.min(l,p/2)/p,v=f*Math.min(l,p/2)/p,y=d.x+g,x=d.y+v;o.push("L",y,x);let E=r[ZC(u+1,r.length)];for(;u<r.length-2&&Math.round(E.x-d.x)===0&&Math.round(E.y-d.y)===0;)E=r[ZC(u+2,r.length)],u+=1;h=E.x-d.x,f=E.y-d.y,p=Math.max(1,Math.sqrt(h*h+f*f));const T=h*Math.min(l,p/2)/p,P=f*Math.min(l,p/2)/p,z=d.x+T,$=d.y+P;o.push("Q",d.x,d.y,z,$),d=new pe(z,$)}else o.push("L",d.x,d.y);c=d,u+=1}return n?o.push("Z"):o.push("L",s.x,s.y),o.map(d=>typeof d=="string"?d:+d.toFixed(3)).join(" ")}function m_(r,e={}){const t=[];return r&&r.length&&r.forEach(n=>{Array.isArray(n)?t.push({x:n[0],y:n[1]}):t.push({x:n.x,y:n.y})}),w6(t,e.round,e.initialMove==null||e.initialMove,e.close,e.exclude)}function Xv(r,e,t,n,i=0,o=0,s=0,a,l){if(t===0||n===0)return[];a-=r,l-=e,t=Math.abs(t),n=Math.abs(n);const c=-a/2,u=-l/2,d=Math.cos(i*Math.PI/180),h=Math.sin(i*Math.PI/180),f=d*c+h*u,p=-1*h*c+d*u,g=f*f,v=p*p,y=t*t,x=n*n,E=g/y+v/x;let T;if(E>1)t=Math.sqrt(E)*t,n=Math.sqrt(E)*n,T=0;else{let Pn=1;o===s&&(Pn=-1),T=Pn*Math.sqrt((y*x-y*v-x*g)/(y*v+x*g))}const P=T*t*p/n,z=-1*T*n*f/t,$=d*P-h*z+a/2,ne=h*P+d*z+l/2;let De=Math.atan2((p-z)/n,(f-P)/t)-Math.atan2(0,1),fe=De>=0?De:2*Math.PI+De;De=Math.atan2((-p-z)/n,(-f-P)/t)-Math.atan2((p-z)/n,(f-P)/t);let Ae=De>=0?De:2*Math.PI+De;s===0&&Ae>0?Ae-=2*Math.PI:s!==0&&Ae<0&&(Ae+=2*Math.PI);const de=Ae*2/Math.PI,ct=Math.ceil(de<0?-1*de:de),bt=Ae/ct,Pe=8/3*Math.sin(bt/4)*Math.sin(bt/4)/Math.sin(bt/2),tt=d*t,Kt=d*n,tn=h*t,Bn=h*n;let cr=Math.cos(fe),gn=Math.sin(fe),si=-Pe*(tt*gn+Bn*cr),xi=-Pe*(tn*gn-Kt*cr),Nt=0,fn=0;const Kn=[];for(let Pn=0;Pn<ct;Pn+=1){fe+=bt,cr=Math.cos(fe),gn=Math.sin(fe),Nt=tt*cr-Bn*gn+$,fn=tn*cr+Kt*gn+ne;const vr=-Pe*(tt*gn+Bn*cr),Gn=-Pe*(tn*gn-Kt*cr),ci=Pn*6;Kn[ci]=Number(si+r),Kn[ci+1]=Number(xi+e),Kn[ci+2]=Number(Nt-vr+r),Kn[ci+3]=Number(fn-Gn+e),Kn[ci+4]=Number(Nt+r),Kn[ci+5]=Number(fn+e),si=Nt+vr,xi=fn+Gn}return Kn.map(Pn=>+Pn.toFixed(2))}function E6(r,e,t,n,i=0,o=0,s=0,a,l){const c=[],u=Xv(r,e,t,n,i,o,s,a,l);if(u!=null)for(let d=0,h=u.length;d<h;d+=6)c.push("C",u[d],u[d+1],u[d+2],u[d+3],u[d+4],u[d+5]);return c.join(" ")}class Dn extends eu{constructor(e){super();if(this.PRECISION=3,this.segments=[],Array.isArray(e))if(xn.isLine(e[0])||Ji.isCurve(e[0])){let t=null;e.forEach((i,o)=>{o===0&&this.appendSegment(Dn.createSegment("M",i.start)),t!=null&&!t.end.equals(i.start)&&this.appendSegment(Dn.createSegment("M",i.start)),xn.isLine(i)?this.appendSegment(Dn.createSegment("L",i.end)):Ji.isCurve(i)&&this.appendSegment(Dn.createSegment("C",i.controlPoint1,i.controlPoint2,i.end)),t=i})}else e.forEach(n=>{n.isSegment&&this.appendSegment(n)});else e!=null&&(xn.isLine(e)?(this.appendSegment(Dn.createSegment("M",e.start)),this.appendSegment(Dn.createSegment("L",e.end))):Ji.isCurve(e)?(this.appendSegment(Dn.createSegment("M",e.start)),this.appendSegment(Dn.createSegment("C",e.controlPoint1,e.controlPoint2,e.end))):so.isPolyline(e)?e.points&&e.points.length&&e.points.forEach((t,n)=>{const i=n===0?Dn.createSegment("M",t):Dn.createSegment("L",t);this.appendSegment(i)}):e.isSegment&&this.appendSegment(e))}get[Symbol.toStringTag](){return Dn.toStringTag}get start(){const e=this.segments,t=e.length;if(t===0)return null;for(let n=0;n<t;n+=1){const i=e[n];if(i.isVisible)return i.start}return e[t-1].end}get end(){const e=this.segments,t=e.length;if(t===0)return null;for(let n=t-1;n>=0;n-=1){const i=e[n];if(i.isVisible)return i.end}return e[t-1].end}moveTo(...e){return this.appendSegment(Cf.create.call(null,...e))}lineTo(...e){return this.appendSegment(cs.create.call(null,...e))}curveTo(...e){return this.appendSegment(ya.create.call(null,...e))}arcTo(e,t,n,i,o,s,a){const l=this.end||new pe,c=typeof s=="number"?Xv(l.x,l.y,e,t,n,i,o,s,a):Xv(l.x,l.y,e,t,n,i,o,s.x,s.y);if(c!=null)for(let u=0,d=c.length;u<d;u+=6)this.curveTo(c[u],c[u+1],c[u+2],c[u+3],c[u+4],c[u+5]);return this}quadTo(e,t,n,i){const o=this.end||new pe,s=["M",o.x,o.y];if(typeof e=="number")s.push("Q",e,t,n,i);else{const l=t;s.push("Q",e.x,e.y,l.x,l.y)}const a=Dn.parse(s.join(" "));return this.appendSegment(a.segments.slice(1)),this}close(){return this.appendSegment(xf.create())}drawPoints(e,t={}){const n=m_(e,t),i=Dn.parse(n);i&&i.segments&&this.appendSegment(i.segments)}bbox(){const e=this.segments,t=e.length;if(t===0)return null;let n;for(let o=0;o<t;o+=1){const s=e[o];if(s.isVisible){const a=s.bbox();a!=null&&(n=n?n.union(a):a)}}if(n!=null)return n;const i=e[t-1];return new Ht(i.end.x,i.end.y,0,0)}appendSegment(e){const t=this.segments.length;let n=t!==0?this.segments[t-1]:null,i;const o=null;if(Array.isArray(e))for(let s=0,a=e.length;s<a;s+=1){const l=e[s];i=this.prepareSegment(l,n,o),this.segments.push(i),n=i}else e!=null&&e.isSegment&&(i=this.prepareSegment(e,n,o),this.segments.push(i));return this}insertSegment(e,t){const n=this.segments.length;if(e<0&&(e=n+e+1),e>n||e<0)throw new Error("Index out of range.");let i,o=null,s=null;if(n!==0&&(e>=1?(o=this.segments[e-1],s=o.nextSegment):(o=null,s=this.segments[0])),!Array.isArray(t))i=this.prepareSegment(t,o,s),this.segments.splice(e,0,i);else for(let a=0,l=t.length;a<l;a+=1){const c=t[a];i=this.prepareSegment(c,o,s),this.segments.splice(e+a,0,i),o=i}return this}removeSegment(e){const t=this.fixIndex(e),n=this.segments.splice(t,1)[0],i=n.previousSegment,o=n.nextSegment;return i&&(i.nextSegment=o),o&&(o.previousSegment=i),n.isSubpathStart&&o&&this.updateSubpathStartSegment(o),n}replaceSegment(e,t){const n=this.fixIndex(e);let i;const o=this.segments[n];let s=o.previousSegment;const a=o.nextSegment;let l=o.isSubpathStart;if(!Array.isArray(t))i=this.prepareSegment(t,s,a),this.segments.splice(n,1,i),l&&i.isSubpathStart&&(l=!1);else{this.segments.splice(e,1);for(let c=0,u=t.length;c<u;c+=1){const d=t[c];i=this.prepareSegment(d,s,a),this.segments.splice(e+c,0,i),s=i,l&&i.isSubpathStart&&(l=!1)}}l&&a&&this.updateSubpathStartSegment(a)}getSegment(e){const t=this.fixIndex(e);return this.segments[t]}fixIndex(e){const t=this.segments.length;if(t===0)throw new Error("Path has no segments.");let n=e;for(;n<0;)n=t+n;if(n>=t||n<0)throw new Error("Index out of range.");return n}segmentAt(e,t={}){const n=this.segmentIndexAt(e,t);return n?this.getSegment(n):null}segmentAtLength(e,t={}){const n=this.segmentIndexAtLength(e,t);return n?this.getSegment(n):null}segmentIndexAt(e,t={}){if(this.segments.length===0)return null;const n=bf(e,0,1),i=this.getOptions(t),s=this.length(i)*n;return this.segmentIndexAtLength(s,i)}segmentIndexAtLength(e,t={}){const n=this.segments.length;if(n===0)return null;let i=!0;e<0&&(i=!1,e=-e);const o=this.getPrecision(t),s=this.getSubdivisions(t);let a=0,l=null;for(let c=0;c<n;c+=1){const u=i?c:n-1-c,d=this.segments[u],h=s[u],f=d.length({precision:o,subdivisions:h});if(d.isVisible){if(e<=a+f)return u;l=u}a+=f}return l}getSegmentSubdivisions(e={}){const t=this.getPrecision(e),n=[];for(let i=0,o=this.segments.length;i<o;i+=1){const a=this.segments[i].getSubdivisions({precision:t});n.push(a)}return n}updateSubpathStartSegment(e){let t=e.previousSegment,n=e;for(;n&&!n.isSubpathStart;)t!=null?n.subpathStartSegment=t.subpathStartSegment:n.subpathStartSegment=null,t=n,n=n.nextSegment}prepareSegment(e,t,n){e.previousSegment=t,e.nextSegment=n,t!=null&&(t.nextSegment=e),n!=null&&(n.previousSegment=e);let i=e;return e.isSubpathStart&&(e.subpathStartSegment=e,i=n),i!=null&&this.updateSubpathStartSegment(i),e}closestPoint(e,t={}){const n=this.closestPointT(e,t);return n?this.pointAtT(n):null}closestPointLength(e,t={}){const n=this.getOptions(t),i=this.closestPointT(e,n);return i?this.lengthAtT(i,n):0}closestPointNormalizedLength(e,t={}){const n=this.getOptions(t),i=this.closestPointLength(e,n);if(i===0)return 0;const o=this.length(n);return o===0?0:i/o}closestPointT(e,t={}){if(this.segments.length===0)return null;const n=this.getPrecision(t),i=this.getSubdivisions(t);let o,s=Infinity;for(let a=0,l=this.segments.length;a<l;a+=1){const c=this.segments[a],u=i[a];if(c.isVisible){const d=c.closestPointT(e,{precision:n,subdivisions:u}),h=c.pointAtT(d),f=f_(h,e);f<s&&(o={segmentIndex:a,value:d},s=f)}}return o||{segmentIndex:this.segments.length-1,value:1}}closestPointTangent(e,t={}){if(this.segments.length===0)return null;const n=this.getPrecision(t),i=this.getSubdivisions(t);let o,s=Infinity;for(let a=0,l=this.segments.length;a<l;a+=1){const c=this.segments[a],u=i[a];if(c.isDifferentiable()){const d=c.closestPointT(e,{precision:n,subdivisions:u}),h=c.pointAtT(d),f=f_(h,e);f<s&&(o=c.tangentAtT(d),s=f)}}return o||null}containsPoint(e,t={}){const n=this.toPolylines(t);if(!n)return!1;let i=0;for(let o=0,s=n.length;o<s;o+=1)n[o].containsPoint(e)&&(i+=1);return i%2==1}pointAt(e,t={}){if(this.segments.length===0)return null;if(e<=0)return this.start.clone();if(e>=1)return this.end.clone();const n=this.getOptions(t),o=this.length(n)*e;return this.pointAtLength(o,n)}pointAtLength(e,t={}){if(this.segments.length===0)return null;if(e===0)return this.start.clone();let n=!0;e<0&&(n=!1,e=-e);const i=this.getPrecision(t),o=this.getSubdivisions(t);let s,a=0;for(let c=0,u=this.segments.length;c<u;c+=1){const d=n?c:u-1-c,h=this.segments[d],f=o[d],p=h.length({precision:i,subdivisions:f});if(h.isVisible){if(e<=a+p)return h.pointAtLength((n?1:-1)*(e-a),{precision:i,subdivisions:f});s=h}a+=p}return s?n?s.end:s.start:this.segments[this.segments.length-1].end.clone()}pointAtT(e){const t=this.segments,n=t.length;if(n===0)return null;const i=e.segmentIndex;if(i<0)return t[0].pointAtT(0);if(i>=n)return t[n-1].pointAtT(1);const o=bf(e.value,0,1);return t[i].pointAtT(o)}divideAt(e,t={}){if(this.segments.length===0)return null;const n=bf(e,0,1),i=this.getOptions(t),s=this.length(i)*n;return this.divideAtLength(s,i)}divideAtLength(e,t={}){if(this.segments.length===0)return null;let n=!0;e<0&&(n=!1,e=-e);const i=this.getPrecision(t),o=this.getSubdivisions(t);let s=0,a,l,c,u,d;for(let P=0,z=this.segments.length;P<z;P+=1){const $=n?P:z-1-P,ne=this.getSegment($),De=o[$],fe={precision:i,subdivisions:De},Ae=ne.length(fe);if(ne.isDifferentiable()&&(c=ne,u=$,e<=s+Ae)){l=$,a=ne.divideAtLength((n?1:-1)*(e-s),fe);break}s+=Ae}if(!c)return null;a||(l=u,d=n?1:0,a=c.divideAtT(d));const h=this.clone(),f=l;h.replaceSegment(f,a);const p=f;let g=f+1,v=f+2;a[0].isDifferentiable()||(h.removeSegment(p),g-=1,v-=1);const y=h.getSegment(g).start;h.insertSegment(g,Dn.createSegment("M",y)),v+=1,a[1].isDifferentiable()||(h.removeSegment(v-1),v-=1);const x=v-p-1;for(let P=v,z=h.segments.length;P<z;P+=1){const $=this.getSegment(P-x),ne=h.getSegment(P);if(ne.type==="Z"&&!$.subpathStartSegment.end.equals(ne.subpathStartSegment.end)){const De=Dn.createSegment("L",$.end);h.replaceSegment(P,De)}}const E=new Dn(h.segments.slice(0,g)),T=new Dn(h.segments.slice(g));return[E,T]}intersectsWithLine(e,t={}){const n=this.toPolylines(t);if(n==null)return null;let i=null;for(let o=0,s=n.length;o<s;o+=1){const a=n[o],l=e.intersect(a);l&&(i==null&&(i=[]),Array.isArray(l)?i.push(...l):i.push(l))}return i}isDifferentiable(){for(let e=0,t=this.segments.length;e<t;e+=1)if(this.segments[e].isDifferentiable())return!0;return!1}isValid(){const e=this.segments;return e.length===0||e[0].type==="M"}length(e={}){if(this.segments.length===0)return 0;const t=this.getSubdivisions(e);let n=0;for(let i=0,o=this.segments.length;i<o;i+=1){const s=this.segments[i],a=t[i];n+=s.length({subdivisions:a})}return n}lengthAtT(e,t={}){const n=this.segments.length;if(n===0)return 0;let i=e.segmentIndex;if(i<0)return 0;let o=bf(e.value,0,1);i>=n&&(i=n-1,o=1);const s=this.getPrecision(t),a=this.getSubdivisions(t);let l=0;for(let d=0;d<i;d+=1){const h=this.segments[d],f=a[d];l+=h.length({precision:s,subdivisions:f})}const c=this.segments[i],u=a[i];return l+=c.lengthAtT(o,{precision:s,subdivisions:u}),l}tangentAt(e,t={}){if(this.segments.length===0)return null;const n=bf(e,0,1),i=this.getOptions(t),s=this.length(i)*n;return this.tangentAtLength(s,i)}tangentAtLength(e,t={}){if(this.segments.length===0)return null;let n=!0;e<0&&(n=!1,e=-e);const i=this.getPrecision(t),o=this.getSubdivisions(t);let s,a=0;for(let l=0,c=this.segments.length;l<c;l+=1){const u=n?l:c-1-l,d=this.segments[u],h=o[u],f=d.length({precision:i,subdivisions:h});if(d.isDifferentiable()){if(e<=a+f)return d.tangentAtLength((n?1:-1)*(e-a),{precision:i,subdivisions:h});s=d}a+=f}if(s){const l=n?1:0;return s.tangentAtT(l)}return null}tangentAtT(e){const t=this.segments.length;if(t===0)return null;const n=e.segmentIndex;if(n<0)return this.segments[0].tangentAtT(0);if(n>=t)return this.segments[t-1].tangentAtT(1);const i=bf(e.value,0,1);return this.segments[n].tangentAtT(i)}getPrecision(e={}){return e.precision==null?this.PRECISION:e.precision}getSubdivisions(e={}){if(e.segmentSubdivisions==null){const t=this.getPrecision(e);return this.getSegmentSubdivisions({precision:t})}return e.segmentSubdivisions}getOptions(e={}){const t=this.getPrecision(e),n=this.getSubdivisions(e);return{precision:t,segmentSubdivisions:n}}toPoints(e={}){const t=this.segments,n=t.length;if(n===0)return null;const i=this.getSubdivisions(e),o=[];let s=[];for(let a=0;a<n;a+=1){const l=t[a];if(l.isVisible){const c=i[a];c.length>0?c.forEach(u=>s.push(u.start)):s.push(l.start)}else s.length>0&&(s.push(t[a-1].end),o.push(s),s=[])}return s.length>0&&(s.push(this.end),o.push(s)),o}toPolylines(e={}){const t=this.toPoints(e);return t?t.map(n=>new so(n)):null}scale(e,t,n){return this.segments.forEach(i=>i.scale(e,t,n)),this}rotate(e,t){return this.segments.forEach(n=>n.rotate(e,t)),this}translate(e,t){return typeof e=="number"?this.segments.forEach(n=>n.translate(e,t)):this.segments.forEach(n=>n.translate(e)),this}clone(){const e=new Dn;return this.segments.forEach(t=>e.appendSegment(t.clone())),e}equals(e){if(e==null)return!1;const t=this.segments,n=e.segments,i=t.length;if(n.length!==i)return!1;for(let o=0;o<i;o+=1){const s=t[o],a=n[o];if(s.type!==a.type||!s.equals(a))return!1}return!0}toJSON(){return this.segments.map(e=>e.toJSON())}serialize(){if(!this.isValid())throw new Error("Invalid path segments.");return this.segments.map(e=>e.serialize()).join(" ")}toString(){return this.serialize()}}(function(r){r.toStringTag=`X6.Geometry.${r.name}`;function e(t){if(t==null)return!1;if(t instanceof r)return!0;const n=t[Symbol.toStringTag],i=t;return!!((n==null||n===r.toStringTag)&&Array.isArray(i.segments)&&typeof i.moveTo=="function"&&typeof i.lineTo=="function"&&typeof i.curveTo=="function")}r.isPath=e})(Dn||(Dn={})),function(r){function e(n){if(!n)return new r;const i=new r,o=/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g,s=r.normalize(n).match(o);if(s!=null)for(let a=0,l=s.length;a<l;a+=1){const c=s[a],u=/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g,d=c.match(u);if(d!=null){const h=d[0],f=d.slice(1).map(g=>+g),p=t.call(null,h,...f);i.appendSegment(p)}}return i}r.parse=e;function t(n,...i){if(n==="M")return Cf.create.call(null,...i);if(n==="L")return cs.create.call(null,...i);if(n==="C")return ya.create.call(null,...i);if(n==="z"||n==="Z")return xf.create();throw new Error(`Invalid path segment type "${n}"`)}r.createSegment=t}(Dn||(Dn={})),function(r){r.normalize=b6,r.isValid=C6,r.drawArc=E6,r.drawPoints=m_,r.arcToCurves=Xv}(Dn||(Dn={}));class pn{constructor(e,t,n){if(!e)throw new TypeError("Invalid element to create vector");let i;if(pn.isVector(e))i=e.node;else if(typeof e=="string")if(e.toLowerCase()==="svg")i=jv();else if(e[0]==="<"){const o=jv(e);i=document.importNode(o.firstChild,!0)}else i=document.createElementNS(qi.svg,e);else i=e;this.node=i,t&&this.setAttributes(t),n&&this.append(n)}get[Symbol.toStringTag](){return pn.toStringTag}get type(){return this.node.nodeName}get id(){return this.node.id}set id(e){this.node.id=e}transform(e,t){return e==null?wf(this.node):(wf(this.node,e,t),this)}translate(e,t=0,n={}){return e==null?D_(this.node):(D_(this.node,e,t,n),this)}rotate(e,t,n,i={}){return e==null?KC(this.node):(KC(this.node,e,t,n,i),this)}scale(e,t){return e==null?nu(this.node):(nu(this.node,e,t),this)}getTransformToElement(e){const t=pn.toNode(e);return tu(this.node,t)}removeAttribute(e){return o_(this.node,e),this}getAttribute(e){return l6(this.node,e)}setAttribute(e,t){return FC(this.node,e,t),this}setAttributes(e){return s_(this.node,e),this}attr(e,t){return e==null?ei(this.node):typeof e=="string"&&t===void 0?ei(this.node,e):(typeof e=="object"?ei(this.node,e):ei(this.node,e,t),this)}svg(){return this.node instanceof SVGSVGElement?this:pn.create(this.node.ownerSVGElement)}defs(){const e=this.svg()||this,t=e.node.getElementsByTagName("defs")[0];return t?pn.create(t):pn.create("defs").appendTo(e)}text(e,t={}){return y_(this.node,e,t),this}tagName(){return DC(this.node)}clone(){return pn.create(this.node.cloneNode(!0))}remove(){return bl(this.node),this}empty(){return IC(this.node),this}append(e){return Rg(this.node,pn.toNodes(e)),this}appendTo(e){return a6(this.node,pn.isVector(e)?e.node:e),this}prepend(e){return s6(this.node,pn.toNodes(e)),this}before(e){return LC(this.node,pn.toNodes(e)),this}replace(e){return this.node.parentNode&&this.node.parentNode.replaceChild(pn.toNode(e),this.node),pn.create(e)}first(){return this.node.firstChild?pn.create(this.node.firstChild):null}last(){return this.node.lastChild?pn.create(this.node.lastChild):null}get(e){const t=this.node.childNodes[e];return t?pn.create(t):null}indexOf(e){return Array.prototype.slice.call(this.node.childNodes).indexOf(pn.toNode(e))}find(e){const t=[],n=o6(this.node,e);if(n)for(let i=0,o=n.length;i<o;i+=1)t.push(pn.create(n[i]));return t}findOne(e){const t=RC(this.node,e);return t?pn.create(t):null}findParentByClass(e,t){const n=n_(this.node,e,t);return n?pn.create(n):null}matches(e){const t=this.node,n=this.node.matches,i=t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector||null;return i&&i.call(t,e)}contains(e){return kC(this.node,pn.isVector(e)?e.node:e)}wrap(e){const t=pn.create(e),n=this.node.parentNode;return n!=null&&n.insertBefore(t.node,this.node),t.append(this)}parent(e){let t=this;if(t.node.parentNode==null)return null;if(t=pn.create(t.node.parentNode),e==null)return t;do if(typeof e=="string"?t.matches(e):t instanceof e)return t;while(t=pn.create(t.node.parentNode));return t}children(){const e=this.node.childNodes,t=[];for(let n=0;n<e.length;n+=1)e[n].nodeType===1&&t.push(pn.create(e[n]));return t}eachChild(e,t){const n=this.children();for(let i=0,o=n.length;i<o;i+=1)e.call(n[i],n[i],i,n),t&&n[i].eachChild(e,t);return this}index(){return NC(this.node)}hasClass(e){return Dg(this.node,e)}addClass(e){return Qr(this.node,e),this}removeClass(e){return ma(this.node,e),this}toggleClass(e,t){return qS(this.node,e,t),this}toLocalPoint(e,t){return j6(this.node,e,t)}toGeometryShape(){return M_(this.node)}translateCenterToPoint(e){const n=this.getBBox({target:this.svg()}).getCenter();return this.translate(e.x-n.x,e.y-n.y),this}translateAndAutoOrient(e,t,n){return qC(this.node,e,t,n),this}animate(e){return H6(this.node,e)}animateTransform(e){return $6(this.node,e)}animateAlongPath(e,t){return W6(this.node,e,t)}normalizePath(){return this.tagName()==="path"&&this.attr("d",Dn.normalize(this.attr("d"))),this}bbox(e,t){return V6(this.node,e,t)}getBBox(e={}){return No(this.node,{recursive:e.recursive,target:e.target?pn.toNode(e.target):null})}sample(e=1){return this.node instanceof SVGPathElement?x_(this.node,e):[]}toPath(){return pn.create(E_(this.node))}toPathData(){return S_(this.node)}}(function(r){r.toStringTag=`X6.${r.name}`;function e(s){if(s==null)return!1;if(s instanceof r)return!0;const a=s[Symbol.toStringTag],l=s;return(a==null||a===r.toStringTag)&&l.node instanceof SVGElement&&typeof l.animate=="function"&&typeof l.sample=="function"&&typeof l.normalizePath=="function"&&typeof l.toPath=="function"}r.isVector=e;function t(s,a,l){return new r(s,a,l)}r.create=t;function n(s){if(s[0]==="<"){const a=jv(s),l=[];for(let c=0,u=a.childNodes.length;c<u;c+=1){const d=a.childNodes[c];l.push(t(document.importNode(d,!0)))}return l}return[t(s)]}r.createVectors=n;function i(s){return e(s)?s.node:s}r.toNode=i;function o(s){return Array.isArray(s)?s.map(a=>i(a)):[i(s)]}r.toNodes=o})(pn||(pn={}));function S6(r,e){const t=pn.create(e),n=pn.create("textPath"),i=r.d;if(i&&r["xlink:href"]===void 0){const o=pn.create("path").attr("d",i).appendTo(t.defs());n.attr("xlink:href",`#${o.id}`)}return typeof r=="object"&&n.attr(r),n.node}function _6(r,e,t){const n=t.eol,i=t.baseSize,o=t.lineHeight;let s=0,a;const l={},c=e.length-1;for(let u=0;u<=c;u+=1){let d=e[u],h=null;if(typeof d=="object"){const f=d.attrs,p=pn.create("tspan",f);a=p.node;let g=d.t;n&&u===c&&(g+=n),a.textContent=g;const v=f.class;v&&p.addClass(v),t.includeAnnotationIndices&&p.attr("annotations",d.annotations.join(",")),h=parseFloat(f["font-size"]),h===void 0&&(h=i),h&&h>s&&(s=h)}else n&&u===c&&(d+=n),a=document.createTextNode(d||" "),i&&i>s&&(s=i);r.appendChild(a)}return s&&(l.maxFontSize=s),o?l.lineHeight=o:s&&(l.lineHeight=s*1.2),l}const v_=/em$/;function Yv(r,e){const t=parseFloat(r);return v_.test(r)?t*e:t}function A6(r,e,t,n){if(!Array.isArray(e))return 0;const i=e.length;if(!i)return 0;let o=e[0];const s=Yv(o.maxFontSize,t)||t;let a=0;const l=Yv(n,t);for(let d=1;d<i;d+=1)o=e[d],a+=Yv(o.lineHeight,t)||l;const c=Yv(o.maxFontSize,t)||t;let u;switch(r){case"middle":u=s/2-.15*c-a/2;break;case"bottom":u=-(.25*c)-a;break;default:case"top":u=.8*s;break}return u}function y_(r,e,t={}){e=u6(e);const n=t.eol;let i=t.textPath;const o=t.textVerticalAnchor,s=o==="middle"||o==="bottom"||o==="top";let a=t.x;a===void 0&&(a=r.getAttribute("x")||0);const l=t.includeAnnotationIndices;let c=t.annotations;c&&!Array.isArray(c)&&(c=[c]);const u=t.lineHeight,d=u==="auto",h=d?"1.5em":u||"1em";IC(r),ei(r,{"xml:space":"preserve",display:e||t.displayEmpty?null:"none"});const f=ei(r,"font-size");let p=parseFloat(f);p||(p=16,(s||c)&&!f&&ei(r,"font-size",`${p}`));let g;i?(typeof i=="string"&&(i={d:i}),g=S6(i,r)):g=document.createDocumentFragment();let v,y=0,x;const E=e.split(`
`),T=[],P=E.length-1;for(let $=0;$<=P;$+=1){v=h;let ne="v-line";const De=Es("tspan");let fe,Ae=E[$];if(Ae)if(c){const de=c6(Ae,c,{offset:-y,includeAnnotationIndices:l});fe=_6(De,de,{eol:$!==P&&n,baseSize:p,lineHeight:d?null:h,includeAnnotationIndices:l});const ct=fe.lineHeight;ct&&d&&$!==0&&(v=ct),$===0&&(x=fe.maxFontSize*.8)}else n&&$!==P&&(Ae+=n),De.textContent=Ae;else{De.textContent="-",ne+=" v-empty-line";const de=De.style;de.fillOpacity=0,de.strokeOpacity=0,c&&(fe={})}fe&&T.push(fe),$>0&&De.setAttribute("dy",v),($>0||i)&&De.setAttribute("x",a),De.className.baseVal=ne,g.appendChild(De),y+=Ae.length+1}if(s)if(c)v=A6(o,T,p,h);else if(o==="top")v="0.8em";else{let $;switch(P>0?($=parseFloat(h)||1,$*=P,v_.test(h)||($/=p)):$=0,o){case"middle":v=`${.3-$/2}em`;break;case"bottom":v=`${-$-.3}em`;break;default:break}}else o===0?v="0em":o?v=o:(v=0,r.getAttribute("y")==null&&r.setAttribute("y",`${x||"0.8em"}`));g.firstChild.setAttribute("dy",v),r.appendChild(g)}function T6(r,e,t,n){const i=[],o=[];if(e!=null){const s=r.split(e);if(i.push(...s),typeof e=="string")for(let a=0,l=s.length-1;a<l;a+=1)o.push(e);else{const a=r.match(new RegExp(e,"g"));for(let l=0,c=s.length-1;l<c;l+=1)o.push(a?a[l]:"")}}else{let s="";for(let a=0,l=r.length;a<l;a+=1){const c=r[a];c===" "?(i.push(s),o.push(" "),s=""):c.match(/[^\x00-\xff]/)?(s.length&&(i.push(s),o.push("")),i.push(c),o.push(""),s=""):s+=c}s.length&&i.push(s)}for(let s=0;s<i.length;s+=1){const a=i[s];if(a.indexOf(t)>=0&&a.length>1){const l=a.split(t);for(let d=0,h=l.length-1;d<h;d+=1)l.splice(2*d+1,0,t);const c=l.filter(d=>d!=="");i.splice(s,1,...c);const u=c.map(()=>"");u.pop(),o.splice(s,0,...u)}}for(let s=0;s<i.length;s+=1){const a=i[s],l=a.search(n);l>0&&l<a.length-1&&(i.splice(s,1,a.substring(0,l+1),a.substring(l+1)),o.splice(s,0,""))}return{words:i,separators:o}}function b_(r,e,t={},n={}){const i=e.width,o=e.height,s=n.svgDocument||Es("svg"),a=Es("text"),l=Es("tspan"),c=document.createTextNode("");ei(a,t),a.appendChild(l),a.style.opacity="0",a.style.display="block",l.style.display="block",l.appendChild(c),s.appendChild(a);const u=s.parentNode==null;u&&document.body.appendChild(s);const d=n.eol||`
`,h=n.separator||" ",f=n.hyphen?new RegExp(n.hyphen):/[^\w\d]/,p=n.breakWord!==!1,g=[],v={};let y=[],x,E,T;const{words:P,separators:z}=T6(r,n.separator,d,f);for(let $=0,ne=0,De=P.length;$<De;$+=1){const fe=P[$];if(!!fe){if(fe===d){g[ne]=!0,ne+=1,y[ne]="";continue}if(y[ne]!=null?(T=z[$-1]||"",c.data=`${y[ne]}${T}${fe}`):c.data=fe,l.getComputedTextLength()<=i)y[ne]=c.data,v[ne]=z[$],x&&(g[ne]=!0,ne+=1,x=0);else{if(p){if(!y[ne]||x){const Ae=!!x,de=fe.length===1;if(x=fe.length-1,Ae||de){if(de){if(!y[ne]){y=[];break}P.splice($,2,fe+P[$+1]),z.splice($+1,1),g[ne]=!0,ne+=1,De-=1,$-=1;continue}P[$]=fe.substring(0,x),P[$+1]=fe.substring(x)+P[$+1]}else P.splice($,1,fe.substring(0,x),fe.substring(x)),z.splice($,0,""),De+=1,ne&&!g[ne-1]&&(ne-=1);$-=1;continue}}else if(!y[ne]){y[ne]=fe,g[ne]=!0,ne+=1;continue}ne+=1,$-=1}if(o!=null){if(E==null){let Ae;t.lineHeight==="auto"?Ae={value:1.5,unit:"em"}:Ae=zF(t.lineHeight,["em"])||{value:1,unit:"em"},E=Ae.value,Ae.unit==="em"&&(_i.IS_FIREFOX?E*=l.getBBox().height:E*=a.getBBox().height)}if(E*y.length>o){const Ae=Math.floor(o/E)-1,de=y[Ae],ct=y[Ae+1];if(y.splice(Ae+1),de==null)break;let bt=n.ellipsis;if(!bt)break;typeof bt!="string"&&(bt="\u2026");let Pe=de;ct&&p&&(Pe+=T+ct);let tt=Pe.length,Kt,tn;do{if(tn=Pe[tt],Kt=Pe.substring(0,tt),tn?tn.match(h)&&(Kt+=tn):Kt+=v[Ae],Kt+=bt,c.data=Kt,l.getComputedTextLength()<=i){y[Ae]=Kt;break}tt-=1}while(tt>=0);break}}}}return bl(u?s:a),y.join(d)}const XC=.551784;function ns(r,e,t=NaN){const n=r.getAttribute(e);if(n==null)return t;const i=parseFloat(n);return Number.isNaN(i)?t:i}function x_(r,e=1){const t=r.getTotalLength(),n=[];let i=0,o;for(;i<t;)o=r.getPointAtLength(i),n.push({distance:i,x:o.x,y:o.y}),i+=e;return n}function M6(r){return["M",ns(r,"x1"),ns(r,"y1"),"L",ns(r,"x2"),ns(r,"y2")].join(" ")}function P6(r){const e=Kv(r);return e.length===0?null:`${C_(e)} Z`}function O6(r){const e=Kv(r);return e.length===0?null:C_(e)}function C_(r){return`M ${r.map(t=>`${t.x} ${t.y}`).join(" L")}`}function Kv(r){const e=[],t=r.points;if(t)for(let n=0,i=t.numberOfItems;n<i;n+=1)e.push(t.getItem(n));return e}function D6(r){const e=ns(r,"cx",0),t=ns(r,"cy",0),n=ns(r,"r"),i=n*XC;return["M",e,t-n,"C",e+i,t-n,e+n,t-i,e+n,t,"C",e+n,t+i,e+i,t+n,e,t+n,"C",e-i,t+n,e-n,t+i,e-n,t,"C",e-n,t-i,e-i,t-n,e,t-n,"Z"].join(" ")}function N6(r){const e=ns(r,"cx",0),t=ns(r,"cy",0),n=ns(r,"rx"),i=ns(r,"ry")||n,o=n*XC,s=i*XC;return["M",e,t-i,"C",e+o,t-i,e+n,t-s,e+n,t,"C",e+n,t+s,e+o,t+i,e,t+i,"C",e-o,t+i,e-n,t+s,e-n,t,"C",e-n,t-s,e-o,t-i,e,t-i,"Z"].join(" ")}function R6(r){return w_({x:ns(r,"x",0),y:ns(r,"y",0),width:ns(r,"width",0),height:ns(r,"height",0),rx:ns(r,"rx",0),ry:ns(r,"ry",0)})}function w_(r){let e;const t=r.x,n=r.y,i=r.width,o=r.height,s=Math.min(r.rx||r["top-rx"]||0,i/2),a=Math.min(r.rx||r["bottom-rx"]||0,i/2),l=Math.min(r.ry||r["top-ry"]||0,o/2),c=Math.min(r.ry||r["bottom-ry"]||0,o/2);return s||a||l||c?e=["M",t,n+l,"v",o-l-c,"a",a,c,0,0,0,a,c,"h",i-2*a,"a",a,c,0,0,0,a,-c,"v",-(o-c-l),"a",s,l,0,0,0,-s,-l,"h",-(i-2*s),"a",s,l,0,0,0,-s,l,"Z"]:e=["M",t,n,"H",t+i,"V",n+o,"H",t,"V",n,"Z"],e.join(" ")}function E_(r){const e=Es("path");ei(e,ei(r));const t=S_(r);return t&&e.setAttribute("d",t),e}function S_(r){const e=r.tagName.toLowerCase();switch(e){case"path":return r.getAttribute("d");case"line":return M6(r);case"polygon":return P6(r);case"polyline":return O6(r);case"ellipse":return N6(r);case"circle":return D6(r);case"rect":return R6(r);default:break}throw new Error(`"${e}" cannot be converted to svg path element.`)}function k6(r,e,t,n){const i=2*Math.PI-1e-6,o=r,s=e;let a=t,l=n;if(l<a){const g=a;a=l,l=g}const c=l-a,u=c<Math.PI?"0":"1",d=Math.cos(a),h=Math.sin(a),f=Math.cos(l),p=Math.sin(l);return c>=i?o?`M0,${s}A${s},${s} 0 1,1 0,${-s}A${s},${s} 0 1,1 0,${s}M0,${o}A${o},${o} 0 1,0 0,${-o}A${o},${o} 0 1,0 0,${o}Z`:`M0,${s}A${s},${s} 0 1,1 0,${-s}A${s},${s} 0 1,1 0,${s}Z`:o?`M${s*d},${s*h}A${s},${s} 0 ${u},1 ${s*f},${s*p}L${o*f},${o*p}A${o},${o} 0 ${u},0 ${o*d},${o*h}Z`:`M${s*d},${s*h}A${s},${s} 0 ${u},1 ${s*f},${s*p}L0,0Z`}const Ig=Es("svg"),I6=/(\w+)\(([^,)]+),?([^)]+)?\)/gi,__=/[ ,]+/,L6=/^(\w+)\((.*)\)/;function A_(r,e){const t=Ig.createSVGPoint();return t.x=r,t.y=e,t}function Do(r){const e=Ig.createSVGMatrix();if(r!=null){const t=r,n=e;for(const i in t)n[i]=t[i]}return e}function Lg(r){return r!=null?(r instanceof DOMMatrix||(r=Do(r)),Ig.createSVGTransformFromMatrix(r)):Ig.createSVGTransform()}function Gg(r){let e=Do();const t=r!=null&&r.match(I6);if(!t)return e;for(let n=0,i=t.length;n<i;n+=1){const s=t[n].match(L6);if(s){let a,l,c,u,d,h=Do();const f=s[2].split(__);switch(s[1].toLowerCase()){case"scale":a=parseFloat(f[0]),l=f[1]===void 0?a:parseFloat(f[1]),h=h.scaleNonUniform(a,l);break;case"translate":c=parseFloat(f[0]),u=parseFloat(f[1]),h=h.translate(c,u);break;case"rotate":d=parseFloat(f[0]),c=parseFloat(f[1])||0,u=parseFloat(f[2])||0,c!==0||u!==0?h=h.translate(c,u).rotate(d).translate(-c,-u):h=h.rotate(d);break;case"skewx":d=parseFloat(f[0]),h=h.skewX(d);break;case"skewy":d=parseFloat(f[0]),h=h.skewY(d);break;case"matrix":h.a=parseFloat(f[0]),h.b=parseFloat(f[1]),h.c=parseFloat(f[2]),h.d=parseFloat(f[3]),h.e=parseFloat(f[4]),h.f=parseFloat(f[5]);break;default:continue}e=e.multiply(h)}}return e}function Nd(r){const e=r||{},t=e.a!=null?e.a:1,n=e.b!=null?e.b:0,i=e.c!=null?e.c:0,o=e.d!=null?e.d:1,s=e.e!=null?e.e:0,a=e.f!=null?e.f:0;return`matrix(${t},${n},${i},${o},${s},${a})`}function qv(r){let e,t,n;if(r){const o=__;if(r.trim().indexOf("matrix")>=0){const s=Gg(r),a=T_(s);e=[a.translateX,a.translateY],t=[a.rotation],n=[a.scaleX,a.scaleY];const l=[];(e[0]!==0||e[1]!==0)&&l.push(`translate(${e.join(",")})`),(n[0]!==1||n[1]!==1)&&l.push(`scale(${n.join(",")})`),t[0]!==0&&l.push(`rotate(${t[0]})`),r=l.join(" ")}else{const s=r.match(/translate\((.*?)\)/);s&&(e=s[1].split(o));const a=r.match(/rotate\((.*?)\)/);a&&(t=a[1].split(o));const l=r.match(/scale\((.*?)\)/);l&&(n=l[1].split(o))}}const i=n&&n[0]?parseFloat(n[0]):1;return{raw:r||"",translation:{tx:e&&e[0]?parseInt(e[0],10):0,ty:e&&e[1]?parseInt(e[1],10):0},rotation:{angle:t&&t[0]?parseInt(t[0],10):0,cx:t&&t[1]?parseInt(t[1],10):void 0,cy:t&&t[2]?parseInt(t[2],10):void 0},scale:{sx:i,sy:n&&n[1]?parseFloat(n[1]):i}}}function YC(r,e){const t=e.x*r.a+e.y*r.c+0,n=e.x*r.b+e.y*r.d+0;return{x:t,y:n}}function T_(r){const e=YC(r,{x:0,y:1}),t=YC(r,{x:1,y:0}),n=180/Math.PI*Math.atan2(e.y,e.x)-90,i=180/Math.PI*Math.atan2(t.y,t.x);return{skewX:n,skewY:i,translateX:r.e,translateY:r.f,scaleX:Math.sqrt(r.a*r.a+r.b*r.b),scaleY:Math.sqrt(r.c*r.c+r.d*r.d),rotation:n}}function G6(r){let e,t,n,i;return r?(e=r.a==null?1:r.a,i=r.d==null?1:r.d,t=r.b,n=r.c):e=i=1,{sx:t?Math.sqrt(e*e+t*t):e,sy:n?Math.sqrt(n*n+i*i):i}}function F6(r){let e={x:0,y:1};return r&&(e=YC(r,e)),{angle:Rr.normalize(Rr.toDeg(Math.atan2(e.y,e.x))-90)}}function B6(r){return{tx:r&&r.e||0,ty:r&&r.f||0}}function xl(r,e){const t=A_(r.x,r.y).matrixTransform(e);return new pe(t.x,t.y)}function z6(r,e){return new xn(xl(r.start,e),xl(r.end,e))}function wee(r,e){let t=r instanceof so?r.points:r;return Array.isArray(t)||(t=[]),new so(t.map(n=>xl(n,e)))}function Vs(r,e){const t=Ig.createSVGPoint();t.x=r.x,t.y=r.y;const n=t.matrixTransform(e);t.x=r.x+r.width,t.y=r.y;const i=t.matrixTransform(e);t.x=r.x+r.width,t.y=r.y+r.height;const o=t.matrixTransform(e);t.x=r.x,t.y=r.y+r.height;const s=t.matrixTransform(e),a=Math.min(n.x,i.x,o.x,s.x),l=Math.max(n.x,i.x,o.x,s.x),c=Math.min(n.y,i.y,o.y,s.y),u=Math.max(n.y,i.y,o.y,s.y);return new Ht(a,c,l-a,u-c)}var U6=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function V6(r,e,t){let n;const i=r.ownerSVGElement;if(!i)return new Ht(0,0,0,0);try{n=r.getBBox()}catch(s){n={x:r.clientLeft,y:r.clientTop,width:r.clientWidth,height:r.clientHeight}}if(e)return Ht.create(n);const o=tu(r,t||i);return Vs(n,o)}function No(r,e={}){let t;if(!r.ownerSVGElement||!Pd(r)){if(Hv(r)){const{left:s,top:a,width:l,height:c}=Z6(r);return new Ht(s,a,l,c)}return new Ht(0,0,0,0)}let i=e.target;if(!e.recursive){try{t=r.getBBox()}catch(a){t={x:r.clientLeft,y:r.clientTop,width:r.clientWidth,height:r.clientHeight}}if(!i)return Ht.create(t);const s=tu(r,i);return Vs(t,s)}{const s=r.childNodes,a=s.length;if(a===0)return No(r,{target:i});i||(i=r);for(let l=0;l<a;l+=1){const c=s[l];let u;c.childNodes.length===0?u=No(c,{target:i}):u=No(c,{target:i,recursive:!0}),t?t=t.union(u):t=u}return t}}function Eee(r){let e=r,t=e?e.tagName.toLowerCase():"";for(;t==="g";)e=e.firstElementChild,t=e?e.tagName.toLowerCase():"";const n=s=>{const a=e.getAttribute(s),l=a?parseFloat(a):0;return Number.isNaN(l)?0:l};let i,o;switch(t){case"rect":o=new Ht(n("x"),n("y"),n("width"),n("height"));break;case"circle":i=n("r"),o=new Ht(n("cx")-i,n("cy")-i,2*i,2*i);break;default:break}return o}function See(r,e){let t=Do();if(Pd(e)&&Pd(r)){let n=r;const i=[];for(;n&&n!==e;){const o=n.getAttribute("transform")||null,s=Gg(o);i.push(s),n=n.parentNode}i.reverse().forEach(o=>{t=t.multiply(o)})}return t}function tu(r,e){if(Pd(e)&&Pd(r)){const t=e.getScreenCTM(),n=r.getScreenCTM();if(t&&n)return t.inverse().multiply(n)}return Do()}function j6(r,e,t){const n=r instanceof SVGSVGElement?r:r.ownerSVGElement,i=n.createSVGPoint();i.x=e,i.y=t;try{const o=n.getScreenCTM(),s=i.matrixTransform(o.inverse()),a=tu(r,n).inverse();return s.matrixTransform(a)}catch(o){return i}}function M_(r){const e=t=>{const n=r.getAttribute(t),i=n?parseFloat(n):0;return Number.isNaN(i)?0:i};switch(r instanceof SVGElement&&r.nodeName.toLowerCase()){case"rect":return new Ht(e("x"),e("y"),e("width"),e("height"));case"circle":return new va(e("cx"),e("cy"),e("r"),e("r"));case"ellipse":return new va(e("cx"),e("cy"),e("rx"),e("ry"));case"polyline":{const t=Kv(r);return new so(t)}case"polygon":{const t=Kv(r);return t.length>1&&t.push(t[0]),new so(t)}case"path":{let t=r.getAttribute("d");return Dn.isValid(t)||(t=Dn.normalize(t)),Dn.parse(t)}case"line":return new xn(e("x1"),e("y1"),e("x2"),e("y2"));default:break}return No(r)}function _ee(r,e,t){const n=r instanceof SVGSVGElement?r:r.ownerSVGElement;t=t||n;const i=No(t),o=i.getCenter();if(!i.intersectsWithLineFromCenterToPoint(e))return null;let s=null;const a=r.tagName.toLowerCase();if(a==="rect"){const l=new Ht(parseFloat(r.getAttribute("x")||"0"),parseFloat(r.getAttribute("y")||"0"),parseFloat(r.getAttribute("width")||"0"),parseFloat(r.getAttribute("height")||"0")),c=tu(r,t),u=T_(c),d=n.createSVGTransform();d.setRotate(-u.rotation,o.x,o.y);const h=Vs(l,d.matrix.multiply(c));s=Ht.create(h).intersectsWithLineFromCenterToPoint(e,u.rotation)}else if(a==="path"||a==="polygon"||a==="polyline"||a==="circle"||a==="ellipse"){const l=a==="path"?r:E_(r),c=x_(l);let u=Infinity,d=[];for(let h=0,f=c.length;h<f;h+=1){const p=c[h];let g=A_(p.x,p.y);g=g.matrixTransform(tu(r,t));const v=pe.create(g),y=v.distance(o),x=v.distance(e)*1.1,E=y+x;E<u?(u=E,d=[{sample:p,refDistance:x}]):E<u+1&&d.push({sample:p,refDistance:x})}d.sort((h,f)=>h.refDistance-f.refDistance),d[0]&&(s=pe.create(d[0].sample))}return s}function H6(r,e){return P_(r,e,"animate")}function $6(r,e){return P_(r,e,"animateTransform")}function P_(r,e,t){const n=Es(t);r.appendChild(n);try{return O_(n,e)}catch(i){}return()=>{}}function O_(r,e){const{start:t,complete:n,repeat:i}=e,o=U6(e,["start","complete","repeat"]);ei(r,o),t&&r.addEventListener("beginEvent",t),n&&r.addEventListener("endEvent",n),i&&r.addEventListener("repeatEvent",i);const s=r;return setTimeout(()=>{s.beginElement()}),()=>s.endElement()}function W6(r,e,t){const n=Vv(t),i=Es("animateMotion"),o=Es("mpath");ei(o,{"xlink:href":`#${n}`}),i.appendChild(o),r.appendChild(i);try{return O_(i,e)}catch(s){if(document.documentElement.getAttribute("smiling")==="fake"){const a=i;a.animators=[];const l=window,c=a.getAttribute("id");c&&(l.id2anim[c]=a);const u=l.getTargets(a);for(let d=0,h=u.length;d<h;d+=1){const f=u[d],p=new l.Animator(a,f,d);l.animators.push(p),a.animators[d]=p,p.register()}}}return()=>{}}function Z6(r){let e=0,t=0,n=0,i=0;if(r){let o=r;for(;o;)e+=o.offsetLeft,t+=o.offsetTop,o=o.offsetParent,o&&(e+=parseInt($C(o,"borderLeft"),10),t+=parseInt($C(o,"borderTop"),10));n=r.offsetWidth,i=r.offsetHeight}return{left:e,top:t,width:n,height:i}}function wf(r,e,t={}){if(e==null)return Gg(ei(r,"transform"));if(t.absolute){r.setAttribute("transform",Nd(e));return}const n=r.transform,i=Lg(e);n.baseVal.appendItem(i)}function D_(r,e,t=0,n={}){let i=ei(r,"transform");const o=qv(i);if(e==null)return o.translation;i=o.raw,i=i.replace(/translate\([^)]*\)/g,"").trim();const s=n.absolute?e:o.translation.tx+e,a=n.absolute?t:o.translation.ty+t,l=`translate(${s},${a})`;r.setAttribute("transform",`${l} ${i}`.trim())}function KC(r,e,t,n,i={}){let o=ei(r,"transform");const s=qv(o);if(e==null)return s.rotation;o=s.raw,o=o.replace(/rotate\([^)]*\)/g,"").trim(),e%=360;const a=i.absolute?e:s.rotation.angle+e,l=t!=null&&n!=null?`,${t},${n}`:"",c=`rotate(${a}${l})`;r.setAttribute("transform",`${o} ${c}`.trim())}function nu(r,e,t){let n=ei(r,"transform");const i=qv(n);if(e==null)return i.scale;t=t==null?e:t,n=i.raw,n=n.replace(/scale\([^)]*\)/g,"").trim();const o=`scale(${e},${t})`;r.setAttribute("transform",`${n} ${o}`.trim())}function qC(r,e,t,n){const i=pe.create(e),o=pe.create(t);n||(n=r instanceof SVGSVGElement?r:r.ownerSVGElement);const s=nu(r);r.setAttribute("transform","");const a=No(r,{target:n}).scale(s.sx,s.sy),l=Lg();l.setTranslate(-a.x-a.width/2,-a.y-a.height/2);const c=Lg(),u=i.angleBetween(o,i.clone().translate(1,0));u&&c.setRotate(u,0,0);const d=Lg(),h=i.clone().move(o,a.width/2);d.setTranslate(2*i.x-h.x,2*i.y-h.y);const f=tu(r,n),p=Lg();p.setMatrix(d.matrix.multiply(c.matrix.multiply(l.matrix.multiply(f.scale(s.sx,s.sy))))),r.setAttribute("transform",Nd(p.matrix))}class N_{constructor(e,t,n){this.animationFrameId=0,this.deltaX=0,this.deltaY=0,this.eventName=_i.isEventSupported("wheel")?"wheel":"mousewheel",this.target=e,this.onWheelCallback=t,this.onWheelGuard=n,this.onWheel=this.onWheel.bind(this),this.didWheel=this.didWheel.bind(this)}enable(){_i.SUPPORT_PASSIVE?this.target.addEventListener(this.eventName,this.onWheel,{passive:!1}):jr()(this.target).on("mousewheel",this.onWheel)}disable(){_i.SUPPORT_PASSIVE?this.target.removeEventListener(this.eventName,this.onWheel):jr()(this.target).off("mousewheel")}onWheel(e){if(this.onWheelGuard!=null&&!this.onWheelGuard(e))return;this.deltaX+=e.deltaX,this.deltaY+=e.deltaY,e.preventDefault();let t;(this.deltaX!==0||this.deltaY!==0)&&(e.stopPropagation(),t=!0),t===!0&&this.animationFrameId===0&&(this.animationFrameId=requestAnimationFrame(()=>{this.didWheel(e)}))}didWheel(e){this.animationFrameId=0,this.onWheelCallback(e,this.deltaX,this.deltaY),this.deltaX=0,this.deltaY=0}}const Aee=pn.isVector,Tee=pn.create,Mee=pn.createVectors;function R_(r,e=60){let t=null;return(...n)=>{t&&clearTimeout(t),t=window.setTimeout(()=>{r.apply(this,n)},e)}}function X6(r){let e=null,t=[];const n=()=>{if(getComputedStyle(r).position==="static"){const c=r.style;c.position="relative"}const l=document.createElement("object");return l.onload=()=>{l.contentDocument.defaultView.addEventListener("resize",i),i()},l.style.display="block",l.style.position="absolute",l.style.top="0",l.style.left="0",l.style.height="100%",l.style.width="100%",l.style.overflow="hidden",l.style.pointerEvents="none",l.style.zIndex="-1",l.style.opacity="0",l.setAttribute("tabindex","-1"),l.type="text/html",r.appendChild(l),l.data="about:blank",l},i=R_(()=>{t.forEach(l=>l(r))}),o=l=>{e||(e=n()),t.indexOf(l)===-1&&t.push(l)},s=()=>{e&&e.parentNode&&(e.contentDocument&&e.contentDocument.defaultView.removeEventListener("resize",i),e.parentNode.removeChild(e),e=null,t=[])};return{element:r,bind:o,destroy:s,unbind:l=>{const c=t.indexOf(l);c!==-1&&t.splice(c,1),t.length===0&&e&&s()}}}function Y6(r){let e=null,t=[];const n=R_(()=>{t.forEach(l=>{l(r)})}),i=()=>{const l=new ResizeObserver(n);return l.observe(r),n(),l},o=l=>{e||(e=i()),t.indexOf(l)===-1&&t.push(l)},s=()=>{e&&(e.disconnect(),t=[],e=null)};return{element:r,bind:o,destroy:s,unbind:l=>{const c=t.indexOf(l);c!==-1&&t.splice(c,1),t.length===0&&e&&s()}}}const K6=typeof ResizeObserver!="undefined"?Y6:X6;var Jv;(function(r){const e=new WeakMap;function t(i){let o=e.get(i);return o||(o=K6(i),e.set(i,o),o)}function n(i){i.destroy(),e.delete(i.element)}r.bind=(i,o)=>{const s=t(i);return s.bind(o),()=>s.unbind(o)},r.clear=i=>{const o=t(i);n(o)}})(Jv||(Jv={}));var Fg;(function(r){const e=[],t=1e3/60,n=[];let i=0;const o=()=>performance.now(),s=u=>u[0],a=u=>n.push(u)===1&&l(),l=(()=>{const u=()=>{var d,h;return(h=(d=n.splice(0,n.length))[0])===null||h===void 0?void 0:h.call(d)};if(typeof MessageChannel!="undefined"){const{port1:d,port2:h}=new MessageChannel;return d.onmessage=u,()=>h.postMessage(null)}return()=>setTimeout(u)})(),c=()=>{i=o()+t;let u=s(e);for(;u&&!r.shouldYield();){const{callback:d,data:h}=u;u.callback=null;const f=d&&d(h);f?u.callback=f:e.shift(),u=s(e)}u&&a(c)};r.scheduleTask=(u,d)=>{const h={callback:u,data:d};e.push(h),a(c)},r.shouldYield=()=>{var u,d;return((d=(u=navigator)===null||u===void 0?void 0:u.scheduling)===null||d===void 0?void 0:d.isInputPending())||o()>=i}})(Fg||(Fg={}));class Qi{constructor(e){this.options=Object.assign({},e),this.data=this.options.data||{},this.register=this.register.bind(this),this.unregister=this.unregister.bind(this)}get names(){return Object.keys(this.data)}register(e,t,n=!1){if(typeof e=="object"){Object.keys(e).forEach(s=>{this.register(s,e[s],t)});return}this.exist(e)&&!n&&!_i.isApplyingHMR()&&this.onDuplicated(e);const i=this.options.process,o=i?dn(i,this,e,t):t;return this.data[e]=o,o}unregister(e){const t=e?this.data[e]:null;return delete this.data[e],t}get(e){return e?this.data[e]:null}exist(e){return e?this.data[e]!=null:!1}onDuplicated(e){try{throw this.options.onConflict&&dn(this.options.onConflict,this,e),new Error(`${Og(this.options.type)} with name '${e}' already registered.`)}catch(t){throw t}}onNotFound(e,t){throw new Error(this.getSpellingSuggestion(e,t))}getSpellingSuggestion(e,t){const n=this.getSpellingSuggestionForName(e),i=t?`${t} ${yF(this.options.type)}`:this.options.type;return`${Og(i)} with name '${e}' does not exist.${n?` Did you mean '${n}'?`:""}`}getSpellingSuggestionForName(e){return bF(e,Object.keys(this.data),t=>t)}}(function(r){function e(t){return new r(t)}r.create=e})(Qi||(Qi={}));const q6={xlinkHref:"xlink:href",xlinkShow:"xlink:show",xlinkRole:"xlink:role",xlinkType:"xlink:type",xlinkArcrole:"xlink:arcrole",xlinkTitle:"xlink:title",xlinkActuate:"xlink:actuate",xmlSpace:"xml:space",xmlBase:"xml:base",xmlLang:"xml:lang",preserveAspectRatio:"preserveAspectRatio",requiredExtension:"requiredExtension",requiredFeatures:"requiredFeatures",systemLanguage:"systemLanguage",externalResourcesRequired:"externalResourceRequired"},J6={},k_={position:Qv("x","width","origin")},I_={position:Qv("y","height","origin")},Q6={position:Qv("x","width","corner")},e5={position:Qv("y","height","corner")},L_={set:ru("width","width")},G_={set:ru("height","height")},t5={set:ru("rx","width")},n5={set:ru("ry","height")},F_={set:(r=>{const e=ru(r,"width"),t=ru(r,"height");return function(n,i){const o=i.refBBox,s=o.height>o.width?e:t;return dn(s,this,n,i)}})("r")},r5={set(r,{refBBox:e}){let t=parseFloat(r);const n=yl(r);n&&(t/=100);const i=Math.sqrt(e.height*e.height+e.width*e.width);let o;return Number.isFinite(t)&&(n||t>=0&&t<=1?o=t*i:o=Math.max(t+i,0)),{r:o}}},i5={set:ru("cx","width")},o5={set:ru("cy","height")},B_={set:V_({resetOffset:!0})},s5={set:V_({resetOffset:!1})},z_={set:j_({resetOffset:!0})},a5={set:j_({resetOffset:!1})},l5=F_,c5=B_,u5=z_,d5=k_,h5=I_,f5=L_,p5=G_;function Qv(r,e,t){return(n,{refBBox:i})=>{if(n==null)return null;let o=parseFloat(n);const s=yl(n);s&&(o/=100);let a;if(Number.isFinite(o)){const c=i[t];s||o>0&&o<1?a=c[r]+i[e]*o:a=c[r]+o}const l=new pe;return l[r]=a||0,l}}function ru(r,e){return function(t,{refBBox:n}){let i=parseFloat(t);const o=yl(t);o&&(i/=100);const s={};if(Number.isFinite(i)){const a=o||i>=0&&i<=1?i*n[e]:Math.max(i+n[e],0);s[r]=a}return s}}function U_(r,e){const t="x6-shape",n=e&&e.resetOffset;return function(i,{view:o,elem:s,refBBox:a}){const l=o.$(s);let c=l.data(t);if(!c||c.value!==i){const y=r(i);c={value:i,shape:y,shapeBBox:y.bbox()},l.data(t,c)}const u=c.shape.clone(),d=c.shapeBBox.clone(),h=d.getOrigin(),f=a.getOrigin();d.x=f.x,d.y=f.y;const p=a.getMaxScaleToFit(d,f),g=d.width===0||a.width===0?1:p.sx,v=d.height===0||a.height===0?1:p.sy;return u.scale(g,v,h),n&&u.translate(-h.x,-h.y),u}}function V_(r){function e(n){return Dn.parse(n)}const t=U_(e,r);return(n,i)=>({d:t(n,i).serialize()})}function j_(r){const e=U_(t=>new so(t),r);return(t,n)=>({points:e(t,n).serialize()})}const g5={qualify:Rt,set(r,{view:e}){return`url(#${e.graph.defineGradient(r)})`}},m5={qualify:Rt,set(r,{view:e}){const t=e.cell,n=Object.assign({},r);if(t.isEdge()&&n.type==="linearGradient"){const i=e,o=i.sourcePoint,s=i.targetPoint;n.id=`gradient-${n.type}-${t.id}`,n.attrs=Object.assign(Object.assign({},n.attrs),{x1:o.x,y1:o.y,x2:s.x,y2:s.y,gradientUnits:"userSpaceOnUse"}),e.graph.defs.remove(n.id)}return`url(#${e.graph.defineGradient(n)})`}},H_={qualify(r,{attrs:e}){return e.textWrap==null||!Rt(e.textWrap)},set(r,{view:e,elem:t,attrs:n}){const i="x6-text",o=e.$(t),s=o.data(i),a=d=>{try{return JSON.parse(d)}catch(h){return d}},l={x:n.x,eol:n.eol,annotations:a(n.annotations),textPath:a(n["text-path"]||n.textPath),textVerticalAnchor:n["text-vertical-anchor"]||n.textVerticalAnchor,displayEmpty:(n["display-empty"]||n.displayEmpty)==="true",lineHeight:n["line-height"]||n.lineHeight},c=n["font-size"]||n.fontSize,u=JSON.stringify([r,l]);if(c&&t.setAttribute("font-size",c),s==null||s!==u){const d=l.textPath;if(d!=null&&typeof d=="object"){const h=d.selector;if(typeof h=="string"){const f=e.find(h)[0];f instanceof SVGPathElement&&(Vv(f),l.textPath=Object.assign({"xlink:href":`#${f.id}`},d))}}y_(t,`${r}`,l),o.data(i,u)}}},v5={qualify:Rt,set(r,{view:e,elem:t,attrs:n,refBBox:i}){const o=r,s=o.width||0;yl(s)?i.width*=parseFloat(s)/100:s<=0?i.width+=s:i.width=s;const a=o.height||0;yl(a)?i.height*=parseFloat(a)/100:a<=0?i.height+=a:i.height=a;let l,c=o.text;c==null&&(c=n.text),c!=null?l=b_(`${c}`,i,{"font-weight":n["font-weight"]||n.fontWeight,"font-size":n["font-size"]||n.fontSize,"font-family":n["font-family"]||n.fontFamily,lineHeight:n.lineHeight},{svgDocument:e.graph.view.svg,ellipsis:o.ellipsis,hyphen:o.hyphen,breakWord:o.breakWord}):l="",dn(H_.set,this,l,{view:e,elem:t,attrs:n,refBBox:i,cell:e.cell})}},Ef=(r,{attrs:e})=>e.text!==void 0,y5={qualify:Ef},b5={qualify:Ef},x5={qualify:Ef},C5={qualify:Ef},w5={qualify:Ef},E5={qualify:Ef},S5={qualify(r,{elem:e}){return e instanceof SVGElement},set(r,{view:e,elem:t}){const n="x6-title",i=`${r}`,o=e.$(t),s=o.data(n);if(s==null||s!==i){o.data(n,i);const a=t.firstChild;if(a&&a.tagName.toUpperCase()==="TITLE"){const l=a;l.textContent=i}else{const l=document.createElementNS(t.namespaceURI,"title");l.textContent=i,t.insertBefore(l,a)}}}},_5={offset:$_("x","width","right")},A5={offset:$_("y","height","bottom")},T5={offset(r,{refBBox:e}){return r?{x:-e.x,y:-e.y}:{x:0,y:0}}};function $_(r,e,t){return(n,{refBBox:i})=>{const o=new pe;let s;return n==="middle"?s=i[e]/2:n===t?s=i[e]:typeof n=="number"&&Number.isFinite(n)?s=n>-1&&n<1?-i[e]*n:-n:yl(n)?s=i[e]*parseFloat(n)/100:s=0,o[r]=-(i[r]+s),o}}const M5={qualify:Rt,set(r,{view:e,elem:t}){e.$(t).css(r)}},P5={set(r,{view:e,elem:t}){e.$(t).html(`${r}`)}},O5={qualify:Rt,set(r,{view:e}){return`url(#${e.graph.defineFilter(r)})`}},D5={set(r){return r!=null&&typeof r=="object"&&r.id?r.id:r}};function iu(r,e,t){let n,i;typeof e=="object"?(n=e.x,i=e.y):(n=e,i=t);const o=Dn.parse(r),s=o.bbox();if(s){let a=-s.height/2-s.y,l=-s.width/2-s.x;typeof n=="number"&&(l-=n),typeof i=="number"&&(a-=i),o.translate(l,a)}return o.serialize()}var W_=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const N5=r=>{var{size:e,width:t,height:n,offset:i,open:o}=r,s=W_(r,["size","width","height","offset","open"]);return Z_({size:e,width:t,height:n,offset:i},o===!0,!0,void 0,s)},R5=r=>{var{size:e,width:t,height:n,offset:i,factor:o}=r,s=W_(r,["size","width","height","offset","factor"]);return Z_({size:e,width:t,height:n,offset:i},!1,!1,o,s)};function Z_(r,e,t,n=3/4,i={}){const o=r.size||10,s=r.width||o,a=r.height||o,l=new Dn,c={};if(e)l.moveTo(s,0).lineTo(0,a/2).lineTo(s,a),c.fill="none";else{if(l.moveTo(0,a/2),l.lineTo(s,0),!t){const u=ws(n,0,1);l.lineTo(s*u,a/2)}l.lineTo(s,a),l.close()}return Object.assign(Object.assign(Object.assign({},c),i),{tagName:"path",d:iu(l.serialize(),{x:r.offset!=null?r.offset:-s/2})})}var k5=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const I5=r=>{var{size:e,width:t,height:n,offset:i}=r,o=k5(r,["size","width","height","offset"]);const s=e||10,a=t||s,l=n||s,c=new Dn;return c.moveTo(0,l/2).lineTo(a/2,0).lineTo(a,l/2).lineTo(a/2,l).close(),Object.assign(Object.assign({},o),{tagName:"path",d:iu(c.serialize(),i==null?-a/2:i)})};var L5=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const G5=r=>{var{d:e,offsetX:t,offsetY:n}=r,i=L5(r,["d","offsetX","offsetY"]);return Object.assign(Object.assign({},i),{tagName:"path",d:iu(e,t,n)})};var F5=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const B5=r=>{var{size:e,width:t,height:n,offset:i}=r,o=F5(r,["size","width","height","offset"]);const s=e||10,a=t||s,l=n||s,c=new Dn;return c.moveTo(0,0).lineTo(a,l).moveTo(0,l).lineTo(a,0),Object.assign(Object.assign({},o),{tagName:"path",fill:"none",d:iu(c.serialize(),i||-a/2)})};var z5=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const U5=r=>{var{width:e,height:t,offset:n,open:i,flip:o}=r,s=z5(r,["width","height","offset","open","flip"]);let a=t||6;const l=e||10,c=i===!0,u=o===!0,d=Object.assign(Object.assign({},s),{tagName:"path"});u&&(a=-a);const h=new Dn;return h.moveTo(0,a).lineTo(l,0),c?d.fill="none":(h.lineTo(l,a),h.close()),d.d=iu(h.serialize(),{x:n||-l/2,y:a/2}),d};var X_=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const Y_=r=>{var{r:e}=r,t=X_(r,["r"]);const n=e||5;return Object.assign(Object.assign({cx:n},t),{tagName:"circle",r:n})},V5=r=>{var{r:e}=r,t=X_(r,["r"]);const n=e||5,i=new Dn;return i.moveTo(n,0).lineTo(n,n*2),i.moveTo(0,n).lineTo(n*2,n),{children:[Object.assign(Object.assign({},Y_({r:n})),{fill:"none"}),Object.assign(Object.assign({},t),{tagName:"path",d:iu(i.serialize(),-n)})]}};var j5=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const H5=r=>{var{rx:e,ry:t}=r,n=j5(r,["rx","ry"]);const i=e||5,o=t||5;return Object.assign(Object.assign({cx:i},n),{tagName:"ellipse",rx:i,ry:o})};var ou;(function(r){r.presets=D,r.registry=Qi.create({type:"marker"}),r.registry.register(r.presets,!0)})(ou||(ou={})),function(r){r.normalize=iu}(ou||(ou={}));var $5=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function JC(r){return typeof r=="string"||Rt(r)}const W5={qualify:JC,set(r,{view:e,attrs:t}){return QC("marker-start",r,e,t)}},Z5={qualify:JC,set(r,{view:e,attrs:t}){return QC("marker-end",r,e,t,{transform:"rotate(180)"})}},X5={qualify:JC,set(r,{view:e,attrs:t}){return QC("marker-mid",r,e,t)}};function QC(r,e,t,n,i={}){const o=typeof e=="string"?{name:e}:e,{name:s,args:a}=o,l=$5(o,["name","args"]);let c=l;if(s&&typeof s=="string"){const d=ou.registry.get(s);if(d)c=d(Object.assign(Object.assign({},l),a));else return ou.registry.onNotFound(s)}const u=Object.assign(Object.assign(Object.assign({},Y5(n,r)),i),c);return{[r]:`url(#${t.graph.defineMarker(u)})`}}function Y5(r,e){const t={},n=r.stroke;typeof n=="string"&&(t.stroke=n,t.fill=n);let i=r.strokeOpacity;if(i==null&&(i=r["stroke-opacity"]),i==null&&(i=r.opacity),i!=null&&(t["stroke-opacity"]=i,t["fill-opacity"]=i),e!=="marker-mid"){const o=parseFloat(r.strokeWidth||r["stroke-width"]);if(Number.isFinite(o)&&o>1){const s=Math.ceil(o/2);t.refX=e==="marker-start"?s:-s}}return t}const Bg=(r,{view:e})=>e.cell.isEdge(),K5={qualify:Bg,set(r,e){var t,n,i,o;const s=e.view,a=r.reverse||!1,l=r.stubs||0;let c;if(Number.isFinite(l)&&l!==0)if(a){let u,d;const h=s.getConnectionLength()||0;l<0?(u=(h+l)/2,d=-l):(u=l,d=h-l*2);const f=s.getConnection();c=(o=(i=(n=(t=f==null?void 0:f.divideAtLength(u))===null||t===void 0?void 0:t[1])===null||n===void 0?void 0:n.divideAtLength(d))===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.serialize()}else{let u;l<0?u=((s.getConnectionLength()||0)+l)/2:u=l;const d=s.getConnection();if(d){const h=d.divideAtLength(u),f=d.divideAtLength(-u);h&&f&&(c=`${h[0].serialize()} ${f[1].serialize()}`)}}return{d:c||s.getConnectionPathData()}}},K_={qualify:Bg,set:ey("getTangentAtLength",{rotate:!0})},q5={qualify:Bg,set:ey("getTangentAtLength",{rotate:!1})},q_={qualify:Bg,set:ey("getTangentAtRatio",{rotate:!0})},J5={qualify:Bg,set:ey("getTangentAtRatio",{rotate:!1})},Q5=K_,eB=q_;function ey(r,e){const t={x:1,y:0};return(n,i)=>{let o,s;const a=i.view,l=a[r](Number(n));return l?(s=e.rotate?l.vector().vectorAngle(t):0,o=l.start):(o=a.path.start,s=0),s===0?{transform:`translate(${o.x},${o.y}')`}:{transform:`translate(${o.x},${o.y}') rotate(${s})`}}}var Cl;(function(r){function e(t,n,i){return!!(t!=null&&(typeof t=="string"||typeof t.qualify!="function"||dn(t.qualify,this,n,i)))}r.isValidDefinition=e})(Cl||(Cl={})),function(r){r.presets=Object.assign(Object.assign({},q6),F),r.registry=Qi.create({type:"attribute definition"}),r.registry.register(r.presets,!0)}(Cl||(Cl={}));const tB={color:"#aaaaaa",thickness:1,markup:"rect",update(r,e){const t=e.thickness*e.sx,n=e.thickness*e.sy;ei(r,{width:t,height:n,rx:t,ry:n,fill:e.color})}},nB={color:"#aaaaaa",thickness:1,markup:"rect",update(r,e){const t=e.sx<=1?e.thickness*e.sx:e.thickness;ei(r,{width:t,height:t,rx:t,ry:t,fill:e.color})}},rB={color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(r,e){let t;const n=e.width,i=e.height,o=e.thickness;n-o>=0&&i-o>=0?t=["M",n,0,"H0 M0 0 V0",i].join(" "):t="M 0 0 0 0",ei(r,{d:t,stroke:e.color,"stroke-width":e.thickness})}},iB=[{color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(r,e){let t;const n=e.width,i=e.height,o=e.thickness;n-o>=0&&i-o>=0?t=["M",n,0,"H0 M0 0 V0",i].join(" "):t="M 0 0 0 0",ei(r,{d:t,stroke:e.color,"stroke-width":e.thickness})}},{color:"rgba(224,224,224,0.2)",thickness:3,factor:4,markup:"path",update(r,e){let t;const n=e.factor||1,i=e.width*n,o=e.height*n,s=e.thickness;i-s>=0&&o-s>=0?t=["M",i,0,"H0 M0 0 V0",o].join(" "):t="M 0 0 0 0",e.width=i,e.height=o,ei(r,{d:t,stroke:e.color,"stroke-width":e.thickness})}}];class su{constructor(){this.patterns={},this.root=pn.create(jv(),{width:"100%",height:"100%"},[Es("defs")]).node}add(e,t){const n=this.root.childNodes[0];n&&n.appendChild(t),this.patterns[e]=t,pn.create("rect",{width:"100%",height:"100%",fill:`url(#${e})`}).appendTo(this.root)}get(e){return this.patterns[e]}has(e){return this.patterns[e]!=null}}(function(r){r.presets=U,r.registry=Qi.create({type:"grid"}),r.registry.register(r.presets,!0)})(su||(su={}));function e1(r,e){return r!=null?r:e}function Zo(r,e){return r!=null&&Number.isFinite(r)?r:e}function oB(r={}){const e=e1(r.color,"blue"),t=Zo(r.width,1),n=Zo(r.margin,2),i=Zo(r.opacity,1),o=n,s=n+t;return`
    <filter>
      <feFlood flood-color="${e}" flood-opacity="${i}" result="colored"/>
      <feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${s}" />
      <feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${o}" />
      <feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/>
      <feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/>
      <feMerge>
        <feMergeNode in="outline"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  `.trim()}function sB(r={}){const e=e1(r.color,"red"),t=Zo(r.blur,0),n=Zo(r.width,1),i=Zo(r.opacity,1);return`
      <filter>
        <feFlood flood-color="${e}" flood-opacity="${i}" result="colored"/>
        <feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${n}"/>
        <feComposite result="composed" in="colored" in2="morphed" operator="in"/>
        <feGaussianBlur result="blured" in="composed" stdDeviation="${t}"/>
        <feBlend in="SourceGraphic" in2="blured" mode="normal"/>
      </filter>
    `.trim()}function aB(r={}){const e=Zo(r.x,2);return`
    <filter>
      <feGaussianBlur stdDeviation="${r.y!=null&&Number.isFinite(r.y)?[e,r.y]:e}"/>
    </filter>
  `.trim()}function lB(r={}){const e=Zo(r.dx,0),t=Zo(r.dy,0),n=e1(r.color,"black"),i=Zo(r.blur,4),o=Zo(r.opacity,1);return"SVGFEDropShadowElement"in window?`<filter>
         <feDropShadow stdDeviation="${i}" dx="${e}" dy="${t}" flood-color="${n}" flood-opacity="${o}" />
       </filter>`.trim():`<filter>
         <feGaussianBlur in="SourceAlpha" stdDeviation="${i}" />
         <feOffset dx="${e}" dy="${t}" result="offsetblur" />
         <feFlood flood-color="${n}" />
         <feComposite in2="offsetblur" operator="in" />
         <feComponentTransfer>
           <feFuncA type="linear" slope="${o}" />
         </feComponentTransfer>
         <feMerge>
           <feMergeNode/>
           <feMergeNode in="SourceGraphic"/>
         </feMerge>
       </filter>`.trim()}function cB(r={}){const e=Zo(r.amount,1),t=.2126+.7874*(1-e),n=.7152-.7152*(1-e),i=.0722-.0722*(1-e),o=.2126-.2126*(1-e),s=.7152+.2848*(1-e),a=.0722-.0722*(1-e),l=.2126-.2126*(1-e),c=.0722+.9278*(1-e);return`
    <filter>
      <feColorMatrix type="matrix" values="${t} ${n} ${i} 0 0 ${o} ${s} ${a} 0 0 ${l} ${n} ${c} 0 0 0 0 0 1 0"/>
    </filter>
  `.trim()}function uB(r={}){const e=Zo(r.amount,1),t=.393+.607*(1-e),n=.769-.769*(1-e),i=.189-.189*(1-e),o=.349-.349*(1-e),s=.686+.314*(1-e),a=.168-.168*(1-e),l=.272-.272*(1-e),c=.534-.534*(1-e),u=.131+.869*(1-e);return`
      <filter>
        <feColorMatrix type="matrix" values="${t} ${n} ${i} 0 0 ${o} ${s} ${a} 0 0 ${l} ${c} ${u} 0 0 0 0 0 1 0"/>
      </filter>
    `.trim()}function dB(r={}){const e=Zo(r.amount,1);return`
      <filter>
        <feColorMatrix type="saturate" values="${1-e}"/>
      </filter>
    `.trim()}function hB(r={}){return`
      <filter>
        <feColorMatrix type="hueRotate" values="${Zo(r.angle,0)}"/>
      </filter>
    `.trim()}function fB(r={}){const e=Zo(r.amount,1),t=1-e;return`
      <filter>
        <feComponentTransfer>
          <feFuncR type="table" tableValues="${e} ${t}"/>
          <feFuncG type="table" tableValues="${e} ${t}"/>
          <feFuncB type="table" tableValues="${e} ${t}"/>
        </feComponentTransfer>
      </filter>
    `.trim()}function pB(r={}){const e=Zo(r.amount,1);return`
    <filter>
      <feComponentTransfer>
        <feFuncR type="linear" slope="${e}"/>
        <feFuncG type="linear" slope="${e}"/>
        <feFuncB type="linear" slope="${e}"/>
      </feComponentTransfer>
    </filter>
  `.trim()}function gB(r={}){const e=Zo(r.amount,1),t=.5-e/2;return`
    <filter>
     <feComponentTransfer>
        <feFuncR type="linear" slope="${e}" intercept="${t}"/>
        <feFuncG type="linear" slope="${e}" intercept="${t}"/>
        <feFuncB type="linear" slope="${e}" intercept="${t}"/>
      </feComponentTransfer>
    </filter>
  `.trim()}var Sf;(function(r){r.presets=X,r.registry=Qi.create({type:"filter"}),r.registry.register(r.presets,!0)})(Sf||(Sf={}));const J_=function(r){const e=document.createElement("canvas"),t=r.width,n=r.height;e.width=t*2,e.height=n;const i=e.getContext("2d");return i.drawImage(r,0,0,t,n),i.translate(2*t,0),i.scale(-1,1),i.drawImage(r,0,0,t,n),e},Q_=function(r){const e=document.createElement("canvas"),t=r.width,n=r.height;e.width=t,e.height=n*2;const i=e.getContext("2d");return i.drawImage(r,0,0,t,n),i.translate(0,2*n),i.scale(1,-1),i.drawImage(r,0,0,t,n),e},eA=function(r){const e=document.createElement("canvas"),t=r.width,n=r.height;e.width=2*t,e.height=2*n;const i=e.getContext("2d");return i.drawImage(r,0,0,t,n),i.setTransform(-1,0,0,-1,e.width,e.height),i.drawImage(r,0,0,t,n),i.setTransform(-1,0,0,1,e.width,0),i.drawImage(r,0,0,t,n),i.setTransform(1,0,0,-1,0,e.height),i.drawImage(r,0,0,t,n),e},mB=function(r,e){const t=r.width,n=r.height,i=document.createElement("canvas");i.width=t*3,i.height=n*3;const o=i.getContext("2d"),s=e.angle!=null?-e.angle:-20,a=Rr.toRad(s),l=i.width/4,c=i.height/4;for(let u=0;u<4;u+=1)for(let d=0;d<4;d+=1)(u+d)%2>0&&(o.setTransform(1,0,0,1,(2*u-1)*l,(2*d-1)*c),o.rotate(a),o.drawImage(r,-t/2,-n/2,t,n));return i};var zg;(function(r){r.presets=Object.assign({},me),r.presets["flip-x"]=J_,r.presets["flip-y"]=Q_,r.presets["flip-xy"]=eA,r.registry=Qi.create({type:"background pattern"}),r.registry.register(r.presets,!0)})(zg||(zg={}));const ea={prefixCls:"x6",autoInsertCSS:!0,useCSSSelector:!0,trackable:!1,trackInfo:{},track(r){ea.trackable=r}};var ao;(function(r){r.snapToGrid=WC,r.normalizeMarker=iu;function e(t){return`${ea.prefixCls}-${t}`}r.prefix=e})(ao||(ao={})),function(r){function e(t,n,i,o=[]){const s=typeof n.children=="function"?n.children(t):t[n.children||"children"];return i||(i=n.createNode(t),o.push(i)),Array.isArray(s)&&s.forEach(a=>{const l=n.createNode(a),c=n.createEdge(i,l);o.push(l,c),this.makeTree(a,n,l,o)}),o}r.makeTree=e}(ao||(ao={}));const tA=ao.prefix("highlighted"),vB={highlight(r,e,t){const n=t&&t.className||tA;Qr(e,n)},unhighlight(r,e,t){const n=t&&t.className||tA;ma(e,n)}},nA=ao.prefix("highlight-opacity"),yB={highlight(r,e){Qr(e,nA)},unhighlight(r,e){ma(e,nA)}},bB={padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}},xB={highlight(r,e,t){const n=au.getHighlighterId(e,t);if(au.hasCache(n))return;t=JE({},t,bB);const i=pn.create(e);let o,s;try{o=i.toPathData()}catch(u){s=i.bbox(!0),o=w_(Object.assign(Object.assign({},t),s))}const a=Es("path");if(ei(a,Object.assign({d:o,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"},t.attrs?kg(t.attrs):null)),r.isEdgeElement(e))ei(a,"d",r.getConnectionPathData());else{let u=i.getTransformToElement(r.container);const d=t.padding;if(d){s==null&&(s=i.bbox(!0));const h=s.x+s.width/2,f=s.y+s.height/2;s=Vs(s,u);const p=Math.max(s.width,1),g=Math.max(s.height,1),v=(p+d)/p,y=(g+d)/g,x=Do({a:v,b:0,c:0,d:y,e:h-v*h,f:f-y*f});u=u.multiply(x)}wf(a,u)}Qr(a,ao.prefix("highlight-stroke"));const l=r.cell,c=()=>au.removeHighlighter(n);l.on("removed",c),l.model&&l.model.on("reseted",c),r.container.appendChild(a),au.setCache(n,a)},unhighlight(r,e,t){au.removeHighlighter(au.getHighlighterId(e,t))}};var au;(function(r){function e(s,a){return Vv(s),s.id+JSON.stringify(a)}r.getHighlighterId=e;const t={};function n(s,a){t[s]=a}r.setCache=n;function i(s){return t[s]!=null}r.hasCache=i;function o(s){const a=t[s];a&&(bl(a),delete t[s])}r.removeHighlighter=o})(au||(au={}));var cc;(function(r){function e(t,n){if(typeof n.highlight!="function")throw new Error(`Highlighter '${t}' is missing required \`highlight()\` method`);if(typeof n.unhighlight!="function")throw new Error(`Highlighter '${t}' is missing required \`unhighlight()\` method`)}r.check=e})(cc||(cc={})),function(r){r.presets=K,r.registry=Qi.create({type:"highlighter"}),r.registry.register(r.presets,!0)}(cc||(cc={}));function t1(r,e={}){return new pe(Ra(e.x,r.width),Ra(e.y,r.height))}function n1(r,e,t){return Object.assign({angle:e,position:r.toJSON()},t)}const CB=(r,e)=>r.map(({x:t,y:n,angle:i})=>n1(t1(e,{x:t,y:n}),i||0)),wB=(r,e,t)=>{const n=t.start||0,i=t.step||20;return rA(r,e,n,(o,s)=>(o+.5-s/2)*i)},EB=(r,e,t)=>{const n=t.start||0,i=t.step||360/r.length;return rA(r,e,n,o=>o*i)};function rA(r,e,t,n){const i=e.getCenter(),o=e.getTopCenter(),s=e.width/e.height,a=va.fromRect(e),l=r.length;return r.map((c,u)=>{const d=t+n(u,l),h=o.clone().rotate(-d,i).scale(s,1,i),f=c.compensateRotate?-a.tangentTheta(h):0;return(c.dx||c.dy)&&h.translate(c.dx||0,c.dy||0),c.dr&&h.move(i,c.dr),n1(h.round(),f,c)})}var SB=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const _B=(r,e,t)=>{const n=t1(e,t.start||e.getOrigin()),i=t1(e,t.end||e.getCorner());return Ug(r,n,i,t)},AB=(r,e,t)=>Ug(r,e.getTopLeft(),e.getBottomLeft(),t),TB=(r,e,t)=>Ug(r,e.getTopRight(),e.getBottomRight(),t),MB=(r,e,t)=>Ug(r,e.getTopLeft(),e.getTopRight(),t),PB=(r,e,t)=>Ug(r,e.getBottomLeft(),e.getBottomRight(),t);function Ug(r,e,t,n){const i=new xn(e,t),o=r.length;return r.map((s,a)=>{var{strict:l}=s,c=SB(s,["strict"]);const u=l||n.strict?(a+1)/(o+1):(a+.5)/o,d=i.pointAt(u);return(c.dx||c.dy)&&d.translate(c.dx||0,c.dy||0),n1(d.round(),0,c)})}var Rd;(function(r){r.presets=q,r.registry=Qi.create({type:"port layout"}),r.registry.register(r.presets,!0)})(Rd||(Rd={}));const OB={position:{x:0,y:0},angle:0,attrs:{".":{y:"0","text-anchor":"start"}}};function lu(r,e){const{x:t,y:n,angle:i,attrs:o}=e||{};return JE({},{angle:i,attrs:o,position:{x:t,y:n}},r,OB)}const DB=(r,e,t)=>lu({position:e.getTopLeft()},t),NB=(r,e,t)=>lu({position:{x:-15,y:0},attrs:{".":{y:".3em","text-anchor":"end"}}},t),RB=(r,e,t)=>lu({position:{x:15,y:0},attrs:{".":{y:".3em","text-anchor":"start"}}},t),kB=(r,e,t)=>lu({position:{x:0,y:-15},attrs:{".":{"text-anchor":"middle"}}},t),IB=(r,e,t)=>lu({position:{x:0,y:15},attrs:{".":{y:".6em","text-anchor":"middle"}}},t),LB=(r,e,t)=>iA(r,e,!1,t),GB=(r,e,t)=>iA(r,e,!0,t),FB=(r,e,t)=>oA(r,e,!1,t),BB=(r,e,t)=>oA(r,e,!0,t);function iA(r,e,t,n){const i=n.offset!=null?n.offset:15,o=e.getCenter().theta(r),s=sA(e);let a,l,c,u,d=0;return o<s[1]||o>s[2]?(a=".3em",l=i,c=0,u="start"):o<s[0]?(a="0",l=0,c=-i,t?(d=-90,u="start"):u="middle"):o<s[3]?(a=".3em",l=-i,c=0,u="end"):(a=".6em",l=0,c=i,t?(d=90,u="start"):u="middle"),lu({position:{x:Math.round(l),y:Math.round(c)},angle:d,attrs:{".":{y:a,"text-anchor":u}}},n)}function oA(r,e,t,n){const i=n.offset!=null?n.offset:15,o=e.getCenter().theta(r),s=sA(e);let a,l,c,u,d=0;return o<s[1]||o>s[2]?(a=".3em",l=-i,c=0,u="end"):o<s[0]?(a=".6em",l=0,c=i,t?(d=90,u="start"):u="middle"):o<s[3]?(a=".3em",l=i,c=0,u="start"):(a="0em",l=0,c=-i,t?(d=-90,u="start"):u="middle"),lu({position:{x:Math.round(l),y:Math.round(c)},angle:d,attrs:{".":{y:a,"text-anchor":u}}},n)}function sA(r){const e=r.getCenter(),t=e.theta(r.getTopLeft()),n=e.theta(r.getBottomLeft()),i=e.theta(r.getBottomRight()),o=e.theta(r.getTopRight());return[t,o,i,n]}const zB=(r,e,t)=>aA(r.diff(e.getCenter()),!1,t),UB=(r,e,t)=>aA(r.diff(e.getCenter()),!0,t);function aA(r,e,t){const n=t.offset!=null?t.offset:20,i=new pe(0,0),o=-r.theta(i),s=r.clone().move(i,n).diff(r).round();let a=".3em",l,c=o;return(o+90)%180==0?(l=e?"end":"middle",!e&&o===-270&&(a="0em")):o>-270&&o<-90?(l="start",c=o-180):l="end",lu({position:s.round().toJSON(),angle:e?c:0,attrs:{".":{y:a,"text-anchor":l}}},t)}var _f;(function(r){r.presets=ae,r.registry=Qi.create({type:"port label layout"}),r.registry.register(r.presets,!0)})(_f||(_f={}));class uc{constructor(e,t,n,i){if(e==null)return this.set(255,255,255,1);if(typeof e=="number")return this.set(e,t,n,i);if(typeof e=="string")return uc.fromString(e)||this;if(Array.isArray(e))return this.set(e);this.set(e.r,e.g,e.b,e.a==null?1:e.a)}blend(e,t,n){this.set(e.r+(t.r-e.r)*n,e.g+(t.g-e.g)*n,e.b+(t.b-e.b)*n,e.a+(t.a-e.a)*n)}lighten(e){const t=uc.lighten(this.toArray(),e);this.r=t[0],this.g=t[1],this.b=t[2],this.a=t[3]}darken(e){this.lighten(-e)}set(e,t,n,i){const o=Array.isArray(e)?e[0]:e,s=Array.isArray(e)?e[1]:t,a=Array.isArray(e)?e[2]:n,l=Array.isArray(e)?e[3]:i;return this.r=Math.round(ws(o,0,255)),this.g=Math.round(ws(s,0,255)),this.b=Math.round(ws(a,0,255)),this.a=l==null?1:ws(l,0,1),this}toHex(){return`#${["r","g","b"].map(t=>{const n=this[t].toString(16);return n.length<2?`0${n}`:n}).join("")}`}toRGBA(){return this.toArray()}toHSLA(){return uc.rgba2hsla(this.r,this.g,this.b,this.a)}toCSS(e){const t=`${this.r},${this.g},${this.b},`;return e?`rgb(${t})`:`rgba(${t},${this.a})`}toGrey(){return uc.makeGrey(Math.round((this.r+this.g+this.b)/3),this.a)}toArray(){return[this.r,this.g,this.b,this.a]}toString(){return this.toCSS()}}(function(r){function e(E){return new r(E)}r.fromArray=e;function t(E){return new r([...p(E),1])}r.fromHex=t;function n(E){const T=E.toLowerCase().match(/^rgba?\(([\s.,0-9]+)\)/);if(T){const P=T[1].split(/\s*,\s*/).map(z=>parseInt(z,10));return new r(P)}return null}r.fromRGBA=n;function i(E,T,P){P<0&&++P,P>1&&--P;const z=6*P;return z<1?E+(T-E)*z:2*P<1?T:3*P<2?E+(T-E)*(2/3-P)*6:E}function o(E){const T=E.toLowerCase().match(/^hsla?\(([\s.,0-9]+)\)/);if(T){const P=T[2].split(/\s*,\s*/),z=(parseFloat(P[0])%360+360)%360/360,$=parseFloat(P[1])/100,ne=parseFloat(P[2])/100,De=P[3]==null?1:parseInt(P[3],10);return new r(c(z,$,ne,De))}return null}r.fromHSLA=o;function s(E){if(E.startsWith("#"))return t(E);if(E.startsWith("rgb"))return n(E);const T=r.named[E];return T?t(T):o(E)}r.fromString=s;function a(E,T){return r.fromArray([E,E,E,T])}r.makeGrey=a;function l(E,T,P,z){const $=Array.isArray(E)?E[0]:E,ne=Array.isArray(E)?E[1]:T,De=Array.isArray(E)?E[2]:P,fe=Array.isArray(E)?E[3]:z,Ae=Math.max($,ne,De),de=Math.min($,ne,De),ct=(Ae+de)/2;let bt=0,Pe=0;if(de!==Ae){const tt=Ae-de;switch(Pe=ct>.5?tt/(2-Ae-de):tt/(Ae+de),Ae){case $:bt=(ne-De)/tt+(ne<De?6:0);break;case ne:bt=(De-$)/tt+2;break;case De:bt=($-ne)/tt+4;break;default:break}bt/=6}return[bt,Pe,ct,fe==null?1:fe]}r.rgba2hsla=l;function c(E,T,P,z){const $=Array.isArray(E)?E[0]:E,ne=Array.isArray(E)?E[1]:T,De=Array.isArray(E)?E[2]:P,fe=Array.isArray(E)?E[3]:z,Ae=De<=.5?De*(ne+1):De+ne-De*ne,de=2*De-Ae;return[i(de,Ae,$+1/3)*256,i(de,Ae,$)*256,i(de,Ae,$-1/3)*256,fe==null?1:fe]}r.hsla2rgba=c;function u(E){return new r(Math.round(Math.random()*256),Math.round(Math.random()*256),Math.round(Math.random()*256),E?void 0:parseFloat(Math.random().toFixed(2)))}r.random=u;function d(){const E="0123456789ABCDEF";let T="#";for(let P=0;P<6;P+=1)T+=E[Math.floor(Math.random()*16)];return T}r.randomHex=d;function h(E){return u(E).toString()}r.randomRGBA=h;function f(E,T){if(typeof E=="string"){const De=E[0]==="#",[fe,Ae,de]=p(E);return T?fe*.299+Ae*.587+de*.114>186?"#000000":"#ffffff":`${De?"#":""}${g(255-fe,255-Ae,255-de)}`}const P=E[0],z=E[1],$=E[2],ne=E[3];return T?P*.299+z*.587+$*.114>186?[0,0,0,ne]:[255,255,255,ne]:[255-P,255-z,255-$,ne]}r.invert=f;function p(E){const T=E.indexOf("#")===0?E:`#${E}`;let P=Number(`0x${T.substr(1)}`);if(!(T.length===4||T.length===7)||Number.isNaN(P))throw new Error("Invalid hex color.");const z=T.length===4?4:8,$=(1<<z)-1,ne=["b","g","r"].map(()=>{const De=P&$;return P>>=z,z===4?17*De:De});return[ne[2],ne[1],ne[0]]}function g(E,T,P){const z=$=>$.length<2?`0${$}`:$;return`${z(E.toString(16))}${z(T.toString(16))}${z(P.toString(16))}`}function v(E,T){return x(E,T)}r.lighten=v;function y(E,T){return x(E,-T)}r.darken=y;function x(E,T){if(typeof E=="string"){const $=E[0]==="#",ne=parseInt($?E.substr(1):E,16),De=ws((ne>>16)+T,0,255),fe=ws((ne>>8&255)+T,0,255),Ae=ws((ne&255)+T,0,255);return`${$?"#":""}${(Ae|fe<<8|De<<16).toString(16)}`}const P=g(E[0],E[1],E[2]),z=p(x(P,T));return[z[0],z[1],z[2],E[3]]}})(uc||(uc={})),function(r){r.named={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",burntsienna:"#ea7e5d",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}}(uc||(uc={}));class VB{constructor(){this.listeners={}}on(e,t,n){return t==null?this:(this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t,n),this)}once(e,t,n){const i=(...o)=>(this.off(e,i),Vg.call([t,n],o));return this.on(e,i,this)}off(e,t,n){if(!(e||t||n))return this.listeners={},this;const i=this.listeners;return(e?[e]:Object.keys(i)).forEach(s=>{const a=i[s];if(!!a){if(!(t||n)){delete i[s];return}for(let l=a.length-2;l>=0;l-=2)t&&a[l]!==t||n&&a[l+1]!==n||a.splice(l,2)}}),this}trigger(e,...t){let n=!0;if(e!=="*"){const o=this.listeners[e];o!=null&&(n=Vg.call([...o],t))}const i=this.listeners["*"];return i!=null?MC([n,Vg.call([...i],[e,...t])]):n}emit(e,...t){return this.trigger(e,...t)}}var Vg;(function(r){function e(t,n){const i=[];for(let o=0;o<t.length;o+=2){const s=t[o],a=t[o+1],l=Array.isArray(n)?n:[n],c=AC(s,a,l);i.push(c)}return MC(i)}r.call=e})(Vg||(Vg={}));class ka{get disposed(){return this._disposed===!0}dispose(){this._disposed=!0}}(function(r){function e(){return(t,n,i)=>{const o=i.value,s=t.__proto__;i.value=function(){this.disposed||(o.call(this),s.dispose.call(this))}}}r.dispose=e})(ka||(ka={}));class Pee{constructor(e){this.callback=e}get disposed(){return!this.callback}dispose(){if(!this.callback)return;const e=this.callback;this.callback=null,e()}}class lA{constructor(){this.isDisposed=!1,this.items=new Set}get disposed(){return this.isDisposed}dispose(){this.isDisposed||(this.isDisposed=!0,this.items.forEach(e=>{e.dispose()}),this.items.clear())}contains(e){return this.items.has(e)}add(e){this.items.add(e)}remove(e){this.items.delete(e)}clear(){this.items.clear()}}(function(r){function e(t){const n=new r;return t.forEach(i=>{n.add(i)}),n}r.from=e})(lA||(lA={}));class rs extends VB{}(function(r){r.dispose=ka.dispose})(rs||(rs={})),QE(rs,ka);class cA extends rs{get disabled(){return this._disabled===!0}enable(){delete this._disabled}disable(){this._disabled=!0}}var jB=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class ty extends ka{constructor(){super();this.clear()}clear(){this.map=new WeakMap,this.arr=[]}has(e){return this.map.has(e)}get(e){return this.map.get(e)}set(e,t){this.map.set(e,t),this.arr.push(e)}delete(e){const t=this.arr.indexOf(e);t>=0&&this.arr.splice(t,1);const n=this.map.get(e);return this.map.delete(e),n}each(e){this.arr.forEach(t=>{const n=this.map.get(t);e(n,t)})}dispose(){this.clear()}}jB([ka.dispose()],ty.prototype,"dispose",null);class jg{constructor(e={}){this.comparator=e.comparator||jg.defaultComparator,this.index={},this.data=e.data||[],this.heapify()}isEmpty(){return this.data.length===0}insert(e,t,n){const i={priority:e,value:t},o=this.data.length;return n&&(i.id=n,this.index[n]=o),this.data.push(i),this.bubbleUp(o),this}peek(){return this.data[0]?this.data[0].value:null}peekPriority(){return this.data[0]?this.data[0].priority:null}updatePriority(e,t){const n=this.index[e];if(typeof n=="undefined")throw new Error(`Node with id '${e}' was not found in the heap.`);const i=this.data,o=i[n].priority,s=this.comparator(t,o);s<0?(i[n].priority=t,this.bubbleUp(n)):s>0&&(i[n].priority=t,this.bubbleDown(n))}remove(){const e=this.data,t=e[0],n=e.pop();return t.id&&delete this.index[t.id],e.length>0&&(e[0]=n,n.id&&(this.index[n.id]=0),this.bubbleDown(0)),t?t.value:null}heapify(){for(let e=0;e<this.data.length;e+=1)this.bubbleUp(e)}bubbleUp(e){const t=this.data;let n,i,o=e;for(;o>0&&(i=o-1>>>1,this.comparator(t[o].priority,t[i].priority)<0);){n=t[i],t[i]=t[o];let s=t[o].id;s!=null&&(this.index[s]=i),t[o]=n,s=t[o].id,s!=null&&(this.index[s]=o),o=i}}bubbleDown(e){const t=this.data,n=t.length-1;let i=e;for(;;){const o=(i<<1)+1,s=o+1;let a=i;if(o<=n&&this.comparator(t[o].priority,t[a].priority)<0&&(a=o),s<=n&&this.comparator(t[s].priority,t[a].priority)<0&&(a=s),a!==i){const l=t[a];t[a]=t[i];let c=t[i].id;c!=null&&(this.index[c]=a),t[i]=l,c=t[i].id,c!=null&&(this.index[c]=i),i=a}else break}}}(function(r){r.defaultComparator=(e,t)=>e-t})(jg||(jg={}));var r1;(function(r){function e(t,n,i=(o,s)=>1){const o={},s={},a={},l=new jg;for(o[n]=0,Object.keys(t).forEach(c=>{c!==n&&(o[c]=Infinity),l.insert(o[c],c,c)});!l.isEmpty();){const c=l.remove();a[c]=!0;const u=t[c]||[];for(let d=0;d<u.length;d+=1){const h=u[d];if(!a[h]){const f=o[c]+i(c,h);f<o[h]&&(o[h]=f,s[h]=c,l.updatePriority(h,f))}}}return s}r.run=e})(r1||(r1={}));var kd;(function(r){r.linear=e=>e,r.quad=e=>e*e,r.cubic=e=>e*e*e,r.inout=e=>{if(e<=0)return 0;if(e>=1)return 1;const t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)},r.exponential=e=>Math.pow(2,10*(e-1)),r.bounce=e=>{for(let t=0,n=1;;t+=n,n/=2)if(e>=(7-4*t)/11){const i=(11-6*t-11*e)/4;return-i*i+n*n}}})(kd||(kd={})),function(r){r.decorators={reverse(e){return t=>1-e(1-t)},reflect(e){return t=>.5*(t<.5?e(2*t):2-e(2-2*t))},clamp(e,t=0,n=1){return i=>{const o=e(i);return o<t?t:o>n?n:o}},back(e=1.70158){return t=>t*t*((e+1)*t-e)},elastic(e=1.5){return t=>Math.pow(2,10*(t-1))*Math.cos(20*Math.PI*e/3*t)}}}(kd||(kd={})),function(r){function e(Pe){return-1*Math.cos(Pe*(Math.PI/2))+1}r.easeInSine=e;function t(Pe){return Math.sin(Pe*(Math.PI/2))}r.easeOutSine=t;function n(Pe){return-.5*(Math.cos(Math.PI*Pe)-1)}r.easeInOutSine=n;function i(Pe){return Pe*Pe}r.easeInQuad=i;function o(Pe){return Pe*(2-Pe)}r.easeOutQuad=o;function s(Pe){return Pe<.5?2*Pe*Pe:-1+(4-2*Pe)*Pe}r.easeInOutQuad=s;function a(Pe){return Pe*Pe*Pe}r.easeInCubic=a;function l(Pe){const tt=Pe-1;return tt*tt*tt+1}r.easeOutCubic=l;function c(Pe){return Pe<.5?4*Pe*Pe*Pe:(Pe-1)*(2*Pe-2)*(2*Pe-2)+1}r.easeInOutCubic=c;function u(Pe){return Pe*Pe*Pe*Pe}r.easeInQuart=u;function d(Pe){const tt=Pe-1;return 1-tt*tt*tt*tt}r.easeOutQuart=d;function h(Pe){const tt=Pe-1;return Pe<.5?8*Pe*Pe*Pe*Pe:1-8*tt*tt*tt*tt}r.easeInOutQuart=h;function f(Pe){return Pe*Pe*Pe*Pe*Pe}r.easeInQuint=f;function p(Pe){const tt=Pe-1;return 1+tt*tt*tt*tt*tt}r.easeOutQuint=p;function g(Pe){const tt=Pe-1;return Pe<.5?16*Pe*Pe*Pe*Pe*Pe:1+16*tt*tt*tt*tt*tt}r.easeInOutQuint=g;function v(Pe){return Pe===0?0:Math.pow(2,10*(Pe-1))}r.easeInExpo=v;function y(Pe){return Pe===1?1:-Math.pow(2,-10*Pe)+1}r.easeOutExpo=y;function x(Pe){if(Pe===0||Pe===1)return Pe;const tt=Pe*2,Kt=tt-1;return tt<1?.5*Math.pow(2,10*Kt):.5*(-Math.pow(2,-10*Kt)+2)}r.easeInOutExpo=x;function E(Pe){const tt=Pe/1;return-1*(Math.sqrt(1-tt*Pe)-1)}r.easeInCirc=E;function T(Pe){const tt=Pe-1;return Math.sqrt(1-tt*tt)}r.easeOutCirc=T;function P(Pe){const tt=Pe*2,Kt=tt-2;return tt<1?-.5*(Math.sqrt(1-tt*tt)-1):.5*(Math.sqrt(1-Kt*Kt)+1)}r.easeInOutCirc=P;function z(Pe,tt=1.70158){return Pe*Pe*((tt+1)*Pe-tt)}r.easeInBack=z;function $(Pe,tt=1.70158){const Kt=Pe/1-1;return Kt*Kt*((tt+1)*Kt+tt)+1}r.easeOutBack=$;function ne(Pe,tt=1.70158){const Kt=Pe*2,tn=Kt-2,Bn=tt*1.525;return Kt<1?.5*Kt*Kt*((Bn+1)*Kt-Bn):.5*(tn*tn*((Bn+1)*tn+Bn)+2)}r.easeInOutBack=ne;function De(Pe,tt=.7){if(Pe===0||Pe===1)return Pe;const tn=Pe/1-1,Bn=1-tt,cr=Bn/(2*Math.PI)*Math.asin(1);return-(Math.pow(2,10*tn)*Math.sin((tn-cr)*(2*Math.PI)/Bn))}r.easeInElastic=De;function fe(Pe,tt=.7){const Kt=1-tt,tn=Pe*2;if(Pe===0||Pe===1)return Pe;const Bn=Kt/(2*Math.PI)*Math.asin(1);return Math.pow(2,-10*tn)*Math.sin((tn-Bn)*(2*Math.PI)/Kt)+1}r.easeOutElastic=fe;function Ae(Pe,tt=.65){const Kt=1-tt;if(Pe===0||Pe===1)return Pe;const tn=Pe*2,Bn=tn-1,cr=Kt/(2*Math.PI)*Math.asin(1);return tn<1?-.5*(Math.pow(2,10*Bn)*Math.sin((Bn-cr)*(2*Math.PI)/Kt)):Math.pow(2,-10*Bn)*Math.sin((Bn-cr)*(2*Math.PI)/Kt)*.5+1}r.easeInOutElastic=Ae;function de(Pe){const tt=Pe/1;if(tt<1/2.75)return 7.5625*tt*tt;if(tt<2/2.75){const Kt=tt-1.5/2.75;return 7.5625*Kt*Kt+.75}if(tt<2.5/2.75){const Kt=tt-2.25/2.75;return 7.5625*Kt*Kt+.9375}{const Kt=tt-2.625/2.75;return 7.5625*Kt*Kt+.984375}}r.easeOutBounce=de;function ct(Pe){return 1-de(1-Pe)}r.easeInBounce=ct;function bt(Pe){return Pe<.5?ct(Pe*2)*.5:de(Pe*2-1)*.5+.5}r.easeInOutBounce=bt}(kd||(kd={}));var Id;(function(r){r.number=(e,t)=>{const n=t-e;return i=>e+n*i},r.object=(e,t)=>{const n=Object.keys(e);return i=>{const o={};for(let s=n.length-1;s!==-1;s-=1){const a=n[s];o[a]=e[a]+(t[a]-e[a])*i}return o}},r.unit=(e,t)=>{const n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,i=n.exec(e),o=n.exec(t),s=o?o[1]:"",a=i?+i[1]:0,l=o?+o[1]:0,c=s.indexOf("."),u=c>0?s[1].length-c-1:0,d=l-a,h=i?i[2]:"";return f=>(a+d*f).toFixed(u)+h},r.color=(e,t)=>{const n=parseInt(e.slice(1),16),i=parseInt(t.slice(1),16),o=n&255,s=(i&255)-o,a=n&65280,l=(i&65280)-a,c=n&16711680,u=(i&16711680)-c;return d=>{const h=o+s*d&255,f=a+l*d&65280,p=c+u*d&16711680;return`#${(1<<24|h|f|p).toString(16).slice(1)}`}}})(Id||(Id={}));var uA;(function(r){const e=`${ea.prefixCls}.storage`;function t(d,h,f){const p=h.id||h4("doc-"),g=l(d);g.keys.push(p),s(c(d,p),h),s(u(d),g),o(f,null,Object.assign(Object.assign({},h),{id:p}))}r.insert=t;function n(d,h,f){const p=l(d),g=[];if(h==null)p.keys.forEach(v=>{const y=a(c(d,v));y?g.push(y):o(f,new Error(`No document found for an ID '${v}' from index.`))}),o(f,null,g);else if(h.id){const v=a(c(d,h.id));o(f,null,v?[v]:[])}else o(f,null,[])}r.find=n;function i(d,h,f){const p=l(d);if(h==null)p.keys.forEach(g=>{localStorage.removeItem(c(d,g))}),localStorage.removeItem(u(d)),o(f,null);else if(h.id){const g=p.keys.indexOf(h.id);g>=0&&p.keys.splice(g,1),localStorage.removeItem(c(d,h.id)),s(u(d),p),o(f,null)}}r.remove=i;function o(d,h,f){d&&e6(()=>{d(h,f)})}function s(d,h){localStorage.setItem(d,JSON.stringify(h))}function a(d){const h=localStorage.getItem(d);return h?JSON.parse(h):null}function l(d){const h=a(u(d));return h?(h.keys==null&&(h.keys=[]),h):{keys:[]}}function c(d,h){return`${e}.${d}.docs.${h}`}function u(d){return`${e}.${d}.index`}})(uA||(uA={}));class Fr extends rs{constructor(){super();this.cid=i1.uniqueId(),Fr.views[this.cid]=this}get priority(){return 2}confirmUpdate(e,t){return 0}$(e){return Fr.$(e)}empty(e=this.container){return this.$(e).empty(),this}unmount(e=this.container){return this.$(e).remove(),this}remove(e=this.container){return e===this.container&&(this.removeEventListeners(document),this.onRemove(),delete Fr.views[this.cid]),this.unmount(e),this}onRemove(){}setClass(e,t=this.container){t.classList.value=Array.isArray(e)?e.join(" "):e}addClass(e,t=this.container){return this.$(t).addClass(Array.isArray(e)?e.join(" "):e),this}removeClass(e,t=this.container){return this.$(t).removeClass(Array.isArray(e)?e.join(" "):e),this}setStyle(e,t=this.container){return this.$(t).css(e),this}setAttrs(e,t=this.container){return e!=null&&t!=null&&(t instanceof SVGElement?ei(t,e):this.$(t).attr(e)),this}findAttr(e,t=this.container){let n=t;for(;n&&n.nodeType===1;){const i=n.getAttribute(e);if(i!=null)return i;if(n===this.container)return null;n=n.parentNode}return null}find(e,t=this.container,n=this.selectors){return Fr.find(e,t,n).elems}findOne(e,t=this.container,n=this.selectors){const i=this.find(e,t,n);return i.length>0?i[0]:null}findByAttr(e,t=this.container){let n=t;for(;n&&n.getAttribute;){const i=n.getAttribute(e);if((i!=null||n===this.container)&&i!=="false")return n;n=n.parentNode}return null}getSelector(e,t){let n;if(e===this.container)return typeof t=="string"&&(n=`> ${t}`),n;if(e){const i=NC(e)+1;n=`${e.tagName.toLowerCase()}:nth-child(${i})`,t&&(n+=` > ${t}`),n=this.getSelector(e.parentNode,n)}return n}prefixClassName(e){return ao.prefix(e)}delegateEvents(e,t){if(e==null)return this;t||this.undelegateEvents();const n=/^(\S+)\s*(.*)$/;return Object.keys(e).forEach(i=>{const o=i.match(n);if(o==null)return;const s=this.getEventHandler(e[i]);typeof s=="function"&&this.delegateEvent(o[1],o[2],s)}),this}undelegateEvents(){return this.$(this.container).off(this.getEventNamespace()),this}delegateDocumentEvents(e,t){return this.addEventListeners(document,e,t),this}undelegateDocumentEvents(){return this.removeEventListeners(document),this}delegateEvent(e,t,n){return this.$(this.container).on(e+this.getEventNamespace(),t,n),this}undelegateEvent(e,t,n){const i=e+this.getEventNamespace();return t==null?this.$(this.container).off(i):typeof t=="string"?this.$(this.container).off(i,t,n):this.$(this.container).off(i,t),this}addEventListeners(e,t,n){if(t==null)return this;const i=this.getEventNamespace(),o=this.$(e);return Object.keys(t).forEach(s=>{const a=this.getEventHandler(t[s]);typeof a=="function"&&o.on(s+i,n,a)}),this}removeEventListeners(e){return e!=null&&this.$(e).off(this.getEventNamespace()),this}getEventNamespace(){return`.${ea.prefixCls}-event-${this.cid}`}getEventHandler(e){let t;if(typeof e=="string"){const n=this[e];typeof n=="function"&&(t=(...i)=>n.call(this,...i))}else t=(...n)=>e.call(this,...n);return t}getEventTarget(e,t={}){const{target:n,type:i,clientX:o=0,clientY:s=0}=e;return t.fromPoint||i==="touchmove"||i==="touchend"?document.elementFromPoint(o,s):n}stopPropagation(e){return this.setEventData(e,{propagationStopped:!0}),this}isPropagationStopped(e){return this.getEventData(e).propagationStopped===!0}getEventData(e){return this.eventData(e)}setEventData(e,t){return this.eventData(e,t)}eventData(e,t){if(e==null)throw new TypeError("Event object required");let n=e.data;const i=`__${this.cid}__`;return t==null?n==null?{}:n[i]||{}:(n==null&&(n=e.data={}),n[i]==null?n[i]=Object.assign({},t):n[i]=Object.assign(Object.assign({},n[i]),t),n[i])}normalizeEvent(e){return Fr.normalizeEvent(e)}}(function(r){function e(o){return jr()(o)}r.$=e;function t(o,s){return s?Es(o||"g"):Ng(o||"div")}r.createElement=t;function n(o,s,a){if(!o||o===".")return{elems:[s]};if(a){const l=a[o];if(l)return{elems:Array.isArray(l)?l:[l]}}return ea.useCSSSelector?{isCSSSelector:!0,elems:e(s).find(o).toArray()}:{elems:[]}}r.find=n;function i(o){let s=o;const a=o.originalEvent,l=a&&a.changedTouches&&a.changedTouches[0];if(l){for(const u in o)l[u]===void 0&&(l[u]=o[u]);s=l}const c=s.target;if(c){const u=c.correspondingUseElement;u&&(s.target=u)}return s}r.normalizeEvent=i})(Fr||(Fr={})),function(r){r.views={};function e(t){return r.views[t]||null}r.getView=e}(Fr||(Fr={}));var i1;(function(r){let e=0;function t(){const n=`v${e}`;return e+=1,n}r.uniqueId=t})(i1||(i1={}));const HB=r=>r;function dA(r,e){return e===0?"0%":`${Math.round(r/e*100)}%`}function hA(r){return(t,n,i,o)=>n.isEdgeElement(i)?WB(r,t,n,i,o):$B(r,t,n,i,o)}function $B(r,e,t,n,i){const o=t.cell,s=o.getAngle(),a=t.getUnrotatedBBoxOfElement(n),l=o.getBBox().getCenter(),c=pe.create(i).rotate(s,l);let u=c.x-a.x,d=c.y-a.y;return r&&(u=dA(u,a.width),d=dA(d,a.height)),e.anchor={name:"topLeft",args:{dx:u,dy:d,rotate:!0}},e}function WB(r,e,t,n,i){const o=t.getConnection();if(!o)return e;const s=o.closestPointLength(i);if(r){const a=o.length();e.anchor={name:"ratio",args:{ratio:s/a}}}else e.anchor={name:"length",args:{length:s}};return e}const ZB=hA(!0),XB=hA(!1);var Af;(function(r){r.presets=ee,r.registry=Qi.create({type:"connection strategy"}),r.registry.register(r.presets,!0)})(Af||(Af={}));class YB{constructor(e){this.view=e,this.clean()}clean(){this.elemCache&&this.elemCache.dispose(),this.elemCache=new ty,this.pathCache={}}get(e){return this.elemCache.has(e)||this.elemCache.set(e,{}),this.elemCache.get(e)}getData(e){const t=this.get(e);return t.data||(t.data={}),t.data}getMatrix(e){const t=this.get(e);if(t.matrix==null){const n=this.view.rotatableNode||this.view.container;t.matrix=tu(e,n)}return Do(t.matrix)}getShape(e){const t=this.get(e);return t.shape==null&&(t.shape=M_(e)),t.shape.clone()}getBoundingRect(e){const t=this.get(e);return t.boundingRect==null&&(t.boundingRect=No(e)),t.boundingRect.clone()}}var Ur;(function(r){function e(u){return u!=null&&!t(u)}r.isJSONMarkup=e;function t(u){return u!=null&&typeof u=="string"}r.isStringMarkup=t;function n(u){return u==null||t(u)?u:Ki(u)}r.clone=n;function i(u){return`${u}`.trim().replace(/[\r|\n]/g," ").replace(/>\s+</g,"><")}r.sanitize=i;function o(u){const d=document.createDocumentFragment(),h={},f={},p=i(u);return WS(p,{raw:!0}).forEach(v=>{d.appendChild(v)}),{fragment:d,selectors:f,groups:h}}r.parseStringMarkup=o;function s(u,d={ns:qi.svg}){const h=document.createDocumentFragment(),f={},p={},g=[{markup:Array.isArray(u)?u:[u],parent:h,ns:d.ns}];for(;g.length>0;){const v=g.pop();let y=v.ns||qi.svg;const x=v.markup,E=v.parent;x.forEach(T=>{const P=T.tagName;if(!P)throw new TypeError("Invalid tagName");T.ns&&(y=T.ns);const z=y===qi.svg,$=y?Ng(P,y):e_(P),ne=T.attrs;ne&&(z?ei($,kg(ne)):jr()($).attr(ne));const De=T.style;De&&jr()($).css(De);const fe=T.className;fe!=null&&$.setAttribute("class",Array.isArray(fe)?fe.join(" "):fe),T.textContent&&($.textContent=T.textContent);const Ae=T.selector;if(Ae!=null){if(p[Ae])throw new TypeError("Selector must be unique");p[Ae]=$}if(T.groupSelector){let ct=T.groupSelector;Array.isArray(ct)||(ct=[ct]),ct.forEach(bt=>{f[bt]||(f[bt]=[]),f[bt].push($)})}E.appendChild($);const de=T.children;Array.isArray(de)&&g.push({ns:y,markup:de,parent:$})})}return Object.keys(f).forEach(v=>{if(p[v])throw new Error("Ambiguous group selector");p[v]=f[v]}),{fragment:h,selectors:p,groups:f}}r.parseJSONMarkup=s;function a(u){return u instanceof SVGElement?Es("g"):e_("div")}function l(u){if(t(u)){const p=pn.createVectors(u),g=p.length;if(g===1)return{elem:p[0].node};if(g>1){const v=a(p[0].node);return p.forEach(y=>{v.appendChild(y.node)}),{elem:v}}return{}}const d=s(u),h=d.fragment;let f=null;return h.childNodes.length>1?(f=a(h.firstChild),f.appendChild(h)):f=h.firstChild,{elem:f,selectors:d.selectors}}r.renderMarkup=l;function c(u){const d=pn.createVectors(u),h=document.createDocumentFragment();for(let f=0,p=d.length;f<p;f+=1){const g=d[f].node;h.appendChild(g)}return{fragment:h,selectors:{}}}r.parseLabelStringMarkup=c})(Ur||(Ur={})),function(r){function e(i,o,s){if(i!=null){let a;const l=i.tagName.toLowerCase();if(i===o)return typeof s=="string"?a=`> ${l} > ${s}`:a=`> ${l}`,a;const c=i.parentNode;if(c&&c.childNodes.length>1){const u=NC(i)+1;a=`${l}:nth-child(${u})`}else a=l;return s&&(a+=` > ${s}`),e(i.parentNode,o,a)}return s}r.getSelector=e;function t(i,o,s){if(i.nodeName==="#text")return null;let a=null,l=null,c=null,u=!1;const d={tagName:i.tagName};if(i.attributes){c={};for(let h=0,f=i.attributes.length;h<f;h+=1){const p=i.attributes[h],g=p.nodeName,v=p.nodeValue;g==="selector"?a=v:g==="groupSelector"?l=v:g==="class"?d.attrs={class:v}:c[g]=v}}return a==null&&(u=!0,a=e(i,o)),i.namespaceURI&&(d.ns=i.namespaceURI),d.ns==null&&(["body","div","section","main","nav","footer","span","p","h1","h2","h3","h4","h5","h6","ul","ol","dl","center","strong","pre","form","select","textarea","fieldset","marquee","bgsound","iframe","frameset"].includes(i.tagName)?d.ns=qi.xhtml:s&&(d.ns=s)),a&&(d.selector=a),l!=null&&(d.groupSelector=l),{markup:d,attrs:c,isCSSSelector:u}}function n(i){const o=r.sanitize(i),s=t_(o,{mimeType:"image/svg+xml"}),a=Array.prototype.slice.call(s.childNodes),l={},c=new WeakMap,u=(h,f,p)=>{const g=t(h,f,p);if(g==null){const v=c.get(h.parentNode);v&&h.textContent&&(v.textContent=h.textContent)}else{const{markup:v,attrs:y,isCSSSelector:x}=g;if(c.set(h,v),v.selector&&y!=null&&(Object.keys(y).length&&(l[v.selector]=y),x&&delete v.selector),h.childNodes&&h.childNodes.length>0)for(let E=0,T=h.childNodes.length;E<T;E+=1){const P=h.childNodes[E],z=u(P,f,v.ns);z&&(v.children==null&&(v.children=[]),v.children.push(z))}return v}};return{markup:a.map(h=>u(h,h)).filter(h=>h!=null),attrs:l}}r.xml2json=n}(Ur||(Ur={})),function(r){function e(){return"g"}r.getPortContainerMarkup=e;function t(){return{tagName:"circle",selector:"circle",attrs:{r:10,fill:"#FFFFFF",stroke:"#000000"}}}r.getPortMarkup=t;function n(){return{tagName:"text",selector:"text",attrs:{fill:"#000000"}}}r.getPortLabelMarkup=n}(Ur||(Ur={})),function(r){function e(){return r.sanitize(`
    <path class="connection" stroke="black" d="M 0 0 0 0"/>
    <path class="source-marker" fill="black" stroke="black" d="M 0 0 0 0"/>
    <path class="target-marker" fill="black" stroke="black" d="M 0 0 0 0"/>
    <path class="connection-wrap" d="M 0 0 0 0"/>
    <g class="labels"/>
    <g class="vertices"/>
    <g class="arrowheads"/>
    <g class="tools"/>
  `)}r.getEdgeMarkup=e;function t(){return r.sanitize(`
    <g class="edge-tool">
      <g class="tool-remove" event="edge:remove">
        <circle r="11" />
        <path transform="scale(.8) translate(-16, -16)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z" />
        <title>Remove edge.</title>
      </g>
      <g class="tool-options" event="edge:options">
        <circle r="11" transform="translate(25)"/>
        <path fill="white" transform="scale(.55) translate(29, -16)" d="M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z"/>
        <title>Edge options.</title>
      </g>
    </g>
  `)}r.getEdgeToolMarkup=t;function n(){return r.sanitize(`
    <g class="vertex-group" transform="translate(<%= x %>, <%= y %>)">
      <circle class="vertex" data-index="<%= index %>" r="10" />
      <path class="vertex-remove-area" data-index="<%= index %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>
      <path class="vertex-remove" data-index="<%= index %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">
      <title>Remove vertex.</title>
      </path>
    </g>
  `)}r.getEdgeVertexMarkup=n;function i(){return r.sanitize(`
    <g class="arrowhead-group arrowhead-group-<%= end %>">
      <path class="arrowhead" data-terminal="<%= end %>" d="M 26 0 L 0 13 L 26 26 z" />
    </g>
  `)}r.getEdgeArrowheadMarkup=i}(Ur||(Ur={})),function(r){function e(t=!1){return{tagName:"foreignObject",selector:"fo",children:[{ns:qi.xhtml,tagName:"body",selector:"foBody",attrs:{xmlns:qi.xhtml},style:{width:"100%",height:"100%",background:"transparent"},children:t?[]:[{tagName:"div",selector:"foContent",style:{width:"100%",height:"100%"}}]}]}}r.getForeignObjectMarkup=e}(Ur||(Ur={}));class Tf{constructor(e){this.view=e}get cell(){return this.view.cell}getDefinition(e){return this.cell.getAttrDefinition(e)}processAttrs(e,t){let n,i,o,s,a;const l=[];return Object.keys(t).forEach(c=>{const u=t[c],d=this.getDefinition(c),h=dn(Cl.isValidDefinition,this.view,d,u,{elem:e,attrs:t,cell:this.cell,view:this.view});if(d&&h)typeof d=="string"?(n==null&&(n={}),n[d]=u):u!==null&&l.push({name:c,definition:d});else{n==null&&(n={});const f=i_.includes(c)?c:$S(c);n[f]=u}}),l.forEach(({name:c,definition:u})=>{const d=t[c];typeof u.set=="function"&&(!Hv(e)&&Tf.DELAY_ATTRS.includes(c)?(a==null&&(a={}),a[c]=d):(i==null&&(i={}),i[c]=d)),typeof u.offset=="function"&&(o==null&&(o={}),o[c]=d),typeof u.position=="function"&&(s==null&&(s={}),s[c]=d)}),{raw:t,normal:n,set:i,offset:o,position:s,delay:a}}mergeProcessedAttrs(e,t){e.set=Object.assign(Object.assign({},e.set),t.set),e.position=Object.assign(Object.assign({},e.position),t.position),e.offset=Object.assign(Object.assign({},e.offset),t.offset);const n=e.normal&&e.normal.transform;n!=null&&t.normal&&(t.normal.transform=n),e.normal=t.normal}findAttrs(e,t,n,i){const o=[],s=new ty;return Object.keys(e).forEach(a=>{const l=e[a];if(!Rt(l))return;const{isCSSSelector:c,elems:u}=Fr.find(a,t,i);n[a]=u;for(let d=0,h=u.length;d<h;d+=1){const f=u[d],p=i&&i[a]===f,g=s.get(f);if(g){g.array||(o.push(f),g.array=!0,g.attrs=[g.attrs],g.priority=[g.priority]);const v=g.attrs,y=g.priority;if(p)v.unshift(l),y.unshift(-1);else{const x=yi(y,c?-1:h);v.splice(x,0,l),y.splice(x,0,h)}}else s.set(f,{elem:f,attrs:l,priority:p?-1:h,array:!1})}}),o.forEach(a=>{const l=s.get(a),c=l.attrs;l.attrs=c.reduceRight((u,d)=>ir(u,d),{})}),s}updateRelativeAttrs(e,t,n,i){const o=t.raw||{};let s=t.normal||{};const a=t.set,l=t.position,c=t.offset,u=t.delay,d=()=>({elem:e,cell:this.cell,view:this.view,attrs:o,refBBox:n.clone()});if(a!=null&&Object.keys(a).forEach(P=>{const z=a[P],$=this.getDefinition(P);if($!=null){const ne=dn($.set,this.view,z,d());typeof ne=="object"?s=Object.assign(Object.assign({},s),ne):ne!=null&&(s[P]=ne)}}),Hv(e)){this.view.setAttrs(s,e);return}const h=s.transform,f=h?`${h}`:null,p=Gg(f),g=new pe(p.e,p.f);h&&(delete s.transform,p.e=0,p.f=0);let v=1,y=1;if(l||c){const P=this.view.getScaleOfElement(e,i.scalableNode);v=P.sx,y=P.sy}let x=!1;l!=null&&Object.keys(l).forEach(P=>{const z=l[P],$=this.getDefinition(P);if($!=null){const ne=dn($.position,this.view,z,d());ne!=null&&(x=!0,g.translate(pe.create(ne).scale(v,y)))}}),this.view.setAttrs(s,e);let E=!1;if(c!=null){const P=this.view.getBoundingRectOfElement(e);if(P.width>0&&P.height>0){const z=Vs(P,p).scale(1/v,1/y);Object.keys(c).forEach($=>{const ne=c[$],De=this.getDefinition($);if(De!=null){const fe=dn(De.offset,this.view,ne,{elem:e,cell:this.cell,view:this.view,attrs:o,refBBox:z});fe!=null&&(E=!0,g.translate(pe.create(fe).scale(v,y)))}})}}(h!=null||x||E)&&(g.round(1),p.e=g.x,p.f=g.y,e.setAttribute("transform",Nd(p)));const T=()=>{u!=null&&Object.keys(u).forEach(P=>{const z=u[P],$=this.getDefinition(P);if($!=null){const ne=dn($.set,this.view,z,d());typeof ne=="object"?this.view.setAttrs(ne,e):ne!=null&&this.view.setAttrs({[P]:ne},e)}})};i.forceSync?T():Fg.scheduleTask(T)}update(e,t,n){const i={},o=this.findAttrs(n.attrs||t,e,i,n.selectors),s=n.attrs?this.findAttrs(t,e,i,n.selectors):o,a=[];o.each(u=>{const d=u.elem,h=u.attrs,f=this.processAttrs(d,h);if(f.set==null&&f.position==null&&f.offset==null&&f.delay==null)this.view.setAttrs(f.normal,d);else{const p=s.get(d),g=p?p.attrs:null,v=g&&h.ref==null?g.ref:h.ref;let y;if(v){if(y=(i[v]||this.view.find(v,e,n.selectors))[0],!y)throw new Error(`"${v}" reference does not exist.`)}else y=null;const x={node:d,refNode:y,attributes:g,processedAttributes:f},E=a.findIndex(T=>T.refNode===d);E>-1?a.splice(E,0,x):a.push(x)}});const l=new ty;let c;a.forEach(u=>{const d=u.node,h=u.refNode;let f;const p=h!=null&&n.rotatableNode!=null&&kC(n.rotatableNode,h);if(h&&(f=l.get(h)),!f){const x=p?n.rotatableNode:e;f=h?No(h,{target:x}):n.rootBBox,h&&l.set(h,f)}let g;n.attrs&&u.attributes?(g=this.processAttrs(d,u.attributes),this.mergeProcessedAttrs(g,u.processedAttributes)):g=u.processedAttributes;let v=f;p&&n.rotatableNode!=null&&!n.rotatableNode.contains(d)&&(c||(c=Gg(ei(n.rotatableNode,"transform"))),v=Vs(f,c)),a.find(x=>x.refNode===d)&&(n.forceSync=!0),this.updateRelativeAttrs(d,g,v,n)})}}(function(r){r.DELAY_ATTRS=["text","textWrap","sourceMarker","targetMarker"]})(Tf||(Tf={}));class fA{constructor(e,t,n=[]){this.view=e;const i={},o={};let s=0;Object.keys(t).forEach(l=>{let c=t[l];Array.isArray(c)||(c=[c]),c.forEach(u=>{let d=i[u];d||(s+=1,d=i[u]=1<<s),o[l]|=d})});let a=n;if(Array.isArray(a)||(a=[a]),a.forEach(l=>{i[l]||(s+=1,i[l]=1<<s)}),s>25)throw new Error("Maximum number of flags exceeded.");this.flags=i,this.attrs=o,this.bootstrap=n}get cell(){return this.view.cell}getFlag(e){const t=this.flags;return t==null?0:Array.isArray(e)?e.reduce((n,i)=>n|t[i],0):t[e]|0}hasAction(e,t){return e&this.getFlag(t)}removeAction(e,t){return e^e&this.getFlag(t)}getBootstrapFlag(){return this.getFlag(this.bootstrap)}getChangedFlag(){let e=0;return this.attrs&&Object.keys(this.attrs).forEach(t=>{this.cell.hasChanged(t)&&(e|=this.attrs[t])}),e}}var KB=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Ii extends Fr{constructor(e,t={}){super();this.cell=e,this.options=this.ensureOptions(t),this.graph=this.options.graph,this.attr=new Tf(this),this.flag=new fA(this,this.options.actions,this.options.bootstrap),this.cache=new YB(this),this.setContainer(this.ensureContainer()),this.setup(),this.$(this.container).data("view",this),this.init()}static getDefaults(){return this.defaults}static config(e){this.defaults=this.getOptions(e)}static getOptions(e){const t=(c,u)=>u!=null?Ju([...Array.isArray(c)?c:[c],...Array.isArray(u)?u:[u]]):Array.isArray(c)?[...c]:[c],n=Ki(this.getDefaults()),{bootstrap:i,actions:o,events:s,documentEvents:a}=e,l=KB(e,["bootstrap","actions","events","documentEvents"]);return i&&(n.bootstrap=t(n.bootstrap,i)),o&&Object.keys(o).forEach(c=>{const u=o[c],d=n.actions[c];u&&d?n.actions[c]=t(d,u):u&&(n.actions[c]=t(u))}),s&&(n.events=Object.assign(Object.assign({},n.events),s)),e.documentEvents&&(n.documentEvents=Object.assign(Object.assign({},n.documentEvents),a)),ir(n,l)}get[Symbol.toStringTag](){return Ii.toStringTag}init(){}onRemove(){this.removeTools()}get priority(){return this.options.priority}get rootSelector(){return this.options.rootSelector}getConstructor(){return this.constructor}ensureOptions(e){return this.getConstructor().getOptions(e)}getContainerTagName(){return this.options.isSvgElement?"g":"div"}getContainerStyle(){}getContainerAttrs(){return{"data-cell-id":this.cell.id,"data-shape":this.cell.shape}}getContainerClassName(){return this.prefixClassName("cell")}ensureContainer(){return Fr.createElement(this.getContainerTagName(),this.options.isSvgElement)}setContainer(e){if(this.container!==e){this.undelegateEvents(),this.container=e,this.options.events!=null&&this.delegateEvents(this.options.events);const t=this.getContainerAttrs();t!=null&&this.setAttrs(t,e);const n=this.getContainerStyle();n!=null&&this.setStyle(n,e);const i=this.getContainerClassName();i!=null&&this.addClass(i,e)}return this}isNodeView(){return!1}isEdgeView(){return!1}render(){return this}confirmUpdate(e,t={}){return 0}getBootstrapFlag(){return this.flag.getBootstrapFlag()}getFlag(e){return this.flag.getFlag(e)}hasAction(e,t){return this.flag.hasAction(e,t)}removeAction(e,t){return this.flag.removeAction(e,t)}handleAction(e,t,n,i){if(this.hasAction(e,t)){n();const o=[t];return i&&(typeof i=="string"?o.push(i):o.push(...i)),this.removeAction(e,o)}return e}setup(){this.cell.on("changed",({options:e})=>this.onAttrsChange(e))}onAttrsChange(e){let t=this.flag.getChangedFlag();e.updated||!t||(e.dirty&&this.hasAction(t,"update")&&(t|=this.getFlag("render")),e.toolId&&(e.async=!1),this.graph!=null&&this.graph.renderer.requestViewUpdate(this,t,this.priority,e))}parseJSONMarkup(e,t){const n=Ur.parseJSONMarkup(e),i=n.selectors,o=this.rootSelector;if(t&&o){if(i[o])throw new Error("Invalid root selector");i[o]=t}return n}can(e){let t=this.graph.options.interacting;if(typeof t=="function"&&(t=dn(t,this.graph,this)),typeof t=="object"){let n=t[e];return typeof n=="function"&&(n=dn(n,this.graph,this)),n!==!1}return typeof t=="boolean"?t:!1}cleanCache(){return this.cache.clean(),this}getCache(e){return this.cache.get(e)}getDataOfElement(e){return this.cache.getData(e)}getMatrixOfElement(e){return this.cache.getMatrix(e)}getShapeOfElement(e){return this.cache.getShape(e)}getScaleOfElement(e,t){let n,i;if(t&&t.contains(e)){const o=nu(t);n=1/o.sx,i=1/o.sy}else n=1,i=1;return{sx:n,sy:i}}getBoundingRectOfElement(e){return this.cache.getBoundingRect(e)}getBBoxOfElement(e){const t=this.getBoundingRectOfElement(e),n=this.getMatrixOfElement(e),i=this.getRootRotatedMatrix(),o=this.getRootTranslatedMatrix();return Vs(t,o.multiply(i).multiply(n))}getUnrotatedBBoxOfElement(e){const t=this.getBoundingRectOfElement(e),n=this.getMatrixOfElement(e),i=this.getRootTranslatedMatrix();return Vs(t,i.multiply(n))}getBBox(e={}){let t;if(e.useCellGeometry){const n=this.cell,i=n.isNode()?n.getAngle():0;t=n.getBBox().bbox(i)}else t=this.getBBoxOfElement(this.container);return this.graph.localToGraph(t)}getRootTranslatedMatrix(){const e=this.cell,t=e.isNode()?e.getPosition():{x:0,y:0};return Do().translate(t.x,t.y)}getRootRotatedMatrix(){let e=Do();const t=this.cell,n=t.isNode()?t.getAngle():0;if(n){const i=t.getBBox(),o=i.width/2,s=i.height/2;e=e.translate(o,s).rotate(n).translate(-o,-s)}return e}findMagnet(e=this.container){return this.findByAttr("magnet",e)}updateAttrs(e,t,n={}){n.rootBBox==null&&(n.rootBBox=new Ht),n.selectors==null&&(n.selectors=this.selectors),this.attr.update(e,t,n)}isEdgeElement(e){return this.cell.isEdge()&&(e==null||e===this.container)}prepareHighlight(e,t={}){const n=e&&this.$(e)[0]||this.container;return t.partial=n===this.container,n}highlight(e,t={}){const n=this.prepareHighlight(e,t);return this.notify("cell:highlight",{magnet:n,options:t,view:this,cell:this.cell}),this.isEdgeView()?this.notify("edge:highlight",{magnet:n,options:t,view:this,edge:this.cell,cell:this.cell}):this.isNodeView()&&this.notify("node:highlight",{magnet:n,options:t,view:this,node:this.cell,cell:this.cell}),this}unhighlight(e,t={}){const n=this.prepareHighlight(e,t);return this.notify("cell:unhighlight",{magnet:n,options:t,view:this,cell:this.cell}),this.isNodeView()?this.notify("node:unhighlight",{magnet:n,options:t,view:this,node:this.cell,cell:this.cell}):this.isEdgeView()&&this.notify("edge:unhighlight",{magnet:n,options:t,view:this,edge:this.cell,cell:this.cell}),this}notifyUnhighlight(e,t){}getEdgeTerminal(e,t,n,i,o){const s=this.cell,a=this.findAttr("port",e),l=e.getAttribute("data-selector"),c={cell:s.id};return l!=null&&(c.magnet=l),a!=null?(c.port=a,s.isNode()&&!s.hasPort(a)&&l==null&&(c.selector=this.getSelector(e))):l==null&&this.container!==e&&(c.selector=this.getSelector(e)),this.customizeEdgeTerminal(c,e,t,n,i,o)}customizeEdgeTerminal(e,t,n,i,o,s){const a=o.getStrategy()||this.graph.options.connecting.strategy;if(a){const l=typeof a=="string"?a:a.name,c=typeof a=="string"?{}:a.args||{},u=Af.registry;if(l){const d=u.get(l);if(d==null)return u.onNotFound(l);const h=dn(d,this.graph,e,this,t,new pe(n,i),o,s,c);if(h)return h}}return e}getMagnetFromEdgeTerminal(e){const t=this.cell,n=this.container,i=e.port;let o=e.magnet,s;return i!=null&&t.isNode()&&t.hasPort(i)?s=this.findPortElem(i,o)||n:(o||(o=e.selector),!o&&i!=null&&(o=`[port="${i}"]`),s=this.findOne(o,n,this.selectors)),s}animate(e,t){const n=typeof e=="string"?this.findOne(e):e;if(n==null)throw new Error("Invalid animation element.");const i=n.parentNode,o=()=>{i||bl(n)},s=pn.create(n);i||s.appendTo(this.graph.view.stage);const a=t.complete;return t.complete=l=>{o(),a&&a(l)},s.animate(t)}animateTransform(e,t){const n=typeof e=="string"?this.findOne(e):e;if(n==null)throw new Error("Invalid animation element.");const i=n.parentNode,o=()=>{i||bl(n)},s=pn.create(n);i||s.appendTo(this.graph.view.stage);const a=t.complete;return t.complete=l=>{o(),a&&a(l)},s.animateTransform(t)}hasTools(e){const t=this.tools;return t==null?!1:e==null?!0:t.name===e}addTools(e){if(!this.can("toolsAddable"))return this;if(this.removeTools(),e){const t=Ao.isToolsView(e)?e:new Ao(e);this.tools=t,this.graph.on("tools:hide",this.hideTools,this),this.graph.on("tools:show",this.showTools,this),this.graph.on("tools:remove",this.removeTools,this),t.config({view:this}),t.mount()}return this}updateTools(e={}){return this.tools&&this.tools.update(e),this}removeTools(){return this.tools&&(this.tools.remove(),this.graph.off("tools:hide",this.hideTools,this),this.graph.off("tools:show",this.showTools,this),this.graph.off("tools:remove",this.removeTools,this),this.tools=null),this}hideTools(){return this.tools&&this.tools.hide(),this}showTools(){return this.tools&&this.tools.show(),this}renderTools(){const e=this.cell.getTools();return this.addTools(e),this}notify(e,t){return this.trigger(e,t),this.graph.trigger(e,t),this}getEventArgs(e,t,n){const i=this,o=i.cell;return t==null||n==null?{e,view:i,cell:o}:{e,x:t,y:n,view:i,cell:o}}onClick(e,t,n){this.notify("cell:click",this.getEventArgs(e,t,n))}onDblClick(e,t,n){this.notify("cell:dblclick",this.getEventArgs(e,t,n))}onContextMenu(e,t,n){this.notify("cell:contextmenu",this.getEventArgs(e,t,n))}onMouseDown(e,t,n){this.cell.model&&(this.cachedModelForMouseEvent=this.cell.model,this.cachedModelForMouseEvent.startBatch("mouse")),this.notify("cell:mousedown",this.getEventArgs(e,t,n))}onMouseUp(e,t,n){this.notify("cell:mouseup",this.getEventArgs(e,t,n)),this.cachedModelForMouseEvent&&(this.cachedModelForMouseEvent.stopBatch("mouse",{cell:this.cell}),this.cachedModelForMouseEvent=null)}onMouseMove(e,t,n){this.notify("cell:mousemove",this.getEventArgs(e,t,n))}onMouseOver(e){this.notify("cell:mouseover",this.getEventArgs(e))}onMouseOut(e){this.notify("cell:mouseout",this.getEventArgs(e))}onMouseEnter(e){this.notify("cell:mouseenter",this.getEventArgs(e))}onMouseLeave(e){this.notify("cell:mouseleave",this.getEventArgs(e))}onMouseWheel(e,t,n,i){this.notify("cell:mousewheel",Object.assign({delta:i},this.getEventArgs(e,t,n)))}onCustomEvent(e,t,n,i){this.notify("cell:customevent",Object.assign({name:t},this.getEventArgs(e,n,i))),this.notify(t,Object.assign({},this.getEventArgs(e,n,i)))}onMagnetMouseDown(e,t,n,i){}onMagnetDblClick(e,t,n,i){}onMagnetContextMenu(e,t,n,i){}onLabelMouseDown(e,t,n){}checkMouseleave(e){const t=this.graph;t.renderer.isAsync()&&t.renderer.dumpView(this);const n=this.getEventTarget(e,{fromPoint:!0}),i=t.renderer.findViewByElem(n);i!==this&&(this.onMouseLeave(e),!!i&&i.onMouseEnter(e))}}Ii.defaults={isSvgElement:!0,rootSelector:"root",priority:0,bootstrap:[],actions:{}},function(r){r.Flag=fA,r.Attr=Tf}(Ii||(Ii={})),function(r){r.toStringTag=`X6.${r.name}`;function e(t){if(t==null)return!1;if(t instanceof r)return!0;const n=t[Symbol.toStringTag],i=t;return(n==null||n===r.toStringTag)&&typeof i.isNodeView=="function"&&typeof i.isEdgeView=="function"&&typeof i.confirmUpdate=="function"}r.isCellView=e}(Ii||(Ii={})),function(r){function e(n){return function(i){i.config({priority:n})}}r.priority=e;function t(n){return function(i){i.config({bootstrap:n})}}r.bootstrap=t}(Ii||(Ii={})),function(r){r.registry=Qi.create({type:"view"})}(Ii||(Ii={}));class Ao extends Fr{constructor(e={}){super();this.svgContainer=this.createContainer(!0,e),this.htmlContainer=this.createContainer(!1,e),this.config(e)}get name(){return this.options.name}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get[Symbol.toStringTag](){return Ao.toStringTag}createContainer(e,t){const n=e?Fr.createElement("g",!0):Fr.createElement("div",!1);return Qr(n,this.prefixClassName("cell-tools")),t.className&&Qr(n,t.className),n}config(e){if(this.options=Object.assign(Object.assign({},this.options),e),!Ii.isCellView(e.view)||e.view===this.cellView)return this;this.cellView=e.view,this.cell.isEdge()?(Qr(this.svgContainer,this.prefixClassName("edge-tools")),Qr(this.htmlContainer,this.prefixClassName("edge-tools"))):this.cell.isNode()&&(Qr(this.svgContainer,this.prefixClassName("node-tools")),Qr(this.htmlContainer,this.prefixClassName("node-tools"))),this.svgContainer.setAttribute("data-cell-id",this.cell.id),this.htmlContainer.setAttribute("data-cell-id",this.cell.id),this.name&&(this.svgContainer.setAttribute("data-tools-name",this.name),this.htmlContainer.setAttribute("data-tools-name",this.name));const t=this.options.items;if(!Array.isArray(t))return this;this.tools=[];const n=[];t.forEach(i=>{Ao.ToolItem.isToolItem(i)?i.name==="vertices"?n.unshift(i):n.push(i):(typeof i=="object"?i.name:i)==="vertices"?n.unshift(i):n.push(i)});for(let i=0;i<n.length;i+=1){const o=n[i];let s;if(Ao.ToolItem.isToolItem(o))s=o;else{const a=typeof o=="object"?o.name:o,l=typeof o=="object"?o.args||{}:{};if(a){if(this.cell.isNode()){const c=Pf.registry.get(a);if(c)s=new c(l);else return Pf.registry.onNotFound(a)}else if(this.cell.isEdge()){const c=Of.registry.get(a);if(c)s=new c(l);else return Of.registry.onNotFound(a)}}}s&&(s.config(this.cellView,this),s.render(),(s.options.isSVGElement!==!1?this.svgContainer:this.htmlContainer).appendChild(s.container),this.tools.push(s))}return this}update(e={}){const t=this.tools;return t&&t.forEach(n=>{e.toolId!==n.cid&&n.isVisible()&&n.update()}),this}focus(e){const t=this.tools;return t&&t.forEach(n=>{e===n?n.show():n.hide()}),this}blur(e){const t=this.tools;return t&&t.forEach(n=>{n!==e&&!n.isVisible()&&(n.show(),n.update())}),this}hide(){return this.focus(null)}show(){return this.blur(null)}remove(){const e=this.tools;return e&&(e.forEach(t=>t.remove()),this.tools=null),bl(this.svgContainer),bl(this.htmlContainer),super.remove()}mount(){const e=this.tools,t=this.cellView;if(t&&e){const n=e.some(o=>o.options.isSVGElement!==!1),i=e.some(o=>o.options.isSVGElement===!1);n&&(this.options.local?t.container:t.graph.view.decorator).appendChild(this.svgContainer),i&&this.graph.container.appendChild(this.htmlContainer)}return this}}(function(r){r.toStringTag=`X6.${r.name}`;function e(t){if(t==null)return!1;if(t instanceof r)return!0;const n=t[Symbol.toStringTag],i=t;return(n==null||n===r.toStringTag)&&i.graph!=null&&i.cell!=null&&typeof i.config=="function"&&typeof i.update=="function"&&typeof i.focus=="function"&&typeof i.blur=="function"&&typeof i.show=="function"&&typeof i.hide=="function"}r.isToolsView=e})(Ao||(Ao={})),function(r){class e extends Fr{constructor(n={}){super();this.visible=!0,this.options=this.getOptions(n),this.container=Fr.createElement(this.options.tagName||"g",this.options.isSVGElement!==!1),Qr(this.container,this.prefixClassName("cell-tool")),typeof this.options.className=="string"&&Qr(this.container,this.options.className),this.init()}static getDefaults(){return this.defaults}static config(n){this.defaults=this.getOptions(n)}static getOptions(n){return ir(Ki(this.getDefaults()),n)}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get name(){return this.options.name}get[Symbol.toStringTag](){return e.toStringTag}init(){}getOptions(n){return this.constructor.getOptions(n)}delegateEvents(){return this.options.events&&super.delegateEvents(this.options.events),this}config(n,i){return this.cellView=n,this.parent=i,this.stamp(this.container),this.cell.isEdge()?Qr(this.container,this.prefixClassName("edge-tool")):this.cell.isNode()&&Qr(this.container,this.prefixClassName("node-tool")),this.name&&this.container.setAttribute("data-tool-name",this.name),this.delegateEvents(),this}render(){this.empty();const n=this.options.markup;if(n){const i=Ur.isStringMarkup(n)?Ur.parseStringMarkup(n):Ur.parseJSONMarkup(n);this.container.appendChild(i.fragment),this.childNodes=i.selectors}return this.onRender(),this}onRender(){}update(){return this}stamp(n){n&&n.setAttribute("data-cell-id",this.cellView.cell.id)}show(){return this.container.style.display="",this.visible=!0,this}hide(){return this.container.style.display="none",this.visible=!1,this}isVisible(){return!!this.visible}focus(){const n=this.options.focusOpacity;return n!=null&&Number.isFinite(n)&&(this.container.style.opacity=`${n}`),this.parent.focus(this),this}blur(){return this.container.style.opacity="",this.parent.blur(this),this}guard(n){return this.graph==null||this.cellView==null?!0:this.graph.view.guard(n,this.cellView)}}e.defaults={isSVGElement:!0,tagName:"g"},r.ToolItem=e,function(t){let n=0;function i(s){return s?CC(s):(n+=1,`CustomTool${n}`)}function o(s){const a=dC(i(s.name),this);return a.config(s),a}t.define=o}(e=r.ToolItem||(r.ToolItem={})),function(t){t.toStringTag=`X6.${t.name}`;function n(i){if(i==null)return!1;if(i instanceof t)return!0;const o=i[Symbol.toStringTag],s=i;return(o==null||o===t.toStringTag)&&s.graph!=null&&s.cell!=null&&typeof s.config=="function"&&typeof s.update=="function"&&typeof s.focus=="function"&&typeof s.blur=="function"&&typeof s.show=="function"&&typeof s.hide=="function"&&typeof s.isVisible=="function"}t.isToolItem=n}(e=r.ToolItem||(r.ToolItem={}))}(Ao||(Ao={}));function pA(r,e,t,n){return dn(Af.presets.pinRelative,this.graph,{},e,t,r,this.cell,n,{}).anchor}function gA(r,e){return e?r.cell.getBBox():r.cell.isEdge()?r.getConnection().bbox():r.getUnrotatedBBoxOfElement(r.container)}class cu extends Ao.ToolItem{onRender(){Qr(this.container,this.prefixClassName("cell-tool-button")),this.update()}update(){return this.updatePosition(),this}updatePosition(){const t=this.cellView.cell.isEdge()?this.getEdgeMatrix():this.getNodeMatrix();wf(this.container,t,{absolute:!0})}getNodeMatrix(){const e=this.cellView,t=this.options;let{x:n=0,y:i=0}=t;const{offset:o,useCellGeometry:s,rotate:a}=t;let l=gA(e,s);const c=e.cell.getAngle();a||(l=l.bbox(c));let u=0,d=0;typeof o=="number"?(u=o,d=o):typeof o=="object"&&(u=o.x,d=o.y),n=Ra(n,l.width),i=Ra(i,l.height);let h=Do().translate(l.x+l.width/2,l.y+l.height/2);return a&&(h=h.rotate(c)),h=h.translate(n+u-l.width/2,i+d-l.height/2),h}getEdgeMatrix(){const e=this.cellView,t=this.options,{offset:n=0,distance:i=0,rotate:o}=t;let s,a,l;const c=Ra(i,1);c>=0&&c<=1?s=e.getTangentAtRatio(c):s=e.getTangentAtLength(c),s?(a=s.start,l=s.vector().vectorAngle(new pe(1,0))||0):(a=e.getConnection().start,l=0);let u=Do().translate(a.x,a.y).rotate(l);return typeof n=="object"?u=u.translate(n.x||0,n.y||0):u=u.translate(0,n),o||(u=u.rotate(-l)),u}onMouseDown(e){if(this.guard(e))return;e.stopPropagation(),e.preventDefault();const t=this.options.onClick;typeof t=="function"&&dn(t,this.cellView,{e,view:this.cellView,cell:this.cellView.cell,btn:this})}}(function(r){r.config({name:"button",events:{mousedown:"onMouseDown",touchstart:"onMouseDown"}})})(cu||(cu={})),function(r){r.Remove=r.define({name:"button-remove",markup:[{tagName:"circle",selector:"button",attrs:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attrs:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],distance:60,offset:0,onClick({view:e,btn:t}){t.parent.remove(),e.cell.remove({ui:!0,toolId:t.cid})}})}(cu||(cu={}));var qB=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class ny extends Ao.ToolItem{onRender(){if(Qr(this.container,this.prefixClassName("cell-tool-boundary")),this.options.attrs){const e=this.options.attrs,{class:t}=e,n=qB(e,["class"]);ei(this.container,kg(n)),t&&Qr(this.container,t)}this.update()}update(){const e=this.cellView,t=this.options,{useCellGeometry:n,rotate:i}=t,o=Us(t.padding);let s=gA(e,n).moveAndExpand({x:-o.left,y:-o.top,width:o.left+o.right,height:o.top+o.bottom});const a=e.cell;if(a.isNode()){const l=a.getAngle();if(l)if(i){const c=a.getBBox().getCenter();KC(this.container,l,c.x,c.y,{absolute:!0})}else s=s.bbox(l)}return ei(this.container,s.toJSON()),this}}(function(r){r.config({name:"boundary",tagName:"rect",padding:10,attrs:{fill:"none",stroke:"#333","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"}})})(ny||(ny={}));class Hg extends Ao.ToolItem{constructor(){super(...arguments);this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}onRender(){return this.addClass(this.prefixClassName("edge-tool-vertices")),this.options.addable&&this.updatePath(),this.resetHandles(),this.renderHandles(),this}update(){return this.vertices.length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.addable&&this.updatePath(),this}resetHandles(){const e=this.handles;this.handles=[],e&&e.forEach(t=>{this.stopHandleListening(t),t.remove()})}renderHandles(){const e=this.vertices;for(let t=0,n=e.length;t<n;t+=1){const i=e[t],o=this.options.createHandle,s=this.options.processHandle,a=o({index:t,graph:this.graph,guard:l=>this.guard(l),attrs:this.options.attrs||{}});s&&s(a),this.graph.hook.onToolItemCreated({name:"vertices",cell:this.cell,view:this.cellView,tool:a}),a.updatePosition(i.x,i.y),this.stamp(a.container),this.container.appendChild(a.container),this.handles.push(a),this.startHandleListening(a)}}updateHandles(){const e=this.vertices;for(let t=0,n=e.length;t<n;t+=1){const i=e[t],o=this.handles[t];o&&o.updatePosition(i.x,i.y)}}updatePath(){const e=this.childNodes.connection;e&&e.setAttribute("d",this.cellView.getConnectionPathData())}startHandleListening(e){const t=this.cellView;t.can("vertexMovable")&&(e.on("change",this.onHandleChange,this),e.on("changing",this.onHandleChanging,this),e.on("changed",this.onHandleChanged,this)),t.can("vertexDeletable")&&e.on("remove",this.onHandleRemove,this)}stopHandleListening(e){const t=this.cellView;t.can("vertexMovable")&&(e.off("change",this.onHandleChange,this),e.off("changing",this.onHandleChanging,this),e.off("changed",this.onHandleChanged,this)),t.can("vertexDeletable")&&e.off("remove",this.onHandleRemove,this)}getNeighborPoints(e){const t=this.cellView,n=this.vertices,i=e>0?n[e-1]:t.sourceAnchor,o=e<n.length-1?n[e+1]:t.targetAnchor;return{prev:pe.create(i),next:pe.create(o)}}getMouseEventArgs(e){const t=this.normalizeEvent(e),{x:n,y:i}=this.graph.snapToGrid(t.clientX,t.clientY);return{e:t,x:n,y:i}}onHandleChange({e}){this.focus();const t=this.cellView;if(t.cell.startBatch("move-vertex",{ui:!0,toolId:this.cid}),!this.options.stopPropagation){const{e:n,x:i,y:o}=this.getMouseEventArgs(e);t.notifyMouseDown(n,i,o)}}onHandleChanging({handle:e,e:t}){const n=this.cellView,i=e.options.index,{e:o,x:s,y:a}=this.getMouseEventArgs(t),l={x:s,y:a};this.snapVertex(l,i),n.cell.setVertexAt(i,l,{ui:!0,toolId:this.cid}),e.updatePosition(l.x,l.y),this.options.stopPropagation||n.notifyMouseMove(o,s,a)}onHandleChanged({e}){const t=this.options,n=this.cellView;if(t.addable&&this.updatePath(),!t.removeRedundancies)return;n.removeRedundantLinearVertices({ui:!0,toolId:this.cid})&&this.render(),this.blur(),n.cell.stopBatch("move-vertex",{ui:!0,toolId:this.cid}),this.eventData(e).vertexAdded&&n.cell.stopBatch("add-vertex",{ui:!0,toolId:this.cid});const{e:o,x:s,y:a}=this.getMouseEventArgs(e);this.options.stopPropagation||n.notifyMouseUp(o,s,a),n.checkMouseleave(o),t.onChanged&&t.onChanged({edge:n.cell,edgeView:n})}snapVertex(e,t){const n=this.options.snapRadius||0;if(n>0){const i=this.getNeighborPoints(t),o=i.prev,s=i.next;Math.abs(e.x-o.x)<n?e.x=o.x:Math.abs(e.x-s.x)<n&&(e.x=s.x),Math.abs(e.y-o.y)<n?e.y=i.prev.y:Math.abs(e.y-s.y)<n&&(e.y=s.y)}}onHandleRemove({handle:e,e:t}){if(this.options.removable){const n=e.options.index,i=this.cellView;i.cell.removeVertexAt(n,{ui:!0}),this.options.addable&&this.updatePath(),i.checkMouseleave(this.normalizeEvent(t))}}onPathMouseDown(e){const t=this.cellView;if(this.guard(e)||!this.options.addable||!t.can("vertexAddable"))return;e.stopPropagation(),e.preventDefault();const n=this.normalizeEvent(e),i=this.graph.snapToGrid(n.clientX,n.clientY).toJSON();t.cell.startBatch("add-vertex",{ui:!0,toolId:this.cid});const o=t.getVertexIndex(i.x,i.y);this.snapVertex(i,o),t.cell.insertVertex(i,o,{ui:!0,toolId:this.cid}),this.render();const s=this.handles[o];this.eventData(n,{vertexAdded:!0}),s.onMouseDown(n)}onRemove(){this.resetHandles()}}(function(r){class e extends Fr{constructor(n){super();this.options=n,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDoubleClick"})}get graph(){return this.options.graph}render(){this.container=Fr.createElement("circle",!0);const n=this.options.attrs;if(typeof n=="function"){const i=r.getDefaults();this.setAttrs(Object.assign(Object.assign({},i.attrs),n(this)))}else this.setAttrs(n);this.addClass(this.prefixClassName("edge-tool-vertex"))}updatePosition(n,i){this.setAttrs({cx:n,cy:i})}onMouseDown(n){this.options.guard(n)||(n.stopPropagation(),n.preventDefault(),this.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},n.data),this.emit("change",{e:n,handle:this}))}onMouseMove(n){this.emit("changing",{e:n,handle:this})}onMouseUp(n){this.emit("changed",{e:n,handle:this}),this.undelegateDocumentEvents(),this.graph.view.delegateEvents()}onDoubleClick(n){this.emit("remove",{e:n,handle:this})}}r.Handle=e})(Hg||(Hg={})),function(r){const e=ao.prefix("edge-tool-vertex-path");r.config({name:"vertices",snapRadius:20,addable:!0,removable:!0,removeRedundancies:!0,stopPropagation:!0,attrs:{r:6,fill:"#333",stroke:"#fff",cursor:"move","stroke-width":2},createHandle:t=>new r.Handle(t),markup:[{tagName:"path",selector:"connection",className:e,attrs:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"pointer"}}],events:{[`mousedown .${e}`]:"onPathMouseDown",[`touchstart .${e}`]:"onPathMouseDown"}})}(Hg||(Hg={}));class $g extends Ao.ToolItem{constructor(){super(...arguments);this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}update(){return this.render(),this}onRender(){Qr(this.container,this.prefixClassName("edge-tool-segments")),this.resetHandles();const e=this.cellView,t=[...this.vertices];t.unshift(e.sourcePoint),t.push(e.targetPoint);for(let n=0,i=t.length;n<i-1;n+=1){const o=t[n],s=t[n+1],a=this.renderHandle(o,s,n);this.stamp(a.container),this.handles.push(a)}return this}renderHandle(e,t,n){const i=this.options.createHandle({index:n,graph:this.graph,guard:o=>this.guard(o),attrs:this.options.attrs||{}});return this.options.processHandle&&this.options.processHandle(i),this.graph.hook.onToolItemCreated({name:"segments",cell:this.cell,view:this.cellView,tool:i}),this.updateHandle(i,e,t),this.container.appendChild(i.container),this.startHandleListening(i),i}startHandleListening(e){e.on("change",this.onHandleChange,this),e.on("changing",this.onHandleChanging,this),e.on("changed",this.onHandleChanged,this)}stopHandleListening(e){e.off("change",this.onHandleChange,this),e.off("changing",this.onHandleChanging,this),e.off("changed",this.onHandleChanged,this)}resetHandles(){const e=this.handles;this.handles=[],e&&e.forEach(t=>{this.stopHandleListening(t),t.remove()})}shiftHandleIndexes(e){const t=this.handles;for(let n=0,i=t.length;n<i;n+=1)t[n].options.index+=e}resetAnchor(e,t){const n=this.cellView.cell,i={ui:!0,toolId:this.cid};t?n.prop([e,"anchor"],t,i):n.removeProp([e,"anchor"],i)}snapHandle(e,t,n){const i=e.options.axis,o=e.options.index,l=this.cellView.cell.getVertices(),c=l[o-2]||n.sourceAnchor,u=l[o+1]||n.targetAnchor,d=this.options.snapRadius;return Math.abs(t[i]-c[i])<d?t[i]=c[i]:Math.abs(t[i]-u[i])<d&&(t[i]=u[i]),t}onHandleChanging({handle:e,e:t}){const n=this.graph,i=this.options,o=this.cellView,s=i.anchor,a=e.options.axis,l=e.options.index-1,c=this.getEventData(t),u=this.normalizeEvent(t),d=n.snapToGrid(u.clientX,u.clientY),h=this.snapHandle(e,d.clone(),c),f=Ki(this.vertices);let p=f[l],g=f[l+1];const v=o.sourceView,y=o.sourceBBox;let x=!1,E=!1;if(p?l===0?y.containsPoint(p)?(f.shift(),this.shiftHandleIndexes(-1),x=!0):(p[a]=h[a],E=!0):p[a]=h[a]:(p=o.sourceAnchor.toJSON(),p[a]=h[a],y.containsPoint(p)?x=!0:(f.unshift(p),this.shiftHandleIndexes(1),E=!0)),typeof s=="function"&&v){if(x){const ne=c.sourceAnchor.clone();ne[a]=h[a];const De=dn(s,o,ne,v,o.sourceMagnet||v.container,"source",o,this);this.resetAnchor("source",De)}E&&this.resetAnchor("source",c.sourceAnchorDef)}const T=o.targetView,P=o.targetBBox;let z=!1,$=!1;if(g?l===f.length-2?P.containsPoint(g)?(f.pop(),z=!0):(g[a]=h[a],$=!0):g[a]=h[a]:(g=o.targetAnchor.toJSON(),g[a]=h[a],P.containsPoint(g)?z=!0:(f.push(g),$=!0)),typeof s=="function"&&T){if(z){const ne=c.targetAnchor.clone();ne[a]=h[a];const De=dn(s,o,ne,T,o.targetMagnet||T.container,"target",o,this);this.resetAnchor("target",De)}$&&this.resetAnchor("target",c.targetAnchorDef)}pe.equalPoints(f,this.vertices)||this.cellView.cell.setVertices(f,{ui:!0,toolId:this.cid}),this.updateHandle(e,p,g,0),i.stopPropagation||o.notifyMouseMove(u,d.x,d.y)}onHandleChange({handle:e,e:t}){const n=this.options,i=this.handles,o=this.cellView,s=e.options.index;if(!!Array.isArray(i)){for(let a=0,l=i.length;a<l;a+=1)a!==s&&i[a].hide();if(this.focus(),this.setEventData(t,{sourceAnchor:o.sourceAnchor.clone(),targetAnchor:o.targetAnchor.clone(),sourceAnchorDef:Ki(this.cell.prop(["source","anchor"])),targetAnchorDef:Ki(this.cell.prop(["target","anchor"]))}),this.cell.startBatch("move-segment",{ui:!0,toolId:this.cid}),!n.stopPropagation){const a=this.normalizeEvent(t),l=this.graph.snapToGrid(a.clientX,a.clientY);o.notifyMouseDown(a,l.x,l.y)}}}onHandleChanged({e}){const t=this.options,n=this.cellView;t.removeRedundancies&&n.removeRedundantLinearVertices({ui:!0,toolId:this.cid});const i=this.normalizeEvent(e),o=this.graph.snapToGrid(i.clientX,i.clientY);this.render(),this.blur(),this.cell.stopBatch("move-segment",{ui:!0,toolId:this.cid}),t.stopPropagation||n.notifyMouseUp(i,o.x,o.y),n.checkMouseleave(i),t.onChanged&&t.onChanged({edge:n.cell,edgeView:n})}updateHandle(e,t,n,i=0){const o=this.options.precision||0,s=Math.abs(t.x-n.x)<o,a=Math.abs(t.y-n.y)<o;if(s||a){const l=new xn(t,n);if(l.length()<this.options.threshold)e.hide();else{const u=l.getCenter(),d=s?"x":"y";u[d]+=i||0;const h=l.vector().vectorAngle(new pe(1,0));e.updatePosition(u.x,u.y,h,this.cellView),e.show(),e.options.axis=d}}else e.hide()}onRemove(){this.resetHandles()}}(function(r){class e extends Fr{constructor(n){super();this.options=n,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"})}render(){this.container=Fr.createElement("rect",!0);const n=this.options.attrs;if(typeof n=="function"){const i=r.getDefaults();this.setAttrs(Object.assign(Object.assign({},i.attrs),n(this)))}else this.setAttrs(n);this.addClass(this.prefixClassName("edge-tool-segment"))}updatePosition(n,i,o,s){const a=s.getClosestPoint(new pe(n,i))||new pe(n,i);let l=Do().translate(a.x,a.y);if(a.equals({x:n,y:i}))l=l.rotate(o);else{let u=new xn(n,i,a.x,a.y).vector().vectorAngle(new pe(1,0));u!==0&&(u+=90),l=l.rotate(u)}this.setAttrs({transform:Nd(l),cursor:o%180==0?"row-resize":"col-resize"})}onMouseDown(n){this.options.guard(n)||(this.trigger("change",{e:n,handle:this}),n.stopPropagation(),n.preventDefault(),this.options.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},n.data))}onMouseMove(n){this.emit("changing",{e:n,handle:this})}onMouseUp(n){this.emit("changed",{e:n,handle:this}),this.undelegateDocumentEvents(),this.options.graph.view.delegateEvents()}show(){this.container.style.display=""}hide(){this.container.style.display="none"}}r.Handle=e})($g||($g={})),function(r){r.config({name:"segments",precision:.5,threshold:40,snapRadius:10,stopPropagation:!0,removeRedundancies:!0,attrs:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#333",stroke:"#fff","stroke-width":2},createHandle:e=>new r.Handle(e),anchor:pA})}($g||($g={}));class ry extends Ao.ToolItem{get type(){return this.options.type}onRender(){Qr(this.container,this.prefixClassName(`edge-tool-${this.type}-anchor`)),this.toggleArea(!1),this.update()}update(){const e=this.type;return this.cellView.getTerminalView(e)?(this.updateAnchor(),this.updateArea(),this.container.style.display=""):this.container.style.display="none",this}updateAnchor(){const e=this.childNodes;if(!e)return;const t=e.anchor;if(!t)return;const n=this.type,i=this.cellView,o=this.options,s=i.getTerminalAnchor(n),a=i.cell.prop([n,"anchor"]);t.setAttribute("transform",`translate(${s.x}, ${s.y})`);const l=a?o.customAnchorAttrs:o.defaultAnchorAttrs;l&&Object.keys(l).forEach(c=>{t.setAttribute(c,l[c])})}updateArea(){const e=this.childNodes;if(!e)return;const t=e.area;if(!t)return;const n=this.type,i=this.cellView,o=i.getTerminalView(n);if(o){const s=o.cell,a=i.getTerminalMagnet(n);let l=this.options.areaPadding||0;Number.isFinite(l)||(l=0);let c,u,d;o.isEdgeElement(a)?(c=o.getBBox(),u=0,d=c.getCenter()):(c=o.getUnrotatedBBoxOfElement(a),u=s.getAngle(),d=c.getCenter(),u&&d.rotate(-u,s.getBBox().getCenter())),c.inflate(l),ei(t,{x:-c.width/2,y:-c.height/2,width:c.width,height:c.height,transform:`translate(${d.x}, ${d.y}) rotate(${u})`})}}toggleArea(e){if(this.childNodes){const t=this.childNodes.area;t&&(t.style.display=e?"":"none")}}onMouseDown(e){this.guard(e)||(e.stopPropagation(),e.preventDefault(),this.graph.view.undelegateEvents(),this.options.documentEvents&&this.delegateDocumentEvents(this.options.documentEvents),this.focus(),this.toggleArea(this.options.restrictArea),this.cell.startBatch("move-anchor",{ui:!0,toolId:this.cid}))}resetAnchor(e){const t=this.type,n=this.cell;e?n.prop([t,"anchor"],e,{rewrite:!0,ui:!0,toolId:this.cid}):n.removeProp([t,"anchor"],{ui:!0,toolId:this.cid})}onMouseMove(e){const t=this.type,n=this.cellView,i=n.getTerminalView(t);if(i==null)return;const o=this.normalizeEvent(e),s=i.cell,a=n.getTerminalMagnet(t);let l=this.graph.clientToLocal(o.clientX,o.clientY);const c=this.options.snap;if(typeof c=="function"){const h=dn(c,n,l,i,a,t,n,this);l=pe.create(h)}if(this.options.restrictArea)if(i.isEdgeElement(a)){const h=i.getClosestPoint(l);h&&(l=h)}else{const h=i.getUnrotatedBBoxOfElement(a),f=s.getAngle(),p=s.getBBox().getCenter(),g=l.clone().rotate(f,p);h.containsPoint(g)||(l=h.getNearestPointToPoint(g).rotate(-f,p))}let u;const d=this.options.anchor;typeof d=="function"&&(u=dn(d,n,l,i,a,t,n,this)),this.resetAnchor(u),this.update()}onMouseUp(e){this.graph.view.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1);const t=this.cellView;this.options.removeRedundancies&&t.removeRedundantLinearVertices({ui:!0,toolId:this.cid}),this.cell.stopBatch("move-anchor",{ui:!0,toolId:this.cid})}onDblClick(){const e=this.options.resetAnchor;e&&this.resetAnchor(e===!0?void 0:e),this.update()}}(function(r){r.config({tagName:"g",markup:[{tagName:"circle",selector:"anchor",attrs:{cursor:"pointer"}},{tagName:"rect",selector:"area",attrs:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDblClick"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},customAnchorAttrs:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttrs:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,resetAnchor:!0,restrictArea:!0,removeRedundancies:!0,anchor:pA,snap(e,t,n,i,o,s){const a=s.options.snapRadius||0,l=i==="source",c=l?0:-1,u=this.cell.getVertexAt(c)||this.getTerminalAnchor(l?"target":"source");return u&&(Math.abs(u.x-e.x)<a&&(e.x=u.x),Math.abs(u.y-e.y)<a&&(e.y=u.y)),e}})})(ry||(ry={}));const JB=ry.define({name:"source-anchor",type:"source"}),QB=ry.define({name:"target-anchor",type:"target"});var ez=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class iy extends Ao.ToolItem{get type(){return this.options.type}get ratio(){return this.options.ratio}init(){if(this.options.attrs){const e=this.options.attrs,{class:t}=e,n=ez(e,["class"]);this.setAttrs(n,this.container),t&&Qr(this.container,t)}}onRender(){Qr(this.container,this.prefixClassName(`edge-tool-${this.type}-arrowhead`)),this.update()}update(){const e=this.ratio,t=this.cellView,n=t.getTangentAtRatio(e),i=n?n.start:t.getPointAtRatio(e),o=n&&n.vector().vectorAngle(new pe(1,0))||0;if(!i)return this;const s=Do().translate(i.x,i.y).rotate(o);return wf(this.container,s,{absolute:!0}),this}onMouseDown(e){if(this.guard(e))return;e.stopPropagation(),e.preventDefault();const t=this.cellView;if(t.can("arrowheadMovable")){t.cell.startBatch("move-arrowhead",{ui:!0,toolId:this.cid});const n=this.graph.snapToGrid(e.clientX,e.clientY),i=t.prepareArrowheadDragging(this.type,{x:n.x,y:n.y,options:{toolId:this.cid}});this.cellView.setEventData(e,i),this.delegateDocumentEvents(this.options.documentEvents,e.data),t.graph.view.undelegateEvents(),this.container.style.pointerEvents="none"}this.focus()}onMouseMove(e){const t=this.normalizeEvent(e),n=this.graph.snapToGrid(t.clientX,t.clientY);this.cellView.onMouseMove(t,n.x,n.y),this.update()}onMouseUp(e){this.undelegateDocumentEvents();const t=this.normalizeEvent(e),n=this.cellView,i=this.graph.snapToGrid(t.clientX,t.clientY);n.onMouseUp(t,i.x,i.y),this.graph.view.delegateEvents(),this.blur(),this.container.style.pointerEvents="",n.cell.stopBatch("move-arrowhead",{ui:!0,toolId:this.cid})}}(function(r){r.config({tagName:"path",isSVGElement:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}})})(iy||(iy={}));const tz=iy.define({name:"source-arrowhead",type:"source",ratio:0,attrs:{d:"M 10 -8 -10 0 10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}}),nz=iy.define({name:"target-arrowhead",type:"target",ratio:1,attrs:{d:"M -10 -8 10 0 -10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}});class Mf extends Ao.ToolItem{constructor(){super(...arguments);this.labelIndex=-1,this.distance=.5}render(){return this.createElement(),this.updateEditor(),this.autoFocus(),this.delegateDocumentEvents(this.options.documentEvents),this}createElement(){const{cell:e}=this,t=[this.prefixClassName(`${e.isEdge()?"edge":"node"}-tool-editor`),this.prefixClassName("cell-tool-editor")];this.editor=Ao.createElement("div",!1),this.addClass(t,this.editor),this.editor.contentEditable="true",this.container.appendChild(this.editor)}updateEditor(){const{graph:e,cell:t,editor:n}=this,i=n.style;let o=new pe,s=20;if(t.isNode())o=t.getBBox().center,s=t.size().width-4;else if(t.isEdge()){const d=this.options.event,h=d.target,f=h.parentElement;if(f&&Dg(f,this.prefixClassName("edge-label"))){const g=f.getAttribute("data-index")||"0";this.labelIndex=parseInt(g,10);const v=f.getAttribute("transform"),{translation:y}=qv(v);o=new pe(y.tx,y.ty),s=No(h).width}else{if(!this.options.labelAddable)return this;o=e.clientToLocal(pe.create(d.clientX,d.clientY));const v=this.cellView.path.closestPointLength(o);this.distance=v}}o=e.localToGraph(o),i.left=`${o.x}px`,i.top=`${o.y}px`,i.minWidth=`${s}px`;const a=e.scale();i.transform=`scale(${a.sx}, ${a.sy}) translate(-50%, -50%)`;const l=this.options.attrs;i.fontSize=`${l.fontSize}px`,i.fontFamily=l.fontFamily,i.color=l.color,i.backgroundColor=l.backgroundColor;const c=this.options.getText;let u;return typeof c=="function"&&(u=dn(c,this.cellView,{cell:this.cell,index:this.labelIndex})),n.innerText=u||"",this}onDocumentMouseDown(e){if(e.target!==this.editor){const t=this.cell,n=this.editor.innerText.replace(/\n$/,"")||"",i=this.options.setText;typeof i=="function"&&dn(i,this.cellView,{cell:this.cell,value:n,index:this.labelIndex,distance:this.distance}),t.removeTool(t.isEdge()?"edge-editor":"node-editor"),this.undelegateDocumentEvents()}}onDblClick(e){e.stopPropagation()}onMouseDown(e){e.stopPropagation()}autoFocus(){setTimeout(()=>{this.editor.focus(),this.selectText()})}selectText(){if(window.getSelection){const e=document.createRange(),t=window.getSelection();e.selectNodeContents(this.editor),t.removeAllRanges(),t.addRange(e)}}}(function(r){r.config({tagName:"div",isSVGElement:!1,events:{dblclick:"onDblClick",mousedown:"onMouseDown"},documentEvents:{mousedown:"onDocumentMouseDown"}})})(Mf||(Mf={})),function(r){r.NodeEditor=r.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},getText({cell:e}){return e.attr("text/text")},setText({cell:e,value:t}){e.attr("text/text",t)}}),r.EdgeEditor=r.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},labelAddable:!0,getText({cell:e,index:t}){return t===-1?"":e.prop(`labels/${t}/attrs/label/text`)},setText({cell:e,value:t,index:n,distance:i}){const o=e;n===-1?o.appendLabel({position:{distance:i},attrs:{label:{text:t}}}):t?o.prop(`labels/${n}/attrs/label/text`,t):typeof n=="number"&&o.removeLabelAt(n)}})}(Mf||(Mf={}));var mA=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t},Pf;(function(r){r.presets={boundary:ny,button:cu,"button-remove":cu.Remove,"node-editor":Mf.NodeEditor},r.registry=Qi.create({type:"node tool",process(e,t){if(typeof t=="function")return t;let n=Ao.ToolItem;const{inherit:i}=t,o=mA(t,["inherit"]);if(i){const s=this.get(i);s==null?this.onNotFound(i,"inherited"):n=s}return o.name==null&&(o.name=e),n.define.call(n,o)}}),r.registry.register(r.presets,!0)})(Pf||(Pf={}));var Of;(function(r){r.presets={boundary:ny,vertices:Hg,segments:$g,button:cu,"button-remove":cu.Remove,"source-anchor":JB,"target-anchor":QB,"source-arrowhead":tz,"target-arrowhead":nz,"edge-editor":Mf.EdgeEditor},r.registry=Qi.create({type:"edge tool",process(e,t){if(typeof t=="function")return t;let n=Ao.ToolItem;const{inherit:i}=t,o=mA(t,["inherit"]);if(i){const s=this.get(i);s==null?this.onNotFound(i,"inherited"):n=s}return o.name==null&&(o.name=e),n.define.call(n,o)}}),r.registry.register(r.presets,!0)})(Of||(Of={}));const rz=dc("center"),iz=dc("topCenter"),oz=dc("bottomCenter"),sz=dc("leftMiddle"),az=dc("rightMiddle"),lz=dc("topLeft"),cz=dc("topRight"),uz=dc("bottomLeft"),dz=dc("bottomRight");function dc(r){return function(e,t,n,i={}){const o=i.rotate?e.getUnrotatedBBoxOfElement(t):e.getBBoxOfElement(t),s=o[r];s.x+=Ra(i.dx,o.width),s.y+=Ra(i.dy,o.height);const a=e.cell;return i.rotate?s.rotate(-a.getAngle(),a.getBBox().getCenter()):s}}function oy(r){return function(e,t,n,i){if(n instanceof Element){const o=this.graph.renderer.findViewByElem(n);let s;if(o)if(o.isEdgeElement(n)){const a=i.fixedAt!=null?i.fixedAt:"50%";s=vA(o,a)}else s=o.getBBoxOfElement(n).getCenter();else s=new pe;return r.call(this,e,t,s,i)}return r.apply(this,arguments)}}function vA(r,e){const t=yl(e),n=typeof e=="string"?parseFloat(e):e;return t?r.getPointAtRatio(n/100):r.getPointAtLength(n)}const hz=oy(function(r,e,t,n){const i=r.cell.getAngle(),o=r.getBBoxOfElement(e),s=o.getCenter(),a=o.getTopLeft(),l=o.getBottomRight();let c=n.padding;if(Number.isFinite(c)||(c=0),a.y+c<=t.y&&t.y<=l.y-c){const u=t.y-s.y;s.x+=i===0||i===180?0:u*1/Math.tan(Rr.toRad(i)),s.y+=u}else if(a.x+c<=t.x&&t.x<=l.x-c){const u=t.x-s.x;s.y+=i===90||i===270?0:u*Math.tan(Rr.toRad(i)),s.x+=u}return s}),fz=function(r,e,t,n,i){const o=r.cell.getConnectionPoint(this.cell,i);return(n.dx||n.dy)&&o.translate(n.dx||0,n.dy||0),o},pz=oy(function(r,e,t,n){let i,o=0,s;const a=r.cell;n.rotate?(i=r.getUnrotatedBBoxOfElement(e),s=a.getBBox().getCenter(),o=a.getAngle()):i=r.getBBoxOfElement(e);const l=n.padding;l!=null&&Number.isFinite(l)&&i.inflate(l),n.rotate&&t.rotate(o,s);const c=i.getNearestSideToPoint(t);let u;switch(c){case"left":u=i.getLeftMiddle();break;case"right":u=i.getRightMiddle();break;case"top":u=i.getTopCenter();break;case"bottom":u=i.getBottomCenter();break;default:break}const d=n.direction;return d==="H"?(c==="top"||c==="bottom")&&(t.x<=i.x+i.width?u=i.getLeftMiddle():u=i.getRightMiddle()):d==="V"&&(t.y<=i.y+i.height?u=i.getTopCenter():u=i.getBottomCenter()),n.rotate?u.rotate(-o,s):u});var Df;(function(r){r.presets=V,r.registry=Qi.create({type:"node endpoint"}),r.registry.register(r.presets,!0)})(Df||(Df={}));const gz=function(r,e,t,n){let i=n.ratio!=null?n.ratio:.5;return i>1&&(i/=100),r.getPointAtRatio(i)},mz=function(r,e,t,n){const i=n.length!=null?n.length:20;return r.getPointAtLength(i)},yA=function(r,e,t,n){const i=r.getClosestPoint(t);return i!=null?i:new pe},vz=oy(yA),yz=oy(function(r,e,t,n){const i=1e6,o=r.getConnection(),s=r.getConnectionSubdivisions(),a=new xn(t.clone().translate(0,i),t.clone().translate(0,-i)),l=new xn(t.clone().translate(i,0),t.clone().translate(-i,0)),c=a.intersect(o,{segmentSubdivisions:s}),u=l.intersect(o,{segmentSubdivisions:s}),d=[];return c&&d.push(...c),u&&d.push(...u),d.length>0?t.closest(d):n.fallbackAt!=null?vA(r,n.fallbackAt):dn(yA,this,r,e,t,n)});var Nf;(function(r){r.presets=W,r.registry=Qi.create({type:"edge endpoint"}),r.registry.register(r.presets,!0)})(Nf||(Nf={}));function sy(r,e,t){let n;if(typeof t=="object"){if(Number.isFinite(t.y)){const o=new xn(e,r),{start:s,end:a}=o.parallel(t.y);e=s,r=a}n=t.x}else n=t;if(n==null||!Number.isFinite(n))return r;const i=r.distance(e);return n===0&&i>0?r:r.move(e,-Math.min(n,i-1))}function ay(r){const e=r.getAttribute("stroke-width");return e===null?0:parseFloat(e)||0}function bz(r){if(r==null)return null;let e=r;do{let t=e.tagName;if(typeof t!="string")return null;if(t=t.toUpperCase(),t==="G")e=e.firstElementChild;else if(t==="TITLE")e=e.nextElementSibling;else break}while(e);return e}const bA=function(r,e,t,n){const i=e.getBBoxOfElement(t);n.stroked&&i.inflate(ay(t)/2);const o=r.intersect(i),s=o&&o.length?r.start.closest(o):r.end;return sy(s,r.start,n.offset)},xz=function(r,e,t,n,i){const o=e.cell,s=o.isNode()?o.getAngle():0;if(s===0)return dn(bA,this,r,e,t,n,i);const a=e.getUnrotatedBBoxOfElement(t);n.stroked&&a.inflate(ay(t)/2);const l=a.getCenter(),c=r.clone().rotate(s,l),u=c.setLength(1e6).intersect(a),d=u&&u.length?c.start.closest(u).rotate(-s,l):r.end;return sy(d,r.start,n.offset)},Cz=function(r,e,t,n){let i,o;const s=r.end,a=n.selector;if(typeof a=="string"?i=e.findOne(a):Array.isArray(a)?i=hC(t,a):i=bz(t),!Pd(i)){if(i===t||!Pd(t))return s;i=t}const l=e.getShapeOfElement(i),c=e.getMatrixOfElement(i),u=e.getRootTranslatedMatrix(),d=e.getRootRotatedMatrix(),h=u.multiply(d).multiply(c),f=h.inverse(),p=z6(r,f),g=p.start.clone(),v=e.getDataOfElement(i);if(n.insideout===!1){v.shapeBBox==null&&(v.shapeBBox=l.bbox());const T=v.shapeBBox;if(T!=null&&T.containsPoint(g))return s}n.extrapolate===!0&&p.setLength(1e6);let y;if(Dn.isPath(l)){const T=n.precision||2;v.segmentSubdivisions==null&&(v.segmentSubdivisions=l.getSegmentSubdivisions({precision:T})),y={precision:T,segmentSubdivisions:v.segmentSubdivisions},o=p.intersect(l,y)}else o=p.intersect(l);o?Array.isArray(o)&&(o=g.closest(o)):n.sticky===!0&&(Ht.isRectangle(l)?o=l.getNearestPointToPoint(g):va.isEllipse(l)?o=l.intersectsWithLineFromCenterToPoint(g):o=l.closestPoint(g,y));const x=o?xl(o,h):s;let E=n.offset||0;return n.stroked!==!1&&(typeof E=="object"?(E=Object.assign({},E),E.x==null&&(E.x=0),E.x+=ay(i)/2):E+=ay(i)/2),sy(x,r.start,E)};function wz(r,e,t=0){const{start:n,end:i}=r;let o,s,a,l;switch(e){case"left":l="x",o=i,s=n,a=-1;break;case"right":l="x",o=n,s=i,a=1;break;case"top":l="y",o=i,s=n,a=-1;break;case"bottom":l="y",o=n,s=i,a=1;break;default:return}n[l]<i[l]?o[l]=s[l]:s[l]=o[l],Number.isFinite(t)&&(o[l]+=a*t,s[l]+=a*t)}const Ez=function(r,e,t,n){const{alignOffset:i,align:o}=n;return o&&wz(r,o,i),sy(r.end,r.start,n.offset)};var Rf;(function(r){r.presets=ce,r.registry=Qi.create({type:"connection point"}),r.registry.register(r.presets,!0)})(Rf||(Rf={}));const Sz=function(r){return[...r]},_z=function(r,e,t){const n=e.side||"bottom",i=Us(e.padding||40),o=t.sourceBBox,s=t.targetBBox,a=o.getCenter(),l=s.getCenter();let c,u,d;switch(n){case"top":d=-1,c="y",u="height";break;case"left":d=-1,c="x",u="width";break;case"right":d=1,c="x",u="width";break;case"bottom":default:d=1,c="y",u="height";break}return a[c]+=d*(o[u]/2+i[n]),l[c]+=d*(s[u]/2+i[n]),d*(a[c]-l[c])>0?l[c]=a[c]:a[c]=l[c],[a.toJSON(),...r,l.toJSON()]};function ly(r){return new Ht(r.x,r.y,0,0)}function cy(r={}){const e=Us(r.padding||20);return{x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}function xA(r,e={}){return r.sourceBBox.clone().moveAndExpand(cy(e))}function CA(r,e={}){return r.targetBBox.clone().moveAndExpand(cy(e))}function Az(r,e={}){return r.sourceAnchor?r.sourceAnchor:xA(r,e).getCenter()}function Tz(r,e={}){return r.targetAnchor?r.targetAnchor:CA(r,e).getCenter()}const wA=function(r,e,t){let n=xA(t,e),i=CA(t,e);const o=Az(t,e),s=Tz(t,e);n=n.union(ly(o)),i=i.union(ly(s));const a=r.map(u=>pe.create(u));a.unshift(o),a.push(s);let l=null;const c=[];for(let u=0,d=a.length-1;u<d;u+=1){let h=null;const f=a[u],p=a[u+1],g=ba.getBearing(f,p)!=null;if(u===0)u+1===d?n.intersectsWithRect(i.clone().inflate(1))?h=ba.insideNode(f,p,n,i):g||(h=ba.nodeToNode(f,p,n,i)):n.containsPoint(p)?h=ba.insideNode(f,p,n,ly(p).moveAndExpand(cy(e))):g||(h=ba.nodeToVertex(f,p,n));else if(u+1===d){const v=g&&ba.getBearing(p,f)===l;i.containsPoint(f)||v?h=ba.insideNode(f,p,ly(f).moveAndExpand(cy(e)),i,l):g||(h=ba.vertexToNode(f,p,i,l))}else g||(h=ba.vertexToVertex(f,p,l));h?(c.push(...h.points),l=h.direction):l=ba.getBearing(f,p),u+1<d&&c.push(p)}return c};var ba;(function(r){const e={N:"S",S:"N",E:"W",W:"E"},t={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function n(d,h,f){let p=new pe(d.x,h.y);return f.containsPoint(p)&&(p=new pe(h.x,d.y)),p}function i(d,h){return d[h==="W"||h==="E"?"width":"height"]}r.getBBoxSize=i;function o(d,h){return d.x===h.x?d.y>h.y?"N":"S":d.y===h.y?d.x>h.x?"W":"E":null}r.getBearing=o;function s(d,h,f){const p=new pe(d.x,h.y),g=new pe(h.x,d.y),v=o(d,p),y=o(d,g),x=f?e[f]:null,E=v===f||v!==x&&(y===x||y!==f)?p:g;return{points:[E],direction:o(E,h)}}r.vertexToVertex=s;function a(d,h,f){const p=n(d,h,f);return{points:[p],direction:o(p,h)}}r.nodeToVertex=a;function l(d,h,f,p){const g=[new pe(d.x,h.y),new pe(h.x,d.y)],v=g.filter(E=>!f.containsPoint(E)),y=v.filter(E=>o(E,d)!==p);let x;if(y.length>0)return x=y.filter(E=>o(d,E)===p).pop(),x=x||y[0],{points:[x],direction:o(x,h)};{x=Sd(g,v)[0];const E=pe.create(h).move(x,-i(f,p)/2);return{points:[n(E,d,f),E],direction:o(E,h)}}}r.vertexToNode=l;function c(d,h,f,p){let g=a(h,d,p);const v=g.points[0];if(f.containsPoint(v)){g=a(d,h,f);const y=g.points[0];if(p.containsPoint(y)){const x=pe.create(d).move(y,-i(f,o(d,y))/2),E=pe.create(h).move(v,-i(p,o(h,v))/2),T=new xn(x,E).getCenter(),P=a(d,T,f),z=s(T,h,P.direction);g.points=[P.points[0],z.points[0]],g.direction=z.direction}}return g}r.nodeToNode=c;function u(d,h,f,p,g){const v=f.union(p).inflate(1),y=v.getCenter(),x=y.distance(h)>y.distance(d),E=x?h:d,T=x?d:h;let P,z,$;g?(P=pe.fromPolar(v.width+v.height,t[g],E),P=v.getNearestPointToPoint(P).move(P,-1)):P=v.getNearestPointToPoint(E).move(E,1),z=n(P,T,v);let ne;P.round().equals(z.round())?(z=pe.fromPolar(v.width+v.height,Rr.toRad(P.theta(E))+Math.PI/2,T),z=v.getNearestPointToPoint(z).move(T,1).round(),$=n(P,z,v),ne=x?[z,$,P]:[P,$,z]):ne=x?[z,P]:[P,z];const De=o(x?P:z,h);return{points:ne,direction:De}}r.insideNode=u})(ba||(ba={}));const Mz={step:10,maxLoopCount:2e3,precision:1,maxDirectionChange:90,perpendicular:!0,excludeTerminals:[],excludeShapes:[],excludeNodes:[],excludeHiddenNodes:!1,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost(){return uu(this.step,this)},directions(){const r=uu(this.step,this),e=uu(this.cost,this);return[{cost:e,offsetX:r,offsetY:0},{cost:e,offsetX:-r,offsetY:0},{cost:e,offsetX:0,offsetY:r},{cost:e,offsetX:0,offsetY:-r}]},penalties(){const r=uu(this.step,this);return{0:0,45:r/2,90:r/2}},paddingBox(){const r=uu(this.step,this);return{x:-r,y:-r,width:2*r,height:2*r}},fallbackRouter:wA,draggingRouter:null};function uu(r,e){return typeof r=="function"?r.call(e):r}function Pz(r){const e=Object.keys(r).reduce((t,n)=>{const i=t;return n==="fallbackRouter"||n==="draggingRouter"||n==="fallbackRoute"?i[n]=r[n]:i[n]=uu(r[n],r),t},{});if(e.padding){const t=Us(e.padding);e.paddingBox={x:-t.left,y:-t.top,width:t.left+t.right,height:t.top+t.bottom}}return e.directions.forEach(t=>{const n=new pe(0,0),i=new pe(t.offsetX,t.offsetY);t.angle=Rr.normalize(n.theta(i))}),e}const EA=1,SA=2;class Oz{constructor(){this.items=[],this.hash={},this.values={}}add(e,t){this.hash[e]?this.items.splice(this.items.indexOf(e),1):this.hash[e]=EA,this.values[e]=t;const n=Qh(this.items,e,i=>this.values[i]);this.items.splice(n,0,e)}pop(){const e=this.items.shift();return e&&(this.hash[e]=SA),e}isOpen(e){return this.hash[e]===EA}isClose(e){return this.hash[e]===SA}isEmpty(){return this.items.length===0}}class Dz{constructor(e){this.options=e,this.mapGridSize=100,this.map={}}build(e,t){const n=this.options,i=n.excludeTerminals.reduce((c,u)=>{const d=t[u];if(d){const h=e.getCell(d.cell);h&&c.push(h)}return c},[]);let o=[];const s=e.getCell(t.getSourceCellId());s&&(o=Ft(o,s.getAncestors().map(c=>c.id)));const a=e.getCell(t.getTargetCellId());a&&(o=Ft(o,a.getAncestors().map(c=>c.id)));const l=this.mapGridSize;return e.getNodes().reduce((c,u)=>{const d=u.shape,h=n.excludeShapes,f=d?h.includes(d):!1,p=i.some(E=>E.id===u.id),g=n.excludeNodes.some(E=>typeof E=="string"?u.id===E:E===u),v=o.includes(u.id),y=n.excludeHiddenNodes&&!u.isVisible();if(!(f||p||g||v||y)){const E=u.getBBox().moveAndExpand(n.paddingBox),T=E.getOrigin().snapToGrid(l),P=E.getCorner().snapToGrid(l);for(let z=T.x;z<=P.x;z+=l)for(let $=T.y;$<=P.y;$+=l){const ne=new pe(z,$).toString();c[ne]==null&&(c[ne]=[]),c[ne].push(E)}}return c},this.map),this}isAccessible(e){const t=e.clone().snapToGrid(this.mapGridSize).toString(),n=this.map[t];return n?n.every(i=>!i.containsPoint(e)):!0}}function _A(r,e){const t=r.sourceBBox.clone();return e&&e.paddingBox?t.moveAndExpand(e.paddingBox):t}function AA(r,e){const t=r.targetBBox.clone();return e&&e.paddingBox?t.moveAndExpand(e.paddingBox):t}function TA(r,e){return r.sourceAnchor?r.sourceAnchor:_A(r,e).getCenter()}function Nz(r,e){return r.targetAnchor?r.targetAnchor:AA(r,e).getCenter()}function o1(r,e,t,n,i){const o=360/t,s=r.theta(Rz(r,e,n,i)),a=Rr.normalize(s+o/2);return o*Math.floor(a/o)}function Rz(r,e,t,n){const i=n.step,o=e.x-r.x,s=e.y-r.y,a=o/t.x,l=s/t.y,c=a*i,u=l*i;return new pe(r.x+c,r.y+u)}function MA(r,e){const t=Math.abs(r-e);return t>180?360-t:t}function kz(r,e){const t=e.step;return e.directions.forEach(n=>{n.gridOffsetX=n.offsetX/t*r.x,n.gridOffsetY=n.offsetY/t*r.y}),e.directions}function Iz(r,e,t){return{source:e.clone(),x:PA(t.x-e.x,r),y:PA(t.y-e.y,r)}}function PA(r,e){if(!r)return e;const t=Math.abs(r),n=Math.round(t/e);if(!n)return t;const i=n*e,s=(t-i)/n;return e+s}function Lz(r,e){const t=e.source,n=ao.snapToGrid(r.x-t.x,e.x)+t.x,i=ao.snapToGrid(r.y-t.y,e.y)+t.y;return new pe(n,i)}function Wg(r,e){return r.round(e)}function uy(r,e,t){return Wg(Lz(r.clone(),e),t)}function Zg(r){return r.toString()}function s1(r){return new pe(r.x===0?0:Math.abs(r.x)/r.x,r.y===0?0:Math.abs(r.y)/r.y)}function OA(r,e){let t=Infinity;for(let n=0,i=e.length;n<i;n+=1){const o=r.manhattanDistance(e[n]);o<t&&(t=o)}return t}function DA(r,e,t,n,i){const o=i.precision,s=i.directionMap,a=r.diff(e.getCenter()),l=Object.keys(s).reduce((c,u)=>{if(t.includes(u)){const d=s[u],h=new pe(r.x+d.x*(Math.abs(a.x)+e.width),r.y+d.y*(Math.abs(a.y)+e.height)),p=new xn(r,h).intersect(e)||[];let g,v=null;for(let y=0;y<p.length;y+=1){const x=p[y],E=r.squaredDistance(x);(g==null||E>g)&&(g=E,v=x)}if(v){let y=uy(v,n,o);e.containsPoint(y)&&(y=uy(y.translate(d.x*n.x,d.y*n.y),n,o)),c.push(y)}}return c},[]);return e.containsPoint(r)||l.push(uy(r,n,o)),l}function Gz(r,e,t,n,i){const o=[];let s=s1(i.diff(t)),a=Zg(t),l=r[a],c;for(;l;){c=e[a];const h=s1(c.diff(l));h.equals(s)||(o.unshift(c),s=h),a=Zg(l),l=r[a]}const u=e[a];return s1(u.diff(n)).equals(s)||o.unshift(u),o}function Fz(r,e,t,n,i){const o=i.precision;let s,a;Ht.isRectangle(e)?s=Wg(TA(r,i).clone(),o):s=Wg(e.clone(),o),Ht.isRectangle(t)?a=Wg(Nz(r,i).clone(),o):a=Wg(t.clone(),o);const l=Iz(i.step,s,a),c=s,u=a;let d,h;if(Ht.isRectangle(e)?d=DA(c,e,i.startDirections,l,i):d=[c],Ht.isRectangle(t)?h=DA(a,t,i.endDirections,l,i):h=[u],d=d.filter(f=>n.isAccessible(f)),h=h.filter(f=>n.isAccessible(f)),d.length>0&&h.length>0){const f=new Oz,p={},g={},v={};for(let fe=0,Ae=d.length;fe<Ae;fe+=1){const de=d[fe],ct=Zg(de);f.add(ct,OA(de,h)),p[ct]=de,v[ct]=0}const y=i.previousDirectionAngle,x=y===void 0;let E,T;const P=kz(l,i),z=P.length,$=h.reduce((fe,Ae)=>{const de=Zg(Ae);return fe.push(de),fe},[]),ne=pe.equalPoints(d,h);let De=i.maxLoopCount;for(;!f.isEmpty()&&De>0;){const fe=f.pop(),Ae=p[fe],de=g[fe],ct=v[fe],bt=Ae.equals(c),Pe=de==null;let tt;if(Pe?x?bt?tt=null:tt=o1(c,Ae,z,l,i):tt=y:tt=o1(de,Ae,z,l,i),!(Pe&&ne)&&$.indexOf(fe)>=0)return i.previousDirectionAngle=tt,Gz(g,p,Ae,c,u);for(let tn=0;tn<z;tn+=1){E=P[tn];const Bn=E.angle;if(T=MA(tt,Bn),!(x&&bt)&&T>i.maxDirectionChange)continue;const cr=uy(Ae.clone().translate(E.gridOffsetX||0,E.gridOffsetY||0),l,o),gn=Zg(cr);if(f.isClose(gn)||!n.isAccessible(cr))continue;if($.indexOf(gn)>=0&&!cr.equals(u)){const Kn=o1(cr,u,z,l,i);if(MA(Bn,Kn)>i.maxDirectionChange)continue}const si=E.cost,xi=bt?0:i.penalties[T],Nt=ct+si+xi;(!f.isOpen(gn)||Nt<v[gn])&&(p[gn]=cr,g[gn]=Ae,v[gn]=Nt,f.add(gn,Nt+OA(cr,h)))}De-=1}}return i.fallbackRoute?dn(i.fallbackRoute,this,c,u,i):null}const Bz=function(r,e,t){const n=Pz(e),i=_A(t,n),o=AA(t,n),s=TA(t,n),a=new Dz(n).build(t.graph.model,t.cell),l=r.map(f=>pe.create(f)),c=[];let u=s,d,h;for(let f=0,p=l.length;f<=p;f+=1){let g=null;if(d=h||i,h=l[f],h==null){h=o;const y=t.cell;if((y.getSourceCellId()==null||y.getTargetCellId()==null)&&typeof n.draggingRouter=="function"){const E=d===i?s:d,T=h.getOrigin();g=dn(n.draggingRouter,t,E,T,n)}}if(g==null&&(g=Fz(t,d,h,a,n)),g===null)return console.warn("Unable to execute manhattan algorithm, use orth instead"),dn(n.fallbackRouter,this,r,n,t);const v=g[0];v&&v.equals(u)&&g.shift(),u=g[g.length-1]||u,c.push(...g)}return c},NA=function(r,e,t){return dn(Bz,this,r,Object.assign(Object.assign({},Mz),e),t)},zz={maxDirectionChange:45,directions(){const r=uu(this.step,this),e=uu(this.cost,this),t=Math.ceil(Math.sqrt(r*r<<1));return[{cost:e,offsetX:r,offsetY:0},{cost:t,offsetX:r,offsetY:r},{cost:e,offsetX:0,offsetY:r},{cost:t,offsetX:-r,offsetY:r},{cost:e,offsetX:-r,offsetY:0},{cost:t,offsetX:-r,offsetY:-r},{cost:e,offsetX:0,offsetY:-r},{cost:t,offsetX:r,offsetY:-r}]},fallbackRoute(r,e,t){const n=r.theta(e),i=[];let o={x:e.x,y:r.y},s={x:r.x,y:e.y};if(n%180>90){const E=o;o=s,s=E}const a=n%90<45?o:s,l=new xn(r,a),c=90*Math.ceil(n/90),u=pe.fromPolar(l.squaredLength(),Rr.toRad(c+135),a),d=new xn(e,u),h=l.intersectsWithLine(d),f=h||e,p=h?f:r,g=360/t.directions.length,v=p.theta(e),y=Rr.normalize(v+g/2),x=g*Math.floor(y/g);return t.previousDirectionAngle=x,f&&i.push(f.round()),i.push(e),i}},Uz=function(r,e,t){return dn(NA,this,r,Object.assign(Object.assign({},zz),e),t)},Vz=function(r,e,t){const n=e.offset||32,i=e.min==null?16:e.min;let o=0,s=e.direction;const a=t.sourceBBox,l=t.targetBBox,c=a.getCenter(),u=l.getCenter();if(typeof n=="number"&&(o=n),s==null){let y=l.left-a.right,x=l.top-a.bottom;y>=0&&x>=0?s=y>=x?"L":"T":y<=0&&x>=0?(y=a.left-l.right,y>=0?s=y>=x?"R":"T":s="T"):y>=0&&x<=0?(x=a.top-l.bottom,x>=0?s=y>=x?"L":"B":s="L"):(y=a.left-l.right,x=a.top-l.bottom,y>=0&&x>=0?s=y>=x?"R":"B":y<=0&&x>=0?s="B":y>=0&&x<=0?s="R":s=Math.abs(y)>Math.abs(x)?"R":"B")}s==="H"?s=u.x-c.x>=0?"L":"R":s==="V"&&(s=u.y-c.y>=0?"T":"B"),n==="center"&&(s==="L"?o=(l.left-a.right)/2:s==="R"?o=(a.left-l.right)/2:s==="T"?o=(l.top-a.bottom)/2:s==="B"&&(o=(a.top-l.bottom)/2));let d,h,f;const p=s==="L"||s==="R";if(p){if(u.y===c.y)return[...r];f=s==="L"?1:-1,d="x",h="width"}else{if(u.x===c.x)return[...r];f=s==="T"?1:-1,d="y",h="height"}const g=c.clone(),v=u.clone();if(g[d]+=f*(a[h]/2+o),v[d]-=f*(l[h]/2+o),p){const y=g.x,x=v.x,E=a.width/2+i,T=l.width/2+i;u.x>c.x?x<=y&&(g.x=Math.max(x,c.x+E),v.x=Math.min(y,u.x-T)):x>=y&&(g.x=Math.min(x,c.x-E),v.x=Math.max(y,u.x+T))}else{const y=g.y,x=v.y,E=a.height/2+i,T=l.height/2+i;u.y>c.y?x<=y&&(g.y=Math.max(x,c.y+E),v.y=Math.min(y,u.y-T)):x>=y&&(g.y=Math.min(x,c.y-E),v.y=Math.max(y,u.y+T))}return[g.toJSON(),...r,v.toJSON()]};function kf(r,e){if(e!=null&&e!==!1){const t=typeof e=="boolean"?0:e;if(t>0){const n=pe.create(r[1]).move(r[2],t),i=pe.create(r[1]).move(r[0],t);return[n.toJSON(),...r,i.toJSON()]}{const n=r[1];return[Object.assign({},n),...r,Object.assign({},n)]}}return r}const jz=function(r,e,t){const n=e.width||50,o=(e.height||80)/2,s=e.angle||"auto",a=t.sourceAnchor,l=t.targetAnchor,c=t.sourceBBox,u=t.targetBBox;if(a.equals(l)){const d=y=>{const x=Rr.toRad(y),E=Math.sin(x),T=Math.cos(x),P=new pe(a.x+T*n,a.y+E*n),z=new pe(P.x-T*o,P.y-E*o),$=z.clone().rotate(-90,P),ne=z.clone().rotate(90,P);return[$.toJSON(),P.toJSON(),ne.toJSON()]},h=y=>{const x=a.clone().move(y,-1),E=new xn(x,y);return!c.containsPoint(y)&&!c.intersectsWithLine(E)},f=[0,90,180,270,45,135,225,315];if(typeof s=="number")return kf(d(s),e.merge);const p=c.getCenter();if(p.equals(a))return kf(d(0),e.merge);const g=p.angleBetween(a,p.clone().translate(1,0));let v=d(g);if(h(v[1]))return kf(v,e.merge);for(let y=1,x=f.length;y<x;y+=1)if(v=d(g+f[y]),h(v[1]))return kf(v,e.merge);return kf(v,e.merge)}{const d=new xn(a,l);let h=d.parallel(-n),f=h.getCenter(),p=h.start.clone().move(h.end,o),g=h.end.clone().move(h.start,o);const v=d.parallel(-1),y=new xn(v.start,f),x=new xn(v.end,f);if((c.containsPoint(f)||u.containsPoint(f)||c.intersectsWithLine(y)||c.intersectsWithLine(x)||u.intersectsWithLine(y)||u.intersectsWithLine(x))&&(h=d.parallel(n),f=h.getCenter(),p=h.start.clone().move(h.end,o),g=h.end.clone().move(h.start,o)),e.merge){const E=new xn(a,l),T=new xn(f,E.center).setLength(Number.MAX_SAFE_INTEGER),P=c.intersectsWithLine(T),z=u.intersectsWithLine(T),$=P?Array.isArray(P)?P:[P]:[];z&&(Array.isArray(z)?$.push(...z):$.push(z));const ne=E.center.closest($);ne?(t.sourceAnchor=ne.clone(),t.targetAnchor=ne.clone()):(t.sourceAnchor=E.center.clone(),t.targetAnchor=E.center.clone())}return kf([p.toJSON(),f.toJSON(),g.toJSON()],e.merge)}};var du;(function(r){r.presets=B,r.registry=Qi.create({type:"router"}),r.registry.register(r.presets,!0)})(du||(du={}));const Hz=function(r,e,t,n={}){const i=[r,...t,e],o=new so(i),s=new Dn(o);return n.raw?s:s.serialize()},$z=function(r,e,t,n={}){const i=t.length===3?0:1,o=pe.create(t[0+i]),s=pe.create(t[2+i]),a=pe.create(t[1+i]);if(!pe.equals(r,e)){const c=new pe((r.x+e.x)/2,(r.y+e.y)/2),u=c.angleBetween(pe.create(r).rotate(90,c),a);u>1&&(o.rotate(180-u,c),s.rotate(180-u,c),a.rotate(180-u,c))}const l=`
     M ${r.x} ${r.y}
     Q ${o.x} ${o.y} ${a.x} ${a.y}
     Q ${s.x} ${s.y} ${e.x} ${e.y}
  `;return n.raw?Dn.parse(l):l},Wz=function(r,e,t,n={}){const i=new Dn;i.appendSegment(Dn.createSegment("M",r));const o=1/3,s=2/3,a=n.radius||10;let l,c;for(let u=0,d=t.length;u<d;u+=1){const h=pe.create(t[u]),f=t[u-1]||r,p=t[u+1]||e;l=c||h.distance(f)/2,c=h.distance(p)/2;const g=-Math.min(a,l),v=-Math.min(a,c),y=h.clone().move(f,g).round(),x=h.clone().move(p,v).round(),E=new pe(o*y.x+s*h.x,s*h.y+o*y.y),T=new pe(o*x.x+s*h.x,s*h.y+o*x.y);i.appendSegment(Dn.createSegment("L",y)),i.appendSegment(Dn.createSegment("C",E,T,x))}return i.appendSegment(Dn.createSegment("L",e)),n.raw?i:i.serialize()},Zz=function(r,e,t,n={}){let i,o=n.direction;if(t&&t.length!==0){const s=[r,...t,e],a=Ji.throughPoints(s);i=new Dn(a)}else if(i=new Dn,i.appendSegment(Dn.createSegment("M",r)),o||(o=Math.abs(r.x-e.x)>=Math.abs(r.y-e.y)?"H":"V"),o==="H"){const s=(r.x+e.x)/2;i.appendSegment(Dn.createSegment("C",s,r.y,s,e.y,e.x,e.y))}else{const s=(r.y+e.y)/2;i.appendSegment(Dn.createSegment("C",r.x,s,e.x,s,e.x,e.y))}return n.raw?i:i.serialize()},RA=1,dy=1/3,hy=2/3;function Xz(r){let e=r.graph._jumpOverUpdateList;if(e==null&&(e=r.graph._jumpOverUpdateList=[],r.graph.on("cell:mouseup",()=>{const t=r.graph._jumpOverUpdateList;for(let n=0;n<t.length;n+=1)t[n].update()}),r.graph.on("model:reseted",()=>{e=r.graph._jumpOverUpdateList=[]})),e.indexOf(r)<0){e.push(r);const t=()=>e.splice(e.indexOf(r),1);r.cell.once("change:connector",t),r.cell.once("removed",t)}}function a1(r,e,t=[]){const n=[r,...t,e],i=[];return n.forEach((o,s)=>{const a=n[s+1];a!=null&&i.push(new xn(o,a))}),i}function Yz(r,e){const t=[];return e.forEach(n=>{const i=r.intersectsWithLine(n);i&&t.push(i)}),t}function kA(r,e){return new xn(r,e).squaredLength()}function Kz(r,e,t){return e.reduce((n,i,o)=>{if(fy.includes(i))return n;const s=n.pop()||r,a=pe.create(i).move(s.start,-t);let l=pe.create(i).move(s.start,+t);const c=e[o+1];if(c!=null){const h=l.distance(c);h<=t&&(l=c.move(s.start,h),fy.push(c))}else if(a.distance(s.end)<t*2+RA)return n.push(s),n;if(l.distance(s.start)<t*2+RA)return n.push(s),n;const d=new xn(a,l);return Xg.push(d),n.push(new xn(s.start,a),d,new xn(l,s.end)),n},[])}function IA(r,e,t,n){const i=new Dn;let o;return o=Dn.createSegment("M",r[0].start),i.appendSegment(o),r.forEach((s,a)=>{if(Xg.includes(s)){let l,c,u,d;if(t==="arc"){l=-90,c=s.start.diff(s.end),(c.x<0||c.x===0&&c.y<0)&&(l+=180);const f=s.getCenter(),p=new xn(f,s.end).rotate(l,f);let g;g=new xn(s.start,f),u=g.pointAt(2/3).rotate(l,s.start),d=p.pointAt(1/3).rotate(-l,p.end),o=Dn.createSegment("C",u,d,p.end),i.appendSegment(o),g=new xn(f,s.end),u=p.pointAt(1/3).rotate(l,p.end),d=g.pointAt(1/3).rotate(-l,s.end),o=Dn.createSegment("C",u,d,s.end),i.appendSegment(o)}else if(t==="gap")o=Dn.createSegment("M",s.end),i.appendSegment(o);else if(t==="cubic"){l=s.start.theta(s.end);const h=e*.6;let f=e*1.35;c=s.start.diff(s.end),(c.x<0||c.x===0&&c.y<0)&&(f*=-1),u=new pe(s.start.x+h,s.start.y+f).rotate(l,s.start),d=new pe(s.end.x-h,s.end.y+f).rotate(l,s.end),o=Dn.createSegment("C",u,d,s.end),i.appendSegment(o)}}else{const l=r[a+1];n===0||!l||Xg.includes(l)?(o=Dn.createSegment("L",s.end),i.appendSegment(o)):qz(n,i,s.end,s.start,l.end)}}),i}function qz(r,e,t,n,i){const o=t.distance(n)/2,s=t.distance(i)/2,a=-Math.min(r,o),l=-Math.min(r,s),c=t.clone().move(n,a).round(),u=t.clone().move(i,l).round(),d=new pe(dy*c.x+hy*t.x,hy*t.y+dy*c.y),h=new pe(dy*u.x+hy*t.x,hy*t.y+dy*u.y);let f;f=Dn.createSegment("L",c),e.appendSegment(f),f=Dn.createSegment("C",d,h,u),e.appendSegment(f)}let Xg,fy;const Jz=function(r,e,t,n={}){Xg=[],fy=[],Xz(this);const i=n.size||5,o=n.type||"arc",s=n.radius||0,a=n.ignoreConnectors||["smooth"],l=this.graph,u=l.model.getEdges();if(u.length===1)return IA(a1(r,e,t),i,o,s);const d=this.cell,h=u.indexOf(d),f=l.options.connecting.connector||{},p=u.filter((T,P)=>{const z=T.getConnector()||f;return a.includes(z.name)?!1:P>h?z.name!=="jumpover":!0}),g=p.map(T=>l.renderer.findViewByCell(T)),v=a1(r,e,t),y=g.map(T=>T==null?[]:T===this?v:a1(T.sourcePoint,T.targetPoint,T.routePoints)),x=[];v.forEach(T=>{const P=p.reduce((z,$,ne)=>{if($!==d){const De=Yz(T,y[ne]);z.push(...De)}return z},[]).sort((z,$)=>kA(T.start,z)-kA(T.start,$));P.length>0?x.push(...Kz(T,P,i)):x.push(T)});const E=IA(x,i,o,s);return Xg=[],fy=[],n.raw?E:E.serialize()};var wl;(function(r){r.presets=se,r.registry=Qi.create({type:"connector"}),r.registry.register(r.presets,!0)})(wl||(wl={}));const Qz=Qi.create;class Yg{constructor(e){this.cell=e,this.ids={},this.cache={}}get(){return Object.keys(this.ids)}start(e,t,n={},i="/"){const o=this.cell.getPropByPath(e),s=KI(n,Yg.defaultOptions),a=this.getTiming(s.timing),l=this.getInterp(s.interp,o,t);let c=0;const u=Array.isArray(e)?e.join(i):e,d=Array.isArray(e)?e:e.split(i),h=()=>{const f=new Date().getTime();c===0&&(c=f);let g=(f-c)/s.duration;g<1?this.ids[u]=VC(h):g=1;const v=l(a(g));this.cell.setPropByPath(d,v),n.progress&&n.progress(Object.assign({progress:g,currentValue:v},this.getArgs(u))),g===1&&(this.cell.notify("transition:end",this.getArgs(u)),this.cell.notify("transition:complete",this.getArgs(u)),n.complete&&n.complete(this.getArgs(u)),this.cell.notify("transition:finish",this.getArgs(u)),n.finish&&n.finish(this.getArgs(u)),this.clean(u))};return setTimeout(()=>{this.stop(e,void 0,i),this.cache[u]={startValue:o,targetValue:t,options:s},this.ids[u]=VC(h),this.cell.notify("transition:begin",this.getArgs(u)),this.cell.notify("transition:start",this.getArgs(u)),n.start&&n.start(this.getArgs(u))},n.delay),this.stop.bind(this,e,i,n)}stop(e,t={},n="/"){const i=Array.isArray(e)?e:e.split(n);return Object.keys(this.ids).filter(o=>ri(i,o.split(n).slice(0,i.length))).forEach(o=>{jC(this.ids[o]);const s=this.cache[o],a=this.getArgs(o),l=Object.assign(Object.assign({},s.options),t),c=l.jumpedToEnd;c&&s.targetValue!=null&&(this.cell.setPropByPath(o,s.targetValue),this.cell.notify("transition:end",Object.assign({},a)),this.cell.notify("transition:complete",Object.assign({},a)),l.complete&&l.complete(Object.assign({},a)));const u=Object.assign({jumpedToEnd:c},a);this.cell.notify("transition:stop",Object.assign({},u)),l.stop&&l.stop(Object.assign({},u)),this.cell.notify("transition:finish",Object.assign({},a)),l.finish&&l.finish(Object.assign({},a)),this.clean(o)}),this}clean(e){delete this.ids[e],delete this.cache[e]}getTiming(e){return typeof e=="string"?kd[e]:e}getInterp(e,t,n){return e?e(t,n):typeof n=="number"?Id.number(t,n):typeof n=="string"?n[0]==="#"?Id.color(t,n):Id.unit(t,n):Id.object(t,n)}getArgs(e){const t=this.cache[e];return{path:e,startValue:t.startValue,targetValue:t.targetValue,cell:this.cell}}}(function(r){r.defaultOptions={delay:10,duration:100,timing:"linear"}})(Yg||(Yg={}));var eU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class LA extends rs{constructor(e={}){super();this.pending=!1,this.changing=!1,this.data={},this.mutate(Ki(e)),this.changed={}}mutate(e,t={}){const n=t.unset===!0,i=t.silent===!0,o=[],s=this.changing;this.changing=!0,s||(this.previous=Ki(this.data),this.changed={});const a=this.data,l=this.previous,c=this.changed;if(Object.keys(e).forEach(u=>{const d=u,h=e[d];ri(a[d],h)||o.push(d),ri(l[d],h)?delete c[d]:c[d]=h,n?delete a[d]:a[d]=h}),!i&&o.length>0&&(this.pending=!0,this.pendingOptions=t,o.forEach(u=>{this.emit("change:*",{key:u,options:t,store:this,current:a[u],previous:l[u]})})),s)return this;if(!i)for(;this.pending;)this.pending=!1,this.emit("changed",{current:a,previous:l,store:this,options:this.pendingOptions});return this.pending=!1,this.changing=!1,this.pendingOptions=null,this}get(e,t){if(e==null)return this.data;const n=this.data[e];return n==null?t:n}getPrevious(e){if(this.previous){const t=this.previous[e];return t==null?void 0:t}}set(e,t,n){return e!=null&&(typeof e=="object"?this.mutate(e,t):this.mutate({[e]:t},n)),this}remove(e,t){const n=void 0,i={};let o;if(typeof e=="string")i[e]=n,o=t;else if(Array.isArray(e))e.forEach(s=>i[s]=n),o=t;else{for(const s in this.data)i[s]=n;o=e}return this.mutate(i,Object.assign(Object.assign({},o),{unset:!0})),this}getByPath(e){return hC(this.data,e,"/")}setByPath(e,t,n={}){const i="/",o=Array.isArray(e)?[...e]:e.split(i),s=Array.isArray(e)?e.join(i):e,a=o[0],l=o.length;if(n.propertyPath=s,n.propertyValue=t,n.propertyPathArray=o,l===1)this.set(a,t,n);else{const c={};let u=c,d=a;for(let p=1;p<l;p+=1){const g=o[p],v=Number.isFinite(Number(g));u=u[d]=v?[]:{},d=g}df(c,o,t,i);const h=Ki(this.data);n.rewrite&&tS(h,e,i);const f=ir(h,c);this.set(a,f[a],n)}return this}removeByPath(e,t){const n=Array.isArray(e)?e:e.split("/"),i=n[0];if(n.length===1)this.remove(i,t);else{const o=n.slice(1),s=Ki(this.get(i));s&&tS(s,o),this.set(i,s,t)}return this}hasChanged(e){return e==null?Object.keys(this.changed).length>0:e in this.changed}getChanges(e){if(e==null)return this.hasChanged()?Ki(this.changed):null;const t=this.changing?this.previous:this.data,n={};let i;for(const o in e){const s=e[o];ri(t[o],s)||(n[o]=s,i=!0)}return i?Ki(n):null}toJSON(){return Ki(this.data)}clone(){const e=this.constructor;return new e(this.data)}dispose(){this.off(),this.data={},this.previous={},this.changed={},this.pending=!1,this.changing=!1,this.pendingOptions=null,this.trigger("disposed",{store:this})}}eU([rs.dispose()],LA.prototype,"dispose",null);var tU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o},GA=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Tr extends rs{constructor(e={}){super();const n=this.constructor.getDefaults(!0),i=ir({},this.preprocess(n),this.preprocess(e));this.id=i.id||EC(),this.store=new LA(i),this.animation=new Yg(this),this.setup(),this.init(),this.postprocess(e)}static config(e){const{markup:t,propHooks:n,attrHooks:i}=e,o=GA(e,["markup","propHooks","attrHooks"]);t!=null&&(this.markup=t),n&&(this.propHooks=this.propHooks.slice(),Array.isArray(n)?this.propHooks.push(...n):typeof n=="function"?this.propHooks.push(n):Object.keys(n).forEach(s=>{const a=n[s];typeof a=="function"&&this.propHooks.push(a)})),i&&(this.attrHooks=Object.assign(Object.assign({},this.attrHooks),i)),this.defaults=ir({},this.defaults,o)}static getMarkup(){return this.markup}static getDefaults(e){return e?this.defaults:Ki(this.defaults)}static getAttrHooks(){return this.attrHooks}static applyPropHooks(e,t){return this.propHooks.reduce((n,i)=>i?dn(i,e,n):n,t)}get[Symbol.toStringTag](){return Tr.toStringTag}init(){}get model(){return this._model}set model(e){this._model!==e&&(this._model=e)}preprocess(e,t){const n=e.id,o=this.constructor.applyPropHooks(this,e);return n==null&&t!==!0&&(o.id=EC()),o}postprocess(e){}setup(){this.store.on("change:*",e=>{const{key:t,current:n,previous:i,options:o}=e;this.notify("change:*",{key:t,options:o,current:n,previous:i,cell:this}),this.notify(`change:${t}`,{options:o,current:n,previous:i,cell:this});const s=t;(s==="source"||s==="target")&&this.notify("change:terminal",{type:s,current:n,previous:i,options:o,cell:this})}),this.store.on("changed",({options:e})=>this.notify("changed",{options:e,cell:this}))}notify(e,t){this.trigger(e,t);const n=this.model;return n&&(n.notify(`cell:${e}`,t),this.isNode()?n.notify(`node:${e}`,Object.assign(Object.assign({},t),{node:this})):this.isEdge()&&n.notify(`edge:${e}`,Object.assign(Object.assign({},t),{edge:this}))),this}isNode(){return!1}isEdge(){return!1}isSameStore(e){return this.store===e.store}get view(){return this.store.get("view")}get shape(){return this.store.get("shape","")}getProp(e,t){return e==null?this.store.get():this.store.get(e,t)}setProp(e,t,n){if(typeof e=="string")this.store.set(e,t,n);else{const i=this.preprocess(e,!0);this.store.set(ir({},this.getProp(),i),t),this.postprocess(e)}return this}removeProp(e,t){return typeof e=="string"||Array.isArray(e)?this.store.removeByPath(e,t):this.store.remove(t),this}hasChanged(e){return e==null?this.store.hasChanged():this.store.hasChanged(e)}getPropByPath(e){return this.store.getByPath(e)}setPropByPath(e,t,n={}){return this.model&&(e==="children"?this._children=t?t.map(i=>this.model.getCell(i)).filter(i=>i!=null):null:e==="parent"&&(this._parent=t?this.model.getCell(t):null)),this.store.setByPath(e,t,n),this}removePropByPath(e,t={}){const n=Array.isArray(e)?e:e.split("/");return n[0]==="attrs"&&(t.dirty=!0),this.store.removeByPath(n,t),this}prop(e,t,n){return e==null?this.getProp():typeof e=="string"||Array.isArray(e)?arguments.length===1?this.getPropByPath(e):t==null?this.removePropByPath(e,n||{}):this.setPropByPath(e,t,n||{}):this.setProp(e,t||{})}previous(e){return this.store.getPrevious(e)}get zIndex(){return this.getZIndex()}set zIndex(e){e==null?this.removeZIndex():this.setZIndex(e)}getZIndex(){return this.store.get("zIndex")}setZIndex(e,t={}){return this.store.set("zIndex",e,t),this}removeZIndex(e={}){return this.store.remove("zIndex",e),this}toFront(e={}){const t=this.model;if(t){let n=t.getMaxZIndex(),i;e.deep?(i=this.getDescendants({deep:!0,breadthFirst:!0}),i.unshift(this)):i=[this],n=n-i.length+1;const o=t.total();let s=t.indexOf(this)!==o-i.length;s||(s=i.some((a,l)=>a.getZIndex()!==n+l)),s&&this.batchUpdate("to-front",()=>{n+=i.length,i.forEach((a,l)=>{a.setZIndex(n+l,e)})})}return this}toBack(e={}){const t=this.model;if(t){let n=t.getMinZIndex(),i;e.deep?(i=this.getDescendants({deep:!0,breadthFirst:!0}),i.unshift(this)):i=[this];let o=t.indexOf(this)!==0;o||(o=i.some((s,a)=>s.getZIndex()!==n+a)),o&&this.batchUpdate("to-back",()=>{n-=i.length,i.forEach((s,a)=>{s.setZIndex(n+a,e)})})}return this}get markup(){return this.getMarkup()}set markup(e){e==null?this.removeMarkup():this.setMarkup(e)}getMarkup(){let e=this.store.get("markup");return e==null&&(e=this.constructor.getMarkup()),e}setMarkup(e,t={}){return this.store.set("markup",e,t),this}removeMarkup(e={}){return this.store.remove("markup",e),this}get attrs(){return this.getAttrs()}set attrs(e){e==null?this.removeAttrs():this.setAttrs(e)}getAttrs(){const e=this.store.get("attrs");return e?Object.assign({},e):{}}setAttrs(e,t={}){if(e==null)this.removeAttrs(t);else{const n=i=>this.store.set("attrs",i,t);if(t.overwrite===!0)n(e);else{const i=this.getAttrs();t.deep===!1?n(Object.assign(Object.assign({},i),e)):n(ir({},i,e))}}return this}replaceAttrs(e,t={}){return this.setAttrs(e,Object.assign(Object.assign({},t),{overwrite:!0}))}updateAttrs(e,t={}){return this.setAttrs(e,Object.assign(Object.assign({},t),{deep:!1}))}removeAttrs(e={}){return this.store.remove("attrs",e),this}getAttrDefinition(e){if(!e)return null;const n=this.constructor.getAttrHooks()||{};let i=n[e]||Cl.registry.get(e);if(!i){const o=Uv(e);i=n[o]||Cl.registry.get(o)}return i||null}getAttrByPath(e){return e==null||e===""?this.getAttrs():this.getPropByPath(this.prefixAttrPath(e))}setAttrByPath(e,t,n={}){return this.setPropByPath(this.prefixAttrPath(e),t,n),this}removeAttrByPath(e,t={}){return this.removePropByPath(this.prefixAttrPath(e),t),this}prefixAttrPath(e){return Array.isArray(e)?["attrs"].concat(e):`attrs/${e}`}attr(e,t,n){return e==null?this.getAttrByPath():typeof e=="string"||Array.isArray(e)?arguments.length===1?this.getAttrByPath(e):t==null?this.removeAttrByPath(e,n||{}):this.setAttrByPath(e,t,n||{}):this.setAttrs(e,t||{})}get visible(){return this.isVisible()}set visible(e){this.setVisible(e)}setVisible(e,t={}){return this.store.set("visible",e,t),this}isVisible(){return this.store.get("visible")!==!1}show(e={}){return this.isVisible()||this.setVisible(!0,e),this}hide(e={}){return this.isVisible()&&this.setVisible(!1,e),this}toggleVisible(e,t={}){const n=typeof e=="boolean"?e:!this.isVisible(),i=typeof e=="boolean"?t:e;return n?this.show(i):this.hide(i),this}get data(){return this.getData()}set data(e){this.setData(e)}getData(){return this.store.get("data")}setData(e,t={}){if(e==null)this.removeData(t);else{const n=i=>this.store.set("data",i,t);if(t.overwrite===!0)n(e);else{const i=this.getData();t.deep===!1?n(typeof e=="object"?Object.assign(Object.assign({},i),e):e):n(ir({},i,e))}}return this}replaceData(e,t={}){return this.setData(e,Object.assign(Object.assign({},t),{overwrite:!0}))}updateData(e,t={}){return this.setData(e,Object.assign(Object.assign({},t),{deep:!1}))}removeData(e={}){return this.store.remove("data",e),this}get parent(){return this.getParent()}get children(){return this.getChildren()}getParentId(){return this.store.get("parent")}getParent(){const e=this.getParentId();if(e&&this.model){const t=this.model.getCell(e);return this._parent=t,t}return null}getChildren(){const e=this.store.get("children");if(e&&e.length&&this.model){const t=e.map(n=>{var i;return(i=this.model)===null||i===void 0?void 0:i.getCell(n)}).filter(n=>n!=null);return this._children=t,[...t]}return null}hasParent(){return this.parent!=null}isParentOf(e){return e!=null&&e.getParent()===this}isChildOf(e){return e!=null&&this.getParent()===e}eachChild(e,t){return this.children&&this.children.forEach(e,t),this}filterChild(e,t){return this.children?this.children.filter(e,t):[]}getChildCount(){return this.children==null?0:this.children.length}getChildIndex(e){return this.children==null?-1:this.children.indexOf(e)}getChildAt(e){return this.children!=null&&e>=0?this.children[e]:null}getAncestors(e={}){const t=[];let n=this.getParent();for(;n;)t.push(n),n=e.deep!==!1?n.getParent():null;return t}getDescendants(e={}){if(e.deep!==!1){if(e.breadthFirst){const t=[],n=this.getChildren()||[];for(;n.length>0;){const i=n.shift(),o=i.getChildren();t.push(i),o&&n.push(...o)}return t}{const t=this.getChildren()||[];return t.forEach(n=>{t.push(...n.getDescendants(e))}),t}}return this.getChildren()||[]}isDescendantOf(e,t={}){if(e==null)return!1;if(t.deep!==!1){let n=this.getParent();for(;n;){if(n===e)return!0;n=n.getParent()}return!1}return this.isChildOf(e)}isAncestorOf(e,t={}){return e==null?!1:e.isDescendantOf(this,t)}contains(e){return this.isAncestorOf(e)}getCommonAncestor(...e){return Tr.getCommonAncestor(this,...e)}setParent(e,t={}){return this._parent=e,e?this.store.set("parent",e.id,t):this.store.remove("parent",t),this}setChildren(e,t={}){return this._children=e,e!=null?this.store.set("children",e.map(n=>n.id),t):this.store.remove("children",t),this}unembed(e,t={}){const n=this.children;if(n!=null&&e!=null){const i=this.getChildIndex(e);i!==-1&&(n.splice(i,1),e.setParent(null,t),this.setChildren(n,t))}return this}embed(e,t={}){return e.addTo(this,t),this}addTo(e,t={}){return Tr.isCell(e)?e.addChild(this,t):e.addCell(this,t),this}insertTo(e,t,n={}){return e.insertChild(this,t,n),this}addChild(e,t={}){return this.insertChild(e,void 0,t)}insertChild(e,t,n={}){if(e!=null&&e!==this){const i=e.getParent(),o=this!==i;let s=t;if(s==null&&(s=this.getChildCount(),o||(s-=1)),i){const l=i.getChildren();if(l){const c=l.indexOf(e);c>=0&&(e.setParent(null,n),l.splice(c,1),i.setChildren(l,n))}}let a=this.children;if(a==null?(a=[],a.push(e)):a.splice(s,0,e),e.setParent(this,n),this.setChildren(a,n),o&&this.model){const l=this.model.getIncomingEdges(this),c=this.model.getOutgoingEdges(this);l&&l.forEach(u=>u.updateParent(n)),c&&c.forEach(u=>u.updateParent(n))}this.model&&this.model.addCell(e,n)}return this}removeFromParent(e={}){const t=this.getParent();if(t!=null){const n=t.getChildIndex(this);t.removeChildAt(n,e)}return this}removeChild(e,t={}){const n=this.getChildIndex(e);return this.removeChildAt(n,t)}removeChildAt(e,t={}){const n=this.getChildAt(e);return this.children!=null&&n!=null&&(this.unembed(n,t),n.remove(t)),n}remove(e={}){return this.batchUpdate("remove",()=>{const t=this.getParent();t&&t.removeChild(this,e),e.deep!==!1&&this.eachChild(n=>n.remove(e)),this.model&&this.model.removeCell(this,e)}),this}transition(e,t,n={},i="/"){return this.animation.start(e,t,n,i)}stopTransition(e,t,n="/"){return this.animation.stop(e,t,n),this}getTransitions(){return this.animation.get()}translate(e,t,n){return this}scale(e,t,n,i){return this}addTools(e,t,n){const i=Array.isArray(e)?e:[e],o=typeof t=="string"?t:null,s=typeof t=="object"?t:typeof n=="object"?n:{};if(s.reset)return this.setTools({name:o,items:i,local:s.local},s);let a=Ki(this.getTools());if(a==null||o==null||a.name===o)return a==null&&(a={}),a.items||(a.items=[]),a.name=o,a.items=[...a.items,...i],this.setTools(Object.assign({},a),s)}setTools(e,t={}){return e==null?this.removeTools():this.store.set("tools",Tr.normalizeTools(e),t),this}getTools(){return this.store.get("tools")}removeTools(e={}){return this.store.remove("tools",e),this}hasTools(e){const t=this.getTools();return t==null?!1:e==null?!0:t.name===e}hasTool(e){const t=this.getTools();return t==null?!1:t.items.some(n=>typeof n=="string"?n===e:n.name===e)}removeTool(e,t={}){const n=Ki(this.getTools());if(n){let i=!1;const o=n.items.slice(),s=a=>{o.splice(a,1),i=!0};if(typeof e=="number")s(e);else for(let a=o.length-1;a>=0;a-=1){const l=o[a];(typeof l=="string"?l===e:l.name===e)&&s(a)}i&&(n.items=o,this.setTools(n,t))}return this}getBBox(e){return new Ht}getConnectionPoint(e,t){return new pe}toJSON(e={}){const t=Object.assign({},this.store.get()),n=Object.prototype.toString,i=this.isNode()?"node":this.isEdge()?"edge":"cell";if(!t.shape){const p=this.constructor;throw new Error(`Unable to serialize ${i} missing "shape" prop, check the ${i} "${p.name||n.call(p)}"`)}const o=this.constructor,s=e.diff===!0,a=t.attrs||{},l=o.getDefaults(!0),c=s?this.preprocess(l,!0):l,u=c.attrs||{},d={};Object.keys(t).forEach(p=>{const g=t[p];if(g!=null&&!Array.isArray(g)&&typeof g=="object"&&!Rt(g))throw new Error(`Can only serialize ${i} with plain-object props, but got a "${n.call(g)}" type of key "${p}" on ${i} "${this.id}"`);if(p!=="attrs"&&p!=="shape"&&s){const v=c[p];ri(g,v)&&delete t[p]}}),Object.keys(a).forEach(p=>{const g=a[p],v=u[p];Object.keys(g).forEach(y=>{const x=g[y],E=v?v[y]:null;x!=null&&typeof x=="object"&&!Array.isArray(x)?Object.keys(x).forEach(T=>{const P=x[T];if(v==null||E==null||!yo.Z(E)||!ri(E[T],P)){d[p]==null&&(d[p]={}),d[p][y]==null&&(d[p][y]={});const z=d[p][y];z[T]=P}}):(v==null||!ri(E,x))&&(d[p]==null&&(d[p]={}),d[p][y]=x)})});const h=Object.assign(Object.assign({},t),{attrs:Qn(d)?void 0:d});h.attrs==null&&delete h.attrs;const f=h;return f.angle===0&&delete f.angle,Ki(f)}clone(e={}){if(!e.deep){const n=Object.assign({},this.store.get());e.keepId||delete n.id,delete n.parent,delete n.children;const i=this.constructor;return new i(n)}return Tr.deepClone(this)[this.id]}findView(e){return e.renderer.findViewByCell(this)}startBatch(e,t={},n=this.model){return this.notify("batch:start",{name:e,data:t,cell:this}),n&&n.startBatch(e,Object.assign(Object.assign({},t),{cell:this})),this}stopBatch(e,t={},n=this.model){return n&&n.stopBatch(e,Object.assign(Object.assign({},t),{cell:this})),this.notify("batch:stop",{name:e,data:t,cell:this}),this}batchUpdate(e,t,n){const i=this.model;this.startBatch(e,n,i);const o=t();return this.stopBatch(e,n,i),o}dispose(){this.removeFromParent(),this.store.dispose()}}Tr.defaults={},Tr.attrHooks={},Tr.propHooks=[],tU([rs.dispose()],Tr.prototype,"dispose",null),function(r){function e(t){return typeof t=="string"?{items:[t]}:Array.isArray(t)?{items:t}:t.items?t:{items:[t]}}r.normalizeTools=e}(Tr||(Tr={})),function(r){r.toStringTag=`X6.${r.name}`;function e(t){if(t==null)return!1;if(t instanceof r)return!0;const n=t[Symbol.toStringTag],i=t;return(n==null||n===r.toStringTag)&&typeof i.isNode=="function"&&typeof i.isEdge=="function"&&typeof i.prop=="function"&&typeof i.attr=="function"}r.isCell=e}(Tr||(Tr={})),function(r){function e(...o){const s=o.filter(l=>l!=null).map(l=>l.getAncestors()).sort((l,c)=>l.length-c.length);return s.shift().find(l=>s.every(c=>c.includes(l)))||null}r.getCommonAncestor=e;function t(o,s={}){let a=null;for(let l=0,c=o.length;l<c;l+=1){const u=o[l];let d=u.getBBox(s);if(d){if(u.isNode()){const h=u.getAngle();h!=null&&h!==0&&(d=d.bbox(h))}a=a==null?d:a.union(d)}}return a}r.getCellsBBox=t;function n(o){const s=[o,...o.getDescendants({deep:!0})];return r.cloneCells(s)}r.deepClone=n;function i(o){const s=Ju(o),a=s.reduce((l,c)=>(l[c.id]=c.clone(),l),{});return s.forEach(l=>{const c=a[l.id];if(c.isEdge()){const h=c.getSourceCellId(),f=c.getTargetCellId();h&&a[h]&&c.setSource(Object.assign(Object.assign({},c.getSource()),{cell:a[h].id})),f&&a[f]&&c.setTarget(Object.assign(Object.assign({},c.getTarget()),{cell:a[f].id}))}const u=l.getParent();u&&a[u.id]&&c.setParent(a[u.id]);const d=l.getChildren();if(d&&d.length){const h=d.reduce((f,p)=>(a[p.id]&&f.push(a[p.id]),f),[]);h.length>0&&c.setChildren(h)}}),a}r.cloneCells=i}(Tr||(Tr={})),function(r){r.config({propHooks(e){var{tools:t}=e,n=GA(e,["tools"]);return t&&(n.tools=r.normalizeTools(t)),n}})}(Tr||(Tr={}));var If;(function(r){let e,t;function n(s,a){return a?e!=null&&e.exist(s):t!=null&&t.exist(s)}r.exist=n;function i(s){e=s}r.setEdgeRegistry=i;function o(s){t=s}r.setNodeRegistry=o})(If||(If={}));class nU{constructor(e){this.ports=[],this.groups={},this.init(Ki(e))}getPorts(){return this.ports}getGroup(e){return e!=null?this.groups[e]:null}getPortsByGroup(e){return this.ports.filter(t=>t.group===e||t.group==null&&e==null)}getPortsLayoutByGroup(e,t){const n=this.getPortsByGroup(e),i=e?this.getGroup(e):null,o=i?i.position:null,s=o?o.name:null;let a;if(s!=null){const d=Rd.registry.get(s);if(d==null)return Rd.registry.onNotFound(s);a=d}else a=Rd.presets.left;const l=n.map(d=>d&&d.position&&d.position.args||{}),c=o&&o.args||{};return a(l,t,c).map((d,h)=>{const f=n[h];return{portLayout:d,portId:f.id,portSize:f.size,portAttrs:f.attrs,labelSize:f.label.size,labelLayout:this.getPortLabelLayout(f,pe.create(d.position),t)}})}init(e){const{groups:t,items:n}=e;t!=null&&Object.keys(t).forEach(i=>{this.groups[i]=this.parseGroup(t[i])}),Array.isArray(n)&&n.forEach(i=>{this.ports.push(this.parsePort(i))})}parseGroup(e){return Object.assign(Object.assign({},e),{label:this.getLabel(e,!0),position:this.getPortPosition(e.position,!0)})}parsePort(e){const t=Object.assign({},e),n=this.getGroup(e.group)||{};return t.markup=t.markup||n.markup,t.attrs=ir({},n.attrs,t.attrs),t.position=this.createPosition(n,t),t.label=ir({},n.label,this.getLabel(t)),t.zIndex=this.getZIndex(n,t),t.size=Object.assign(Object.assign({},n.size),t.size),t}getZIndex(e,t){return typeof t.zIndex=="number"?t.zIndex:typeof e.zIndex=="number"||e.zIndex==="auto"?e.zIndex:"auto"}createPosition(e,t){return ir({name:"left",args:{}},e.position,{args:t.args})}getPortPosition(e,t=!1){if(e==null){if(t)return{name:"left",args:{}}}else{if(typeof e=="string")return{name:e,args:{}};if(Array.isArray(e))return{name:"absolute",args:{x:e[0],y:e[1]}};if(typeof e=="object")return e}return{args:{}}}getPortLabelPosition(e,t=!1){if(e==null){if(t)return{name:"left",args:{}}}else{if(typeof e=="string")return{name:e,args:{}};if(typeof e=="object")return e}return{args:{}}}getLabel(e,t=!1){const n=e.label||{};return n.position=this.getPortLabelPosition(n.position,t),n}getPortLabelLayout(e,t,n){const i=e.label.position.name||"left",o=e.label.position.args||{},s=_f.registry.get(i)||_f.presets.left;return s?s(t,n,o):null}}var py=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class ii extends Tr{constructor(e={}){super(e);this.initPorts()}get[Symbol.toStringTag](){return ii.toStringTag}preprocess(e,t){const{x:n,y:i,width:o,height:s}=e,a=py(e,["x","y","width","height"]);if(n!=null||i!=null){const l=a.position;a.position=Object.assign(Object.assign({},l),{x:n!=null?n:l?l.x:0,y:i!=null?i:l?l.y:0})}if(o!=null||s!=null){const l=a.size;a.size=Object.assign(Object.assign({},l),{width:o!=null?o:l?l.width:0,height:s!=null?s:l?l.height:0})}return super.preprocess(a,t)}isNode(){return!0}size(e,t,n){return e===void 0?this.getSize():typeof e=="number"?this.setSize(e,t,n):this.setSize(e,t)}getSize(){const e=this.store.get("size");return e?Object.assign({},e):{width:1,height:1}}setSize(e,t,n){return typeof e=="object"?this.resize(e.width,e.height,t):this.resize(e,t,n),this}resize(e,t,n={}){this.startBatch("resize",n);const i=n.direction;if(i){const o=this.getSize();switch(i){case"left":case"right":t=o.height;break;case"top":case"bottom":e=o.width;break;default:break}let a={right:0,"top-right":0,top:1,"top-left":1,left:2,"bottom-left":2,bottom:3,"bottom-right":3}[i];const l=Rr.normalize(this.getAngle()||0);n.absolute&&(a+=Math.floor((l+45)/90),a%=4);const c=this.getBBox();let u;a===0?u=c.getBottomLeft():a===1?u=c.getCorner():a===2?u=c.getTopRight():u=c.getOrigin();const d=u.clone().rotate(-l,c.getCenter()),h=Math.sqrt(e*e+t*t)/2;let f=a*Math.PI/2;f+=Math.atan(a%2==0?t/e:e/t),f-=Rr.toRad(l);const g=pe.fromPolar(h,f,d).clone().translate(e/-2,t/-2);this.store.set("size",{width:e,height:t},n),this.setPosition(g.x,g.y,n)}else this.store.set("size",{width:e,height:t},n);return this.stopBatch("resize",n),this}scale(e,t,n,i={}){const o=this.getBBox().scale(e,t,n==null?void 0:n);return this.startBatch("scale",i),this.setPosition(o.x,o.y,i),this.resize(o.width,o.height,i),this.stopBatch("scale"),this}position(e,t,n){return typeof e=="number"?this.setPosition(e,t,n):this.getPosition(e)}getPosition(e={}){if(e.relative){const n=this.getParent();if(n!=null&&n.isNode()){const i=this.getPosition(),o=n.getPosition();return{x:i.x-o.x,y:i.y-o.y}}}const t=this.store.get("position");return t?Object.assign({},t):{x:0,y:0}}setPosition(e,t,n={}){let i,o,s;if(typeof e=="object"?(i=e.x,o=e.y,s=t||{}):(i=e,o=t,s=n||{}),s.relative){const a=this.getParent();if(a!=null&&a.isNode()){const l=a.getPosition();i+=l.x,o+=l.y}}if(s.deep){const a=this.getPosition();this.translate(i-a.x,o-a.y,s)}else this.store.set("position",{x:i,y:o},s);return this}translate(e=0,t=0,n={}){if(e===0&&t===0)return this;n.translateBy=n.translateBy||this.id;const i=this.getPosition();if(n.restrict!=null&&n.translateBy===this.id){const s=this.getBBox({deep:!0}),a=n.restrict,l=i.x-s.x,c=i.y-s.y,u=Math.max(a.x+l,Math.min(a.x+a.width+l-s.width,i.x+e)),d=Math.max(a.y+c,Math.min(a.y+a.height+c-s.height,i.y+t));e=u-i.x,t=d-i.y}const o={x:i.x+e,y:i.y+t};return n.tx=e,n.ty=t,n.transition?(typeof n.transition!="object"&&(n.transition={}),this.transition("position",o,Object.assign(Object.assign({},n.transition),{interp:Id.object})),this.eachChild(s=>{var a;((a=n.exclude)===null||a===void 0?void 0:a.includes(s))||s.translate(e,t,n)})):(this.startBatch("translate",n),this.store.set("position",o,n),this.eachChild(s=>{var a;((a=n.exclude)===null||a===void 0?void 0:a.includes(s))||s.translate(e,t,n)}),this.stopBatch("translate",n)),this}angle(e,t){return e==null?this.getAngle():this.rotate(e,t)}getAngle(){return this.store.get("angle",0)}rotate(e,t={}){const n=this.getAngle();if(t.center){const i=this.getSize(),o=this.getPosition(),s=this.getBBox().getCenter();s.rotate(n-e,t.center);const a=s.x-i.width/2-o.x,l=s.y-i.height/2-o.y;this.startBatch("rotate",{angle:e,options:t}),this.setPosition(o.x+a,o.y+l,t),this.rotate(e,Object.assign(Object.assign({},t),{center:null})),this.stopBatch("rotate")}else this.store.set("angle",t.absolute?e:(n+e)%360,t);return this}getBBox(e={}){if(e.deep){const t=this.getDescendants({deep:!0,breadthFirst:!0});return t.push(this),Tr.getCellsBBox(t)}return Ht.fromPositionAndSize(this.getPosition(),this.getSize())}getConnectionPoint(e,t){const n=this.getBBox(),i=n.getCenter(),o=e.getTerminal(t);if(o==null)return i;const s=o.port;if(!s||!this.hasPort(s))return i;const a=this.getPort(s);if(!a||!a.group)return i;const c=this.getPortsPosition(a.group)[s].position,u=pe.create(c).translate(n.getOrigin()),d=this.getAngle();return d&&u.rotate(-d,i),u}fit(e={}){const n=(this.getChildren()||[]).filter(c=>c.isNode());if(n.length===0)return this;this.startBatch("fit-embeds",e),e.deep&&n.forEach(c=>c.fit(e));let{x:i,y:o,width:s,height:a}=Tr.getCellsBBox(n);const l=Us(e.padding);return i-=l.left,o-=l.top,s+=l.left+l.right,a+=l.bottom+l.top,this.store.set({position:{x:i,y:o},size:{width:s,height:a}},e),this.stopBatch("fit-embeds"),this}get portContainerMarkup(){return this.getPortContainerMarkup()}set portContainerMarkup(e){this.setPortContainerMarkup(e)}getDefaultPortContainerMarkup(){return this.store.get("defaultPortContainerMarkup")||Ur.getPortContainerMarkup()}getPortContainerMarkup(){return this.store.get("portContainerMarkup")||this.getDefaultPortContainerMarkup()}setPortContainerMarkup(e,t={}){return this.store.set("portContainerMarkup",Ur.clone(e),t),this}get portMarkup(){return this.getPortMarkup()}set portMarkup(e){this.setPortMarkup(e)}getDefaultPortMarkup(){return this.store.get("defaultPortMarkup")||Ur.getPortMarkup()}getPortMarkup(){return this.store.get("portMarkup")||this.getDefaultPortMarkup()}setPortMarkup(e,t={}){return this.store.set("portMarkup",Ur.clone(e),t),this}get portLabelMarkup(){return this.getPortLabelMarkup()}set portLabelMarkup(e){this.setPortLabelMarkup(e)}getDefaultPortLabelMarkup(){return this.store.get("defaultPortLabelMarkup")||Ur.getPortLabelMarkup()}getPortLabelMarkup(){return this.store.get("portLabelMarkup")||this.getDefaultPortLabelMarkup()}setPortLabelMarkup(e,t={}){return this.store.set("portLabelMarkup",Ur.clone(e),t),this}get ports(){const e=this.store.get("ports",{items:[]});return e.items==null&&(e.items=[]),e}getPorts(){return Ki(this.ports.items)}getPortsByGroup(e){return this.getPorts().filter(t=>t.group===e)}getPort(e){return Ki(this.ports.items.find(t=>t.id&&t.id===e))}getPortAt(e){return this.ports.items[e]||null}hasPorts(){return this.ports.items.length>0}hasPort(e){return this.getPortIndex(e)!==-1}getPortIndex(e){const t=typeof e=="string"?e:e.id;return t!=null?this.ports.items.findIndex(n=>n.id===t):-1}getPortsPosition(e){const t=this.getSize();return this.port.getPortsLayoutByGroup(e,new Ht(0,0,t.width,t.height)).reduce((i,o)=>{const s=o.portLayout;return i[o.portId]={position:Object.assign({},s.position),angle:s.angle||0},i},{})}getPortProp(e,t){return this.getPropByPath(this.prefixPortPath(e,t))}setPortProp(e,t,n,i){if(typeof t=="string"||Array.isArray(t)){const a=this.prefixPortPath(e,t),l=n;return this.setPropByPath(a,l,i)}const o=this.prefixPortPath(e),s=t;return this.setPropByPath(o,s,n)}removePortProp(e,t,n){return typeof t=="string"||Array.isArray(t)?this.removePropByPath(this.prefixPortPath(e,t),n):this.removePropByPath(this.prefixPortPath(e),t)}portProp(e,t,n,i){return t==null?this.getPortProp(e):typeof t=="string"||Array.isArray(t)?arguments.length===2?this.getPortProp(e,t):n==null?this.removePortProp(e,t,i):this.setPortProp(e,t,n,i):this.setPortProp(e,t,n)}prefixPortPath(e,t){const n=this.getPortIndex(e);if(n===-1)throw new Error(`Unable to find port with id: "${e}"`);return t==null||t===""?["ports","items",`${n}`]:Array.isArray(t)?["ports","items",`${n}`,...t]:`ports/items/${n}/${t}`}addPort(e,t){const n=[...this.ports.items];return n.push(e),this.setPropByPath("ports/items",n,t),this}addPorts(e,t){return this.setPropByPath("ports/items",[...this.ports.items,...e],t),this}insertPort(e,t,n){const i=[...this.ports.items];return i.splice(e,0,t),this.setPropByPath("ports/items",i,n),this}removePort(e,t={}){return this.removePortAt(this.getPortIndex(e),t)}removePortAt(e,t={}){if(e>=0){const n=[...this.ports.items];n.splice(e,1),t.rewrite=!0,this.setPropByPath("ports/items",n,t)}return this}removePorts(e,t){let n;if(Array.isArray(e)){if(n=t||{},e.length){n.rewrite=!0;const o=[...this.ports.items].filter(s=>!e.some(a=>{const l=typeof a=="string"?a:a.id;return s.id===l}));this.setPropByPath("ports/items",o,n)}}else n=e||{},n.rewrite=!0,this.setPropByPath("ports/items",[],n);return this}getParsedPorts(){return this.port.getPorts()}getParsedGroups(){return this.port.groups}getPortsLayoutByGroup(e,t){return this.port.getPortsLayoutByGroup(e,t)}initPorts(){this.updatePortData(),this.on("change:ports",()=>{this.processRemovedPort(),this.updatePortData()})}processRemovedPort(){const e=this.ports,t={};e.items.forEach(s=>{s.id&&(t[s.id]=!0)});const n={};(this.store.getPrevious("ports")||{items:[]}).items.forEach(s=>{s.id&&!t[s.id]&&(n[s.id]=!0)});const o=this.model;o&&!Qn(n)&&(o.getConnectedEdges(this,{incoming:!0}).forEach(l=>{const c=l.getTargetPortId();c&&n[c]&&l.remove()}),o.getConnectedEdges(this,{outgoing:!0}).forEach(l=>{const c=l.getSourcePortId();c&&n[c]&&l.remove()}))}validatePorts(){const e={},t=[];return this.ports.items.forEach(n=>{typeof n!="object"&&t.push(`Invalid port ${n}.`),n.id==null&&(n.id=this.generatePortId()),e[n.id]&&t.push("Duplicitied port id."),e[n.id]=!0}),t}generatePortId(){return EC()}updatePortData(){const e=this.validatePorts();if(e.length>0)throw this.store.set("ports",this.store.getPrevious("ports")),new Error(e.join(" "));const t=this.port?this.port.getPorts():null;this.port=new nU(this.ports);const n=this.port.getPorts(),i=t?n.filter(s=>t.find(a=>a.id===s.id)?null:s):[...n],o=t?t.filter(s=>n.find(a=>a.id===s.id)?null:s):[];i.length>0&&this.notify("ports:added",{added:i,cell:this,node:this}),o.length>0&&this.notify("ports:removed",{removed:o,cell:this,node:this})}}ii.defaults={angle:0,position:{x:0,y:0},size:{width:1,height:1}},function(r){r.toStringTag=`X6.${r.name}`;function e(t){if(t==null)return!1;if(t instanceof r)return!0;const n=t[Symbol.toStringTag],i=t;return(n==null||n===r.toStringTag)&&typeof i.isNode=="function"&&typeof i.isEdge=="function"&&typeof i.prop=="function"&&typeof i.attr=="function"&&typeof i.size=="function"&&typeof i.position=="function"}r.isNode=e}(ii||(ii={})),function(r){r.config({propHooks(e){var{ports:t}=e,n=py(e,["ports"]);return t&&(n.ports=Array.isArray(t)?{items:t}:t),n}})}(ii||(ii={})),function(r){r.registry=Qi.create({type:"node",process(e,t){if(If.exist(e,!0))throw new Error(`Node with name '${e}' was registered by anthor Edge`);if(typeof t=="function")return t.config({shape:e}),t;let n=r;const{inherit:i}=t,o=py(t,["inherit"]);if(i)if(typeof i=="string"){const a=this.get(i);a==null?this.onNotFound(i,"inherited"):n=a}else n=i;o.constructorName==null&&(o.constructorName=e);const s=n.define.call(n,o);return s.config({shape:e}),s}}),If.setNodeRegistry(r.registry)}(ii||(ii={})),function(r){let e=0;function t(o){return o?CC(o):(e+=1,`CustomNode${e}`)}function n(o){const{constructorName:s,overwrite:a}=o,l=py(o,["constructorName","overwrite"]),c=dC(t(s||l.shape),this);return c.config(l),l.shape&&r.registry.register(l.shape,c,a),c}r.define=n;function i(o){const s=o.shape||"rect",a=r.registry.get(s);return a?new a(o):r.registry.onNotFound(s)}r.create=i}(ii||(ii={}));var rU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Xo extends ii{get label(){return this.getLabel()}set label(e){this.setLabel(e)}getLabel(){return this.getAttrByPath("text/text")}setLabel(e,t){return e==null?this.removeLabel():this.setAttrByPath("text/text",e,t),this}removeLabel(){return this.removeAttrByPath("text/text"),this}}(function(r){r.bodyAttr={fill:"#ffffff",stroke:"#333333",strokeWidth:2},r.labelAttr={fontSize:14,fill:"#000000",refX:.5,refY:.5,textAnchor:"middle",textVerticalAnchor:"middle",fontFamily:"Arial, helvetica, sans-serif"},r.config({attrs:{text:Object.assign({},r.labelAttr)},propHooks(e){const{label:t}=e,n=rU(e,["label"]);return t&&df(n,"attrs/text/text",t),n},visible:!0})})(Xo||(Xo={}));var iU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function oU(r,e=!1){return`<g class="rotatable"><g class="scalable"><${r}/></g>${e?"":"<text/>"}</g>`}function l1(r){return`basic.${r}`}function Kg(r="xlink:href"){return t=>{const{imageUrl:n,imageWidth:i,imageHeight:o}=t,s=iU(t,["imageUrl","imageWidth","imageHeight"]);if(n!=null||i!=null||o!=null){const a=()=>{if(s.attrs){const l=s.attrs.image;n!=null&&(l[r]=n),i!=null&&(l.width=i),o!=null&&(l.height=o),s.attrs.image=l}};s.attrs?(s.attrs.image==null&&(s.attrs.image={}),a()):(s.attrs={image:{}},a())}return s}}function El(r,e,t={}){const n=l1(r),i={constructorName:n,attrs:{".":{fill:"#ffffff",stroke:"none"},[r]:{fill:"#ffffff",stroke:"#000000"}}};return t.ignoreMarkup||(i.markup=oU(r,t.noText===!0)),(t.parent||Xo).define(ir(i,e,{shape:n}))}const Ree=El("rect",{attrs:{rect:{width:100,height:60}}}),kee=El("circle",{width:60,height:60,attrs:{circle:{r:30,cx:30,cy:30}}}),Iee=El("ellipse",{width:60,height:40,attrs:{ellipse:{rx:30,ry:20,cx:30,cy:20}}}),Lee=El("polygon",{width:60,height:40,attrs:{text:{refY:null,refDy:16}}}),Gee=El("polyline",{width:60,height:40,attrs:{text:{refY:null,refDy:16}}}),Fee=El("image",{attrs:{text:{refY:null,refDy:16}},propHooks:Kg()});var sU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const FA=El("path",{width:60,height:60,attrs:{text:{ref:"path",refY:null,refDy:16}},propHooks(r){const{d:e}=r,t=sU(r,["d"]);return e!=null&&df(t,"attrs/path/d",e),t}}),Bee=El("rhombus",{d:"M 30 0 L 60 30 30 60 0 30 z",attrs:{text:{refY:.5,refDy:null}}},{parent:FA,ignoreMarkup:!0}),zee=El("cylinder",{width:40,height:40,attrs:{path:{fill:"#FFFFFF",stroke:"#cbd2d7",strokeWidth:3,d:["M 0 10 C 10 5, 30 5, 40 10 C 30 15, 10 15, 0 10","L 0 20","C 10 25, 30 25, 40 20","L 40 10"].join(" ")},text:{refY:.7,refDy:null,fill:"#435460"}}},{parent:FA,ignoreMarkup:!0});var gy=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Ai extends Tr{constructor(e={}){super(e)}get[Symbol.toStringTag](){return Ai.toStringTag}preprocess(e,t){const{source:n,sourceCell:i,sourcePort:o,sourcePoint:s,target:a,targetCell:l,targetPort:c,targetPoint:u}=e,h=gy(e,["source","sourceCell","sourcePort","sourcePoint","target","targetCell","targetPort","targetPoint"]),f=p=>typeof p=="string"||typeof p=="number";if(n!=null)if(Tr.isCell(n))h.source={cell:n.id};else if(f(n))h.source={cell:n};else if(pe.isPoint(n))h.source=n.toJSON();else if(Array.isArray(n))h.source={x:n[0],y:n[1]};else{const p=n.cell;Tr.isCell(p)?h.source=Object.assign(Object.assign({},n),{cell:p.id}):h.source=n}if(i!=null||o!=null){let p=h.source;if(i!=null){const g=f(i)?i:i.id;p?p.cell=g:p=h.source={cell:g}}o!=null&&p&&(p.port=o)}else s!=null&&(h.source=pe.create(s).toJSON());if(a!=null)if(Tr.isCell(a))h.target={cell:a.id};else if(f(a))h.target={cell:a};else if(pe.isPoint(a))h.target=a.toJSON();else if(Array.isArray(a))h.target={x:a[0],y:a[1]};else{const p=a.cell;Tr.isCell(p)?h.target=Object.assign(Object.assign({},a),{cell:p.id}):h.target=a}if(l!=null||c!=null){let p=h.target;if(l!=null){const g=f(l)?l:l.id;p?p.cell=g:p=h.target={cell:g}}c!=null&&p&&(p.port=c)}else u!=null&&(h.target=pe.create(u).toJSON());return super.preprocess(h,t)}setup(){super.setup(),this.on("change:labels",e=>this.onLabelsChanged(e)),this.on("change:vertices",e=>this.onVertexsChanged(e))}isEdge(){return!0}disconnect(e={}){return this.store.set({source:{x:0,y:0},target:{x:0,y:0}},e),this}get source(){return this.getSource()}set source(e){this.setSource(e)}getSource(){return this.getTerminal("source")}getSourceCellId(){return this.source.cell}getSourcePortId(){return this.source.port}setSource(e,t,n={}){return this.setTerminal("source",e,t,n)}get target(){return this.getTarget()}set target(e){this.setTarget(e)}getTarget(){return this.getTerminal("target")}getTargetCellId(){return this.target.cell}getTargetPortId(){return this.target.port}setTarget(e,t,n={}){return this.setTerminal("target",e,t,n)}getTerminal(e){return Object.assign({},this.store.get(e))}setTerminal(e,t,n,i={}){if(Tr.isCell(t))return this.store.set(e,ir({},n,{cell:t.id}),i),this;const o=t;return pe.isPoint(t)||o.x!=null&&o.y!=null?(this.store.set(e,ir({},n,{x:o.x,y:o.y}),i),this):(this.store.set(e,Ki(t),i),this)}getSourcePoint(){return this.getTerminalPoint("source")}getTargetPoint(){return this.getTerminalPoint("target")}getTerminalPoint(e){const t=this[e];if(pe.isPointLike(t))return pe.create(t);const n=this.getTerminalCell(e);return n?n.getConnectionPoint(this,e):new pe}getSourceCell(){return this.getTerminalCell("source")}getTargetCell(){return this.getTerminalCell("target")}getTerminalCell(e){if(this.model){const t=e==="source"?this.getSourceCellId():this.getTargetCellId();if(t)return this.model.getCell(t)}return null}getSourceNode(){return this.getTerminalNode("source")}getTargetNode(){return this.getTerminalNode("target")}getTerminalNode(e){let t=this;const n={};for(;t&&t.isEdge();){if(n[t.id])return null;n[t.id]=!0,t=t.getTerminalCell(e)}return t&&t.isNode()?t:null}get router(){return this.getRouter()}set router(e){e==null?this.removeRouter():this.setRouter(e)}getRouter(){return this.store.get("router")}setRouter(e,t,n){return typeof e=="object"?this.store.set("router",e,t):this.store.set("router",{name:e,args:t},n),this}removeRouter(e={}){return this.store.remove("router",e),this}get connector(){return this.getConnector()}set connector(e){e==null?this.removeConnector():this.setConnector(e)}getConnector(){return this.store.get("connector")}setConnector(e,t,n){return typeof e=="object"?this.store.set("connector",e,t):this.store.set("connector",{name:e,args:t},n),this}removeConnector(e={}){return this.store.remove("connector",e)}get strategy(){return this.getStrategy()}set strategy(e){e==null?this.removeStrategy():this.setStrategy(e)}getStrategy(){return this.store.get("strategy")}setStrategy(e,t,n){return typeof e=="object"?this.store.set("strategy",e,t):this.store.set("strategy",{name:e,args:t},n),this}removeStrategy(e={}){return this.store.remove("strategy",e)}getDefaultLabel(){const e=this.constructor,t=this.store.get("defaultLabel")||e.defaultLabel||{};return Ki(t)}get labels(){return this.getLabels()}set labels(e){this.setLabels(e)}getLabels(){return[...this.store.get("labels",[])].map(e=>this.parseLabel(e))}setLabels(e,t={}){return this.store.set("labels",Array.isArray(e)?e:[e],t),this}insertLabel(e,t,n={}){const i=this.getLabels(),o=i.length;let s=t!=null&&Number.isFinite(t)?t:o;return s<0&&(s=o+s+1),i.splice(s,0,this.parseLabel(e)),this.setLabels(i,n)}appendLabel(e,t={}){return this.insertLabel(e,-1,t)}getLabelAt(e){const t=this.getLabels();return e!=null&&Number.isFinite(e)?this.parseLabel(t[e]):null}setLabelAt(e,t,n={}){if(e!=null&&Number.isFinite(e)){const i=this.getLabels();i[e]=this.parseLabel(t),this.setLabels(i,n)}return this}removeLabelAt(e,t={}){const n=this.getLabels(),i=e!=null&&Number.isFinite(e)?e:-1,o=n.splice(i,1);return this.setLabels(n,t),o.length?o[0]:null}parseLabel(e){return typeof e=="string"?this.constructor.parseStringLabel(e):e}onLabelsChanged({previous:e,current:t}){const n=e&&t?t.filter(o=>e.find(s=>o===s||ri(o,s))?null:o):t?[...t]:[],i=e&&t?e.filter(o=>t.find(s=>o===s||ri(o,s))?null:o):e?[...e]:[];n.length>0&&this.notify("labels:added",{added:n,cell:this,edge:this}),i.length>0&&this.notify("labels:removed",{removed:i,cell:this,edge:this})}get vertexMarkup(){return this.getVertexMarkup()}set vertexMarkup(e){this.setVertexMarkup(e)}getDefaultVertexMarkup(){return this.store.get("defaultVertexMarkup")||Ur.getEdgeVertexMarkup()}getVertexMarkup(){return this.store.get("vertexMarkup")||this.getDefaultVertexMarkup()}setVertexMarkup(e,t={}){return this.store.set("vertexMarkup",Ur.clone(e),t),this}get vertices(){return this.getVertices()}set vertices(e){this.setVertices(e)}getVertices(){return[...this.store.get("vertices",[])]}setVertices(e,t={}){const n=Array.isArray(e)?e:[e];return this.store.set("vertices",n.map(i=>pe.toJSON(i)),t),this}insertVertex(e,t,n={}){const i=this.getVertices(),o=i.length;let s=t!=null&&Number.isFinite(t)?t:o;return s<0&&(s=o+s+1),i.splice(s,0,pe.toJSON(e)),this.setVertices(i,n)}appendVertex(e,t={}){return this.insertVertex(e,-1,t)}getVertexAt(e){return e!=null&&Number.isFinite(e)?this.getVertices()[e]:null}setVertexAt(e,t,n={}){if(e!=null&&Number.isFinite(e)){const i=this.getVertices();i[e]=t,this.setVertices(i,n)}return this}removeVertexAt(e,t={}){const n=this.getVertices(),i=e!=null&&Number.isFinite(e)?e:-1;return n.splice(i,1),this.setVertices(n,t)}onVertexsChanged({previous:e,current:t}){const n=e&&t?t.filter(o=>e.find(s=>pe.equals(o,s))?null:o):t?[...t]:[],i=e&&t?e.filter(o=>t.find(s=>pe.equals(o,s))?null:o):e?[...e]:[];n.length>0&&this.notify("vertexs:added",{added:n,cell:this,edge:this}),i.length>0&&this.notify("vertexs:removed",{removed:i,cell:this,edge:this})}getDefaultMarkup(){return this.store.get("defaultMarkup")||Ur.getEdgeMarkup()}getMarkup(){return super.getMarkup()||this.getDefaultMarkup()}get toolMarkup(){return this.getToolMarkup()}set toolMarkup(e){this.setToolMarkup(e)}getDefaultToolMarkup(){return this.store.get("defaultToolMarkup")||Ur.getEdgeToolMarkup()}getToolMarkup(){return this.store.get("toolMarkup")||this.getDefaultToolMarkup()}setToolMarkup(e,t={}){return this.store.set("toolMarkup",e,t),this}get doubleToolMarkup(){return this.getDoubleToolMarkup()}set doubleToolMarkup(e){this.setDoubleToolMarkup(e)}getDefaultDoubleToolMarkup(){return this.store.get("defaultDoubleToolMarkup")}getDoubleToolMarkup(){return this.store.get("doubleToolMarkup")||this.getDefaultDoubleToolMarkup()}setDoubleToolMarkup(e,t={}){return this.store.set("doubleToolMarkup",e,t),this}get arrowheadMarkup(){return this.getArrowheadMarkup()}set arrowheadMarkup(e){this.setArrowheadMarkup(e)}getDefaultArrowheadMarkup(){return this.store.get("defaultArrowheadMarkup")||Ur.getEdgeArrowheadMarkup()}getArrowheadMarkup(){return this.store.get("arrowheadMarkup")||this.getDefaultArrowheadMarkup()}setArrowheadMarkup(e,t={}){return this.store.set("arrowheadMarkup",e,t),this}translate(e,t,n={}){return n.translateBy=n.translateBy||this.id,n.tx=e,n.ty=t,this.applyToPoints(i=>({x:(i.x||0)+e,y:(i.y||0)+t}),n)}scale(e,t,n,i={}){return this.applyToPoints(o=>pe.create(o).scale(e,t,n).toJSON(),i)}applyToPoints(e,t={}){const n={},i=this.getSource(),o=this.getTarget();pe.isPointLike(i)&&(n.source=e(i)),pe.isPointLike(o)&&(n.target=e(o));const s=this.getVertices();return s.length>0&&(n.vertices=s.map(e)),this.store.set(n,t),this}getBBox(){return this.getPolyline().bbox()}getConnectionPoint(){return this.getPolyline().pointAt(.5)}getPolyline(){const e=[this.getSourcePoint(),...this.getVertices().map(t=>pe.create(t)),this.getTargetPoint()];return new so(e)}updateParent(e){let t=null;const n=this.getSourceCell(),i=this.getTargetCell(),o=this.getParent();return n&&i&&(n===i||n.isDescendantOf(i)?t=i:i.isDescendantOf(n)?t=n:t=Tr.getCommonAncestor(n,i)),o&&(!t||t.id!==o.id)&&o.unembed(this,e),t&&t.embed(this,e),t}hasLoop(e={}){const t=this.getSource(),n=this.getTarget(),i=t.cell,o=n.cell;if(!i||!o)return!1;let s=i===o;if(!s&&e.deep&&this._model){const a=this.getSourceCell(),l=this.getTargetCell();a&&l&&(s=a.isAncestorOf(l,e)||l.isAncestorOf(a,e))}return s}getFragmentAncestor(){const e=[this,this.getSourceNode(),this.getTargetNode()].filter(t=>t!=null);return this.getCommonAncestor(...e)}isFragmentDescendantOf(e){const t=this.getFragmentAncestor();return!!t&&(t.id===e.id||t.isDescendantOf(e))}}Ai.defaults={},function(r){function e(t,n){const i=t,o=n;return i.cell===o.cell?i.port===o.port||i.port==null&&o.port==null:!1}r.equalTerminals=e}(Ai||(Ai={})),function(r){r.defaultLabel={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{text:{fill:"#000",fontSize:14,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},rect:{ref:"label",fill:"#fff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}};function e(t){return{attrs:{label:{text:t}}}}r.parseStringLabel=e}(Ai||(Ai={})),function(r){r.toStringTag=`X6.${r.name}`;function e(t){if(t==null)return!1;if(t instanceof r)return!0;const n=t[Symbol.toStringTag],i=t;return(n==null||n===r.toStringTag)&&typeof i.isNode=="function"&&typeof i.isEdge=="function"&&typeof i.prop=="function"&&typeof i.attr=="function"&&typeof i.disconnect=="function"&&typeof i.getSource=="function"&&typeof i.getTarget=="function"}r.isEdge=e}(Ai||(Ai={})),function(r){r.registry=Qi.create({type:"edge",process(e,t){if(If.exist(e,!1))throw new Error(`Edge with name '${e}' was registered by anthor Node`);if(typeof t=="function")return t.config({shape:e}),t;let n=r;const{inherit:i="edge"}=t,o=gy(t,["inherit"]);if(typeof i=="string"){const a=this.get(i||"edge");a==null&&i?this.onNotFound(i,"inherited"):n=a}else n=i;o.constructorName==null&&(o.constructorName=e);const s=n.define.call(n,o);return s.config({shape:e}),s}}),If.setEdgeRegistry(r.registry)}(Ai||(Ai={})),function(r){let e=0;function t(o){return o?CC(o):(e+=1,`CustomEdge${e}`)}function n(o){const{constructorName:s,overwrite:a}=o,l=gy(o,["constructorName","overwrite"]),c=dC(t(s||l.shape),this);return c.config(l),l.shape&&r.registry.register(l.shape,c,a),c}r.define=n;function i(o){const s=o.shape||"edge",a=r.registry.get(s);return a?new a(o):r.registry.onNotFound(s)}r.create=i}(Ai||(Ai={})),function(r){const e="basic.edge";r.config({shape:e,propHooks(t){const{label:n,vertices:i}=t,o=gy(t,["label","vertices"]);if(n){o.labels==null&&(o.labels=[]);const s=typeof n=="string"?r.parseStringLabel(n):n;o.labels.push(s)}return i&&Array.isArray(i)&&(o.vertices=i.map(s=>pe.create(s).toJSON())),o}}),r.registry.register(e,r)}(Ai||(Ai={}));var aU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class hc extends Ii{constructor(){super(...arguments);this.POINT_ROUNDING=2,this.markerCache={}}get[Symbol.toStringTag](){return hc.toStringTag}getContainerClassName(){return[super.getContainerClassName(),this.prefixClassName("edge")].join(" ")}get sourceBBox(){const e=this.sourceView;if(!e){const n=this.cell.getSource();return new Ht(n.x,n.y)}const t=this.sourceMagnet;return e.isEdgeElement(t)?new Ht(this.sourceAnchor.x,this.sourceAnchor.y):e.getBBoxOfElement(t||e.container)}get targetBBox(){const e=this.targetView;if(!e){const n=this.cell.getTarget();return new Ht(n.x,n.y)}const t=this.targetMagnet;return e.isEdgeElement(t)?new Ht(this.targetAnchor.x,this.targetAnchor.y):e.getBBoxOfElement(t||e.container)}isEdgeView(){return!0}confirmUpdate(e,t={}){let n=e;if(this.hasAction(n,"source")){if(!this.updateTerminalProperties("source"))return n;n=this.removeAction(n,"source")}if(this.hasAction(n,"target")){if(!this.updateTerminalProperties("target"))return n;n=this.removeAction(n,"target")}const i=this.graph,o=this.sourceView,s=this.targetView;return i&&(o&&!i.renderer.isViewMounted(o)||s&&!i.renderer.isViewMounted(s))?n:this.hasAction(n,"render")?(this.render(),n=this.removeAction(n,["render","update","vertices","labels","tools","widget"]),n):(n=this.handleAction(n,"vertices",()=>this.renderVertexMarkers()),n=this.handleAction(n,"update",()=>this.update(null,t)),n=this.handleAction(n,"labels",()=>this.onLabelsChange(t)),n=this.handleAction(n,"tools",()=>{this.renderTools(),this.updateToolsPosition()}),n=this.handleAction(n,"widget",()=>this.renderExternalTools()),n)}onLabelsChange(e={}){this.shouldRerenderLabels(e)?this.renderLabels():this.updateLabels(),this.updateLabelPositions()}shouldRerenderLabels(e={}){const t=this.cell.previous("labels");if(t==null)return!0;if("propertyPathArray"in e&&"propertyValue"in e){const n=e.propertyPathArray||[],i=n.length;if(i>1){const o=n[1];if(t[o]){if(i===2)return typeof e.propertyValue=="object"&&Jc(e.propertyValue,"markup");if(n[2]!=="markup")return!1}}}return!0}render(){return this.empty(),this.containers={},this.renderMarkup(),this.renderLabels(),this.update(),this.renderExternalTools(),this}renderMarkup(){const e=this.cell.markup;if(e)return typeof e=="string"?this.renderStringMarkup(e):this.renderJSONMarkup(e);throw new TypeError("Invalid edge markup.")}renderJSONMarkup(e){const t=this.parseJSONMarkup(e,this.container);this.selectors=t.selectors,this.container.append(t.fragment)}renderStringMarkup(e){const t=this.containers,n=pn.createVectors(e);n.forEach(i=>{const o=i.attr("class");o&&(t[Uv(o)]=i.node)}),this.renderTools(),this.renderVertexMarkers(),this.renderArrowheadMarkers(),Rg(this.container,n.map(i=>i.node))}renderLabels(){const e=this.cell,t=e.getLabels(),n=t.length;let i=this.containers.labels;if(this.labelCache={},this.labelSelectors={},n<=0)return i&&i.parentNode&&i.parentNode.removeChild(i),this;i?this.empty(i):(i=Es("g"),this.addClass(this.prefixClassName("edge-labels"),i),this.containers.labels=i);for(let o=0,s=t.length;o<s;o+=1){const a=t[o],l=this.normalizeLabelMarkup(this.parseLabelMarkup(a.markup));let c,u;if(l)c=l.node,u=l.selectors;else{const h=e.getDefaultLabel(),f=this.normalizeLabelMarkup(this.parseLabelMarkup(h.markup));c=f.node,u=f.selectors}c.setAttribute("data-index",`${o}`),i.appendChild(c);const d=this.rootSelector;if(u[d])throw new Error("Ambiguous label root selector.");u[d]=c,this.labelCache[o]=c,this.labelSelectors[o]=u}return i.parentNode==null&&this.container.appendChild(i),this.updateLabels(),this.customizeLabels(),this}parseLabelMarkup(e){return e?typeof e=="string"?this.parseLabelStringMarkup(e):this.parseJSONMarkup(e):null}parseLabelStringMarkup(e){const t=pn.createVectors(e),n=document.createDocumentFragment();for(let i=0,o=t.length;i<o;i+=1){const s=t[i].node;n.appendChild(s)}return{fragment:n,selectors:{}}}normalizeLabelMarkup(e){if(e==null)return;const t=e.fragment;if(!(t instanceof DocumentFragment)||!t.hasChildNodes())throw new Error("Invalid label markup.");let n;const i=t.childNodes;return i.length>1||i[0].nodeName.toUpperCase()!=="G"?n=pn.create("g").append(t):n=pn.create(i[0]),n.addClass(this.prefixClassName("edge-label")),{node:n.node,selectors:e.selectors}}updateLabels(){if(this.containers.labels){const e=this.cell,t=e.labels,n=this.can("edgeLabelMovable"),i=e.getDefaultLabel();for(let o=0,s=t.length;o<s;o+=1){const a=this.labelCache[o],l=this.labelSelectors[o];a.setAttribute("cursor",n?"move":"default");const c=t[o],u=ir({},i.attrs,c.attrs);this.updateAttrs(a,u,{selectors:l,rootBBox:c.size?Ht.fromSize(c.size):void 0})}}}mergeLabelAttrs(e,t,n){if(t===null)return null;if(t===void 0)return n===null?null:n===void 0?void 0:e?n:ir({},n);if(e)return ir({},n,t)}customizeLabels(){if(this.containers.labels){const e=this.cell,t=e.labels;for(let n=0,i=t.length;n<i;n+=1){const o=t[n],s=this.labelCache[n],a=this.labelSelectors[n];this.graph.hook.onEdgeLabelRendered({edge:e,label:o,container:s,selectors:a})}}}renderTools(){const e=this.containers.tools;if(e==null)return this;const t=this.cell.toolMarkup,n=this.$(e).empty();if(Ur.isStringMarkup(t)){let i=pf(t);const o=pn.create(i());if(n.append(o.node),this.toolCache=o.node,this.options.doubleTools){let s;const a=this.cell.doubleToolMarkup;Ur.isStringMarkup(a)?(i=pf(a),s=pn.create(i())):s=o.clone(),n.append(s.node),this.tool2Cache=s.node}}return this}renderExternalTools(){const e=this.cell.getTools();return this.addTools(e),this}renderVertexMarkers(){const e=this.containers.vertices;if(e==null)return this;const t=this.cell.vertexMarkup,n=this.$(e).empty();if(Ur.isStringMarkup(t)){const i=pf(t);this.cell.getVertices().forEach((o,s)=>{n.append(pn.create(i(Object.assign({index:s},o))).node)})}return this}renderArrowheadMarkers(){const e=this.containers.arrowheads;if(e==null)return this;const t=this.cell.arrowheadMarkup,n=this.$(e).empty();if(Ur.isStringMarkup(t)){const i=pf(t),o=pn.create(i({end:"source"})).node,s=pn.create(i({end:"target"})).node;this.containers.sourceArrowhead=o,this.containers.targetArrowhead=s,n.append(o,s)}return this}update(e,t={}){this.cleanCache(),this.updateConnection(t);const n=this.cell.getAttrs();return n!=null&&this.updateAttrs(this.container,n,{attrs:e===n?null:e,selectors:this.selectors}),this.updateConnectionPath(),this.updateLabelPositions(),this.updateToolsPosition(),this.updateArrowheadMarkers(),this.updateTools(t),this}removeRedundantLinearVertices(e={}){const t=this.cell,n=t.getVertices(),i=[this.sourceAnchor,...n,this.targetAnchor],o=i.length,s=new so(i);s.simplify({threshold:.01});const a=s.points.map(c=>c.toJSON()),l=a.length;return o===l?0:(t.setVertices(a.slice(1,l-1),e),o-l)}updateConnectionPath(){const e=this.containers;if(e.connection){const t=this.getConnectionPathData();e.connection.setAttribute("d",t)}if(e.connectionWrap){const t=this.getConnectionPathData();e.connectionWrap.setAttribute("d",t)}e.sourceMarker&&e.targetMarker&&this.translateAndAutoOrientArrows(e.sourceMarker,e.targetMarker)}getTerminalView(e){switch(e){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error(`Unknown terminal type '${e}'`)}}getTerminalAnchor(e){switch(e){case"source":return pe.create(this.sourceAnchor);case"target":return pe.create(this.targetAnchor);default:throw new Error(`Unknown terminal type '${e}'`)}}getTerminalConnectionPoint(e){switch(e){case"source":return pe.create(this.sourcePoint);case"target":return pe.create(this.targetPoint);default:throw new Error(`Unknown terminal type '${e}'`)}}getTerminalMagnet(e,t={}){switch(e){case"source":{if(t.raw)return this.sourceMagnet;const n=this.sourceView;return n?this.sourceMagnet||n.container:null}case"target":{if(t.raw)return this.targetMagnet;const n=this.targetView;return n?this.targetMagnet||n.container:null}default:throw new Error(`Unknown terminal type '${e}'`)}}updateConnection(e={}){const t=this.cell;if(e.translateBy&&t.isFragmentDescendantOf(e.translateBy)){const n=e.tx||0,i=e.ty||0;this.routePoints=new so(this.routePoints).translate(n,i).points,this.translateConnectionPoints(n,i),this.path.translate(n,i)}else{const n=t.getVertices(),i=this.findAnchors(n);this.sourceAnchor=i.source,this.targetAnchor=i.target,this.routePoints=this.findRoutePoints(n);const o=this.findConnectionPoints(this.routePoints,this.sourceAnchor,this.targetAnchor);this.sourcePoint=o.source,this.targetPoint=o.target;const s=this.findMarkerPoints(this.routePoints,this.sourcePoint,this.targetPoint);this.path=this.findPath(this.routePoints,s.source||this.sourcePoint,s.target||this.targetPoint)}this.cleanCache()}findAnchors(e){const t=this.cell,n=t.source,i=t.target,o=e[0],s=e[e.length-1];return i.priority&&!n.priority?this.findAnchorsOrdered("target",s,"source",o):this.findAnchorsOrdered("source",o,"target",s)}findAnchorsOrdered(e,t,n,i){let o,s;const a=this.cell,l=a[e],c=a[n],u=this.getTerminalView(e),d=this.getTerminalView(n),h=this.getTerminalMagnet(e),f=this.getTerminalMagnet(n);if(u){let p;t?p=pe.create(t):d?p=f:p=pe.create(c),o=this.getAnchor(l.anchor,u,h,p,e)}else o=pe.create(l);if(d){const p=pe.create(i||o);s=this.getAnchor(c.anchor,d,f,p,n)}else s=pe.isPointLike(c)?pe.create(c):new pe;return{[e]:o,[n]:s}}getAnchor(e,t,n,i,o){const s=t.isEdgeElement(n),a=this.graph.options.connecting;let l=typeof e=="string"?{name:e}:e;if(!l){const d=s?(o==="source"?a.sourceEdgeAnchor:a.targetEdgeAnchor)||a.edgeAnchor:(o==="source"?a.sourceAnchor:a.targetAnchor)||a.anchor;l=typeof d=="string"?{name:d}:d}if(!l)throw new Error("Anchor should be specified.");let c;const u=l.name;if(s){const d=Nf.registry.get(u);if(typeof d!="function")return Nf.registry.onNotFound(u);c=dn(d,this,t,n,i,l.args||{},o)}else{const d=Df.registry.get(u);if(typeof d!="function")return Df.registry.onNotFound(u);c=dn(d,this,t,n,i,l.args||{},o)}return c?c.round(this.POINT_ROUNDING):new pe}findRoutePoints(e=[]){const t=this.graph.options.connecting.router||du.presets.normal,n=this.cell.getRouter()||t;let i;if(typeof n=="function")i=dn(n,this,e,{},this);else{const o=typeof n=="string"?n:n.name,s=typeof n=="string"?{}:n.args||{},a=o?du.registry.get(o):du.presets.normal;if(typeof a!="function")return du.registry.onNotFound(o);i=dn(a,this,e,s,this)}return i==null?e.map(o=>pe.create(o)):i.map(o=>pe.create(o))}findConnectionPoints(e,t,n){const i=this.cell,o=this.graph.options.connecting,s=i.getSource(),a=i.getTarget(),l=this.sourceView,c=this.targetView,u=e[0],d=e[e.length-1];let h;if(l&&!l.isEdgeElement(this.sourceMagnet)){const p=this.sourceMagnet||l.container,g=u||n,v=new xn(g,t),y=s.connectionPoint||o.sourceConnectionPoint||o.connectionPoint;h=this.getConnectionPoint(y,l,p,v,"source")}else h=t;let f;if(c&&!c.isEdgeElement(this.targetMagnet)){const p=this.targetMagnet||c.container,g=a.connectionPoint||o.targetConnectionPoint||o.connectionPoint,v=d||t,y=new xn(v,n);f=this.getConnectionPoint(g,c,p,y,"target")}else f=n;return{source:h,target:f}}getConnectionPoint(e,t,n,i,o){const s=i.end;if(e==null)return s;const a=typeof e=="string"?e:e.name,l=typeof e=="string"?{}:e.args,c=Rf.registry.get(a);if(typeof c!="function")return Rf.registry.onNotFound(a);const u=dn(c,this,i,t,n,l||{},o);return u?u.round(this.POINT_ROUNDING):s}updateMarkerAttr(e){const t=this.cell.getAttrs(),n=`.${e}-marker`,i=t&&t[n];i&&this.updateAttrs(this.container,{},{attrs:{[n]:i},selectors:this.selectors})}findMarkerPoints(e,t,n){const i=h=>{const f=this.cell.getAttrs(),p=Object.keys(f);for(let g=0,v=p.length;g<v;g+=1){const y=f[p[g]];if(y[`${h}Marker`]||y[`${h}-marker`]){const x=y.strokeWidth||y["stroke-width"];if(x)return parseFloat(x);break}}return null},o=e[0],s=e[e.length-1],a=this.containers.sourceMarker,l=this.containers.targetMarker,c=this.markerCache;let u,d;if(a){if(this.updateMarkerAttr("source"),c.sourceBBox=c.sourceBBox||No(a),c.sourceBBox.width>0){const h=nu(a);u=t.clone().move(o||n,c.sourceBBox.width*h.sx*-1)}}else{const h=i("source");h&&(u=t.clone().move(o||n,-h))}if(l){if(this.updateMarkerAttr("target"),c.targetBBox=c.targetBBox||No(l),c.targetBBox.width>0){const h=nu(l);d=n.clone().move(s||t,c.targetBBox.width*h.sx*-1)}}else{const h=i("target");h&&(d=n.clone().move(s||t,-h))}return c.sourcePoint=u||t.clone(),c.targetPoint=d||n.clone(),{source:u,target:d}}findPath(e,t,n){const i=this.cell.getConnector()||this.graph.options.connecting.connector;let o,s,a;if(typeof i=="string"?o=i:(o=i.name,s=i.args),o){const c=wl.registry.get(o);if(typeof c!="function")return wl.registry.onNotFound(o);a=c}else a=wl.presets.normal;const l=dn(a,this,t,n,e,Object.assign(Object.assign({},s),{raw:!0}),this);return typeof l=="string"?Dn.parse(l):l}translateConnectionPoints(e,t){const n=this.markerCache;n.sourcePoint&&n.sourcePoint.translate(e,t),n.targetPoint&&n.targetPoint.translate(e,t),this.sourcePoint.translate(e,t),this.targetPoint.translate(e,t),this.sourceAnchor.translate(e,t),this.targetAnchor.translate(e,t)}updateLabelPositions(){if(this.containers.labels==null)return this;if(!this.path)return this;const t=this.cell,n=t.getLabels();if(n.length===0)return this;const i=t.getDefaultLabel(),o=this.normalizeLabelPosition(i.position);for(let s=0,a=n.length;s<a;s+=1){const l=n[s],c=this.normalizeLabelPosition(l.position),u=ir({},o,c),d=this.getLabelTransformationMatrix(u);this.labelCache[s].setAttribute("transform",Nd(d))}return this}updateToolsPosition(){if(this.containers.tools==null)return this;let e="",t=this.options.toolsOffset;const n=this.getConnectionLength();if(n!=null){n<this.options.shortLength&&(e="scale(.5)",t/=2);let i=this.getPointAtLength(t);if(i!=null&&ei(this.toolCache,"transform",`translate(${i.x},${i.y}) ${e}`),this.options.doubleTools&&n>=this.options.longLength){const o=this.options.doubleToolsOffset||t;i=this.getPointAtLength(n-o),i!=null&&ei(this.tool2Cache,"transform",`translate(${i.x},${i.y}) ${e}`),ei(this.tool2Cache,"visibility","visible")}else this.options.doubleTools&&ei(this.tool2Cache,"visibility","hidden")}return this}updateArrowheadMarkers(){const e=this.containers.arrowheads;if(e==null)return this;if(e.style.display==="none")return this;const t=this.containers.sourceArrowhead,n=this.containers.targetArrowhead;if(t&&n){const o=(this.getConnectionLength()||0)<this.options.shortLength?.5:1;nu(t,o),nu(n,o),this.translateAndAutoOrientArrows(t,n)}return this}updateTerminalProperties(e){const t=this.cell,n=this.graph,i=t[e],o=i&&i.cell,s=`${e}View`;if(!o)return this[s]=null,this.updateTerminalMagnet(e),!0;const a=n.getCellById(o);if(!a)throw new Error(`Edge's ${e} node with id "${o}" not exists`);const l=a.findView(n);return l?(this[s]=l,this.updateTerminalMagnet(e),!0):!1}updateTerminalMagnet(e){const t=`${e}Magnet`,n=this.getTerminalView(e);if(n){let i=n.getMagnetFromEdgeTerminal(this.cell[e]);i===n.container&&(i=null),this[t]=i}else this[t]=null}translateAndAutoOrientArrows(e,t){const n=this.routePoints;e&&qC(e,this.sourcePoint,n[0]||this.targetPoint,this.graph.view.stage),t&&qC(t,this.targetPoint,n[n.length-1]||this.sourcePoint,this.graph.view.stage)}getLabelPositionAngle(e){const t=this.cell.getLabelAt(e);return t&&t.position&&typeof t.position=="object"&&t.position.angle||0}getLabelPositionArgs(e){const t=this.cell.getLabelAt(e);if(t&&t.position&&typeof t.position=="object")return t.position.options}getDefaultLabelPositionArgs(){const e=this.cell.getDefaultLabel();if(e&&e.position&&typeof e.position=="object")return e.position.options}mergeLabelPositionArgs(e,t){return e===null?null:e===void 0?t===null?null:t:ir({},t,e)}addLabel(e,t,n,i){let o,s,a=0,l;typeof e!="number"?(o=e.x,s=e.y,typeof t=="number"?(a=t,l=n):l=t):(o=e,s=t,typeof n=="number"?(a=n,l=i):l=n);const c=this.getDefaultLabelPositionArgs(),u=l,d=this.mergeLabelPositionArgs(u,c),h={position:this.getLabelPosition(o,s,a,d)},f=-1;return this.cell.insertLabel(h,f,l),f}addVertex(e,t,n){const i=typeof e!="number",o=i?e.x:e,s=i?e.y:t,a=i?t:n,l={x:o,y:s},c=this.getVertexIndex(o,s);return this.cell.insertVertex(l,c,a),c}sendToken(e,t,n){let i,o,s,a,l="linear";typeof t=="object"?(i=t.duration,o=t.reversed===!0,s=t.selector,t.rotate===!1?a="":t.rotate===!0?a="auto":t.rotate!=null&&(a=`${t.rotate}`),t.timing&&(l=t.timing)):(i=t,o=!1,s=null),i=i||1e3;const c={dur:`${i}ms`,repeatCount:"1",calcMode:l,fill:"freeze"};if(a&&(c.rotate=a),o&&(c.keyPoints="1;0",c.keyTimes="0;1"),typeof t=="object"){const{duration:y,reversed:x,selector:E,rotate:T,timing:P}=t,z=aU(t,["duration","reversed","selector","rotate","timing"]);Object.keys(z).forEach($=>{c[$]=z[$]})}let u;if(typeof s=="string"?u=this.findOne(s,this.container,this.selectors):u=this.containers.connection?this.containers.connection:this.container.querySelector("path"),!(u instanceof SVGPathElement))throw new Error("Token animation requires a valid connection path.");const d=typeof e=="string"?this.findOne(e):e;if(d==null)throw new Error("Token animation requires a valid token element.");const h=d.parentNode,f=()=>{h||bl(d)},p=pn.create(d);h||p.appendTo(this.graph.view.stage);const g=c.complete;c.complete=y=>{f(),n&&n(),g&&g(y)};const v=p.animateAlongPath(c,u);return()=>{f(),v()}}getConnection(){return this.path!=null?this.path.clone():null}getConnectionPathData(){if(this.path==null)return"";const e=this.cache.pathCache;return Jc(e,"data")||(e.data=this.path.serialize()),e.data||""}getConnectionSubdivisions(){if(this.path==null)return null;const e=this.cache.pathCache;return Jc(e,"segmentSubdivisions")||(e.segmentSubdivisions=this.path.getSegmentSubdivisions()),e.segmentSubdivisions}getConnectionLength(){if(this.path==null)return 0;const e=this.cache.pathCache;return Jc(e,"length")||(e.length=this.path.length({segmentSubdivisions:this.getConnectionSubdivisions()})),e.length}getPointAtLength(e){return this.path==null?null:this.path.pointAtLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getPointAtRatio(e){return this.path==null?null:(yl(e)&&(e=parseFloat(e)/100),this.path.pointAt(e,{segmentSubdivisions:this.getConnectionSubdivisions()}))}getTangentAtLength(e){return this.path==null?null:this.path.tangentAtLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getTangentAtRatio(e){return this.path==null?null:this.path.tangentAt(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPoint(e){return this.path==null?null:this.path.closestPoint(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointLength(e){return this.path==null?null:this.path.closestPointLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointRatio(e){return this.path==null?null:this.path.closestPointNormalizedLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getLabelPosition(e,t,n,i){const o={distance:0};let s=0,a;typeof n=="number"?(s=n,a=i):a=n,a!=null&&(o.options=a);const l=a&&a.absoluteOffset,c=!(a&&a.absoluteDistance),u=a&&a.absoluteDistance&&a.reverseDistance,d=this.path,h={segmentSubdivisions:this.getConnectionSubdivisions()},f=new pe(e,t),p=d.closestPointT(f,h),g=this.getConnectionLength()||0;let v=d.lengthAtT(p,h);c&&(v=g>0?v/g:0),u&&(v=-1*(g-v)||1),o.distance=v;let y;l||(y=d.tangentAtT(p));let x;if(y)x=y.pointOffset(f);else{const E=d.pointAtT(p),T=f.diff(E);x={x:T.x,y:T.y}}return o.offset=x,o.angle=s,o}normalizeLabelPosition(e){return typeof e=="number"?{distance:e}:e}getLabelTransformationMatrix(e){const t=this.normalizeLabelPosition(e),n=t.options||{},i=t.angle||0,o=t.distance,s=o>0&&o<=1;let a=0;const l={x:0,y:0},c=t.offset;c&&(typeof c=="number"?a=c:(c.x!=null&&(l.x=c.x),c.y!=null&&(l.y=c.y)));const u=l.x!==0||l.y!==0||a===0,d=n.keepGradient,h=n.ensureLegibility,f=this.path,p={segmentSubdivisions:this.getConnectionSubdivisions()},g=s?o*this.getConnectionLength():o,v=f.tangentAtLength(g,p);let y,x=i;if(v){if(u)y=v.start,y.translate(l);else{const E=v.clone();E.rotate(-90,v.start),E.setLength(a),y=E.end}d&&(x=v.angle()+i,h&&(x=Rr.normalize((x+90)%180-90)))}else y=f.start,u&&y.translate(l);return Do().translate(y.x,y.y).rotate(x)}getLabelCoordinates(e){const t=this.getLabelTransformationMatrix(e);return new pe(t.e,t.f)}getVertexIndex(e,t){const i=this.cell.getVertices(),o=this.getClosestPointLength(new pe(e,t));let s=0;if(o!=null)for(const a=i.length;s<a;s+=1){const l=i[s],c=this.getClosestPointLength(l);if(c!=null&&o<c)break}return s}getEventArgs(e,t,n){const i=this,o=i.cell,s=o;return t==null||n==null?{e,view:i,edge:o,cell:s}:{e,x:t,y:n,view:i,edge:o,cell:s}}notifyUnhandledMouseDown(e,t,n){this.notify("edge:unhandled:mousedown",{e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})}notifyMouseDown(e,t,n){super.onMouseDown(e,t,n),this.notify("edge:mousedown",this.getEventArgs(e,t,n))}notifyMouseMove(e,t,n){super.onMouseMove(e,t,n),this.notify("edge:mousemove",this.getEventArgs(e,t,n))}notifyMouseUp(e,t,n){super.onMouseUp(e,t,n),this.notify("edge:mouseup",this.getEventArgs(e,t,n))}onClick(e,t,n){super.onClick(e,t,n),this.notify("edge:click",this.getEventArgs(e,t,n))}onDblClick(e,t,n){super.onDblClick(e,t,n),this.notify("edge:dblclick",this.getEventArgs(e,t,n))}onContextMenu(e,t,n){super.onContextMenu(e,t,n),this.notify("edge:contextmenu",this.getEventArgs(e,t,n))}onMouseDown(e,t,n){switch(this.notifyMouseDown(e,t,n),e.target.getAttribute("class")){case"vertex":{this.startVertexDragging(e,t,n);return}case"vertex-remove":case"vertex-remove-area":{this.handleVertexRemoving(e,t,n);return}case"connection":case"connection-wrap":{this.handleVertexAdding(e,t,n);return}case"arrowhead":{this.startArrowheadDragging(e,t,n);return}case"source-marker":case"target-marker":{this.notifyUnhandledMouseDown(e,t,n);return}default:break}this.startEdgeDragging(e,t,n)}onMouseMove(e,t,n){const i=this.getEventData(e);switch(i.action){case"drag-vertex":{this.dragVertex(e,t,n);break}case"drag-label":{this.dragLabel(e,t,n);break}case"drag-arrowhead":{this.dragArrowhead(e,t,n);break}case"drag-edge":{this.dragEdge(e,t,n);break}default:break}return this.notifyMouseMove(e,t,n),i}onMouseUp(e,t,n){const i=this.getEventData(e);switch(i.action){case"drag-vertex":{this.stopVertexDragging(e,t,n);break}case"drag-label":{this.stopLabelDragging(e,t,n);break}case"drag-arrowhead":{this.stopArrowheadDragging(e,t,n);break}case"drag-edge":{this.stopEdgeDragging(e,t,n);break}default:break}return this.notifyMouseUp(e,t,n),this.checkMouseleave(e),i}onMouseOver(e){super.onMouseOver(e),this.notify("edge:mouseover",this.getEventArgs(e))}onMouseOut(e){super.onMouseOut(e),this.notify("edge:mouseout",this.getEventArgs(e))}onMouseEnter(e){super.onMouseEnter(e),this.notify("edge:mouseenter",this.getEventArgs(e))}onMouseLeave(e){super.onMouseLeave(e),this.notify("edge:mouseleave",this.getEventArgs(e))}onMouseWheel(e,t,n,i){super.onMouseWheel(e,t,n,i),this.notify("edge:mousewheel",Object.assign({delta:i},this.getEventArgs(e,t,n)))}onCustomEvent(e,t,n,i){if(n_(e.target,"edge-tool",this.container)){if(e.stopPropagation(),this.can("useEdgeTools")){if(t==="edge:remove"){this.cell.remove({ui:!0});return}this.notify("edge:customevent",Object.assign({name:t},this.getEventArgs(e,n,i)))}this.notifyMouseDown(e,n,i)}else this.notify("edge:customevent",Object.assign({name:t},this.getEventArgs(e,n,i))),super.onCustomEvent(e,t,n,i)}onLabelMouseDown(e,t,n){this.notifyMouseDown(e,t,n),this.startLabelDragging(e,t,n),this.getEventData(e).stopPropagation&&e.stopPropagation()}startEdgeDragging(e,t,n){if(!this.can("edgeMovable")){this.notifyUnhandledMouseDown(e,t,n);return}this.setEventData(e,{x:t,y:n,moving:!1,action:"drag-edge"})}dragEdge(e,t,n){const i=this.getEventData(e);i.moving||(i.moving=!0,this.addClass("edge-moving"),this.notify("edge:move",{e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})),this.cell.translate(t-i.x,n-i.y,{ui:!0}),this.setEventData(e,{x:t,y:n}),this.notify("edge:moving",{e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})}stopEdgeDragging(e,t,n){const i=this.getEventData(e);i.moving&&(this.removeClass("edge-moving"),this.notify("edge:moved",{e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})),i.moving=!1}prepareArrowheadDragging(e,t){const n=this.getTerminalMagnet(e),i={action:"drag-arrowhead",x:t.x,y:t.y,isNewEdge:t.isNewEdge===!0,terminalType:e,initialMagnet:n,initialTerminal:Mg(this.cell[e]),fallbackAction:t.fallbackAction||"revert",getValidateConnectionArgs:this.createValidateConnectionArgs(e),options:t.options};return this.beforeArrowheadDragging(i),i}createValidateConnectionArgs(e){const t=[];t[4]=e,t[5]=this;let n,i=0,o=0;e==="source"?(i=2,n="target"):(o=2,n="source");const s=this.cell[n],a=s.cell;if(a){let l;const c=t[i]=this.graph.renderer.findViewByCell(a);c&&(l=c.getMagnetFromEdgeTerminal(s),l===c.container&&(l=void 0)),t[i+1]=l}return(l,c)=>(t[o]=l,t[o+1]=l.container===c?void 0:c,t)}beforeArrowheadDragging(e){e.zIndex=this.cell.zIndex,this.cell.toFront();const t=this.container.style;e.pointerEvents=t.pointerEvents,t.pointerEvents="none",this.graph.options.connecting.highlight&&this.highlightAvailableMagnets(e)}afterArrowheadDragging(e){e.zIndex!=null&&(this.cell.setZIndex(e.zIndex,{ui:!0}),e.zIndex=null);const t=this.container;t.style.pointerEvents=e.pointerEvents||"",this.graph.options.connecting.highlight&&this.unhighlightAvailableMagnets(e)}arrowheadDragging(e,t,n,i){i.x=t,i.y=n,i.currentTarget!==e&&(i.currentMagnet&&i.currentView&&i.currentView.unhighlight(i.currentMagnet,{type:"magnetAdsorbed"}),i.currentView=this.graph.renderer.findViewByElem(e),i.currentView?(i.currentMagnet=i.currentView.findMagnet(e),i.currentMagnet&&this.graph.hook.validateConnection(...i.getValidateConnectionArgs(i.currentView,i.currentMagnet),i.currentView.getEdgeTerminal(i.currentMagnet,t,n,this.cell,i.terminalType))?i.currentView.highlight(i.currentMagnet,{type:"magnetAdsorbed"}):i.currentMagnet=null):i.currentMagnet=null),i.currentTarget=e,this.cell.prop(i.terminalType,{x:t,y:n},Object.assign(Object.assign({},i.options),{ui:!0}))}arrowheadDragged(e,t,n){const i=e.currentView,o=e.currentMagnet;if(!o||!i)return;i.unhighlight(o,{type:"magnetAdsorbed"});const s=e.terminalType,a=i.getEdgeTerminal(o,t,n,this.cell,s);this.cell.setTerminal(s,a,{ui:!0})}snapArrowhead(e,t,n){const i=this.graph,{snap:o,allowEdge:s}=i.options.connecting,a=typeof o=="object"&&o.radius||50,l={x:e-a,y:t-a,width:2*a,height:2*a},c=i.renderer.findViewsInArea(l);if(s){const T=i.renderer.findEdgeViewsInArea(l).filter(P=>P!==this);c.push(...T)}const u=n.closestView||null,d=n.closestMagnet||null;n.closestView=null,n.closestMagnet=null;let h,f=Number.MAX_SAFE_INTEGER;const p=new pe(e,t);c.forEach(T=>{T.container.getAttribute("magnet")!=="false"&&(h=T.cell.getBBox().getCenter().distance(p),h<a&&h<f&&(d===T.container||i.hook.validateConnection(...n.getValidateConnectionArgs(T,null),T.getEdgeTerminal(T.container,e,t,this.cell,n.terminalType)))&&(f=h,n.closestView=T,n.closestMagnet=T.container)),T.container.querySelectorAll("[magnet]").forEach(P=>{if(P.getAttribute("magnet")!=="false"){const z=T.getBBoxOfElement(P);h=p.distance(z.getCenter()),h<a&&h<f&&(d===P||i.hook.validateConnection(...n.getValidateConnectionArgs(T,P),T.getEdgeTerminal(P,e,t,this.cell,n.terminalType)))&&(f=h,n.closestView=T,n.closestMagnet=P)}})});let g;const v=n.terminalType,y=n.closestView,x=n.closestMagnet,E=d!==x;if(u&&E&&u.unhighlight(d,{type:"magnetAdsorbed"}),y){if(!E)return;y.highlight(x,{type:"magnetAdsorbed"}),g=y.getEdgeTerminal(x,e,t,this.cell,v)}else g={x:e,y:t};this.cell.setTerminal(v,g,{},Object.assign(Object.assign({},n.options),{ui:!0}))}snapArrowheadEnd(e){const t=e.closestView,n=e.closestMagnet;t&&n&&(t.unhighlight(n,{type:"magnetAdsorbed"}),e.currentMagnet=t.findMagnet(n)),e.closestView=null,e.closestMagnet=null}finishEmbedding(e){this.graph.options.embedding.enabled&&this.cell.updateParent()&&(e.zIndex=null)}fallbackConnection(e){switch(e.fallbackAction){case"remove":this.cell.remove({ui:!0});break;case"revert":default:this.cell.prop(e.terminalType,e.initialTerminal,{ui:!0});break}}notifyConnectionEvent(e,t){const n=e.terminalType,i=e.initialTerminal,o=this.cell[n];if(o&&!Ai.equalTerminals(i,o)){const a=this.graph,l=i,c=l.cell?a.getCellById(l.cell):null,u=l.port,d=c?a.findViewByCell(c):null,h=c||e.isNewEdge?null:pe.create(i).toJSON(),f=o,p=f.cell?a.getCellById(f.cell):null,g=f.port,v=p?a.findViewByCell(p):null,y=p?null:pe.create(o).toJSON();this.notify("edge:connected",{e:t,previousCell:c,previousPort:u,previousView:d,previousPoint:h,currentCell:p,currentView:v,currentPort:g,currentPoint:y,previousMagnet:e.initialMagnet,currentMagnet:e.currentMagnet,edge:this.cell,view:this,type:n,isNew:e.isNewEdge})}}highlightAvailableMagnets(e){const t=this.graph,n=t.model.getCells();e.marked={};for(let i=0,o=n.length;i<o;i+=1){const s=t.renderer.findViewByCell(n[i]);if(!s)continue;const a=Array.prototype.slice.call(s.container.querySelectorAll("[magnet]"));s.container.getAttribute("magnet")!=="false"&&a.push(s.container);const l=a.filter(c=>t.hook.validateConnection(...e.getValidateConnectionArgs(s,c),s.getEdgeTerminal(c,e.x,e.y,this.cell,e.terminalType)));if(l.length>0){for(let c=0,u=l.length;c<u;c+=1)s.highlight(l[c],{type:"magnetAvailable"});s.highlight(null,{type:"nodeAvailable"}),e.marked[s.cell.id]=l}}}unhighlightAvailableMagnets(e){const t=e.marked||{};Object.keys(t).forEach(n=>{const i=this.graph.renderer.findViewByCell(n);i&&(t[n].forEach(s=>{i.unhighlight(s,{type:"magnetAvailable"})}),i.unhighlight(null,{type:"nodeAvailable"}))}),e.marked=null}startArrowheadDragging(e,t,n){if(!this.can("arrowheadMovable")){this.notifyUnhandledMouseDown(e,t,n);return}const o=e.target.getAttribute("data-terminal"),s=this.prepareArrowheadDragging(o,{x:t,y:n});this.setEventData(e,s)}dragArrowhead(e,t,n){const i=this.getEventData(e);this.graph.options.connecting.snap?this.snapArrowhead(t,n,i):this.arrowheadDragging(this.getEventTarget(e),t,n,i)}stopArrowheadDragging(e,t,n){const i=this.graph,o=this.getEventData(e);i.options.connecting.snap?this.snapArrowheadEnd(o):this.arrowheadDragged(o,t,n),i.hook.validateEdge(this.cell,o.terminalType,o.initialTerminal)?(this.finishEmbedding(o),this.notifyConnectionEvent(o,e)):this.fallbackConnection(o),this.afterArrowheadDragging(o)}startLabelDragging(e,t,n){if(this.can("edgeLabelMovable")){const i=e.currentTarget,o=parseInt(i.getAttribute("data-index"),10),s=this.getLabelPositionAngle(o),a=this.getLabelPositionArgs(o),l=this.getDefaultLabelPositionArgs(),c=this.mergeLabelPositionArgs(a,l);this.setEventData(e,{index:o,positionAngle:s,positionArgs:c,stopPropagation:!0,action:"drag-label"})}else this.setEventData(e,{stopPropagation:!0});this.graph.view.delegateDragEvents(e,this)}dragLabel(e,t,n){const i=this.getEventData(e),o=this.cell.getLabelAt(i.index),s=ir({},o,{position:this.getLabelPosition(t,n,i.positionAngle,i.positionArgs)});this.cell.setLabelAt(i.index,s)}stopLabelDragging(e,t,n){}handleVertexAdding(e,t,n){if(!this.can("vertexAddable")){this.notifyUnhandledMouseDown(e,t,n);return}const i=this.addVertex({x:t,y:n},{ui:!0});this.setEventData(e,{index:i,action:"drag-vertex"})}handleVertexRemoving(e,t,n){if(!this.can("vertexDeletable")){this.notifyUnhandledMouseDown(e,t,n);return}const i=e.target,o=parseInt(i.getAttribute("idx"),10);this.cell.removeVertexAt(o)}startVertexDragging(e,t,n){if(!this.can("vertexMovable")){this.notifyUnhandledMouseDown(e,t,n);return}const i=e.target,o=parseInt(i.getAttribute("idx"),10);this.setEventData(e,{index:o,action:"drag-vertex"})}dragVertex(e,t,n){const i=this.getEventData(e);this.cell.setVertexAt(i.index,{x:t,y:n},{ui:!0})}stopVertexDragging(e,t,n){}}(function(r){r.toStringTag=`X6.${r.name}`;function e(t){if(t==null)return!1;if(t instanceof r)return!0;const n=t[Symbol.toStringTag],i=t;return(n==null||n===r.toStringTag)&&typeof i.isNodeView=="function"&&typeof i.isEdgeView=="function"&&typeof i.confirmUpdate=="function"&&typeof i.update=="function"&&typeof i.getConnection=="function"}r.isEdgeView=e})(hc||(hc={})),hc.config({isSvgElement:!0,priority:1,bootstrap:["render","source","target"],actions:{view:["render"],markup:["render"],attrs:["update"],source:["source","update"],target:["target","update"],router:["update"],connector:["update"],labels:["labels"],defaultLabel:["labels"],vertices:["vertices","update"],vertexMarkup:["vertices"],toolMarkup:["tools"],tools:["widget"]},shortLength:105,longLength:155,toolsOffset:40,doubleTools:!1,doubleToolsOffset:65,sampleInterval:50}),hc.registry.register("edge",hc,!0);class xo extends Ii{constructor(){super(...arguments);this.scalableNode=null,this.rotatableNode=null,this.scalableSelector="scalable",this.rotatableSelector="rotatable",this.defaultPortMarkup=Ur.getPortMarkup(),this.defaultPortLabelMarkup=Ur.getPortLabelMarkup(),this.defaultPortContainerMarkup=Ur.getPortContainerMarkup(),this.portsCache={}}get[Symbol.toStringTag](){return xo.toStringTag}getContainerClassName(){const e=[super.getContainerClassName(),this.prefixClassName("node")];return this.can("nodeMovable")||e.push(this.prefixClassName("node-immovable")),e.join(" ")}updateClassName(e){const t=e.target;if(t.hasAttribute("magnet")){const n=this.prefixClassName("port-unconnectable");this.can("magnetConnectable")?ma(t,n):Qr(t,n)}else{const n=this.prefixClassName("node-immovable");this.can("nodeMovable")?this.removeClass(n):this.addClass(n)}}isNodeView(){return!0}confirmUpdate(e,t={}){let n=e;return this.hasAction(n,"ports")&&(this.removePorts(),this.cleanPortsCache()),this.hasAction(n,"render")?(this.render(),n=this.removeAction(n,["render","update","resize","translate","rotate","ports","tools"])):(n=this.handleAction(n,"resize",()=>this.resize(t),"update"),n=this.handleAction(n,"update",()=>this.update(),ea.useCSSSelector?"ports":null),n=this.handleAction(n,"translate",()=>this.translate()),n=this.handleAction(n,"rotate",()=>this.rotate()),n=this.handleAction(n,"ports",()=>this.renderPorts()),n=this.handleAction(n,"tools",()=>this.renderTools())),n}update(e){this.cleanCache(),ea.useCSSSelector&&this.removePorts();const t=this.cell,n=t.getSize(),i=t.getAttrs();this.updateAttrs(this.container,i,{attrs:e===i?null:e,rootBBox:new Ht(0,0,n.width,n.height),selectors:this.selectors,scalableNode:this.scalableNode,rotatableNode:this.rotatableNode}),ea.useCSSSelector&&this.renderPorts()}renderMarkup(){const e=this.cell.markup;if(e)return typeof e=="string"?this.renderStringMarkup(e):this.renderJSONMarkup(e);throw new TypeError("Invalid node markup.")}renderJSONMarkup(e){const t=this.parseJSONMarkup(e,this.container),n=i=>Array.isArray(i)?i[0]:i;this.selectors=t.selectors,this.rotatableNode=n(this.selectors[this.rotatableSelector]),this.scalableNode=n(this.selectors[this.scalableSelector]),this.container.appendChild(t.fragment)}renderStringMarkup(e){Rg(this.container,pn.toNodes(pn.createVectors(e))),this.rotatableNode=RC(this.container,`.${this.rotatableSelector}`),this.scalableNode=RC(this.container,`.${this.scalableSelector}`),this.selectors={},this.rootSelector&&(this.selectors[this.rootSelector]=this.container)}render(){return this.empty(),this.renderMarkup(),this.scalableNode&&this.update(),this.resize(),this.rotatableNode?(this.rotate(),this.translate()):this.updateTransform(),ea.useCSSSelector||this.renderPorts(),this.renderTools(),this}resize(e={}){if(this.scalableNode)return this.updateSize(e);this.cell.getAngle()&&this.rotate(),this.update()}translate(){if(this.rotatableNode)return this.updateTranslation();this.updateTransform()}rotate(){if(this.rotatableNode){this.updateRotation(),this.update();return}this.updateTransform()}getTranslationString(){const e=this.cell.getPosition();return`translate(${e.x},${e.y})`}getRotationString(){const e=this.cell.getAngle();if(e){const t=this.cell.getSize();return`rotate(${e},${t.width/2},${t.height/2})`}}updateTransform(){let e=this.getTranslationString();const t=this.getRotationString();t&&(e+=` ${t}`),this.container.setAttribute("transform",e)}updateRotation(){if(this.rotatableNode!=null){const e=this.getRotationString();e!=null?this.rotatableNode.setAttribute("transform",e):this.rotatableNode.removeAttribute("transform")}}updateTranslation(){this.container.setAttribute("transform",this.getTranslationString())}updateSize(e={}){const t=this.cell,n=t.getSize(),i=t.getAngle(),o=this.scalableNode;let s=!1;o.getElementsByTagName("path").length>0&&(s=!0);const a=No(o,{recursive:s}),l=n.width/(a.width||1),c=n.height/(a.height||1);o.setAttribute("transform",`scale(${l},${c})`);const u=this.rotatableNode;if(u!=null){const d=u.getAttribute("transform");if(d){u.setAttribute("transform",`${d} rotate(${-i},${n.width/2},${n.height/2})`);const h=No(o,{target:this.graph.view.stage});t.prop("position",{x:h.x,y:h.y},Object.assign({updated:!0},e)),this.translate(),this.rotate()}}this.update()}findPortElem(e,t){const n=e?this.portsCache[e]:null;if(!n)return null;const i=n.portContentElement,o=n.portContentSelectors||{};return this.findOne(t,i,o)}initializePorts(){this.cleanPortsCache()}refreshPorts(){this.removePorts(),this.cleanPortsCache(),this.renderPorts()}cleanPortsCache(){this.portsCache={}}removePorts(){Object.keys(this.portsCache).forEach(e=>{const t=this.portsCache[e];bl(t.portElement)})}renderPorts(){const e=this.getPortsContainer(),t=[];e.childNodes.forEach(o=>{t.push(o)});const n=Cd(this.cell.getParsedPorts(),"zIndex"),i="auto";n[i]&&n[i].forEach(o=>{const s=this.getPortElement(o);e.append(s),t.push(s)}),Object.keys(n).forEach(o=>{if(o!==i){const s=parseInt(o,10);this.appendPorts(n[o],s,t)}}),this.updatePorts()}getPortsContainer(){return this.rotatableNode||this.container}appendPorts(e,t,n){const i=e.map(o=>this.getPortElement(o));n[t]||t<0?LC(n[Math.max(t,0)],i):Rg(this.getPortsContainer(),i)}getPortElement(e){const t=this.portsCache[e.id];return t?t.portElement:this.createPortElement(e)}createPortElement(e){let t=Ur.renderMarkup(this.getPortContainerMarkup());const n=t.elem;if(n==null)throw new Error("Invalid port container markup.");t=Ur.renderMarkup(this.getPortMarkup(e));const i=t.elem,o=t.selectors;if(i==null)throw new Error("Invalid port markup.");this.setAttrs({port:e.id,"port-group":e.group},i),t=Ur.renderMarkup(this.getPortLabelMarkup(e.label));const s=t.elem,a=t.selectors;if(s==null)throw new Error("Invalid port label markup.");let l;if(o&&a){for(const u in a)if(o[u]&&u!==this.rootSelector)throw new Error("Selectors within port must be unique.");l=Object.assign(Object.assign({},o),a)}else l=o||a;let c="x6-port";return e.group&&(c+=` x6-port-${e.group}`),Qr(n,c),Qr(i,"x6-port-body"),Qr(s,"x6-port-label"),n.appendChild(i),n.appendChild(s),this.portsCache[e.id]={portElement:n,portSelectors:l,portLabelElement:s,portLabelSelectors:a,portContentElement:i,portContentSelectors:o},this.graph.hook.onPortRendered({port:e,node:this.cell,container:n,selectors:l,labelContainer:s,labelSelectors:a,contentContainer:i,contentSelectors:o}),n}updatePorts(){this.updatePortGroup();const e=this.cell.getParsedGroups();Object.keys(e).forEach(t=>this.updatePortGroup(t))}updatePortGroup(e){const t=Ht.fromSize(this.cell.getSize()),n=this.cell.getPortsLayoutByGroup(e,t);for(let i=0,o=n.length;i<o;i+=1){const s=n[i],a=s.portId,l=this.portsCache[a]||{},c=s.portLayout;if(this.applyPortTransform(l.portElement,c),s.portAttrs!=null){const d={selectors:l.portSelectors||{}};s.portSize&&(d.rootBBox=Ht.fromSize(s.portSize)),this.updateAttrs(l.portElement,s.portAttrs,d)}const u=s.labelLayout;if(u&&(this.applyPortTransform(l.portLabelElement,u,-(c.angle||0)),u.attrs)){const d={selectors:l.portLabelSelectors||{}};s.labelSize&&(d.rootBBox=Ht.fromSize(s.labelSize)),this.updateAttrs(l.portLabelElement,u.attrs,d)}}}applyPortTransform(e,t,n=0){const i=t.angle,o=t.position,s=Do().rotate(n).translate(o.x||0,o.y||0).rotate(i||0);wf(e,s,{absolute:!0})}getPortContainerMarkup(){return this.cell.getPortContainerMarkup()||this.defaultPortContainerMarkup}getPortMarkup(e){return e.markup||this.cell.portMarkup||this.defaultPortMarkup}getPortLabelMarkup(e){return e.markup||this.cell.portLabelMarkup||this.defaultPortLabelMarkup}getEventArgs(e,t,n){const i=this,o=i.cell,s=o;return t==null||n==null?{e,view:i,node:o,cell:s}:{e,x:t,y:n,view:i,node:o,cell:s}}notifyMouseDown(e,t,n){super.onMouseDown(e,t,n),this.notify("node:mousedown",this.getEventArgs(e,t,n))}notifyMouseMove(e,t,n){super.onMouseMove(e,t,n),this.notify("node:mousemove",this.getEventArgs(e,t,n))}notifyMouseUp(e,t,n){super.onMouseUp(e,t,n),this.notify("node:mouseup",this.getEventArgs(e,t,n))}onClick(e,t,n){super.onClick(e,t,n),this.notify("node:click",this.getEventArgs(e,t,n))}onDblClick(e,t,n){super.onDblClick(e,t,n),this.notify("node:dblclick",this.getEventArgs(e,t,n))}onContextMenu(e,t,n){super.onContextMenu(e,t,n),this.notify("node:contextmenu",this.getEventArgs(e,t,n))}onMouseDown(e,t,n){if(this.isPropagationStopped(e))return;const i=e.target;GC(i)||r_(i)||(this.notifyMouseDown(e,t,n),this.startNodeDragging(e,t,n))}onMouseMove(e,t,n){const i=this.getEventData(e),o=i.action;if(o==="magnet")this.dragMagnet(e,t,n);else{if(o==="move"){const a=i.targetView||this;a.dragNode(e,t,n),a.notify("node:moving",{e,x:t,y:n,view:a,cell:a.cell,node:a.cell})}this.notifyMouseMove(e,t,n)}this.setEventData(e,i)}onMouseUp(e,t,n){const i=this.getEventData(e),o=i.action;if(o==="magnet")this.stopMagnetDragging(e,t,n);else{const a=e.target;if(GC(a)||r_(a))return;this.notifyMouseUp(e,t,n),o==="move"&&(i.targetView||this).stopNodeDragging(e,t,n)}const s=i.targetMagnet;s&&this.onMagnetClick(e,s,t,n),this.checkMouseleave(e)}onMouseOver(e){super.onMouseOver(e),this.notify("node:mouseover",this.getEventArgs(e))}onMouseOut(e){super.onMouseOut(e),this.notify("node:mouseout",this.getEventArgs(e))}onMouseEnter(e){this.updateClassName(e),super.onMouseEnter(e),this.notify("node:mouseenter",this.getEventArgs(e))}onMouseLeave(e){super.onMouseLeave(e),this.notify("node:mouseleave",this.getEventArgs(e))}onMouseWheel(e,t,n,i){super.onMouseWheel(e,t,n,i),this.notify("node:mousewheel",Object.assign({delta:i},this.getEventArgs(e,t,n)))}onMagnetClick(e,t,n,i){this.graph.view.getMouseMovedCount(e)>this.graph.options.clickThreshold||this.notify("node:magnet:click",Object.assign({magnet:t},this.getEventArgs(e,n,i)))}onMagnetDblClick(e,t,n,i){this.notify("node:magnet:dblclick",Object.assign({magnet:t},this.getEventArgs(e,n,i)))}onMagnetContextMenu(e,t,n,i){this.notify("node:magnet:contextmenu",Object.assign({magnet:t},this.getEventArgs(e,n,i)))}onMagnetMouseDown(e,t,n,i){this.startMagnetDragging(e,n,i)}onCustomEvent(e,t,n,i){this.notify("node:customevent",Object.assign({name:t},this.getEventArgs(e,n,i))),super.onCustomEvent(e,t,n,i)}prepareEmbedding(e){const n=this.getEventData(e).cell||this.cell,i=this.graph.findViewByCell(n),o=this.graph.snapToGrid(e.clientX,e.clientY);this.notify("node:embed",{e,node:n,view:i,cell:n,x:o.x,y:o.y,currentParent:n.getParent()})}processEmbedding(e,t){const n=t.cell||this.cell,i=t.graph||this.graph,o=i.options.embedding,s=o.findParent;let a=typeof s=="function"?dn(s,i,{view:this,node:this.cell}).filter(h=>Tr.isCell(h)&&this.cell.id!==h.id&&!h.isDescendantOf(this.cell)):i.model.getNodesUnderNode(n,{by:s});if(o.frontOnly&&a.length>0){const h=Cd(a,"zIndex"),f=bv(Object.keys(h).map(p=>parseInt(p,10)));f&&(a=h[f])}a=a.filter(h=>h.visible);let l=null;const c=t.candidateEmbedView,u=o.validate;for(let h=a.length-1;h>=0;h-=1){const f=a[h];if(c&&c.cell.id===f.id){l=c;break}else{const p=f.findView(i);if(dn(u,i,{child:this.cell,parent:p.cell,childView:this,parentView:p})){l=p;break}}}this.clearEmbedding(t),l&&l.highlight(null,{type:"embedding"}),t.candidateEmbedView=l;const d=i.snapToGrid(e.clientX,e.clientY);this.notify("node:embedding",{e,cell:n,node:n,view:i.findViewByCell(n),x:d.x,y:d.y,currentParent:n.getParent(),candidateParent:l?l.cell:null})}clearEmbedding(e){const t=e.candidateEmbedView;t&&(t.unhighlight(null,{type:"embedding"}),e.candidateEmbedView=null)}finalizeEmbedding(e,t){this.graph.startBatch("embedding");const n=t.cell||this.cell,i=t.graph||this.graph,o=i.findViewByCell(n),s=n.getParent(),a=t.candidateEmbedView;if(a?(a.unhighlight(null,{type:"embedding"}),t.candidateEmbedView=null,(s==null||s.id!==a.cell.id)&&a.cell.insertChild(n,void 0,{ui:!0})):s&&s.unembed(n,{ui:!0}),i.model.getConnectedEdges(n,{deep:!0}).forEach(l=>{l.updateParent({ui:!0})}),o&&a){const l=i.snapToGrid(e.clientX,e.clientY);o.notify("node:embedded",{e,cell:n,x:l.x,y:l.y,node:n,view:i.findViewByCell(n),previousParent:s,currentParent:n.getParent()})}this.graph.stopBatch("embedding")}getDelegatedView(){let e=this.cell,t=this;for(;t&&!e.isEdge();){if(!e.hasParent()||t.can("stopDelegateOnDragging"))return t;e=e.getParent(),t=this.graph.renderer.findViewByCell(e)}return null}startMagnetDragging(e,t,n){if(!this.can("magnetConnectable"))return;e.stopPropagation();const i=e.currentTarget,o=this.graph;this.setEventData(e,{targetMagnet:i}),o.hook.validateMagnet(this,i,e)?(o.options.magnetThreshold<=0&&this.startConnectting(e,i,t,n),this.setEventData(e,{action:"magnet"}),this.stopPropagation(e)):((Dg(i,"x6-port-body")||jr()(i).closest(".x6-port-body").length>0)&&this.stopPropagation(e),this.onMouseDown(e,t,n)),o.view.delegateDragEvents(e,this)}startConnectting(e,t,n,i){this.graph.model.startBatch("add-edge");const o=this.createEdgeFromMagnet(t,n,i);o.notifyMouseDown(e,n,i),o.setEventData(e,o.prepareArrowheadDragging("target",{x:n,y:i,isNewEdge:!0,fallbackAction:"remove"})),this.setEventData(e,{edgeView:o})}createEdgeFromMagnet(e,t,n){const i=this.graph,o=i.model,s=i.hook.getDefaultEdge(this,e);return s.setSource(Object.assign(Object.assign({},s.getSource()),this.getEdgeTerminal(e,t,n,s,"source"))),s.setTarget(Object.assign(Object.assign({},s.getTarget()),{x:t,y:n})),s.addTo(o,{async:!1,ui:!0}),s.findView(i)}dragMagnet(e,t,n){const i=this.getEventData(e),o=i.edgeView;if(o)o.onMouseMove(e,t,n),this.autoScrollGraph(e.clientX,e.clientY);else{const s=this.graph,a=s.options.magnetThreshold,l=this.getEventTarget(e),c=i.targetMagnet;if(a==="onleave"){if(c===l||c.contains(l))return}else if(s.view.getMouseMovedCount(e)<=a)return;this.startConnectting(e,c,t,n)}}stopMagnetDragging(e,t,n){const o=this.eventData(e).edgeView;o&&(o.onMouseUp(e,t,n),this.graph.model.stopBatch("add-edge"))}notifyUnhandledMouseDown(e,t,n){this.notify("node:unhandled:mousedown",{e,x:t,y:n,view:this,cell:this.cell,node:this.cell})}notifyNodeMove(e,t,n,i,o){let s=[o];const a=this.graph.selection.widget;if(a&&a.options.movable){const l=this.graph.getSelectedCells();l.includes(o)&&(s=l.filter(c=>c.isNode()))}s.forEach(l=>{this.notify(e,{e:t,x:n,y:i,cell:l,node:l,view:l.findView(this.graph)})})}startNodeDragging(e,t,n){const i=this.getDelegatedView();if(i==null||!i.can("nodeMovable"))return this.notifyUnhandledMouseDown(e,t,n);this.setEventData(e,{targetView:i,action:"move"});const o=pe.create(i.cell.getPosition());i.setEventData(e,{moving:!1,offset:o.diff(t,n),restrict:this.graph.hook.getRestrictArea(i)})}dragNode(e,t,n){const i=this.cell,o=this.graph,s=o.getGridSize(),a=this.getEventData(e),l=a.offset,c=a.restrict;a.moving||(a.moving=!0,this.addClass("node-moving"),this.notifyNodeMove("node:move",e,t,n,this.cell)),this.autoScrollGraph(e.clientX,e.clientY);const u=ao.snapToGrid(t+l.x,s),d=ao.snapToGrid(n+l.y,s);i.setPosition(u,d,{restrict:c,deep:!0,ui:!0}),o.options.embedding.enabled&&(a.embedding||(this.prepareEmbedding(e),a.embedding=!0),this.processEmbedding(e,a))}stopNodeDragging(e,t,n){const i=this.getEventData(e);i.embedding&&this.finalizeEmbedding(e,i),i.moving&&(this.removeClass("node-moving"),this.notifyNodeMove("node:moved",e,t,n,this.cell)),i.moving=!1,i.embedding=!1}autoScrollGraph(e,t){const n=this.graph.scroller.widget;n&&n.autoScroll(e,t)}}(function(r){r.toStringTag=`X6.${r.name}`;function e(t){if(t==null)return!1;if(t instanceof r)return!0;const n=t[Symbol.toStringTag],i=t;return(n==null||n===r.toStringTag)&&typeof i.isNodeView=="function"&&typeof i.isEdgeView=="function"&&typeof i.confirmUpdate=="function"&&typeof i.update=="function"&&typeof i.findPortElem=="function"&&typeof i.resize=="function"&&typeof i.rotate=="function"&&typeof i.translate=="function"}r.isNodeView=e})(xo||(xo={})),xo.config({isSvgElement:!0,priority:0,bootstrap:["render"],actions:{view:["render"],markup:["render"],attrs:["update"],size:["resize","ports","tools"],angle:["rotate","tools"],position:["translate","tools"],ports:["ports"],tools:["tools"]}}),xo.registry.register("node",xo,!0);const BA=l1("text");class zA extends El("text",{view:BA,attrs:{text:{fontSize:18,fill:"#000000",stroke:null,refX:.5,refY:.5}}},{noText:!0}){}(function(r){class e extends xo{confirmUpdate(n,i={}){let o=super.confirmUpdate(n,i);return this.hasAction(o,"scale")&&(this.resize(),o=this.removeAction(o,"scale")),o}}r.View=e,e.config({actions:{attrs:["scale"]}}),xo.registry.register(BA,e)})(zA||(zA={}));class UA extends rs{constructor(e,t={}){super();this.length=0,this.comparator=t.comparator||"zIndex",this.clean(),e&&this.reset(e,{silent:!0})}toJSON(){return this.cells.map(e=>e.toJSON())}add(e,t,n){let i,o;typeof t=="number"?(i=t,o=Object.assign({merge:!1},n)):(i=this.length,o=Object.assign({merge:!1},t)),i>this.length&&(i=this.length),i<0&&(i+=this.length+1);const s=Array.isArray(e)?e:[e],a=this.comparator&&typeof t!="number"&&o.sort!==!1,l=this.comparator||null;let c=!1;const u=[],d=[];return s.forEach(h=>{const f=this.get(h);f?o.merge&&!h.isSameStore(f)&&(f.setProp(h.getProp(),n),d.push(f),a&&!c&&(l==null||typeof l=="function"?c=f.hasChanged():typeof l=="string"?c=f.hasChanged(l):c=l.some(p=>f.hasChanged(p)))):(u.push(h),this.reference(h))}),u.length&&(a&&(c=!0),this.cells.splice(i,0,...u),this.length=this.cells.length),c&&this.sort({silent:!0}),o.silent||(u.forEach((h,f)=>{const p={cell:h,index:i+f,options:o};this.trigger("added",p),o.dryrun||h.notify("added",Object.assign({},p))}),c&&this.trigger("sorted"),(u.length||d.length)&&this.trigger("updated",{added:u,merged:d,removed:[],options:o})),this}remove(e,t={}){const n=Array.isArray(e)?e:[e],i=this.removeCells(n,t);return!t.silent&&i.length>0&&this.trigger("updated",{options:t,removed:i,added:[],merged:[]}),Array.isArray(e)?i:i[0]}removeCells(e,t){const n=[];for(let i=0;i<e.length;i+=1){const o=this.get(e[i]);if(o==null)continue;const s=this.cells.indexOf(o);this.cells.splice(s,1),this.length-=1,delete this.map[o.id],n.push(o),this.unreference(o),t.dryrun||o.remove(),t.silent||(this.trigger("removed",{cell:o,index:s,options:t}),t.dryrun||o.notify("removed",{cell:o,index:s,options:t}))}return n}reset(e,t={}){const n=this.cells.slice();if(n.forEach(i=>this.unreference(i)),this.clean(),this.add(e,Object.assign({silent:!0},t)),!t.silent){const i=this.cells.slice();this.trigger("reseted",{options:t,previous:n,current:i});const o=[],s=[];i.forEach(a=>{n.some(c=>c.id===a.id)||o.push(a)}),n.forEach(a=>{i.some(c=>c.id===a.id)||s.push(a)}),this.trigger("updated",{options:t,added:o,removed:s,merged:[]})}return this}push(e,t){return this.add(e,this.length,t)}pop(e){const t=this.at(this.length-1);return this.remove(t,e)}unshift(e,t){return this.add(e,0,t)}shift(e){const t=this.at(0);return this.remove(t,e)}get(e){if(e==null)return null;const t=typeof e=="string"||typeof e=="number"?e:e.id;return this.map[t]||null}has(e){return this.get(e)!=null}at(e){return e<0&&(e+=this.length),this.cells[e]||null}first(){return this.at(0)}last(){return this.at(-1)}indexOf(e){return this.cells.indexOf(e)}toArray(){return this.cells.slice()}sort(e={}){return this.comparator!=null&&(this.cells=bg(this.cells,this.comparator),e.silent||this.trigger("sorted")),this}clone(){const e=this.constructor;return new e(this.cells.slice(),{comparator:this.comparator})}reference(e){this.map[e.id]=e,e.on("*",this.notifyCellEvent,this)}unreference(e){e.off("*",this.notifyCellEvent,this),delete this.map[e.id]}notifyCellEvent(e,t){const n=t.cell;this.trigger(`cell:${e}`,t),n&&(n.isNode()?this.trigger(`node:${e}`,Object.assign(Object.assign({},t),{node:n})):n.isEdge()&&this.trigger(`edge:${e}`,Object.assign(Object.assign({},t),{edge:n})))}clean(){this.length=0,this.cells=[],this.map={}}}class is extends rs{constructor(e=[]){super();this.batches={},this.addings=new WeakMap,this.nodes={},this.edges={},this.outgoings={},this.incomings={},this.collection=new UA(e),this.setup()}get[Symbol.toStringTag](){return is.toStringTag}notify(e,t){this.trigger(e,t);const n=this.graph;return n&&(e==="sorted"||e==="reseted"||e==="updated"?n.trigger(`model:${e}`,t):n.trigger(e,t)),this}setup(){const e=this.collection;e.on("sorted",()=>this.notify("sorted",null)),e.on("updated",t=>this.notify("updated",t)),e.on("cell:change:zIndex",()=>this.sortOnChangeZ()),e.on("added",({cell:t})=>{this.onCellAdded(t)}),e.on("removed",t=>{const n=t.cell;this.onCellRemoved(n,t.options),this.notify("cell:removed",t),n.isNode()?this.notify("node:removed",Object.assign(Object.assign({},t),{node:n})):n.isEdge()&&this.notify("edge:removed",Object.assign(Object.assign({},t),{edge:n}))}),e.on("reseted",t=>{this.onReset(t.current),this.notify("reseted",t)}),e.on("edge:change:source",({edge:t})=>this.onEdgeTerminalChanged(t,"source")),e.on("edge:change:target",({edge:t})=>{this.onEdgeTerminalChanged(t,"target")})}sortOnChangeZ(){this.collection.sort()}onCellAdded(e){const t=e.id;e.isEdge()?(e.updateParent(),this.edges[t]=!0,this.onEdgeTerminalChanged(e,"source"),this.onEdgeTerminalChanged(e,"target")):this.nodes[t]=!0}onCellRemoved(e,t){const n=e.id;if(e.isEdge()){delete this.edges[n];const i=e.getSource(),o=e.getTarget();if(i&&i.cell){const s=this.outgoings[i.cell],a=s?s.indexOf(n):-1;a>=0&&(s.splice(a,1),s.length===0&&delete this.outgoings[i.cell])}if(o&&o.cell){const s=this.incomings[o.cell],a=s?s.indexOf(n):-1;a>=0&&(s.splice(a,1),s.length===0&&delete this.incomings[o.cell])}}else delete this.nodes[n];t.clear||(t.disconnectEdges?this.disconnectConnectedEdges(e,t):this.removeConnectedEdges(e,t)),e.model===this&&(e.model=null)}onReset(e){this.nodes={},this.edges={},this.outgoings={},this.incomings={},e.forEach(t=>this.onCellAdded(t))}onEdgeTerminalChanged(e,t){const n=t==="source"?this.outgoings:this.incomings,i=e.previous(t);if(i&&i.cell){const s=Tr.isCell(i.cell)?i.cell.id:i.cell,a=n[s],l=a?a.indexOf(e.id):-1;l>=0&&(a.splice(l,1),a.length===0&&delete n[s])}const o=e.getTerminal(t);if(o&&o.cell){const s=Tr.isCell(o.cell)?o.cell.id:o.cell,a=n[s]||[];a.indexOf(e.id)===-1&&a.push(e.id),n[s]=a}}prepareCell(e,t){return!e.model&&(!t||!t.dryrun)&&(e.model=this),e.zIndex==null&&e.setZIndex(this.getMaxZIndex()+1,{silent:!0}),e}resetCells(e,t={}){return e.map(n=>this.prepareCell(n,Object.assign(Object.assign({},t),{dryrun:!0}))),this.collection.reset(e,t),e.map(n=>this.prepareCell(n,{options:t})),this}clear(e={}){const t=this.getCells();if(t.length===0)return this;const n=Object.assign(Object.assign({},e),{clear:!0});return this.batchUpdate("clear",()=>{const i=t.sort((o,s)=>{const a=o.isEdge()?1:2,l=s.isEdge()?1:2;return a-l});for(;i.length>0;){const o=i.shift();o&&o.remove(n)}},n),this}addNode(e,t={}){const n=ii.isNode(e)?e:this.createNode(e);return this.addCell(n,t),n}createNode(e){return ii.create(e)}addEdge(e,t={}){const n=Ai.isEdge(e)?e:this.createEdge(e);return this.addCell(n,t),n}createEdge(e){return Ai.create(e)}addCell(e,t={}){return Array.isArray(e)?this.addCells(e,t):(!this.collection.has(e)&&!this.addings.has(e)&&(this.addings.set(e,!0),this.collection.add(this.prepareCell(e,t),t),e.eachChild(n=>this.addCell(n,t)),this.addings.delete(e)),this)}addCells(e,t={}){const n=e.length;if(n===0)return this;const i=Object.assign(Object.assign({},t),{position:n-1,maxPosition:n-1});return this.startBatch("add",Object.assign(Object.assign({},i),{cells:e})),e.forEach(o=>{this.addCell(o,i),i.position-=1}),this.stopBatch("add",Object.assign(Object.assign({},i),{cells:e})),this}removeCell(e,t={}){const n=typeof e=="string"?this.getCell(e):e;return n&&this.has(n)?this.collection.remove(n,t):null}updateCellId(e,t){this.startBatch("update",{id:t}),e.prop("id",t);const n=e.clone({keepId:!0});return this.addCell(n),this.getConnectedEdges(e).forEach(o=>{const s=o.getSourceCell(),a=o.getTargetCell();s===e&&o.setSource(Object.assign(Object.assign({},o.getSource()),{cell:t})),a===e&&o.setTarget(Object.assign(Object.assign({},o.getTarget()),{cell:t}))}),this.removeCell(e),this.stopBatch("update",{id:t}),n}removeCells(e,t={}){return e.length?this.batchUpdate("remove",()=>e.map(n=>this.removeCell(n,t))):[]}removeConnectedEdges(e,t={}){const n=this.getConnectedEdges(e);return n.forEach(i=>{i.remove(t)}),n}disconnectConnectedEdges(e,t={}){const n=typeof e=="string"?e:e.id;this.getConnectedEdges(e).forEach(i=>{const o=i.getSourceCell(),s=i.getTargetCell();o&&o.id===n&&i.setSource({x:0,y:0},t),s&&s.id===n&&i.setTarget({x:0,y:0},t)})}has(e){return this.collection.has(e)}total(){return this.collection.length}indexOf(e){return this.collection.indexOf(e)}getCell(e){return this.collection.get(e)}getCells(){return this.collection.toArray()}getFirstCell(){return this.collection.first()}getLastCell(){return this.collection.last()}getMinZIndex(){const e=this.collection.first();return e&&e.getZIndex()||0}getMaxZIndex(){const e=this.collection.last();return e&&e.getZIndex()||0}getCellsFromCache(e){return e?Object.keys(e).map(t=>this.getCell(t)).filter(t=>t!=null):[]}getNodes(){return this.getCellsFromCache(this.nodes)}getEdges(){return this.getCellsFromCache(this.edges)}getOutgoingEdges(e){const t=typeof e=="string"?e:e.id,n=this.outgoings[t];return n?n.map(i=>this.getCell(i)).filter(i=>i&&i.isEdge()):null}getIncomingEdges(e){const t=typeof e=="string"?e:e.id,n=this.incomings[t];return n?n.map(i=>this.getCell(i)).filter(i=>i&&i.isEdge()):null}getConnectedEdges(e,t={}){const n=[],i=typeof e=="string"?this.getCell(e):e;if(i==null)return n;const o={},s=t.indirect;let a=t.incoming,l=t.outgoing;a==null&&l==null&&(a=l=!0);const c=(u,d)=>{const h=d?this.getOutgoingEdges(u):this.getIncomingEdges(u);if(h!=null&&h.forEach(f=>{o[f.id]||(n.push(f),o[f.id]=!0,s&&(a&&c(f,!1),l&&c(f,!0)))}),s&&u.isEdge()){const f=d?u.getTargetCell():u.getSourceCell();f&&f.isEdge()&&(o[f.id]||(n.push(f),c(f,d)))}};if(l&&c(i,!0),a&&c(i,!1),t.deep){const u=i.getDescendants({deep:!0}),d={};u.forEach(f=>{f.isNode()&&(d[f.id]=!0)});const h=(f,p)=>{const g=p?this.getOutgoingEdges(f.id):this.getIncomingEdges(f.id);g!=null&&g.forEach(v=>{if(!o[v.id]){const y=v.getSourceCell(),x=v.getTargetCell();if(!t.enclosed&&y&&d[y.id]&&x&&d[x.id])return;n.push(v),o[v.id]=!0}})};u.forEach(f=>{f.isEdge()||(l&&h(f,!0),a&&h(f,!1))})}return n}isBoundary(e,t){const n=typeof e=="string"?this.getCell(e):e,i=t?this.getIncomingEdges(n):this.getOutgoingEdges(n);return i==null||i.length===0}getBoundaryNodes(e){const t=[];return Object.keys(this.nodes).forEach(n=>{if(this.isBoundary(n,e)){const i=this.getCell(n);i&&t.push(i)}}),t}getRoots(){return this.getBoundaryNodes(!0)}getLeafs(){return this.getBoundaryNodes(!1)}isRoot(e){return this.isBoundary(e,!0)}isLeaf(e){return this.isBoundary(e,!1)}getNeighbors(e,t={}){let n=t.incoming,i=t.outgoing;n==null&&i==null&&(n=i=!0);const s=this.getConnectedEdges(e,t).reduce((a,l)=>{const c=l.hasLoop(t),u=l.getSourceCell(),d=l.getTargetCell();return n&&u&&u.isNode()&&!a[u.id]&&(c||u!==e&&(!t.deep||!u.isDescendantOf(e)))&&(a[u.id]=u),i&&d&&d.isNode()&&!a[d.id]&&(c||d!==e&&(!t.deep||!d.isDescendantOf(e)))&&(a[d.id]=d),a},{});if(e.isEdge()){if(n){const a=e.getSourceCell();a&&a.isNode()&&!s[a.id]&&(s[a.id]=a)}if(i){const a=e.getTargetCell();a&&a.isNode()&&!s[a.id]&&(s[a.id]=a)}}return Object.keys(s).map(a=>s[a])}isNeighbor(e,t,n={}){let i=n.incoming,o=n.outgoing;return i==null&&o==null&&(i=o=!0),this.getConnectedEdges(e,n).some(s=>{const a=s.getSourceCell(),l=s.getTargetCell();return!!(i&&a&&a.id===t.id||o&&l&&l.id===t.id)})}getSuccessors(e,t={}){const n=[];return this.search(e,(i,o)=>{i!==e&&this.matchDistance(o,t.distance)&&n.push(i)},Object.assign(Object.assign({},t),{outgoing:!0})),n}isSuccessor(e,t,n={}){let i=!1;return this.search(e,(o,s)=>{if(o===t&&o!==e&&this.matchDistance(s,n.distance))return i=!0,!1},Object.assign(Object.assign({},n),{outgoing:!0})),i}getPredecessors(e,t={}){const n=[];return this.search(e,(i,o)=>{i!==e&&this.matchDistance(o,t.distance)&&n.push(i)},Object.assign(Object.assign({},t),{incoming:!0})),n}isPredecessor(e,t,n={}){let i=!1;return this.search(e,(o,s)=>{if(o===t&&o!==e&&this.matchDistance(s,n.distance))return i=!0,!1},Object.assign(Object.assign({},n),{incoming:!0})),i}matchDistance(e,t){return t==null?!0:typeof t=="function"?t(e):Array.isArray(t)&&t.includes(e)?!0:e===t}getCommonAncestor(...e){const t=[];return e.forEach(n=>{n&&(Array.isArray(n)?t.push(...n):t.push(n))}),Tr.getCommonAncestor(...t)}getSubGraph(e,t={}){const n=[],i={},o=[],s=[],a=l=>{i[l.id]||(n.push(l),i[l.id]=l,l.isEdge()&&s.push(l),l.isNode()&&o.push(l))};return e.forEach(l=>{a(l),t.deep&&l.getDescendants({deep:!0}).forEach(u=>a(u))}),s.forEach(l=>{const c=l.getSourceCell(),u=l.getTargetCell();c&&!i[c.id]&&(n.push(c),i[c.id]=c,c.isNode()&&o.push(c)),u&&!i[u.id]&&(n.push(u),i[u.id]=u,u.isNode()&&o.push(u))}),o.forEach(l=>{this.getConnectedEdges(l,t).forEach(u=>{const d=u.getSourceCell(),h=u.getTargetCell();!i[u.id]&&d&&i[d.id]&&h&&i[h.id]&&(n.push(u),i[u.id]=u)})}),n}cloneSubGraph(e,t={}){const n=this.getSubGraph(e,t);return this.cloneCells(n)}cloneCells(e){return Tr.cloneCells(e)}getNodesFromPoint(e,t){const n=typeof e=="number"?{x:e,y:t||0}:e;return this.getNodes().filter(i=>i.getBBox().containsPoint(n))}getNodesInArea(e,t,n,i,o){const s=typeof e=="number"?new Ht(e,t,n,i):Ht.create(e),a=typeof e=="number"?o:t,l=a&&a.strict;return this.getNodes().filter(c=>{const u=c.getBBox();return l?s.containsRect(u):s.isIntersectWithRect(u)})}getEdgesInArea(e,t,n,i,o){const s=typeof e=="number"?new Ht(e,t,n,i):Ht.create(e),a=typeof e=="number"?o:t,l=a&&a.strict;return this.getEdges().filter(c=>{const u=c.getBBox();return u.width===0?u.inflate(1,0):u.height===0&&u.inflate(0,1),l?s.containsRect(u):s.isIntersectWithRect(u)})}getNodesUnderNode(e,t={}){const n=e.getBBox();return(t.by==null||t.by==="bbox"?this.getNodesInArea(n):this.getNodesFromPoint(n[t.by])).filter(o=>e.id!==o.id&&!o.isDescendantOf(e))}getAllCellsBBox(){return this.getCellsBBox(this.getCells())}getCellsBBox(e,t={}){return Tr.getCellsBBox(e,t)}search(e,t,n={}){n.breadthFirst?this.breadthFirstSearch(e,t,n):this.depthFirstSearch(e,t,n)}breadthFirstSearch(e,t,n={}){const i=[],o={},s={};for(i.push(e),s[e.id]=0;i.length>0;){const a=i.shift();if(a==null||o[a.id]||(o[a.id]=!0,dn(t,this,a,s[a.id])===!1))continue;this.getNeighbors(a,n).forEach(c=>{s[c.id]=s[a.id]+1,i.push(c)})}}depthFirstSearch(e,t,n={}){const i=[],o={},s={};for(i.push(e),s[e.id]=0;i.length>0;){const a=i.pop();if(a==null||o[a.id]||(o[a.id]=!0,dn(t,this,a,s[a.id])===!1))continue;const l=this.getNeighbors(a,n),c=i.length;l.forEach(u=>{s[u.id]=s[a.id]+1,i.splice(c,0,u)})}}getShortestPath(e,t,n={}){const i={};this.getEdges().forEach(c=>{const u=c.getSourceCellId(),d=c.getTargetCellId();u&&d&&(i[u]||(i[u]=[]),i[d]||(i[d]=[]),i[u].push(d),n.directed||i[d].push(u))});const o=typeof e=="string"?e:e.id,s=r1.run(i,o,n.weight),a=[];let l=typeof t=="string"?t:t.id;for(s[l]&&a.push(l);l=s[l];)a.unshift(l);return a}translate(e,t,n){return this.getCells().filter(i=>!i.hasParent()).forEach(i=>i.translate(e,t,n)),this}resize(e,t,n){return this.resizeCells(e,t,this.getCells(),n)}resizeCells(e,t,n,i={}){const o=this.getCellsBBox(n);if(o){const s=Math.max(e/o.width,0),a=Math.max(t/o.height,0),l=o.getOrigin();n.forEach(c=>c.scale(s,a,l,i))}return this}toJSON(e={}){return is.toJSON(this.getCells(),e)}parseJSON(e){return is.fromJSON(e)}fromJSON(e,t={}){const n=this.parseJSON(e);return this.resetCells(n,t),this}startBatch(e,t={}){return this.batches[e]=(this.batches[e]||0)+1,this.notify("batch:start",{name:e,data:t}),this}stopBatch(e,t={}){return this.batches[e]=(this.batches[e]||0)-1,this.notify("batch:stop",{name:e,data:t}),this}batchUpdate(e,t,n={}){this.startBatch(e,n);const i=t();return this.stopBatch(e,n),i}hasActiveBatch(e=Object.keys(this.batches)){return(Array.isArray(e)?e:[e]).some(n=>this.batches[n]>0)}}(function(r){r.toStringTag=`X6.${r.name}`;function e(t){if(t==null)return!1;if(t instanceof r)return!0;const n=t[Symbol.toStringTag],i=t;return(n==null||n===r.toStringTag)&&typeof i.addNode=="function"&&typeof i.addEdge=="function"&&i.collection!=null}r.isModel=e})(is||(is={})),function(r){function e(n,i={}){return{cells:n.map(o=>o.toJSON(i))}}r.toJSON=e;function t(n){const i=[];return Array.isArray(n)?i.push(...n):(n.cells&&i.push(...n.cells),n.nodes&&n.nodes.forEach(o=>{o.shape==null&&(o.shape="rect"),i.push(o)}),n.edges&&n.edges.forEach(o=>{o.shape==null&&(o.shape="edge"),i.push(o)})),i.map(o=>{const s=o.shape;if(s){if(ii.registry.exist(s))return ii.create(o);if(Ai.registry.exist(s))return Ai.create(o)}throw new Error("The `shape` should be specified when creating a node/edge instance")})}r.fromJSON=t}(is||(is={}));const Sl=".text-block-content",my=l1("text-block");class vy extends ii{get content(){return this.getContent()}set content(e){this.setContent(e)}getContent(){return this.store.get("content","")}setContent(e,t={}){this.store.set("content",e,t)}setup(){super.setup(),this.store.on("change:*",e=>{const t=e.key;t==="content"?this.updateContent(this.getContent()):t==="size"&&this.updateSize(this.getSize())}),this.updateSize(this.getSize()),this.updateContent(this.getContent())}updateSize(e){_i.SUPPORT_FOREIGNOBJECT&&this.setAttrs({foreignObject:Object.assign({},e),[Sl]:{style:Object.assign({},e)}})}updateContent(e){_i.SUPPORT_FOREIGNOBJECT?this.setAttrs({[Sl]:{html:e?WS(e):""}}):this.setAttrs({[Sl]:{text:e}})}}(function(r){r.config({type:my,view:my,markup:['<g class="rotatable">','<g class="scalable"><rect/></g>',_i.SUPPORT_FOREIGNOBJECT?["<foreignObject>",'<body xmlns="http://www.w3.org/1999/xhtml">',`<div class="${Sl.substr(1)}" />`,"</body>","</foreignObject>"].join(""):`<text class="${Sl.substr(1)}"/>`,"</g>"].join(""),attrs:{".":{fill:"#ffffff",stroke:"none"},rect:{fill:"#ffffff",stroke:"#000000",width:80,height:100},text:{fill:"#000000",fontSize:14,fontFamily:"Arial, helvetica, sans-serif"},body:{style:{background:"transparent",position:"static",margin:0,padding:0}},foreignObject:{style:{overflow:"hidden"}},[Sl]:{refX:.5,refY:.5,yAlign:"middle",xAlign:"middle",style:{textAlign:"center",verticalAlign:"middle",display:"table-cell",padding:"0 5px",margin:0}}}}),ii.registry.register(my,r)})(vy||(vy={})),function(r){const e="content";class t extends xo{confirmUpdate(i,o={}){let s=super.confirmUpdate(i,o);return this.hasAction(s,e)&&(this.updateContent(),s=this.removeAction(s,e)),s}update(i){if(_i.SUPPORT_FOREIGNOBJECT)super.update(i);else{const o=this.cell,s=Object.assign({},i||o.getAttrs());delete s[Sl],super.update(s),(!i||Jc(i,Sl))&&this.updateContent(i)}}updateContent(i){if(_i.SUPPORT_FOREIGNOBJECT)super.update(i);else{const o=this.cell,s=(i||o.getAttrs())[Sl],a=b_(o.getContent(),o.getSize(),s,{svgDocument:this.graph.view.svg}),l={[Sl]:ir({},s,{text:a})};super.update(l)}}}r.View=t,function(n){n.config({bootstrap:["render",e],actions:_i.SUPPORT_FOREIGNOBJECT?{}:{size:e,content:e}}),xo.registry.register(my,n)}(t=r.View||(r.View={}))}(vy||(vy={}));const Uee=Xo.define({shape:"empty"});function lU(r,e="body"){return[{tagName:r,selector:e},{tagName:"text",selector:"label"}]}function fc(r,e,t={}){const n={constructorName:r,markup:lU(r,t.selector),attrs:{[r]:Object.assign({},Xo.bodyAttr)}};return(t.parent||Xo).define(ir(n,e,{shape:r}))}const Vee=fc("rect",{attrs:{body:{refWidth:"100%",refHeight:"100%"}}}),jee=ii.define({shape:"rect-headered",markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerText"},{tagName:"text",selector:"bodyText"}],attrs:{body:Object.assign(Object.assign({},Xo.bodyAttr),{refWidth:"100%",refHeight:"100%"}),header:Object.assign(Object.assign({},Xo.bodyAttr),{refWidth:"100%",height:30,stroke:"#000000"}),headerText:Object.assign(Object.assign({},Xo.labelAttr),{refX:"50%",refY:15,fontSize:16}),bodyText:Object.assign(Object.assign({},Xo.labelAttr),{refY2:15})}}),Hee=fc("circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%"}}}),c1=10,$ee=Xo.define({shape:"cylinder",overwrite:!0,markup:[{tagName:"path",selector:"body"},{tagName:"ellipse",selector:"top"},{tagName:"text",selector:"label"}],attrs:{body:Object.assign(Object.assign({},Xo.bodyAttr),{lateral:c1}),top:Object.assign(Object.assign({},Xo.bodyAttr),{refCx:"50%",refRx:"50%",cy:c1,ry:c1})},attrHooks:{lateral:{set(r,{refBBox:e}){const t=yl(r);t&&(r=parseFloat(r)/100);const n=e.x,i=e.y,o=e.width,s=e.height,a=o/2,l=t?s*r:r,c=.551784,u=c*a,d=c*l,h=n,f=n+o/2,p=n+o,g=i+l,v=g-l,y=i+s-l,x=i+s;return{d:["M",h,g,"L",h,y,"C",n,y+d,f-u,x,f,x,"C",f+u,x,p,y+d,p,y,"L",p,g,"C",p,g-d,f+u,v,f,v,"C",f-u,v,h,g-d,h,g,"Z"].join(" ")}}}},knob:{enabled:!0,position({node:r}){const e=r.attr("body/lateral");return{x:0,y:e}},onMouseMove({node:r,data:e,deltaY:t}){if(t!==0){const n=r.getBBox(),i=r.attr("body/lateral");e.round==null&&(e.round=i);const o=0,s=n.height/2,a=ws(e.round+t,o,s);a!==i&&r.attr({body:{lateral:a},top:{cy:a,ry:a}})}}}}),Wee=fc("ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}}});var cU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Lf extends Xo{get points(){return this.getPoints()}set points(e){this.setPoints(e)}getPoints(){return this.getAttrByPath("body/refPoints")}setPoints(e,t){return e==null?this.removePoints():this.setAttrByPath("body/refPoints",Lf.pointsToString(e),t),this}removePoints(){return this.removeAttrByPath("body/refPoints"),this}}(function(r){function e(t){return typeof t=="string"?t:t.map(n=>Array.isArray(n)?n.join(","):pe.isPointLike(n)?`${n.x}, ${n.y}`:"").join(" ")}r.pointsToString=e,r.config({propHooks(t){const{points:n}=t,i=cU(t,["points"]);if(n){const o=e(n);o&&df(i,"attrs/body/refPoints",o)}return i}})})(Lf||(Lf={}));const Zee=fc("polygon",{},{parent:Lf}),Xee=fc("polyline",{},{parent:Lf});var uU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const Yee=Xo.define({shape:"path",markup:[{tagName:"rect",selector:"bg"},{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}],attrs:{bg:{refWidth:"100%",refHeight:"100%",fill:"none",stroke:"none",pointerEvents:"all"},body:{fill:"none",stroke:"#000",strokeWidth:2}},propHooks(r){const{path:e}=r,t=uU(r,["path"]);return e&&df(t,"attrs/body/refD",e),t}});var dU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const Kee=Xo.define({shape:"text-block",markup:[{tagName:"rect",selector:"body"},_i.SUPPORT_FOREIGNOBJECT?{tagName:"foreignObject",selector:"foreignObject",children:[{tagName:"div",ns:qi.xhtml,selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attrs:{textAnchor:"middle"}}],attrs:{body:Object.assign(Object.assign({},Xo.bodyAttr),{refWidth:"100%",refHeight:"100%"}),foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}},propHooks(r){const{text:e}=r,t=dU(r,["text"]);return e&&df(t,"attrs/label/text",e),t},attrHooks:{text:{set(r,{cell:e,view:t,refBBox:n,elem:i,attrs:o}){if(i instanceof HTMLElement)i.textContent=r;else{const s=o.style||{},a={text:r,width:-5,height:"100%"},l=Object.assign({textVerticalAnchor:"middle"},s),c=Cl.presets.textWrap;return dn(c.set,this,a,{cell:e,view:t,elem:i,refBBox:n,attrs:l}),{fill:s.color||null}}},position(r,{refBBox:e,elem:t}){if(t instanceof SVGElement)return e.getCenter()}}}}),qee=fc("image",{attrs:{image:{refWidth:"100%",refHeight:"100%"}},propHooks:Kg()},{selector:"image"}),Jee=fc("image-bordered",{markup:[{tagName:"rect",selector:"background",attrs:{stroke:"none"}},{tagName:"image",selector:"image"},{tagName:"rect",selector:"border",attrs:{fill:"none"}},{tagName:"text",selector:"label"}],attrs:{background:{refWidth:-1,refHeight:-1,x:.5,y:.5,fill:"#ffffff"},border:{refWidth:"100%",refHeight:"100%",stroke:"#333333",strokeWidth:2},image:{refWidth:-1,refHeight:-1,x:.5,y:.5}},propHooks:Kg()}),Qee=fc("image-embedded",{markup:[{tagName:"rect",selector:"body"},{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}],attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#333333",fill:"#FFFFFF",strokeWidth:2},image:{refWidth:"30%",refHeight:-20,x:10,y:10,preserveAspectRatio:"xMidYMin"}},propHooks:Kg()}),ete=fc("image-inscribed",{propHooks:Kg(),markup:[{tagName:"ellipse",selector:"background"},{tagName:"image",selector:"image"},{tagName:"ellipse",selector:"border",attrs:{fill:"none"}},{tagName:"text",selector:"label"}],attrs:{border:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",stroke:"#333333",strokeWidth:2},background:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",fill:"#ffffff"},image:{refWidth:"68%",refHeight:"68%",refX:"16%",refY:"16%",preserveAspectRatio:"xMidYMid"}}}),_l=Ai.define({shape:"edge",markup:[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}],attrs:{lines:{connection:!0,strokeLinejoin:"round"},wrap:{strokeWidth:10},line:{stroke:"#333",strokeWidth:2,targetMarker:"classic"}}}),tte=Ai.define({shape:"shadow-edge",markup:[{tagName:"path",selector:"shadow",attrs:{fill:"none"}},{tagName:"path",selector:"line",attrs:{fill:"none",cursor:"pointer"}}],attrs:{line:{connection:!0,stroke:"#FF0000",strokeWidth:20,strokeLinejoin:"round",targetMarker:{name:"path",stroke:"none",d:"M 0 -10 -10 0 0 10 z",offsetX:-5},sourceMarker:{name:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z",offsetX:-5}},shadow:{connection:!0,refX:3,refY:6,stroke:"#000000",strokeOpacity:.2,strokeWidth:20,strokeLinejoin:"round",targetMarker:{name:"path",d:"M 0 -10 -10 0 0 10 z",stroke:"none",offsetX:-5},sourceMarker:{name:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z",offsetX:-5}}}}),nte=Ai.define({shape:"double-edge",markup:[{tagName:"path",selector:"outline",attrs:{fill:"none"}},{tagName:"path",selector:"line",attrs:{fill:"none",cursor:"pointer"}}],attrs:{line:{connection:!0,stroke:"#dddddd",strokeWidth:4,strokeLinejoin:"round",targetMarker:{tagName:"path",stroke:"#000000",d:"M 10 -3 10 -10 -2 0 10 10 10 3"}},outline:{connection:!0,stroke:"#000000",strokeWidth:6,strokeLinejoin:"round"}}});class Al extends Xo{get html(){return this.getHTML()}set html(e){this.setHTML(e)}getHTML(){return this.store.get("html")}setHTML(e,t={}){return e==null?this.removeHTML(t):this.store.set("html",e,t),this}removeHTML(e={}){return this.store.remove("html",e)}}(function(r){class e extends xo{init(){super.init(),this.cell.on("change:*",()=>{this.graph.hook.shouldUpdateHTMLComponent(this.cell)&&this.renderHTMLComponent()})}confirmUpdate(n){const i=super.confirmUpdate(n);return this.handleAction(i,e.action,()=>this.renderHTMLComponent())}renderHTMLComponent(){const n=this.selectors.foContent;if(n){const i=this.$(n).empty(),o=this.graph.hook.getHTMLComponent(this.cell);o&&(typeof o=="string"?i.html(o):i.append(o))}}}r.View=e,function(t){t.action="html",t.config({bootstrap:[t.action],actions:{html:t.action}}),xo.registry.register("html-view",t)}(e=r.View||(r.View={}))})(Al||(Al={})),function(r){r.config({view:"html-view",markup:[{tagName:"rect",selector:"body"},Object.assign({},Ur.getForeignObjectMarkup()),{tagName:"text",selector:"label"}],attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}}}),ii.registry.register("html",r)}(Al||(Al={})),function(r){r.componentRegistry=Qi.create({type:"html componnet"})}(Al||(Al={}));var hU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class qg extends cA{constructor(e){super();this.delay=10,this.throttle=2,this.threshold=5,this.changeCount=0,this.timestamp=0,this.options=Object.assign(Object.assign({},qg.defaultOptions),e),this.graph.model.on("cell:change:*",this.onModelChanged,this)}get graph(){return this.options.graph}onModelChanged(){if(this.disabled)return;const t=(new Date().getTime()-this.timestamp)/1e3;t>this.delay||this.changeCount>=this.threshold&&t>this.throttle?(this.save(),this.reset()):this.changeCount+=1}save(){this.trigger("save")}reset(){this.changeCount=0,this.timestamp=new Date().getTime()}dispose(){this.graph.model.off("cell:change:*",this.onModelChanged,this)}}hU([cA.dispose()],qg.prototype,"dispose",null),function(r){r.defaultOptions={delay:10,throttle:2,threshold:5}}(qg||(qg={}));class hi extends ka{constructor(e){super();this.graph=e,this.init()}get options(){return this.graph.options}get model(){return this.graph.model}get view(){return this.graph.view}init(){}}var fU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class Ia extends Fr{constructor(e){super();this.graph=e;const{selectors:t,fragment:n}=Ur.parseJSONMarkup(Ia.markup);this.background=t.background,this.grid=t.grid,this.svg=t.svg,this.defs=t.defs,this.viewport=t.viewport,this.primer=t.primer,this.stage=t.stage,this.decorator=t.decorator,this.overlay=t.overlay,this.container=this.options.container,this.restore=Ia.snapshoot(this.container),this.$(this.container).addClass(this.prefixClassName("graph")).append(n),this.delegateEvents()}get model(){return this.graph.model}get options(){return this.graph.options}delegateEvents(){const e=this.constructor;return super.delegateEvents(e.events),this}guard(e,t){return e.type==="mousedown"&&e.button===2||this.options.guard&&this.options.guard(e,t)?!0:e.data&&e.data.guarded!==void 0?e.data.guarded:!(t&&t.cell&&Tr.isCell(t.cell)||this.svg===e.target||this.container===e.target||jr().contains(this.svg,e.target))}findView(e){return this.graph.renderer.findViewByElem(e)}onDblClick(e){this.options.preventDefaultDblClick&&e.preventDefault();const t=this.normalizeEvent(e),n=this.findView(t.target);if(this.guard(t,n))return;const i=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onDblClick(t,i.x,i.y):this.graph.trigger("blank:dblclick",{e:t,x:i.x,y:i.y})}onClick(e){if(this.getMouseMovedCount(e)<=this.options.clickThreshold){const t=this.normalizeEvent(e),n=this.findView(t.target);if(this.guard(t,n))return;const i=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onClick(t,i.x,i.y):this.graph.trigger("blank:click",{e:t,x:i.x,y:i.y})}}isPreventDefaultContextMenu(e,t){let n=this.options.preventDefaultContextMenu;return typeof n=="function"&&(n=dn(n,this.graph,{view:t})),n}onContextMenu(e){const t=this.normalizeEvent(e),n=this.findView(t.target);if(this.isPreventDefaultContextMenu(t,n)&&e.preventDefault(),this.guard(t,n))return;const i=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onContextMenu(t,i.x,i.y):this.graph.trigger("blank:contextmenu",{e:t,x:i.x,y:i.y})}delegateDragEvents(e,t){e.data==null&&(e.data={}),this.setEventData(e,{currentView:t||null,mouseMovedCount:0,startPosition:{x:e.clientX,y:e.clientY}});const n=this.constructor;this.delegateDocumentEvents(n.documentEvents,e.data),this.undelegateEvents()}getMouseMovedCount(e){return this.getEventData(e).mouseMovedCount||0}onMouseDown(e){const t=this.normalizeEvent(e),n=this.findView(t.target);if(this.guard(t,n))return;this.options.preventDefaultMouseDown&&t.preventDefault();const i=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onMouseDown(t,i.x,i.y):(this.options.preventDefaultBlankAction&&["touchstart"].includes(t.type)&&t.preventDefault(),this.graph.trigger("blank:mousedown",{e:t,x:i.x,y:i.y})),this.delegateDragEvents(t,n)}onMouseMove(e){const t=this.getEventData(e),n=t.startPosition;if(n&&n.x===e.clientX&&n.y===e.clientY||(t.mouseMovedCount==null&&(t.mouseMovedCount=0),t.mouseMovedCount+=1,t.mouseMovedCount<=this.options.moveThreshold))return;const o=this.normalizeEvent(e),s=this.graph.snapToGrid(o.clientX,o.clientY),a=t.currentView;a?a.onMouseMove(o,s.x,s.y):this.graph.trigger("blank:mousemove",{e:o,x:s.x,y:s.y}),this.setEventData(o,t)}onMouseUp(e){this.undelegateDocumentEvents();const t=this.normalizeEvent(e),n=this.graph.snapToGrid(t.clientX,t.clientY),o=this.getEventData(e).currentView;o?o.onMouseUp(t,n.x,n.y):this.graph.trigger("blank:mouseup",{e:t,x:n.x,y:n.y}),e.isPropagationStopped()||this.onClick(jr().Event(e,{type:"click",data:e.data})),e.stopImmediatePropagation(),this.delegateEvents()}onMouseOver(e){const t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n))if(n)n.onMouseOver(t);else{if(this.container===t.target)return;this.graph.trigger("blank:mouseover",{e:t})}}onMouseOut(e){const t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n))if(n)n.onMouseOut(t);else{if(this.container===t.target)return;this.graph.trigger("blank:mouseout",{e:t})}}onMouseEnter(e){const t=this.normalizeEvent(e),n=this.findView(t.target);if(this.guard(t,n))return;const i=this.graph.renderer.findViewByElem(t.relatedTarget);if(n){if(i===n)return;n.onMouseEnter(t)}else{if(i)return;this.graph.trigger("graph:mouseenter",{e:t})}}onMouseLeave(e){const t=this.normalizeEvent(e),n=this.findView(t.target);if(this.guard(t,n))return;const i=this.graph.renderer.findViewByElem(t.relatedTarget);if(n){if(i===n)return;n.onMouseLeave(t)}else{if(i)return;this.graph.trigger("graph:mouseleave",{e:t})}}onMouseWheel(e){const t=this.normalizeEvent(e),n=this.findView(t.target);if(this.guard(t,n))return;const i=t.originalEvent,o=this.graph.snapToGrid(i.clientX,i.clientY),s=Math.max(-1,Math.min(1,i.wheelDelta||-i.detail));n?n.onMouseWheel(t,o.x,o.y,s):this.graph.trigger("blank:mousewheel",{e:t,delta:s,x:o.x,y:o.y})}onCustomEvent(e){const t=e.currentTarget,n=t.getAttribute("event")||t.getAttribute("data-event");if(n){const i=this.findView(t);if(i){const o=this.normalizeEvent(e);if(this.guard(o,i))return;const s=this.graph.snapToGrid(o.clientX,o.clientY);i.onCustomEvent(o,n,s.x,s.y)}}}handleMagnetEvent(e,t){const n=e.currentTarget,i=n.getAttribute("magnet");if(i&&i.toLowerCase()!=="false"){const o=this.findView(n);if(o){const s=this.normalizeEvent(e);if(this.guard(s,o))return;const a=this.graph.snapToGrid(s.clientX,s.clientY);dn(t,this.graph,o,s,n,a.x,a.y)}}}onMagnetMouseDown(e){this.handleMagnetEvent(e,(t,n,i,o,s)=>{t.onMagnetMouseDown(n,i,o,s)})}onMagnetDblClick(e){this.handleMagnetEvent(e,(t,n,i,o,s)=>{t.onMagnetDblClick(n,i,o,s)})}onMagnetContextMenu(e){const t=this.normalizeEvent(e),n=this.findView(t.target);this.isPreventDefaultContextMenu(t,n)&&t.preventDefault(),this.handleMagnetEvent(t,(i,o,s,a,l)=>{i.onMagnetContextMenu(o,s,a,l)})}onLabelMouseDown(e){const t=e.currentTarget,n=this.findView(t);if(n){const i=this.normalizeEvent(e);if(this.guard(i,n))return;const o=this.graph.snapToGrid(i.clientX,i.clientY);n.onLabelMouseDown(i,o.x,o.y)}}onImageDragStart(){return!1}dispose(){this.undelegateEvents(),this.undelegateDocumentEvents(),this.restore(),this.restore=()=>{}}}fU([Fr.dispose()],Ia.prototype,"dispose",null),function(r){const e=`${ea.prefixCls}-graph`;r.markup=[{ns:qi.xhtml,tagName:"div",selector:"background",className:`${e}-background`},{ns:qi.xhtml,tagName:"div",selector:"grid",className:`${e}-grid`},{ns:qi.svg,tagName:"svg",selector:"svg",className:`${e}-svg`,attrs:{width:"100%",height:"100%","xmlns:xlink":qi.xlink},children:[{tagName:"defs",selector:"defs"},{tagName:"g",selector:"viewport",className:`${e}-svg-viewport`,children:[{tagName:"g",selector:"primer",className:`${e}-svg-primer`},{tagName:"g",selector:"stage",className:`${e}-svg-stage`},{tagName:"g",selector:"decorator",className:`${e}-svg-decorator`},{tagName:"g",selector:"overlay",className:`${e}-svg-overlay`}]}]}];function t(n){const i=n.cloneNode();return n.childNodes.forEach(o=>i.appendChild(o)),()=>{for(IC(n);n.attributes.length>0;)n.removeAttribute(n.attributes[0].name);for(let o=0,s=i.attributes.length;o<s;o+=1){const a=i.attributes[o];n.setAttribute(a.name,a.value)}i.childNodes.forEach(o=>n.appendChild(o))}}r.snapshoot=t}(Ia||(Ia={})),function(r){const e=ea.prefixCls;r.events={dblclick:"onDblClick",contextmenu:"onContextMenu",touchstart:"onMouseDown",mousedown:"onMouseDown",mouseover:"onMouseOver",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousewheel:"onMouseWheel",DOMMouseScroll:"onMouseWheel",[`mouseenter  .${e}-cell`]:"onMouseEnter",[`mouseleave  .${e}-cell`]:"onMouseLeave",[`mouseenter  .${e}-cell-tools`]:"onMouseEnter",[`mouseleave  .${e}-cell-tools`]:"onMouseLeave",[`mousedown   .${e}-cell [event]`]:"onCustomEvent",[`touchstart  .${e}-cell [event]`]:"onCustomEvent",[`mousedown   .${e}-cell [data-event]`]:"onCustomEvent",[`touchstart  .${e}-cell [data-event]`]:"onCustomEvent",[`dblclick    .${e}-cell [magnet]`]:"onMagnetDblClick",[`contextmenu .${e}-cell [magnet]`]:"onMagnetContextMenu",[`mousedown   .${e}-cell [magnet]`]:"onMagnetMouseDown",[`touchstart  .${e}-cell [magnet]`]:"onMagnetMouseDown",[`dblclick    .${e}-cell [data-magnet]`]:"onMagnetDblClick",[`contextmenu .${e}-cell [data-magnet]`]:"onMagnetContextMenu",[`mousedown   .${e}-cell [data-magnet]`]:"onMagnetMouseDown",[`touchstart  .${e}-cell [data-magnet]`]:"onMagnetMouseDown",[`dragstart   .${e}-cell image`]:"onImageDragStart",[`mousedown   .${e}-edge .${e}-edge-label`]:"onLabelMouseDown",[`touchstart  .${e}-edge .${e}-edge-label`]:"onLabelMouseDown"},r.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}}(Ia||(Ia={}));var xa;(function(r){function e(t,n){return(i,o,s)=>{const a=s.value;s.value=function(...l){if(this.scroller.widget==null){const u=`Shoule enable scroller to use method '${o}'`;if(t!==!1)throw console.error(u),new Error(u);return n!==!1&&console.warn(u),this}return a.call(this,...l)}}}r.checkScroller=e})(xa||(xa={}));const pU=`.x6-graph {
  position: relative;
  outline: none;
  touch-action: none;
}
.x6-graph-background,
.x6-graph-grid,
.x6-graph-svg {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}
.x6-graph-background-stage,
.x6-graph-grid-stage,
.x6-graph-svg-stage {
  user-select: none;
}
.x6-graph.x6-graph-pannable {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}
.x6-graph.x6-graph-panning {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
  user-select: none;
}
.x6-node {
  cursor: move;
  /* stylelint-disable-next-line */
}
.x6-node.x6-node-immovable {
  cursor: default;
}
.x6-node * {
  -webkit-user-drag: none;
}
.x6-node .scalable * {
  vector-effect: non-scaling-stroke;
}
.x6-node [magnet='true'] {
  cursor: crosshair;
  transition: opacity 0.3s;
}
.x6-node [magnet='true']:hover {
  opacity: 0.7;
}
.x6-node foreignObject {
  display: block;
  overflow: visible;
  background-color: transparent;
}
.x6-node foreignObject > body {
  position: static;
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: visible;
  background-color: transparent;
}
.x6-edge .source-marker,
.x6-edge .target-marker {
  vector-effect: non-scaling-stroke;
}
.x6-edge .connection {
  stroke-linejoin: round;
  fill: none;
}
.x6-edge .connection-wrap {
  cursor: move;
  opacity: 0;
  fill: none;
  stroke: #000;
  stroke-width: 15;
  stroke-linecap: round;
  stroke-linejoin: round;
}
.x6-edge .connection-wrap:hover {
  opacity: 0.4;
  stroke-opacity: 0.4;
}
.x6-edge .vertices {
  cursor: move;
  opacity: 0;
}
.x6-edge .vertices .vertex {
  fill: #1abc9c;
}
.x6-edge .vertices .vertex :hover {
  fill: #34495e;
  stroke: none;
}
.x6-edge .vertices .vertex-remove {
  cursor: pointer;
  fill: #fff;
}
.x6-edge .vertices .vertex-remove-area {
  cursor: pointer;
  opacity: 0.1;
}
.x6-edge .vertices .vertex-group:hover .vertex-remove-area {
  opacity: 1;
}
.x6-edge .arrowheads {
  cursor: move;
  opacity: 0;
}
.x6-edge .arrowheads .arrowhead {
  fill: #1abc9c;
}
.x6-edge .arrowheads .arrowhead :hover {
  fill: #f39c12;
  stroke: none;
}
.x6-edge .tools {
  cursor: pointer;
  opacity: 0;
}
.x6-edge .tools .tool-options {
  display: none;
}
.x6-edge .tools .tool-remove circle {
  fill: #f00;
}
.x6-edge .tools .tool-remove path {
  fill: #fff;
}
.x6-edge:hover .vertices,
.x6-edge:hover .arrowheads,
.x6-edge:hover .tools {
  opacity: 1;
}
.x6-highlight-opacity {
  opacity: 0.3;
}
@keyframes halo-pie-visibility {
  0% {
    visibility: hidden;
  }
  100% {
    visibility: visible;
  }
}
@keyframes halo-pie-opening {
  0% {
    transform: scale(0.4) rotate(-20deg);
  }
  100% {
    transform: scale(1) rotate(0);
  }
}
.x6-widget-handle {
  position: absolute;
  width: 20px;
  height: 20px;
  background-color: transparent;
  background-repeat: no-repeat;
  background-position: 0 0;
  background-size: 20px 20px;
  cursor: pointer;
  user-select: none;
  pointer-events: auto;
  -webkit-user-drag: none;
  user-drag: none;
  /* stylelint-disable-line */
}
.x6-widget-handle.hidden {
  display: none;
}
.x6-widget-handle-selected {
  background-color: rgba(0, 0, 0, 0.1);
  border-radius: 3px;
}
.x6-widget-handle-remove {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M15.386%2C3.365c-3.315-3.314-8.707-3.313-12.021%2C0c-3.314%2C3.315-3.314%2C8.706%2C0%2C12.02%20c3.314%2C3.314%2C8.707%2C3.314%2C12.021%2C0S18.699%2C6.68%2C15.386%2C3.365L15.386%2C3.365z%20M4.152%2C14.598C1.273%2C11.719%2C1.273%2C7.035%2C4.153%2C4.154%20c2.88-2.88%2C7.563-2.88%2C10.443%2C0c2.881%2C2.88%2C2.881%2C7.562%2C0%2C10.443C11.716%2C17.477%2C7.032%2C17.477%2C4.152%2C14.598L4.152%2C14.598z%22%2F%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M12.157%2C11.371L7.38%2C6.593C7.162%2C6.375%2C6.809%2C6.375%2C6.592%2C6.592c-0.218%2C0.219-0.218%2C0.572%2C0%2C0.79%20l4.776%2C4.776c0.218%2C0.219%2C0.571%2C0.219%2C0.79%2C0C12.375%2C11.941%2C12.375%2C11.588%2C12.157%2C11.371L12.157%2C11.371z%22%2F%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M11.369%2C6.593l-4.777%2C4.778c-0.217%2C0.217-0.217%2C0.568%2C0%2C0.787c0.219%2C0.219%2C0.571%2C0.217%2C0.788%2C0l4.777-4.777%20c0.218-0.218%2C0.218-0.571%2C0.001-0.789C11.939%2C6.375%2C11.587%2C6.375%2C11.369%2C6.593L11.369%2C6.593z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');
  cursor: pointer;
}
.x6-widget-handle-remove:hover {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M15.386%2C3.365c-3.315-3.314-8.707-3.313-12.021%2C0c-3.314%2C3.315-3.314%2C8.706%2C0%2C12.02%20c3.314%2C3.314%2C8.707%2C3.314%2C12.021%2C0S18.699%2C6.68%2C15.386%2C3.365L15.386%2C3.365z%22%2F%3E%3Cpath%20fill%3D%22%23FFFFFF%22%20d%3D%22M12.157%2C11.371L7.38%2C6.593C7.162%2C6.375%2C6.809%2C6.375%2C6.592%2C6.592c-0.218%2C0.219-0.218%2C0.572%2C0%2C0.79%20l4.776%2C4.776c0.218%2C0.219%2C0.571%2C0.219%2C0.79%2C0C12.375%2C11.941%2C12.375%2C11.588%2C12.157%2C11.371L12.157%2C11.371z%22%2F%3E%3Cpath%20fill%3D%22%23FFFFFF%22%20d%3D%22M11.369%2C6.593l-4.777%2C4.778c-0.217%2C0.217-0.217%2C0.568%2C0%2C0.787c0.219%2C0.219%2C0.571%2C0.217%2C0.788%2C0l4.777-4.777%20c0.218-0.218%2C0.218-0.571%2C0.001-0.789C11.939%2C6.375%2C11.587%2C6.375%2C11.369%2C6.593L11.369%2C6.593z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');
}
.x6-widget-handle-rotate {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M9.374%2C17.592c-4.176%2C0-7.57-3.401-7.57-7.575c0-4.175%2C3.395-7.574%2C7.57-7.574c0.28%2C0%2C0.56%2C0.018%2C0.837%2C0.05%20V1.268c0-0.158%2C0.099-0.3%2C0.239-0.36c0.151-0.058%2C0.315-0.026%2C0.428%2C0.086l2.683%2C2.688c0.152%2C0.154%2C0.152%2C0.399%2C0%2C0.553l-2.68%2C2.693%20c-0.115%2C0.112-0.279%2C0.147-0.431%2C0.087c-0.141-0.063-0.239-0.205-0.239-0.361V5.296C9.934%2C5.243%2C9.654%2C5.22%2C9.374%2C5.22%20c-2.646%2C0-4.796%2C2.152-4.796%2C4.797s2.154%2C4.798%2C4.796%2C4.798c2.645%2C0%2C4.798-2.153%2C4.798-4.798c0-0.214%2C0.174-0.391%2C0.391-0.391h1.991%20c0.217%2C0%2C0.394%2C0.177%2C0.394%2C0.391C16.947%2C14.19%2C13.549%2C17.592%2C9.374%2C17.592L9.374%2C17.592z%20M9.374%2C17.592%22%2F%3E%3C%2Fsvg%3E%20');
  cursor: move;
}
.x6-widget-handle-rotate:hover {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M9.374%2C17.592c-4.176%2C0-7.57-3.401-7.57-7.575c0-4.175%2C3.395-7.574%2C7.57-7.574c0.28%2C0%2C0.56%2C0.018%2C0.837%2C0.05%20V1.268c0-0.158%2C0.099-0.3%2C0.239-0.36c0.151-0.058%2C0.315-0.026%2C0.428%2C0.086l2.683%2C2.688c0.152%2C0.154%2C0.152%2C0.399%2C0%2C0.553l-2.68%2C2.693%20c-0.115%2C0.112-0.279%2C0.147-0.431%2C0.087c-0.141-0.063-0.239-0.205-0.239-0.361V5.296C9.934%2C5.243%2C9.654%2C5.22%2C9.374%2C5.22%20c-2.646%2C0-4.796%2C2.152-4.796%2C4.797s2.154%2C4.798%2C4.796%2C4.798c2.645%2C0%2C4.798-2.153%2C4.798-4.798c0-0.214%2C0.174-0.391%2C0.391-0.391h1.991%20c0.217%2C0%2C0.394%2C0.177%2C0.394%2C0.391C16.947%2C14.19%2C13.549%2C17.592%2C9.374%2C17.592L9.374%2C17.592z%20M9.374%2C17.592%22%2F%3E%3C%2Fsvg%3E%20');
}
.x6-widget-handle-resize {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3Csvg%20height%3D%2224px%22%20version%3D%221.1%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224px%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Asketch%3D%22http%3A%2F%2Fwww.bohemiancoding.com%2Fsketch%2Fns%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Ctitle%2F%3E%3Cdesc%2F%3E%3Cdefs%2F%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%20id%3D%22miu%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%3E%3Cg%20id%3D%22Artboard-1%22%20transform%3D%22translate(-251.000000%2C%20-443.000000)%22%3E%3Cg%20id%3D%22slice%22%20transform%3D%22translate(215.000000%2C%20119.000000)%22%2F%3E%3Cpath%20d%3D%22M252%2C448%20L256%2C448%20L256%2C444%20L252%2C444%20L252%2C448%20Z%20M257%2C448%20L269%2C448%20L269%2C446%20L257%2C446%20L257%2C448%20Z%20M257%2C464%20L269%2C464%20L269%2C462%20L257%2C462%20L257%2C464%20Z%20M270%2C444%20L270%2C448%20L274%2C448%20L274%2C444%20L270%2C444%20Z%20M252%2C462%20L252%2C466%20L256%2C466%20L256%2C462%20L252%2C462%20Z%20M270%2C462%20L270%2C466%20L274%2C466%20L274%2C462%20L270%2C462%20Z%20M254%2C461%20L256%2C461%20L256%2C449%20L254%2C449%20L254%2C461%20Z%20M270%2C461%20L272%2C461%20L272%2C449%20L270%2C449%20L270%2C461%20Z%22%20fill%3D%22%236A6C8A%22%20id%3D%22editor-crop-glyph%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E');
  cursor: se-resize;
}
.x6-widget-handle-resize:hover {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3Csvg%20height%3D%2224px%22%20version%3D%221.1%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224px%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Asketch%3D%22http%3A%2F%2Fwww.bohemiancoding.com%2Fsketch%2Fns%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Ctitle%2F%3E%3Cdesc%2F%3E%3Cdefs%2F%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%20id%3D%22miu%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%3E%3Cg%20id%3D%22Artboard-1%22%20transform%3D%22translate(-251.000000%2C%20-443.000000)%22%3E%3Cg%20id%3D%22slice%22%20transform%3D%22translate(215.000000%2C%20119.000000)%22%2F%3E%3Cpath%20d%3D%22M252%2C448%20L256%2C448%20L256%2C444%20L252%2C444%20L252%2C448%20Z%20M257%2C448%20L269%2C448%20L269%2C446%20L257%2C446%20L257%2C448%20Z%20M257%2C464%20L269%2C464%20L269%2C462%20L257%2C462%20L257%2C464%20Z%20M270%2C444%20L270%2C448%20L274%2C448%20L274%2C444%20L270%2C444%20Z%20M252%2C462%20L252%2C466%20L256%2C466%20L256%2C462%20L252%2C462%20Z%20M270%2C462%20L270%2C466%20L274%2C466%20L274%2C462%20L270%2C462%20Z%20M254%2C461%20L256%2C461%20L256%2C449%20L254%2C449%20L254%2C461%20Z%20M270%2C461%20L272%2C461%20L272%2C449%20L270%2C449%20L270%2C461%20Z%22%20fill%3D%22%23FD6EB6%22%20id%3D%22editor-crop-glyph%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E');
}
.x6-widget-handle-clone {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M12.852%2C0.875h-9.27c-0.853%2C0-1.547%2C0.694-1.547%2C1.547v10.816h1.547V2.422h9.27V0.875z%20M15.172%2C3.965h-8.5%20c-0.849%2C0-1.547%2C0.698-1.547%2C1.547v10.816c0%2C0.849%2C0.698%2C1.547%2C1.547%2C1.547h8.5c0.85%2C0%2C1.543-0.698%2C1.543-1.547V5.512%20C16.715%2C4.663%2C16.021%2C3.965%2C15.172%2C3.965L15.172%2C3.965z%20M15.172%2C16.328h-8.5V5.512h8.5V16.328z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');
  cursor: move;
}
.x6-widget-handle-clone:hover {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M12.852%2C0.875h-9.27c-0.853%2C0-1.547%2C0.694-1.547%2C1.547v10.816h1.547V2.422h9.27V0.875z%20M15.172%2C3.965h-8.5%20c-0.849%2C0-1.547%2C0.698-1.547%2C1.547v10.816c0%2C0.849%2C0.698%2C1.547%2C1.547%2C1.547h8.5c0.849%2C0%2C1.543-0.698%2C1.543-1.547V5.512%20C16.715%2C4.663%2C16.021%2C3.965%2C15.172%2C3.965L15.172%2C3.965z%20M15.172%2C16.328h-8.5V5.512h8.5V16.328z%20M15.172%2C16.328%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');
}
.x6-widget-handle-link {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M9.884%2C9.838c0.54-0.551%2C1.005-0.955%2C1.384-1.201c0.463-0.308%2C0.749-0.352%2C0.887-0.352h1.34v1.367%20c0%2C0.104%2C0.061%2C0.2%2C0.154%2C0.242s0.204%2C0.027%2C0.284-0.038l3.168-2.669c0.06-0.051%2C0.096-0.125%2C0.096-0.203S17.16%2C6.83%2C17.101%2C6.781%20l-3.168-2.677c-0.08-0.067-0.19-0.081-0.284-0.038c-0.094%2C0.045-0.154%2C0.139-0.154%2C0.242v1.414h-1.343%20c-1.24%2C0.014-2.215%2C0.67-2.927%2C1.242c-0.797%2C0.65-1.533%2C1.447-2.245%2C2.217c-0.361%2C0.391-0.7%2C0.759-1.044%2C1.1%20c-0.541%2C0.549-1.011%2C0.951-1.395%2C1.199c-0.354%2C0.231-0.678%2C0.357-0.921%2C0.357h-1.8c-0.146%2C0-0.266%2C0.12-0.266%2C0.265v2.029%20c0%2C0.148%2C0.12%2C0.268%2C0.266%2C0.268h1.8l0%2C0c1.255-0.014%2C2.239-0.667%2C2.958-1.24c0.82-0.661%2C1.572-1.475%2C2.297-2.256%20C9.225%2C10.524%2C9.555%2C10.169%2C9.884%2C9.838z%22%2F%3E%3C%2Fsvg%3E%20');
  cursor: move;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}
.x6-widget-handle-link:hover {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M9.884%2C9.838c0.54-0.551%2C1.005-0.955%2C1.384-1.201c0.463-0.308%2C0.749-0.352%2C0.887-0.352h1.34v1.367%20c0%2C0.104%2C0.061%2C0.2%2C0.154%2C0.242s0.204%2C0.027%2C0.284-0.038l3.168-2.669c0.06-0.051%2C0.096-0.125%2C0.096-0.203S17.16%2C6.83%2C17.101%2C6.781%20l-3.168-2.677c-0.08-0.067-0.19-0.081-0.284-0.038c-0.094%2C0.045-0.154%2C0.139-0.154%2C0.242v1.414h-1.343%20c-1.24%2C0.014-2.215%2C0.67-2.927%2C1.242c-0.797%2C0.65-1.533%2C1.447-2.245%2C2.217c-0.361%2C0.391-0.7%2C0.759-1.044%2C1.1%20c-0.541%2C0.549-1.011%2C0.951-1.395%2C1.199c-0.354%2C0.231-0.678%2C0.357-0.921%2C0.357h-1.8c-0.146%2C0-0.266%2C0.12-0.266%2C0.265v2.029%20c0%2C0.148%2C0.12%2C0.268%2C0.266%2C0.268h1.8l0%2C0c1.255-0.014%2C2.239-0.667%2C2.958-1.24c0.82-0.661%2C1.572-1.475%2C2.297-2.256%20C9.225%2C10.524%2C9.555%2C10.169%2C9.884%2C9.838z%22%2F%3E%3C%2Fsvg%3E%20');
}
.x6-widget-handle-fork {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cg%3E%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20fill%3D%22%236A6C8A%22%20d%3D%22M13.307%2C11.593c-0.69%2C0-1.299%2C0.33-1.693%2C0.835l-4.136-2.387%20C7.552%2C9.82%2C7.602%2C9.589%2C7.602%2C9.344c0-0.25-0.051-0.487-0.129-0.71l4.097-2.364c0.393%2C0.536%2C1.022%2C0.888%2C1.737%2C0.888%20c1.193%2C0%2C2.16-0.967%2C2.16-2.159s-0.967-2.159-2.16-2.159c-1.191%2C0-2.158%2C0.967-2.158%2C2.159c0%2C0.076%2C0.014%2C0.149%2C0.021%2C0.223%20L6.848%2C7.716C6.469%2C7.39%2C5.982%2C7.185%2C5.442%2C7.185c-1.191%2C0-2.158%2C0.967-2.158%2C2.159s0.967%2C2.159%2C2.158%2C2.159%20c0.545%2C0%2C1.037-0.208%2C1.417-0.541l4.319%2C2.493c-0.014%2C0.098-0.029%2C0.194-0.029%2C0.296c0%2C1.193%2C0.967%2C2.159%2C2.158%2C2.159%20c1.193%2C0%2C2.16-0.966%2C2.16-2.159C15.467%2C12.559%2C14.5%2C11.593%2C13.307%2C11.593z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');
  cursor: move;
}
.x6-widget-handle-fork:hover {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cg%3E%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20fill%3D%22%23FD6EB6%22%20d%3D%22M13.307%2C11.593c-0.69%2C0-1.299%2C0.33-1.693%2C0.835l-4.136-2.387%20c0.075-0.22%2C0.125-0.452%2C0.125-0.697c0-0.25-0.051-0.487-0.129-0.71l4.097-2.365c0.394%2C0.536%2C1.022%2C0.888%2C1.737%2C0.888%20c1.193%2C0%2C2.16-0.967%2C2.16-2.159s-0.967-2.159-2.16-2.159c-1.191%2C0-2.158%2C0.967-2.158%2C2.159c0%2C0.076%2C0.015%2C0.148%2C0.022%2C0.223%20L6.848%2C7.716C6.469%2C7.39%2C5.981%2C7.185%2C5.442%2C7.185c-1.191%2C0-2.158%2C0.967-2.158%2C2.159s0.967%2C2.159%2C2.158%2C2.159%20c0.545%2C0%2C1.037-0.208%2C1.417-0.541l4.319%2C2.493c-0.013%2C0.098-0.029%2C0.194-0.029%2C0.296c0%2C1.193%2C0.967%2C2.159%2C2.158%2C2.159%20c1.193%2C0%2C2.16-0.966%2C2.16-2.159C15.467%2C12.559%2C14.5%2C11.593%2C13.307%2C11.593z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');
}
.x6-widget-handle-unlink {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cg%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M12.285%2C9.711l-2.104-0.302L9.243%2C8.568L6.669%2C7.095C6.948%2C6.6%2C6.995%2C6.026%2C6.845%2C5.474%20c-0.191-0.698-0.695-1.36-1.438-1.786C4.068%2C2.922%2C2.464%2C3.214%2C1.82%2C4.338C1.536%2C4.836%2C1.489%2C5.414%2C1.64%2C5.97%20c0.189%2C0.698%2C0.694%2C1.36%2C1.438%2C1.787c0.328%2C0.187%2C0.67%2C0.31%2C1.01%2C0.372c0.002%2C0%2C0.006%2C0.002%2C0.008%2C0.004%20c0.027%2C0.004%2C0.057%2C0.009%2C0.088%2C0.011c2.12%2C0.316%2C3.203%2C0.915%2C3.73%2C1.337c-0.527%2C0.424-1.61%2C1.021-3.731%2C1.339%20c-0.029%2C0.003-0.058%2C0.007-0.087%2C0.012c-0.002%2C0.002-0.004%2C0.002-0.007%2C0.003c-0.341%2C0.062-0.684%2C0.187-1.013%2C0.374%20c-0.74%2C0.425-1.246%2C1.089-1.437%2C1.787c-0.149%2C0.555-0.105%2C1.133%2C0.181%2C1.632c0.011%2C0.018%2C0.021%2C0.033%2C0.033%2C0.049l0.883%2C0.783%20c0.765%2C0.366%2C1.775%2C0.328%2C2.67-0.184c0.744-0.425%2C1.248-1.088%2C1.439-1.786c0.148-0.552%2C0.104-1.126-0.176-1.62l2.573-1.473%20c0.573%2C0.287%2C2.299%2C1.292%2C2.299%2C1.292s3.602%2C1.445%2C4.241%2C1.812c0.773%2C0.191%2C0.566-0.151%2C0.566-0.151L12.285%2C9.711z%20M5.571%2C6.482%20C5.279%2C6.993%2C4.425%2C7.076%2C3.705%2C6.664C3.282%2C6.424%2C2.966%2C6.039%2C2.856%2C5.64C2.81%2C5.464%2C2.778%2C5.203%2C2.917%2C4.963%20c0.291-0.51%2C1.146-0.593%2C1.866-0.182C5.21%2C5.027%2C5.521%2C5.4%2C5.632%2C5.807C5.679%2C5.98%2C5.708%2C6.242%2C5.571%2C6.482z%20M5.632%2C13.159%20c-0.111%2C0.406-0.422%2C0.778-0.848%2C1.025c-0.719%2C0.409-1.576%2C0.327-1.867-0.184c-0.137-0.239-0.106-0.499-0.06-0.676%20c0.108-0.398%2C0.426-0.781%2C0.847-1.022c0.72-0.412%2C1.574-0.329%2C1.866%2C0.181C5.708%2C12.723%2C5.679%2C12.983%2C5.632%2C13.159z%20M16.181%2C5.139%20c-0.448%2C0.258-4.435%2C1.9-4.435%2C1.9s-1.556%2C0.855-2.104%2C1.13l0.937%2C0.843l2.057-0.229l4.11-3.638%20C16.745%2C5.146%2C17.013%2C4.664%2C16.181%2C5.139z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');
}
.x6-widget-handle-unlink:hover {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cg%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M12.285%2C9.711l-2.104-0.302L9.243%2C8.568L6.669%2C7.095C6.948%2C6.6%2C6.995%2C6.026%2C6.845%2C5.474%20c-0.191-0.698-0.695-1.36-1.438-1.786C4.068%2C2.922%2C2.464%2C3.214%2C1.82%2C4.338C1.536%2C4.836%2C1.489%2C5.414%2C1.64%2C5.97%20c0.189%2C0.698%2C0.694%2C1.36%2C1.438%2C1.787c0.328%2C0.187%2C0.67%2C0.31%2C1.01%2C0.372c0.002%2C0%2C0.006%2C0.002%2C0.008%2C0.004%20c0.027%2C0.004%2C0.057%2C0.009%2C0.088%2C0.011c2.12%2C0.316%2C3.203%2C0.915%2C3.73%2C1.337c-0.527%2C0.424-1.61%2C1.021-3.731%2C1.339%20c-0.029%2C0.003-0.058%2C0.007-0.087%2C0.012c-0.002%2C0.002-0.004%2C0.002-0.007%2C0.003c-0.341%2C0.062-0.684%2C0.187-1.013%2C0.374%20c-0.74%2C0.425-1.246%2C1.089-1.437%2C1.787c-0.149%2C0.555-0.105%2C1.133%2C0.181%2C1.632c0.011%2C0.018%2C0.021%2C0.033%2C0.033%2C0.049l0.883%2C0.783%20c0.765%2C0.366%2C1.775%2C0.328%2C2.67-0.184c0.744-0.425%2C1.248-1.088%2C1.439-1.786c0.148-0.552%2C0.104-1.126-0.176-1.62l2.573-1.473%20c0.573%2C0.287%2C2.299%2C1.292%2C2.299%2C1.292s3.602%2C1.445%2C4.241%2C1.812c0.773%2C0.191%2C0.566-0.151%2C0.566-0.151L12.285%2C9.711z%20M5.571%2C6.482%20C5.279%2C6.993%2C4.425%2C7.076%2C3.705%2C6.664C3.282%2C6.424%2C2.966%2C6.039%2C2.856%2C5.64C2.81%2C5.464%2C2.778%2C5.203%2C2.917%2C4.963%20c0.291-0.51%2C1.146-0.593%2C1.866-0.182C5.21%2C5.027%2C5.521%2C5.4%2C5.632%2C5.807C5.679%2C5.98%2C5.708%2C6.242%2C5.571%2C6.482z%20M5.632%2C13.159%20c-0.111%2C0.406-0.422%2C0.778-0.848%2C1.025c-0.719%2C0.409-1.576%2C0.327-1.867-0.184c-0.137-0.239-0.106-0.499-0.06-0.676%20c0.108-0.398%2C0.426-0.781%2C0.847-1.022c0.72-0.412%2C1.574-0.329%2C1.866%2C0.181C5.708%2C12.723%2C5.679%2C12.983%2C5.632%2C13.159z%20M16.181%2C5.139%20c-0.448%2C0.258-4.435%2C1.9-4.435%2C1.9s-1.556%2C0.855-2.104%2C1.13l0.937%2C0.843l2.057-0.229l4.11-3.638%20C16.745%2C5.146%2C17.013%2C4.664%2C16.181%2C5.139z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');
}
.x6-widget-handle-direction {
  background-image: url("data:image/svg+xml;charset=UTF-8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3C!DOCTYPE%20svg%20%20PUBLIC%20'-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN'%20%20'http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd'%3E%3Csvg%20id%3D%22Layer_1%22%20style%3D%22enable-background%3Anew%200%200%20512%20512%3B%22%20version%3D%221.1%22%20viewBox%3D%220%200%20512%20512%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%0A%09.st0%7Bfill%3A%236A6C8A%3Bstroke%3A%236A6C8A%3Bstroke-width%3A30%7D%0A%09.dot%7Bfill%3A%236A6C8A%3B%7D%0A%3C%2Fstyle%3E%3Cg%3E%3Cg%20id%3D%22XMLID_475_%22%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M133.1%2C277.1c1.8%2C0%2C3.7-0.6%2C5.4-1.7c4.1-3%2C5-8.7%2C2-12.8c-3-4.1-8.7-5-12.8-2c0%2C0%2C0%2C0%2C0%2C0%20%20%20%20%20c-4.1%2C3-5%2C8.7-2%2C12.8C127.5%2C275.8%2C130.3%2C277.1%2C133.1%2C277.1z%22%20id%3D%22XMLID_489_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M138.5%2C359.6c-4.1-3-9.8-2.1-12.8%2C2c-3%2C4.1-2.1%2C9.8%2C2%2C12.8c1.6%2C1.2%2C3.5%2C1.7%2C5.4%2C1.7%20%20%20%20%20c2.8%2C0%2C5.6-1.3%2C7.4-3.7C143.5%2C368.3%2C142.6%2C362.6%2C138.5%2C359.6z%22%20id%3D%22XMLID_726_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M108.1%2C327.7c-4.8%2C1.6-7.4%2C6.7-5.9%2C11.5c1.3%2C3.9%2C4.8%2C6.3%2C8.7%2C6.3c0.9%2C0%2C1.9-0.1%2C2.8-0.4%20%20%20%20%20c4.8-1.6%2C7.4-6.7%2C5.9-11.5C118%2C328.8%2C112.9%2C326.2%2C108.1%2C327.7z%22%20id%3D%22XMLID_776_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M108.1%2C307.3c0.9%2C0.3%2C1.9%2C0.4%2C2.8%2C0.4c3.8%2C0%2C7.4-2.4%2C8.7-6.3c1.6-4.8-1.1-9.9-5.9-11.5%20%20%20%20%20c-4.8-1.6-9.9%2C1.1-11.5%2C5.9C100.7%2C300.6%2C103.3%2C305.7%2C108.1%2C307.3z%22%20id%3D%22XMLID_777_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M169.2%2C265.4c2.4%2C0%2C4.7-1%2C6.5-2.6c1.7-1.7%2C2.7-4.1%2C2.7-6.5c0-2.4-1-4.8-2.7-6.5%20%20%20%20%20c-1.7-1.7-4.1-2.7-6.5-2.7s-4.7%2C1-6.5%2C2.7c-1.7%2C1.7-2.7%2C4-2.7%2C6.5c0%2C2.4%2C1%2C4.7%2C2.7%2C6.5C164.4%2C264.4%2C166.8%2C265.4%2C169.2%2C265.4z%22%20id%3D%22XMLID_797_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M247.7%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C243.7%2C265.4%2C247.7%2C261.3%2C247.7%2C256.3z%22%20id%3D%22XMLID_798_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M213%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C208.9%2C265.4%2C213%2C261.3%2C213%2C256.3z%22%20id%3D%22XMLID_799_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M317.2%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C313.1%2C265.4%2C317.2%2C261.3%2C317.2%2C256.3z%22%20id%3D%22XMLID_800_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M282.5%2C256.3c0-5-4.1-9.1-9.1-9.1s-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20S282.5%2C261.3%2C282.5%2C256.3z%22%20id%3D%22XMLID_801_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M401.1%2C185.2c0.9%2C0%2C1.9-0.1%2C2.8-0.5c4.8-1.6%2C7.4-6.7%2C5.9-11.5c-1.6-4.8-6.7-7.4-11.5-5.8%20%20%20%20%20c-4.8%2C1.6-7.4%2C6.7-5.8%2C11.5C393.6%2C182.8%2C397.2%2C185.2%2C401.1%2C185.2z%22%20id%3D%22XMLID_802_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M403.9%2C205.2c-4.8-1.6-9.9%2C1-11.5%2C5.9l0%2C0c-1.6%2C4.8%2C1.1%2C9.9%2C5.9%2C11.5%20%20%20%20%20c0.9%2C0.3%2C1.9%2C0.5%2C2.8%2C0.5c3.9%2C0%2C7.4-2.5%2C8.7-6.3c0%2C0%2C0%2C0%2C0%2C0C411.3%2C211.9%2C408.7%2C206.8%2C403.9%2C205.2z%22%20id%3D%22XMLID_803_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M373.5%2C237.2L373.5%2C237.2c-4.1%2C3-5%2C8.7-2%2C12.8c1.8%2C2.4%2C4.6%2C3.7%2C7.4%2C3.7%20%20%20%20%20c1.8%2C0%2C3.7-0.6%2C5.4-1.8c4.1-3%2C4.9-8.7%2C2-12.8C383.3%2C235.1%2C377.6%2C234.2%2C373.5%2C237.2z%22%20id%3D%22XMLID_804_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M373.5%2C152.9c1.6%2C1.2%2C3.5%2C1.8%2C5.4%2C1.8c2.8%2C0%2C5.6-1.3%2C7.4-3.8c3-4.1%2C2.1-9.8-2-12.7%20%20%20%20%20c-4.1-3-9.8-2.1-12.7%2C2C368.5%2C144.2%2C369.4%2C149.9%2C373.5%2C152.9z%22%20id%3D%22XMLID_805_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M342.8%2C247.1c-2.4%2C0-4.8%2C1-6.5%2C2.7c-1.7%2C1.7-2.7%2C4-2.7%2C6.5c0%2C2.4%2C1%2C4.7%2C2.7%2C6.4%20%20%20%20%20c1.7%2C1.7%2C4%2C2.7%2C6.5%2C2.7c2.4%2C0%2C4.7-1%2C6.5-2.7c1.7-1.7%2C2.7-4%2C2.7-6.4c0-2.4-1-4.8-2.7-6.5C347.6%2C248.1%2C345.2%2C247.1%2C342.8%2C247.1z%22%20id%3D%22XMLID_806_%22%2F%3E%0A%3Cpath%20class%3D%22st0%22%20d%3D%22M342.8%2C124.7H206.6l36.4-36.4c3.6-3.6%2C3.6-9.3%2C0-12.9c-3.6-3.6-9.3-3.6-12.9%2C0l-51.5%2C51.5%20%20%20%20%20c-1.9%2C1.9-2.8%2C4.4-2.7%2C6.9c-0.1%2C2.5%2C0.7%2C5%2C2.7%2C6.9l51.5%2C51.5c1.8%2C1.8%2C4.1%2C2.7%2C6.5%2C2.7c2.3%2C0%2C4.7-0.9%2C6.5-2.7%20%20%20%20%20c3.6-3.6%2C3.6-9.3%2C0-12.9l-36.4-36.4h136.1c0%2C0%2C0.1%2C0%2C0.1%2C0c0.6%2C0%2C1.2-0.1%2C1.8-0.2c0.2%2C0%2C0.4-0.1%2C0.6-0.1c0.1%2C0%2C0.2%2C0%2C0.3-0.1%20%20%20%20%20c3.2-1%2C5.6-3.6%2C6.3-6.9c0.1-0.6%2C0.2-1.2%2C0.2-1.8c0-0.6-0.1-1.2-0.2-1.8C351%2C127.8%2C347.3%2C124.7%2C342.8%2C124.7z%22%20id%3D%22XMLID_807_%22%2F%3E%0A%3Cpath%20class%3D%22st0%22%20d%3D%22M322.1%2C371.3l-51.5-51.5c-3.6-3.6-9.3-3.6-12.9%2C0c-3.6%2C3.6-3.6%2C9.3%2C0%2C12.9l36.9%2C36.9H169.2%20%20%20%20%20c-2.8%2C0-5.4%2C1.3-7%2C3.3c-0.1%2C0.1-0.2%2C0.2-0.3%2C0.4c-0.1%2C0.1-0.2%2C0.2-0.2%2C0.3c-0.1%2C0.1-0.1%2C0.2-0.2%2C0.4c-0.1%2C0.1-0.2%2C0.3-0.2%2C0.4%20%20%20%20%20c0%2C0.1-0.1%2C0.2-0.1%2C0.2c-0.1%2C0.2-0.2%2C0.4-0.3%2C0.6c0%2C0%2C0%2C0%2C0%2C0.1c-0.4%2C1.1-0.7%2C2.2-0.7%2C3.4c0%2C1.5%2C0.4%2C2.9%2C1%2C4.2c0%2C0%2C0%2C0.1%2C0.1%2C0.1%20%20%20%20%20c0.1%2C0.1%2C0.1%2C0.2%2C0.2%2C0.3c0.4%2C0.7%2C0.9%2C1.3%2C1.4%2C1.8c0.4%2C0.4%2C0.7%2C0.7%2C1.2%2C1c0.1%2C0.1%2C0.1%2C0.1%2C0.2%2C0.2c0%2C0%2C0.1%2C0%2C0.1%2C0.1%20%20%20%20%20c1.4%2C0.9%2C3.1%2C1.5%2C5%2C1.5h124.4l-36%2C36c-3.6%2C3.6-3.6%2C9.3%2C0%2C12.9c1.8%2C1.8%2C4.1%2C2.7%2C6.5%2C2.7c2.3%2C0%2C4.7-0.9%2C6.5-2.7l51.5-51.5%20%20%20%20%20c1.9-1.9%2C2.8-4.4%2C2.7-6.9C324.8%2C375.7%2C324%2C373.2%2C322.1%2C371.3z%22%20id%3D%22XMLID_808_%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E");
}
.x6-widget-handle-direction:hover {
  background-image: url("data:image/svg+xml;charset=UTF-8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3C!DOCTYPE%20svg%20%20PUBLIC%20'-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN'%20%20'http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd'%3E%3Csvg%20id%3D%22Layer_1%22%20style%3D%22enable-background%3Anew%200%200%20512%20512%3B%22%20version%3D%221.1%22%20viewBox%3D%220%200%20512%20512%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%0A%09.st0%7Bfill%3A%23FD6EB6%3Bstroke%3A%23FD6EB6%3Bstroke-width%3A30%7D%0A%09.dot%7Bfill%3A%23FD6EB6%3B%7D%0A%3C%2Fstyle%3E%3Cg%3E%3Cg%20id%3D%22XMLID_475_%22%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M133.1%2C277.1c1.8%2C0%2C3.7-0.6%2C5.4-1.7c4.1-3%2C5-8.7%2C2-12.8c-3-4.1-8.7-5-12.8-2c0%2C0%2C0%2C0%2C0%2C0%20%20%20%20%20c-4.1%2C3-5%2C8.7-2%2C12.8C127.5%2C275.8%2C130.3%2C277.1%2C133.1%2C277.1z%22%20id%3D%22XMLID_489_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M138.5%2C359.6c-4.1-3-9.8-2.1-12.8%2C2c-3%2C4.1-2.1%2C9.8%2C2%2C12.8c1.6%2C1.2%2C3.5%2C1.7%2C5.4%2C1.7%20%20%20%20%20c2.8%2C0%2C5.6-1.3%2C7.4-3.7C143.5%2C368.3%2C142.6%2C362.6%2C138.5%2C359.6z%22%20id%3D%22XMLID_726_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M108.1%2C327.7c-4.8%2C1.6-7.4%2C6.7-5.9%2C11.5c1.3%2C3.9%2C4.8%2C6.3%2C8.7%2C6.3c0.9%2C0%2C1.9-0.1%2C2.8-0.4%20%20%20%20%20c4.8-1.6%2C7.4-6.7%2C5.9-11.5C118%2C328.8%2C112.9%2C326.2%2C108.1%2C327.7z%22%20id%3D%22XMLID_776_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M108.1%2C307.3c0.9%2C0.3%2C1.9%2C0.4%2C2.8%2C0.4c3.8%2C0%2C7.4-2.4%2C8.7-6.3c1.6-4.8-1.1-9.9-5.9-11.5%20%20%20%20%20c-4.8-1.6-9.9%2C1.1-11.5%2C5.9C100.7%2C300.6%2C103.3%2C305.7%2C108.1%2C307.3z%22%20id%3D%22XMLID_777_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M169.2%2C265.4c2.4%2C0%2C4.7-1%2C6.5-2.6c1.7-1.7%2C2.7-4.1%2C2.7-6.5c0-2.4-1-4.8-2.7-6.5%20%20%20%20%20c-1.7-1.7-4.1-2.7-6.5-2.7s-4.7%2C1-6.5%2C2.7c-1.7%2C1.7-2.7%2C4-2.7%2C6.5c0%2C2.4%2C1%2C4.7%2C2.7%2C6.5C164.4%2C264.4%2C166.8%2C265.4%2C169.2%2C265.4z%22%20id%3D%22XMLID_797_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M247.7%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C243.7%2C265.4%2C247.7%2C261.3%2C247.7%2C256.3z%22%20id%3D%22XMLID_798_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M213%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C208.9%2C265.4%2C213%2C261.3%2C213%2C256.3z%22%20id%3D%22XMLID_799_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M317.2%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C313.1%2C265.4%2C317.2%2C261.3%2C317.2%2C256.3z%22%20id%3D%22XMLID_800_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M282.5%2C256.3c0-5-4.1-9.1-9.1-9.1s-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20S282.5%2C261.3%2C282.5%2C256.3z%22%20id%3D%22XMLID_801_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M401.1%2C185.2c0.9%2C0%2C1.9-0.1%2C2.8-0.5c4.8-1.6%2C7.4-6.7%2C5.9-11.5c-1.6-4.8-6.7-7.4-11.5-5.8%20%20%20%20%20c-4.8%2C1.6-7.4%2C6.7-5.8%2C11.5C393.6%2C182.8%2C397.2%2C185.2%2C401.1%2C185.2z%22%20id%3D%22XMLID_802_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M403.9%2C205.2c-4.8-1.6-9.9%2C1-11.5%2C5.9l0%2C0c-1.6%2C4.8%2C1.1%2C9.9%2C5.9%2C11.5%20%20%20%20%20c0.9%2C0.3%2C1.9%2C0.5%2C2.8%2C0.5c3.9%2C0%2C7.4-2.5%2C8.7-6.3c0%2C0%2C0%2C0%2C0%2C0C411.3%2C211.9%2C408.7%2C206.8%2C403.9%2C205.2z%22%20id%3D%22XMLID_803_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M373.5%2C237.2L373.5%2C237.2c-4.1%2C3-5%2C8.7-2%2C12.8c1.8%2C2.4%2C4.6%2C3.7%2C7.4%2C3.7%20%20%20%20%20c1.8%2C0%2C3.7-0.6%2C5.4-1.8c4.1-3%2C4.9-8.7%2C2-12.8C383.3%2C235.1%2C377.6%2C234.2%2C373.5%2C237.2z%22%20id%3D%22XMLID_804_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M373.5%2C152.9c1.6%2C1.2%2C3.5%2C1.8%2C5.4%2C1.8c2.8%2C0%2C5.6-1.3%2C7.4-3.8c3-4.1%2C2.1-9.8-2-12.7%20%20%20%20%20c-4.1-3-9.8-2.1-12.7%2C2C368.5%2C144.2%2C369.4%2C149.9%2C373.5%2C152.9z%22%20id%3D%22XMLID_805_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M342.8%2C247.1c-2.4%2C0-4.8%2C1-6.5%2C2.7c-1.7%2C1.7-2.7%2C4-2.7%2C6.5c0%2C2.4%2C1%2C4.7%2C2.7%2C6.4%20%20%20%20%20c1.7%2C1.7%2C4%2C2.7%2C6.5%2C2.7c2.4%2C0%2C4.7-1%2C6.5-2.7c1.7-1.7%2C2.7-4%2C2.7-6.4c0-2.4-1-4.8-2.7-6.5C347.6%2C248.1%2C345.2%2C247.1%2C342.8%2C247.1z%22%20id%3D%22XMLID_806_%22%2F%3E%0A%3Cpath%20class%3D%22st0%22%20d%3D%22M342.8%2C124.7H206.6l36.4-36.4c3.6-3.6%2C3.6-9.3%2C0-12.9c-3.6-3.6-9.3-3.6-12.9%2C0l-51.5%2C51.5%20%20%20%20%20c-1.9%2C1.9-2.8%2C4.4-2.7%2C6.9c-0.1%2C2.5%2C0.7%2C5%2C2.7%2C6.9l51.5%2C51.5c1.8%2C1.8%2C4.1%2C2.7%2C6.5%2C2.7c2.3%2C0%2C4.7-0.9%2C6.5-2.7%20%20%20%20%20c3.6-3.6%2C3.6-9.3%2C0-12.9l-36.4-36.4h136.1c0%2C0%2C0.1%2C0%2C0.1%2C0c0.6%2C0%2C1.2-0.1%2C1.8-0.2c0.2%2C0%2C0.4-0.1%2C0.6-0.1c0.1%2C0%2C0.2%2C0%2C0.3-0.1%20%20%20%20%20c3.2-1%2C5.6-3.6%2C6.3-6.9c0.1-0.6%2C0.2-1.2%2C0.2-1.8c0-0.6-0.1-1.2-0.2-1.8C351%2C127.8%2C347.3%2C124.7%2C342.8%2C124.7z%22%20id%3D%22XMLID_807_%22%2F%3E%0A%3Cpath%20class%3D%22st0%22%20d%3D%22M322.1%2C371.3l-51.5-51.5c-3.6-3.6-9.3-3.6-12.9%2C0c-3.6%2C3.6-3.6%2C9.3%2C0%2C12.9l36.9%2C36.9H169.2%20%20%20%20%20c-2.8%2C0-5.4%2C1.3-7%2C3.3c-0.1%2C0.1-0.2%2C0.2-0.3%2C0.4c-0.1%2C0.1-0.2%2C0.2-0.2%2C0.3c-0.1%2C0.1-0.1%2C0.2-0.2%2C0.4c-0.1%2C0.1-0.2%2C0.3-0.2%2C0.4%20%20%20%20%20c0%2C0.1-0.1%2C0.2-0.1%2C0.2c-0.1%2C0.2-0.2%2C0.4-0.3%2C0.6c0%2C0%2C0%2C0%2C0%2C0.1c-0.4%2C1.1-0.7%2C2.2-0.7%2C3.4c0%2C1.5%2C0.4%2C2.9%2C1%2C4.2c0%2C0%2C0%2C0.1%2C0.1%2C0.1%20%20%20%20%20c0.1%2C0.1%2C0.1%2C0.2%2C0.2%2C0.3c0.4%2C0.7%2C0.9%2C1.3%2C1.4%2C1.8c0.4%2C0.4%2C0.7%2C0.7%2C1.2%2C1c0.1%2C0.1%2C0.1%2C0.1%2C0.2%2C0.2c0%2C0%2C0.1%2C0%2C0.1%2C0.1%20%20%20%20%20c1.4%2C0.9%2C3.1%2C1.5%2C5%2C1.5h124.4l-36%2C36c-3.6%2C3.6-3.6%2C9.3%2C0%2C12.9c1.8%2C1.8%2C4.1%2C2.7%2C6.5%2C2.7c2.3%2C0%2C4.7-0.9%2C6.5-2.7l51.5-51.5%20%20%20%20%20c1.9-1.9%2C2.8-4.4%2C2.7-6.9C324.8%2C375.7%2C324%2C373.2%2C322.1%2C371.3z%22%20id%3D%22XMLID_808_%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E");
}
.x6-widget-handle-surround .x6-widget-handle-animate .x6-widget-handle {
  transition: background-size 80ms, width 80ms, height 80ms, top 150ms, left 150ms, bottom 150ms, right 150ms;
}
.x6-widget-handle-surround .x6-widget-handle-pos-se {
  right: -25px;
  bottom: -25px;
}
.x6-widget-handle-surround .x6-widget-handle-pos-nw {
  top: -21px;
  left: -25px;
}
.x6-widget-handle-surround .x6-widget-handle-pos-n {
  top: -22px;
  left: 50%;
  margin-left: -10px;
}
.x6-widget-handle-surround .x6-widget-handle-pos-e {
  top: -webkit-calc(40%);
  top: calc(50% - 10px);
  right: -25px;
}
.x6-widget-handle-surround .x6-widget-handle-pos-ne {
  top: -21px;
  right: -25px;
}
.x6-widget-handle-surround .x6-widget-handle-pos-w {
  top: 50%;
  left: -25px;
  margin-top: -10px;
}
.x6-widget-handle-surround .x6-widget-handle-pos-sw {
  bottom: -25px;
  left: -25px;
}
.x6-widget-handle-surround .x6-widget-handle-pos-s {
  bottom: -24px;
  left: 50%;
  margin-left: -10px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle {
  width: 15px;
  height: 15px;
  font-size: 15px;
  background-size: 15px 15px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-se {
  right: -19px;
  bottom: -19px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-nw {
  top: -19px;
  left: -19px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-n {
  top: -19px;
  margin-left: -7.5px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-e {
  top: -webkit-calc(42%);
  top: calc(50% - 8px);
  right: -19px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-ne {
  top: -19px;
  right: -19px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-w {
  left: -19px;
  margin-top: -8px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-sw {
  bottom: -19px;
  left: -19px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-s {
  bottom: -19px;
  margin-left: -7.5px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle {
  width: 10px;
  height: 10px;
  font-size: 10px;
  background-size: 10px 10px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-se {
  right: -15px;
  bottom: -13px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-nw {
  top: -13px;
  left: -15px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-n {
  top: -13px;
  margin-left: -5px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-e {
  top: -webkit-calc(45%);
  top: calc(50% - 5px);
  right: -15px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-ne {
  top: -13px;
  right: -15px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-w {
  left: -15px;
  margin-top: -5px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-sw {
  bottom: -13px;
  left: -15px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-s {
  bottom: -13px;
  margin-left: -5px;
}
.x6-widget-handle-toolbar {
  position: absolute;
  top: -50px;
  display: table-row;
  padding: 7px 5px;
}
.x6-widget-handle-toolbar::after {
  position: absolute;
  top: 100%;
  left: 10px;
  width: 0;
  height: 0;
  margin-top: 4px;
  border-right: 10px solid transparent;
  border-left: 10px solid transparent;
  content: '';
}
.x6-widget-handle-toolbar .x6-widget-handle {
  position: relative;
  display: table-cell;
  min-width: 20px;
  margin: 0 2px;
  background-position: 3px 3px;
  background-size: 16px 16px;
}
.x6-widget-handle-toolbar .x6-widget-handle::after {
  position: absolute;
  bottom: -11px;
  width: 100%;
  content: '';
}
.x6-widget-handle-pie {
  position: absolute;
  top: -webkit-calc(0%);
  top: calc(50% - 50px);
  right: -50px;
  z-index: 1;
  display: none;
  width: 100px;
  height: 100px;
  margin: -2px -2px 0 0;
  border-radius: 50%;
  cursor: default;
  pointer-events: visiblePainted;
}
.x6-widget-handle-pie .x6-widget-handle {
  width: 1px;
  height: auto;
  pointer-events: visiblePainted;
}
.x6-widget-handle-pie-slice-svg {
  width: 100%;
  height: 100%;
  overflow: visible !important;
}
.x6-widget-handle-pie-slice-img,
.x6-widget-handle-pie-slice-txt {
  display: none;
  pointer-events: none;
}
.x6-widget-handle-pie[data-pie-toggle-position='e'] {
  top: calc(50% - 50px);
  right: -50px;
  left: auto;
}
.x6-widget-handle-pie[data-pie-toggle-position='w'] {
  top: calc(50% - 50px);
  right: auto;
  left: -52px;
}
.x6-widget-handle-pie[data-pie-toggle-position='n'] {
  top: -50px;
  right: auto;
  bottom: auto;
  left: calc(50% - 52px);
}
.x6-widget-handle-pie[data-pie-toggle-position='s'] {
  top: auto;
  right: auto;
  bottom: -52px;
  left: calc(50% - 52px);
}
.x6-widget-handle-pie-opened {
  display: block;
  animation: halo-pie-visibility 0.1s, halo-pie-opening 0.1s;
  animation-timing-function: step-end, ease;
  animation-delay: 0s, 0.1s;
}
.x6-widget-handle-pie-toggle {
  position: absolute;
  top: -webkit-calc(35%);
  top: calc(50% - 15px);
  right: -15px;
  z-index: 2;
  display: block;
  box-sizing: border-box;
  width: 30px;
  height: 30px;
  background-repeat: no-repeat;
  background-position: center;
  background-size: 20px 20px;
  border-radius: 50%;
  cursor: pointer;
  user-select: none;
  pointer-events: visiblePainted;
  -webkit-user-drag: none;
  user-drag: none;
  /* stylelint-disable-line */
}
.x6-widget-handle-pie-toggle-pos-e {
  top: -webkit-calc(35%);
  top: calc(50% - 15px);
  right: -15px;
  bottom: auto;
  left: auto;
}
.x6-widget-handle-pie-toggle-pos-w {
  top: -webkit-calc(35%);
  top: calc(50% - 15px);
  right: auto;
  bottom: auto;
  left: -15px;
}
.x6-widget-handle-pie-toggle-pos-n {
  top: -15px;
  right: auto;
  bottom: auto;
  left: -webkit-calc(35%);
  left: calc(50% - 15px);
}
.x6-widget-handle-pie-toggle-pos-s {
  top: auto;
  right: auto;
  bottom: -15px;
  left: -webkit-calc(35%);
  left: calc(50% - 15px);
}
.x6-widget-handle-pie-toggle-opened {
  transition: 0.1s background-image;
}
.x6-widget-handle-toolbar {
  position: static;
  display: inline-block;
  margin-top: -50px;
  margin-left: 45px;
  white-space: nowrap;
  vertical-align: top;
  background-color: #f5f5f5;
  border-bottom: 3px solid #333;
  border-radius: 5px;
  box-shadow: 0 1px 2px #222;
}
.x6-widget-handle-toolbar::after {
  top: -12px;
  left: 55px;
  margin-top: 0;
  border-top: 6px solid #333;
  border-right: 10px solid transparent;
  border-left: 10px solid transparent;
}
.x6-widget-handle-toolbar .x6-widget-handle {
  display: inline-block;
  vertical-align: top;
}
.x6-widget-handle-toolbar .x6-widget-handle:hover::after {
  border-bottom: 4px solid #fc6cb8;
}
.x6-widget-handle-toolbar .x6-widget-handle-rotate {
  position: absolute;
  top: 100%;
  right: 100%;
  margin-top: 3px;
  margin-right: 6px;
}
.x6-widget-handle-toolbar .x6-widget-handle-remove:hover::after,
.x6-widget-handle-toolbar .x6-widget-handle-rotate:hover::after {
  border-bottom: none;
}
.x6-widget-handle-toolbar .x6-widget-handle + .x6-widget-handle {
  margin-left: 4px;
}
.x6-widget-handle-pie {
  box-sizing: content-box;
  background-color: #f5f5f5;
  border: 2px solid #404040;
}
.x6-widget-handle-pie-slice {
  fill: transparent;
  stroke: #e9e9e9;
  stroke-width: 1;
}
.x6-widget-handle-pie-slice:hover {
  fill: #fff;
}
.x6-widget-handle-pie-slice-img {
  display: block;
}
.x6-widget-handle-selected .x6-widget-handle-pie-slice {
  fill: #fff;
}
.x6-widget-handle-pie-toggle {
  background-color: #f6f6f6;
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20height%3D%2216px%22%20id%3D%22Layer_1%22%20style%3D%22enable-background%3Anew%200%200%2016%2016%3B%22%20version%3D%221.1%22%20viewBox%3D%220%200%2016%2016%22%20width%3D%2216px%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M15%2C6h-5V1c0-0.55-0.45-1-1-1H7C6.45%2C0%2C6%2C0.45%2C6%2C1v5H1C0.45%2C6%2C0%2C6.45%2C0%2C7v2c0%2C0.55%2C0.45%2C1%2C1%2C1h5v5c0%2C0.55%2C0.45%2C1%2C1%2C1h2%20c0.55%2C0%2C1-0.45%2C1-1v-5h5c0.55%2C0%2C1-0.45%2C1-1V7C16%2C6.45%2C15.55%2C6%2C15%2C6z%22%2F%3E%3C%2Fsvg%3E');
  background-size: 16px 16px;
  border: 2px solid #3b425f;
}
.x6-widget-handle-pie-toggle:hover {
  background-color: #fff;
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20height%3D%2216px%22%20id%3D%22Layer_1%22%20style%3D%22enable-background%3Anew%200%200%2016%2016%3B%22%20version%3D%221.1%22%20viewBox%3D%220%200%2016%2016%22%20width%3D%2216px%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M15%2C6h-5V1c0-0.55-0.45-1-1-1H7C6.45%2C0%2C6%2C0.45%2C6%2C1v5H1C0.45%2C6%2C0%2C6.45%2C0%2C7v2c0%2C0.55%2C0.45%2C1%2C1%2C1h5v5c0%2C0.55%2C0.45%2C1%2C1%2C1h2%20c0.55%2C0%2C1-0.45%2C1-1v-5h5c0.55%2C0%2C1-0.45%2C1-1V7C16%2C6.45%2C15.55%2C6%2C15%2C6z%22%2F%3E%3C%2Fsvg%3E');
  border-color: #fd6eb6;
}
.x6-widget-handle-pie-toggle-opened {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%3Csvg%20xmlns%3Adc%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Felements%2F1.1%2F%22%20xmlns%3Acc%3D%22http%3A%2F%2Fcreativecommons.org%2Fns%23%22%20xmlns%3Ardf%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2F02%2F22-rdf-syntax-ns%23%22%20xmlns%3Asvg%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20version%3D%221.1%22%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20id%3D%22Layer_1%22%20xml%3Aspace%3D%22preserve%22%3E%3Cmetadata%20id%3D%22metadata9%22%3E%3Crdf%3ARDF%3E%3Ccc%3AWork%20rdf%3Aabout%3D%22%22%3E%3Cdc%3Aformat%3Eimage%2Fsvg%2Bxml%3C%2Fdc%3Aformat%3E%3Cdc%3Atype%20rdf%3Aresource%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Fdcmitype%2FStillImage%22%20%2F%3E%3Cdc%3Atitle%3E%3C%2Fdc%3Atitle%3E%3C%2Fcc%3AWork%3E%3C%2Frdf%3ARDF%3E%3C%2Fmetadata%3E%3Cdefs%20id%3D%22defs7%22%20%2F%3E%3Cpath%20d%3D%22M%2015%2C6%2010%2C6%20C%201.0301983%2C6.00505%2015.002631%2C6.011353%206%2C6%20L%201%2C6%20C%200.45%2C6%200%2C6.45%200%2C7%20l%200%2C2%20c%200%2C0.55%200.45%2C1%201%2C1%20l%205%2C0%20c%208.988585%2C-0.019732%20-5.02893401%2C-0.018728%204%2C0%20l%205%2C0%20c%200.55%2C0%201%2C-0.45%201%2C-1%20L%2016%2C7%20C%2016%2C6.45%2015.55%2C6%2015%2C6%20z%22%20id%3D%22path3%22%20style%3D%22fill%3A%236a6c8a%22%20%2F%3E%3C%2Fsvg%3E');
}
.x6-widget-handle-pie-toggle-opened:hover {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%3Csvg%20xmlns%3Adc%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Felements%2F1.1%2F%22%20xmlns%3Acc%3D%22http%3A%2F%2Fcreativecommons.org%2Fns%23%22%20xmlns%3Ardf%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2F02%2F22-rdf-syntax-ns%23%22%20xmlns%3Asvg%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20version%3D%221.1%22%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20id%3D%22Layer_1%22%20xml%3Aspace%3D%22preserve%22%3E%3Cmetadata%20id%3D%22metadata9%22%3E%3Crdf%3ARDF%3E%3Ccc%3AWork%20rdf%3Aabout%3D%22%22%3E%3Cdc%3Aformat%3Eimage%2Fsvg%2Bxml%3C%2Fdc%3Aformat%3E%3Cdc%3Atype%20rdf%3Aresource%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Fdcmitype%2FStillImage%22%20%2F%3E%3Cdc%3Atitle%3E%3C%2Fdc%3Atitle%3E%3C%2Fcc%3AWork%3E%3C%2Frdf%3ARDF%3E%3C%2Fmetadata%3E%3Cdefs%20id%3D%22defs7%22%20%2F%3E%3Cpath%20d%3D%22M%2015%2C6%2010%2C6%20C%201.0301983%2C6.00505%2015.002631%2C6.011353%206%2C6%20L%201%2C6%20C%200.45%2C6%200%2C6.45%200%2C7%20l%200%2C2%20c%200%2C0.55%200.45%2C1%201%2C1%20l%205%2C0%20c%208.988585%2C-0.019732%20-5.02893401%2C-0.018728%204%2C0%20l%205%2C0%20c%200.55%2C0%201%2C-0.45%201%2C-1%20L%2016%2C7%20C%2016%2C6.45%2015.55%2C6%2015%2C6%20z%22%20id%3D%22path3%22%20style%3D%22fill%3A%23FD6EB6%22%20%2F%3E%3C%2Fsvg%3E');
}
.x6-widget-dnd {
  position: absolute;
  top: -10000px;
  left: -10000px;
  z-index: 999999;
  display: none;
  cursor: move;
  opacity: 0.7;
  pointer-events: 'cursor';
}
.x6-widget-dnd.dragging {
  display: inline-block;
}
.x6-widget-dnd.dragging * {
  pointer-events: none !important;
}
.x6-widget-dnd .x6-graph {
  background: transparent;
  box-shadow: none;
}
.x6-widget-halo {
  position: absolute;
  pointer-events: none;
}
.x6-widget-halo-content {
  position: absolute;
  top: 100%;
  padding: 6px;
  font-size: 10px;
  line-height: 14px;
  text-align: center;
  border-radius: 6px;
}
.x6-widget-halo-handles + .x6-widget-halo-content {
  right: -20px;
  left: -20px;
  margin-top: 30px;
}
.x6-widget-halo-handles.x6-widget-handle-small + .x6-widget-halo-content {
  margin-top: 25px;
}
.x6-widget-halo-handles.x6-widget-handle-small + .x6-widget-halo-content {
  margin-top: 20px;
}
.x6-widget-halo-handles.x6-widget-handle-pie + .x6-widget-halo-content {
  right: 0;
  left: 0;
  margin-top: 10px;
}
.x6-widget-halo-content {
  color: #fff;
  background-color: #6a6b8a;
}
.x6-widget-halo.type-node .x6-widget-handle-toolbar .x6-widget-handle-remove {
  position: absolute;
  right: 100%;
  bottom: 100%;
  margin-right: 6px;
  margin-bottom: 3px;
}
.x6-widget-halo.type-edge .x6-widget-handle-surround .x6-widget-handle-remove {
  background-color: #fff;
  border-radius: 50%;
}
.x6-widget-halo.type-edge .x6-widget-handle-toolbar {
  margin-top: -60px;
  margin-left: -18px;
}
.x6-widget-halo.type-edge .x6-widget-handle-toolbar::after {
  top: -22px;
  left: -9px;
}
.x6-widget-minimap {
  position: relative;
  display: table-cell;
  box-sizing: border-box;
  overflow: hidden;
  text-align: center;
  vertical-align: middle;
  background-color: #fff;
  user-select: none;
}
.x6-widget-minimap .x6-graph {
  display: inline-block;
  box-shadow: 0 0 4px 0 #eee;
  cursor: pointer;
}
.x6-widget-minimap .x6-graph > svg {
  pointer-events: none;
  shape-rendering: optimizeSpeed;
}
.x6-widget-minimap .x6-graph .x6-node * {
  /* stylelint-disable-next-line */
  vector-effect: initial;
}
.x6-widget-minimap-viewport {
  position: absolute;
  box-sizing: content-box !important;
  margin: -2px 0 0 -2px;
  border: 2px solid #31d0c6;
  cursor: move;
}
.x6-widget-minimap-viewport-zoom {
  position: absolute;
  right: 0;
  bottom: 0;
  box-sizing: border-box;
  width: 12px;
  height: 12px;
  margin: 0 -6px -6px 0;
  background-color: #fff;
  border: 2px solid #31d0c6;
  border-radius: 50%;
  cursor: nwse-resize;
}
.x6-graph-scroller {
  position: relative;
  box-sizing: border-box;
  overflow: scroll;
  outline: none;
}
.x6-graph-scroller-content {
  position: relative;
}
.x6-graph-scroller-background {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}
.x6-graph-scroller .x6-graph {
  position: absolute;
  display: inline-block;
  margin: 0;
  box-shadow: none;
}
.x6-graph-scroller .x6-graph > svg {
  display: block;
}
.x6-graph-scroller.x6-graph-scroller-paged .x6-graph {
  box-shadow: 0 0 4px 0 #eee;
}
.x6-graph-scroller.x6-graph-scroller-pannable[data-panning='false'] {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}
.x6-graph-scroller.x6-graph-scroller-pannable[data-panning='true'] {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
  user-select: none;
}
.x6-graph-pagebreak {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}
.x6-graph-pagebreak-vertical {
  position: absolute;
  top: 0;
  bottom: 0;
  box-sizing: border-box;
  width: 1px;
  border-left: 1px dashed #bdbdbd;
}
.x6-graph-pagebreak-horizontal {
  position: absolute;
  right: 0;
  left: 0;
  box-sizing: border-box;
  height: 1px;
  border-top: 1px dashed #bdbdbd;
}
.x6-widget-selection {
  position: absolute;
  display: none;
  width: 0;
  height: 0;
  touch-action: none;
}
.x6-widget-selection-rubberband {
  display: block;
  overflow: visible;
  opacity: 0.3;
}
.x6-widget-selection-selected {
  display: block;
}
.x6-widget-selection-box {
  cursor: move;
}
.x6-widget-selection-inner[data-selection-length='0'],
.x6-widget-selection-inner[data-selection-length='1'] {
  display: none;
}
.x6-widget-selection-content {
  position: absolute;
  top: 100%;
  right: -20px;
  left: -20px;
  margin-top: 30px;
  padding: 6px;
  line-height: 14px;
  text-align: center;
  border-radius: 6px;
}
.x6-widget-selection-content:empty {
  display: none;
}
.x6-widget-selection-rubberband {
  background-color: #3498db;
  border: 2px solid #2980b9;
}
.x6-widget-selection-box {
  box-sizing: content-box !important;
  margin-top: -4px;
  margin-left: -4px;
  padding-right: 4px;
  padding-bottom: 4px;
  border: 2px dashed #feb663;
  box-shadow: 2px 2px 5px #d3d3d3;
}
.x6-widget-selection-inner {
  box-sizing: content-box !important;
  margin-top: -8px;
  margin-left: -8px;
  padding-right: 12px;
  padding-bottom: 12px;
  border: 2px solid #feb663;
  box-shadow: 2px 2px 5px #d3d3d3;
}
.x6-widget-selection-content {
  color: #fff;
  font-size: 10px;
  background-color: #6a6b8a;
}
.x6-widget-snapline {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  pointer-events: none;
}
.x6-widget-snapline-vertical,
.x6-widget-snapline-horizontal {
  stroke: #2ecc71;
  stroke-width: 1px;
}
.x6-widget-stencil {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}
.x6-widget-stencil::after {
  position: absolute;
  top: 0;
  display: block;
  width: 100%;
  height: 20px;
  padding: 8px 0;
  line-height: 20px;
  text-align: center;
  opacity: 0;
  transition: top 0.1s linear, opacity 0.1s linear;
  content: ' ';
  pointer-events: none;
}
.x6-widget-stencil-content {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  height: auto;
  overflow-x: hidden;
  overflow-y: auto;
}
.x6-widget-stencil .x6-node [magnet]:not([magnet='passive']) {
  pointer-events: none;
}
.x6-widget-stencil-group {
  padding: 0;
  padding-bottom: 8px;
  overflow: hidden;
  user-select: none;
}
.x6-widget-stencil-group.collapsed {
  height: auto;
  padding-bottom: 0;
}
.x6-widget-stencil-group-title {
  position: relative;
  margin-top: 0;
  margin-bottom: 0;
  padding: 4px;
  cursor: pointer;
}
.x6-widget-stencil-title,
.x6-widget-stencil-group > .x6-widget-stencil-group-title {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
  user-select: none;
}
.x6-widget-stencil .unmatched {
  opacity: 0.3;
}
.x6-widget-stencil .x6-node.unmatched {
  display: none;
}
.x6-widget-stencil-group.unmatched {
  display: none;
}
.x6-widget-stencil-search-text {
  position: relative;
  z-index: 1;
  box-sizing: border-box;
  width: 100%;
  height: 30px;
  max-height: 30px;
  line-height: 30px;
  outline: 0;
}
.x6-widget-stencil.not-found::after {
  opacity: 1;
  content: attr(data-not-found-text);
}
.x6-widget-stencil.not-found.searchable::after {
  top: 30px;
}
.x6-widget-stencil.not-found.searchable.collapsable::after {
  top: 50px;
}
.x6-widget-stencil {
  color: #333;
  background: #f5f5f5;
}
.x6-widget-stencil-content {
  position: absolute;
}
.x6-widget-stencil.collapsable > .x6-widget-stencil-content {
  top: 32px;
}
.x6-widget-stencil.searchable > .x6-widget-stencil-content {
  top: 80px;
}
.x6-widget-stencil.not-found::after {
  position: absolute;
}
.x6-widget-stencil.not-found.searchable.collapsable::after {
  top: 80px;
}
.x6-widget-stencil.not-found.searchable::after {
  top: 60px;
}
.x6-widget-stencil-group {
  height: auto;
  margin-bottom: 1px;
  padding: 0;
  transition: none;
}
.x6-widget-stencil-group .x6-graph {
  background: transparent;
  box-shadow: none;
}
.x6-widget-stencil-group.collapsed {
  height: auto;
  max-height: 31px;
}
.x6-widget-stencil-title,
.x6-widget-stencil-group > .x6-widget-stencil-group-title {
  position: relative;
  left: 0;
  box-sizing: border-box;
  width: 100%;
  height: 32px;
  padding: 0 5px 0 8px;
  color: #666;
  font-weight: 700;
  font-size: 12px;
  line-height: 32px;
  cursor: default;
  transition: all 0.3;
}
.x6-widget-stencil-title:hover,
.x6-widget-stencil-group > .x6-widget-stencil-group-title:hover {
  color: #444;
}
.x6-widget-stencil-title {
  background: #e9e9e9;
}
.x6-widget-stencil-group > .x6-widget-stencil-group-title {
  background: #ededed;
}
.x6-widget-stencil.collapsable > .x6-widget-stencil-title,
.x6-widget-stencil-group.collapsable > .x6-widget-stencil-group-title {
  padding-left: 32px;
  cursor: pointer;
}
.x6-widget-stencil.collapsable > .x6-widget-stencil-title::before,
.x6-widget-stencil-group.collapsable > .x6-widget-stencil-group-title::before {
  position: absolute;
  top: 6px;
  left: 8px;
  display: block;
  width: 18px;
  height: 18px;
  margin: 0;
  padding: 0;
  background-color: transparent;
  background-repeat: no-repeat;
  background-position: 0 0;
  border: none;
  content: ' ';
}
.x6-widget-stencil.collapsable > .x6-widget-stencil-title::before,
.x6-widget-stencil-group.collapsable > .x6-widget-stencil-group-title::before {
  background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIj48cGF0aCBkPSJNOS4zNzUuNUM0LjY4Ny41Ljg3NSA0LjMxMy44NzUgOWMwIDQuNjg4IDMuODEyIDguNSA4LjUgOC41IDQuNjg3IDAgOC41LTMuODEyIDguNS04LjUgMC00LjY4Ny0zLjgxMy04LjUtOC41LTguNXptMCAxNS44ODZDNS4zMDMgMTYuMzg2IDEuOTkgMTMuMDcyIDEuOTkgOXMzLjMxMi03LjM4NSA3LjM4NS03LjM4NVMxNi43NiA0LjkyOCAxNi43NiA5YzAgNC4wNzItMy4zMTMgNy4zODYtNy4zODUgNy4zODZ6Ii8+PHBhdGggZD0iTTEyLjc1MyA4LjQ0M0g1Ljk5N2EuNTU4LjU1OCAwIDAwMCAxLjExNmg2Ljc1NmEuNTU4LjU1OCAwIDAwMC0xLjExNnoiLz48L2c+PC9zdmc+');
  opacity: 0.4;
  transition: all 0.3s;
}
.x6-widget-stencil.collapsable > .x6-widget-stencil-title:hover::before,
.x6-widget-stencil-group.collapsable > .x6-widget-stencil-group-title:hover::before {
  opacity: 0.6;
}
.x6-widget-stencil.collapsable.collapsed > .x6-widget-stencil-title::before,
.x6-widget-stencil-group.collapsable.collapsed > .x6-widget-stencil-group-title::before {
  background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIj48cGF0aCBkPSJNOS4zNzUuNUM0LjY4Ny41Ljg3NSA0LjMxMy44NzUgOWMwIDQuNjg4IDMuODEyIDguNSA4LjUgOC41IDQuNjg3IDAgOC41LTMuODEyIDguNS04LjUgMC00LjY4Ny0zLjgxMy04LjUtOC41LTguNXptMCAxNS44ODZDNS4zMDMgMTYuMzg2IDEuOTkgMTMuMDcyIDEuOTkgOXMzLjMxMi03LjM4NSA3LjM4NS03LjM4NVMxNi43NiA0LjkyOCAxNi43NiA5YzAgNC4wNzItMy4zMTMgNy4zODYtNy4zODUgNy4zODZ6Ii8+PHBhdGggZD0iTTEyLjc1MyA4LjQ0M0g1Ljk5N2EuNTU4LjU1OCAwIDAwMCAxLjExNmg2Ljc1NmEuNTU4LjU1OCAwIDAwMC0xLjExNnoiLz48cGF0aCBkPSJNOC44MTcgNS42MjN2Ni43NTZhLjU1OC41NTggMCAwMDEuMTE2IDBWNS42MjNhLjU1OC41NTggMCAxMC0xLjExNiAweiIvPjwvZz48L3N2Zz4=');
  opacity: 0.4;
}
.x6-widget-stencil.collapsable.collapsed > .x6-widget-stencil-title:hover::before,
.x6-widget-stencil-group.collapsable.collapsed > .x6-widget-stencil-group-title:hover::before {
  opacity: 0.6;
}
.x6-widget-stencil input[type='search'] {
  -webkit-appearance: textfield;
}
.x6-widget-stencil input[type='search']::-webkit-search-cancel-button,
.x6-widget-stencil input[type='search']::-webkit-search-decoration {
  -webkit-appearance: none;
}
.x6-widget-stencil-search-text {
  display: block;
  width: 90%;
  margin: 8px 5%;
  padding-left: 8px;
  color: #333;
  background: #fff;
  border: 1px solid #e9e9e9;
  border-radius: 12px;
  outline: 0;
}
.x6-widget-stencil-search-text:focus {
  outline: 0;
}
.x6-widget-stencil::after {
  color: #808080;
  font-weight: 600;
  font-size: 12px;
  background: 0 0;
}
.x6-widget-transform {
  position: absolute;
  box-sizing: content-box !important;
  margin: -5px 0 0 -5px;
  padding: 4px;
  border: 1px dashed #000;
  border-radius: 5px;
  user-select: none;
  pointer-events: none;
}
.x6-widget-transform > div {
  position: absolute;
  box-sizing: border-box;
  background-color: #fff;
  border: 1px solid #000;
  transition: background-color 0.2s;
  pointer-events: auto;
  -webkit-user-drag: none;
  user-drag: none;
  /* stylelint-disable-line */
}
.x6-widget-transform > div:hover {
  background-color: #d3d3d3;
}
.x6-widget-transform-cursor-n {
  cursor: n-resize;
}
.x6-widget-transform-cursor-s {
  cursor: s-resize;
}
.x6-widget-transform-cursor-e {
  cursor: e-resize;
}
.x6-widget-transform-cursor-w {
  cursor: w-resize;
}
.x6-widget-transform-cursor-ne {
  cursor: ne-resize;
}
.x6-widget-transform-cursor-nw {
  cursor: nw-resize;
}
.x6-widget-transform-cursor-se {
  cursor: se-resize;
}
.x6-widget-transform-cursor-sw {
  cursor: sw-resize;
}
.x6-widget-transform-resize {
  width: 10px;
  height: 10px;
  border-radius: 6px;
}
.x6-widget-transform-resize[data-position='top-left'] {
  top: -5px;
  left: -5px;
}
.x6-widget-transform-resize[data-position='top-right'] {
  top: -5px;
  right: -5px;
}
.x6-widget-transform-resize[data-position='bottom-left'] {
  bottom: -5px;
  left: -5px;
}
.x6-widget-transform-resize[data-position='bottom-right'] {
  right: -5px;
  bottom: -5px;
}
.x6-widget-transform-resize[data-position='top'] {
  top: -5px;
  left: 50%;
  margin-left: -5px;
}
.x6-widget-transform-resize[data-position='bottom'] {
  bottom: -5px;
  left: 50%;
  margin-left: -5px;
}
.x6-widget-transform-resize[data-position='left'] {
  top: 50%;
  left: -5px;
  margin-top: -5px;
}
.x6-widget-transform-resize[data-position='right'] {
  top: 50%;
  right: -5px;
  margin-top: -5px;
}
.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='top'],
.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='bottom'],
.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='left'],
.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='right'] {
  display: none;
}
.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='bottom'],
.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='left'],
.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='right'],
.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='top'] {
  display: none;
}
.x6-widget-transform.no-resize .x6-widget-transform-resize {
  display: none;
}
.x6-widget-transform-rotate {
  top: -20px;
  left: -20px;
  width: 12px;
  height: 12px;
  border-radius: 6px;
  cursor: crosshair;
}
.x6-widget-transform.no-rotate .x6-widget-transform-rotate {
  display: none;
}
.x6-widget-transform-active {
  border-color: transparent;
  pointer-events: all;
}
.x6-widget-transform-active > div {
  display: none;
}
.x6-widget-transform-active > .x6-widget-transform-active-handle {
  display: block;
  background-color: #808080;
}
.x6-widget-knob {
  position: absolute;
  box-sizing: border-box;
  width: 16px;
  height: 16px;
  margin-top: -8px;
  margin-left: -8px;
  cursor: pointer;
  user-select: none;
}
.x6-widget-knob::before,
.x6-widget-knob::after {
  position: absolute;
  transform: rotate(45deg);
  content: '';
}
.x6-widget-knob::before {
  top: 4px;
  left: 4px;
  box-sizing: border-box;
  width: 8px;
  height: 8px;
  background-color: #fff;
}
.x6-widget-knob::after {
  top: 5px;
  left: 5px;
  box-sizing: border-box;
  width: 6px;
  height: 6px;
  background-color: #fca000;
}
.x6-graph-print {
  position: relative;
}
.x6-graph-print .x6-graph-print-ready {
  display: none;
}
.x6-graph-print .x6-graph-print-preview {
  overflow: hidden !important;
  background: #fff !important;
}
@media print {
  html,
  html > body.x6-graph-printing {
    position: relative !important;
    width: 100% !important;
    height: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
  }
  html > body.x6-graph-printing > * {
    display: none !important;
  }
  html > body.x6-graph-printing > .x6-graph-print {
    display: block !important;
  }
  .x6-graph-print {
    top: 0 !important;
    left: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
    overflow: hidden !important;
    page-break-after: always;
    background: #fff !important;
  }
  .x6-graph-print .x6-graph-print-ready {
    display: none;
  }
}
.x6-cell-tool-editor {
  position: relative;
  display: inline-block;
  min-height: 1em;
  margin: 0;
  padding: 0;
  line-height: 1;
  white-space: normal;
  text-align: center;
  vertical-align: top;
  overflow-wrap: normal;
  outline: none;
  transform-origin: 0 0;
  -webkit-user-drag: none;
}
.x6-edge-tool-editor {
  border: 1px solid #275fc5;
  border-radius: 2px;
}
`;var gU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class hu extends hi{init(){ea.autoInsertCSS&&hu.ensure()}dispose(){hu.clean()}}gU([hu.dispose()],hu.prototype,"dispose",null),function(r){let e,t=0;function n(){if(t+=1,!(t>1)&&!_i.isApplyingHMR()){e=document.createElement("style"),e.setAttribute("type","text/css"),e.textContent=pU;const o=document.querySelector("head");o&&o.insertBefore(e,o.firstChild)}}r.ensure=n;function i(){t-=1,!(t>0)&&(e&&e.parentNode&&e.parentNode.removeChild(e),e=null)}r.clean=i}(hu||(hu={}));var mU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Ld{get handleClassName(){return fi.handle}get pie(){return Object.assign(Object.assign({},Ld.defaultPieOptions),this.handleOptions.pie)}initHandles(){if(this.handles=[],this.handleOptions.handles&&this.handleOptions.handles.forEach(e=>this.addHandle(e)),this.handleOptions.type==="pie"){if(this.pie.toggles){const e=fi.pieToggle;this.$pieToggles={},this.pie.toggles.forEach(t=>{const n=this.$("<div/>");this.applyAttrs(n,t.attrs),n.addClass(e).addClass(`${e}-pos-${t.position||"e"}`).attr("data-name",t.name).appendTo(this.container),this.$pieToggles[t.name]=n})}this.setPieIcons()}if(this.$handleContainer){const e=this.handleOptions.type||"surround";this.$handleContainer.addClass(fi.wrap).addClass(fi.animate).addClass(`${fi.handle}-${e}`)}this.delegateEvents({[`mousedown .${fi.handle}`]:"onHandleMouseDown",[`touchstart .${fi.handle}`]:"onHandleMouseDown",[`mousedown .${fi.pieToggle}`]:"onPieToggleMouseDown",[`touchstart .${fi.pieToggle}`]:"onPieToggleMouseDown"})}onHandleMouseDown(e){const t=this.$(e.currentTarget).closest(`.${fi.handle}`).attr("data-action");t&&(e.preventDefault(),e.stopPropagation(),this.setEventData(e,{action:t,clientX:e.clientX,clientY:e.clientY,startX:e.clientX,startY:e.clientY}),e.type==="mousedown"&&e.button===2?this.triggerHandleAction(t,"contextmenu",e):(this.triggerHandleAction(t,"mousedown",e),this.delegateDocumentEvents({mousemove:"onHandleMouseMove",touchmove:"onHandleMouseMove",mouseup:"onHandleMouseUp",touchend:"onHandleMouseUp",touchcancel:"onHandleMouseUp"},e.data)))}onHandleMouseMove(e){const n=this.getEventData(e).action;n&&this.triggerHandleAction(n,"mousemove",e)}onHandleMouseUp(e){const n=this.getEventData(e).action;n&&(this.triggerHandleAction(n,"mouseup",e),this.undelegateDocumentEvents())}triggerHandleAction(e,t,n,i){n.preventDefault(),n.stopPropagation();const o=this.normalizeEvent(n),s=this.getEventData(o),a=this.graph.snapToGrid(o.clientX,o.clientY),l=this.graph.snapToGrid(s.clientX,s.clientY),c=a.x-l.x,u=a.y-l.y;this.trigger(`action:${e}:${t}`,Object.assign({e:o,dx:c,dy:u,x:a.x,y:a.y,offsetX:n.clientX-s.startX,offsetY:n.clientY-s.startY},i)),s.clientX=n.clientX,s.clientY=n.clientY}onPieToggleMouseDown(e){e.stopPropagation();const t=this.$(e.target).closest(`.${fi.pieToggle}`).attr("data-name");this.isOpen(t)||this.isOpen()&&this.toggleState(),this.toggleState(t)}setPieIcons(){this.handleOptions.type==="pie"&&this.$handleContainer.find(`.${fi.handle}`).each((e,t)=>{const n=this.$(t),i=n.attr("data-action"),o=fi.pieSlice,s=this.getHandle(i);if(!s||!s.icon){const a=window.getComputedStyle(t,":before").getPropertyValue("content");if(a&&a!=="none"){const c=n.find(`.${o}-txt`);c.length&&pn.create(c[0]).text(a.replace(/['"]/g,""))}const l=n.css("background-image");if(l){const c=l.match(/url\(['"]?([^'"]+)['"]?\)/);if(c){const u=c[1],d=n.find(`.${o}-img`);d.length>0&&pn.create(d[0]).attr("xlink:href",u)}}}})}getHandleIdx(e){return this.handles.findIndex(t=>t.name===e)}hasHandle(e){return this.getHandleIdx(e)>=0}getHandle(e){return this.handles.find(t=>t.name===e)}renderHandle(e){const t=this.$("<div/>").addClass(`${fi.handle} ${fi.handle}-${e.name}`).attr("data-action",e.name).prop("draggable",!1);if(this.handleOptions.type==="pie"){const n=this.getHandleIdx(e.name),i=this.pie,o=i.outerRadius,s=i.innerRadius,a=(o+s)/2,l=new pe(o,o),c=Rr.toRad(i.sliceAngle),u=n*c+Rr.toRad(i.startAngle),d=u+c,h=k6(s,o,u,d),f=pn.create("svg").addClass(`${fi.pieSlice}-svg`),p=pn.create("path").addClass(fi.pieSlice).attr("d",h).translate(o,o),g=pe.fromPolar(a,-u-c/2,l).toJSON(),v=i.iconSize,y=pn.create("image").attr(g).addClass(`${fi.pieSlice}-img`);g.y=g.y+v-2;const x=pn.create("text",{"font-size":v}).attr(g).addClass(`${fi.pieSlice}-txt`);y.attr({width:v,height:v}),y.translate(-v/2,-v/2),x.translate(-v/2,-v/2),f.append([p,y,x]),t.append(f.node)}else t.addClass(`${fi.handle}-pos-${e.position}`),e.content&&(typeof e.content=="string"?t.html(e.content):t.append(e.content));return this.updateHandleIcon(t,e.icon),this.applyAttrs(t,e.attrs),t}addHandle(e){if(!this.hasHandle(e.name)){this.handles.push(e);const t=e.events;t&&Object.keys(t).forEach(n=>{const i=t[n],o=`action:${e.name}:${n}`;typeof i=="string"?this.on(o,this[i],this):this.on(o,i)}),this.$handleContainer&&this.$handleContainer.append(this.renderHandle(e))}return this}addHandles(e){return e.forEach(t=>this.addHandle(t)),this}removeHandles(){for(;this.handles.length;)this.removeHandle(this.handles[0].name);return this}removeHandle(e){const t=this.getHandleIdx(e),n=this.handles[t];return n&&(n.events&&Object.keys(n.events).forEach(i=>{this.off(`action:${e}:${i}`)}),this.getHandleElem(e).remove(),this.handles.splice(t,1)),this}changeHandle(e,t){const n=this.getHandle(e);return n&&(this.removeHandle(e),this.addHandle(Object.assign(Object.assign({},n),t))),this}toggleHandle(e,t){const n=this.getHandle(e);if(n){const i=this.getHandleElem(e),o=`${fi.handle}-selected`;t===void 0&&(t=!i.hasClass(o)),i.toggleClass(o,t);const s=t?n.iconSelected:n.icon;s&&this.updateHandleIcon(i,s)}return this}selectHandle(e){return this.toggleHandle(e,!0)}deselectHandle(e){return this.toggleHandle(e,!1)}deselectAllHandles(){return this.handles.forEach(e=>this.deselectHandle(e.name)),this}getHandleElem(e){return this.$handleContainer.find(`.${fi.handle}-${e}`)}updateHandleIcon(e,t){if(this.handleOptions.type==="pie"){const n=e.find(`.${fi.pieSliceImg}`);this.$(n[0]).attr("xlink:href",t||"")}else e.css("background-image",t?`url(${t})`:"")}isRendered(){return this.$handleContainer!=null}isOpen(e){return this.isRendered()?e?this.$pieToggles[e].hasClass(fi.pieToggleOpened):this.$handleContainer.hasClass(`${fi.pieOpended}`):!1}toggleState(e){if(this.isRendered()){const t=this.$handleContainer;if(Object.keys(this.$pieToggles).forEach(n=>{this.$pieToggles[n].removeClass(fi.pieToggleOpened)}),this.isOpen())this.trigger("pie:close",{name:e}),t.removeClass(fi.pieOpended);else{if(this.trigger("pie:open",{name:e}),e){const n=this.pie.toggles,i=n&&n.find(o=>o.name===e);i&&t.attr({"data-pie-toggle-name":i.name,"data-pie-toggle-position":i.position}),this.$pieToggles[e].addClass(fi.pieToggleOpened)}t.addClass(fi.pieOpended)}}}applyAttrs(e,t){if(t){const n=Fr.$(e);Object.keys(t).forEach(i=>{const o=n.find(i).addBack().filter(i),s=t[i],{class:a}=s,l=mU(s,["class"]);a&&o.addClass(a),o.attr(l)})}}}(function(r){r.defaultPieOptions={innerRadius:20,outerRadius:50,sliceAngle:45,startAngle:0,iconSize:14,toggles:[{name:"default",position:"e"}]}})(Ld||(Ld={}));var fi;(function(r){r.handle=Fr.prototype.prefixClassName("widget-handle"),r.wrap=`${r.handle}-wrap`,r.animate=`${r.handle}-animate`,r.pieOpended=`${r.handle}-pie-opened`,r.pieToggle=`${r.handle}-pie-toggle`,r.pieToggleOpened=`${r.handle}-pie-toggle-opened`,r.pieSlice=`${r.handle}-pie-slice`,r.pieSliceImg=`${r.handle}-pie-slice-img`})(fi||(fi={}));var vU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o},yU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Jg extends Fr{constructor(e){super();const t=e,{view:n,cell:i,node:o,edge:s,graph:a}=t,l=yU(t,["view","cell","node","edge","graph"]);n?(this.view=n,this.cell=n.cell,this.graph=n.graph,this.model=this.graph.model):(i||s||o)&&a&&(this.cell=o||s||i,this.view=a.renderer.findViewByCell(this.cell),this.graph=a,this.model=this.graph.model);const c=this.constructor;e.clearAll!==!1&&c.removeInstances(this.graph),c.register(this),this.init(l)}static ensureCache(){return this.instanceCache.has(this)||this.instanceCache.set(this,{}),this.instanceCache.get(this)}static register(e,t){t==null&&(t=e.graph);const n=this.ensureCache();let i=n[t.view.cid];i==null&&(i=n[t.view.cid]={}),i[e.cid]=e}static unregister(e,t){t==null&&(t=e.graph);const n=this.ensureCache();n[t.view.cid]&&delete n[t.view.cid][e.cid]}static removeInstances(e){const n=this.ensureCache()[e.view.cid];n&&Object.keys(n).forEach(i=>{const o=n[i];o&&o.remove()})}static getInstances(e){return this.ensureCache()[e.view.cid]||{}}init(e){}render(){return this}startListening(){this.options.clearOnBlankMouseDown!==!1&&this.graph.on("blank:mousedown",this.remove,this)}stopListening(){this.options.clearOnBlankMouseDown!==!1&&this.graph.off("blank:mousedown",this.remove,this)}remove(){return this.stopListening(),this.constructor.unregister(this),super.remove()}dispose(){this.remove()}}Jg.instanceCache=new WeakMap,vU([Fr.dispose()],Jg.prototype,"dispose",null);class VA extends Jg{get node(){return this.cell}get metadata(){const e=this.cell.prop("knob");return Array.isArray(e)?this.options.index!=null?e[this.options.index]:null:e}init(e){this.options=Object.assign({},e),this.render(),this.startListening()}startListening(){this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"}),this.model.on("*",this.update,this),this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this),this.model.on("reseted",this.remove,this),this.node.on("removed",this.remove,this),this.view.on("node:resize:mousedown",this.onTransform,this),this.view.on("node:rotate:mousedown",this.onTransform,this),this.view.on("node:resize:mouseup",this.onTransformed,this),this.view.on("node:rotate:mouseup",this.onTransformed,this),this.view.on("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.on("cell:knob:mouseup",this.onKnobMouseUp,this),super.startListening()}stopListening(){this.undelegateEvents(),this.model.off("*",this.update,this),this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this),this.model.off("reseted",this.remove,this),this.node.off("removed",this.remove,this),this.view.off("node:resize:mousedown",this.onTransform,this),this.view.off("node:rotate:mousedown",this.onTransform,this),this.view.off("node:resize:mouseup",this.onTransformed,this),this.view.off("node:rotate:mouseup",this.onTransformed,this),this.view.off("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.off("cell:knob:mouseup",this.onKnobMouseUp,this),super.stopListening()}render(){return this.container=document.createElement("div"),Qr(this.container,this.prefixClassName("widget-knob")),this.options.className&&Qr(this.container,this.options.className),this.view.addClass(Gd.KNOB),this.graph.container.appendChild(this.container),this.update(),this}remove(){return this.view.removeClass(Gd.KNOB),super.remove()}update(){if(this.metadata){const{update:e,position:t}=this.metadata,n={knob:this,cell:this.cell,node:this.node};if(t){const i=t.call(this.graph,Object.assign({},n));if(i){const o=this.graph.matrix(),s=this.node.getBBox(),a=Rr.normalize(this.node.getAngle()),l=pe.create(i);a!==0&&l.rotate(-a,{x:s.width/2,y:s.height/2}),l.translate(s).scale(o.a,o.d).translate(o.e,o.f),this.container.style.left=`${l.x}px`,this.container.style.top=`${l.y}px`}}e&&e.call(this.graph,Object.assign({},n))}}hide(){this.container.style.display="none"}show(){this.container.style.display=""}onTransform(){this.hide()}onTransformed(){this.show()}onKnobMouseDown({knob:e}){this.cid!==e.cid&&this.hide()}onKnobMouseUp(){this.show()}notify(e,t){if(this.view){const n=this.view.normalizeEvent(t),i=this.graph.snapToGrid(n.clientX,n.clientY);this.view.notify(`cell:${e}`,{e:n,view:this.view,node:this.node,cell:this.cell,x:i.x,y:i.y,knob:this}),this.cell.isNode()?this.view.notify(`node:${e}`,{e:n,view:this.view,node:this.node,cell:this.cell,x:i.x,y:i.y,knob:this}):this.cell.isEdge()&&this.view.notify(`edge:${e}`,{e:n,view:this.view,edge:this.cell,cell:this.cell,x:i.x,y:i.y,knob:this})}}onMouseDown(e){e.stopPropagation(),this.setEventData(e,{knobbing:!1,originX:e.clientX,originY:e.clientY,clientX:e.clientX,clientY:e.clientY}),this.graph.view.undelegateEvents(),this.delegateDocumentEvents(Gd.documentEvents,e.data),this.metadata&&this.metadata.onMouseDown&&this.metadata.onMouseDown.call(this.graph,{e,data:this.getEventData(e),knob:this,cell:this.cell,node:this.node}),this.notify("knob:mousedown",e)}onMouseMove(e){const t=this.getEventData(e),n=this.graph.findViewByCell(this.node);if(t.knobbing||(t.knobbing=!0,n&&(n.addClass(Gd.KNOBBING),this.notify("knob",e)),this.model.startBatch("knob",{cid:this.cid})),t.clientX=e.clientX,t.clientY=e.clientY,this.metadata&&this.metadata.onMouseMove){const i=this.graph.matrix(),o=(e.clientX-t.originX)/i.a,s=(e.clientY-t.originY)/i.d,a=this.node.getAngle(),l=new pe(o,s).rotate(a);this.metadata.onMouseMove.call(this.graph,{e,data:t,deltaX:l.x,deltaY:l.y,knob:this,cell:this.cell,node:this.node})}this.notify("knobbing",e),this.notify("knob:mousemove",e)}onMouseUp(e){this.undelegateDocumentEvents(),this.graph.view.delegateEvents();const t=this.getEventData(e),n=this.graph.findViewByCell(this.node);t.knobbing&&(n&&n.removeClass(Gd.KNOBBING),this.metadata&&this.metadata.onMouseUp&&this.metadata.onMouseUp.call(this.graph,{e,data:t,knob:this,cell:this.cell,node:this.node}),this.model.stopBatch("knob",{cid:this.cid}),this.notify("knobbed",e)),this.notify("knob:mouseup",e)}}var Gd;(function(r){r.KNOB="has-widget-knob",r.KNOBBING="node-knobbing",r.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp"}})(Gd||(Gd={}));var bU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o},Qg;(function(r){r.root="widget-minimap",r.viewport=`${r.root}-viewport`,r.zoom=`${r.viewport}-zoom`})(Qg||(Qg={}));class jA extends Fr{constructor(e){super();this.options=Object.assign(Object.assign({},yy.defaultOptions),e),this.updateViewport=KS(this.updateViewport.bind(this),0),this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(this.prefixClassName(Qg.root));const t=document.createElement("div");this.container.appendChild(t),this.$viewport=this.$("<div>").addClass(this.prefixClassName(Qg.viewport)),this.options.scalable&&(this.zoomHandle=this.$("<div>").addClass(this.prefixClassName(Qg.zoom)).appendTo(this.$viewport).get(0)),this.$container.append(this.$viewport).css({width:this.options.width,height:this.options.height,padding:this.options.padding}),this.options.container&&this.options.container.appendChild(this.container),this.sourceGraph=this.graph;const n=Object.assign(Object.assign({},this.options.graphOptions),{container:t,model:this.sourceGraph.model,frozen:!0,async:this.sourceGraph.isAsync(),interacting:!1,grid:!1,background:!1,rotating:!1,resizing:!1,embedding:!1,selecting:!1,snapline:!1,clipboard:!1,history:!1,scroller:!1});this.targetGraph=this.options.createGraph?this.options.createGraph(n):new kr(n),this.targetGraph.renderer.unfreeze(),this.updatePaper(this.sourceGraph.options.width,this.sourceGraph.options.height),this.startListening()}get graph(){return this.options.graph}get scroller(){return this.graph.scroller.widget}get graphContainer(){return this.scroller?this.scroller.container:this.graph.container}get $graphContainer(){return this.scroller?this.scroller.$container:this.$(this.graph.container)}startListening(){this.scroller?this.$graphContainer.on(`scroll${this.getEventNamespace()}`,this.updateViewport):(this.sourceGraph.on("translate",this.onTransform,this),this.sourceGraph.on("scale",this.onTransform,this),this.sourceGraph.on("model:updated",this.onModelUpdated,this)),this.sourceGraph.on("resize",this.updatePaper,this),this.delegateEvents({mousedown:"startAction",touchstart:"startAction",[`mousedown .${this.prefixClassName("graph")}`]:"scrollTo",[`touchstart .${this.prefixClassName("graph")}`]:"scrollTo"})}stopListening(){this.scroller?this.$graphContainer.off(this.getEventNamespace()):(this.sourceGraph.off("translate",this.onTransform,this),this.sourceGraph.off("scale",this.onTransform,this),this.sourceGraph.off("model:updated",this.onModelUpdated,this)),this.sourceGraph.off("resize",this.updatePaper,this),this.undelegateEvents()}onRemove(){this.targetGraph.view.remove(),this.stopListening(),this.targetGraph.dispose()}onTransform(e){(e.ui||this.targetGraphTransforming)&&this.updateViewport()}onModelUpdated(){this.targetGraph.zoomToFit()}updatePaper(e,t){let n,i;typeof e=="object"?(n=e.width,i=e.height):(n=e,i=t);const o=this.sourceGraph.options,s=this.sourceGraph.transform.getScale(),a=this.options.width-2*this.options.padding,l=this.options.height-2*this.options.padding;n/=s.sx,i/=s.sy,this.ratio=Math.min(a/n,l/i);const c=this.ratio,u=o.x*c/s.sx,d=o.y*c/s.sy;return n*=c,i*=c,this.targetGraph.resizeGraph(n,i),this.targetGraph.translate(u,d),this.scroller?this.targetGraph.scale(c,c):this.targetGraph.zoomToFit(),this.updateViewport(),this}updateViewport(){const e=this.sourceGraph.transform.getScale(),t=this.targetGraph.transform.getScale();let n=null;this.scroller?n=this.scroller.clientToLocalPoint(0,0):n=this.graph.graphToLocal(0,0);const i=this.$(this.targetGraph.container).position(),o=this.targetGraph.translate();o.ty=o.ty||0,this.geometry={top:i.top+n.y*t.sy+o.ty,left:i.left+n.x*t.sx+o.tx,width:this.$graphContainer.innerWidth()*t.sx/e.sx,height:this.$graphContainer.innerHeight()*t.sy/e.sy},this.$viewport.css(this.geometry)}startAction(e){const t=this.normalizeEvent(e),n=t.target===this.zoomHandle?"zooming":"panning",{tx:i,ty:o}=this.sourceGraph.translate(),s={action:n,clientX:t.clientX,clientY:t.clientY,scrollLeft:this.graphContainer.scrollLeft,scrollTop:this.graphContainer.scrollTop,zoom:this.sourceGraph.zoom(),scale:this.sourceGraph.transform.getScale(),geometry:this.geometry,translateX:i,translateY:o};this.targetGraphTransforming=!0,this.delegateDocumentEvents(yy.documentEvents,s)}doAction(e){const t=this.normalizeEvent(e),n=t.clientX,i=t.clientY,o=t.data;switch(o.action){case"panning":{const s=this.sourceGraph.transform.getScale(),a=(n-o.clientX)*s.sx,l=(i-o.clientY)*s.sy;this.scroller?(this.graphContainer.scrollLeft=o.scrollLeft+a/this.ratio,this.graphContainer.scrollTop=o.scrollTop+l/this.ratio):this.sourceGraph.translate(o.translateX-a/this.ratio,o.translateY-l/this.ratio);break}case"zooming":{const s=o.scale,a=o.geometry,l=1+(o.clientX-n)/a.width/s.sx;o.frameId&&cancelAnimationFrame(o.frameId),o.frameId=requestAnimationFrame(()=>{this.sourceGraph.zoom(l*o.zoom,{absolute:!0,minScale:this.options.minScale,maxScale:this.options.maxScale})});break}default:break}}stopAction(){this.undelegateDocumentEvents(),this.targetGraphTransforming=!1}scrollTo(e){const t=this.normalizeEvent(e);let n,i;const o=this.targetGraph.translate();if(o.ty=o.ty||0,t.offsetX==null){const l=this.$(this.targetGraph.container).offset();n=t.pageX-l.left,i=t.pageY-l.top}else n=t.offsetX,i=t.offsetY;const s=(n-o.tx)/this.ratio,a=(i-o.ty)/this.ratio;this.sourceGraph.centerPoint(s,a)}dispose(){this.remove()}}bU([Fr.dispose()],jA.prototype,"dispose",null);var yy;(function(r){r.defaultOptions={width:300,height:200,padding:10,scalable:!0,minScale:.01,maxScale:16,graphOptions:{},createGraph:e=>new kr(e)},r.documentEvents={mousemove:"doAction",touchmove:"doAction",mouseup:"stopAction",touchend:"stopAction"}})(yy||(yy={}));var xU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o},CU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class HA extends Fr{constructor(e){super();const{graph:t}=e,n=CU(e,["graph"]);this.graph=t,this.options=Object.assign({tolerance:10},n),this.offset={x:0,y:0},this.render(),this.parseFilter(),this.disabled||this.startListening()}get model(){return this.graph.model}get containerClassName(){return this.prefixClassName("widget-snapline")}get verticalClassName(){return`${this.containerClassName}-vertical`}get horizontalClassName(){return`${this.containerClassName}-horizontal`}get disabled(){return this.options.enabled!==!0||this.graph.options.snapline.enabled!==!0}enable(){this.disabled&&(this.options.enabled=!0,this.graph.options.snapline.enabled=!0,this.startListening())}disable(){this.disabled||(this.options.enabled=!1,this.graph.options.snapline.enabled=!1,this.stopListening())}setFilter(e){this.options.filter=e,this.parseFilter()}render(){const e=this.containerWrapper=new pn("svg"),t=this.horizontal=new pn("line"),n=this.vertical=new pn("line");e.addClass(this.containerClassName),t.addClass(this.horizontalClassName),n.addClass(this.verticalClassName),e.setAttribute("width","100%"),e.setAttribute("height","100%"),t.setAttribute("display","none"),n.setAttribute("display","none"),e.append([t,n]),this.options.className&&e.addClass(this.options.className),this.container=this.containerWrapper.node}startListening(){this.stopListening(),this.graph.on("node:mousedown",this.captureCursorOffset,this),this.graph.on("node:mousemove",this.snapOnMoving,this),this.model.on("batch:stop",this.onBatchStop,this),this.delegateDocumentEvents({mouseup:"hide",touchend:"hide"})}stopListening(){this.graph.off("node:mousedown",this.captureCursorOffset,this),this.graph.off("node:mousemove",this.snapOnMoving,this),this.model.off("batch:stop",this.onBatchStop,this),this.undelegateDocumentEvents()}parseFilter(){this.filterShapes={},this.filterCells={},this.filterFunction=null;const e=this.options.filter;Array.isArray(e)?e.forEach(t=>{typeof t=="string"?this.filterShapes[t]=!0:this.filterCells[t.id]=!0}):typeof e=="function"&&(this.filterFunction=e)}onBatchStop({name:e,data:t}){e==="resize"&&this.snapOnResizing(t.cell,t)}captureCursorOffset({view:e,x:t,y:n}){const i=e.getDelegatedView();if(i&&this.isNodeMovable(i)){const o=e.cell.getPosition();this.offset={x:t-o.x,y:n-o.y}}}isNodeMovable(e){return e&&e.cell.isNode()&&e.can("nodeMovable")}snapOnResizing(e,t){if(this.options.resizing&&!t.snapped&&t.ui&&t.direction&&t.trueDirection){const n=this.graph.renderer.findViewByCell(e);if(n&&n.cell.isNode()){const i=e.getBBox(),o=i.bbox(e.getAngle()),s=o.getTopLeft(),a=o.getBottomRight(),l=Rr.normalize(e.getAngle()),c=this.options.tolerance||0;let u,d,h,f,p,g;const v={vertical:0,horizontal:0},y=t.direction,x=t.trueDirection,E=t.relativeDirection;x.indexOf("right")!==-1?v.vertical=a.x:v.vertical=s.x,x.indexOf("bottom")!==-1?v.horizontal=a.y:v.horizontal=s.y,this.model.getNodes().some(de=>{if(this.isIgnored(e,de))return!1;const ct=de.getBBox().bbox(de.getAngle()),bt=ct.getTopLeft(),Pe=ct.getBottomRight(),tt={vertical:[bt.x,Pe.x],horizontal:[bt.y,Pe.y]},Kt={};return Object.keys(tt).forEach(tn=>{const Bn=tn,cr=tt[Bn].map(gn=>({position:gn,distance:Math.abs(gn-v[Bn])})).filter(gn=>gn.distance<=c);Kt[Bn]=bg(cr,gn=>gn.distance)}),u==null&&Kt.vertical.length>0&&(u=Kt.vertical[0].position,d=Math.min(o.y,ct.y),h=Math.max(a.y,Pe.y)-d),f==null&&Kt.horizontal.length>0&&(f=Kt.horizontal[0].position,p=Math.min(o.x,ct.x),g=Math.max(a.x,Pe.x)-p),u!=null&&f!=null}),this.hide();let T=0,P=0;(f!=null||u!=null)&&(u!=null&&(T=x.indexOf("right")!==-1?u-a.x:s.x-u),f!=null&&(P=x.indexOf("bottom")!==-1?f-a.y:s.y-f));let z=0,$=0;if(l%90==0)l===90||l===270?(z=P,$=T):(z=T,$=P);else{const de=l>=0&&l<90?1:l>=90&&l<180?4:l>=180&&l<270?3:2;f!=null&&u!=null&&(T<P?(P=0,f=void 0):(T=0,u=void 0));const ct=Rr.toRad(l%90);T&&(z=de===3?T/Math.cos(ct):T/Math.sin(ct)),P&&($=de===3?P/Math.cos(ct):P/Math.sin(ct));const bt=de===1||de===3;switch(E){case"top":case"bottom":$=P?P/(bt?Math.cos(ct):Math.sin(ct)):T/(bt?Math.sin(ct):Math.cos(ct));break;case"left":case"right":z=T?T/(bt?Math.cos(ct):Math.sin(ct)):P/(bt?Math.sin(ct):Math.cos(ct));break;default:break}}switch(E){case"top":case"bottom":z=0;break;case"left":case"right":$=0;break;default:break}const ne=this.graph.getGridSize();let De=Math.max(i.width+z,ne),fe=Math.max(i.height+$,ne);t.minWidth&&t.minWidth>ne&&(De=Math.max(De,t.minWidth)),t.minHeight&&t.minHeight>ne&&(fe=Math.max(fe,t.minHeight)),t.maxWidth&&(De=Math.min(De,t.maxWidth)),t.maxHeight&&(fe=Math.min(fe,t.maxHeight)),t.preserveAspectRatio&&($<z?fe=De*(i.height/i.width):De=fe*(i.width/i.height)),(De!==i.width||fe!==i.height)&&(e.resize(De,fe,{direction:y,relativeDirection:E,trueDirection:x,snapped:!0,snaplines:this.cid,restrict:this.graph.hook.getRestrictArea(n)}),h&&(h+=fe-i.height),g&&(g+=De-i.width));const Ae=e.getBBox().bbox(l);u&&Math.abs(Ae.x-u)>1&&Math.abs(Ae.width+Ae.x-u)>1&&(u=void 0),f&&Math.abs(Ae.y-f)>1&&Math.abs(Ae.height+Ae.y-f)>1&&(f=void 0),this.update({verticalLeft:u,verticalTop:d,verticalHeight:h,horizontalTop:f,horizontalLeft:p,horizontalWidth:g})}}}snapOnMoving({view:e,e:t,x:n,y:i}){const o=e.getEventData(t).delegatedView||e;if(!this.isNodeMovable(o))return;const s=o.cell,a=s.getSize(),l=s.getPosition(),c=new Ht(n-this.offset.x,i-this.offset.y,a.width,a.height),u=s.getAngle(),d=c.getCenter(),h=c.bbox(u),f=h.getTopLeft(),p=h.getBottomRight(),g=this.options.tolerance||0;let v,y,x,E,T,P,z=0,$=0;if(this.model.getNodes().some(ne=>{if(this.isIgnored(s,ne))return!1;const De=ne.getBBox().bbox(ne.getAngle()),fe=De.getCenter(),Ae=De.getTopLeft(),de=De.getBottomRight();return v==null&&(Math.abs(fe.x-d.x)<g?(v=fe.x,z=.5):Math.abs(Ae.x-f.x)<g?(v=Ae.x,z=0):Math.abs(Ae.x-p.x)<g?(v=Ae.x,z=1):Math.abs(de.x-p.x)<g?(v=de.x,z=1):Math.abs(de.x-f.x)<g&&(v=de.x),v!=null&&(y=Math.min(h.y,De.y),x=Math.max(p.y,de.y)-y)),E==null&&(Math.abs(fe.y-d.y)<g?(E=fe.y,$=.5):Math.abs(Ae.y-f.y)<g?E=Ae.y:Math.abs(Ae.y-p.y)<g?(E=Ae.y,$=1):Math.abs(de.y-p.y)<g?(E=de.y,$=1):Math.abs(de.y-f.y)<g&&(E=de.y),E!=null&&(T=Math.min(h.x,De.x),P=Math.max(p.x,de.x)-T)),v!=null&&E!=null}),this.hide(),E!=null||v!=null){E!=null&&(h.y=E-$*h.height),v!=null&&(h.x=v-z*h.width);const ne=h.getCenter(),De=ne.x-c.width/2,fe=ne.y-c.height/2,Ae=De-l.x,de=fe-l.y;(Ae!==0||de!==0)&&(s.translate(Ae,de,{snapped:!0,restrict:this.graph.hook.getRestrictArea(o)}),P&&(P+=Ae),x&&(x+=de)),this.update({verticalLeft:v,verticalTop:y,verticalHeight:x,horizontalTop:E,horizontalLeft:T,horizontalWidth:P})}}isIgnored(e,t){return t.id===e.id||t.isDescendantOf(e)||this.filterShapes[t.shape]||this.filterCells[t.id]||this.filterFunction&&dn(this.filterFunction,this.graph,t)}update(e){if(e.horizontalTop){const t=this.graph.localToGraph(new pe(e.horizontalLeft,e.horizontalTop)),n=this.graph.localToGraph(new pe(e.horizontalLeft+e.horizontalWidth,e.horizontalTop));this.horizontal.setAttributes({x1:this.options.sharp?`${t.x}`:"0",y1:`${t.y}`,x2:this.options.sharp?`${n.x}`:"100%",y2:`${n.y}`,display:"inherit"})}else this.horizontal.setAttribute("display","none");if(e.verticalLeft){const t=this.graph.localToGraph(new pe(e.verticalLeft,e.verticalTop)),n=this.graph.localToGraph(new pe(e.verticalLeft,e.verticalTop+e.verticalHeight));this.vertical.setAttributes({x1:`${t.x}`,y1:this.options.sharp?`${t.y}`:"0",x2:`${n.x}`,y2:this.options.sharp?`${n.y}`:"100%",display:"inherit"})}else this.vertical.setAttribute("display","none");this.show()}resetTimer(){this.timer&&(clearTimeout(this.timer),this.timer=null)}show(){return this.resetTimer(),this.container.parentNode==null&&this.graph.container.appendChild(this.container),this}hide(){this.resetTimer(),this.vertical.setAttribute("display","none"),this.horizontal.setAttribute("display","none");const e=this.options.clean,t=typeof e=="number"?e:e!==!1?3e3:0;return t>0&&(this.timer=window.setTimeout(()=>{this.container.parentNode!==null&&this.unmount()},t)),this}onRemove(){this.stopListening(),this.hide()}dispose(){this.remove()}}xU([Fr.dispose()],HA.prototype,"dispose",null);var wU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class qr extends hi{init(){this.resetUpdates(),this.startListening(),this.resetViews(this.model.getCells()),!this.isFrozen()&&this.isAsync()&&this.updateViewsAsync()}startListening(){this.model.on("sorted",this.onSortModel,this),this.model.on("reseted",this.onModelReseted,this),this.model.on("batch:stop",this.onBatchStop,this),this.model.on("cell:added",this.onCellAdded,this),this.model.on("cell:removed",this.onCellRemoved,this),this.model.on("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.on("cell:change:visible",this.onCellVisibleChanged,this)}stopListening(){this.model.off("sorted",this.onSortModel,this),this.model.off("reseted",this.onModelReseted,this),this.model.off("batch:stop",this.onBatchStop,this),this.model.off("cell:added",this.onCellAdded,this),this.model.off("cell:removed",this.onCellRemoved,this),this.model.off("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.off("cell:change:visible",this.onCellVisibleChanged,this)}resetUpdates(){this.updates={priorities:[{},{},{}],mounted:{},mountedCids:[],unmounted:{},unmountedCids:[],count:0,sort:!1,frozen:!1,freezeKey:null,animationId:null}}onSortModel(){this.model.hasActiveBatch(qr.SORT_DELAYING_BATCHES)||this.sortViews()}onModelReseted({options:e}){this.removeZPivots(),this.resetViews(this.model.getCells(),e)}onBatchStop({name:e,data:t}){if(this.isFrozen())return;const n=this.model;if(!this.isAsync()){const o=qr.UPDATE_DELAYING_BATCHES;o.includes(e)&&!n.hasActiveBatch(o)&&this.updateViews(t)}const i=qr.SORT_DELAYING_BATCHES;i.includes(e)&&!n.hasActiveBatch(i)&&this.sortViews()}onCellAdded({cell:e,options:t}){const n=t.position;this.isAsync()||typeof n!="number"?this.renderView(e,t):(t.maxPosition===n&&this.freeze({key:"addCells"}),this.renderView(e,t),n===0&&this.unfreeze({key:"addCells"}))}onCellRemoved({cell:e,options:t}){const n=this.findViewByCell(e);n&&this.requestViewUpdate(n,qr.FLAG_REMOVE,n.priority,t)}onCellZIndexChanged({cell:e,options:t}){if(this.options.sorting==="approx"){const n=this.findViewByCell(e);n&&this.requestViewUpdate(n,qr.FLAG_INSERT,n.priority,t)}}onCellVisibleChanged({cell:e,current:t,options:n}){t||this.processEdgeOnTerminalVisibleChanged(e,!1);const i=this.findViewByCell(e);!t&&i?this.removeView(e):t&&i==null&&this.renderView(e,n),t&&this.processEdgeOnTerminalVisibleChanged(e,!0)}processEdgeOnTerminalVisibleChanged(e,t){const n=(i,o)=>i.getSourceCellId()!==o.id?i.getSourceCell():i.getTargetCellId()!==o.id?i.getTargetCell():null;this.model.getConnectedEdges(e).forEach(i=>{const o=n(i,e);(o==null||o.isVisible())&&(t?i.show():i.hide())})}isEdgeTerminalVisible(e,t){const n=t==="source"?e.getSourceCellId():e.getTargetCellId(),i=n?this.model.getCell(n):null;return!(i&&!i.isVisible())}requestConnectedEdgesUpdate(e,t={}){if(Ii.isCellView(e)){const n=e.cell,i=this.model.getConnectedEdges(n);for(let o=0,s=i.length;o<s;o+=1){const a=i[o],l=this.findViewByCell(a);if(!l)continue;const c=["update"];a.getTargetCell()===n&&c.push("target"),a.getSourceCell()===n&&c.push("source"),this.scheduleViewUpdate(l,l.getFlag(c),l.priority,t)}}}forcePostponedViewUpdate(e,t){if(!e||!Ii.isCellView(e))return!1;const n=e.cell;if(n.isNode())return!1;const i=e;if(n.isEdge()&&(t&e.getFlag(["source","target"]))==0){let o=0;const s=this.findViewByCell(n.getSourceCell());s&&!this.isViewMounted(s)&&(o=this.dumpView(s),i.updateTerminalMagnet("source"));let a=0;const l=this.findViewByCell(n.getTargetCell());if(l&&!this.isViewMounted(l)&&(a=this.dumpView(l),i.updateTerminalMagnet("target")),o===0&&a===0)return!this.dumpView(i)}return!1}scheduleViewUpdate(e,t,n,i={}){const o=e.cid,s=this.updates;let a=s.priorities[n];a||(a=s.priorities[n]={});const l=a[o]||0;(l&t)!==t&&(l||(s.count+=1),t&qr.FLAG_REMOVE&&l&qr.FLAG_INSERT?a[o]^=qr.FLAG_INSERT:t&qr.FLAG_INSERT&&l&qr.FLAG_REMOVE&&(a[o]^=qr.FLAG_REMOVE),a[o]|=t,this.graph.hook.onViewUpdated(e,t,i))}requestViewUpdate(e,t,n,i={}){this.scheduleViewUpdate(e,t,n,i);const o=this.isAsync();if(this.isFrozen()||o&&i.async!==!1||this.model.hasActiveBatch(qr.UPDATE_DELAYING_BATCHES))return;const s=this.updateViews(i);o&&this.graph.trigger("render:done",{stats:s,options:i})}dumpView(e,t={}){if(e==null)return 0;const n=e.cid,o=this.updates.priorities[e.priority],s=this.registerMountedView(e)|o[n];return delete o[n],s?this.updateView(e,s,t):0}dumpViews(e={}){this.checkView(e),this.updateViews(e)}requireView(e,t={}){const n=this.findViewByCell(e);return n==null?null:(this.dumpView(n,t),n)}updateView(e,t,n={}){if(e==null)return 0;if(Ii.isCellView(e)){if(t&qr.FLAG_REMOVE)return this.removeView(e.cell),0;t&qr.FLAG_INSERT&&(this.insertView(e),t^=qr.FLAG_INSERT)}return t?e.confirmUpdate(t,n):0}updateViews(e={}){let t,n=0,i=0,o=qr.MIN_PRIORITY;do t=this.updateViewsBatch(e),n+=1,i+=t.updatedCount,o=Math.min(t.priority,o);while(!t.empty);return{priority:o,batchCount:n,updatedCount:i}}updateViewsBatch(e={}){const t=this.updates,n=t.priorities,i=e.batchSize||qr.UPDATE_BATCH_SIZE;let o=!0,s=qr.MIN_PRIORITY,a=0,l=0,c=0,u=0,d=e.checkView||this.options.checkView;typeof d!="function"&&(d=null);e:for(let h=0,f=n.length;h<f;h+=1){const p=n[h];for(const g in p){if(c>=i){o=!1;break e}const v=Fr.views[g];if(!v){delete p[g];continue}let y=p[g];if((y&qr.FLAG_REMOVE)==0){const T=g in t.unmounted;if(d&&!dn(d,this.graph,{view:v,unmounted:T})){T||(this.registerUnmountedView(v),v.unmount()),t.unmounted[g]|=y,delete p[g],l+=1;continue}T&&(y|=qr.FLAG_INSERT,a+=1),y|=this.registerMountedView(v)}const x=v;let E=this.updateView(v,y,e);if(E>0){const T=x.cell;T&&T.isEdge()&&(x.hasAction(E,"source")&&!this.isEdgeTerminalVisible(T,"source")&&(E=x.removeAction(E,"source"),E|=qr.FLAG_REMOVE),x.hasAction(E,"target")&&!this.isEdgeTerminalVisible(T,"target")&&(E=x.removeAction(E,"target"),E|=qr.FLAG_REMOVE))}if(E>0&&(p[g]=E,!this.graph.hook.onViewPostponed(x,E,e)||p[g])){u+=1,o=!1;continue}s>h&&(s=h),c+=1,delete p[g]}}return{empty:o,priority:s,mountedCount:a,unmountedCount:l,updatedCount:c,postponedCount:u}}updateViewsAsync(e={},t={processed:0,priority:qr.MIN_PRIORITY}){const n=this.updates,i=n.animationId;if(i){if(jC(i),t.processed===0){const h=e.before;typeof h=="function"&&dn(h,this.graph,this.graph)}const o=this.updateViewsBatch(e),s=this.checkViewImpl({checkView:e.checkView,mountedBatchSize:qr.MOUNT_BATCH_SIZE-o.mountedCount,unmountedBatchSize:qr.MOUNT_BATCH_SIZE-o.unmountedCount});let a=t.processed;const l=n.count,c=s.mountedCount,u=s.unmountedCount;o.updatedCount>0&&(a+=o.updatedCount+o.unmountedCount,t.priority=Math.min(o.priority,t.priority),o.empty&&c===0?(o.priority=t.priority,o.mountedCount+=c,o.unmountedCount+=u,this.graph.trigger("render:done",{stats:o,options:e}),t.processed=0,n.count=0):t.processed=a);const d=e.progress;if(l&&typeof d=="function"&&dn(d,this.graph,{total:l,done:o.empty,current:a}),n.animationId!==i)return}n.animationId=VC(()=>{this.updateViewsAsync(e,t)})}registerMountedView(e){const t=e.cid,n=this.updates;if(t in n.mounted)return 0;n.mounted[t]=!0,n.mountedCids.push(t);const i=n.unmounted[t]||0;return delete n.unmounted[t],i}registerUnmountedView(e){const t=e.cid,n=this.updates;if(t in n.unmounted)return 0;n.unmounted[t]|=qr.FLAG_INSERT;const i=n.unmounted[t];return n.unmountedCids.push(t),delete n.mounted[t],i}isViewMounted(e){return e==null?!1:e.cid in this.updates.mounted}getMountedViews(){return Object.keys(this.updates.mounted).map(e=>Ii.views[e])}getUnmountedViews(){return Object.keys(this.updates.unmounted).map(e=>Ii.views[e])}checkMountedViews(e,t){let n=0;if(typeof e!="function")return n;const i=this.updates,o=i.mounted,s=i.mountedCids,a=t==null?s.length:Math.min(s.length,t);for(let l=0;l<a;l+=1){const c=s[l];if(!(c in o))continue;const u=Ii.views[c];if(u==null)continue;if(dn(e,this.graph,{view:u,unmounted:!0})){s.push(c);continue}n+=1,this.registerUnmountedView(u)&&u.unmount()}return s.splice(0,a),n}checkUnmountedViews(e,t){let n=0;typeof e!="function"&&(e=null);const i=this.updates,o=i.unmounted,s=i.unmountedCids,a=t==null?s.length:Math.min(s.length,t);for(let l=0;l<a;l+=1){const c=s[l];if(!(c in o))continue;const u=Ii.views[c];if(u==null)continue;if(e&&!dn(e,this.graph,{view:u,unmounted:!1})){s.push(c);continue}n+=1;const d=this.registerMountedView(u);d&&this.scheduleViewUpdate(u,d,u.priority,{mounting:!0})}return s.splice(0,a),n}checkViewImpl(e={mountedBatchSize:Number.MAX_SAFE_INTEGER,unmountedBatchSize:Number.MAX_SAFE_INTEGER}){const t=e.checkView||this.options.checkView,n=this.checkMountedViews(t,e.unmountedBatchSize);return{mountedCount:this.checkUnmountedViews(t,n>0?Math.min(this.updates.unmountedCids.length-n,e.mountedBatchSize):e.mountedBatchSize),unmountedCount:n}}checkView(e={}){return this.checkViewImpl(e)}isFrozen(){return!!this.options.frozen}freeze(e={}){const t=e.key,n=this.updates,i=this.options.frozen,o=n.freezeKey;if(t&&t!==o){if(i&&o)return;n.frozen=i,n.freezeKey=t}this.options.frozen=!0;const s=n.animationId;n.animationId=null,this.isAsync()&&s!=null&&jC(s),this.graph.trigger("freeze",{key:t})}unfreeze(e={}){const t=e.key,n=this.updates,i=n.freezeKey;if(t&&i&&t!==i||(n.freezeKey=null,t&&t===i&&n.frozen))return;const o=()=>{this.options.frozen=n.frozen=!1,n.sort&&(this.sortViews(),n.sort=!1);const s=e.after;s&&dn(s,this.graph,this.graph),this.graph.trigger("unfreeze",{key:t})};if(this.isAsync()){this.freeze();const s=e.progress;this.updateViewsAsync(Object.assign(Object.assign({},e),{progress:({done:a,current:l,total:c})=>{s&&dn(s,this.graph,{done:a,current:l,total:c}),a&&o()}}))}else this.updateViews(e),o()}isAsync(){return!!this.options.async}setAsync(e){this.options.async=e}onRemove(){this.freeze(),this.removeViews()}resetViews(e=[],t={}){this.resetUpdates(),this.removeViews(),this.freeze({key:"reset"});for(let n=0,i=e.length;n<i;n+=1)this.renderView(e[n],t);this.unfreeze({key:"reset"}),this.sortViews()}removeView(e){const t=this.views[e.id];if(t){const n=t.cid,i=this.updates,o=i.mounted,s=i.unmounted;t.remove(),delete this.views[e.id],delete o[n],delete s[n]}return t}removeViews(){this.views&&Object.keys(this.views).forEach(e=>{const t=this.views[e];t&&this.removeView(t.cell)}),this.views={}}renderView(e,t={}){const n=e.id,i=this.views;let o=0,s=i[n];if(!!e.isVisible()&&!(e.isEdge()&&(!this.isEdgeTerminalVisible(e,"source")||!this.isEdgeTerminalVisible(e,"target")))){if(s)o=qr.FLAG_INSERT;else{const a=this.graph.hook.createCellView(e);a&&(s=i[e.id]=a,s.graph=this.graph,o=this.registerUnmountedView(s)|s.getBootstrapFlag())}s&&this.requestViewUpdate(s,o,s.priority,t)}}isExactSorting(){return this.options.sorting==="exact"}sortViews(){if(!!this.isExactSorting()){if(this.isFrozen()){this.updates.sort=!0;return}this.sortViewsExact()}}sortElements(e,t){const n=e.map(i=>{const o=i.parentNode,s=o.insertBefore(document.createTextNode(""),i.nextSibling);return a=>{if(o===a)throw new Error("You can't sort elements if any one is a descendant of another.");o.insertBefore(a,s),o.removeChild(s)}});e.sort(t).forEach((i,o)=>n[o](i))}sortViewsExact(){const e=this.view.$(this.view.stage).children("[data-cell-id]").toArray(),t=this.model;this.sortElements(e,(n,i)=>{const o=t.getCell(n.getAttribute("data-cell-id")||""),s=t.getCell(i.getAttribute("data-cell-id")||""),a=o.getZIndex()||0,l=s.getZIndex()||0;return a===l?0:a<l?-1:1})}addZPivot(e=0){this.zPivots==null&&(this.zPivots={});const t=this.zPivots;let n=t[e];if(n)return n;n=t[e]=document.createComment(`z-index:${e+1}`);let i=-Infinity;for(const s in t){const a=+s;!(a<e&&a>i&&(i=a,i===e-1))}const o=this.view.stage;if(i!==-Infinity){const s=t[i];o.insertBefore(n,s.nextSibling)}else o.insertBefore(n,o.firstChild);return n}removeZPivots(){this.zPivots&&Object.keys(this.zPivots).forEach(e=>{const t=this.zPivots[e];t&&t.parentNode&&t.parentNode.removeChild(t)}),this.zPivots={}}insertView(e){const t=this.view.stage;switch(this.options.sorting){case"approx":{const n=e.cell.getZIndex(),i=this.addZPivot(n);t.insertBefore(e.container,i);break}case"exact":default:t.appendChild(e.container);break}}findViewByCell(e){if(e==null)return null;const t=Tr.isCell(e)?e.id:e;return this.views[t]}findViewByElem(e){if(e==null)return null;const t=typeof e=="string"?this.view.stage.querySelector(e):e instanceof Element?e:e[0];if(t){const n=this.view.findAttr("data-cell-id",t);if(n)return this.views[n]}return null}findViewsFromPoint(e){const t={x:e.x,y:e.y};return this.model.getCells().map(n=>this.findViewByCell(n)).filter(n=>n!=null?No(n.container,{target:this.view.stage}).containsPoint(t):!1)}findEdgeViewsInArea(e,t={}){const n=Ht.create(e);return this.model.getEdges().map(i=>this.findViewByCell(i)).filter(i=>{if(i){const o=No(i.container,{target:this.view.stage});return o.width===0?o.inflate(1,0):o.height===0&&o.inflate(0,1),t.strict?n.containsRect(o):n.isIntersectWithRect(o)}return!1})}findViewsInArea(e,t={}){const n=Ht.create(e);return this.model.getNodes().map(i=>this.findViewByCell(i)).filter(i=>{if(i){const o=No(i.container,{target:this.view.stage});return t.strict?n.containsRect(o):n.isIntersectWithRect(o)}return!1})}dispose(){this.resetUpdates(),this.stopListening()}}wU([hi.dispose()],qr.prototype,"dispose",null),function(r){r.FLAG_INSERT=1<<30,r.FLAG_REMOVE=1<<29,r.MOUNT_BATCH_SIZE=1e3,r.UPDATE_BATCH_SIZE=1e3,r.MIN_PRIORITY=2,r.SORT_DELAYING_BATCHES=["add","to-front","to-back"],r.UPDATE_DELAYING_BATCHES=["translate"]}(qr||(qr={}));var EU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class by extends hi{get elem(){return this.view.background}init(){this.startListening(),this.options.background&&this.draw(this.options.background)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}updateBackgroundImage(e={}){let t=e.size||"auto auto",n=e.position||"center";const i=this.graph.transform.getScale(),o=this.graph.translate();if(typeof n=="object"){const s=o.tx+i.sx*(n.x||0),a=o.ty+i.sy*(n.y||0);n=`${s}px ${a}px`}typeof t=="object"&&(t=Ht.fromSize(t).scale(i.sx,i.sy),t=`${t.width}px ${t.height}px`),this.elem.style.backgroundSize=t,this.elem.style.backgroundPosition=n}drawBackgroundImage(e,t={}){if(!(e instanceof HTMLImageElement)){this.elem.style.backgroundImage="";return}const n=this.optionsCache;if(n&&n.image!==t.image)return;let i;const o=t.opacity,s=t.size;let a=t.repeat||"no-repeat";const l=zg.registry.get(a);if(typeof l=="function"){const u=t.quality||1;e.width*=u,e.height*=u;const d=l(e,t);if(!(d instanceof HTMLCanvasElement))throw new Error("Background pattern must return an HTML Canvas instance");i=d.toDataURL("image/png"),t.repeat&&a!==t.repeat?a=t.repeat:a="repeat",typeof s=="object"?(s.width*=d.width/e.width,s.height*=d.height/e.height):s===void 0&&(t.size={width:d.width/u,height:d.height/u})}else i=e.src,s===void 0&&(t.size={width:e.width,height:e.height});n!=null&&typeof t.size=="object"&&t.image===n.image&&t.repeat===n.repeat&&t.quality===n.quality&&(n.size=Mg(t.size));const c=this.elem.style;c.backgroundImage=`url(${i})`,c.backgroundRepeat=a,c.opacity=o==null||o>=1?"":`${o}`,this.updateBackgroundImage(t)}updateBackgroundColor(e){this.elem.style.backgroundColor=e||""}updateBackgroundOptions(e){this.graph.options.background=e}update(){this.optionsCache&&this.updateBackgroundImage(this.optionsCache)}draw(e){const t=e||{};if(this.updateBackgroundOptions(e),this.updateBackgroundColor(t.color),t.image){this.optionsCache=Mg(t);const n=document.createElement("img");n.onload=()=>this.drawBackgroundImage(n,e),n.setAttribute("crossorigin","anonymous"),n.src=t.image}else this.drawBackgroundImage(null),this.optionsCache=null}clear(){this.draw()}dispose(){this.clear(),this.stopListening()}}EU([hi.dispose()],by.prototype,"dispose",null);var SU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o},_U=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Gf extends Fr{constructor(e){super();this.padding={left:0,top:0,right:0,bottom:0},this.options=Ca.getOptions(e);const t=this.graph.transform.getScale();this.sx=t.sx,this.sy=t.sy;const n=this.options.width||this.graph.options.width,i=this.options.height||this.graph.options.height;this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(this.prefixClassName(Ca.containerClass)).css({width:n,height:i}),this.options.pageVisible&&this.$container.addClass(this.prefixClassName(Ca.pagedClass)),this.options.className&&this.$container.addClass(this.options.className);const o=this.graph.container;o.parentNode&&this.$container.insertBefore(o);const s=o.getAttribute("style");if(s){const a={};s.split(";").forEach(c=>{const u=c.trim();if(u){const d=u.split(":");d.length&&(a[d[0].trim()]=d[1]?d[1].trim():"")}}),Object.keys(a).forEach(c=>{c==="width"||c==="height"||(o.style[c]="",this.container.style[c]=a[c])})}this.content=document.createElement("div"),this.$content=this.$(this.content).addClass(this.prefixClassName(Ca.contentClass)).css({width:this.graph.options.width,height:this.graph.options.height}),this.background=document.createElement("div"),this.$background=this.$(this.background).addClass(this.prefixClassName(Ca.backgroundClass)),this.$content.append(this.background),this.options.pageVisible||this.$content.append(this.graph.view.grid),this.$content.append(o),this.$content.appendTo(this.container),this.startListening(),this.options.pageVisible||this.graph.grid.update(),this.backgroundManager=new Gf.Background(this),this.options.autoResize||this.update()}get graph(){return this.options.graph}get model(){return this.graph.model}startListening(){const e=this.graph,t=this.model;e.on("scale",this.onScale,this),e.on("resize",this.onResize,this),e.on("before:print",this.storeScrollPosition,this),e.on("before:export",this.storeScrollPosition,this),e.on("after:print",this.restoreScrollPosition,this),e.on("after:export",this.restoreScrollPosition,this),e.on("render:done",this.onRenderDone,this),e.on("unfreeze",this.onUpdate,this),t.on("reseted",this.onUpdate,this),t.on("cell:added",this.onUpdate,this),t.on("cell:removed",this.onUpdate,this),t.on("cell:changed",this.onUpdate,this),t.on("batch:stop",this.onBatchStop,this),this.delegateBackgroundEvents()}stopListening(){const e=this.graph,t=this.model;e.off("scale",this.onScale,this),e.off("resize",this.onResize,this),e.off("beforeprint",this.storeScrollPosition,this),e.off("beforeexport",this.storeScrollPosition,this),e.off("afterprint",this.restoreScrollPosition,this),e.off("afterexport",this.restoreScrollPosition,this),e.off("render:done",this.onRenderDone,this),e.off("unfreeze",this.onUpdate,this),t.off("reseted",this.onUpdate,this),t.off("cell:added",this.onUpdate,this),t.off("cell:removed",this.onUpdate,this),t.off("cell:changed",this.onUpdate,this),t.off("batch:stop",this.onBatchStop,this),this.undelegateBackgroundEvents()}enableAutoResize(){this.options.autoResize=!0}disableAutoResize(){this.options.autoResize=!1}onUpdate(){this.graph.isAsync()||!this.options.autoResize||this.update()}onBatchStop(e){this.graph.isAsync()||!this.options.autoResize||qr.UPDATE_DELAYING_BATCHES.includes(e.name)&&this.update()}delegateBackgroundEvents(e){const t=e||Ia.events;this.delegatedHandlers=Object.keys(t).reduce((n,i)=>{const o=t[i];if(i.indexOf(" ")===-1)if(typeof o=="function")n[i]=o;else{let s=this.graph.view[o];typeof s=="function"&&(s=s.bind(this.graph.view),n[i]=s)}return n},{}),this.onBackgroundEvent=this.onBackgroundEvent.bind(this),Object.keys(this.delegatedHandlers).forEach(n=>{this.delegateEvent(n,{guarded:!1},this.onBackgroundEvent)})}undelegateBackgroundEvents(){Object.keys(this.delegatedHandlers).forEach(e=>{this.undelegateEvent(e,this.onBackgroundEvent)})}onBackgroundEvent(e){let t=!1;const n=e.target;if(this.options.pageVisible)this.options.background?t=this.background===n:t=this.content===n;else{const i=this.graph.view;t=i.background===n||i.grid===n}if(t){const i=this.delegatedHandlers[e.type];typeof i=="function"&&i.apply(this.graph,arguments)}}onRenderDone({stats:e}){this.options.autoResize&&e.priority<2&&this.update()}onResize(){this.cachedCenterPoint&&(this.centerPoint(this.cachedCenterPoint.x,this.cachedCenterPoint.y),this.updatePageBreak())}onScale({sx:e,sy:t,ox:n,oy:i}){this.updateScale(e,t),(n||i)&&(this.centerPoint(n,i),this.updatePageBreak()),typeof(this.options.autoResizeOptions||this.options.fitTocontentOptions)=="function"&&this.update()}storeScrollPosition(){this.cachedScrollLeft=this.container.scrollLeft,this.cachedScrollTop=this.container.scrollTop}restoreScrollPosition(){this.container.scrollLeft=this.cachedScrollLeft,this.container.scrollTop=this.cachedScrollTop,this.cachedScrollLeft=null,this.cachedScrollTop=null}storeClientSize(){this.cachedClientSize={width:this.container.clientWidth,height:this.container.clientHeight}}restoreClientSize(){this.cachedClientSize=null}beforeManipulation(){(_i.IS_IE||_i.IS_EDGE)&&this.$container.css("visibility","hidden")}afterManipulation(){(_i.IS_IE||_i.IS_EDGE)&&this.$container.css("visibility","visible")}updatePageSize(e,t){e!=null&&(this.options.pageWidth=e),t!=null&&(this.options.pageHeight=t),this.updatePageBreak()}updatePageBreak(){if(this.pageBreak&&this.pageBreak.parentNode&&this.pageBreak.parentNode.removeChild(this.pageBreak),this.pageBreak=null,this.options.pageVisible&&this.options.pageBreak){const e=this.graph.options.width,t=this.graph.options.height,n=this.options.pageWidth*this.sx,i=this.options.pageHeight*this.sy;if(n===0||i===0)return;if(e>n||t>i){let o=!1;const s=document.createElement("div");for(let a=1,l=Math.floor(e/n);a<l;a+=1)this.$("<div/>").addClass(this.prefixClassName("graph-pagebreak-vertical")).css({left:a*n}).appendTo(s),o=!0;for(let a=1,l=Math.floor(t/i);a<l;a+=1)this.$("<div/>").addClass(this.prefixClassName("graph-pagebreak-horizontal")).css({top:a*i}).appendTo(s),o=!0;o&&(Qr(s,this.prefixClassName("graph-pagebreak")),this.$(this.graph.view.grid).after(s),this.pageBreak=s)}}}update(){const e=this.getClientSize();this.cachedCenterPoint=this.clientToLocalPoint(e.width/2,e.height/2);let t=this.options.autoResizeOptions||this.options.fitTocontentOptions;typeof t=="function"&&(t=dn(t,this,this));const n=Object.assign({gridWidth:this.options.pageWidth,gridHeight:this.options.pageHeight,allowNewOrigin:"negative",contentArea:this.calcContextArea(t)},t);this.graph.fitToContent(this.getFitToContentOptions(n))}calcContextArea(e){const t=e==null?void 0:e.direction;if(!t)return this.graph.transform.getContentArea(e);function n(a){let l=a.getBBox();if(l&&a.isNode()){const c=a.getAngle();c!=null&&c!==0&&(l=l.bbox(c))}return l}const i=this.options.pageWidth||1,o=this.options.pageHeight||1;let s=this.graph.getCells();return t.includes("top")||(s=s.filter(a=>n(a).y>=0)),t.includes("left")||(s=s.filter(a=>n(a).x>=0)),t.includes("right")||(s=s.filter(a=>{const l=n(a);return l.x+l.width<=i})),t.includes("bottom")||(s=s.filter(a=>{const l=n(a);return l.y+l.height<=o})),this.model.getCellsBBox(s)||new Ht}getFitToContentOptions(e){const t=this.sx,n=this.sy;return e.gridWidth&&(e.gridWidth*=t),e.gridHeight&&(e.gridHeight*=n),e.minWidth&&(e.minWidth*=t),e.minHeight&&(e.minHeight*=n),typeof e.padding=="object"?e.padding={left:(e.padding.left||0)*t,right:(e.padding.right||0)*t,top:(e.padding.top||0)*n,bottom:(e.padding.bottom||0)*n}:typeof e.padding=="number"&&(e.padding*=t),this.options.autoResize||(e.contentArea=Ht.create()),e}updateScale(e,t){const n=this.graph.options,i=e/this.sx,o=t/this.sy;this.sx=e,this.sy=t,this.graph.translate(n.x*i,n.y*o),this.graph.resizeGraph(n.width*i,n.height*o)}scrollbarPosition(e,t,n){if(e==null&&t==null)return{left:this.container.scrollLeft,top:this.container.scrollTop};const i={};return typeof e=="number"&&(i.scrollLeft=e),typeof t=="number"&&(i.scrollTop=t),n&&n.animation?this.$container.animate(i,n.animation):this.$container.prop(i),this}scrollToPoint(e,t,n){const i=this.getClientSize(),o=this.graph.matrix(),s={};return typeof e=="number"&&(s.scrollLeft=e-i.width/2+o.e+(this.padding.left||0)),typeof t=="number"&&(s.scrollTop=t-i.height/2+o.f+(this.padding.top||0)),n&&n.animation?this.$container.animate(s,n.animation):this.$container.prop(s),this}scrollToContent(e){const t=this.sx,n=this.sy,i=this.graph.getContentArea().getCenter();return this.scrollToPoint(i.x*t,i.y*n,e)}scrollToCell(e,t){const n=this.sx,i=this.sy,o=e.getBBox().getCenter();return this.scrollToPoint(o.x*n,o.y*i,t)}center(e){return this.centerPoint(e)}centerPoint(e,t,n){const i=this.graph.matrix(),o=i.a,s=i.d,a=-i.e,l=-i.f,c=a+this.graph.options.width,u=l+this.graph.options.height;let d;if(this.storeClientSize(),typeof e=="number"||typeof t=="number"){d=n;const P=this.getVisibleArea().getCenter();typeof e=="number"?e*=o:e=P.x,typeof t=="number"?t*=s:t=P.y}else d=e,e=(a+c)/2,t=(l+u)/2;if(d&&d.padding)return this.positionPoint({x:e,y:t},"50%","50%",d);const h=this.getPadding(),f=this.getClientSize(),p=f.width/2,g=f.height/2,v=p-h.left-e+a,y=p-h.right+e-c,x=g-h.top-t+l,E=g-h.bottom+t-u;this.addPadding(Math.max(v,0),Math.max(y,0),Math.max(x,0),Math.max(E,0));const T=this.scrollToPoint(e,t,d||void 0);return this.restoreClientSize(),T}centerContent(e){return this.positionContent("center",e)}centerCell(e,t){return this.positionCell(e,"center",t)}positionContent(e,t){const n=this.graph.getContentArea(t);return this.positionRect(n,e,t)}positionCell(e,t,n){const i=e.getBBox();return this.positionRect(i,t,n)}positionRect(e,t,n){const i=Ht.create(e);switch(t){case"center":return this.positionPoint(i.getCenter(),"50%","50%",n);case"top":return this.positionPoint(i.getTopCenter(),"50%",0,n);case"top-right":return this.positionPoint(i.getTopRight(),"100%",0,n);case"right":return this.positionPoint(i.getRightMiddle(),"100%","50%",n);case"bottom-right":return this.positionPoint(i.getBottomRight(),"100%","100%",n);case"bottom":return this.positionPoint(i.getBottomCenter(),"50%","100%",n);case"bottom-left":return this.positionPoint(i.getBottomLeft(),0,"100%",n);case"left":return this.positionPoint(i.getLeftMiddle(),0,"50%",n);case"top-left":return this.positionPoint(i.getTopLeft(),0,0,n);default:return this}}positionPoint(e,t,n,i={}){const{padding:o}=i,s=_U(i,["padding"]),a=Us(o),l=Ht.fromSize(this.getClientSize()),c=l.clone().moveAndExpand({x:a.left,y:a.top,width:-a.right-a.left,height:-a.top-a.bottom});t=Ra(t,Math.max(0,c.width)),t<0&&(t=c.width+t),n=Ra(n,Math.max(0,c.height)),n<0&&(n=c.height+n);const u=c.getTopLeft().translate(t,n),d=l.getCenter().diff(u),h=this.zoom(),f=d.scale(1/h,1/h),p=pe.create(e).translate(f);return this.centerPoint(p.x,p.y,s)}zoom(e,t){if(e==null)return this.sx;t=t||{};let n,i;const o=this.getClientSize(),s=this.clientToLocalPoint(o.width/2,o.height/2);let a=e,l=e;if(t.absolute||(a+=this.sx,l+=this.sy),t.scaleGrid&&(a=Math.round(a/t.scaleGrid)*t.scaleGrid,l=Math.round(l/t.scaleGrid)*t.scaleGrid),t.maxScale&&(a=Math.min(t.maxScale,a),l=Math.min(t.maxScale,l)),t.minScale&&(a=Math.max(t.minScale,a),l=Math.max(t.minScale,l)),a=this.graph.transform.clampScale(a),l=this.graph.transform.clampScale(l),t.center){const c=a/this.sx,u=l/this.sy;n=t.center.x-(t.center.x-s.x)/c,i=t.center.y-(t.center.y-s.y)/u}else n=s.x,i=s.y;return this.beforeManipulation(),this.graph.transform.scale(a,l),this.centerPoint(n,i),this.afterManipulation(),this}zoomToRect(e,t={}){const n=Ht.create(e),i=this.graph;t.contentArea=n,t.viewportArea==null&&(t.viewportArea={x:i.options.x,y:i.options.y,width:this.$container.width(),height:this.$container.height()}),this.beforeManipulation(),i.transform.scaleContentToFitImpl(t,!1);const o=n.getCenter();return this.centerPoint(o.x,o.y),this.afterManipulation(),this}zoomToFit(e={}){return this.zoomToRect(this.graph.getContentArea(e),e)}transitionToPoint(e,t,n){typeof e=="object"?(n=t,t=e.y,e=e.x):t=t,n==null&&(n={});let i,o;const s=this.sx,a=Math.max(n.scale||s,1e-6),l=this.getClientSize(),c=new pe(e,t),u=this.clientToLocalPoint(l.width/2,l.height/2);if(s===a){const h=u.diff(c).scale(s,s).round();i=`translate(${h.x}px,${h.y}px)`}else{const h=a/(s-a)*c.distance(u),f=u.clone().move(c,h),p=this.localToBackgroundPoint(f).round();i=`scale(${a/s})`,o=`${p.x}px ${p.y}px`}const d=n.onTransitionEnd;return this.$container.addClass(Ca.transitionClassName),this.$content.off(Ca.transitionEventName).on(Ca.transitionEventName,h=>{this.syncTransition(a,{x:e,y:t}),typeof d=="function"&&dn(d,this,h.originalEvent)}).css({transform:i,transformOrigin:o,transition:"transform",transitionDuration:n.duration||"1s",transitionDelay:n.delay,transitionTimingFunction:n.timing}),this}syncTransition(e,t){return this.beforeManipulation(),this.graph.scale(e),this.removeTransition(),this.centerPoint(t.x,t.y),this.afterManipulation(),this}removeTransition(){return this.$container.removeClass(Ca.transitionClassName),this.$content.off(Ca.transitionEventName).css({transform:"",transformOrigin:"",transition:"",transitionDuration:"",transitionDelay:"",transitionTimingFunction:""}),this}transitionToRect(e,t={}){const n=Ht.create(e),i=t.maxScale||Infinity,o=t.minScale||Number.MIN_VALUE,s=t.scaleGrid||null,a=t.visibility||1,l=t.center?pe.create(t.center):n.getCenter(),c=this.getClientSize(),u=c.width*a,d=c.height*a;let h=new Ht(l.x-u/2,l.y-d/2,u,d).getMaxUniformScaleToFit(n,l);return h=Math.min(h,i),s&&(h=Math.floor(h/s)*s),h=Math.max(o,h),this.transitionToPoint(l,Object.assign({scale:h},t))}startPanning(e){const t=this.normalizeEvent(e);this.clientX=t.clientX,this.clientY=t.clientY,this.trigger("pan:start",{e:t}),this.$(document.body).on({"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this),"mouseleave.panning":this.stopPanning.bind(this)}),this.$(window).on("mouseup.panning",this.stopPanning.bind(this))}pan(e){const t=this.normalizeEvent(e),n=t.clientX-this.clientX,i=t.clientY-this.clientY;this.container.scrollTop-=i,this.container.scrollLeft-=n,this.clientX=t.clientX,this.clientY=t.clientY,this.trigger("panning",{e:t})}stopPanning(e){this.$(document.body).off(".panning"),this.$(window).off(".panning"),this.trigger("pan:stop",{e})}clientToLocalPoint(e,t){let n=typeof e=="object"?e.x:e,i=typeof e=="object"?e.y:t;const o=this.graph.matrix();return n+=this.container.scrollLeft-this.padding.left-o.e,i+=this.container.scrollTop-this.padding.top-o.f,new pe(n/o.a,i/o.d)}localToBackgroundPoint(e,t){const n=typeof e=="object"?pe.create(e):new pe(e,t),i=this.graph.matrix(),o=this.padding;return xl(n,i).translate(o.left,o.top)}resize(e,t){let n=e!=null?e:this.container.offsetWidth,i=t!=null?t:this.container.offsetHeight;typeof n=="number"&&(n=Math.round(n)),typeof i=="number"&&(i=Math.round(i)),this.options.width=n,this.options.height=i,this.$container.css({width:n,height:i}),this.update()}getClientSize(){return this.cachedClientSize?this.cachedClientSize:{width:this.container.clientWidth,height:this.container.clientHeight}}autoScroll(e,t){const n=10,i=this.container,o=i.getBoundingClientRect();let s=0,a=0;return e<=o.left+n&&(s=-n),t<=o.top+n&&(a=-n),e>=o.right-n&&(s=n),t>=o.bottom-n&&(a=n),s!==0&&(i.scrollLeft+=s),a!==0&&(i.scrollTop+=a),{scrollerX:s,scrollerY:a}}addPadding(e,t,n,i){let o=this.getPadding();this.padding={left:Math.round(o.left+(e||0)),top:Math.round(o.top+(n||0)),bottom:Math.round(o.bottom+(i||0)),right:Math.round(o.right+(t||0))},o=this.padding,this.$content.css({width:o.left+this.graph.options.width+o.right,height:o.top+this.graph.options.height+o.bottom});const s=this.graph.container;return s.style.left=`${this.padding.left}px`,s.style.top=`${this.padding.top}px`,this}getPadding(){const e=this.options.padding;return typeof e=="function"?Us(dn(e,this,this)):Us(e)}getVisibleArea(){const e=this.graph.matrix(),t=this.getClientSize(),n={x:this.container.scrollLeft||0,y:this.container.scrollTop||0,width:t.width,height:t.height},i=Vs(n,e.inverse());return i.x-=(this.padding.left||0)/this.sx,i.y-=(this.padding.top||0)/this.sy,i}isCellVisible(e,t={}){const n=e.getBBox(),i=this.getVisibleArea();return t.strict?i.containsRect(n):i.isIntersectWithRect(n)}isPointVisible(e){return this.getVisibleArea().containsPoint(e)}lock(){return this.$container.css("overflow","hidden"),this}unlock(){return this.$container.css("overflow","scroll"),this}onRemove(){this.stopListening()}dispose(){this.$(this.graph.container).insertBefore(this.$container),this.remove()}}SU([Fr.dispose()],Gf.prototype,"dispose",null),function(r){class e extends by{constructor(n){super(n.graph);this.scroller=n,n.options.background&&this.draw(n.options.background)}get elem(){return this.scroller.background}init(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}updateBackgroundOptions(n){this.scroller.options.background=n}}r.Background=e}(Gf||(Gf={}));var Ca;(function(r){r.containerClass="graph-scroller",r.panningClass=`${r.containerClass}-panning`,r.pannableClass=`${r.containerClass}-pannable`,r.pagedClass=`${r.containerClass}-paged`,r.contentClass=`${r.containerClass}-content`,r.backgroundClass=`${r.containerClass}-background`,r.transitionClassName="transition-in-progress",r.transitionEventName="transitionend.graph-scroller-transition",r.defaultOptions={padding(){const t=this.getClientSize(),n=Math.max(this.options.minVisibleWidth||0,1)||1,i=Math.max(this.options.minVisibleHeight||0,1)||1,o=Math.max(t.width-n,0),s=Math.max(t.height-i,0);return{left:o,top:s,right:o,bottom:s}},minVisibleWidth:50,minVisibleHeight:50,pageVisible:!1,pageBreak:!1,autoResize:!0};function e(t){const n=ir({},r.defaultOptions,t);return n.pageWidth==null&&(n.pageWidth=t.graph.options.width),n.pageHeight==null&&(n.pageHeight=t.graph.options.height),n}r.getOptions=e})(Ca||(Ca={}));function To(r,e,t,n={}){if(t){const i=t.graph,o=i.view.normalizeEvent(e),s=i.snapToGrid(o.clientX,o.clientY);t.notify(r,Object.assign({e:o,view:t,node:t.cell,cell:t.cell,x:s.x,y:s.y},n))}}var AU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class u1 extends Fr{constructor(e){super();this.options=ir({},Ss.defaultOptions,e),this.options.model&&(this.options.collection=this.options.model.collection),this.options.collection?this.collection=this.options.collection:(this.collection=new UA([],{comparator:Ss.depthComparator}),this.options.collection=this.collection),this.boxCount=0,this.createContainer(),this.initHandles(),this.startListening()}get graph(){return this.options.graph}get boxClassName(){return this.prefixClassName(Ss.classNames.box)}get $boxes(){return this.$container.children(`.${this.boxClassName}`)}get handleOptions(){return this.options}startListening(){const e=this.graph,t=this.collection;this.delegateEvents({[`mousedown .${this.boxClassName}`]:"onSelectionBoxMouseDown",[`touchstart .${this.boxClassName}`]:"onSelectionBoxMouseDown"},!0),e.on("scale",this.onGraphTransformed,this),e.on("translate",this.onGraphTransformed,this),e.model.on("updated",this.onModelUpdated,this),t.on("added",this.onCellAdded,this),t.on("removed",this.onCellRemoved,this),t.on("reseted",this.onReseted,this),t.on("updated",this.onCollectionUpdated,this),t.on("node:change:position",this.onNodePositionChanged,this),t.on("cell:changed",this.onCellChanged,this)}stopListening(){const e=this.graph,t=this.collection;this.undelegateEvents(),e.off("scale",this.onGraphTransformed,this),e.off("translate",this.onGraphTransformed,this),e.model.off("updated",this.onModelUpdated,this),t.off("added",this.onCellAdded,this),t.off("removed",this.onCellRemoved,this),t.off("reseted",this.onReseted,this),t.off("updated",this.onCollectionUpdated,this),t.off("node:change:position",this.onNodePositionChanged,this),t.off("cell:changed",this.onCellChanged,this)}onRemove(){this.stopListening()}onGraphTransformed(){this.updateSelectionBoxes({async:!1})}onCellChanged(){this.updateSelectionBoxes()}onNodePositionChanged({node:e,options:t}){const{showNodeSelectionBox:n,pointerEvents:i}=this.options,{ui:o,selection:s,translateBy:a,snapped:l}=t,c=(n!==!0||i==="none")&&!this.translating&&!s,u=o&&a&&e.id===a;if(c&&(u||l)){this.translating=!0;const d=e.position(),h=e.previous("position"),f=d.x-h.x,p=d.y-h.y;(f!==0||p!==0)&&this.translateSelectedNodes(f,p,e,t),this.translating=!1}}onModelUpdated({removed:e}){e&&e.length&&this.unselect(e)}isEmpty(){return this.length<=0}isSelected(e){return this.collection.has(e)}get length(){return this.collection.length}get cells(){return this.collection.toArray()}select(e,t={}){t.dryrun=!0;const n=this.filter(Array.isArray(e)?e:[e]);return this.collection.add(n,t),this}unselect(e,t={}){return t.dryrun=!0,this.collection.remove(Array.isArray(e)?e:[e],t),this}reset(e,t={}){if(e){if(t.batch){const c=this.filter(Array.isArray(e)?e:[e]);return this.collection.reset(c,Object.assign(Object.assign({},t),{ui:!0})),this}const n=this.cells,i=this.filter(Array.isArray(e)?e:[e]),o={},s={};n.forEach(c=>o[c.id]=c),i.forEach(c=>s[c.id]=c);const a=[],l=[];return i.forEach(c=>{o[c.id]||a.push(c)}),n.forEach(c=>{s[c.id]||l.push(c)}),l.length&&this.unselect(l,Object.assign(Object.assign({},t),{ui:!0})),a.length&&this.select(a,Object.assign(Object.assign({},t),{ui:!0})),l.length===0&&a.length===0&&this.updateContainer(),this}return this.clean(t)}clean(e={}){return this.length&&(e.batch===!1?this.unselect(this.cells,e):this.collection.reset([],Object.assign(Object.assign({},e),{ui:!0}))),this}setFilter(e){this.options.filter=e}setContent(e){this.options.content=e}startSelecting(e){e=this.normalizeEvent(e),this.clean();let t,n;const i=this.graph.container;if(e.offsetX!=null&&e.offsetY!=null&&i.contains(e.target))t=e.offsetX,n=e.offsetY;else{const o=this.$(i).offset(),s=i.scrollLeft,a=i.scrollTop;t=e.clientX-o.left+window.pageXOffset+s,n=e.clientY-o.top+window.pageYOffset+a}this.$container.css({top:n,left:t,width:1,height:1}),this.setEventData(e,{action:"selecting",clientX:e.clientX,clientY:e.clientY,offsetX:t,offsetY:n,scrollerX:0,scrollerY:0,moving:!1}),this.delegateDocumentEvents(Ss.documentEvents,e.data)}filter(e){const t=this.options.filter;return Array.isArray(t)?e.filter(n=>!t.includes(n)&&!t.includes(n.shape)):typeof t=="function"?e.filter(n=>dn(t,this.graph,n)):e}stopSelecting(e){const t=this.graph,n=this.getEventData(e);switch(n.action){case"selecting":{let o=this.$container.width(),s=this.$container.height();const a=this.$container.offset(),l=t.pageToLocal(a.left,a.top),c=t.transform.getScale();o/=c.sx,s/=c.sy;const u=new Ht(l.x,l.y,o,s),d=this.getCellViewsInArea(u).map(h=>h.cell);this.reset(d,{batch:!0}),this.hideRubberband();break}case"translating":{const o=t.snapToGrid(e.clientX,e.clientY);if(!this.options.following){const s=n;this.updateSelectedNodesPosition({dx:s.clientX-s.originX,dy:s.clientY-s.originY})}this.graph.model.stopBatch("move-selection"),this.notifyBoxEvent("box:mouseup",e,o.x,o.y);break}default:{this.clean();break}}}onMouseUp(e){this.getEventData(e).action&&(this.stopSelecting(e),this.undelegateDocumentEvents())}onSelectionBoxMouseDown(e){this.options.following||e.stopPropagation();const t=this.normalizeEvent(e);this.options.movable&&this.startTranslating(t);const n=this.getCellViewFromElem(t.target);this.setEventData(t,{activeView:n});const i=this.graph.snapToGrid(t.clientX,t.clientY);this.notifyBoxEvent("box:mousedown",t,i.x,i.y),this.delegateDocumentEvents(Ss.documentEvents,t.data)}startTranslating(e){this.graph.model.startBatch("move-selection");const t=this.graph.snapToGrid(e.clientX,e.clientY);this.setEventData(e,{action:"translating",clientX:t.x,clientY:t.y,originX:t.x,originY:t.y})}getSelectionOffset(e,t){let n=e.x-t.clientX,i=e.y-t.clientY;const o=this.graph.hook.getRestrictArea();if(o){const s=this.collection.toArray(),a=Tr.getCellsBBox(s,{deep:!0})||Ht.create(),l=o.x-a.x,c=o.y-a.y,u=o.x+o.width-(a.x+a.width),d=o.y+o.height-(a.y+a.height);if(n<l&&(n=l),i<c&&(i=c),u<n&&(n=u),d<i&&(i=d),!this.options.following){const h=e.x-t.originX,f=e.y-t.originY;n=h<=l||h>=u?0:n,i=f<=c||f>=d?0:i}}return{dx:n,dy:i}}updateSelectedNodesPosition(e){const{dx:t,dy:n}=e;if(t||n)if(this.translateSelectedNodes(t,n),this.boxesUpdated)this.collection.length>1&&this.updateSelectionBoxes();else{const i=this.graph.transform.getScale();this.$boxes.add(this.$selectionContainer).css({left:`+=${t*i.sx}`,top:`+=${n*i.sy}`})}}autoScrollGraph(e,t){const n=this.graph.scroller.widget;return n?n.autoScroll(e,t):{scrollerX:0,scrollerY:0}}adjustSelection(e){const t=this.normalizeEvent(e),n=this.getEventData(t);switch(n.action){case"selecting":{const o=n;o.moving!==!0&&(this.$container.appendTo(this.graph.container),this.showRubberband(),o.moving=!0);const{scrollerX:s,scrollerY:a}=this.autoScrollGraph(t.clientX,t.clientY);o.scrollerX+=s,o.scrollerY+=a;const l=t.clientX-o.clientX+o.scrollerX,c=t.clientY-o.clientY+o.scrollerY,u=parseInt(this.$container.css("left"),10),d=parseInt(this.$container.css("top"),10);this.$container.css({left:l<0?o.offsetX+l:u,top:c<0?o.offsetY+c:d,width:Math.abs(l),height:Math.abs(c)});break}case"translating":{const o=this.graph.snapToGrid(t.clientX,t.clientY),s=n,a=this.getSelectionOffset(o,s);this.options.following?this.updateSelectedNodesPosition(a):this.updateContainerPosition(a),a.dx&&(s.clientX=o.x),a.dy&&(s.clientY=o.y),this.notifyBoxEvent("box:mousemove",e,o.x,o.y);break}default:break}this.boxesUpdated=!1}translateSelectedNodes(e,t,n,i){const o={},s=[];if(n&&(o[n.id]=!0),this.collection.toArray().forEach(a=>{a.getDescendants({deep:!0}).forEach(l=>{o[l.id]=!0})}),i&&i.translateBy){const a=this.graph.getCellById(i.translateBy);a&&(o[a.id]=!0,a.getDescendants({deep:!0}).forEach(l=>{o[l.id]=!0}),s.push(a))}this.collection.toArray().forEach(a=>{if(!o[a.id]){const l=Object.assign(Object.assign({},i),{selection:this.cid,exclude:s});a.translate(e,t,l),this.graph.model.getConnectedEdges(a).forEach(c=>{o[c.id]||(c.translate(e,t,l),o[c.id]=!0)})}})}getCellViewsInArea(e){const t=this.graph,n={strict:this.options.strict};let i=[];return this.options.rubberNode&&(this.options.useCellGeometry?i=i.concat(t.model.getNodesInArea(e,n).map(o=>t.renderer.findViewByCell(o)).filter(o=>o!=null)):i=i.concat(t.renderer.findViewsInArea(e,n))),this.options.rubberEdge&&(this.options.useCellGeometry?i=i.concat(t.model.getEdgesInArea(e,n).map(o=>t.renderer.findViewByCell(o)).filter(o=>o!=null)):i=i.concat(t.renderer.findEdgeViewsInArea(e,n))),i}notifyBoxEvent(e,t,n,i){const s=this.getEventData(t).activeView;this.trigger(e,{e:t,view:s,x:n,y:i,cell:s.cell})}getSelectedClassName(e){return this.prefixClassName(`${e.isNode()?"node":"edge"}-selected`)}addCellSelectedClassName(e){const t=this.graph.renderer.findViewByCell(e);t&&t.addClass(this.getSelectedClassName(e))}removeCellUnSelectedClassName(e){const t=this.graph.renderer.findViewByCell(e);t&&t.removeClass(this.getSelectedClassName(e))}destroySelectionBox(e){this.removeCellUnSelectedClassName(e),this.canShowSelectionBox(e)&&(this.$container.find(`[data-cell-id="${e.id}"]`).remove(),this.$boxes.length===0&&this.hide(),this.boxCount=Math.max(0,this.boxCount-1))}destroyAllSelectionBoxes(e){e.forEach(t=>this.removeCellUnSelectedClassName(t)),this.hide(),this.$boxes.remove(),this.boxCount=0}hide(){this.$container.removeClass(this.prefixClassName(Ss.classNames.rubberband)).removeClass(this.prefixClassName(Ss.classNames.selected))}showRubberband(){this.$container.addClass(this.prefixClassName(Ss.classNames.rubberband))}hideRubberband(){this.$container.removeClass(this.prefixClassName(Ss.classNames.rubberband))}showSelected(){this.$container.removeAttr("style").addClass(this.prefixClassName(Ss.classNames.selected))}createContainer(){this.container=document.createElement("div"),this.$container=this.$(this.container),this.$container.addClass(this.prefixClassName(Ss.classNames.root)),this.options.className&&this.$container.addClass(this.options.className),this.$selectionContainer=this.$("<div/>").addClass(this.prefixClassName(Ss.classNames.inner)),this.$selectionContent=this.$("<div/>").addClass(this.prefixClassName(Ss.classNames.content)),this.$selectionContainer.append(this.$selectionContent),this.$selectionContainer.attr("data-selection-length",this.collection.length),this.$container.prepend(this.$selectionContainer),this.$handleContainer=this.$selectionContainer}updateContainerPosition(e){(e.dx||e.dy)&&this.$selectionContainer.css({left:`+=${e.dx}`,top:`+=${e.dy}`})}updateContainer(){const e={x:Infinity,y:Infinity},t={x:0,y:0};this.collection.toArray().filter(o=>this.canShowSelectionBox(o)).forEach(o=>{const s=this.graph.renderer.findViewByCell(o);if(s){const a=s.getBBox({useCellGeometry:this.options.useCellGeometry});e.x=Math.min(e.x,a.x),e.y=Math.min(e.y,a.y),t.x=Math.max(t.x,a.x+a.width),t.y=Math.max(t.y,a.y+a.height)}}),this.$selectionContainer.css({position:"absolute",pointerEvents:"none",left:e.x,top:e.y,width:t.x-e.x,height:t.y-e.y}).attr("data-selection-length",this.collection.length);const i=this.options.content;if(i)if(typeof i=="function"){const o=dn(i,this.graph,this,this.$selectionContent[0]);o&&this.$selectionContent.html(o)}else this.$selectionContent.html(i);this.collection.length>0&&!this.container.parentNode?this.$container.appendTo(this.graph.container):this.collection.length<=0&&this.container.parentNode&&this.container.parentNode.removeChild(this.container)}canShowSelectionBox(e){return e.isNode()&&this.options.showNodeSelectionBox===!0||e.isEdge()&&this.options.showEdgeSelectionBox===!0}createSelectionBox(e){if(this.addCellSelectedClassName(e),this.canShowSelectionBox(e)){const t=this.graph.renderer.findViewByCell(e);if(t){const n=t.getBBox({useCellGeometry:this.options.useCellGeometry}),i=this.boxClassName;this.$("<div/>").addClass(i).addClass(`${i}-${e.isNode()?"node":"edge"}`).attr("data-cell-id",e.id).css({position:"absolute",left:n.x,top:n.y,width:n.width,height:n.height,pointerEvents:this.options.pointerEvents||"auto"}).appendTo(this.container),this.showSelected(),this.boxCount+=1}}}updateSelectionBoxes(e={}){this.collection.length>0&&(this.boxesUpdated=!0,this.graph.renderer.requestViewUpdate(this,1,2,e))}confirmUpdate(){return this.boxCount&&(this.hide(),this.$boxes.each((e,t)=>{const n=this.$(t).remove().attr("data-cell-id"),i=this.collection.get(n);i&&this.createSelectionBox(i)}),this.updateContainer()),0}getCellViewFromElem(e){const t=e.getAttribute("data-cell-id");if(t){const n=this.collection.get(t);if(n)return this.graph.renderer.findViewByCell(n)}return null}onCellRemoved({cell:e}){this.destroySelectionBox(e),this.updateContainer()}onReseted({previous:e,current:t}){this.destroyAllSelectionBoxes(e),t.forEach(n=>{this.listenCellRemoveEvent(n),this.createSelectionBox(n)}),this.updateContainer()}onCellAdded({cell:e}){this.listenCellRemoveEvent(e),this.createSelectionBox(e),this.updateContainer()}listenCellRemoveEvent(e){e.off("removed",this.onCellRemoved,this),e.on("removed",this.onCellRemoved,this)}onCollectionUpdated({added:e,removed:t,options:n}){e.forEach(o=>{this.trigger("cell:selected",{cell:o,options:n}),this.graph.trigger("cell:selected",{cell:o,options:n}),o.isNode()?(this.trigger("node:selected",{cell:o,options:n,node:o}),this.graph.trigger("node:selected",{cell:o,options:n,node:o})):o.isEdge()&&(this.trigger("edge:selected",{cell:o,options:n,edge:o}),this.graph.trigger("edge:selected",{cell:o,options:n,edge:o}))}),t.forEach(o=>{this.trigger("cell:unselected",{cell:o,options:n}),this.graph.trigger("cell:unselected",{cell:o,options:n}),o.isNode()?(this.trigger("node:unselected",{cell:o,options:n,node:o}),this.graph.trigger("node:unselected",{cell:o,options:n,node:o})):o.isEdge()&&(this.trigger("edge:unselected",{cell:o,options:n,edge:o}),this.graph.trigger("edge:unselected",{cell:o,options:n,edge:o}))});const i={added:e,removed:t,options:n,selected:this.cells.filter(o=>!!this.graph.getCellById(o.id))};this.trigger("selection:changed",i),this.graph.trigger("selection:changed",i)}deleteSelectedCells(){const e=this.collection.toArray();this.clean(),this.graph.model.removeCells(e,{selection:this.cid})}startRotate({e}){const t=this.collection.toArray(),n=Tr.getCellsBBox(t).getCenter(),i=this.graph.snapToGrid(e.clientX,e.clientY),o=t.reduce((s,a)=>(s[a.id]=Rr.normalize(a.getAngle()),s),{});this.setEventData(e,{center:n,angles:o,start:i.theta(n)})}doRotate({e}){const t=this.getEventData(e),n=this.graph.options.rotating.grid,i=typeof n=="function"?dn(n,this.graph,null):n,o=this.graph.snapToGrid(e.clientX,e.clientY),s=t.start-o.theta(t.center);t.rotated||(t.rotated=!0),Math.abs(s)>.001&&(this.collection.toArray().forEach(a=>{const l=ao.snapToGrid(t.angles[a.id]+s,i||15);a.rotate(l,{absolute:!0,center:t.center,selection:this.cid})}),this.updateSelectionBoxes())}stopRotate({e}){const t=this.getEventData(e);t.rotated&&(t.rotated=!1,this.collection.toArray().forEach(n=>{To("node:rotated",e,this.graph.findViewByCell(n))}))}startResize({e}){const t=this.graph.getGridSize(),n=this.collection.toArray(),i=Tr.getCellsBBox(n),o=n.map(l=>l.getBBox()),s=o.reduce((l,c)=>c.width<l?c.width:l,Infinity),a=o.reduce((l,c)=>c.height<l?c.height:l,Infinity);this.setEventData(e,{bbox:i,cells:this.graph.model.getSubGraph(n),minWidth:t*i.width/s,minHeight:t*i.height/a})}doResize({e,dx:t,dy:n}){const i=this.eventData(e),o=i.bbox,s=o.width,a=o.height,l=Math.max(s+t,i.minWidth),c=Math.max(a+n,i.minHeight);i.resized||(i.resized=!0),(Math.abs(s-l)>.001||Math.abs(a-c)>.001)&&(this.graph.model.resizeCells(l,c,i.cells,{selection:this.cid}),o.width=l,o.height=c,this.updateSelectionBoxes())}stopResize({e}){const t=this.eventData(e);t.resized&&(t.resized=!1,this.collection.toArray().forEach(n=>{To("node:resized",e,this.graph.findViewByCell(n))}))}dispose(){this.clean(),this.remove()}}AU([Fr.dispose()],u1.prototype,"dispose",null),QE(u1,Ld);var Ss;(function(r){const e="widget-selection";r.classNames={root:e,inner:`${e}-inner`,box:`${e}-box`,content:`${e}-content`,rubberband:`${e}-rubberband`,selected:`${e}-selected`},r.documentEvents={mousemove:"adjustSelection",touchmove:"adjustSelection",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},r.defaultOptions={movable:!0,following:!0,strict:!1,useCellGeometry:!1,content(n){return pf('<%= length %> node<%= length > 1 ? "s":"" %> selected.')({length:n.length})},handles:[{name:"remove",position:"nw",events:{mousedown:"deleteSelectedCells"}},{name:"rotate",position:"sw",events:{mousedown:"startRotate",mousemove:"doRotate",mouseup:"stopRotate"}},{name:"resize",position:"se",events:{mousedown:"startResize",mousemove:"doResize",mouseup:"stopResize"}}]};function t(n){return n.getAncestors().length}r.depthComparator=t})(Ss||(Ss={}));class $A extends Jg{get node(){return this.cell}get containerClassName(){return this.prefixClassName("widget-transform")}get resizeClassName(){return`${this.containerClassName}-resize`}get rotateClassName(){return`${this.containerClassName}-rotate`}init(e){this.options=Object.assign(Object.assign({},Ro.defaultOptions),e),this.render(),this.startListening()}startListening(){this.delegateEvents({[`mousedown .${this.resizeClassName}`]:"startResizing",[`touchstart .${this.resizeClassName}`]:"startResizing",[`mousedown .${this.rotateClassName}`]:"startRotating",[`touchstart .${this.rotateClassName}`]:"startRotating"}),this.model.on("*",this.update,this),this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this),this.node.on("removed",this.remove,this),this.model.on("reseted",this.remove,this),this.view.on("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.on("cell:knob:mouseup",this.onKnobMouseUp,this),super.startListening()}stopListening(){this.undelegateEvents(),this.model.off("*",this.update,this),this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this),this.node.off("removed",this.remove,this),this.model.off("reseted",this.remove,this),this.view.off("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.off("cell:knob:mouseup",this.onKnobMouseUp,this),super.stopListening()}renderHandles(){this.container=document.createElement("div"),this.$container=this.$(this.container);const e=this.$("<div/>").prop("draggable",!1),t=e.clone().addClass(this.rotateClassName),n=Ro.POSITIONS.map(i=>e.clone().addClass(this.resizeClassName).attr("data-position",i));this.empty(),this.$container.append(n,t)}render(){return this.renderHandles(),this.view.addClass(Ro.NODE_CLS),this.$container.addClass(this.containerClassName).toggleClass("no-orth-resize",this.options.preserveAspectRatio||!this.options.orthogonalResizing).toggleClass("no-resize",!this.options.resizable).toggleClass("no-rotate",!this.options.rotatable),this.options.className&&this.$container.addClass(this.options.className),this.graph.container.appendChild(this.container),this.update()}update(){const e=this.graph.matrix(),t=this.node.getBBox();t.x*=e.a,t.x+=e.e,t.y*=e.d,t.y+=e.f,t.width*=e.a,t.height*=e.d;const n=Rr.normalize(this.node.getAngle()),i=n!==0?`rotate(${n}deg)`:"";return this.$container.css({transform:i,width:t.width,height:t.height,left:t.x,top:t.y}),this.updateResizerDirections(),this}remove(){return this.view.removeClass(Ro.NODE_CLS),super.remove()}onKnobMouseDown(){this.startHandle()}onKnobMouseUp(){this.stopHandle()}updateResizerDirections(){const e=Rr.normalize(this.node.getAngle()),t=Math.floor(e*(Ro.DIRECTIONS.length/360));if(t!==this.prevShift){const n=Ro.DIRECTIONS.slice(t).concat(Ro.DIRECTIONS.slice(0,t)),i=o=>`${this.containerClassName}-cursor-${o}`;this.$container.find(`.${this.resizeClassName}`).removeClass(Ro.DIRECTIONS.map(o=>i(o)).join(" ")).each((o,s)=>{this.$(s).addClass(i(n[o]))}),this.prevShift=t}}getTrueDirection(e){const t=Rr.normalize(this.node.getAngle());let n=Ro.POSITIONS.indexOf(e);return n+=Math.floor(t*(Ro.POSITIONS.length/360)),n%=Ro.POSITIONS.length,Ro.POSITIONS[n]}toValidResizeDirection(e){return{top:"top-left",bottom:"bottom-right",left:"bottom-left",right:"top-right"}[e]||e}startResizing(e){e.stopPropagation(),this.model.startBatch("resize",{cid:this.cid});const t=this.$(e.target).attr("data-position"),n=this.graph.findViewByCell(this.node);this.prepareResizing(e,t),this.startAction(e),To("node:resize:mousedown",e,n)}prepareResizing(e,t){const n=this.getTrueDirection(t);let i=0,o=0;t.split("-").forEach(c=>{i={left:-1,right:1}[c]||i,o={top:-1,bottom:1}[c]||o});const s=this.toValidResizeDirection(t),a={"top-right":"bottomLeft","top-left":"bottomRight","bottom-left":"topRight","bottom-right":"topLeft"}[s],l=Rr.normalize(this.node.getAngle());this.setEventData(e,{selector:a,direction:s,trueDirection:n,relativeDirection:t,angle:l,resizeX:i,resizeY:o,action:"resizing"})}startRotating(e){e.stopPropagation(),this.model.startBatch("rotate",{cid:this.cid});const t=this.graph.findViewByCell(this.node),n=this.node.getBBox().getCenter(),i=this.normalizeEvent(e),o=this.graph.snapToGrid(i.clientX,i.clientY);this.setEventData(e,{center:n,action:"rotating",angle:Rr.normalize(this.node.getAngle()),start:pe.create(o).theta(n)}),this.startAction(e),To("node:rotate:mousedown",e,t)}onMouseMove(e){const t=this.graph.findViewByCell(this.node);let n=this.getEventData(e);if(n.action){const i=this.normalizeEvent(e);let o=i.clientX,s=i.clientY;const a=this.graph.scroller.widget,l=this.options.restrictedResizing;if(l===!0||typeof l=="number"){const f=l===!0?0:l,p=a?Math.max(f,8):f,g=this.graph.container.getBoundingClientRect();o=ws(o,g.left+p,g.right-p),s=ws(s,g.top+p,g.bottom-p)}else this.options.autoScrollOnResizing&&a&&a.autoScroll(o,s);const c=this.graph.snapToGrid(o,s),u=this.graph.getGridSize(),d=this.node,h=this.options;if(n.action==="resizing"){n=n,n.resized||(t&&(t.addClass("node-resizing"),To("node:resize",e,t)),n.resized=!0);const f=d.getBBox(),p=pe.create(c).rotate(n.angle,f.getCenter()).diff(f[n.selector]);let g=n.resizeX?p.x*n.resizeX:f.width,v=n.resizeY?p.y*n.resizeY:f.height;const y=g,x=v;if(g=ao.snapToGrid(g,u),v=ao.snapToGrid(v,u),g=Math.max(g,h.minWidth||u),v=Math.max(v,h.minHeight||u),g=Math.min(g,h.maxWidth||Infinity),v=Math.min(v,h.maxHeight||Infinity),h.preserveAspectRatio){const T=f.width*v/f.height,P=f.height*g/f.width;g<T?v=P:g=T}const E=n.relativeDirection;if(h.allowReverse&&(y<=-g||x<=-v)){let T;E==="left"?y<=-g&&(T="right"):E==="right"?y<=-g&&(T="left"):E==="top"?x<=-v&&(T="bottom"):E==="bottom"?x<=-v&&(T="top"):E==="top-left"?y<=-g&&x<=-v?T="bottom-right":y<=-g?T="top-right":x<=-v&&(T="bottom-left"):E==="top-right"?y<=-g&&x<=-v?T="bottom-left":y<=-g?T="top-left":x<=-v&&(T="bottom-right"):E==="bottom-left"?y<=-g&&x<=-v?T="top-right":y<=-g?T="bottom-right":x<=-v&&(T="top-left"):E==="bottom-right"&&(y<=-g&&x<=-v?T="top-left":y<=-g?T="bottom-left":x<=-v&&(T="top-right"));const P=T;this.stopHandle();const z=this.$container.find(`.${this.resizeClassName}[data-position="${P}"]`);this.startHandle(z[0]),this.prepareResizing(e,P),this.onMouseMove(e)}if(f.width!==g||f.height!==v){const T={ui:!0,direction:n.direction,relativeDirection:n.relativeDirection,trueDirection:n.trueDirection,minWidth:h.minWidth,minHeight:h.minHeight,maxWidth:h.maxWidth,maxHeight:h.maxHeight,preserveAspectRatio:h.preserveAspectRatio===!0};d.resize(g,v,T),To("node:resizing",e,t)}To("node:resize:mousemove",e,t)}else if(n.action==="rotating"){n=n,n.rotated||(t&&(t.addClass("node-rotating"),To("node:rotate",e,t)),n.rotated=!0);const f=d.getAngle(),p=n.start-pe.create(c).theta(n.center);let g=n.angle+p;h.rotateGrid&&(g=ao.snapToGrid(g,h.rotateGrid)),g=Rr.normalize(g),f!==g&&(d.rotate(g,{absolute:!0}),To("node:rotating",e,t)),To("node:rotate:mousemove",e,t)}}}onMouseUp(e){const t=this.graph.findViewByCell(this.node),n=this.getEventData(e);n.action&&(this.stopAction(e),this.model.stopBatch(n.action==="resizing"?"resize":"rotate",{cid:this.cid}),n.action==="resizing"?To("node:resize:mouseup",e,t):n.action==="rotating"&&To("node:rotate:mouseup",e,t))}startHandle(e){if(this.handle=e||null,this.$container.addClass(`${this.containerClassName}-active`),e){this.$(e).addClass(`${this.containerClassName}-active-handle`);const t=e.getAttribute("data-position");if(t){const n=Ro.DIRECTIONS[Ro.POSITIONS.indexOf(t)];this.$container.addClass(`${this.containerClassName}-cursor-${n}`)}}}stopHandle(){if(this.$container.removeClass(`${this.containerClassName}-active`),this.handle){this.$(this.handle).removeClass(`${this.containerClassName}-active-handle`);const e=this.handle.getAttribute("data-position");if(e){const t=Ro.DIRECTIONS[Ro.POSITIONS.indexOf(e)];this.$container.removeClass(`${this.containerClassName}-cursor-${t}`)}this.handle=null}}startAction(e){this.startHandle(e.target),this.graph.view.undelegateEvents(),this.delegateDocumentEvents(Ro.documentEvents,e.data)}stopAction(e){this.stopHandle(),this.undelegateDocumentEvents(),this.graph.view.delegateEvents();const t=this.graph.findViewByCell(this.node),n=this.getEventData(e);t&&(t.removeClass(`node-${n.action}`),n.action==="resizing"&&n.resized?To("node:resized",e,t):n.action==="rotating"&&n.rotated&&To("node:rotated",e,t))}}var Ro;(function(r){r.NODE_CLS="has-widget-transform",r.DIRECTIONS=["nw","n","ne","e","se","s","sw","w"],r.POSITIONS=["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"],r.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp"},r.defaultOptions={minWidth:0,minHeight:0,maxWidth:Infinity,maxHeight:Infinity,rotateGrid:15,rotatable:!0,preserveAspectRatio:!1,orthogonalResizing:!0,restrictedResizing:!1,autoScrollOnResizing:!0,allowReverse:!0}})(Ro||(Ro={}));var TU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t},La;(function(r){function e(t,n,i){const o={};return Object.keys(i||{}).forEach(s=>{const a=i[s];o[s]=typeof a=="function"?a.call(t,n):a}),o}r.parseOptionGroup=e})(La||(La={})),function(r){function e(t){const{grid:n,panning:i,selecting:o,embedding:s,snapline:a,resizing:l,rotating:c,knob:u,clipboard:d,history:h,scroller:f,minimap:p,keyboard:g,mousewheel:v}=t,y=TU(t,["grid","panning","selecting","embedding","snapline","resizing","rotating","knob","clipboard","history","scroller","minimap","keyboard","mousewheel"]),x=t.container;if(x!=null)y.width==null&&(y.width=x.clientWidth),y.height==null&&(y.height=x.clientHeight);else throw new Error("Ensure the container of the graph is specified and valid");const E=ir({},r.defaults,y),T={size:10,visible:!1};return typeof n=="number"?E.grid={size:n,visible:!1}:typeof n=="boolean"?E.grid=Object.assign(Object.assign({},T),{visible:n}):E.grid=Object.assign(Object.assign({},T),n),["panning","selecting","embedding","snapline","resizing","rotating","knob","clipboard","history","scroller","minimap","keyboard","mousewheel"].forEach(z=>{const $=t[z];typeof $=="boolean"?E[z].enabled=$:E[z]=Object.assign(Object.assign({},E[z]),$)}),E.background&&E.scroller.enabled&&E.scroller.background==null&&(E.scroller.background=E.background,delete E.background),E}r.get=e}(La||(La={})),function(r){r.defaults={x:0,y:0,grid:{size:10,visible:!1},scaling:{min:.01,max:16},background:!1,highlighting:{default:{name:"stroke",args:{padding:3}},nodeAvailable:{name:"className",args:{className:ao.prefix("available-node")}},magnetAvailable:{name:"className",args:{className:ao.prefix("available-magnet")}}},connecting:{snap:!1,multi:!0,dangling:!0,allowLoop:!0,allowNode:!0,allowEdge:!1,allowPort:!0,highlight:!1,anchor:"center",edgeAnchor:"ratio",connectionPoint:"boundary",strategy:null,router:"normal",connector:"normal",validateConnection({type:e,sourceView:t,targetView:n}){return(e==="target"?n:t)!=null},createEdge(){return new _l}},transforming:{clearAll:!0,clearOnBlankMouseDown:!0},resizing:{enabled:!1,minWidth:0,minHeight:0,maxWidth:Number.MAX_SAFE_INTEGER,maxHeight:Number.MAX_SAFE_INTEGER,orthogonal:!0,restricted:!1,autoScroll:!0,preserveAspectRatio:!1,allowReverse:!0},rotating:{enabled:!1,grid:15},translating:{restrict:!1},knob:{enabled:!1,clearAll:!0,clearOnBlankMouseDown:!0},embedding:{enabled:!1,findParent:"bbox",frontOnly:!0,validate:()=>!0},selecting:{enabled:!1,rubberband:!1,rubberNode:!0,rubberEdge:!1,pointerEvents:"auto",multiple:!0,multipleSelectionModifiers:["ctrl","meta"],movable:!0,strict:!1,useCellGeometry:!1,selectCellOnMoved:!1,selectNodeOnMoved:!1,selectEdgeOnMoved:!1,content:null,handles:null},panning:{enabled:!1,eventTypes:["leftMouseDown"]},snapline:{enabled:!1},clipboard:{enabled:!1},history:{enabled:!1},scroller:{enabled:!1},keyboard:{enabled:!1},mousewheel:{enabled:!1,factor:1.2,zoomAtMousePosition:!0},async:!1,frozen:!1,sorting:"exact",moveThreshold:0,clickThreshold:0,magnetThreshold:0,preventDefaultDblClick:!0,preventDefaultMouseDown:!1,preventDefaultContextMenu:!0,preventDefaultBlankAction:!0,interacting:{edgeLabelMovable:!1},guard:()=>!1}}(La||(La={}));var WA=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class ZA extends hi{get cid(){return this.graph.view.cid}get svg(){return this.view.svg}get defs(){return this.view.defs}isDefined(e){return this.svg.getElementById(e)!=null}filter(e){let t=e.id;const n=e.name;if(t||(t=`filter-${n}-${this.cid}-${wC(JSON.stringify(e))}`),!this.isDefined(t)){const i=Sf.registry.get(n);if(i==null)return Sf.registry.onNotFound(n);const o=i(e.args||{}),s=Object.assign(Object.assign({x:-1,y:-1,width:3,height:3,filterUnits:"objectBoundingBox"},e.attrs),{id:t});pn.create(Ur.sanitize(o),s).appendTo(this.defs)}return t}gradient(e){let t=e.id;const n=e.type;if(t||(t=`gradient-${n}-${this.cid}-${wC(JSON.stringify(e))}`),!this.isDefined(t)){const o=e.stops.map(l=>{const c=l.opacity!=null&&Number.isFinite(l.opacity)?l.opacity:1;return`<stop offset="${l.offset}" stop-color="${l.color}" stop-opacity="${c}"/>`}),s=`<${n}>${o.join("")}</${n}>`,a=Object.assign({id:t},e.attrs);pn.create(s,a).appendTo(this.defs)}return t}marker(e){const{id:t,refX:n,refY:i,markerUnits:o,markerOrient:s,tagName:a,children:l}=e,c=WA(e,["id","refX","refY","markerUnits","markerOrient","tagName","children"]);let u=t;if(u||(u=`marker-${this.cid}-${wC(JSON.stringify(e))}`),!this.isDefined(u)){a!=="path"&&delete c.d;const d=pn.create("marker",{refX:n,refY:i,id:u,overflow:"visible",orient:s!=null?s:"auto",markerUnits:o||"userSpaceOnUse"},l?l.map(h=>{var{tagName:f}=h,p=WA(h,["tagName"]);return pn.create(`${f}`||"path",kg(Object.assign(Object.assign({},c),p)))}):[pn.create(a||"path",kg(c))]);this.defs.appendChild(d.node)}return u}remove(e){const t=this.svg.getElementById(e);t&&t.parentNode&&t.parentNode.removeChild(t)}}var MU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o},PU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class d1 extends hi{get elem(){return this.view.grid}get grid(){return this.options.grid}init(){this.startListening(),this.draw(this.grid)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}setVisible(e){this.grid.visible!==e&&(this.grid.visible=e,this.update())}getGridSize(){return this.grid.size}setGridSize(e){this.grid.size=Math.max(e,1),this.update()}show(){this.setVisible(!0),this.update()}hide(){this.setVisible(!1),this.update()}clear(){this.elem.style.backgroundImage=""}draw(e){this.clear(),this.instance=null,Object.assign(this.grid,e),this.patterns=this.resolveGrid(e),this.update()}update(e={}){const t=this.grid.size;if(t<=1||!this.grid.visible)return this.clear();const n=this.graph.matrix(),i=this.getInstance(),o=Array.isArray(e)?e:[e];this.patterns.forEach((l,c)=>{const u=`pattern_${c}`,d=n.a||1,h=n.d||1,{update:f,markup:p}=l,g=PU(l,["update","markup"]),v=Object.assign(Object.assign(Object.assign({},g),o[c]),{sx:d,sy:h,ox:n.e||0,oy:n.f||0,width:t*d,height:t*h});i.has(u)||i.add(u,pn.create("pattern",{id:u,patternUnits:"userSpaceOnUse"},pn.createVectors(p)).node);const y=i.get(u);typeof f=="function"&&f(y.childNodes[0],v);let x=v.ox%v.width;x<0&&(x+=v.width);let E=v.oy%v.height;E<0&&(E+=v.height),ei(y,{x,y:E,width:v.width,height:v.height})});const s=new XMLSerializer().serializeToString(i.root),a=`url(data:image/svg+xml;base64,${btoa(s)})`;this.elem.style.backgroundImage=a}getInstance(){return this.instance||(this.instance=new su),this.instance}resolveGrid(e){if(!e)return[];const t=e.type;if(t==null)return[Object.assign(Object.assign({},su.presets.dot),e.args)];const n=su.registry.get(t);if(n){let i=e.args||[];return Array.isArray(i)||(i=[i]),Array.isArray(n)?n.map((o,s)=>Object.assign(Object.assign({},o),i[s])):[Object.assign(Object.assign({},n),i[0])]}return su.registry.onNotFound(t)}dispose(){this.stopListening(),this.clear()}}MU([hi.dispose()],d1.prototype,"dispose",null);class XA extends hi{getClientMatrix(){return Do(this.view.stage.getScreenCTM())}getClientOffset(){const e=this.view.svg.getBoundingClientRect();return new pe(e.left,e.top)}getPageOffset(){return this.getClientOffset().translate(window.scrollX,window.scrollY)}snapToGrid(e,t){return(typeof e=="number"?this.clientToLocalPoint(e,t):this.clientToLocalPoint(e.x,e.y)).snapToGrid(this.graph.getGridSize())}localToGraphPoint(e,t){const n=pe.create(e,t);return xl(n,this.graph.matrix())}localToClientPoint(e,t){const n=pe.create(e,t);return xl(n,this.getClientMatrix())}localToPagePoint(e,t){return(typeof e=="number"?this.localToGraphPoint(e,t):this.localToGraphPoint(e)).translate(this.getPageOffset())}localToGraphRect(e,t,n,i){const o=Ht.create(e,t,n,i);return Vs(o,this.graph.matrix())}localToClientRect(e,t,n,i){const o=Ht.create(e,t,n,i);return Vs(o,this.getClientMatrix())}localToPageRect(e,t,n,i){return(typeof e=="number"?this.localToGraphRect(e,t,n,i):this.localToGraphRect(e)).translate(this.getPageOffset())}graphToLocalPoint(e,t){const n=pe.create(e,t);return xl(n,this.graph.matrix().inverse())}clientToLocalPoint(e,t){const n=pe.create(e,t);return xl(n,this.getClientMatrix().inverse())}clientToGraphPoint(e,t){const n=pe.create(e,t);return xl(n,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalPoint(e,t){const i=pe.create(e,t).diff(this.getPageOffset());return this.graphToLocalPoint(i)}graphToLocalRect(e,t,n,i){const o=Ht.create(e,t,n,i);return Vs(o,this.graph.matrix().inverse())}clientToLocalRect(e,t,n,i){const o=Ht.create(e,t,n,i);return Vs(o,this.getClientMatrix().inverse())}clientToGraphRect(e,t,n,i){const o=Ht.create(e,t,n,i);return Vs(o,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalRect(e,t,n,i){const o=Ht.create(e,t,n,i),s=this.getPageOffset();return o.x-=s.x,o.y-=s.y,this.graphToLocalRect(o)}}var OU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class h1 extends hi{constructor(){super(...arguments);this.widget=this.graph.hook.createSnapline()}dispose(){this.widget.dispose()}}OU([hi.dispose()],h1.prototype,"dispose",null);var fu;(function(r){function e(i){const o=[],s=[];return Array.isArray(i)?o.push(...i):i.split("|").forEach(a=>{a.indexOf("&")===-1?o.push(a):s.push(...a.split("&"))}),{or:o,and:s}}r.parse=e;function t(i,o){if(i!=null&&o!=null){const s=e(i),a=e(o),l=s.or.sort(),c=a.or.sort(),u=s.and.sort(),d=a.and.sort(),h=(f,p)=>f.length===p.length&&(f.length===0||f.every((g,v)=>g===p[v]));return h(l,c)&&h(u,d)}return i==null&&o==null}r.equals=t;function n(i,o,s){if(o==null||Array.isArray(o)&&o.length===0)return s?i.altKey!==!0&&i.ctrlKey!==!0&&i.metaKey!==!0&&i.shiftKey!==!0:!0;const{or:a,and:l}=e(o),c=u=>{const d=`${u.toLowerCase()}Key`;return i[d]===!0};return a.some(u=>c(u))&&l.every(u=>c(u))}r.isMatch=n})(fu||(fu={}));var DU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class f1 extends hi{get widgetOptions(){return this.options.scroller}get pannable(){return this.widgetOptions?typeof this.widgetOptions.pannable=="object"?this.widgetOptions.pannable.enabled:!!this.widgetOptions.pannable:!1}init(){this.widget=this.graph.hook.createScroller(),this.startListening(),this.updateClassName(),this.widget&&this.widget.center()}startListening(){let e=[];const t=this.widgetOptions.pannable;typeof t=="object"?e=t.eventTypes||[]:e=["leftMouseDown"],e.includes("leftMouseDown")&&(this.graph.on("blank:mousedown",this.preparePanning,this),this.graph.on("node:unhandled:mousedown",this.preparePanning,this),this.graph.on("edge:unhandled:mousedown",this.preparePanning,this)),e.includes("rightMouseDown")&&(this.onRightMouseDown=this.onRightMouseDown.bind(this),this.view.$(this.widget.container).on("mousedown",this.onRightMouseDown))}stopListening(){let e=[];const t=this.widgetOptions.pannable;typeof t=="object"?e=t.eventTypes||[]:e=["leftMouseDown"],e.includes("leftMouseDown")&&(this.graph.off("blank:mousedown",this.preparePanning,this),this.graph.off("node:unhandled:mousedown",this.preparePanning,this),this.graph.off("edge:unhandled:mousedown",this.preparePanning,this)),e.includes("rightMouseDown")&&this.view.$(this.widget.container).off("mousedown",this.onRightMouseDown)}onRightMouseDown(e){e.button===2&&this.allowPanning(e,!0)&&this.widget&&(this.updateClassName(!0),this.widget.startPanning(e),this.widget.once("pan:stop",()=>this.updateClassName(!1)))}preparePanning({e}){this.widget&&(this.allowPanning(e,!0)||this.allowPanning(e)&&!this.graph.selection.allowRubberband(e,!0))&&(this.updateClassName(!0),this.widget.startPanning(e),this.widget.once("pan:stop",()=>this.updateClassName(!1)))}allowPanning(e,t){return this.widget&&this.pannable&&fu.isMatch(e,this.widgetOptions.modifiers,t)&&this.graph.hook.allowPanning(e)}updateClassName(e){if(this.widget==null)return;const t=this.widget.container,n=this.view.prefixClassName("graph-scroller-pannable");this.pannable?(Qr(t,n),t.dataset.panning=(!!e).toString()):ma(t,n)}enablePanning(){this.pannable||(this.widgetOptions.pannable=!0,this.updateClassName())}disablePanning(){this.pannable&&(this.widgetOptions.pannable=!1,this.updateClassName())}lock(){this.widget&&this.widget.lock()}unlock(){this.widget&&this.widget.unlock()}update(){this.widget&&this.widget.update()}enableAutoResize(){this.widget&&this.widget.enableAutoResize()}disableAutoResize(){this.widget&&this.widget.disableAutoResize()}resize(e,t){this.widget&&this.widget.resize(e,t)}dispose(){this.widget&&this.widget.dispose(),this.stopListening()}}DU([hi.dispose()],f1.prototype,"dispose",null);var NU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o},RU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class p1 extends hi{get commonOptions(){const e=this.instanceOptions,{enabled:t}=e;return RU(e,["enabled"])}get instanceOptions(){return this.options.clipboard}get cells(){return this.widget.cells}get disabled(){return this.instanceOptions.enabled!==!0}init(){this.widget=this.graph.hook.createClipboard(),this.widget.deserialize(this.instanceOptions)}enable(){this.disabled&&(this.instanceOptions.enabled=!0)}disable(){this.disabled||(this.instanceOptions.enabled=!1)}copy(e,t={}){this.disabled||(this.widget.copy(e,this.graph,Object.assign(Object.assign({},this.commonOptions),t)),this.graph.trigger("clipboard:changed",{cells:e}))}cut(e,t={}){this.disabled||(this.widget.cut(e,this.graph,Object.assign(Object.assign({},this.commonOptions),t)),this.graph.trigger("clipboard:changed",{cells:e}))}paste(e={},t=this.graph){return this.disabled?[]:this.widget.paste(t,Object.assign(Object.assign({},this.commonOptions),e))}clean(e){(!this.disabled||e)&&(this.widget.clean(),this.graph.trigger("clipboard:changed",{cells:[]}))}isEmpty(){return this.widget.isEmpty()}dispose(){this.clean(!0)}}NU([hi.dispose()],p1.prototype,"dispose",null);var kU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class xy extends hi{constructor(){super(...arguments);this.highlights={}}init(){this.startListening()}startListening(){this.graph.on("cell:highlight",this.onCellHighlight,this),this.graph.on("cell:unhighlight",this.onCellUnhighlight,this)}stopListening(){this.graph.off("cell:highlight",this.onCellHighlight,this),this.graph.off("cell:unhighlight",this.onCellUnhighlight,this)}onCellHighlight({view:e,magnet:t,options:n={}}){const i=this.resolveHighlighter(n);if(!i)return;const o=this.getHighlighterId(t,i);if(!this.highlights[o]){const s=i.highlighter;s.highlight(e,t,Object.assign({},i.args)),this.highlights[o]={cellView:e,magnet:t,highlighter:s,args:i.args}}}onCellUnhighlight({magnet:e,options:t={}}){const n=this.resolveHighlighter(t);if(!n)return;const i=this.getHighlighterId(e,n);this.unhighlight(i)}resolveHighlighter(e){const t=this.options;let n=e.highlighter;if(n==null){const a=e.type;n=a&&t.highlighting[a]||t.highlighting.default}if(n==null)return null;const i=typeof n=="string"?{name:n}:n,o=i.name,s=cc.registry.get(o);return s==null?cc.registry.onNotFound(o):(cc.check(o,s),{name:o,highlighter:s,args:i.args||{}})}getHighlighterId(e,t){return Vv(e),t.name+e.id+JSON.stringify(t.args)}unhighlight(e){const t=this.highlights[e];t&&(t.highlighter.unhighlight(t.cellView,t.magnet,t.args),delete this.highlights[e])}dispose(){Object.keys(this.highlights).forEach(e=>this.unhighlight(e)),this.stopListening()}}kU([xy.dispose()],xy.prototype,"dispose",null);var IU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class Cy extends hi{constructor(){super(...arguments);this.widgets=new Map}get container(){return this.graph.view.container}get viewport(){return this.graph.view.viewport}get isSelectionEnabled(){return this.options.selecting.enabled===!0}init(){this.startListening(),this.resize()}startListening(){this.graph.on("node:mouseup",this.onNodeMouseUp,this),this.graph.on("node:selected",this.onNodeSelected,this),this.graph.on("node:unselected",this.onNodeUnSelected,this)}stopListening(){this.graph.off("node:mouseup",this.onNodeMouseUp,this),this.graph.off("node:selected",this.onNodeSelected,this),this.graph.off("node:unselected",this.onNodeUnSelected,this)}onNodeMouseUp({node:e}){if(!this.isSelectionEnabled){const t=this.graph.hook.createTransform(e,{clearAll:!0});t&&this.widgets.set(e,t)}}onNodeSelected({node:e}){if(this.isSelectionEnabled){const t=this.graph.hook.createTransform(e,{clearAll:!1});t&&this.widgets.set(e,t)}}onNodeUnSelected({node:e}){if(this.isSelectionEnabled){const t=this.widgets.get(e);t&&t.dispose(),this.widgets.delete(e)}}getMatrix(){const e=this.viewport.getAttribute("transform");return e!==this.viewportTransformString&&(this.viewportMatrix=this.viewport.getCTM(),this.viewportTransformString=e),Do(this.viewportMatrix)}setMatrix(e){const t=Do(e),n=Nd(t);this.viewport.setAttribute("transform",n),this.viewportMatrix=t,this.viewportTransformString=n}resize(e,t){let n=e===void 0?this.options.width:e,i=t===void 0?this.options.height:t;this.options.width=n,this.options.height=i,typeof n=="number"&&(n=Math.round(n)),typeof i=="number"&&(i=Math.round(i)),this.container.style.width=n==null?"":`${n}px`,this.container.style.height=i==null?"":`${i}px`;const o=this.getComputedSize();return this.graph.trigger("resize",Object.assign({},o)),this}getComputedSize(){let e=this.options.width,t=this.options.height;return SC(e)||(e=this.container.clientWidth),SC(t)||(t=this.container.clientHeight),{width:e,height:t}}getScale(){return G6(this.getMatrix())}scale(e,t=e,n=0,i=0,o={}){if(e=this.clampScale(e),t=this.clampScale(t),n||i){const a=this.getTranslation(),l=a.tx-n*(e-1),c=a.ty-i*(t-1);(l!==a.tx||c!==a.ty)&&this.translate(l,c)}const s=this.getMatrix();return s.a=e,s.d=t,this.setMatrix(s),this.graph.trigger("scale",Object.assign({sx:e,sy:t,ox:n,oy:i},o)),this}clampScale(e){const t=this.graph.options.scaling;return ws(e,t.min||.01,t.max||16)}getZoom(){return this.getScale().sx}zoom(e,t){t=t||{};let n=e,i=e;const o=this.getScale(),s=this.getComputedSize();let a=s.width/2,l=s.height/2;if(t.absolute||(n+=o.sx,i+=o.sy),t.scaleGrid&&(n=Math.round(n/t.scaleGrid)*t.scaleGrid,i=Math.round(i/t.scaleGrid)*t.scaleGrid),t.maxScale&&(n=Math.min(t.maxScale,n),i=Math.min(t.maxScale,i)),t.minScale&&(n=Math.max(t.minScale,n),i=Math.max(t.minScale,i)),t.center&&(a=t.center.x,l=t.center.y),n=this.clampScale(n),i=this.clampScale(i),a||l){const c=this.getTranslation(),u=a-(a-c.tx)*(n/o.sx),d=l-(l-c.ty)*(i/o.sy);(u!==c.tx||d!==c.ty)&&this.translate(u,d,{ui:t.ui})}return this.scale(n,i,0,0,{ui:t.ui}),this}getRotation(){return F6(this.getMatrix())}rotate(e,t,n){if(t==null||n==null){const o=No(this.graph.view.stage);t=o.width/2,n=o.height/2}const i=this.getMatrix().translate(t,n).rotate(e).translate(-t,-n);return this.setMatrix(i),this}getTranslation(){return B6(this.getMatrix())}translate(e,t,n={}){const i=this.getMatrix();i.e=e||0,i.f=t||0,this.setMatrix(i);const o=this.getTranslation();return this.options.x=o.tx,this.options.y=o.ty,this.graph.trigger("translate",Object.assign(Object.assign({},o),n)),this}setOrigin(e,t){return this.translate(e||0,t||0)}fitToContent(e,t,n,i){if(typeof e=="object"){const E=e;e=E.gridWidth||1,t=E.gridHeight||1,n=E.padding||0,i=E}else e=e||1,t=t||1,n=n||0,i==null&&(i={});const o=Us(n),s=i.border||0,a=i.contentArea?Ht.create(i.contentArea):this.getContentArea(i);s>0&&a.inflate(s);const l=this.getScale(),c=this.getTranslation(),u=l.sx,d=l.sy;a.x*=u,a.y*=d,a.width*=u,a.height*=d;let h=Math.max(Math.ceil((a.width+a.x)/e),1)*e,f=Math.max(Math.ceil((a.height+a.y)/t),1)*t,p=0,g=0;(i.allowNewOrigin==="negative"&&a.x<0||i.allowNewOrigin==="positive"&&a.x>=0||i.allowNewOrigin==="any")&&(p=Math.ceil(-a.x/e)*e,p+=o.left,h+=p),(i.allowNewOrigin==="negative"&&a.y<0||i.allowNewOrigin==="positive"&&a.y>=0||i.allowNewOrigin==="any")&&(g=Math.ceil(-a.y/t)*t,g+=o.top,f+=g),h+=o.right,f+=o.bottom,h=Math.max(h,i.minWidth||0),f=Math.max(f,i.minHeight||0),h=Math.min(h,i.maxWidth||Number.MAX_SAFE_INTEGER),f=Math.min(f,i.maxHeight||Number.MAX_SAFE_INTEGER);const v=this.getComputedSize(),y=h!==v.width||f!==v.height;return(p!==c.tx||g!==c.ty)&&this.translate(p,g),y&&this.resize(h,f),new Ht(-p/u,-g/d,h/u,f/d)}scaleContentToFit(e={}){this.scaleContentToFitImpl(e)}scaleContentToFitImpl(e={},t=!0){let n,i;if(e.contentArea){const y=e.contentArea;n=this.graph.localToGraph(y),i=pe.create(y)}else n=this.getContentBBox(e),i=this.graph.graphToLocal(n);if(!n.width||!n.height)return;const o=Us(e.padding),s=e.minScale||0,a=e.maxScale||Number.MAX_SAFE_INTEGER,l=e.minScaleX||s,c=e.maxScaleX||a,u=e.minScaleY||s,d=e.maxScaleY||a;let h;if(e.viewportArea)h=e.viewportArea;else{const y=this.getComputedSize(),x=this.getTranslation();h={x:x.tx,y:x.ty,width:y.width,height:y.height}}h=Ht.create(h).moveAndExpand({x:o.left,y:o.top,width:-o.left-o.right,height:-o.top-o.bottom});const f=this.getScale();let p=h.width/n.width*f.sx,g=h.height/n.height*f.sy;e.preserveAspectRatio!==!1&&(p=g=Math.min(p,g));const v=e.scaleGrid;if(v&&(p=v*Math.floor(p/v),g=v*Math.floor(g/v)),p=ws(p,l,c),g=ws(g,u,d),this.scale(p,g),t){const y=this.options,x=h.x-i.x*p-y.x,E=h.y-i.y*g-y.y;this.translate(x,E)}}getContentArea(e={}){return e.useCellGeometry?this.model.getAllCellsBBox()||new Ht:No(this.graph.view.stage)}getContentBBox(e={}){return this.graph.localToGraph(this.getContentArea(e))}getGraphArea(){const e=Ht.fromSize(this.getComputedSize());return this.graph.graphToLocal(e)}zoomToRect(e,t={}){const n=Ht.create(e),i=this.graph;t.contentArea=n,t.viewportArea==null&&(t.viewportArea={x:i.options.x,y:i.options.y,width:this.options.width,height:this.options.height}),this.scaleContentToFitImpl(t,!1);const o=n.getCenter();return this.centerPoint(o.x,o.y),this}zoomToFit(e={}){return this.zoomToRect(this.getContentArea(e),e)}centerPoint(e,t){const n=this.getComputedSize(),i=this.getScale(),o=this.getTranslation(),s=n.width/2,a=n.height/2;e=typeof e=="number"?e:s,t=typeof t=="number"?t:a,e=s-e*i.sx,t=a-t*i.sy,(o.tx!==e||o.ty!==t)&&this.translate(e,t)}centerContent(e){const n=this.graph.getContentArea(e).getCenter();this.centerPoint(n.x,n.y)}centerCell(e){return this.positionCell(e,"center")}positionPoint(e,t,n){const i=this.getComputedSize();t=Ra(t,Math.max(0,i.width)),t<0&&(t=i.width+t),n=Ra(n,Math.max(0,i.height)),n<0&&(n=i.height+n);const o=this.getTranslation(),s=this.getScale(),a=t-e.x*s.sx,l=n-e.y*s.sy;(o.tx!==a||o.ty!==l)&&this.translate(a,l)}positionRect(e,t){const n=Ht.create(e);switch(t){case"center":return this.positionPoint(n.getCenter(),"50%","50%");case"top":return this.positionPoint(n.getTopCenter(),"50%",0);case"top-right":return this.positionPoint(n.getTopRight(),"100%",0);case"right":return this.positionPoint(n.getRightMiddle(),"100%","50%");case"bottom-right":return this.positionPoint(n.getBottomRight(),"100%","100%");case"bottom":return this.positionPoint(n.getBottomCenter(),"50%","100%");case"bottom-left":return this.positionPoint(n.getBottomLeft(),0,"100%");case"left":return this.positionPoint(n.getLeftMiddle(),0,"50%");case"top-left":return this.positionPoint(n.getTopLeft(),0,0);default:return this}}positionCell(e,t){const n=e.getBBox();return this.positionRect(n,t)}positionContent(e,t){const n=this.graph.getContentArea(t);return this.positionRect(n,e)}dispose(){this.widgets.forEach(e=>e.dispose()),this.widgets.clear(),this.stopListening()}}IU([Cy.dispose()],Cy.prototype,"dispose",null);var LU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class g1 extends hi{constructor(){super(...arguments);this.movedMap=new WeakMap,this.unselectMap=new WeakMap}get widgetOptions(){return this.options.selecting}get rubberbandDisabled(){return this.widgetOptions.enabled!==!0||this.widgetOptions.rubberband!==!0}get disabled(){return this.widgetOptions.enabled!==!0}get length(){return this.widget.length}get cells(){return this.widget.cells}init(){this.widget=this.graph.hook.createSelection(),this.startListening()}startListening(){this.graph.on("blank:mousedown",this.onBlankMouseDown,this),this.graph.on("blank:click",this.onBlankClick,this),this.graph.on("cell:mousemove",this.onCellMouseMove,this),this.graph.on("cell:mouseup",this.onCellMouseUp,this),this.widget.on("box:mousedown",this.onBoxMouseDown,this)}stopListening(){this.graph.off("blank:mousedown",this.onBlankMouseDown,this),this.graph.off("blank:click",this.onBlankClick,this),this.graph.off("cell:mousemove",this.onCellMouseMove,this),this.graph.off("cell:mouseup",this.onCellMouseUp,this),this.widget.off("box:mousedown",this.onBoxMouseDown,this)}onBlankMouseDown({e}){(this.allowRubberband(e,!0)||this.allowRubberband(e)&&!this.graph.scroller.allowPanning(e,!0)&&!this.graph.panning.allowPanning(e,!0))&&this.startRubberband(e)}onBlankClick(){this.clean()}allowRubberband(e,t){return!this.rubberbandDisabled&&fu.isMatch(e,this.widgetOptions.modifiers,t)&&this.graph.hook.allowRubberband(e)}allowMultipleSelection(e){return this.isMultiple()&&fu.isMatch(e,this.widgetOptions.multipleSelectionModifiers)}onCellMouseMove({cell:e}){this.movedMap.set(e,!0)}onCellMouseUp({e,cell:t}){const n=this.widgetOptions;let i=this.disabled;!i&&this.movedMap.has(t)&&(i=n.selectCellOnMoved===!1,i||(i=n.selectNodeOnMoved===!1&&t.isNode()),i||(i=n.selectEdgeOnMoved===!1&&t.isEdge())),i||(this.allowMultipleSelection(e)?this.unselectMap.has(t)?this.unselectMap.delete(t):this.isSelected(t)?this.unselect(t):this.select(t):this.reset(t)),this.movedMap.delete(t)}onBoxMouseDown({e,cell:t}){this.disabled||this.allowMultipleSelection(e)&&(this.unselect(t),this.unselectMap.set(t,!0))}isEmpty(){return this.length<=0}isSelected(e){return this.widget.isSelected(e)}getCells(e){return(Array.isArray(e)?e:[e]).map(t=>typeof t=="string"?this.graph.getCellById(t):t).filter(t=>t!=null)}select(e,t={}){const n=this.getCells(e);return n.length&&(this.isMultiple()?this.widget.select(n,t):this.reset(n.slice(0,1),t)),this}unselect(e,t={}){return this.widget.unselect(this.getCells(e),t),this}reset(e,t={}){return this.widget.reset(e?this.getCells(e):[],t),this}clean(e={}){return this.widget.clean(e),this}enable(){return this.disabled&&(this.widgetOptions.enabled=!0),this}disable(){return this.disabled||(this.widgetOptions.enabled=!1),this}startRubberband(e){return this.rubberbandDisabled||this.widget.startSelecting(e),this}enableRubberband(){return this.rubberbandDisabled&&(this.widgetOptions.rubberband=!0),this}disableRubberband(){return this.rubberbandDisabled||(this.widgetOptions.rubberband=!1),this}isMultiple(){return this.widgetOptions.multiple!==!1}enableMultiple(){return this.widgetOptions.multiple=!0,this}disableMultiple(){return this.widgetOptions.multiple=!1,this}setModifiers(e){return this.widgetOptions.modifiers=e,this}setContent(e){return this.widget.setContent(e),this}setFilter(e){return this.widget.setFilter(e),this}dispose(){this.stopListening(),this.widget.dispose()}}LU([hi.dispose()],g1.prototype,"dispose",null);var YA=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o},GU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Fd extends rs{constructor(e){super();this.batchCommands=null,this.batchLevel=0,this.lastBatchIndex=-1,this.freezed=!1,this.handlers=[],this.graph=e.graph,this.model=e.graph.model,this.options=eo.getOptions(e),this.validator=new Fd.Validator({history:this,cancelInvalid:this.options.cancelInvalid}),this.clean(),this.startListening()}get disabled(){return this.options.enabled!==!0}enable(){this.disabled&&(this.options.enabled=!0)}disable(){this.disabled||(this.options.enabled=!1)}undo(e={}){if(!this.disabled){const t=this.undoStack.pop();t&&(this.revertCommand(t,e),this.redoStack.push(t),this.notify("undo",t,e))}return this}redo(e={}){if(!this.disabled){const t=this.redoStack.pop();t&&(this.applyCommand(t,e),this.undoStack.push(t),this.notify("redo",t,e))}return this}cancel(e={}){if(!this.disabled){const t=this.undoStack.pop();t&&(this.revertCommand(t,e),this.redoStack=[],this.notify("cancel",t,e))}return this}clean(e={}){return this.undoStack=[],this.redoStack=[],this.notify("clean",null,e),this}canUndo(){return!this.disabled&&this.undoStack.length>0}canRedo(){return!this.disabled&&this.redoStack.length>0}validate(e,...t){return this.validator.validate(e,...t),this}dispose(){this.validator.dispose(),this.clean(),this.stopListening()}startListening(){this.model.on("batch:start",this.initBatchCommand,this),this.model.on("batch:stop",this.storeBatchCommand,this),this.options.eventNames&&this.options.eventNames.forEach((e,t)=>{this.handlers[t]=this.addCommand.bind(this,e),this.model.on(e,this.handlers[t])}),this.validator.on("invalid",e=>this.trigger("invalid",e))}stopListening(){this.model.off("batch:start",this.initBatchCommand,this),this.model.off("batch:stop",this.storeBatchCommand,this),this.options.eventNames&&(this.options.eventNames.forEach((e,t)=>{this.model.off(e,this.handlers[t])}),this.handlers.length=0),this.validator.off("invalid")}createCommand(e){return{batch:e?e.batch:!1,data:{}}}revertCommand(e,t){this.freezed=!0;const n=Array.isArray(e)?eo.sortBatchCommands(e):[e];for(let i=n.length-1;i>=0;i-=1){const o=n[i],s=Object.assign(Object.assign({},t),Sg(o.options,this.options.revertOptionsList||[]));this.executeCommand(o,!0,s)}this.freezed=!1}applyCommand(e,t){this.freezed=!0;const n=Array.isArray(e)?eo.sortBatchCommands(e):[e];for(let i=0;i<n.length;i+=1){const o=n[i],s=Object.assign(Object.assign({},t),Sg(o.options,this.options.applyOptionsList||[]));this.executeCommand(o,!1,s)}this.freezed=!1}executeCommand(e,t,n){const i=this.model,o=i.getCell(e.data.id),s=e.event;if(eo.isAddEvent(s)&&t||eo.isRemoveEvent(s)&&!t)o&&o.remove(n);else if(eo.isAddEvent(s)&&!t||eo.isRemoveEvent(s)&&t){const a=e.data;a.node?i.addNode(a.props,n):a.edge&&i.addEdge(a.props,n)}else if(eo.isChangeEvent(s)){const a=e.data,l=a.key;if(l&&o){const c=t?a.prev[l]:a.next[l];o.prop(l,c,n)}}else{const a=this.options.executeCommand;a&&dn(a,this,e,t,n)}}addCommand(e,t){if(this.freezed||this.disabled)return;const n=t,i=n.options||{};if(i.dryrun||eo.isAddEvent(e)&&this.options.ignoreAdd||eo.isRemoveEvent(e)&&this.options.ignoreRemove||eo.isChangeEvent(e)&&this.options.ignoreChange)return;const o=this.options.beforeAddCommand;if(o!=null&&dn(o,this,e,t)===!1)return;e==="cell:change:*"&&(e=`cell:change:${n.key}`);const s=n.cell,a=is.isModel(s);let l;if(this.batchCommands){l=this.batchCommands[Math.max(this.lastBatchIndex,0)];const u=a&&!l.modelChange||l.data.id!==s.id,d=l.event!==e;if(this.lastBatchIndex>=0&&(u||d)){const h=this.batchCommands.findIndex(f=>(a&&f.modelChange||f.data.id===s.id)&&f.event===e);h<0||eo.isAddEvent(e)||eo.isRemoveEvent(e)?l=this.createCommand({batch:!0}):(l=this.batchCommands[h],this.batchCommands.splice(h,1)),this.batchCommands.push(l),this.lastBatchIndex=this.batchCommands.length-1}}else l=this.createCommand({batch:!1});if(eo.isAddEvent(e)||eo.isRemoveEvent(e)){const u=l.data;return l.event=e,l.options=i,u.id=s.id,u.props=Ki(s.toJSON()),s.isEdge()?u.edge=!0:s.isNode()&&(u.node=!0),this.push(l,i)}if(eo.isChangeEvent(e)){const u=t.key,d=l.data;return(!l.batch||!l.event)&&(l.event=e,l.options=i,d.key=u,d.prev==null&&(d.prev={}),d.prev[u]=Mg(s.previous(u)),a?l.modelChange=!0:d.id=s.id),d.next==null&&(d.next={}),d.next[u]=Mg(s.prop(u)),this.push(l,i)}const c=this.options.afterAddCommand;c&&dn(c,this,e,t,l),this.push(l,i)}initBatchCommand(e){this.freezed||(this.batchCommands?this.batchLevel+=1:(this.batchCommands=[this.createCommand({batch:!0})],this.batchLevel=0,this.lastBatchIndex=-1))}storeBatchCommand(e){if(!this.freezed)if(this.batchCommands&&this.batchLevel<=0){const t=this.filterBatchCommand(this.batchCommands);t.length>0&&(this.redoStack=[],this.undoStack.push(t),this.consolidateCommands(),this.notify("add",t,e)),this.batchCommands=null,this.lastBatchIndex=-1,this.batchLevel=0}else this.batchCommands&&this.batchLevel>0&&(this.batchLevel-=1)}filterBatchCommand(e){let t=e.slice();const n=[];for(;t.length>0;){const i=t.shift(),o=i.event,s=i.data.id;if(o!=null&&(s!=null||i.modelChange)){if(eo.isAddEvent(o)){const a=t.findIndex(l=>eo.isRemoveEvent(l.event)&&l.data.id===s);if(a>=0){t=t.filter((l,c)=>a<c||l.data.id!==s);continue}}else if(eo.isRemoveEvent(o)){const a=t.findIndex(l=>eo.isAddEvent(l.event)&&l.data.id===s);if(a>=0){t.splice(a,1);continue}}else if(eo.isChangeEvent(o)){const a=i.data;if(ri(a.prev,a.next))continue}n.push(i)}}return n}notify(e,t,n){const i=t==null?null:Array.isArray(t)?t:[t];this.emit(e,{cmds:i,options:n}),this.emit("change",{cmds:i,options:n})}push(e,t){this.redoStack=[],e.batch?(this.lastBatchIndex=Math.max(this.lastBatchIndex,0),this.emit("batch",{cmd:e,options:t})):(this.undoStack.push(e),this.consolidateCommands(),this.notify("add",e,t))}consolidateCommands(){var e;const t=this.undoStack[this.undoStack.length-1],n=this.undoStack[this.undoStack.length-2];if(!Array.isArray(t))return;const i=new Set(t.map(s=>s.event));if(i.size!==2||!i.has("cell:change:parent")||!i.has("cell:change:children")||!t.every(s=>{var a;return s.batch&&((a=s.options)===null||a===void 0?void 0:a.ui)})||!Array.isArray(n)||n.length!==1)return;const o=n[0];o.event!=="cell:change:position"||!((e=o.options)===null||e===void 0?void 0:e.ui)||(n.push(...t),this.undoStack.pop())}}YA([rs.dispose()],Fd.prototype,"dispose",null),function(r){class e extends rs{constructor(n){super();this.map={},this.command=n.history,this.cancelInvalid=n.cancelInvalid!==!1,this.command.on("add",this.onCommandAdded,this)}onCommandAdded({cmds:n}){return Array.isArray(n)?n.every(i=>this.isValidCommand(i)):this.isValidCommand(n)}isValidCommand(n){if(n.options&&n.options.validation===!1)return!0;const i=n.event&&this.map[n.event]||[];let o=null;return i.forEach(s=>{let a=0;const l=c=>{const u=s[a];a+=1;try{if(u)u(c,n,l);else{o=c;return}}catch(d){l(d)}};l(o)}),o?(this.cancelInvalid&&this.command.cancel(),this.emit("invalid",{err:o}),!1):!0}validate(n,...i){const o=Array.isArray(n)?n:n.split(/\s+/);return i.forEach(s=>{if(typeof s!="function")throw new Error(`${o.join(" ")} requires callback functions.`)}),o.forEach(s=>{this.map[s]==null&&(this.map[s]=[]),this.map[s].push(i)}),this}dispose(){this.command.off("add",this.onCommandAdded,this)}}YA([rs.dispose()],e.prototype,"dispose",null),r.Validator=e}(Fd||(Fd={}));var eo;(function(r){function e(s){return s==="cell:added"}r.isAddEvent=e;function t(s){return s==="cell:removed"}r.isRemoveEvent=t;function n(s){return s!=null&&s.startsWith("cell:change:")}r.isChangeEvent=n;function i(s){const{graph:a}=s,l=GU(s,["graph"]),c=["cell:added","cell:removed","cell:change:*"],u=["batch:start","batch:stop"],d=s.eventNames?s.eventNames.filter(h=>!(r.isChangeEvent(h)||c.includes(h)||u.includes(h))):c;return Object.assign(Object.assign({},l),{eventNames:d,applyOptionsList:s.applyOptionsList||["propertyPath"],revertOptionsList:s.revertOptionsList||["propertyPath"]})}r.getOptions=i;function o(s){const a=[];for(let l=0,c=s.length;l<c;l+=1){const u=s[l];let d=null;if(r.isAddEvent(u.event)){const h=u.data.id;for(let f=0;f<l;f+=1)if(s[f].data.id===h){d=f;break}}d!==null?a.splice(d,0,u):a.push(u)}return a}r.sortBatchCommands=o})(eo||(eo={}));var FU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class m1 extends hi{get widgetOptions(){return this.options.minimap}init(){this.widget=this.graph.hook.createMiniMap()}dispose(){this.widget&&this.widget.dispose()}}FU([hi.dispose()],m1.prototype,"dispose",null);var BU=w(42441),zU=w.n(BU),UU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class Bd extends ka{constructor(e){super();this.options=e;const t=this.graph.scroller.widget;this.container=t?t.container:this.graph.container,e.global?this.target=document:(this.target=this.container,this.disabled||this.target.setAttribute("tabindex","-1"),this.graph.on("cell:mouseup",this.focus,this),this.graph.on("blank:mouseup",this.focus,this)),this.mousetrap=Bd.createMousetrap(this)}get graph(){return this.options.graph}get disabled(){return this.options.enabled!==!0}enable(){this.disabled&&(this.options.enabled=!0,this.graph.options.keyboard.enabled=!0,this.target instanceof HTMLElement&&this.target.setAttribute("tabindex","-1"))}disable(){this.disabled||(this.options.enabled=!1,this.graph.options.keyboard.enabled=!1,this.target instanceof HTMLElement&&this.target.removeAttribute("tabindex"))}on(e,t,n){this.mousetrap.bind(this.getKeys(e),t,n)}off(e,t){this.mousetrap.unbind(this.getKeys(e),t)}focus(e){if(this.isInputEvent(e.e))return;this.target.focus({preventScroll:!0})}getKeys(e){return(Array.isArray(e)?e:[e]).map(t=>this.formatkey(t))}formatkey(e){const t=e.toLowerCase().replace(/\s/g,"").replace("delete","del").replace("cmd","command"),n=this.options.format;return n?dn(n,this.graph,t):t}isGraphEvent(e){const t=e.srcElement||e.target,n=e.currentTarget;return t?t===this.target||n===this.target||t===document.body?!0:kC(this.container,t):!1}isInputEvent(e){var t;const n=e.target,i=(t=n==null?void 0:n.tagName)===null||t===void 0?void 0:t.toLowerCase();return["input","textarea"].includes(i)}isEnabledForEvent(e){const t=!this.disabled&&this.isGraphEvent(e),n=this.isInputEvent(e);if(t){const i=e.keyCode||e.which;if(n&&(i===8||i===46))return!1;if(this.options.guard)return dn(this.options.guard,this.graph,e)}return t}dispose(){this.mousetrap.reset()}}UU([ka.dispose()],Bd.prototype,"dispose",null),function(r){function e(t){const n=new(zU())(t.target),i=n.stopCallback;return n.stopCallback=(o,s,a)=>t.isEnabledForEvent(o)?i?i.call(n,o,s,a):!1:!0,n}r.createMousetrap=e}(Bd||(Bd={}));var VU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class v1 extends ka{constructor(e){super();this.options=e,this.cumulatedFactor=1;const t=this.graph.scroller.widget;this.container=t?t.container:this.graph.container,this.target=this.options.global?document:this.container,this.mousewheelHandle=new N_(this.target,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.options.enabled&&this.enable(!0)}get graph(){return this.options.graph}get disabled(){return this.options.enabled!==!0}enable(e){(this.disabled||e)&&(this.options.enabled=!0,this.graph.options.mousewheel.enabled=!0,this.mousewheelHandle.enable())}disable(){this.disabled||(this.options.enabled=!1,this.graph.options.mousewheel.enabled=!1,this.mousewheelHandle.disable())}allowMouseWheel(e){const t=e.originalEvent||e,n=this.options.guard;return(n==null||n.call(this.graph,t))&&fu.isMatch(t,this.options.modifiers)}onMouseWheel(e){const t=e.originalEvent||e,n=this.options.guard;if((n==null||n.call(this.graph,t))&&fu.isMatch(t,this.options.modifiers)){const i=this.options.factor||1.2;this.currentScale==null&&(this.startPos={x:e.clientX,y:e.clientY},this.currentScale=this.graph.scroller.widget?this.graph.scroller.widget.zoom():this.graph.transform.getScale().sx),e.deltaY<0?this.currentScale<.15?this.cumulatedFactor=(this.currentScale+.01)/this.currentScale:this.cumulatedFactor=Math.round(this.currentScale*i*20)/20/this.currentScale:this.currentScale<=.15?this.cumulatedFactor=(this.currentScale-.01)/this.currentScale:this.cumulatedFactor=Math.round(this.currentScale*(1/i)*20)/20/this.currentScale,this.cumulatedFactor=Math.max(.01,Math.min(this.currentScale*this.cumulatedFactor,160)/this.currentScale);const s=this.graph.scroller.widget,a=this.currentScale;let l=this.graph.transform.clampScale(a*this.cumulatedFactor);const c=this.options.minScale||Number.MIN_SAFE_INTEGER,u=this.options.maxScale||Number.MAX_SAFE_INTEGER;if(l=ws(l,c,u),l!==a)if(s)if(this.options.zoomAtMousePosition){const d=this.graph.coord.clientToLocalPoint(this.startPos);s.zoom(l,{absolute:!0,center:d.clone()})}else s.zoom(l,{absolute:!0});else if(this.options.zoomAtMousePosition){const d=this.graph.coord.clientToGraphPoint(this.startPos);this.graph.transform.zoom(l,{absolute:!0,center:d.clone(),ui:!0})}else this.graph.transform.zoom(l,{absolute:!0,ui:!0});this.currentScale=null,this.cumulatedFactor=1}}dispose(){this.disable()}}VU([ka.dispose()],v1.prototype,"dispose",null);var jU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class zd extends hi{show(e={}){const t=Object.assign(Object.assign({},zd.defaultOptions),e),n=this.createPrintPages(t);t.ready(n,i=>this.showPrintWindow(i,t),{sheetSize:this.getSheetSize(t)})}get className(){return this.view.prefixClassName("graph-print")}showPrintWindow(e,t){if(e){const n=jr()(document.body),i=jr()(this.view.container),o=this.view.prefixClassName("graph-printing");n.addClass(o);const s=i.children().detach();e.forEach(c=>{c.removeClass(`${this.className}-preview`).addClass(`${this.className}-ready`).appendTo(n)});let a=!1;const l=()=>{a||(a=!0,n.removeClass(o),e.forEach(c=>c.remove()),i.append(s),jr()(`#${this.styleSheetId}`).remove(),this.graph.trigger("after:print",t),jr()(window).off("afterprint",l))};jr()(window).one("afterprint",l),setTimeout(l,200),window.print()}}createPrintPage(e,t){this.graph.trigger("before:print",t);const n=jr()("<div/>").addClass(this.className),i=jr()("<div/>").addClass(this.view.prefixClassName("graph-print-inner")).css("position","relative");t.size&&n.addClass(`${this.className}-size-${t.size}`);const o=pn.create(this.view.svg).clone(),s=o.findOne(`.${this.view.prefixClassName("graph-svg-stage")}`);i.append(o.node);const a=this.getSheetSize(t),l=this.graph.transform.getGraphArea(),c=this.graph.transform.getScale(),u=this.graph.translate(),d=Do().translate(u.tx/c.sx,u.ty/c.sy),h=this.getPageInfo(l,e,a),f=h.scale,p=h.bbox;return i.css({left:0,top:0}),o.attr({width:p.width*f,height:p.height*f,style:"position:relative",viewBox:[p.x,p.y,p.width,p.height].join(" ")}),s.attr("transform",Nd(d)),n.append(i),n.addClass(`${this.className}-preview`),{$page:n,sheetSize:a}}createPrintPages(e){let t;const n=this.getPrintArea(e),i=[];if(e.page){const o=this.getPageSize(n,e.page);this.getPageAreas(n,o).forEach(a=>{t=this.createPrintPage(a,e),i.push(t.$page)})}else t=this.createPrintPage(n,e),i.push(t.$page);if(t){const o={width:t.sheetSize.cssWidth,height:t.sheetSize.cssHeight};this.updatePrintStyle(o,e)}return i}get styleSheetId(){return this.view.prefixClassName("graph-print-style")}updatePrintStyle(e,t){const n=Object.keys(e).reduce((u,d)=>`${u} ${d}:${e[d]};`,""),i=Us(t.margin),o=t.marginUnit||"",s=t.sheetUnit||"",a=`
      @media print {
        .${this.className}.${this.className}-ready {
          ${n}
        }

        @page {
          margin:
          ${[i.top+o,i.right+o,i.bottom+o,i.left+o].join(" ")};
          size: ${t.sheet.width+s} ${t.sheet.height+s};

        .${this.className}.${this.className}-preview {
          ${n}
        }
      }`,l=this.styleSheetId,c=jr()(`#${l}`);c.length?c.html(a):jr()("head").append(`'<style type="text/css" id="${l}">${a}</style>'`)}getPrintArea(e){let t=e.area;if(!t){const n=Us(e.padding);t=this.graph.getContentArea().moveAndExpand({x:-n.left,y:-n.top,width:n.left+n.right,height:n.top+n.bottom})}return t}getPageSize(e,t){if(typeof t=="object"){const n=t,i={width:n.width,height:n.height};return i.width==null&&(i.width=Math.ceil(e.width/(n.columns||1))),i.height==null&&(i.height=Math.ceil(e.height/(n.rows||1))),i}return{width:e.width,height:e.height}}getPageAreas(e,t){const n=[],i=t.width,o=t.height;for(let s=0,a=0;s<e.height&&a<200;s+=o,a+=1)for(let l=0,c=0;l<e.width&&c<200;l+=i,c+=1)n.push(new Ht(e.x+l,e.y+s,i,o));return n}getSheetSize(e){const t=e.sheet,n=Us(e.margin),i=e.marginUnit||"",o=e.sheetUnit||"",s=`calc(${t.width}${o} - ${n.left+n.right}${i})`,a=`calc(${t.height}${o} - ${n.top+n.bottom}${i})`,l=UC.measure(s,a);return{cssWidth:s,cssHeight:a,width:l.width,height:l.height}}getPageInfo(e,t,n){const i=new Ht(t.x-e.x,t.y-e.y,t.width,t.height),o=i.width/i.height,s=n.width/n.height;return{bbox:i,scale:s<o?n.width/i.width:n.height/i.height,fitHorizontal:s<o}}dispose(){}}jU([hi.dispose()],zd.prototype,"dispose",null),function(r){r.defaultOptions={page:!1,sheet:{width:210,height:297},sheetUnit:"mm",margin:.4,marginUnit:"in",padding:5,ready:(e,t)=>t(e)}}(zd||(zd={}));class KA extends hi{toSVG(e,t={}){this.graph.trigger("before:export",t);const n=this.view.svg,i=pn.create(n).clone();let o=i.node;const s=i.findOne(`.${this.view.prefixClassName("graph-svg-stage")}`),a=t.viewBox||this.graph.graphToLocal(this.graph.getContentBBox()),l=t.preserveDimensions;if(l){const d=typeof l=="boolean"?a:l;i.attr({width:d.width,height:d.height})}if(i.removeAttribute("style").attr("viewBox",[a.x,a.y,a.width,a.height].join(" ")),s.removeAttribute("transform"),t.copyStyles!==!1){const d=n.ownerDocument,h=Array.from(n.querySelectorAll("*")),f=Array.from(o.querySelectorAll("*")),p=d.styleSheets.length,g=[];for(let x=p-1;x>=0;x-=1)g[x]=d.styleSheets[x],d.styleSheets[x].disabled=!0;const v={};h.forEach((x,E)=>{const T=window.getComputedStyle(x,null),P={};Object.keys(T).forEach(z=>{P[z]=T.getPropertyValue(z)}),v[E]=P}),p!==d.styleSheets.length&&g.forEach((x,E)=>{d.styleSheets[E]=x});for(let x=0;x<p;x+=1)d.styleSheets[x].disabled=!1;const y={};h.forEach((x,E)=>{const T=window.getComputedStyle(x,null),P=v[E],z={};Object.keys(T).forEach($=>{!BF($)&&T.getPropertyValue($)!==P[$]&&(z[$]=T.getPropertyValue($))}),y[E]=z}),f.forEach((x,E)=>{jr()(x).css(y[E])})}const c=t.stylesheet;if(typeof c=="string"){const d=n.ownerDocument.implementation.createDocument(null,"xml",null).createCDATASection(c);i.prepend(pn.create("style",{type:"text/css"},[d]))}const u=()=>{const d=t.beforeSerialize;if(typeof d=="function"){const f=dn(d,this.graph,o);f instanceof SVGSVGElement&&(o=f)}const h=new XMLSerializer().serializeToString(o).replace(/&nbsp;/g,"\xA0");this.graph.trigger("after:export",t),e(h)};if(t.serializeImages){const d=i.find("image").map(h=>new Promise(f=>{const p=h.attr("xlink:href")||h.attr("href");zC.imageToDataUri(p,(g,v)=>{!g&&v&&h.attr("xlink:href",v),f()})}));Promise.all(d).then(u)}else u()}toDataURL(e,t){let n=t.viewBox||this.graph.getContentBBox();const i=Us(t.padding);t.width&&t.height&&(i.left+i.right>=t.width&&(i.left=i.right=0),i.top+i.bottom>=t.height&&(i.top=i.bottom=0));const o=new Ht(-i.left,-i.top,i.left+i.right,i.top+i.bottom);if(t.width&&t.height){const u=n.width+i.left+i.right,d=n.height+i.top+i.bottom;o.scale(u/t.width,d/t.height)}n=Ht.create(n).moveAndExpand(o);const s=typeof t.width=="number"&&typeof t.height=="number"?{width:t.width,height:t.height}:n;let a=t.ratio?parseFloat(t.ratio):1;(!Number.isFinite(a)||a===0)&&(a=1);const l={width:Math.max(Math.round(s.width*a),1),height:Math.max(Math.round(s.height*a),1)};{const u=document.createElement("canvas"),d=u.getContext("2d");u.width=l.width,u.height=l.height;const h=l.width-1,f=l.height-1;d.fillStyle="rgb(1,1,1)",d.fillRect(h,f,1,1);const p=d.getImageData(h,f,1,1).data;if(p[0]!==1||p[1]!==1||p[2]!==1)throw new Error("size exceeded")}const c=new Image;c.onload=()=>{const u=document.createElement("canvas");u.width=l.width,u.height=l.height;const d=u.getContext("2d");d.fillStyle=t.backgroundColor||"white",d.fillRect(0,0,l.width,l.height);try{d.drawImage(c,0,0,l.width,l.height);const h=u.toDataURL(t.type,t.quality);e(h)}catch(h){}},this.toSVG(u=>{c.src=`data:image/svg+xml,${encodeURIComponent(u)}`},Object.assign(Object.assign({},t),{viewBox:n,serializeImages:!0,preserveDimensions:Object.assign({},l)}))}toPNG(e,t={}){this.toDataURL(e,Object.assign(Object.assign({},t),{type:"image/png"}))}toJPEG(e,t={}){this.toDataURL(e,Object.assign(Object.assign({},t),{type:"image/jpeg"}))}}class HU extends hi{constructor(){super(...arguments);this.widgets=new Map}get isSelectionEnabled(){return this.options.selecting.enabled===!0}init(){this.startListening()}startListening(){this.graph.on("node:mouseup",this.onNodeMouseUp,this),this.graph.on("node:selected",this.onNodeSelected,this),this.graph.on("node:unselected",this.onNodeUnSelected,this)}stopListening(){this.graph.off("node:mouseup",this.onNodeMouseUp,this),this.graph.off("node:selected",this.onNodeSelected,this),this.graph.off("node:unselected",this.onNodeUnSelected,this)}onNodeMouseUp({node:e}){if(!this.isSelectionEnabled){const t=this.graph.hook.createKnob(e,{clearAll:!0});t&&this.widgets.set(e,t)}}onNodeSelected({node:e}){if(this.isSelectionEnabled){const t=this.graph.hook.createKnob(e,{clearAll:!1});t&&this.widgets.set(e,t)}}onNodeUnSelected({node:e}){if(this.isSelectionEnabled){const t=this.widgets.get(e);t&&t.forEach(n=>n.dispose()),this.widgets.delete(e)}}}var $U=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class qA extends hi{get widgetOptions(){return this.options.panning}get pannable(){return this.widgetOptions&&this.widgetOptions.enabled===!0}init(){this.startListening(),this.updateClassName()}startListening(){const e=this.widgetOptions.eventTypes;!e||(e.includes("leftMouseDown")&&(this.graph.on("blank:mousedown",this.preparePanning,this),this.graph.on("node:unhandled:mousedown",this.preparePanning,this),this.graph.on("edge:unhandled:mousedown",this.preparePanning,this)),e.includes("rightMouseDown")&&(this.onRightMouseDown=this.onRightMouseDown.bind(this),this.view.$(this.graph.container).on("mousedown",this.onRightMouseDown)),e.includes("mouseWheel")&&(this.mousewheelHandle=new N_(this.graph.container,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.mousewheelHandle.enable()))}stopListening(){const e=this.widgetOptions.eventTypes;!e||(e.includes("leftMouseDown")&&(this.graph.off("blank:mousedown",this.preparePanning,this),this.graph.off("node:unhandled:mousedown",this.preparePanning,this),this.graph.off("edge:unhandled:mousedown",this.preparePanning,this)),e.includes("rightMouseDown")&&this.view.$(this.graph.container).off("mousedown",this.onRightMouseDown),e.includes("mouseWheel")&&this.mousewheelHandle&&this.mousewheelHandle.disable())}preparePanning({e}){(this.allowPanning(e,!0)||this.allowPanning(e)&&!this.graph.selection.allowRubberband(e,!0))&&this.startPanning(e)}allowPanning(e,t){return this.pannable&&fu.isMatch(e,this.widgetOptions.modifiers,t)&&this.graph.hook.allowPanning(e)}startPanning(e){const t=this.view.normalizeEvent(e);this.clientX=t.clientX,this.clientY=t.clientY,this.panning=!0,this.updateClassName(),this.view.$(document.body).on({"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this),"mouseleave.panning":this.stopPanning.bind(this)}),this.view.$(window).on("mouseup.panning",this.stopPanning.bind(this))}pan(e){const t=this.view.normalizeEvent(e),n=t.clientX-this.clientX,i=t.clientY-this.clientY;this.clientX=t.clientX,this.clientY=t.clientY;const o=this.graph.transform.getTranslation(),s=o.tx+n,a=o.ty+i;this.graph.transform.translate(s,a,{ui:!0})}stopPanning(e){this.panning=!1,this.updateClassName(),this.view.$(document.body).off(".panning"),this.view.$(window).off(".panning")}updateClassName(){const e=this.view.container,t=this.view.prefixClassName("graph-panning"),n=this.view.prefixClassName("graph-pannable");this.pannable?this.panning?(Qr(e,t),ma(e,n)):(ma(e,t),Qr(e,n)):(ma(e,t),ma(e,n))}onRightMouseDown(e){e.button===2&&this.allowPanning(e,!0)&&this.startPanning(e)}allowMouseWheel(e){return this.pannable&&!e.ctrlKey}onMouseWheel(e,t,n){e.ctrlKey||this.graph.translateBy(-t,-n)}autoPanning(e,t){const n=10,i=this.graph.getGraphArea();let o=0,s=0;e<=i.left+n&&(o=-n),t<=i.top+n&&(s=-n),e>=i.right-n&&(o=n),t>=i.bottom-n&&(s=n),(o!==0||s!==0)&&this.graph.translateBy(-o,-s)}enablePanning(){this.pannable||(this.widgetOptions.enabled=!0,this.updateClassName())}disablePanning(){this.pannable&&(this.widgetOptions.enabled=!1,this.updateClassName())}dispose(){this.stopListening()}}$U([hi.dispose()],qA.prototype,"dispose",null);var WU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class JA extends hi{hasScroller(){return this.graph.scroller.widget!=null}getContainer(){return this.hasScroller()?this.graph.scroller.widget.container:this.graph.container}init(){const e=this.options.autoResize;if(e){const t=typeof e=="boolean"?this.getContainer():e;Jv.bind(t,()=>{const n=this.getContainer(),i=n.offsetWidth,o=n.offsetHeight;this.resize(i,o)})}}resize(e,t){this.hasScroller()?this.resizeScroller(e,t):this.resizeGraph(e,t)}resizeGraph(e,t){this.graph.transform.resize(e,t)}resizeScroller(e,t){this.graph.scroller.resize(e,t)}resizePage(e,t){const n=this.graph.scroller.widget;n&&n.updatePageSize(e,t)}dispose(){Jv.clear(this.getContainer())}}WU([hi.dispose()],JA.prototype,"dispose",null);var Br=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o},ZU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t},Mr;(function(r){function e(n,i){return(o,s,a)=>{const l=a.value,c=i||s;a.value=function(...u){const d=this.options[c];if(d!=null){this.getNativeValue=l.bind(this,...u);const h=dn(d,this.graph,...u);if(this.getNativeValue=null,h!=null||n===!0&&h===null)return h}return l.call(this,...u)}}}r.hook=e;function t(n){return(i,o,s)=>{const a=s.value,l=n||o;s.value=function(...c){let u=a.call(this,...c);const d=this.options[l];return d!=null&&(u=dn(d,this.graph,...c)&&u),u}}}r.after=t})(Mr||(Mr={}));class Pr extends hi{createModel(){if(this.options.model)return this.options.model;const e=new is;return e.graph=this.graph,e}createView(){return new Ia(this.graph)}createRenderer(){return new qr(this.graph)}createDefsManager(){return new ZA(this.graph)}createGridManager(){return new d1(this.graph)}createCoordManager(){return new XA(this.graph)}createKnobManager(){return new HU(this.graph)}createTransform(e,t){const n=this.getTransformOptions(e);return n.resizable||n.rotatable?new $A(Object.assign(Object.assign({node:e,graph:this.graph},n),t)):(n.clearAll&&$A.removeInstances(this.graph),null)}createKnob(e,t){const n=La.parseOptionGroup(this.graph,e,this.options.knob),i=Object.assign(Object.assign({},n),t);i.clearAll&&VA.removeInstances(this.graph),i.clearAll=!1;const o=e.prop("knob"),s=[];return(Array.isArray(o)?o:[o]).forEach((l,c)=>{if(l){if(l.enabled===!1||typeof l.enabled=="function"&&l.enabled.call(this.graph,e)===!1)return}else return;n.enabled&&s.push(new VA(Object.assign({node:e,index:c,graph:this.graph},i)))}),s}getTransformOptions(e){const t=La.parseOptionGroup(this.graph,e,this.options.resizing),n=La.parseOptionGroup(this.graph,e,this.options.rotating),i=La.parseOptionGroup(this.graph,e,this.options.transforming);return Object.assign(Object.assign({},i),{resizable:t.enabled,minWidth:t.minWidth,maxWidth:t.maxWidth,minHeight:t.minHeight,maxHeight:t.maxHeight,orthogonalResizing:t.orthogonal,restrictedResizing:t.restrict!=null?t.restrict:t.restricted,autoScrollOnResizing:t.autoScroll,preserveAspectRatio:t.preserveAspectRatio,allowReverse:t.allowReverse,rotatable:n.enabled,rotateGrid:n.grid})}createTransformManager(){return new Cy(this.graph)}createHighlightManager(){return new xy(this.graph)}createBackgroundManager(){return new by(this.graph)}createClipboard(){return new XU}createClipboardManager(){return new p1(this.graph)}createSnapline(){return new HA(Object.assign({graph:this.graph},this.options.snapline))}createSnaplineManager(){return new h1(this.graph)}createSelection(){return new u1(Object.assign({graph:this.graph},this.options.selecting))}createSelectionManager(){return new g1(this.graph)}allowRubberband(e){return!0}createHistoryManager(){return new Fd(Object.assign({graph:this.graph},this.options.history))}createScroller(){return this.options.scroller.enabled?new Gf(Object.assign({graph:this.graph},this.options.scroller)):null}createScrollerManager(){return new f1(this.graph)}allowPanning(e){return!0}createMiniMap(){const e=this.options.minimap,{enabled:t}=e,n=ZU(e,["enabled"]);return t?new jA(Object.assign({graph:this.graph},n)):null}createMiniMapManager(){return new m1(this.graph)}createKeyboard(){return new Bd(Object.assign({graph:this.graph},this.options.keyboard))}createMouseWheel(){return new v1(Object.assign({graph:this.graph},this.options.mousewheel))}createPrintManager(){return new zd(this.graph)}createFormatManager(){return new KA(this.graph)}createPanningManager(){return new qA(this.graph)}createSizeManager(){return new JA(this.graph)}allowConnectToBlank(e){const t=this.options.connecting,n=t.allowBlank!=null?t.allowBlank:t.dangling;if(typeof n!="function")return!!n;const i=this.graph.findViewByCell(e),o=e.getSourceCell(),s=e.getTargetCell(),a=this.graph.findViewByCell(o),l=this.graph.findViewByCell(s);return dn(n,this.graph,{edge:e,edgeView:i,sourceCell:o,targetCell:s,sourceView:a,targetView:l,sourcePort:e.getSourcePortId(),targetPort:e.getTargetPortId(),sourceMagnet:i.sourceMagnet,targetMagnet:i.targetMagnet})}validateEdge(e,t,n){if(!this.allowConnectToBlank(e)){const o=e.getSourceCellId(),s=e.getTargetCellId();if(!(o&&s))return!1}const i=this.options.connecting.validateEdge;return i?dn(i,this.graph,{edge:e,type:t,previous:n}):!0}validateMagnet(e,t,n){if(t.getAttribute("magnet")!=="passive"){const i=this.options.connecting.validateMagnet;return i?dn(i,this.graph,{e:n,magnet:t,view:e,cell:e.cell}):!0}return!1}getDefaultEdge(e,t){let n;const i=this.options.connecting.createEdge;return i&&(n=dn(i,this.graph,{sourceMagnet:t,sourceView:e,sourceCell:e.cell})),n==null&&(n=new _l),n}validateConnection(e,t,n,i,o,s,a){const l=this.options.connecting,c=l.allowLoop,u=l.allowNode,d=l.allowEdge,h=l.allowPort,f=l.allowMulti!=null?l.allowMulti:l.multi,p=l.validateConnection,g=s?s.cell:null,v=o==="target"?n:e,y=o==="target"?i:t;let x=!0;const E=T=>{const P=o==="source"?a?a.port:null:g?g.getSourcePortId():null,z=o==="target"?a?a.port:null:g?g.getTargetPortId():null;return dn(T,this.graph,{edge:g,edgeView:s,sourceView:e,targetView:n,sourcePort:P,targetPort:z,sourceMagnet:t,targetMagnet:i,sourceCell:e?e.cell:null,targetCell:n?n.cell:null,type:o})};if(c!=null&&(typeof c=="boolean"?!c&&e===n&&(x=!1):x=E(c)),x&&h!=null&&(typeof h=="boolean"?!h&&y&&(x=!1):x=E(h)),x&&d!=null&&(typeof d=="boolean"?!d&&hc.isEdgeView(v)&&(x=!1):x=E(d)),x&&u!=null&&y==null&&(typeof u=="boolean"?!u&&xo.isNodeView(v)&&(x=!1):x=E(u)),x&&f!=null&&s){const T=s.cell,P=o==="source"?a:T.getSource(),z=o==="target"?a:T.getTarget(),$=a?this.graph.getCellById(a.cell):null;if(P&&z&&P.cell&&z.cell&&$)if(typeof f=="function")x=E(f);else{const ne=this.model.getConnectedEdges($,{outgoing:o==="source",incoming:o==="target"});ne.length&&(f==="withPort"?ne.some(fe=>{const Ae=fe.getSource(),de=fe.getTarget();return Ae&&de&&Ae.cell===P.cell&&de.cell===z.cell&&Ae.port!=null&&Ae.port===P.port&&de.port!=null&&de.port===z.port})&&(x=!1):f||ne.some(fe=>{const Ae=fe.getSource(),de=fe.getTarget();return Ae&&de&&Ae.cell===P.cell&&de.cell===z.cell})&&(x=!1))}}return x&&p!=null&&(x=E(p)),x}getRestrictArea(e){const t=this.options.translating.restrict,n=typeof t=="function"?dn(t,this.graph,e):t;return typeof n=="number"?this.graph.transform.getGraphArea().inflate(n):n===!0?this.graph.transform.getGraphArea():n||null}onViewUpdated(e,t,n){t&qr.FLAG_INSERT||n.mounting||this.graph.renderer.requestConnectedEdgesUpdate(e,n)}onViewPostponed(e,t,n){return this.graph.renderer.forcePostponedViewUpdate(e,t)}getCellView(e){return null}createCellView(e){const t={graph:this.graph},n=this.getCellView(e);if(n)return new n(e,t);const i=e.view;if(i!=null&&typeof i=="string"){const o=Ii.registry.get(i);return o?new o(e,t):Ii.registry.onNotFound(i)}return e.isNode()?new xo(e,t):e.isEdge()?new hc(e,t):null}getHTMLComponent(e){let t=e.getHTML();return typeof t=="string"&&(t=Al.componentRegistry.get(t)||t),Rt(t)&&(t=t.render),typeof t=="function"?dn(t,this.graph,e):t}shouldUpdateHTMLComponent(e){let t=e.getHTML();if(typeof t=="string"&&(t=Al.componentRegistry.get(t)||t),Rt(t)){const n=t.shouldComponentUpdate;return typeof n=="function"?dn(n,this.graph,e):!!n}return!1}onEdgeLabelRendered(e){}onPortRendered(e){}onToolItemCreated(e){}}Br([Mr.hook()],Pr.prototype,"createModel",null),Br([Mr.hook()],Pr.prototype,"createView",null),Br([Mr.hook()],Pr.prototype,"createRenderer",null),Br([Mr.hook()],Pr.prototype,"createDefsManager",null),Br([Mr.hook()],Pr.prototype,"createGridManager",null),Br([Mr.hook()],Pr.prototype,"createCoordManager",null),Br([Mr.hook()],Pr.prototype,"createKnobManager",null),Br([Mr.hook()],Pr.prototype,"createTransform",null),Br([Mr.hook()],Pr.prototype,"createKnob",null),Br([Mr.hook()],Pr.prototype,"createTransformManager",null),Br([Mr.hook()],Pr.prototype,"createHighlightManager",null),Br([Mr.hook()],Pr.prototype,"createBackgroundManager",null),Br([Mr.hook()],Pr.prototype,"createClipboard",null),Br([Mr.hook()],Pr.prototype,"createClipboardManager",null),Br([Mr.hook()],Pr.prototype,"createSnapline",null),Br([Mr.hook()],Pr.prototype,"createSnaplineManager",null),Br([Mr.hook()],Pr.prototype,"createSelection",null),Br([Mr.hook()],Pr.prototype,"createSelectionManager",null),Br([Mr.hook()],Pr.prototype,"allowRubberband",null),Br([Mr.hook()],Pr.prototype,"createHistoryManager",null),Br([Mr.hook()],Pr.prototype,"createScroller",null),Br([Mr.hook()],Pr.prototype,"createScrollerManager",null),Br([Mr.hook()],Pr.prototype,"allowPanning",null),Br([Mr.hook()],Pr.prototype,"createMiniMap",null),Br([Mr.hook()],Pr.prototype,"createMiniMapManager",null),Br([Mr.hook()],Pr.prototype,"createKeyboard",null),Br([Mr.hook()],Pr.prototype,"createMouseWheel",null),Br([Mr.hook()],Pr.prototype,"createPrintManager",null),Br([Mr.hook()],Pr.prototype,"createFormatManager",null),Br([Mr.hook()],Pr.prototype,"createPanningManager",null),Br([Mr.hook()],Pr.prototype,"createSizeManager",null),Br([Mr.after()],Pr.prototype,"onViewUpdated",null),Br([Mr.after()],Pr.prototype,"onViewPostponed",null),Br([Mr.hook()],Pr.prototype,"getCellView",null),Br([Mr.hook(!0)],Pr.prototype,"createCellView",null),Br([Mr.hook()],Pr.prototype,"getHTMLComponent",null),Br([Mr.hook()],Pr.prototype,"shouldUpdateHTMLComponent",null),Br([Mr.hook()],Pr.prototype,"onEdgeLabelRendered",null),Br([Mr.hook()],Pr.prototype,"onPortRendered",null),Br([Mr.hook()],Pr.prototype,"onToolItemCreated",null);var Ga=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class kr extends rs{constructor(e){super();this.options=La.get(e),this.css=new hu(this),this.hook=new Pr(this),this.view=this.hook.createView(),this.defs=this.hook.createDefsManager(),this.coord=this.hook.createCoordManager(),this.transform=this.hook.createTransformManager(),this.knob=this.hook.createKnobManager(),this.highlight=this.hook.createHighlightManager(),this.grid=this.hook.createGridManager(),this.background=this.hook.createBackgroundManager(),this.model=this.hook.createModel(),this.renderer=this.hook.createRenderer(),this.clipboard=this.hook.createClipboardManager(),this.snapline=this.hook.createSnaplineManager(),this.selection=this.hook.createSelectionManager(),this.history=this.hook.createHistoryManager(),this.scroller=this.hook.createScrollerManager(),this.minimap=this.hook.createMiniMapManager(),this.keyboard=this.hook.createKeyboard(),this.mousewheel=this.hook.createMouseWheel(),this.print=this.hook.createPrintManager(),this.format=this.hook.createFormatManager(),this.panning=this.hook.createPanningManager(),this.size=this.hook.createSizeManager()}get container(){return this.view.container}get[Symbol.toStringTag](){return kr.toStringTag}isNode(e){return e.isNode()}isEdge(e){return e.isEdge()}resetCells(e,t={}){return this.model.resetCells(e,t),this}clearCells(e={}){return this.model.clear(e),this}toJSON(e={}){return this.model.toJSON(e)}parseJSON(e){return this.model.parseJSON(e)}fromJSON(e,t={}){return this.model.fromJSON(e,t),this}getCellById(e){return this.model.getCell(e)}addNode(e,t={}){return this.model.addNode(e,t)}addNodes(e,t={}){return this.addCell(e.map(n=>ii.isNode(n)?n:this.createNode(n)),t)}createNode(e){return this.model.createNode(e)}removeNode(e,t={}){return this.model.removeCell(e,t)}addEdge(e,t={}){return this.model.addEdge(e,t)}addEdges(e,t={}){return this.addCell(e.map(n=>Ai.isEdge(n)?n:this.createEdge(n)),t)}removeEdge(e,t={}){return this.model.removeCell(e,t)}createEdge(e){return this.model.createEdge(e)}addCell(e,t={}){return this.model.addCell(e,t),this}removeCell(e,t={}){return this.model.removeCell(e,t)}removeCells(e,t={}){return this.model.removeCells(e,t)}removeConnectedEdges(e,t={}){return this.model.removeConnectedEdges(e,t)}disconnectConnectedEdges(e,t={}){return this.model.disconnectConnectedEdges(e,t),this}hasCell(e){return this.model.has(e)}getCell(e){return this.model.getCell(e)}getCells(){return this.model.getCells()}getCellCount(){return this.model.total()}getNodes(){return this.model.getNodes()}getEdges(){return this.model.getEdges()}getOutgoingEdges(e){return this.model.getOutgoingEdges(e)}getIncomingEdges(e){return this.model.getIncomingEdges(e)}getConnectedEdges(e,t={}){return this.model.getConnectedEdges(e,t)}getRootNodes(){return this.model.getRoots()}getLeafNodes(){return this.model.getLeafs()}isRootNode(e){return this.model.isRoot(e)}isLeafNode(e){return this.model.isLeaf(e)}getNeighbors(e,t={}){return this.model.getNeighbors(e,t)}isNeighbor(e,t,n={}){return this.model.isNeighbor(e,t,n)}getSuccessors(e,t={}){return this.model.getSuccessors(e,t)}isSuccessor(e,t,n={}){return this.model.isSuccessor(e,t,n)}getPredecessors(e,t={}){return this.model.getPredecessors(e,t)}isPredecessor(e,t,n={}){return this.model.isPredecessor(e,t,n)}getCommonAncestor(...e){return this.model.getCommonAncestor(...e)}getSubGraph(e,t={}){return this.model.getSubGraph(e,t)}cloneSubGraph(e,t={}){return this.model.cloneSubGraph(e,t)}cloneCells(e){return this.model.cloneCells(e)}getNodesFromPoint(e,t){return this.model.getNodesFromPoint(e,t)}getNodesInArea(e,t,n,i,o){return this.model.getNodesInArea(e,t,n,i,o)}getNodesUnderNode(e,t={}){return this.model.getNodesUnderNode(e,t)}searchCell(e,t,n={}){return this.model.search(e,t,n),this}getShortestPath(e,t,n={}){return this.model.getShortestPath(e,t,n)}getAllCellsBBox(){return this.model.getAllCellsBBox()}getCellsBBox(e,t={}){return this.model.getCellsBBox(e,t)}startBatch(e,t={}){this.model.startBatch(e,t)}stopBatch(e,t={}){this.model.stopBatch(e,t)}batchUpdate(e,t,n){const i=typeof e=="string"?e:"update",o=typeof e=="string"?t:e,s=typeof t=="function"?n:t;this.startBatch(i,s);const a=o();return this.stopBatch(i,s),a}updateCellId(e,t){return this.model.updateCellId(e,t)}isFrozen(){return this.renderer.isFrozen()}freeze(e={}){return this.renderer.freeze(e),this}unfreeze(e={}){return this.renderer.unfreeze(e),this}isAsync(){return this.renderer.isAsync()}setAsync(e){return this.renderer.setAsync(e),this}findView(e){return Tr.isCell(e)?this.findViewByCell(e):this.findViewByElem(e)}findViews(e){return Ht.isRectangleLike(e)?this.findViewsInArea(e):pe.isPointLike(e)?this.findViewsFromPoint(e):[]}findViewByCell(e){return this.renderer.findViewByCell(e)}findViewByElem(e){return this.renderer.findViewByElem(e)}findViewsFromPoint(e,t){const n=typeof e=="number"?{x:e,y:t}:e;return this.renderer.findViewsFromPoint(n)}findViewsInArea(e,t,n,i,o){const s=typeof e=="number"?{x:e,y:t,width:n,height:i}:e,a=typeof e=="number"?o:t;return this.renderer.findViewsInArea(s,a)}isViewMounted(e){return this.renderer.isViewMounted(e)}getMountedViews(){return this.renderer.getMountedViews()}getUnmountedViews(){return this.renderer.getUnmountedViews()}matrix(e){return typeof e=="undefined"?this.transform.getMatrix():(this.transform.setMatrix(e),this)}resize(e,t){return this.size.resize(e,t),this}resizeGraph(e,t){return this.size.resizeGraph(e,t),this}resizeScroller(e,t){return this.size.resizeScroller(e,t),this}resizePage(e,t){return this.size.resizePage(e,t),this}scale(e,t=e,n=0,i=0){return typeof e=="undefined"?this.transform.getScale():(this.transform.scale(e,t,n,i),this)}zoom(e,t){const n=this.scroller.widget;if(n){if(typeof e=="undefined")return n.zoom();n.zoom(e,t)}else{if(typeof e=="undefined")return this.transform.getZoom();this.transform.zoom(e,t)}return this}zoomTo(e,t={}){const n=this.scroller.widget;return n?n.zoom(e,Object.assign(Object.assign({},t),{absolute:!0})):this.transform.zoom(e,Object.assign(Object.assign({},t),{absolute:!0})),this}zoomToRect(e,t={}){const n=this.scroller.widget;return n?n.zoomToRect(e,t):this.transform.zoomToRect(e,t),this}zoomToFit(e={}){const t=this.scroller.widget;return t?t.zoomToFit(e):this.transform.zoomToFit(e),this}rotate(e,t,n){return typeof e=="undefined"?this.transform.getRotation():(this.transform.rotate(e,t,n),this)}translate(e,t){return typeof e=="undefined"?this.transform.getTranslation():(this.transform.translate(e,t),this)}translateBy(e,t){const n=this.translate(),i=n.tx+e,o=n.ty+t;return this.translate(i,o)}getArea(){return this.transform.getGraphArea()}getGraphArea(){return this.transform.getGraphArea()}getContentArea(e={}){return this.transform.getContentArea(e)}getContentBBox(e={}){return this.transform.getContentBBox(e)}fitToContent(e,t,n,i){return this.transform.fitToContent(e,t,n,i)}scaleContentToFit(e={}){return this.transform.scaleContentToFit(e),this}center(e){return this.centerPoint(e)}centerPoint(e,t,n){const i=this.scroller.widget;return i?i.centerPoint(e,t,n):this.transform.centerPoint(e,t),this}centerContent(e){const t=this.scroller.widget;return t?t.centerContent(e):this.transform.centerContent(e),this}centerCell(e,t){const n=this.scroller.widget;return n?n.centerCell(e,t):this.transform.centerCell(e),this}positionPoint(e,t,n,i={}){const o=this.scroller.widget;return o?o.positionPoint(e,t,n,i):this.transform.positionPoint(e,t,n),this}positionRect(e,t,n){const i=this.scroller.widget;return i?i.positionRect(e,t,n):this.transform.positionRect(e,t),this}positionCell(e,t,n){const i=this.scroller.widget;return i?i.positionCell(e,t,n):this.transform.positionCell(e,t),this}positionContent(e,t){const n=this.scroller.widget;return n?n.positionContent(e,t):this.transform.positionContent(e,t),this}getClientMatrix(){return this.coord.getClientMatrix()}getClientOffset(){return this.coord.getClientOffset()}getPageOffset(){return this.coord.getPageOffset()}snapToGrid(e,t){return this.coord.snapToGrid(e,t)}pageToLocal(e,t,n,i){return Ht.isRectangleLike(e)?this.coord.pageToLocalRect(e):typeof e=="number"&&typeof t=="number"&&typeof n=="number"&&typeof i=="number"?this.coord.pageToLocalRect(e,t,n,i):this.coord.pageToLocalPoint(e,t)}localToPage(e,t,n,i){return Ht.isRectangleLike(e)?this.coord.localToPageRect(e):typeof e=="number"&&typeof t=="number"&&typeof n=="number"&&typeof i=="number"?this.coord.localToPageRect(e,t,n,i):this.coord.localToPagePoint(e,t)}clientToLocal(e,t,n,i){return Ht.isRectangleLike(e)?this.coord.clientToLocalRect(e):typeof e=="number"&&typeof t=="number"&&typeof n=="number"&&typeof i=="number"?this.coord.clientToLocalRect(e,t,n,i):this.coord.clientToLocalPoint(e,t)}localToClient(e,t,n,i){return Ht.isRectangleLike(e)?this.coord.localToClientRect(e):typeof e=="number"&&typeof t=="number"&&typeof n=="number"&&typeof i=="number"?this.coord.localToClientRect(e,t,n,i):this.coord.localToClientPoint(e,t)}localToGraph(e,t,n,i){return Ht.isRectangleLike(e)?this.coord.localToGraphRect(e):typeof e=="number"&&typeof t=="number"&&typeof n=="number"&&typeof i=="number"?this.coord.localToGraphRect(e,t,n,i):this.coord.localToGraphPoint(e,t)}graphToLocal(e,t,n,i){return Ht.isRectangleLike(e)?this.coord.graphToLocalRect(e):typeof e=="number"&&typeof t=="number"&&typeof n=="number"&&typeof i=="number"?this.coord.graphToLocalRect(e,t,n,i):this.coord.graphToLocalPoint(e,t)}clientToGraph(e,t,n,i){return Ht.isRectangleLike(e)?this.coord.clientToGraphRect(e):typeof e=="number"&&typeof t=="number"&&typeof n=="number"&&typeof i=="number"?this.coord.clientToGraphRect(e,t,n,i):this.coord.clientToGraphPoint(e,t)}defineFilter(e){return this.defs.filter(e)}defineGradient(e){return this.defs.gradient(e)}defineMarker(e){return this.defs.marker(e)}getGridSize(){return this.grid.getGridSize()}setGridSize(e){return this.grid.setGridSize(e),this}showGrid(){return this.grid.show(),this}hideGrid(){return this.grid.hide(),this}clearGrid(){return this.grid.clear(),this}drawGrid(e){return this.grid.draw(e),this}updateBackground(){return this.background.update(),this}drawBackground(e,t){const n=this.scroller.widget;return n!=null&&(this.options.background==null||!t)?n.backgroundManager.draw(e):this.background.draw(e),this}clearBackground(e){const t=this.scroller.widget;return t!=null&&(this.options.background==null||!e)?t.backgroundManager.clear():this.background.clear(),this}isClipboardEnabled(){return!this.clipboard.disabled}enableClipboard(){return this.clipboard.enable(),this}disableClipboard(){return this.clipboard.disable(),this}toggleClipboard(e){return e!=null?e!==this.isClipboardEnabled()&&(e?this.enableClipboard():this.disableClipboard()):this.isClipboardEnabled()?this.disableClipboard():this.enableClipboard(),this}isClipboardEmpty(){return this.clipboard.isEmpty()}getCellsInClipboard(){return this.clipboard.cells}cleanClipboard(){return this.clipboard.clean(),this}copy(e,t={}){return this.clipboard.copy(e,t),this}cut(e,t={}){return this.clipboard.cut(e,t),this}paste(e={},t=this){return this.clipboard.paste(e,t)}isHistoryEnabled(){return!this.history.disabled}enableHistory(){return this.history.enable(),this}disableHistory(){return this.history.disable(),this}toggleHistory(e){return e!=null?e!==this.isHistoryEnabled()&&(e?this.enableHistory():this.disableHistory()):this.isHistoryEnabled()?this.disableHistory():this.enableHistory(),this}undo(e={}){return this.history.undo(e),this}undoAndCancel(e={}){return this.history.cancel(e),this}redo(e={}){return this.history.redo(e),this}canUndo(){return this.history.canUndo()}canRedo(){return this.history.canRedo()}cleanHistory(e={}){this.history.clean(e)}isKeyboardEnabled(){return!this.keyboard.disabled}enableKeyboard(){return this.keyboard.enable(),this}disableKeyboard(){return this.keyboard.disable(),this}toggleKeyboard(e){return e!=null?e!==this.isKeyboardEnabled()&&(e?this.enableKeyboard():this.disableKeyboard()):this.isKeyboardEnabled()?this.disableKeyboard():this.enableKeyboard(),this}bindKey(e,t,n){return this.keyboard.on(e,t,n),this}unbindKey(e,t){return this.keyboard.off(e,t),this}isMouseWheelEnabled(){return!this.mousewheel.disabled}enableMouseWheel(){return this.mousewheel.enable(),this}disableMouseWheel(){return this.mousewheel.disable(),this}toggleMouseWheel(e){return e==null?this.isMouseWheelEnabled()?this.disableMouseWheel():this.enableMouseWheel():e?this.enableMouseWheel():this.disableMouseWheel(),this}isPannable(){return this.scroller.widget?this.scroller.pannable:this.panning.pannable}enablePanning(){return this.scroller.widget?this.scroller.enablePanning():this.panning.enablePanning(),this}disablePanning(){return this.scroller.widget?this.scroller.disablePanning():this.panning.disablePanning(),this}togglePanning(e){return e==null?this.isPannable()?this.disablePanning():this.enablePanning():e!==this.isPannable()&&(e?this.enablePanning():this.disablePanning()),this}lockScroller(){var e;(e=this.scroller.widget)===null||e===void 0||e.lock()}unlockScroller(){var e;(e=this.scroller.widget)===null||e===void 0||e.unlock()}updateScroller(){var e;(e=this.scroller.widget)===null||e===void 0||e.update()}getScrollbarPosition(){return this.scroller.widget.scrollbarPosition()}setScrollbarPosition(e,t,n){return this.scroller.widget.scrollbarPosition(e,t,n),this}scrollToPoint(e,t,n){return this.scroller.widget.scrollToPoint(e,t,n),this}scrollToContent(e){return this.scroller.widget.scrollToContent(e),this}scrollToCell(e,t){return this.scroller.widget.scrollToCell(e,t),this}transitionToPoint(e,t,n){return this.scroller.widget.transitionToPoint(e,t,n),this}transitionToRect(e,t={}){return this.scroller.widget.transitionToRect(e,t),this}isSelectionEnabled(){return!this.selection.disabled}enableSelection(){return this.selection.enable(),this}disableSelection(){return this.selection.disable(),this}toggleSelection(e){return e!=null?e!==this.isSelectionEnabled()&&(e?this.enableSelection():this.disableSelection()):this.isSelectionEnabled()?this.disableSelection():this.enableSelection(),this}isMultipleSelection(){return this.selection.isMultiple()}enableMultipleSelection(){return this.selection.enableMultiple(),this}disableMultipleSelection(){return this.selection.disableMultiple(),this}toggleMultipleSelection(e){return e!=null?e!==this.isMultipleSelection()&&(e?this.enableMultipleSelection():this.disableMultipleSelection()):this.isMultipleSelection()?this.disableMultipleSelection():this.enableMultipleSelection(),this}isSelectionMovable(){return this.selection.widget.options.movable!==!1}enableSelectionMovable(){return this.selection.widget.options.movable=!0,this}disableSelectionMovable(){return this.selection.widget.options.movable=!1,this}toggleSelectionMovable(e){return e!=null?e!==this.isSelectionMovable()&&(e?this.enableSelectionMovable():this.disableSelectionMovable()):this.isSelectionMovable()?this.disableSelectionMovable():this.enableSelectionMovable(),this}isRubberbandEnabled(){return!this.selection.rubberbandDisabled}enableRubberband(){return this.selection.enableRubberband(),this}disableRubberband(){return this.selection.disableRubberband(),this}toggleRubberband(e){return e!=null?e!==this.isRubberbandEnabled()&&(e?this.enableRubberband():this.disableRubberband()):this.isRubberbandEnabled()?this.disableRubberband():this.enableRubberband(),this}isStrictRubberband(){return this.selection.widget.options.strict===!0}enableStrictRubberband(){return this.selection.widget.options.strict=!0,this}disableStrictRubberband(){return this.selection.widget.options.strict=!1,this}toggleStrictRubberband(e){return e!=null?e!==this.isStrictRubberband()&&(e?this.enableStrictRubberband():this.disableStrictRubberband()):this.isStrictRubberband()?this.disableStrictRubberband():this.enableStrictRubberband(),this}setRubberbandModifiers(e){this.selection.setModifiers(e)}setSelectionFilter(e){return this.selection.setFilter(e),this}setSelectionDisplayContent(e){return this.selection.setContent(e),this}isSelectionEmpty(){return this.selection.isEmpty()}cleanSelection(e){return this.selection.clean(e),this}resetSelection(e,t){return this.selection.reset(e,t),this}getSelectedCells(){return this.selection.cells}getSelectedCellCount(){return this.selection.length}isSelected(e){return this.selection.isSelected(e)}select(e,t){return this.selection.select(e,t),this}unselect(e,t){return this.selection.unselect(e,t),this}isSnaplineEnabled(){return!this.snapline.widget.disabled}enableSnapline(){return this.snapline.widget.enable(),this}disableSnapline(){return this.snapline.widget.disable(),this}toggleSnapline(e){if(e!=null)e!==this.isSnaplineEnabled()&&(e?this.enableSnapline():this.disableSnapline());else return this.isSnaplineEnabled()?this.disableSnapline():this.enableSnapline(),this}hideSnapline(){return this.snapline.widget.hide(),this}setSnaplineFilter(e){return this.snapline.widget.setFilter(e),this}isSnaplineOnResizingEnabled(){return this.snapline.widget.options.resizing===!0}enableSnaplineOnResizing(){return this.snapline.widget.options.resizing=!0,this}disableSnaplineOnResizing(){return this.snapline.widget.options.resizing=!1,this}toggleSnaplineOnResizing(e){return e!=null?e!==this.isSnaplineOnResizingEnabled()&&(e?this.enableSnaplineOnResizing():this.disableSnaplineOnResizing()):this.isSnaplineOnResizingEnabled()?this.disableSnaplineOnResizing():this.enableSnaplineOnResizing(),this}isSharpSnapline(){return this.snapline.widget.options.sharp===!0}enableSharpSnapline(){return this.snapline.widget.options.sharp=!0,this}disableSharpSnapline(){return this.snapline.widget.options.sharp=!1,this}toggleSharpSnapline(e){return e!=null?e!==this.isSharpSnapline()&&(e?this.enableSharpSnapline():this.disableSharpSnapline()):this.isSharpSnapline()?this.disableSharpSnapline():this.enableSharpSnapline(),this}getSnaplineTolerance(){return this.snapline.widget.options.tolerance}setSnaplineTolerance(e){return this.snapline.widget.options.tolerance=e,this}removeTools(){return this.emit("tools:remove"),this}hideTools(){return this.emit("tools:hide"),this}showTools(){return this.emit("tools:show"),this}toSVG(e,t={}){this.format.toSVG(e,t)}toDataURL(e,t){this.format.toDataURL(e,t)}toPNG(e,t={}){this.format.toPNG(e,t)}toJPEG(e,t={}){this.format.toJPEG(e,t)}printPreview(e){this.print.show(e)}dispose(){this.clearCells(),this.off(),this.css.dispose(),this.hook.dispose(),this.defs.dispose(),this.grid.dispose(),this.coord.dispose(),this.transform.dispose(),this.knob.dispose(),this.highlight.dispose(),this.background.dispose(),this.clipboard.dispose(),this.snapline.dispose(),this.selection.dispose(),this.history.dispose(),this.keyboard.dispose(),this.mousewheel.dispose(),this.print.dispose(),this.format.dispose(),this.minimap.dispose(),this.panning.dispose(),this.scroller.dispose(),this.view.dispose(),this.renderer.dispose(),this.size.dispose()}}Ga([xa.checkScroller()],kr.prototype,"lockScroller",null),Ga([xa.checkScroller()],kr.prototype,"unlockScroller",null),Ga([xa.checkScroller()],kr.prototype,"updateScroller",null),Ga([xa.checkScroller()],kr.prototype,"getScrollbarPosition",null),Ga([xa.checkScroller()],kr.prototype,"setScrollbarPosition",null),Ga([xa.checkScroller()],kr.prototype,"scrollToPoint",null),Ga([xa.checkScroller()],kr.prototype,"scrollToContent",null),Ga([xa.checkScroller()],kr.prototype,"scrollToCell",null),Ga([xa.checkScroller()],kr.prototype,"transitionToPoint",null),Ga([xa.checkScroller()],kr.prototype,"transitionToRect",null),Ga([rs.dispose()],kr.prototype,"dispose",null),function(r){r.View=Ia,r.Hook=Pr,r.Renderer=qr,r.Keyboard=Bd,r.MouseWheel=v1,r.BaseManager=hi,r.DefsManager=ZA,r.GridManager=d1,r.CoordManager=XA,r.PrintManager=zd,r.FormatManager=KA,r.MiniMapManager=m1,r.HistoryManager=Fd,r.SnaplineManager=h1,r.ScrollerManager=f1,r.ClipboardManager=p1,r.TransformManager=Cy,r.HighlightManager=xy,r.BackgroundManager=by,r.SelectionManager=g1}(kr||(kr={})),function(r){r.toStringTag=`X6.${r.name}`;function e(t){if(t==null)return!1;if(t instanceof r)return!0;const n=t[Symbol.toStringTag],i=t;return(n==null||n===r.toStringTag)&&i.hook!=null&&i.view!=null&&i.model!=null}r.isGraph=e}(kr||(kr={})),function(r){function e(t,n){const i=t instanceof HTMLElement?new r({container:t}):new r(t);return n!=null&&i.fromJSON(n),i}r.render=e}(kr||(kr={})),function(r){r.registerNode=ii.registry.register,r.registerEdge=Ai.registry.register,r.registerView=Ii.registry.register,r.registerAttr=Cl.registry.register,r.registerGrid=su.registry.register,r.registerFilter=Sf.registry.register,r.registerNodeTool=Pf.registry.register,r.registerEdgeTool=Of.registry.register,r.registerBackground=zg.registry.register,r.registerHighlighter=cc.registry.register,r.registerPortLayout=Rd.registry.register,r.registerPortLabelLayout=_f.registry.register,r.registerMarker=ou.registry.register,r.registerRouter=du.registry.register,r.registerConnector=wl.registry.register,r.registerAnchor=Df.registry.register,r.registerEdgeAnchor=Nf.registry.register,r.registerConnectionPoint=Rf.registry.register,r.registerConnectionStrategy=Af.registry.register,r.registerHTMLComponent=Al.componentRegistry.register}(kr||(kr={})),function(r){r.unregisterNode=ii.registry.unregister,r.unregisterEdge=Ai.registry.unregister,r.unregisterView=Ii.registry.unregister,r.unregisterAttr=Cl.registry.unregister,r.unregisterGrid=su.registry.unregister,r.unregisterFilter=Sf.registry.unregister,r.unregisterNodeTool=Pf.registry.unregister,r.unregisterEdgeTool=Of.registry.unregister,r.unregisterBackground=zg.registry.unregister,r.unregisterHighlighter=cc.registry.unregister,r.unregisterPortLayout=Rd.registry.unregister,r.unregisterPortLabelLayout=_f.registry.unregister,r.unregisterMarker=ou.registry.unregister,r.unregisterRouter=du.registry.unregister,r.unregisterConnector=wl.registry.unregister,r.unregisterAnchor=Df.registry.unregister,r.unregisterEdgeAnchor=Nf.registry.unregister,r.unregisterConnectionPoint=Rf.registry.unregister,r.unregisterConnectionStrategy=Af.registry.unregister,r.unregisterHTMLComponent=Al.componentRegistry.unregister}(kr||(kr={}));class XU{constructor(){this.cells=[]}copy(e,t,n={}){this.options=Object.assign({},n);const o=(is.isModel(t)?t:t.model).cloneSubGraph(e,n);this.cells=bg(Object.keys(o).map(s=>o[s]),s=>s.isEdge()?2:1),this.serialize(n)}cut(e,t,n={}){this.copy(e,t,n),(kr.isGraph(t)?t.model:t).batchUpdate("cut",()=>{e.forEach(o=>o.remove())})}paste(e,t={}){const n=Object.assign(Object.assign({},this.options),t),{offset:i,edgeProps:o,nodeProps:s}=n;let a=20,l=20;i&&(a=typeof i=="number"?i:i.dx,l=typeof i=="number"?i:i.dy),this.deserialize(n);const c=this.cells;c.forEach(d=>{d.model=null,d.removeProp("zIndex"),(a||l)&&d.translate(a,l),s&&d.isNode()&&d.prop(s),o&&d.isEdge()&&d.prop(o)});const u=kr.isGraph(e)?e.model:e;return u.batchUpdate("paste",()=>{u.addCells(this.cells)}),this.copy(c,e,t),c}serialize(e){e.useLocalStorage!==!1&&e0.save(this.cells)}deserialize(e){if(e.useLocalStorage){const t=e0.fetch();t&&(this.cells=t)}}isEmpty(){return this.cells.length<=0}clean(){this.options={},this.cells=[],e0.clean()}}var e0;(function(r){const e=`${ea.prefixCls}.clipboard.cells`;function t(o){if(window.localStorage){const s=o.map(a=>a.toJSON());localStorage.setItem(e,JSON.stringify(s))}}r.save=t;function n(){if(window.localStorage){const o=localStorage.getItem(e),s=o?JSON.parse(o):[];if(s)return is.fromJSON(s)}}r.fetch=n;function i(){window.localStorage&&localStorage.removeItem(e)}r.clean=i})(e0||(e0={}));class YU{constructor(e){this.halo=e}get options(){return this.halo.options}get graph(){return this.halo.graph}get model(){return this.halo.model}get view(){return this.halo.view}get cell(){return this.halo.cell}get node(){return this.cell}getPresets(){return{className:"type-node",handles:[{name:"remove",position:"nw",events:{mousedown:this.removeCell.bind(this)},icon:null},{name:"resize",position:"se",events:{mousedown:this.startResize.bind(this),mousemove:this.doResize.bind(this),mouseup:this.stopResize.bind(this)},icon:null},{name:"clone",position:"n",events:{mousedown:this.startClone.bind(this),mousemove:this.doClone.bind(this),mouseup:this.stopClone.bind(this)},icon:null},{name:"link",position:"e",events:{mousedown:this.startLink.bind(this),mousemove:this.doLink.bind(this),mouseup:this.stopLink.bind(this)},icon:null},{name:"fork",position:"ne",events:{mousedown:this.startFork.bind(this),mousemove:this.doFork.bind(this),mouseup:this.stopFork.bind(this)},icon:null},{name:"unlink",position:"w",events:{mousedown:this.unlink.bind(this)},icon:null},{name:"rotate",position:"sw",events:{mousedown:this.startRotate.bind(this),mousemove:this.doRotate.bind(this),mouseup:this.stopRotate.bind(this)},icon:null}],bbox(e){return this.options.useCellGeometry?e.cell.getBBox():e.getBBox()},content(e){const t=pf("x: <%= x %>, y: <%= y %>, width: <%= width %>, height: <%= height %>, angle: <%= angle %>"),n=e.cell,i=n.getBBox();return t({x:Math.floor(i.x),y:Math.floor(i.y),width:Math.floor(i.width),height:Math.floor(i.height),angle:Math.floor(n.getAngle())})},magnet(e){return e.container},tinyThreshold:40,smallThreshold:80,loopEdgePreferredSide:"top",loopEdgeWidth:40,rotateGrid:15,rotateEmbeds:!1}}removeCell(){this.model.removeConnectedEdges(this.cell),this.cell.remove()}startLink({x:e,y:t}){this.halo.startBatch();const n=this.graph,i=this.createEdgeConnectedToSource();i.setTarget({x:e,y:t}),this.model.addEdge(i,{validation:!1,halo:this.halo.cid,async:!1}),n.view.undelegateEvents(),this.edgeView=n.renderer.findViewByCell(i),this.edgeView.prepareArrowheadDragging("target",{x:e,y:t,fallbackAction:"remove"})}createEdgeConnectedToSource(){const e=this.getMagnet(this.view,"source"),t=this.getEdgeTerminal(this.view,e),n=this.graph.hook.getDefaultEdge(this.view,e);return n.setSource(t),n}getMagnet(e,t){const n=this.options.magnet;if(typeof n=="function"){const i=dn(n,this.halo,e,t);if(i instanceof SVGElement)return i}throw new Error("`magnet()` has to return an SVGElement")}getEdgeTerminal(e,t){const n={cell:e.cell.id};if(t!==e.container){const i=t.getAttribute("port");i?n.port=i:n.selector=e.getSelector(t)}return n}doLink({e,x:t,y:n}){this.edgeView&&this.edgeView.onMouseMove(e,t,n)}stopLink({e,x:t,y:n}){const i=this.edgeView;if(i){i.onMouseUp(e,t,n);const o=i.cell;o.hasLoop()&&this.makeLoopEdge(o),this.halo.stopBatch(),this.halo.trigger("action:edge:addde",{edge:o}),this.edgeView=null}this.graph.view.delegateEvents()}makeLoopEdge(e){let t=null,n=null;const i=this.options.loopEdgeWidth,o=this.graph.options,s=new Ht(0,0,o.width,o.height),a=this.graph.graphToLocal(this.view.getBBox());[this.options.loopEdgePreferredSide,"top","bottom","left","right"].some(c=>{let u=null,d=0,h=0;switch(c){case"top":u=new pe(a.x+a.width/2,a.y-i),d=i/2;break;case"bottom":u=new pe(a.x+a.width/2,a.y+a.height+i),d=i/2;break;case"left":u=new pe(a.x-i,a.y+a.height/2),h=i/2;break;case"right":u=new pe(a.x+a.width+i,a.y+a.height/2),h=i/2;break;default:break}return u?(t=u.translate(-d,-h),n=u.translate(d,h),s.containsPoint(t)&&s.containsPoint(n)):!1})&&t&&n&&e.setVertices([t,n])}startResize({e}){this.halo.startBatch(),this.flip=[1,0,0,1,1,0,0,1][Math.floor(Rr.normalize(this.node.getAngle())/45)],this.view.addClass("node-resizing"),To("node:resize",e,this.view)}doResize({e,dx:t,dy:n}){const i=this.node.getSize(),o=Math.max(i.width+(this.flip?t:n),1),s=Math.max(i.height+(this.flip?n:t),1);this.node.resize(o,s,{absolute:!0}),To("node:resizing",e,this.view)}stopResize({e}){this.view.removeClass("node-resizing"),To("node:resized",e,this.view),this.halo.stopBatch()}startClone({e,x:t,y:n}){this.halo.startBatch();const o=this.options.clone(this.cell,{clone:!0});if(!Tr.isCell(o))throw new Error("option 'clone()' has to return a cell");this.centerNodeAtCursor(o,t,n),this.model.addCell(o,{halo:this.halo.cid,async:!1});const s=this.graph.renderer.findViewByCell(o);s.onMouseDown(e,t,n),this.halo.setEventData(e,{cloneView:s})}centerNodeAtCursor(e,t,n){const i=e.getBBox().getCenter(),o=t-i.x,s=n-i.y;e.translate(o,s)}doClone({e,x:t,y:n}){const i=this.halo.getEventData(e).cloneView;i&&i.onMouseMove(e,t,n)}stopClone({e,x:t,y:n}){const i=this.halo.getEventData(e).cloneView;i&&i.onMouseUp(e,t,n),this.halo.stopBatch()}startFork({e,x:t,y:n}){this.halo.startBatch();const i=this.options.clone(this.cell,{fork:!0});if(!Tr.isCell(i))throw new Error("option 'clone()' has to return a cell");this.centerNodeAtCursor(i,t,n),this.model.addCell(i,{halo:this.halo.cid,async:!1});const o=this.createEdgeConnectedToSource(),s=this.graph.renderer.findViewByCell(i),a=this.getMagnet(s,"target"),l=this.getEdgeTerminal(s,a);o.setTarget(l),this.model.addEdge(o,{halo:this.halo.cid,async:!1}),s.onMouseDown(e,t,n),this.halo.setEventData(e,{cloneView:s})}doFork({e,x:t,y:n}){const i=this.halo.getEventData(e).cloneView;i&&i.onMouseMove(e,t,n)}stopFork({e,x:t,y:n}){const i=this.halo.getEventData(e).cloneView;i&&i.onMouseUp(e,t,n),this.halo.stopBatch()}startRotate({e,x:t,y:n}){this.halo.startBatch();const i=this.node.getBBox().getCenter(),o=[this.node];this.options.rotateEmbeds&&this.node.getDescendants({deep:!0}).reduce((s,a)=>(a.isNode()&&s.push(a),s),o),this.halo.setEventData(e,{center:i,nodes:o,rotateStartAngles:o.map(s=>s.getAngle()),clientStartAngle:new pe(t,n).theta(i)}),o.forEach(s=>{const a=this.graph.findViewByCell(s);a&&(a.addClass("node-rotating"),To("node:rotate",e,a))})}doRotate({e,x:t,y:n}){const i=this.halo.getEventData(e),o=i.clientStartAngle-new pe(t,n).theta(i.center);i.nodes.forEach((s,a)=>{const l=i.rotateStartAngles[a],c=ao.snapToGrid(l+o,this.options.rotateGrid);s.rotate(c,{absolute:!0,center:i.center,halo:this.halo.cid}),To("node:rotating",e,this.graph.findViewByCell(s))})}stopRotate({e}){this.halo.getEventData(e).nodes.forEach(n=>{const i=this.graph.findViewByCell(n);i.removeClass("node-rotating"),To("node:rotated",e,i)}),this.halo.stopBatch()}unlink(){this.halo.startBatch(),this.model.removeConnectedEdges(this.cell),this.halo.stopBatch()}}class KU{constructor(e){this.halo=e}get options(){return this.halo.options}get graph(){return this.halo.graph}get model(){return this.halo.model}get view(){return this.halo.view}get cell(){return this.halo.cell}get edge(){return this.cell}getPresets(){return{className:"type-edge",handles:[{name:"remove",position:"nw",icon:null,events:{mousedown:this.removeEdge.bind(this)}},{name:"direction",position:"se",icon:null,events:{mousedown:this.directionSwap.bind(this)}}],content:!1,bbox(e){return e.graph.localToGraph(e.getPointAtRatio(.5))},tinyThreshold:-1,smallThreshold:-1}}removeEdge(){this.cell.remove()}directionSwap(){const e=this.edge.getSource(),t=this.edge.getTarget();this.edge.prop({source:t,target:e})}}class t0 extends Jg{get type(){return this.options.type||"surround"}get handleOptions(){return this.options}init(e){this.options=ir(t0.defaultOptions,this.cell.isNode()?new YU(this).getPresets():this.cell.isEdge()?new KU(this).getPresets():null,e),this.render(),this.initHandles(),this.update(),this.startListening()}startListening(){const e=this.model,t=this.graph;this.view.cell.on("removed",this.remove,this),e.on("reseted",this.remove,this),t.on("halo:destroy",this.remove,this),e.on("*",this.update,this),t.on("scale",this.update,this),t.on("translate",this.update,this),super.startListening()}stopListening(){const e=this.model,t=this.graph,n=this.view.cell;this.undelegateEvents(),n.off("removed",this.remove,this),e.off("reseted",this.remove,this),t.off("halo:destroy",this.remove,this),e.off("*",this.update,this),t.off("scale",this.update,this),t.off("translate",this.update,this),super.stopListening()}render(){const e=this.options,t=this.prefixClassName("widget-halo");return this.view.addClass(wy.NODE_CLS),this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(t).attr("data-shape",this.view.cell.shape),e.className&&this.$container.addClass(e.className),this.$handleContainer=this.$("<div/>").addClass(`${t}-handles`).appendTo(this.container),this.$content=this.$("<div/>").addClass(`${t}-content`).appendTo(this.container),this.$container.appendTo(this.graph.container),this}remove(){return this.stopBatch(),this.view.removeClass(wy.NODE_CLS),super.remove()}update(){if(this.isRendered()){this.updateContent();const e=this.getBBox(),t=this.options.tinyThreshold||0,n=this.options.smallThreshold||0;this.$handleContainer.toggleClass(`${this.handleClassName}-tiny`,e.width<t&&e.height<t);const i=`${this.handleClassName}-small`;this.$handleContainer.toggleClass(i,!this.$handleContainer.hasClass(i)&&e.width<n&&e.height<n),this.$container.css({width:e.width,height:e.height,left:e.x,top:e.y}),this.hasHandle("unlink")&&this.toggleUnlink(),(this.type==="surround"||this.type==="toolbar")&&this.hasHandle("fork")&&this.toggleFork()}}updateContent(){const e=this.options.content;if(typeof e=="function"){const t=dn(e,this,this.view,this.$content[0]);t&&this.$content.html(t)}else e?this.$content.html(e):this.$content.remove()}getBBox(){const e=this.view,t=this.options.bbox,n=typeof t=="function"?dn(t,this,e):t;return Ht.create(Object.assign({x:0,y:0,width:1,height:1},n))}removeCell(){this.cell.remove()}toggleFork(){const e=this.view.cell.clone(),t=this.graph.hook.createCellView(e),n=this.graph.hook.validateConnection(this.view,null,t,null,"target");this.$handleContainer.children(".fork").toggleClass("hidden",!n),t.remove()}toggleUnlink(){const e=this.model.getConnectedEdges(this.view.cell).length>0;this.$handleContainer.children(".unlink").toggleClass("hidden",!e)}startBatch(){this.model.startBatch("halo",{halo:this.cid})}stopBatch(){this.model.hasActiveBatch("halo")&&this.model.stopBatch("halo",{halo:this.cid})}}(function(r){r.defaultOptions={type:"surround",clearAll:!0,clearOnBlankMouseDown:!0,useCellGeometry:!1,clone:e=>e.clone().removeZIndex()}})(t0||(t0={})),Object.getOwnPropertyNames(Ld.prototype).forEach(r=>{r!=="constructor"&&Object.defineProperty(t0.prototype,r,Object.getOwnPropertyDescriptor(Ld.prototype,r))});var wy;(function(r){r.NODE_CLS="has-widget-halo"})(wy||(wy={}));var qU=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};class pc extends Fr{constructor(e){super();this.options=Object.assign(Object.assign({},pc.defaults),e),this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(this.prefixClassName("widget-dnd")),this.draggingGraph=new kr(Object.assign(Object.assign({},this.options.delegateGraphOptions),{container:document.createElement("div"),width:1,height:1})),this.$container.append(this.draggingGraph.container)}get targetScroller(){const e=this.options.target;return kr.isGraph(e)?e.scroller.widget:e}get targetGraph(){const e=this.options.target;return kr.isGraph(e)?e:e.graph}get targetModel(){return this.targetGraph.model}get snapline(){return this.targetGraph.snapline.widget}start(e,t){const n=t;n.preventDefault(),this.targetModel.startBatch("dnd"),this.$container.addClass("dragging").appendTo(this.options.draggingContainer||document.body),this.sourceNode=e,this.prepareDragging(e,n.clientX,n.clientY);const i=this.updateNodePosition(n.clientX,n.clientY);this.isSnaplineEnabled()&&(this.snapline.captureCursorOffset({e:n,node:e,cell:e,view:this.draggingView,x:i.x,y:i.y}),this.draggingNode.on("change:position",this.snap,this)),this.delegateDocumentEvents(pc.documentEvents,n.data)}isSnaplineEnabled(){return this.snapline&&!this.snapline.disabled}prepareDragging(e,t,n){const i=this.draggingGraph,o=i.model,s=this.options.getDragNode(e,{sourceNode:e,draggingGraph:i,targetGraph:this.targetGraph});s.position(0,0);let a=5;if(this.isSnaplineEnabled()&&(a+=this.snapline.options.tolerance||0),this.isSnaplineEnabled()||this.options.scaled){const u=this.targetGraph.transform.getScale();i.scale(u.sx,u.sy),a*=Math.max(u.sx,u.sy)}else i.scale(1,1);this.clearDragging(),this.options.animation&&this.$container.stop(!0,!0),o.resetCells([s]);const l=i.findViewByCell(s);l.undelegateEvents(),l.cell.off("changed"),i.fitToContent({padding:a,allowNewOrigin:"any"});const c=l.getBBox();this.geometryBBox=l.getBBox({useCellGeometry:!0}),this.delta=this.geometryBBox.getTopLeft().diff(c.getTopLeft()),this.draggingNode=s,this.draggingView=l,this.draggingBBox=s.getBBox(),this.padding=a,this.originOffset=this.updateGraphPosition(t,n)}updateGraphPosition(e,t){const n=document.body.scrollTop||document.documentElement.scrollTop,i=this.delta,o=this.geometryBBox,s=this.padding||5,a={left:e-i.x-o.width/2-s,top:t-i.y-o.height/2-s+n};return this.draggingGraph&&this.$container.offset(a),a}updateNodePosition(e,t){const n=this.targetGraph.clientToLocal(e,t),i=this.draggingBBox;return n.x-=i.width/2,n.y-=i.height/2,this.draggingNode.position(n.x,n.y),n}snap({cell:e,current:t,options:n}){const i=e;if(n.snapped){const o=this.draggingBBox;i.position(o.x+n.tx,o.y+n.ty,{silent:!0}),this.draggingView.translate(),i.position(t.x,t.y,{silent:!0}),this.snapOffset={x:n.tx,y:n.ty}}else this.snapOffset=null}onDragging(e){const t=this.draggingView;if(t){e.preventDefault();const n=this.normalizeEvent(e),i=n.clientX,o=n.clientY;this.updateGraphPosition(i,o);const s=this.updateNodePosition(i,o),a=this.targetGraph.options.embedding.enabled,l=(a||this.isSnaplineEnabled())&&this.isInsideValidArea({x:i,y:o});if(a){t.setEventData(n,{graph:this.targetGraph,candidateEmbedView:this.candidateEmbedView});const c=t.getEventData(n);l?t.processEmbedding(n,c):t.clearEmbedding(c),this.candidateEmbedView=c.candidateEmbedView}this.isSnaplineEnabled()&&(l?this.snapline.snapOnMoving({e:n,view:t,x:s.x,y:s.y}):this.snapline.hide())}}onDragEnd(e){const t=this.draggingNode;if(t){const n=this.normalizeEvent(e),i=this.draggingView,o=this.draggingBBox,s=this.snapOffset;let a=o.x,l=o.y;s&&(a+=s.x,l+=s.y),t.position(a,l,{silent:!0});const c=this.drop(t,{x:n.clientX,y:n.clientY}),u=d=>{d?(this.onDropped(t),this.targetGraph.options.embedding.enabled&&i&&(i.setEventData(n,{cell:d,graph:this.targetGraph,candidateEmbedView:this.candidateEmbedView}),i.finalizeEmbedding(n,i.getEventData(n)))):this.onDropInvalid(),this.candidateEmbedView=null,this.targetModel.stopBatch("dnd")};TC(c)?(this.undelegateDocumentEvents(),c.then(u)):u(c)}}clearDragging(){this.draggingNode&&(this.sourceNode=null,this.draggingNode.remove(),this.draggingNode=null,this.draggingView=null,this.delta=null,this.padding=null,this.snapOffset=null,this.originOffset=null,this.undelegateDocumentEvents())}onDropped(e){this.draggingNode===e&&(this.clearDragging(),this.$container.removeClass("dragging").remove())}onDropInvalid(){const e=this.draggingNode;if(e){const t=this.options.animation;if(t){const n=typeof t=="object"&&t.duration||150,i=typeof t=="object"&&t.easing||"swing";this.draggingView=null,this.$container.animate(this.originOffset,n,i,()=>this.onDropped(e))}else this.onDropped(e)}}isInsideValidArea(e){let t,n=null;const i=this.targetGraph,o=this.targetScroller;this.options.dndContainer&&(n=this.getDropArea(this.options.dndContainer));const s=n&&n.containsPoint(e);if(o)if(o.options.autoResize)t=this.getDropArea(o.container);else{const a=this.getDropArea(o.container);t=this.getDropArea(i.container).intersectsWithRect(a)}else t=this.getDropArea(i.container);return!s&&t&&t.containsPoint(e)}getDropArea(e){const t=this.$(e),n=t.offset(),i=document.body.scrollTop||document.documentElement.scrollTop,o=document.body.scrollLeft||document.documentElement.scrollLeft;return Ht.create({x:n.left+parseInt(t.css("border-left-width"),10)-o,y:n.top+parseInt(t.css("border-top-width"),10)-i,width:t.innerWidth(),height:t.innerHeight()})}drop(e,t){if(this.isInsideValidArea(t)){const n=this.targetGraph,i=n.model,o=n.clientToLocal(t),s=this.sourceNode,a=this.options.getDropNode(e,{sourceNode:s,draggingNode:e,targetGraph:this.targetGraph,draggingGraph:this.draggingGraph}),l=a.getBBox();o.x+=l.x-l.width/2,o.y+=l.y-l.height/2;const c=this.snapOffset?1:n.getGridSize();a.position(ao.snapToGrid(o.x,c),ao.snapToGrid(o.y,c)),a.removeZIndex();const u=this.options.validateNode,d=u?u(a,{sourceNode:s,draggingNode:e,droppingNode:a,targetGraph:n,draggingGraph:this.draggingGraph}):!0;return typeof d=="boolean"?d?(i.addCell(a,{stencil:this.cid}),a):null:r6(d).then(h=>h?(i.addCell(a,{stencil:this.cid}),a):null)}return null}onRemove(){this.draggingGraph&&(this.draggingGraph.view.remove(),this.draggingGraph.dispose())}dispose(){this.remove()}}qU([Fr.dispose()],pc.prototype,"dispose",null),function(r){r.defaults={animation:!1,getDragNode:e=>e.clone(),getDropNode:e=>e.clone()},r.documentEvents={mousemove:"onDragging",touchmove:"onDragging",mouseup:"onDragEnd",touchend:"onDragEnd",touchcancel:"onDragEnd"}}(pc||(pc={}));function JU(r,e={}){const t=is.isModel(r)?r:new is().resetCells(r,{sort:!1,dryrun:!0}),n=t.getNodes(),i=e.columns||1,o=Math.ceil(n.length/i),s=e.dx||0,a=e.dy||0,l=e.center!==!1,c=e.resizeToFit===!0,u=e.marginX||0,d=e.marginY||0,h=[];let f=e.columnWidth;if(f==="compact")for(let x=0;x<i;x+=1){const E=Tl.getNodesInColumn(n,x,i);h.push(Tl.getMaxDim(E,"width")+s)}else{(f==null||f==="auto")&&(f=Tl.getMaxDim(n,"width")+s);for(let x=0;x<i;x+=1)h.push(f)}const p=Tl.accumulate(h,u),g=[];let v=e.rowHeight;if(v==="compact")for(let x=0;x<o;x+=1){const E=Tl.getNodesInRow(n,x,i);g.push(Tl.getMaxDim(E,"height")+a)}else{(v==null||v==="auto")&&(v=Tl.getMaxDim(n,"height")+a);for(let x=0;x<o;x+=1)g.push(v)}const y=Tl.accumulate(g,d);t.startBatch("layout"),n.forEach((x,E)=>{const T=E%i,P=Math.floor(E/i),z=h[T],$=g[P];let ne=0,De=0,fe=x.getSize();if(c){let Ae=z-2*s,de=$-2*a;const ct=fe.height*(fe.width?Ae/fe.width:1),bt=fe.width*(fe.height?de/fe.height:1);$<ct?Ae=bt:de=ct,fe={width:Ae,height:de},x.setSize(fe,e)}l&&(ne=(z-fe.width)/2,De=($-fe.height)/2),x.position(p[T]+s+ne,y[P]+a+De,e)}),t.stopBatch("layout")}var Tl;(function(r){function e(o,s){return o.reduce((a,l)=>Math.max(l.getSize()[s],a),0)}r.getMaxDim=e;function t(o,s,a){const l=[];for(let c=a*s,u=c+a;c<u;c+=1)l.push(o[c]);return l}r.getNodesInRow=t;function n(o,s,a){const l=[];for(let c=s,u=o.length;c<u;c+=a)l.push(o[c]);return l}r.getNodesInColumn=n;function i(o,s){return o.reduce((a,l,c)=>(a.push(a[c]+l),a),[s||0])}r.accumulate=i})(Tl||(Tl={}));class Ey extends Fr{constructor(e){super();this.graphs={},this.$groups={},this.options=Object.assign(Object.assign({},Ey.defaultOptions),e),this.dnd=new pc(this.options),this.onSearch=KS(this.onSearch,200),this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(this.prefixClassName(js.base)).attr("data-not-found-text",this.options.notFoundText||"No matches found"),this.options.collapsable=e.collapsable&&e.groups&&e.groups.some(n=>n.collapsable!==!1),this.options.collapsable&&(this.$container.addClass("collapsable"),e.groups&&e.groups.every(i=>i.collapsed||i.collapsable===!1)&&this.$container.addClass("collapsed")),this.$("<div/>").addClass(this.prefixClassName(js.title)).html(this.options.title).appendTo(this.$container),e.search&&this.$container.addClass("searchable").append(this.renderSearch()),this.$content=this.$("<div/>").addClass(this.prefixClassName(js.content)).appendTo(this.$container);const t=e.stencilGraphOptions||{};if(e.groups&&e.groups.length)e.groups.forEach(n=>{const i=this.$("<div/>").addClass(this.prefixClassName(js.group)).attr("data-name",n.name);(n.collapsable==null&&e.collapsable||n.collapsable!==!1)&&i.addClass("collapsable"),i.toggleClass("collapsed",n.collapsed===!0);const o=this.$("<h3/>").addClass(this.prefixClassName(js.groupTitle)).html(n.title||n.name),s=this.$("<div/>").addClass(this.prefixClassName(js.groupContent)),a=n.graphOptions,l=new kr(Object.assign(Object.assign(Object.assign({},t),a),{container:document.createElement("div"),model:t.model||new is,width:n.graphWidth||e.stencilGraphWidth,height:n.graphHeight||e.stencilGraphHeight,interacting:!1,preventDefaultBlankAction:!1}));s.append(l.container),i.append(o,s).appendTo(this.$content),this.$groups[n.name]=i,this.graphs[n.name]=l});else{const n=new kr(Object.assign(Object.assign({},t),{container:document.createElement("div"),model:t.model||new is,width:e.stencilGraphWidth,height:e.stencilGraphHeight,interacting:!1,preventDefaultBlankAction:!1}));this.$content.append(n.container),this.graphs[n0.defaultGroupName]=n}return this.startListening(),this}get targetScroller(){const e=this.options.target;return kr.isGraph(e)?e.scroller.widget:e}get targetGraph(){const e=this.options.target;return kr.isGraph(e)?e:e.graph}get targetModel(){return this.targetGraph.model}renderSearch(){return this.$("<div/>").addClass(this.prefixClassName(js.search)).append(this.$("<input/>").attr({type:"search",placeholder:this.options.placeholder||"Search"}).addClass(this.prefixClassName(js.searchText)))}startListening(){const e=this.prefixClassName(js.title),t=this.prefixClassName(js.searchText),n=this.prefixClassName(js.groupTitle);this.delegateEvents({[`click .${e}`]:"onTitleClick",[`touchstart .${e}`]:"onTitleClick",[`click .${n}`]:"onGroupTitleClick",[`touchstart .${n}`]:"onGroupTitleClick",[`input .${t}`]:"onSearch",[`focusin .${t}`]:"onSearchFocusIn",[`focusout .${t}`]:"onSearchFocusOut"}),Object.keys(this.graphs).forEach(i=>{this.graphs[i].on("cell:mousedown",this.onDragStart,this)})}stopListening(){this.undelegateEvents(),Object.keys(this.graphs).forEach(e=>{this.graphs[e].off("cell:mousedown",this.onDragStart,this)})}load(e,t){return Array.isArray(e)?this.loadGroup(e,t):this.options.groups&&Object.keys(this.options.groups).forEach(n=>{e[n]&&this.loadGroup(e[n],n)}),this}loadGroup(e,t){const n=this.getModel(t);if(n){const a=e.map(l=>ii.isNode(l)?l:ii.create(l));n.resetCells(a)}const i=this.getGroup(t);let o=this.options.stencilGraphHeight;i&&i.graphHeight!=null&&(o=i.graphHeight);const s=i&&i.layout||this.options.layout;if(s&&n&&dn(s,this,n,i),!o){const a=this.getGraph(t);a.fitToContent({minWidth:a.options.width,gridHeight:1,padding:i&&i.graphPadding||this.options.stencilGraphPadding||10})}return this}onDragStart(e){const{e:t,node:n}=e;this.dnd.start(n,t)}filter(e,t){const n=Object.keys(this.graphs).reduce((i,o)=>{const s=this.graphs[o],a=o===n0.defaultGroupName?null:o,l=s.model.getNodes().filter(h=>{let f=!1;typeof t=="function"?f=dn(t,this,h,e,a,this):typeof t=="boolean"?f=t:f=this.isCellMatched(h,e,t,e.toLowerCase()!==e);const p=s.renderer.findViewByCell(h);return p&&p.$(p.container).toggleClass("unmatched",!f),f}),c=l.length>0,u=this.options,d=new is;return d.resetCells(l),u.layout&&dn(u.layout,this,d,this.getGroup(o)),this.$groups[o]&&this.$groups[o].toggleClass("unmatched",!c),s.fitToContent({gridWidth:1,gridHeight:1,padding:u.stencilGraphPadding||10}),i||c},!1);this.$container.toggleClass("not-found",!n)}isCellMatched(e,t,n,i){return t&&n?Object.keys(n).some(o=>{if(o==="*"||e.shape===o){const s=n[o];return typeof s=="boolean"?s:(Array.isArray(s)?s:[s]).some(l=>{let c=e.getPropByPath(l);return c!=null?(c=`${c}`,i||(c=c.toLowerCase()),c.indexOf(t)>=0):!1})}return!1}):!0}onSearch(e){this.filter(e.target.value,this.options.search)}onSearchFocusIn(){this.$container.addClass("is-focused")}onSearchFocusOut(){this.$container.removeClass("is-focused")}onTitleClick(){this.options.collapsable&&(this.$container.toggleClass("collapsed"),this.$container.hasClass("collapsed")?this.collapseGroups():this.expandGroups())}onGroupTitleClick(e){const t=this.$(e.target).closest(`.${this.prefixClassName(js.group)}`);this.toggleGroup(t.attr("data-name")||"");const n=Object.keys(this.$groups).every(i=>{const o=this.getGroup(i),s=this.$groups[i];return o&&o.collapsable===!1||s.hasClass("collapsed")});this.$container.toggleClass("collapsed",n)}getModel(e){const t=this.getGraph(e);return t?t.model:null}getGraph(e){return this.graphs[e||n0.defaultGroupName]}getGroup(e){const t=this.options.groups;return e!=null&&t&&t.length?t.find(n=>n.name===e):null}toggleGroup(e){return this.isGroupCollapsed(e)?this.expandGroup(e):this.collapseGroup(e),this}collapseGroup(e){if(this.isGroupCollapsable(e)){const t=this.$groups[e];t&&!this.isGroupCollapsed(e)&&(this.trigger("group:collapse",{name:e}),t.addClass("collapsed"))}return this}expandGroup(e){if(this.isGroupCollapsable(e)){const t=this.$groups[e];t&&this.isGroupCollapsed(e)&&(this.trigger("group:expand",{name:e}),t.removeClass("collapsed"))}return this}isGroupCollapsable(e){return this.$groups[e].hasClass("collapsable")}isGroupCollapsed(e){const t=this.$groups[e];return t&&t.hasClass("collapsed")}collapseGroups(){return Object.keys(this.$groups).forEach(e=>this.collapseGroup(e)),this}expandGroups(){return Object.keys(this.$groups).forEach(e=>this.expandGroup(e)),this}resizeGroup(e,t){const n=this.graphs[e];return n&&n.resize(t.width,t.height),this}onRemove(){Object.keys(this.graphs).forEach(e=>{this.graphs[e].view.remove(),delete this.graphs[e]}),this.dnd.remove(),this.stopListening(),this.undelegateDocumentEvents()}}(function(r){r.defaultOptions=Object.assign({stencilGraphWidth:200,stencilGraphHeight:800,title:"Stencil",collapsable:!1,placeholder:"Search",notFoundText:"No matches found",layout(e,t){const n={columnWidth:this.options.stencilGraphWidth/2-10,columns:2,rowHeight:80,resizeToFit:!1,dx:10,dy:10};JU(e,Object.assign(Object.assign(Object.assign({},n),this.options.layoutOptions),t?t.layoutOptions:{}))}},pc.defaults)})(Ey||(Ey={}));var js;(function(r){r.base="widget-stencil",r.title=`${r.base}-title`,r.search=`${r.base}-search`,r.searchText=`${r.search}-text`,r.content=`${r.base}-content`,r.group=`${r.base}-group`,r.groupTitle=`${r.group}-title`,r.groupContent=`${r.group}-content`})(js||(js={}));var n0;(function(r){r.defaultGroupName="__default__"})(n0||(n0={}));var pu=w(73935),y1;(function(r){function e(n){return!!n&&typeof n=="object"&&"dispose"in n&&typeof n.dispose=="function"}r.is=e;function t(n){return{dispose:n}}r.create=t,r.NONE=t(()=>{})})(y1||(y1={}));let QA;var eT;(function(r){r.None=()=>y1.NONE;function e(t,n){return(i,o)=>t(s=>i.call(o,n(s)),void 0)}r.map=e})(eT||(eT={})),QA=Symbol.iterator;class QU{constructor(e=!1){this.mono=void 0,this._callbacks=void 0,this.mono=e}get callbacks(){return this._callbacks||(this._callbacks=[]),this._callbacks}get length(){return this.callbacks.length}add(e,t=void 0){this.callbacks.push([e,t])}remove(e,t=void 0){if(this.isEmpty())return;let n=!1;for(let i=0;i<this.length;i+=1)if(this.callbacks[i][0]===e){if(this.callbacks[i][1]===t){this.callbacks.splice(i,1);return}n=!0}if(n)throw new Error("You should remove it with the same context you add it")}[QA](){return this.isEmpty()?[][Symbol.iterator]():this.callbacks.slice(0).map(t=>(...n)=>t[0].apply(t[1],n))[Symbol.iterator]()}invoke(...e){const t=[];for(const n of this)try{t.push(n(...e))}catch(i){console.error(i)}return t}isEmpty(){return this.callbacks.length===0}dispose(){this._callbacks=void 0}}class r0{constructor(e={}){this.options=void 0,this._event=void 0,this._callbacks=void 0,this.disposed=!1,this.options=e}get callbacks(){return this._callbacks||(this._callbacks=new QU),this._callbacks}get event(){return this._event||(this._event=(e,t)=>{this.options.onFirstListenerAdd&&this.callbacks.isEmpty()&&this.options.onFirstListenerAdd(this),this.callbacks.add(e,t);const n={dispose:()=>{n.dispose=r0.noop,this.disposed||(this.callbacks.remove(e,t),n.dispose=r0.noop,this.options.onLastListenerRemove&&this.callbacks.isEmpty()&&this.options.onLastListenerRemove(this))}};return n}),this._event}fire(e){!this._callbacks||this.callbacks.invoke(e)}sequence(e){return eI(this,null,function*(){for(const t of this.callbacks)if(!(yield e(t)))break})}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0),this.disposed=!0}}r0.noop=()=>{};var wn;(function(r){function e(n){return!!n&&typeof n=="object"&&"dispose"in n&&typeof n.dispose=="function"}r.is=e;function t(n){return{dispose:n}}r.create=t,r.NULL=t(()=>{})})(wn||(wn={}));class $r{constructor(...e){this.disposables=[],this.onDisposeEmitter=new r0,this.disposingElements=!1,e.forEach(t=>this.push(t))}get onDispose(){return this.onDisposeEmitter.event}checkDisposed(){this.disposed&&!this.disposingElements&&(this.onDisposeEmitter.fire(void 0),this.onDisposeEmitter.dispose())}get disposed(){return this.disposables.length===0}dispose(){return(0,S.mG)(this,void 0,void 0,function*(){if(!(this.disposed||this.disposingElements)){for(this.disposingElements=!0;!this.disposed;)try{yield this.disposables.pop().dispose()}catch(e){console.error(e)}this.disposingElements=!1,this.checkDisposed()}})}push(e){const{disposables:t}=this;t.push(e);const n=e.dispose.bind(e),i=wn.create(()=>{const o=t.indexOf(e);o!==-1&&t.splice(o,1),this.checkDisposed()});return e.dispose=()=>{i.dispose(),n()},i}pushAll(e){return e.map(t=>this.push(t))}}class ta{constructor(){this.isResolved=!1,this.isRejected=!1,this.promise=new Promise((e,t)=>{this.resolve=(...n)=>{this.isResolved=!0,e(...n)},this.reject=(...n)=>{this.isRejected=!0,t(...n)}})}}const tT="X6_NODE_PORTAL_NODE_VIEW",e8="xflow",nT=.01,rT=1.5,Sy="XFLOW_DEFAULT_NODE",t8="XFLOW_DEFAULT_GROUP_NODE",iT="XFLOW_DEFAULT_EDGE",i0="XFLOW_COPY_ITEMS",oT={width:180,height:36};function na(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}var sT=w(18267),aT=w(18095);const o0=b.createContext(null);o0.displayName="XFlowAppContext";const Yo=()=>{const r=b.useContext(o0);return r&&r.getApp?r.getApp():null},n8=()=>b.useContext(o0);class lT{constructor(e=!1){this.cache=null,this.setApp=t=>{this.cache=t,this.onAppChangeCallback&&this.onAppChangeCallback(t)},this.isUserDefined=()=>this.isUserDefinedFlag,this.getApp=()=>this.cache,this.onAppChange=t=>{this.onAppChangeCallback=t},this.dispose=()=>{this.cache=null},this.isUserDefinedFlag=e}}const cT=r=>{const e=n8(),[,t]=b.useState(null),n=b.useMemo(()=>e&&e.isUserDefined()?e:new lT(!1),[]);return n.isUserDefined()||n.onAppChange(()=>t(0)),b.useEffect(()=>{r.app&&n.setApp(r.app)},[r.app]),n.isUserDefined()?b.createElement(b.Fragment,null,r.children):b.createElement(o0.Provider,{value:Object.assign({},n)},r.children)};cT.displayName="XFlowAppInternalProvider";const r8=({children:r})=>{const[,e]=b.useState(null),t=b.useMemo(()=>new lT(!0),[]);return t.onAppChange(()=>e(0)),b.createElement(o0.Provider,{value:Object.assign({},t)},r)};r8.displayName="XFlowAppProvider";var Wr;(function(r){const e="\u8282\u70B9\u64CD\u4F5C";r.ADD_NODE={id:"xflow:add-node",label:"\u6DFB\u52A0\u8282\u70B9",category:e},r.DEL_NODE={id:"xflow:del-node",label:"\u5220\u9664\u8282\u70B9",category:e},r.UPDATE_NODE_PORT={id:"xflow:update-node-port",label:"\u5220\u9664\u8FDE\u63A5\u6869",category:e},r.UPDATE_NODE={id:"xflow:update-node",label:"\u66F4\u65B0\u8282\u70B9",category:e},r.HIGHLIGHT_NODE={id:"xflow:highlight-node",label:"\u9AD8\u4EAE\u8282\u70B9",category:e},r.SELECT_NODE={id:"xflow:select-node",label:"\u9009\u4E2D\u8282\u70B9",category:e},r.MOVE_NODE={id:"xflow:move-node",label:"Move Node",category:e},r.CENTER_NODE={id:"xflow:center-node",label:"\u5C45\u4E2D\u8282\u70B9",category:e},r.FRONT_NODE={id:"xflow:front-node",label:"\u524D\u7F6E\u8282\u70B9",category:e},r.BACK_NODE={id:"xflow:back-node",label:"\u540E\u7F6E\u8282\u70B9",category:e}})(Wr||(Wr={}));var Ti;(function(r){const e="\u8FB9\u64CD\u4F5C";r.ADD_EDGE={id:"xflow:add-edge",label:"\u6DFB\u52A0\u8FB9",category:e},r.DEL_EDGE={id:"xflow:del-edge",label:"\u5220\u9664\u8FB9",category:e},r.UPDATE_EDGE={id:"xflow:update-edge",label:"\u66F4\u65B0\u8FB9",category:e},r.HIGHLIGHT_EDGE={id:"xflow:highlight-edge",label:"\u9AD8\u4EAE\u8FB9",category:e},r.FRONT_EDGE={id:"xflow:front-edge",label:"\u524D\u7F6E\u53D8",category:e},r.BACK_EDGE={id:"xflow:back-edge",label:"\u540E\u7F6E\u8FB9",category:e}})(Ti||(Ti={}));var Zn;(function(r){const e="\u753B\u5E03\u64CD\u4F5C";r.LOAD_META={id:"xflow:load-meta",label:"\u83B7\u53D6\u5143\u6570\u636E",category:e},r.LOAD_DATA={id:"xflow:load-data",label:"\u83B7\u53D6\u56FE\u6570\u636E",category:e},r.SAVE_GRAPH_DATA={id:"xflow:save-graph-data",label:"\u4FDD\u5B58",category:e},r.GRAPH_LAYOUT={id:"xflow:layout",label:"\u8BA1\u7B97\u5E03\u5C40",category:e},r.GRAPH_RENDER={id:"xflow:graph-render",label:"\u6E32\u67D3\u753B\u5E03",category:e},r.UNDO_CMD={id:"xflow:undo-cmd",label:"\u64A4\u9500",category:e},r.REDO_CMD={id:"xflow:redo-cmd",label:"\u91CD\u505A",category:e},r.GRAPH_INSTANCE_COMMAND={id:"xflow:graph-instacne-cmd",label:"Graph\u901A\u7528Command",category:e},r.GRAPH_ZOOM={id:"xflow:graph-zoom",label:"\u7F29\u653E\u753B\u5E03",category:e},r.GRAPH_FULLSCREEN={id:"xflow:graph-fullscreen",label:"\u5168\u5C4F",category:e},r.GRAPH_RESIZE={id:"xflow:graph-resize",label:"\u8C03\u6574\u7A97\u53E3\u5927\u5C0F",category:e},r.GRAPH_COPY={id:"xflow:graph-copy-selection",label:"\u590D\u5236",category:e},r.GRAPH_PASTE={id:"xflow:graph-paste-selection",label:"\u7C98\u8D34",category:e},r.GRAPH_TOGGLE_MULTI_SELECT={id:"xflow:graph-toggle-multi-select",label:"\u542F\u7528\u6846\u9009",category:e},r.GRAPH_ADD_TOOL={id:"xflow:add-tool",label:"\u6DFB\u52A0\u5DE5\u5177",category:e},r.GRAPH_DEL_TOOL={id:"xflow:del-tool",label:"\u5220\u9664\u5DE5\u5177",category:e},r.GRAPH_HISTORY_UNDO={id:"xflow:history-undo",label:"history undo",category:e},r.GRAPH_HISTORY_REDO={id:"xflow:history-redo",label:"history redo",category:e},r.GRAPH_HISTORY_RESET={id:"xflow:history-reset",label:"history reset",category:e},r.GRAPH_HISTORY_TOGGLE={id:"xflow:history-toggle",label:"history toggle",category:e}})(Zn||(Zn={}));var b1;(function(r){const e="\u72B6\u6001\u64CD\u4F5C";r.UPDATE_MODEL={id:"xflow:update-model",label:"\u8BBE\u7F6E\u72B6\u6001\u503C",category:e}})(b1||(b1={}));var Co;(function(r){const e="\u7FA4\u7EC4\u64CD\u4F5C";r.INIT_GROUP={id:"xflow:init-group",label:"\u521D\u59CB\u5316\u7FA4\u7EC4",category:e},r.ADD_GROUP={id:"xflow:add-group",label:"\u65B0\u5EFA\u7FA4\u7EC4",category:e},r.DEL_GROUP={id:"xflow:del-group",label:"\u89E3\u6563\u7FA4\u7EC4",category:e},r.COLLAPSE_GROUP={id:"xflow:collapse-group",label:"\u6298\u53E0\u7FA4\u7EC4",category:e}})(Co||(Co={}));const uT=r=>{const{cell:e}=r,t=Yo(),n=r.data.isCollapsed||!1,i=s=>{s.preventDefault(),t.executeCommand(Co.COLLAPSE_GROUP.id,{nodeId:e.id,isCollapsed:!1})},o=s=>{s.preventDefault(),t.executeCommand(Co.COLLAPSE_GROUP.id,{nodeId:e.id,isCollapsed:!0,gap:3})};return b.createElement("div",{className:"xflow-default-group-node"},b.createElement("div",{className:"xflow-group-header"},b.createElement("div",{className:"header-left"},r.data.label),b.createElement("div",{className:"header-right"},n&&b.createElement(sT.Z,{onClick:i}),!n&&b.createElement(aT.Z,{onClick:o}))))};uT.displayName="XFlowDefaultGroupNode";var dT=w(32779),i8=w(73218),o8=w(15873),s8=w(57119),a8=w(68628),l8=w(73888);const c8={fontSize:"16px",color:"#3057e3"};var Ud;(function(r){r.SUCCESS="success",r.PROCESSING="processing",r.ERROR="error",r.DEFAULT="default",r.WARNING="warning"})(Ud||(Ud={}));const u8=r=>{if(r.hide)return null;switch(r.status){case Ud.PROCESSING:return b.createElement(dT.Z,{spin:!0,style:{color:"#c1cdf7",fontSize:"16px"}});case Ud.ERROR:return b.createElement(i8.Z,{style:{color:"#ff4d4f",fontSize:"16px"}});case Ud.SUCCESS:return b.createElement(o8.Z,{style:{color:"#39ca74cc",fontSize:"16px"}});case Ud.WARNING:return b.createElement(s8.Z,{style:{color:"#faad14",fontSize:"16px"}});case Ud.DEFAULT:return b.createElement(a8.Z,{style:{color:"#d9d9d9",fontSize:"16px"}});default:return null}},hT=r=>{const e=b.isValidElement(r.data.icon)?r.data.icon:b.createElement(l8.Z,{style:c8});return b.createElement("div",{className:`xflow-default-node ${r.isNodeTreePanel?"panel-node":""}`},b.createElement("span",{className:"icon"},e),b.createElement("span",{className:"label"},r.data.label),b.createElement("span",{className:"status"},b.createElement(u8,{status:r.data&&r.data.status,hide:r.isNodeTreePanel})))};hT.displayName="XFlowDefaultNode";var Ff;(function(r){r.CONFIG_TYPE="GraphConfig",r.defaultNodeTypeParser=e=>e.renderKey,r.defaultEdgeTypeParser=e=>e.renderKey,r.defaultNodeMapValue=[[Sy,hT],[t8,uT]]})(Ff||(Ff={}));class fT{constructor(){this.CONFIG_TYPE=Ff.CONFIG_TYPE,this.x6Options=new ta,this.rootContainer=new ta,this.graphContainer=new ta,this.nodeRender=new Map(Ff.defaultNodeMapValue),this.edgeRender=new Map,this.nodeTypeParser=Ff.defaultNodeTypeParser,this.edgeTypeParser=Ff.defaultEdgeTypeParser,this.events=[],this.mergeX6Config=e=>(0,S.mG)(this,void 0,void 0,function*(){const t=yield this.getX6Config();return Object.assign(t,e)}),this.getX6Config=()=>(0,S.mG)(this,void 0,void 0,function*(){return yield this.x6Options.promise}),this.setX6Config=e=>{var t;const n=this.getDefaultGraphOptions();(t=this.x6Options)===null||t===void 0||t.resolve(Object.assign(Object.assign({},n),e))},this.setAppContainer=e=>{this.appContainer=e},this.setRootContainer=e=>{e&&(this===null||this===void 0||this.rootContainer.resolve(e))},this.setGraphContainer=e=>{var t;e&&((t=this.graphContainer)===null||t===void 0||t.resolve(e))},this.setEvents=e=>{this.events=e},this.setDefaultNodeRender=e=>{this.nodeRender.set(Sy,e)},this.setDefaultEdgeRender=e=>{this.edgeRender.set(iT,e)},this.setNodeRender=(e,t)=>{this.nodeRender.set(e,t)},this.setEdgeRender=(e,t)=>{this.edgeRender.set(e,t)},this.setNodeTypeParser=e=>{this.nodeTypeParser=e},this.setEdgeTypeParser=e=>{this.edgeTypeParser=e},this.getConfig=()=>(0,S.mG)(this,void 0,void 0,function*(){const[e,t,n]=yield Promise.all([this.rootContainer.promise,this.graphContainer.promise,this.x6Options.promise]);return{xflowInstanceId:this.xflowInstanceId,graphId:this.graphId,nodeViewId:this.graphId,appContainer:this.appContainer,rootContainer:e,graphContainer:t,x6Options:n,events:this.events,nodeRender:this.nodeRender,edgeRender:this.edgeRender,nodeTypeParser:this.nodeTypeParser,edgeTypeParser:this.edgeTypeParser}}),this.getDefaultGraphOptions=()=>({rotating:!1,resizing:!1,connecting:{snap:!0,dangling:!1,highlight:!1,connectionPoint:"rect",router:{name:"er"},connector:{name:"rounded",args:{radius:15}}},background:{},grid:{visible:!0},selecting:{strict:!0,enabled:!0,multiple:!0,selectCellOnMoved:!0,showNodeSelectionBox:!1,rubberEdge:!0,rubberNode:!0,movable:!0},snapline:{enabled:!1},history:{enabled:!1},clipboard:{enabled:!0,useLocalStorage:!0},scroller:{enabled:!1},mousewheel:{enabled:!0,minScale:nT,maxScale:rT,factor:1.1,modifiers:["ctrl","meta"]},panning:{enabled:!0},scaling:{min:nT,max:rT},keyboard:{enabled:!0},interacting:{nodeMovable:!0,edgeLabelMovable:!1},async:!1}),this.dispose=()=>{this.rootContainer=new ta,this.graphContainer=new ta,this.x6Options=new ta},this.graphId=na()}}const s0=Symbol("IGraphOptionProvider"),d8=(r,e)=>{r(s0,{lifecycle:L.Lifecycle.singleton,useDynamic:()=>({getOptions:()=>(0,S.mG)(void 0,void 0,void 0,function*(){return e.getConfig()})})})},h8=r=>e=>{const t=b.useMemo(()=>({getValue:()=>({})}),[]);return t.getValue=()=>e,b.useMemo(()=>{const i=new fT;return r(i,t),i},[t])};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var x1=function(e,t){return x1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},x1(e,t)};function Ko(r,e){x1(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var pT=function(){return pT=Object.assign||function(t){for(var n,i=1,o=arguments.length;i<o;i++){n=arguments[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},pT.apply(this,arguments)};function ote(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}function ste(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}function ate(r,e){return function(t,n){e(t,n,r)}}function lte(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function cte(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(n.next(u))}catch(d){s(d)}}function l(u){try{c(n.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})}function ute(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(u){c=[6,u],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function dte(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}function hte(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function gT(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function f8(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(s)throw s.error}}return o}function fte(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(f8(arguments[e]));return r}function pte(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n}function _y(r){return this instanceof _y?(this.v=r,this):new _y(r)}function gte(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(h){n[h]&&(i[h]=function(f){return new Promise(function(p,g){o.push([h,f,p,g])>1||a(h,f)})})}function a(h,f){try{l(n[h](f))}catch(p){d(o[0][3],p)}}function l(h){h.value instanceof _y?Promise.resolve(h.value.v).then(c,u):d(o[0][2],h)}function c(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),o.shift(),o.length&&a(o[0][0],o[0][1])}}function mte(r){var e,t;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,o){e[i]=r[i]?function(s){return(t=!t)?{value:_y(r[i](s)),done:i==="return"}:o?o(s):s}:o}}function vte(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof gT=="function"?gT(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(o){t[o]=r[o]&&function(s){return new Promise(function(a,l){s=r[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}function yte(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function bte(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function xte(r){return r&&r.__esModule?r:{default:r}}function Cte(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function wte(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}var p8=function(){return Array.isArray||function(r){return r&&typeof r.length=="number"}}();function mT(r){return r!==null&&typeof r=="object"}function C1(r){return typeof r=="function"}var g8=function(){function r(e){return Error.call(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(t,n){return n+1+") "+t.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e,this}return r.prototype=Object.create(Error.prototype),r}(),Ay=g8,Bf=function(){function r(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return r.prototype.unsubscribe=function(){var e;if(!this.closed){var t=this,n=t._parentOrParents,i=t._ctorUnsubscribe,o=t._unsubscribe,s=t._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof r)n.remove(this);else if(n!==null)for(var a=0;a<n.length;++a){var l=n[a];l.remove(this)}if(C1(o)){i&&(this._unsubscribe=void 0);try{o.call(this)}catch(d){e=d instanceof Ay?vT(d.errors):[d]}}if(p8(s))for(var a=-1,c=s.length;++a<c;){var u=s[a];if(mT(u))try{u.unsubscribe()}catch(h){e=e||[],h instanceof Ay?e=e.concat(vT(h.errors)):e.push(h)}}if(e)throw new Ay(e)}},r.prototype.add=function(e){var t=e;if(!e)return r.EMPTY;switch(typeof e){case"function":t=new r(e);case"object":if(t===this||t.closed||typeof t.unsubscribe!="function")return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof r)){var n=t;t=new r,t._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=t._parentOrParents;if(i===null)t._parentOrParents=this;else if(i instanceof r){if(i===this)return t;t._parentOrParents=[i,this]}else if(i.indexOf(this)===-1)i.push(this);else return t;var o=this._subscriptions;return o===null?this._subscriptions=[t]:o.push(t),t},r.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);n!==-1&&t.splice(n,1)}},r.EMPTY=function(e){return e.closed=!0,e}(new r),r}();function vT(r){return r.reduce(function(e,t){return e.concat(t instanceof Ay?t.errors:t)},[])}var m8=function(r){Ko(e,r);function e(t,n){return r.call(this)||this}return e.prototype.schedule=function(t,n){return n===void 0&&(n=0),this},e}(Bf),v8=function(r){Ko(e,r);function e(t,n){var i=r.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.pending=!1,i}return e.prototype.schedule=function(t,n){if(n===void 0&&(n=0),this.closed)return this;this.state=t;var i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,n)),this.pending=!0,this.delay=n,this.id=this.id||this.requestAsyncId(o,this.id,n),this},e.prototype.requestAsyncId=function(t,n,i){return i===void 0&&(i=0),setInterval(t.flush.bind(t,this),i)},e.prototype.recycleAsyncId=function(t,n,i){if(i===void 0&&(i=0),i!==null&&this.delay===i&&this.pending===!1)return n;clearInterval(n)},e.prototype.execute=function(t,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,n);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,n){var i=!1,o=void 0;try{this.work(t)}catch(s){i=!0,o=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),o},e.prototype._unsubscribe=function(){var t=this.id,n=this.scheduler,i=n.actions,o=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,o!==-1&&i.splice(o,1),t!=null&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null},e}(m8),yT=function(){function r(e,t){t===void 0&&(t=r.now),this.SchedulerAction=e,this.now=t}return r.prototype.schedule=function(e,t,n){return t===void 0&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},r.now=function(){return Date.now()},r}(),y8=function(r){Ko(e,r);function e(t,n){n===void 0&&(n=yT.now);var i=r.call(this,t,function(){return e.delegate&&e.delegate!==i?e.delegate.now():n()})||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return e.prototype.schedule=function(t,n,i){return n===void 0&&(n=0),e.delegate&&e.delegate!==this?e.delegate.schedule(t,n,i):r.prototype.schedule.call(this,t,n,i)},e.prototype.flush=function(t){var n=this.actions;if(this.active){n.push(t);return}var i;this.active=!0;do if(i=t.execute(t.state,t.delay))break;while(t=n.shift());if(this.active=!1,i){for(;t=n.shift();)t.unsubscribe();throw i}},e}(yT),bT=new y8(v8),b8=bT,w1=!1,Fa={Promise:void 0,set useDeprecatedSynchronousErrorHandling(r){if(r){var e=new Error;""+e.stack}w1=r},get useDeprecatedSynchronousErrorHandling(){return w1}};function zf(r){setTimeout(function(){throw r},0)}var Ty={closed:!0,next:function(r){},error:function(r){if(Fa.useDeprecatedSynchronousErrorHandling)throw r;zf(r)},complete:function(){}},My=function(){return typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Ete=null,ra=function(r){Ko(e,r);function e(t,n,i){var o=r.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=Ty;break;case 1:if(!t){o.destination=Ty;break}if(typeof t=="object"){t instanceof e?(o.syncErrorThrowable=t.syncErrorThrowable,o.destination=t,t.add(o)):(o.syncErrorThrowable=!0,o.destination=new xT(o,t));break}default:o.syncErrorThrowable=!0,o.destination=new xT(o,t,n,i);break}return o}return e.prototype[My]=function(){return this},e.create=function(t,n,i){var o=new e(t,n,i);return o.syncErrorThrowable=!1,o},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(Bf),xT=function(r){Ko(e,r);function e(t,n,i,o){var s=r.call(this)||this;s._parentSubscriber=t;var a,l=s;return C1(n)?a=n:n&&(a=n.next,i=n.error,o=n.complete,n!==Ty&&(l=Object.create(n),C1(l.unsubscribe)&&s.add(l.unsubscribe.bind(l)),l.unsubscribe=s.unsubscribe.bind(s))),s._context=l,s._next=a,s._error=i,s._complete=o,s}return e.prototype.next=function(t){if(!this.isStopped&&this._next){var n=this._parentSubscriber;!Fa.useDeprecatedSynchronousErrorHandling||!n.syncErrorThrowable?this.__tryOrUnsub(this._next,t):this.__tryOrSetError(n,this._next,t)&&this.unsubscribe()}},e.prototype.error=function(t){if(!this.isStopped){var n=this._parentSubscriber,i=Fa.useDeprecatedSynchronousErrorHandling;if(this._error)!i||!n.syncErrorThrowable?(this.__tryOrUnsub(this._error,t),this.unsubscribe()):(this.__tryOrSetError(n,this._error,t),this.unsubscribe());else if(n.syncErrorThrowable)i?(n.syncErrorValue=t,n.syncErrorThrown=!0):zf(t),this.unsubscribe();else{if(this.unsubscribe(),i)throw t;zf(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var n=this._parentSubscriber;if(this._complete){var i=function(){return t._complete.call(t._context)};!Fa.useDeprecatedSynchronousErrorHandling||!n.syncErrorThrowable?(this.__tryOrUnsub(i),this.unsubscribe()):(this.__tryOrSetError(n,i),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,n){try{t.call(this._context,n)}catch(i){if(this.unsubscribe(),Fa.useDeprecatedSynchronousErrorHandling)throw i;zf(i)}},e.prototype.__tryOrSetError=function(t,n,i){if(!Fa.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{n.call(this._context,i)}catch(o){return Fa.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=o,t.syncErrorThrown=!0,!0):(zf(o),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(ra);function x8(r){for(;r;){var e=r,t=e.closed,n=e.destination,i=e.isStopped;if(t||i)return!1;n&&n instanceof ra?r=n:r=null}return!0}function C8(r,e,t){if(r){if(r instanceof ra)return r;if(r[My])return r[My]()}return!r&&!e&&!t?new ra(Ty):new ra(r,e,t)}var E1=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function w8(r){return r}function Ste(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return CT(r)}function CT(r){return r.length===0?w8:r.length===1?r[0]:function(t){return r.reduce(function(n,i){return i(n)},t)}}var S1=function(){function r(e){this._isScalar=!1,e&&(this._subscribe=e)}return r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,n){var i=this.operator,o=C8(e,t,n);if(i?o.add(i.call(o,this.source)):o.add(this.source||Fa.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),Fa.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){Fa.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),x8(e)?e.error(t):console.warn(t)}},r.prototype.forEach=function(e,t){var n=this;return t=wT(t),new t(function(i,o){var s;s=n.subscribe(function(a){try{e(a)}catch(l){o(l),s&&s.unsubscribe()}},o,i)})},r.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},r.prototype[E1]=function(){return this},r.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length===0?this:CT(e)(this)},r.prototype.toPromise=function(e){var t=this;return e=wT(e),new e(function(n,i){var o;t.subscribe(function(s){return o=s},function(s){return i(s)},function(){return n(o)})})},r.create=function(e){return new r(e)},r}();function wT(r){if(r||(r=Fa.Promise||Promise),!r)throw new Error("no Promise impl found");return r}var E8=function(){function r(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return r.prototype=Object.create(Error.prototype),r}(),Uf=E8,S8=function(r){Ko(e,r);function e(t,n){var i=r.call(this)||this;return i.subject=t,i.subscriber=n,i.closed=!1,i}return e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,n=t.observers;if(this.subject=null,!(!n||n.length===0||t.isStopped||t.closed)){var i=n.indexOf(this.subscriber);i!==-1&&n.splice(i,1)}}},e}(Bf),_8=function(r){Ko(e,r);function e(t){var n=r.call(this,t)||this;return n.destination=t,n}return e}(ra),ET=function(r){Ko(e,r);function e(){var t=r.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype[My]=function(){return new _8(this)},e.prototype.lift=function(t){var n=new ST(this,this);return n.operator=t,n},e.prototype.next=function(t){if(this.closed)throw new Uf;if(!this.isStopped)for(var n=this.observers,i=n.length,o=n.slice(),s=0;s<i;s++)o[s].next(t)},e.prototype.error=function(t){if(this.closed)throw new Uf;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var n=this.observers,i=n.length,o=n.slice(),s=0;s<i;s++)o[s].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new Uf;this.isStopped=!0;for(var t=this.observers,n=t.length,i=t.slice(),o=0;o<n;o++)i[o].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(t){if(this.closed)throw new Uf;return r.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){if(this.closed)throw new Uf;return this.hasError?(t.error(this.thrownError),Bf.EMPTY):this.isStopped?(t.complete(),Bf.EMPTY):(this.observers.push(t),new S8(this,t))},e.prototype.asObservable=function(){var t=new S1;return t.source=this,t},e.create=function(t,n){return new ST(t,n)},e}(S1),ST=function(r){Ko(e,r);function e(t,n){var i=r.call(this)||this;return i.destination=t,i.source=n,i}return e.prototype.next=function(t){var n=this.destination;n&&n.next&&n.next(t)},e.prototype.error=function(t){var n=this.destination;n&&n.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){var n=this.source;return n?this.source.subscribe(t):Bf.EMPTY},e}(ET),A8=function(r){Ko(e,r);function e(t){var n=r.call(this)||this;return n._value=t,n}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(t){var n=r.prototype._subscribe.call(this,t);return n&&!n.closed&&t.next(this._value),n},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new Uf;return this._value},e.prototype.next=function(t){r.prototype.next.call(this,this._value=t)},e}(ET);function T8(r,e){return function(t){return t.lift(new M8(r,e))}}var M8=function(){function r(e,t){this.compare=e,this.keySelector=t}return r.prototype.call=function(e,t){return t.subscribe(new P8(e,this.compare,this.keySelector))},r}(),P8=function(r){Ko(e,r);function e(t,n,i){var o=r.call(this,t)||this;return o.keySelector=i,o.hasKey=!1,typeof n=="function"&&(o.compare=n),o}return e.prototype.compare=function(t,n){return t===n},e.prototype._next=function(t){var n;try{var i=this.keySelector;n=i?i(t):t}catch(a){return this.destination.error(a)}var o=!1;if(this.hasKey)try{var s=this.compare;o=s(this.key,n)}catch(a){return this.destination.error(a)}else this.hasKey=!0;o||(this.key=n,this.destination.next(t))},e}(ra);function O8(r,e){return function(n){return n.lift(new D8(r,e))}}var D8=function(){function r(e,t){this.predicate=e,this.thisArg=t}return r.prototype.call=function(e,t){return t.subscribe(new N8(e,this.predicate,this.thisArg))},r}(),N8=function(r){Ko(e,r);function e(t,n,i){var o=r.call(this,t)||this;return o.predicate=n,o.thisArg=i,o.count=0,o}return e.prototype._next=function(t){var n;try{n=this.predicate.call(this.thisArg,t,this.count++)}catch(i){this.destination.error(i);return}n&&this.destination.next(t)},e}(ra),R8=function(r){return function(e){for(var t=0,n=r.length;t<n&&!e.closed;t++)e.next(r[t]);e.complete()}},k8=function(r){return function(e){return r.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,zf),e}};function I8(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var _T=I8(),_te=null,L8=function(r){return function(e){var t=r[_T]();do{var n=void 0;try{n=t.next()}catch(i){return e.error(i),e}if(n.done){e.complete();break}if(e.next(n.value),e.closed)break}while(!0);return typeof t.return=="function"&&e.add(function(){t.return&&t.return()}),e}},G8=function(r){return function(e){var t=r[E1]();if(typeof t.subscribe!="function")throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)}},F8=function(r){return r&&typeof r.length=="number"&&typeof r!="function"};function B8(r){return!!r&&typeof r.subscribe!="function"&&typeof r.then=="function"}var z8=function(r){if(!!r&&typeof r[E1]=="function")return G8(r);if(F8(r))return R8(r);if(B8(r))return k8(r);if(!!r&&typeof r[_T]=="function")return L8(r);var e=mT(r)?"an invalid object":"'"+r+"'",t="You provided "+e+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";throw new TypeError(t)},U8=function(r){Ko(e,r);function e(t){var n=r.call(this)||this;return n.parent=t,n}return e.prototype._next=function(t){this.parent.notifyNext(t)},e.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(ra),Ate=function(r){Ko(e,r);function e(t,n,i){var o=r.call(this)||this;return o.parent=t,o.outerValue=n,o.outerIndex=i,o}return e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this)},e.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(ra),V8=function(r){Ko(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(ra),Tte=function(r){Ko(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.notifyNext=function(t,n,i,o){this.destination.next(n)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(ra);function j8(r,e){if(!e.closed){if(r instanceof S1)return r.subscribe(e);var t;try{t=z8(r)(e)}catch(n){e.error(n)}return t}}var AT={leading:!0,trailing:!1};function Mte(r,e){return e===void 0&&(e=AT),function(t){return t.lift(new H8(r,!!e.leading,!!e.trailing))}}var H8=null,Pte=function(r){Ko(e,r);function e(t,n,i,o){var s=r.call(this,t)||this;return s.destination=t,s.durationSelector=n,s._leading=i,s._trailing=o,s._hasValue=!1,s}return e.prototype._next=function(t){this._hasValue=!0,this._sendValue=t,this._throttled||(this._leading?this.send():this.throttle(t))},e.prototype.send=function(){var t=this,n=t._hasValue,i=t._sendValue;n&&(this.destination.next(i),this.throttle(i)),this._hasValue=!1,this._sendValue=void 0},e.prototype.throttle=function(t){var n=this.tryDurationSelector(t);n&&this.add(this._throttled=j8(n,new U8(this)))},e.prototype.tryDurationSelector=function(t){try{return this.durationSelector(t)}catch(n){return this.destination.error(n),null}},e.prototype.throttlingDone=function(){var t=this,n=t._throttled,i=t._trailing;n&&n.unsubscribe(),this._throttled=void 0,i&&this.send()},e.prototype.notifyNext=function(){this.throttlingDone()},e.prototype.notifyComplete=function(){this.throttlingDone()},e}(V8);function $8(r,e,t){return e===void 0&&(e=b8),t===void 0&&(t=AT),function(n){return n.lift(new W8(r,e,t.leading,t.trailing))}}var W8=function(){function r(e,t,n,i){this.duration=e,this.scheduler=t,this.leading=n,this.trailing=i}return r.prototype.call=function(e,t){return t.subscribe(new Z8(e,this.duration,this.scheduler,this.leading,this.trailing))},r}(),Z8=function(r){Ko(e,r);function e(t,n,i,o,s){var a=r.call(this,t)||this;return a.duration=n,a.scheduler=i,a.leading=o,a.trailing=s,a._hasTrailingValue=!1,a._trailingValue=null,a}return e.prototype._next=function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(X8,this.duration,{subscriber:this})),this.leading?this.destination.next(t):this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0))},e.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},e.prototype.clearThrottle=function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)},e}(ra);function X8(r){var e=r.subscriber;e.clearThrottle()}function ko(r){for(var e=arguments.length,t=Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];if(!1)var i,o;throw Error("[Immer] minified error nr: "+r+(t.length?" "+t.map(function(s){return"'"+s+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function gc(r){return!!r&&!!r[Or]}function Ml(r){var e;return!!r&&(function(t){if(!t||typeof t!="object")return!1;var n=Object.getPrototypeOf(t);if(n===null)return!0;var i=Object.hasOwnProperty.call(n,"constructor")&&n.constructor;return i===Object||typeof i=="function"&&Function.toString.call(i)===n7}(r)||Array.isArray(r)||!!r[u0]||!!((e=r.constructor)===null||e===void 0?void 0:e[u0])||Oy(r)||Dy(r))}function Ote(r){return gc(r)||ko(23,r),r[Or].t}function mc(r,e,t){t===void 0&&(t=!1),gu(r)===0?(t?Object.keys:Vf)(r).forEach(function(n){t&&typeof n=="symbol"||e(n,r[n],r)}):r.forEach(function(n,i){return e(i,n,r)})}function gu(r){var e=r[Or];return e?e.i>3?e.i-4:e.i:Array.isArray(r)?1:Oy(r)?2:Dy(r)?3:0}function mu(r,e){return gu(r)===2?r.has(e):Object.prototype.hasOwnProperty.call(r,e)}function Py(r,e){return gu(r)===2?r.get(e):r[e]}function TT(r,e,t){var n=gu(r);n===2?r.set(e,t):n===3?(r.delete(e),r.add(t)):r[e]=t}function MT(r,e){return r===e?r!==0||1/r==1/e:r!=r&&e!=e}function Oy(r){return e7&&r instanceof Map}function Dy(r){return t7&&r instanceof Set}function Io(r){return r.o||r.t}function _1(r){if(Array.isArray(r))return Array.prototype.slice.call(r);var e=LT(r);delete e[Or];for(var t=Vf(e),n=0;n<t.length;n++){var i=t[n],o=e[i];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(e[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:r[i]})}return Object.create(Object.getPrototypeOf(r),e)}function A1(r,e){return e===void 0&&(e=!1),T1(r)||gc(r)||!Ml(r)||(gu(r)>1&&(r.set=r.add=r.clear=r.delete=Y8),Object.freeze(r),e&&mc(r,function(t,n){return A1(n,!0)},!0)),r}function Y8(){ko(2)}function T1(r){return r==null||typeof r!="object"||Object.isFrozen(r)}function Pl(r){var e=L1[r];return e||ko(18,r),e}function M1(r,e){L1[r]||(L1[r]=e)}function a0(){return c0}function P1(r,e){e&&(Pl("Patches"),r.u=[],r.s=[],r.v=e)}function Ny(r){O1(r),r.p.forEach(K8),r.p=null}function O1(r){r===c0&&(c0=r.l)}function PT(r){return c0={p:[],l:c0,h:r,m:!0,_:0}}function K8(r){var e=r[Or];e.i===0||e.i===1?e.j():e.O=!0}function D1(r,e){e._=e.p.length;var t=e.p[0],n=r!==void 0&&r!==t;return e.h.g||Pl("ES5").S(e,r,n),n?(t[Or].P&&(Ny(e),ko(4)),Ml(r)&&(r=Ry(e,r),e.l||ky(e,r)),e.u&&Pl("Patches").M(t[Or].t,r,e.u,e.s)):r=Ry(e,t,[]),Ny(e),e.u&&e.v(e.u,e.s),r!==I1?r:void 0}function Ry(r,e,t){if(T1(e))return e;var n=e[Or];if(!n)return mc(e,function(o,s){return OT(r,n,e,o,s,t)},!0),e;if(n.A!==r)return e;if(!n.P)return ky(r,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var i=n.i===4||n.i===5?n.o=_1(n.k):n.o;mc(n.i===3?new Set(i):i,function(o,s){return OT(r,n,i,o,s,t)}),ky(r,i,!1),t&&r.u&&Pl("Patches").R(n,t,r.u,r.s)}return n.o}function OT(r,e,t,n,i,o){if(gc(i)){var s=Ry(r,i,o&&e&&e.i!==3&&!mu(e.D,n)?o.concat(n):void 0);if(TT(t,n,s),!gc(s))return;r.m=!1}if(Ml(i)&&!T1(i)){if(!r.h.F&&r._<1)return;Ry(r,i),e&&e.A.l||ky(r,i)}}function ky(r,e,t){t===void 0&&(t=!1),r.h.F&&r.m&&A1(e,t)}function N1(r,e){var t=r[Or];return(t?Io(t):r)[e]}function DT(r,e){if(e in r)for(var t=Object.getPrototypeOf(r);t;){var n=Object.getOwnPropertyDescriptor(t,e);if(n)return n;t=Object.getPrototypeOf(t)}}function Hs(r){r.P||(r.P=!0,r.l&&Hs(r.l))}function R1(r){r.o||(r.o=_1(r.t))}function l0(r,e,t){var n=Oy(e)?Pl("MapSet").N(e,t):Dy(e)?Pl("MapSet").T(e,t):r.g?function(i,o){var s=Array.isArray(i),a={i:s?1:0,A:o?o.A:a0(),P:!1,I:!1,D:{},l:o,t:i,k:null,o:null,j:null,C:!1},l=a,c=d0;s&&(l=[a],c=h0);var u=Proxy.revocable(l,c),d=u.revoke,h=u.proxy;return a.k=h,a.j=d,h}(e,t):Pl("ES5").J(e,t);return(t?t.A:a0()).p.push(n),n}function q8(r){return gc(r)||ko(22,r),function e(t){if(!Ml(t))return t;var n,i=t[Or],o=gu(t);if(i){if(!i.P&&(i.i<4||!Pl("ES5").K(i)))return i.t;i.I=!0,n=NT(t,o),i.I=!1}else n=NT(t,o);return mc(n,function(s,a){i&&Py(i.t,s)===a||TT(n,s,e(a))}),o===3?new Set(n):n}(r)}function NT(r,e){switch(e){case 2:return new Map(r);case 3:return Array.from(r)}return _1(r)}function J8(){function r(s,a){var l=o[s];return l?l.enumerable=a:o[s]=l={configurable:!0,enumerable:a,get:function(){var c=this[Or];return d0.get(c,s)},set:function(c){var u=this[Or];d0.set(u,s,c)}},l}function e(s){for(var a=s.length-1;a>=0;a--){var l=s[a][Or];if(!l.P)switch(l.i){case 5:n(l)&&Hs(l);break;case 4:t(l)&&Hs(l)}}}function t(s){for(var a=s.t,l=s.k,c=Vf(l),u=c.length-1;u>=0;u--){var d=c[u];if(d!==Or){var h=a[d];if(h===void 0&&!mu(a,d))return!0;var f=l[d],p=f&&f[Or];if(p?p.t!==h:!MT(f,h))return!0}}var g=!!a[Or];return c.length!==Vf(a).length+(g?0:1)}function n(s){var a=s.k;if(a.length!==s.t.length)return!0;var l=Object.getOwnPropertyDescriptor(a,a.length-1);if(l&&!l.get)return!0;for(var c=0;c<a.length;c++)if(!a.hasOwnProperty(c))return!0;return!1}function i(s){s.O&&ko(3,JSON.stringify(Io(s)))}var o={};M1("ES5",{J:function(s,a){var l=Array.isArray(s),c=function(d,h){if(d){for(var f=Array(h.length),p=0;p<h.length;p++)Object.defineProperty(f,""+p,r(p,!0));return f}var g=LT(h);delete g[Or];for(var v=Vf(g),y=0;y<v.length;y++){var x=v[y];g[x]=r(x,d||!!g[x].enumerable)}return Object.create(Object.getPrototypeOf(h),g)}(l,s),u={i:l?5:4,A:a?a.A:a0(),P:!1,I:!1,D:{},l:a,t:s,k:c,o:null,O:!1,C:!1};return Object.defineProperty(c,Or,{value:u,writable:!0}),c},S:function(s,a,l){l?gc(a)&&a[Or].A===s&&e(s.p):(s.u&&function c(u){if(u&&typeof u=="object"){var d=u[Or];if(d){var h=d.t,f=d.k,p=d.D,g=d.i;if(g===4)mc(f,function(T){T!==Or&&(h[T]!==void 0||mu(h,T)?p[T]||c(f[T]):(p[T]=!0,Hs(d)))}),mc(h,function(T){f[T]!==void 0||mu(f,T)||(p[T]=!1,Hs(d))});else if(g===5){if(n(d)&&(Hs(d),p.length=!0),f.length<h.length)for(var v=f.length;v<h.length;v++)p[v]=!1;else for(var y=h.length;y<f.length;y++)p[y]=!0;for(var x=Math.min(f.length,h.length),E=0;E<x;E++)f.hasOwnProperty(E)||(p[E]=!0),p[E]===void 0&&c(f[E])}}}}(s.p[0]),e(s.p))},K:function(s){return s.i===4?t(s):n(s)}})}function Q8(){function r(n){if(!Ml(n))return n;if(Array.isArray(n))return n.map(r);if(Oy(n))return new Map(Array.from(n.entries()).map(function(s){return[s[0],r(s[1])]}));if(Dy(n))return new Set(Array.from(n).map(r));var i=Object.create(Object.getPrototypeOf(n));for(var o in n)i[o]=r(n[o]);return mu(n,u0)&&(i[u0]=n[u0]),i}function e(n){return gc(n)?r(n):n}var t="add";M1("Patches",{$:function(n,i){return i.forEach(function(o){for(var s=o.path,a=o.op,l=n,c=0;c<s.length-1;c++){var u=gu(l),d=""+s[c];u!==0&&u!==1||d!=="__proto__"&&d!=="constructor"||ko(24),typeof l=="function"&&d==="prototype"&&ko(24),typeof(l=Py(l,d))!="object"&&ko(15,s.join("/"))}var h=gu(l),f=r(o.value),p=s[s.length-1];switch(a){case"replace":switch(h){case 2:return l.set(p,f);case 3:ko(16);default:return l[p]=f}case t:switch(h){case 1:return p==="-"?l.push(f):l.splice(p,0,f);case 2:return l.set(p,f);case 3:return l.add(f);default:return l[p]=f}case"remove":switch(h){case 1:return l.splice(p,1);case 2:return l.delete(p);case 3:return l.delete(o.value);default:return delete l[p]}default:ko(17,a)}}),n},R:function(n,i,o,s){switch(n.i){case 0:case 4:case 2:return function(a,l,c,u){var d=a.t,h=a.o;mc(a.D,function(f,p){var g=Py(d,f),v=Py(h,f),y=p?mu(d,f)?"replace":t:"remove";if(g!==v||y!=="replace"){var x=l.concat(f);c.push(y==="remove"?{op:y,path:x}:{op:y,path:x,value:v}),u.push(y===t?{op:"remove",path:x}:y==="remove"?{op:t,path:x,value:e(g)}:{op:"replace",path:x,value:e(g)})}})}(n,i,o,s);case 5:case 1:return function(a,l,c,u){var d=a.t,h=a.D,f=a.o;if(f.length<d.length){var p=[f,d];d=p[0],f=p[1];var g=[u,c];c=g[0],u=g[1]}for(var v=0;v<d.length;v++)if(h[v]&&f[v]!==d[v]){var y=l.concat([v]);c.push({op:"replace",path:y,value:e(f[v])}),u.push({op:"replace",path:y,value:e(d[v])})}for(var x=d.length;x<f.length;x++){var E=l.concat([x]);c.push({op:t,path:E,value:e(f[x])})}d.length<f.length&&u.push({op:"replace",path:l.concat(["length"]),value:d.length})}(n,i,o,s);case 3:return function(a,l,c,u){var d=a.t,h=a.o,f=0;d.forEach(function(p){if(!h.has(p)){var g=l.concat([f]);c.push({op:"remove",path:g,value:p}),u.unshift({op:t,path:g,value:p})}f++}),f=0,h.forEach(function(p){if(!d.has(p)){var g=l.concat([f]);c.push({op:t,path:g,value:p}),u.unshift({op:"remove",path:g,value:p})}f++})}(n,i,o,s)}},M:function(n,i,o,s){o.push({op:"replace",path:[],value:i===I1?void 0:i}),s.push({op:"replace",path:[],value:n})}})}function RT(){function r(a,l){function c(){this.constructor=a}i(a,l),a.prototype=(c.prototype=l.prototype,new c)}function e(a){a.o||(a.D=new Map,a.o=new Map(a.t))}function t(a){a.o||(a.o=new Set,a.t.forEach(function(l){if(Ml(l)){var c=l0(a.A.h,l,a);a.p.set(l,c),a.o.add(c)}else a.o.add(l)}))}function n(a){a.O&&ko(3,JSON.stringify(Io(a)))}var i=function(a,l){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,u){c.__proto__=u}||function(c,u){for(var d in u)u.hasOwnProperty(d)&&(c[d]=u[d])})(a,l)},o=function(){function a(c,u){return this[Or]={i:2,l:u,A:u?u.A:a0(),P:!1,I:!1,o:void 0,D:void 0,t:c,k:this,C:!1,O:!1},this}r(a,Map);var l=a.prototype;return Object.defineProperty(l,"size",{get:function(){return Io(this[Or]).size}}),l.has=function(c){return Io(this[Or]).has(c)},l.set=function(c,u){var d=this[Or];return n(d),Io(d).has(c)&&Io(d).get(c)===u||(e(d),Hs(d),d.D.set(c,!0),d.o.set(c,u),d.D.set(c,!0)),this},l.delete=function(c){if(!this.has(c))return!1;var u=this[Or];return n(u),e(u),Hs(u),u.t.has(c)?u.D.set(c,!1):u.D.delete(c),u.o.delete(c),!0},l.clear=function(){var c=this[Or];n(c),Io(c).size&&(e(c),Hs(c),c.D=new Map,mc(c.t,function(u){c.D.set(u,!1)}),c.o.clear())},l.forEach=function(c,u){var d=this;Io(this[Or]).forEach(function(h,f){c.call(u,d.get(f),f,d)})},l.get=function(c){var u=this[Or];n(u);var d=Io(u).get(c);if(u.I||!Ml(d)||d!==u.t.get(c))return d;var h=l0(u.A.h,d,u);return e(u),u.o.set(c,h),h},l.keys=function(){return Io(this[Or]).keys()},l.values=function(){var c,u=this,d=this.keys();return(c={})[Iy]=function(){return u.values()},c.next=function(){var h=d.next();return h.done?h:{done:!1,value:u.get(h.value)}},c},l.entries=function(){var c,u=this,d=this.keys();return(c={})[Iy]=function(){return u.entries()},c.next=function(){var h=d.next();if(h.done)return h;var f=u.get(h.value);return{done:!1,value:[h.value,f]}},c},l[Iy]=function(){return this.entries()},a}(),s=function(){function a(c,u){return this[Or]={i:3,l:u,A:u?u.A:a0(),P:!1,I:!1,o:void 0,t:c,k:this,p:new Map,O:!1,C:!1},this}r(a,Set);var l=a.prototype;return Object.defineProperty(l,"size",{get:function(){return Io(this[Or]).size}}),l.has=function(c){var u=this[Or];return n(u),u.o?!!u.o.has(c)||!(!u.p.has(c)||!u.o.has(u.p.get(c))):u.t.has(c)},l.add=function(c){var u=this[Or];return n(u),this.has(c)||(t(u),Hs(u),u.o.add(c)),this},l.delete=function(c){if(!this.has(c))return!1;var u=this[Or];return n(u),t(u),Hs(u),u.o.delete(c)||!!u.p.has(c)&&u.o.delete(u.p.get(c))},l.clear=function(){var c=this[Or];n(c),Io(c).size&&(t(c),Hs(c),c.o.clear())},l.values=function(){var c=this[Or];return n(c),t(c),c.o.values()},l.entries=function(){var c=this[Or];return n(c),t(c),c.o.entries()},l.keys=function(){return this.values()},l[Iy]=function(){return this.values()},l.forEach=function(c,u){for(var d=this.values(),h=d.next();!h.done;)c.call(u,h.value,h.value,this),h=d.next()},a}();M1("MapSet",{N:function(a,l){return new o(a,l)},T:function(a,l){return new s(a,l)}})}function Dte(){J8(),RT(),Q8()}function Nte(r){return r}function Rte(r){return r}var kT,c0,k1=typeof Symbol!="undefined"&&typeof Symbol("x")=="symbol",e7=typeof Map!="undefined",t7=typeof Set!="undefined",IT=typeof Proxy!="undefined"&&Proxy.revocable!==void 0&&typeof Reflect!="undefined",I1=k1?Symbol.for("immer-nothing"):((kT={})["immer-nothing"]=!0,kT),u0=k1?Symbol.for("immer-draftable"):"__$immer_draftable",Or=k1?Symbol.for("immer-state"):"__$immer_state",Iy=typeof Symbol!="undefined"&&Symbol.iterator||"@@iterator",kte={0:"Illegal state",1:"Immer drafts cannot have computed properties",2:"This object has been frozen and should not be mutated",3:function(r){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+r},4:"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.",5:"Immer forbids circular references",6:"The first or second argument to `produce` must be a function",7:"The third argument to `produce` must be a function or undefined",8:"First argument to `createDraft` must be a plain object, an array, or an immerable object",9:"First argument to `finishDraft` must be a draft returned by `createDraft`",10:"The given draft is already finalized",11:"Object.defineProperty() cannot be used on an Immer draft",12:"Object.setPrototypeOf() cannot be used on an Immer draft",13:"Immer only supports deleting array indices",14:"Immer only supports setting array indices and the 'length' property",15:function(r){return"Cannot apply patch, path doesn't resolve: "+r},16:'Sets cannot have "replace" patches.',17:function(r){return"Unsupported patch operation: "+r},18:function(r){return"The plugin for '"+r+"' has not been loaded into Immer. To enable the plugin, import and call `enable"+r+"()` when initializing your application."},20:"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available",21:function(r){return"produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '"+r+"'"},22:function(r){return"'current' expects a draft, got: "+r},23:function(r){return"'original' expects a draft, got: "+r},24:"Patching reserved attributes like __proto__, prototype and constructor is not allowed"},n7=""+Object.prototype.constructor,Vf=typeof Reflect!="undefined"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:Object.getOwnPropertyNames,LT=Object.getOwnPropertyDescriptors||function(r){var e={};return Vf(r).forEach(function(t){e[t]=Object.getOwnPropertyDescriptor(r,t)}),e},L1={},d0={get:function(r,e){if(e===Or)return r;var t=Io(r);if(!mu(t,e))return function(i,o,s){var a,l=DT(o,s);return l?"value"in l?l.value:(a=l.get)===null||a===void 0?void 0:a.call(i.k):void 0}(r,t,e);var n=t[e];return r.I||!Ml(n)?n:n===N1(r.t,e)?(R1(r),r.o[e]=l0(r.A.h,n,r)):n},has:function(r,e){return e in Io(r)},ownKeys:function(r){return Reflect.ownKeys(Io(r))},set:function(r,e,t){var n=DT(Io(r),e);if(n==null?void 0:n.set)return n.set.call(r.k,t),!0;if(!r.P){var i=N1(Io(r),e),o=i==null?void 0:i[Or];if(o&&o.t===t)return r.o[e]=t,r.D[e]=!1,!0;if(MT(t,i)&&(t!==void 0||mu(r.t,e)))return!0;R1(r),Hs(r)}return r.o[e]===t&&typeof t!="number"&&(t!==void 0||e in r.o)||(r.o[e]=t,r.D[e]=!0,!0)},deleteProperty:function(r,e){return N1(r.t,e)!==void 0||e in r.t?(r.D[e]=!1,R1(r),Hs(r)):delete r.D[e],r.o&&delete r.o[e],!0},getOwnPropertyDescriptor:function(r,e){var t=Io(r),n=Reflect.getOwnPropertyDescriptor(t,e);return n&&{writable:!0,configurable:r.i!==1||e!=="length",enumerable:n.enumerable,value:t[e]}},defineProperty:function(){ko(11)},getPrototypeOf:function(r){return Object.getPrototypeOf(r.t)},setPrototypeOf:function(){ko(12)}},h0={};mc(d0,function(r,e){h0[r]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),h0.deleteProperty=function(r,e){return h0.set.call(this,r,e,void 0)},h0.set=function(r,e,t){return d0.set.call(this,r[0],e,t,r[0])};var r7=function(){function r(t){var n=this;this.g=IT,this.F=!0,this.produce=function(i,o,s){if(typeof i=="function"&&typeof o!="function"){var a=o;o=i;var l=n;return function(g){var v=this;g===void 0&&(g=a);for(var y=arguments.length,x=Array(y>1?y-1:0),E=1;E<y;E++)x[E-1]=arguments[E];return l.produce(g,function(T){var P;return(P=o).call.apply(P,[v,T].concat(x))})}}var c;if(typeof o!="function"&&ko(6),s!==void 0&&typeof s!="function"&&ko(7),Ml(i)){var u=PT(n),d=l0(n,i,void 0),h=!0;try{c=o(d),h=!1}finally{h?Ny(u):O1(u)}return typeof Promise!="undefined"&&c instanceof Promise?c.then(function(g){return P1(u,s),D1(g,u)},function(g){throw Ny(u),g}):(P1(u,s),D1(c,u))}if(!i||typeof i!="object"){if((c=o(i))===void 0&&(c=i),c===I1&&(c=void 0),n.F&&A1(c,!0),s){var f=[],p=[];Pl("Patches").M(i,c,f,p),s(f,p)}return c}ko(21,i)},this.produceWithPatches=function(i,o){if(typeof i=="function")return function(c){for(var u=arguments.length,d=Array(u>1?u-1:0),h=1;h<u;h++)d[h-1]=arguments[h];return n.produceWithPatches(c,function(f){return i.apply(void 0,[f].concat(d))})};var s,a,l=n.produce(i,o,function(c,u){s=c,a=u});return typeof Promise!="undefined"&&l instanceof Promise?l.then(function(c){return[c,s,a]}):[l,s,a]},typeof(t==null?void 0:t.useProxies)=="boolean"&&this.setUseProxies(t.useProxies),typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze)}var e=r.prototype;return e.createDraft=function(t){Ml(t)||ko(8),gc(t)&&(t=q8(t));var n=PT(this),i=l0(this,t,void 0);return i[Or].C=!0,O1(n),i},e.finishDraft=function(t,n){var i=t&&t[Or],o=i.A;return P1(o,n),D1(void 0,o)},e.setAutoFreeze=function(t){this.F=t},e.setUseProxies=function(t){t&&!IT&&ko(20),this.g=t},e.applyPatches=function(t,n){var i;for(i=n.length-1;i>=0;i--){var o=n[i];if(o.path.length===0&&o.op==="replace"){t=o.value;break}}i>-1&&(n=n.slice(i+1));var s=Pl("Patches").$;return gc(t)?s(t,n):this.produce(t,function(a){return s(a,n)})},r}(),ia=new r7,i7=ia.produce,Ite=ia.produceWithPatches.bind(ia),o7=ia.setAutoFreeze.bind(ia),Lte=ia.setUseProxies.bind(ia),Gte=ia.applyPatches.bind(ia),s7=ia.createDraft.bind(ia),a7=ia.finishDraft.bind(ia),Fte=null;RT(),o7(!1);var Ba;(function(r){r.EMPTY_VALUE=Symbol("EMPTY_MODEL_VALUE");function e(n){return n!==r.EMPTY_VALUE}r.isValidValue=e;function t(n){return n.pipe(T8(),O8(i=>e(i)),$8(17,bT,{leading:!1,trailing:!0}))}r.defaultPipeFunction=t})(Ba||(Ba={}));class Vd{constructor(e=Ba.EMPTY_VALUE,t=30){this.toDispose=new $r,this.watch=(n,i=Ba.defaultPipeFunction)=>{this.subject$.observers.length+1>this.maxSubscription&&console.warn(`${this.subject$} reach maxSubscription limitation, please check`);const s=(i?i(this.subject$):this.subject$).subscribe(n);return wn.create(()=>{s.unsubscribe()})},this.getValue=()=>this.subject$.getValue(),this.setValue=n=>{if(!!this.subject$){if(typeof n=="function"){const i=this.subject$.getValue(),o=i7(i,s=>{n(s)});Ba.isValidValue(o)&&this.setValue(o);return}this.subject$.next(n)}},this.hasValidValue=()=>{const n=this.getValue();return Ba.isValidValue(n)},this.getValidValue=()=>(0,S.mG)(this,void 0,void 0,function*(){const n=new ta;if(this.hasValidValue())return this.getValue();const i=this.watch(o=>{Ba.isValidValue(o)&&(n.resolve(o),i.dispose())});return n.promise}),this.dispose=()=>{this.toDispose.dispose()},this.subject$=new A8(e||Ba.EMPTY_VALUE),this.maxSubscription=t,this.toDispose.push(wn.create(()=>{this.subject$.complete(),this.subject$.unsubscribe(),this.subject$=null}))}}const vu=L.defineToken("IFrontendApplicationContribution"),jd=Symbol("IGraphCommandService"),Sr=L.defineToken("ICommandHandler"),Dr=Symbol("ICommandContextProvider"),G1=Symbol("IGraphCommandFactory"),Ly=L.defineToken("IGraphCommandContribution");var F1;(function(r){function e(i){return!!i&&i===Object(i)&&"id"in i}r.is=e;function t(i,o){if(i.label&&o.label){const s=(i.category?`${i.category}: ${i.label}`:i.label).toLowerCase(),a=(o.category?`${o.category}: ${o.label}`:o.label).toLowerCase();return s.localeCompare(a)}else return 0}r.compareCommands=t;function n(i,o){return i.id===o.id&&i.label===o.label&&i.iconName===o.iconName&&i.category===o.category}r.equals=n})(F1||(F1={}));let B1=class{constructor(e){this.contributionProvider=e,this.redoStack=[],this.undoStack=[],this.commands=new Map,this.factories=new Map,this.disposables=new Map,this.cmdChangeEvent=new Vd(null),this.Globals=new Vd(new Map),this.setGlobal=(t,n)=>{this.Globals.setValue(i=>{i.set(t,n)})},this.getGlobal=t=>this.Globals.getValue().get(t),this.undoCommand=()=>(0,S.mG)(this,void 0,void 0,function*(){const t=this.undoStack.pop();if(!t){console.error("empty undo stack");return}yield t.undo(),this.redoStack.push(t),this.cmdChangeEvent.setValue(null)}),this.redoCommand=()=>(0,S.mG)(this,void 0,void 0,function*(){const t=this.redoStack.pop();if(!t){console.error("empty undo stack");return}yield t.redo(),this.undoStack.push(t),this.cmdChangeEvent.setValue(null)}),this.registerDisposableCommand=t=>{const n=new $r;return t({registerCommand:(o,s)=>{const a=this.registerCommand(o,s);return n.push(a),a}}),n}}get watchChange(){return this.cmdChangeEvent.watch}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerGraphCommands(this)}executeCommandPipeline(e){return(0,S.mG)(this,void 0,void 0,function*(){let t=null;for(const n of e){const i=t==null?void 0:t.contextProvider(),{args:o,hooks:s}=yield n==null?void 0:n.getCommandOption(i);t=yield this.executeCommand(n==null?void 0:n.commandId,o,s)}return this.cmdChangeEvent.setValue(null),t})}executeCommand(e,t,n=[]){return(0,S.mG)(this,void 0,void 0,function*(){const i=this.getFactory(e);if(i){const o=yield i.createCommand(e,t,n);return yield o.execute(),o.isUndoable()&&this.undoStack.push(o),this.cmdChangeEvent.setValue(null),o}throw Object.assign(new Error(`The command '${e}' cannot be executed. There are no active handlers available for the command.`),{code:"NO_ACTIVE_HANDLER"})})}executeUndoCommand(e,t,n=[]){return(0,S.mG)(this,void 0,void 0,function*(){const i=this.getFactory(e);if(i){const o=yield i.createCommand(e,t,n);return yield o.execute(),o}throw Object.assign(new Error(`The command '${e}' cannot be executed. There are no active handlers available for the command.`),{code:"NO_ACTIVE_HANDLER"})})}createCommand(e,t,n=[]){return(0,S.mG)(this,void 0,void 0,function*(){const i=this.getFactory(e);if(i)return yield i.createCommand(e,t,n);throw Object.assign(new Error(`The command '${e}' cannot be executed. There are no active handlers available for the command.`),{code:"NO_ACTIVE_HANDLER"})})}get isUndoable(){return this.undoStack.length>0}get isRedoable(){return this.redoStack.length>0}hasCommand(e){return this.commands.has(e)}getCommand(e){return this.commands.get(e)}registerCommand(e,t){if(this.factories.has(e.id))return console.warn(`A command ${e.id} is already registered.`),wn.NULL;const n=new $r(this.doRegisterCommand(e),this.registerFactory(e.id,t),wn.create(()=>this.disposables.delete(e.id)));return this.disposables.set(e.id,n),n}doRegisterCommand(e){return this.commands.set(e.id,e),wn.create(()=>this.disposables.delete(e.id))}unregisterCommand(e){const t=F1.is(e)?e.id:e,n=this.disposables.get(t);n&&n.dispose()}hasFactory(e){return!!this.factories.get(e)}getFactory(e){return this.factories.get(e)}registerFactory(e,t,n=!1){return this.hasFactory(e)&&n===!1&&console.error("cannot register command:",e),this.factories.set(e,t),wn.create(()=>{this.factories.delete(e)})}getAllFactories(){return Array.from(this.factories.entries())}};B1=(0,S.gn)([Yt({contrib:[vu,jd]}),(0,S.fM)(0,wr(Ly)),(0,S.w6)("design:paramtypes",[Object])],B1);const l7=Nr(r=>{Mi.register(r,Ly),r(B1)}),Hd=L.defineToken("IModelService"),$d=L.defineToken("IModelContribution"),GT=Symbol("IModelOptionProvider");var f0;(function(r){r.ASYNC_SRRIES="ASYNC_SRRIES",r.ASYNC_PARALLEL="ASYNC_PARALLEL"})(f0||(f0={}));var c7=w(94633),u7=w.n(c7),jf;(function(r){let e;(function(i){i.INVALID_HOOK_BEFORE="INVALID_HOOK_BEFORE",i.INVALID_HOOK_AFTER="INVALID_HOOK_AFTER",i.INVALID_HOOK_ARGS_LENGTH="INVALID_HOOK_ARGS_LENGTH"})(e=r.ErrorEnum||(r.ErrorEnum={}));class t extends Error{constructor(o,s,...a){Array.isArray(s)&&(s=s.filter(function(l){return!!l}).join(" ")),super(`${o}: ${s}`),Error.captureStackTrace&&Error.captureStackTrace(this,t),this.code=o,this.contexts={},a.forEach(l=>{typeof l=="object"&&Object.entries(l).forEach(c=>{const[u,d]=c;u!=="key"&&d&&(this.contexts[u]=JSON.parse(JSON.stringify(d)))})})}toString(){return`${this.code}: ${this.message}`}}r.HookError=t;const n=(i,o,...s)=>new t(i,o,...s);r.HookBeforeError=()=>n(e.INVALID_HOOK_BEFORE,["hook require a before dependency but not exist in hookmap"]),r.HookAfterError=()=>n(e.INVALID_HOOK_AFTER,["hook require a after dependency but not exist in hookmap"]),r.InvalidHookArguments=i=>n(e.INVALID_HOOK_ARGS_LENGTH,["hook handlers must have 0 to 2 arguments",`but got ${i.handler.length}`])})(jf||(jf={}));var Gy;(function(r){r.normalize=(e=[],t)=>{const n=Array.isArray(e)?e:[e],i=[];return t.forEach(o=>{i.push(o)}),[...i,...n].filter(o=>o&&!!o.handler)},r.sort=(e=[],t)=>{const n=[];return e.forEach(o=>{if(o.before){if(!t.has(o.before))throw jf.HookBeforeError();const s=[o,t.get(o.before)];n.push(s)}if(o.after){if(!t.has(o.after))throw jf.HookBeforeError();const s=[t.get(o.after),o];n.push(s)}}),u7().array(e,n)}})(Gy||(Gy={}));class d7{constructor(){this.isResolved=!1,this.isRejected=!1,this.promise=new Promise((e,t)=>{this.resolve=n=>{this.isResolved=!0,e(n)},this.reject=n=>{this.isRejected=!0,t(n)}})}}class za{constructor(e){this.scheduleType=f0.ASYNC_SRRIES,this.hasHook=t=>this.hookMap.has(t),this.getHooks=(t=[],n=!0)=>{const i=Gy.normalize(t,this.hookMap);return n?Gy.sort(i,this.hookMap):i},this.registerHook=t=>(this.hookMap.has(t.name)&&console.error(`${t.name} is duplicated in hookmap`),this.hookMap.set(t.name,t),{dispose:()=>{this.hookMap.delete(t.name)}}),this.call=(t,n=o=>(0,S.mG)(this,void 0,void 0,function*(){return o}),i=[])=>(0,S.mG)(this,void 0,void 0,function*(){const o=this.getHooks(i,!0);return this.schedulers[this.scheduleType](t,n,o)}),this.schedulers={[f0.ASYNC_SRRIES]:(t,n,i=[])=>(0,S.mG)(this,void 0,void 0,function*(){let o=n;for(const s of i){if([0,1].includes(s.handler.length)){yield s.handler.call(this,t);continue}if([2].includes(s.handler.length)&&o!==null){const l=yield s.handler.call(this,t,o);if(l===null){o=null;break}else if(typeof l=="function"){o=l;continue}}throw jf.InvalidHookArguments(s)}if(o)return yield o.call(this,t)}),[f0.ASYNC_PARALLEL]:(t,n,i=[])=>(0,S.mG)(this,void 0,void 0,function*(){const o=i.map(a=>{if([0,1].includes(a.handler.length))return a.handler.call(this,t);if([2].includes(a.handler.length))return a.handler.call(this,t,n);throw jf.InvalidHookArguments(a)}),s=new d7;if(Promise.all(o).then(a=>s.resolve(a)),n)return yield n.call(this,s)})},this.hookMap=new Map,e&&e.type&&(this.scheduleType=e.type)}}const z1=L.defineToken("IHookService"),wa=L.defineToken("IHookContribution"),h7=()=>({graphOptions:new za,reactNodeRender:new za,reactEdgeLabelRender:new za,afterGraphInit:new za,beforeGraphDestroy:new za,x6Events:new za}),FT=()=>({dispose:()=>{}});var U1;(function(r){r.CONFIG_TYPE="XFlowHook"})(U1||(U1={}));class Fy{constructor(){this.CONFIG_TYPE=U1.CONFIG_TYPE,this.time=Date.now(),this.setRegisterHook=e=>{this.hookRegisterFunc=e},this.setRegisterHookhub=e=>{this.hookhubRegisterFn=e},this.getConfig=()=>(0,S.mG)(this,void 0,void 0,function*(){return{CONFIG_TYPE:this.CONFIG_TYPE,hookRegisterFn:this.hookRegisterFunc||FT,hookhubRegisterFn:this.hookhubRegisterFn||FT}}),this.dispose=()=>{}}}let By=class{constructor(){this.toDispose=new $r,this.hookProvider=()=>this.hooks,this.registerHook=e=>e(this.hooks),this.registerHookHub=(e,t)=>(this.hooks[e]=t,{dispose:()=>{delete this.hooks[e]}}),this.onStart=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerHookHub(this);for(const t of e)t.registerHook(this.hooks)}),this.hooks=h7()}onStop(){this.toDispose.dispose()}};(0,S.gn)([wr(wa),(0,S.w6)("design:type",Object)],By.prototype,"contributionProvider",void 0),By=(0,S.gn)([Yt({contrib:[vu,z1]}),(0,S.w6)("design:paramtypes",[])],By);var BT;(function(r){r.pluginId="GraphEventPlugin"})(BT||(BT={}));let zy=class{constructor(){this.toDispose=new $r,this.registerHook=e=>(0,S.mG)(this,void 0,void 0,function*(){const{hookRegisterFn:t}=yield this.hookConfig.getConfig(),n=t(e);return wn.create(()=>{n.dispose()})}),this.registerHookHub=e=>(0,S.mG)(this,void 0,void 0,function*(){const{hookhubRegisterFn:t}=yield this.hookConfig.getConfig(),n=t(e);return wn.create(()=>{n.dispose()})})}};(0,S.gn)([St(Fy),(0,S.w6)("design:type",Fy)],zy.prototype,"hookConfig",void 0),zy=(0,S.gn)([Yt({contrib:wa})],zy);const zT={dispose:()=>null};function zte(r,e){let t;return()=>{clearTimeout(t),t=window.setTimeout(r,e)}}function f7(r){let e;return()=>{e||(e=requestAnimationFrame(()=>{e=null,r()}))}}const Ute=r=>{const e=document.createElement("style");return e.setAttribute("type","text/css"),document.head.appendChild(e),e.styleSheet?e.styleSheet.cssText=r:e.appendChild(document.createTextNode(r)),e};function p7(r){return typeof r=="function"&&!!r.prototype.isReactComponent}function g7(r){return typeof r=="function"&&String(r).includes("return React.createElement")}function Vte(r){return p7(r)||g7(r)}var p0;(function(r){r.pluginId="base-graph-events"})(p0||(p0={}));let Uy=class{constructor(){this.toDispose=new $r,this.registerHookHub=()=>(0,S.mG)(this,void 0,void 0,function*(){return wn.create(()=>{})}),this.registerHook=e=>(0,S.mG)(this,void 0,void 0,function*(){const t=new $r,n=[e.x6Events.registerHook({name:p0.pluginId,handler:i=>(0,S.mG)(this,void 0,void 0,function*(){const{events:o}=yield this.graphOptions.getOptions();o.forEach(s=>{i.push(s)})})}),e.afterGraphInit.registerHook({name:p0.pluginId,handler:i=>(0,S.mG)(this,void 0,void 0,function*(){const{commandService:o,modelService:s,graph:a}=i,l=yield e.x6Events.call([],c=>(0,S.mG)(this,void 0,void 0,function*(){return c.map(u=>{const d=h=>{u.callback(h,o,s,a)};return a.on(u.eventName,d),{dispose:()=>{a.off(u.eventName,d)}}})}));t.pushAll(l)})}),e.afterGraphInit.registerHook({name:"add auto resize event",handler:i=>(0,S.mG)(this,void 0,void 0,function*(){const{commandService:o,options:s,graph:a}=i,l=f7(()=>{o.executeCommand(Zn.GRAPH_RESIZE.id,{})});window.addEventListener("resize",l);const{rootContainer:c}=s,u=new ResizeObserver(()=>a.resize(c.clientWidth));c&&u.observe(c),t.push(wn.create(()=>{window.removeEventListener("resize",l)}))})}),e.beforeGraphDestroy.registerHook({name:p0.pluginId,handler:()=>(0,S.mG)(this,void 0,void 0,function*(){t.dispose()})})];return t.pushAll(n),t})}};(0,S.gn)([St(s0),(0,S.w6)("design:type",Object)],Uy.prototype,"graphOptions",void 0),Uy=(0,S.gn)([Yt({contrib:wa})],Uy);const m7=r=>Nr(e=>{Mi.register(e,wa),e(zy),e(Uy),e(By),e(Fy,{useValue:r})});var Ua=w(96486);class v7{constructor(){this.extensions=[],this.containerClassNames=new Set,this.addCoreModule=e=>(this.extensions.unshift(e),wn.create(()=>{this.removeExtension(e)})),this.addExtension=e=>(this.extensions.push(e),wn.create(()=>{this.removeExtension(e)})),this.getExtension=e=>(0,Ua.find)(this.extensions,t=>(0,Ua.get)(t,"config.CONFIG_TYPE")===e),this.removeExtension=e=>{const t=this.extensions.indexOf(e);t>-1&&this.extensions.splice(t,1)},this.getInstanceId=()=>this.instanceId,this.addContainerClassNames=e=>this.containerClassNames.add(e),this.getContainerClassNames=()=>Array.from(this.containerClassNames),this.getAllExtensions=()=>this.extensions,this.getAllExtensionConfigs=()=>this.extensions.map(e=>e.config),this.instanceId=na()}has(e){return this.extensions.some(t=>t.config.CONFIG_TYPE===e)}}const y7=()=>b.useMemo(()=>new v7,[]),UT=b.createContext({}),vc=()=>b.useContext(UT),b7=r=>{const e=vc(),t=b.useMemo(()=>r.config?r.config:new Fy,[]);return b.useEffect(()=>{const n=e.addCoreModule({config:t,createModule:m7});return()=>{n.dispose(),t.dispose()}},[e,t]),null},jte=r=>e=>{const t=React.useMemo(()=>({getValue:()=>({})}),[]);return t.getValue=()=>e,React.useMemo(()=>{const i=new HookConfig;return r(i,t),i},[t])},V1=b.createContext({cell:null,x6Graph:null,commands:null,modelService:null}),x7=()=>React.useContext(V1);function VT(r,e,t){return function(n){const i=this,o=n==null?void 0:n.getData(),s=n==null?void 0:n.getSize(),a=n==null?void 0:n.getPosition(),l=()=>b.createElement(V1.Provider,{value:{cell:n,x6Graph:i,commands:e,modelService:t}},b.createElement(r,{cell:n,data:o,size:s,position:a}));return b.createElement(l,null)}}function C7(r,e,t){return function(n){const i=this,o=n==null?void 0:n.getData(),s=()=>b.createElement(V1.Provider,{value:{cell:n,x6Graph:i,commands:e,modelService:t}},b.createElement(r,{data:o,cell:n}));return b.createElement(s,null)}}const Hte=()=>{const[r,e]=React.useState(!1),{x6Graph:t,cell:n}=x7();return React.useEffect(()=>{const i=({added:o,removed:s})=>{if(o.filter(c=>c.isNode()).some(c=>{c.id,n.id})){n.setData(Object.assign(Object.assign({},n.getData()),{isNodeSelected:!0})),e(!0);return}if(s.filter(c=>c.isNode()).some(c=>{c.id,n.id})){n.setData(Object.assign(Object.assign({},n.getData()),{isNodeSelected:!1})),e(!1);return}};return t.on("selection:changed",i),()=>{t.off("selection:changed",i)}},[t]),[r]},Wd=Symbol("IGraphProvider"),jT=Symbol("ICommandServiceProvider"),HT=Symbol("IModelServiceProvider");let yu=class{constructor(){this.toDispose=new $r,this.graphMap=new Map,this.getGraph=e=>(0,S.mG)(this,void 0,void 0,function*(){let t=this.graphMap.get(e);if(!t){t=new ta,this.graphMap.set(e,t);const n=yield this.optionProvider.getOptions(),i=this.hookService.hookProvider(),o=yield i.graphOptions.call(n.x6Options),{graphContainer:s,edgeRender:a,nodeRender:l,edgeTypeParser:c}=n,u=yield i.reactEdgeLabelRender.call(a);yield i.reactNodeRender.call(l);const{clientHeight:d,clientWidth:h}=s,f=yield this.commandServiceProvider.getCommandService(),p=yield this.modelServiceProvider.getModelService(),g=new kr(Object.assign(Object.assign({container:s,width:h,height:d},o),{onEdgeLabelRendered:v=>{const{edge:y,container:x}=v;this.renderEdgeReactLabel({edge:y,container:x,edgeRenderMap:u,edgeTypeParser:c,modelService:p,commandService:f})}}));yield i.afterGraphInit.call({graph:g,commandService:f,modelService:p,options:n}),t.resolve(g),g.on("node:moved",({node:v})=>{const y=v.getData(),x=v.position();v.setData(Object.assign(Object.assign({},y),{x:x==null?void 0:x.x,y:x==null?void 0:x.y}))}),g.on("node:resized",({node:v})=>{const y=v.getData(),x=v.size();v.setData(Object.assign(Object.assign({},y),{width:x==null?void 0:x.width,height:x==null?void 0:x.height}))}),this.toDispose.push(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){yield i.beforeGraphDestroy.call({graph:g,commandService:f,modelService:p,options:n}),this.graphMap.delete(e),g.dispose()})))}return t.promise}),this.renderEdgeReactLabel=e=>(0,S.mG)(this,void 0,void 0,function*(){const{container:t,edgeTypeParser:n,edge:i,edgeRenderMap:o,commandService:s,modelService:a}=e,l=n(i==null?void 0:i.data)||iT,c=o.get(l);if(!!c&&i&&(i==null?void 0:i.data)&&c){const u=this.edgeAppendForeignObject(i,t),d=C7(c,s,a)(i);pu.render(d,u)}})}edgeAppendForeignObject(e,t){const n=Es("foreignObject"),i=Ng("body",qi.xhtml),o=Ng("div",qi.xhtml),s=e==null?void 0:e.data,a=(s==null?void 0:s.edgeContentWidth)||100,l=(s==null?void 0:s.edgeContentHeight)||30;return n.setAttribute("width",`${a}`),n.setAttribute("height",`${l}`),n.setAttribute("x",`${-1*a/2}`),n.setAttribute("y",`${-1*l/2}`),i.setAttribute("xhtmls",qi.xhtml),i.style.width="100%",i.style.height="100%",i.style.padding="0",i.style.margin="0",i.style.background="unset",i.style.overflow="visible",i.className="xflow-edge-label-body",o.style.width="100%",o.style.height="100%",i.appendChild(o),n.appendChild(i),t.appendChild(n),o}dispose(){this.toDispose.dispose()}};(0,S.gn)([St(s0),(0,S.w6)("design:type",Object)],yu.prototype,"optionProvider",void 0),(0,S.gn)([St(z1),(0,S.w6)("design:type",Object)],yu.prototype,"hookService",void 0),(0,S.gn)([St(jT),(0,S.w6)("design:type",Object)],yu.prototype,"commandServiceProvider",void 0),(0,S.gn)([St(HT),(0,S.w6)("design:type",Object)],yu.prototype,"modelServiceProvider",void 0),yu=(0,S.gn)([Yt()],yu);const w7=r=>{r(yu),r(Wd,{lifecycle:L.Lifecycle.singleton,useDynamic:e=>({getGraphInstance:()=>(0,S.mG)(void 0,void 0,void 0,function*(){const t=e.container.get(yu),n=e.container.get(s0),i=yield n==null?void 0:n.getOptions();return yield t==null?void 0:t.getGraph(i.graphId)}),getGraphOptions:()=>(0,S.mG)(void 0,void 0,void 0,function*(){const t=e.container.get(s0);return t==null?void 0:t.getOptions()})})}),r(jT,{lifecycle:L.Lifecycle.singleton,useDynamic:e=>({getCommandService:()=>(0,S.mG)(void 0,void 0,void 0,function*(){return e.container.get(jd)})})}),r(HT,{lifecycle:L.Lifecycle.singleton,useDynamic:e=>({getModelService:()=>(0,S.mG)(void 0,void 0,void 0,function*(){return e.container.get(Hd)})})})};var j1;(function(r){r.CONFIG_TYPE="MODEL_SERVICE_CONFIG"})(j1||(j1={}));const H1=()=>wn.create(()=>{});class E7{constructor(){this.CONFIG_TYPE=j1.CONFIG_TYPE,this.registerModelFn=H1,this.isMounted=new ta,this.registerModel=e=>{this.registerModelFn=e},this.setMountState=()=>{this.isMounted.resolve(!0)},this.getConfig=()=>(0,S.mG)(this,void 0,void 0,function*(){return yield this.isMounted.promise,{CONFIG_TYPE:this.CONFIG_TYPE,modelRegisterFunc:this.registerModelFn||H1}}),this.dispose=()=>{this.registerModelFn=H1,this.isMounted=new ta}}}let Hf=class{constructor(){this.toDispose=new $r,this.deferredModelMap=new Map,this.registerModel=e=>{const{id:t,getInitialValue:n,modelFactory:i}=e,o=new $r,s=this.ensureModel(t);if(s.isResolved){console.error(e,"model has been registerd");return}const a=n?n():Ba.EMPTY_VALUE,l=i?i():new Vd(a);return Ba.isValidValue(a)&&s.resolve(l),e.watchChange&&e.watchChange(l,this).then(c=>{s.isResolved||s.resolve(l),this.toDispose.pushAll([c,o]),o.push(c)}),o},this.findDeferredModel=e=>this.deferredModelMap.get(e),this.awaitModel=e=>this.ensureModel(e).promise,this.registerRuntimeModel=()=>(0,S.mG)(this,void 0,void 0,function*(){const{modelRegisterFunc:e}=yield this.modelOptionProvider.getOption(),t=yield this.graphProvider.getGraphInstance();e&&e(this,t)}),this.ensureModel=e=>{const t=this.deferredModelMap.get(e);if(t)return t;const n=new ta;return this.deferredModelMap.set(e,n),this.toDispose.push(wn.create(()=>this.deferredModelMap.delete(e))),n}}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerModel(this);this.registerRuntimeModel()}onStop(){this.toDispose.dispose()}};(0,S.gn)([wr($d),(0,S.w6)("design:type",Object)],Hf.prototype,"contributionProvider",void 0),(0,S.gn)([St(GT),(0,S.w6)("design:type",Object)],Hf.prototype,"modelOptionProvider",void 0),(0,S.gn)([St(Wd),(0,S.w6)("design:type",Object)],Hf.prototype,"graphProvider",void 0),Hf=(0,S.gn)([Yt({contrib:[vu,Hd]})],Hf);const $te=r=>e=>{const t=e.findDeferredModel(r);return!!(t&&t.promise)},to=r=>e=>(0,S.mG)(void 0,void 0,void 0,function*(){return yield e.awaitModel(r)}),no=r=>e=>(0,S.mG)(void 0,void 0,void 0,function*(){return(yield e.awaitModel(r)).getValidValue()});var $f;(function(r){r.id="GRAPH_ENABLE_MULTI_SELECT",r.getModel=to(r.id),r.useValue=no(r.id)})($f||($f={}));var Wf;(function(r){r.id="GRAPH_FULLSCREEN",r.getModel=to(r.id),r.useValue=no(r.id)})(Wf||(Wf={}));var $1;(function(r){r.id="IS_NODE_SELECTED",r.getModel=to(r.id),r.useValue=no(r.id)})($1||($1={}));var Vy;(function(r){r.id="IS_GROUP_SELECTED",r.getModel=to(r.id),r.useValue=no(r.id)})(Vy||(Vy={}));var jy;(function(r){r.id="IS_NORMAL_NODES_SELECTED",r.getModel=to(r.id),r.useValue=no(r.id)})(jy||(jy={}));var g0;(function(r){r.id="LAST_SELECTED_CELL",r.getModel=to(r.id),r.useValue=no(r.id)})(g0||(g0={}));var Ol;(function(r){r.id="SELECTED_CELLS",r.getModel=to(r.id),r.useValue=no(r.id)})(Ol||(Ol={}));var Zd;(function(r){r.id="LAST_SELECTED_NODE",r.getModel=to(r.id),r.useValue=no(r.id)})(Zd||(Zd={}));var Xd;(function(r){r.id="SELECTED_NODES",r.getModel=to(r.id),r.useValue=no(r.id)})(Xd||(Xd={}));var $T;(function(r){r.id="SELECTED_EDGES",r.getModel=to(r.id),r.useValue=no(r.id)})($T||($T={}));var W1;(function(r){r.id="SELECTED_GROUPS",r.getModel=to(r.id),r.useValue=no(r.id)})(W1||(W1={}));var WT;(function(r){r.id="CONTEXTMENU_NODE",r.getModel=to(r.id),r.useValue=no(r.id)})(WT||(WT={}));var ZT;(function(r){r.id="CONTEXTMENU_EDGE",r.getModel=to(r.id),r.useValue=no(r.id)})(ZT||(ZT={}));var Hy;(function(r){r.id="CONTEXTMENU_TARGET",r.getModel=to(r.id),r.useValue=no(r.id)})(Hy||(Hy={}));var Zf;(function(r){r.id="GRAPH_META",r.getModel=to(r.id),r.useValue=no(r.id)})(Zf||(Zf={}));var m0;(function(r){r.id="GRAPH_SCALE",r.getModel=to(r.id),r.useValue=no(r.id)})(m0||(m0={}));var $y;(function(r){r.id="COMMAND_REDOABLE",r.getModel=to(r.id),r.useValue=no(r.id)})($y||($y={}));var Wy;(function(r){r.id="COMMAND_UNDOABLE",r.getModel=to(r.id),r.useValue=no(r.id)})(Wy||(Wy={}));var Z1;(function(r){r.id="COMMAND_GLOBALS",r.getModel=to(r.id),r.useValue=no(r.id)})(Z1||(Z1={}));var X1;(function(r){r.id="HISTORY_UNDOABLE",r.getModel=to(r.id),r.useValue=no(r.id)})(X1||(X1={}));var Y1;(function(r){r.id="HISTORY_REDOABLE",r.getModel=to(r.id),r.useValue=no(r.id)})(Y1||(Y1={}));let Zy=class{registerModel(e){e.registerModel({id:$y.id,getInitialValue:()=>this.commands.isRedoable,watchChange:t=>(0,S.mG)(this,void 0,void 0,function*(){return this.commands.watchChange(()=>{t.setValue(this.commands.isRedoable)})})}),e.registerModel({id:Wy.id,getInitialValue:()=>this.commands.isUndoable,watchChange:t=>(0,S.mG)(this,void 0,void 0,function*(){return this.commands.watchChange(()=>{t.setValue(this.commands.isUndoable)})})}),e.registerModel({id:Z1.id,modelFactory:()=>this.commands.Globals})}};(0,S.gn)([St(jd),(0,S.w6)("design:type",Object)],Zy.prototype,"commands",void 0),Zy=(0,S.gn)([Yt({contrib:$d})],Zy);const K1=(r,e,t)=>(r.on(e,t),wn.create(()=>{r.off(e,t)}));let Xy=class{constructor(){this.getGraphInstance=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=yield this.graphProvider.getGraphInstance(),t=yield this.graphProvider.getGraphOptions();return{graph:e,config:t}})}registerModel(e){e.registerModel({id:Zf.id,getInitialValue:()=>({flowId:"-1"}),watchChange:t=>(0,S.mG)(this,void 0,void 0,function*(){return wn.create(()=>{t.setValue({flowId:"-1"})})})}),e.registerModel({id:$f.id,getInitialValue:()=>({isEnable:!1}),watchChange:t=>(0,S.mG)(this,void 0,void 0,function*(){return wn.create(()=>{t.setValue({isEnable:!1})})})}),e.registerModel({id:Wf.id,getInitialValue:()=>!1,watchChange:(t,n)=>(0,S.mG)(this,void 0,void 0,function*(){const i=()=>(0,S.mG)(this,void 0,void 0,function*(){const o=!!document.fullscreenElement;(yield Wf.getModel(n)).setValue(o)});return document.addEventListener("fullscreenchange",i,!1),wn.create(()=>{document.removeEventListener("fullscreenchange",i),t.setValue(!1)})})}),e.registerModel({id:Ol.id,getInitialValue:()=>[],watchChange:t=>(0,S.mG)(this,void 0,void 0,function*(){const{graph:n}=yield this.getGraphInstance(),i=o=>{const{selected:s}=o;t.setValue(s)};return n.on("selection:changed",i),wn.create(()=>n.off("selection:changed",i))})}),e.registerModel({id:g0.id,watchChange:(t,n)=>(0,S.mG)(this,void 0,void 0,function*(){return(yield Ol.getModel(n)).watch((o=[])=>{t.setValue([...o].pop()||null)})})}),e.registerModel({id:Xd.id,getInitialValue:()=>[],watchChange:(t,n)=>(0,S.mG)(this,void 0,void 0,function*(){return(yield Ol.getModel(n)).watch((o=[])=>{const s=o.filter(a=>a.isNode());t.setValue(s)})})}),e.registerModel({id:Zd.id,watchChange:(t,n)=>(0,S.mG)(this,void 0,void 0,function*(){return(yield Xd.getModel(n)).watch(s=>{t.setValue([...s].pop()||null)})})}),e.registerModel({id:$1.id,watchChange:(t,n)=>(0,S.mG)(this,void 0,void 0,function*(){return(yield Xd.getModel(n)).watch(s=>{t.setValue(s.length>0)})})}),e.registerModel({id:Vy.id,getInitialValue:()=>!1,watchChange:(t,n)=>(0,S.mG)(this,void 0,void 0,function*(){return(yield Ol.getModel(n)).watch(s=>{const a=s.every(l=>l&&l.getProp("isGroup")===!0);t.setValue(a)})})}),e.registerModel({id:W1.id,getInitialValue:()=>[],watchChange:(t,n)=>(0,S.mG)(this,void 0,void 0,function*(){return(yield Xd.getModel(n)).watch(s=>{const a=s.filter(l=>l&&l.getProp("isGroup")===!0);t.setValue(a)})})}),e.registerModel({id:jy.id,getInitialValue:()=>!1,watchChange:(t,n)=>(0,S.mG)(this,void 0,void 0,function*(){return(yield Ol.getModel(n)).watch(s=>{const a=s.every(c=>{const u=!(c&&c.getProp("isGroup")),d=!(c&&c.getProp("group"));return u&&d}),l=s.length>0&&a;t.setValue(l)})})}),e.registerModel({id:m0.id,getInitialValue:()=>({zoomFactor:-1}),watchChange:t=>(0,S.mG)(this,void 0,void 0,function*(){const{graph:n}=yield this.getGraphInstance(),i=o=>{const s=n.zoom();t.setValue(Object.assign(Object.assign({},o),{zoomFactor:s}))};return n.on("scale",i),wn.create(()=>n.off("scale",i))})}),e.registerModel({id:Hy.id,watchChange:t=>(0,S.mG)(this,void 0,void 0,function*(){const{graph:n,config:i}=yield this.getGraphInstance(),o=a=>l=>{const{x:c,y:u}=l,d=n.localToClient({x:c,y:u}),h=i.rootContainer.getBoundingClientRect(),f={x:d.x-((h==null?void 0:h.x)||0),y:d.y-((h==null?void 0:h.y)||0)};t.setValue({type:a,anchor:f,data:l,cell:l.cell})},s=new $r;return s.pushAll([K1(n,"node:contextmenu",o("node")),K1(n,"edge:contextmenu",o("edge")),K1(n,"blank:contextmenu",o("blank"))]),s})}),e.registerModel({id:Y1.id,getInitialValue:()=>!1,watchChange:t=>(0,S.mG)(this,void 0,void 0,function*(){const{graph:n}=yield this.getGraphInstance(),i=()=>{const o=n.history.canRedo();t.setValue(o)};return n.history&&n.history.on("change",i),wn.create(()=>n.history.off("change",i))})}),e.registerModel({id:X1.id,getInitialValue:()=>!1,watchChange:t=>(0,S.mG)(this,void 0,void 0,function*(){const{graph:n}=yield this.getGraphInstance(),i=()=>{const o=n.history.canUndo();t.setValue(o)};return n.history&&n.history.on("change",i),wn.create(()=>n.history.off("change",i))})})}};(0,S.gn)([St(Wd),(0,S.w6)("design:type",Object)],Xy.prototype,"graphProvider",void 0),Xy=(0,S.gn)([Yt({contrib:$d})],Xy);const S7=Nr(r=>{Mi.register(r,$d),r(Hf),r(Xy),r(Zy)}),_7=(r,e)=>{r({token:GT,useDynamic:()=>({getOption:()=>(0,S.mG)(void 0,void 0,void 0,function*(){return e.getConfig()})}),lifecycle:L.Lifecycle.singleton})},A7=r=>Nr(e=>{_7(e,r)}),XT=r=>{const{config:e}=r,t=vc(),n=b.useMemo(()=>e||new E7,[]);return b.useEffect(()=>{const i=t.addCoreModule({config:n,createModule:A7});return n.setMountState(),()=>{i.dispose(),n.dispose()}},[]),null};XT.defaultProps={XFlowModuleType:"ModelServiceConfig"};const Wte=r=>e=>{const t=React.useMemo(()=>({getValue:()=>({})}),[]);return t.getValue=()=>e,React.useMemo(()=>{const i=new ModelServiceConfig;return r(i,t),i},[t])},T7=r=>{const e=r.getChildren(),t=r.getSize(),n=r.getData()||{},i=r.getPosition(),o=r.getParentId(),{isCollapsed:s}=n,a=n.groupCollapsedSize||(s?t:null);return Object.assign(Object.assign({},n),{id:r.id,width:t.width,height:t.height,x:i.x,y:i.y,group:o,groupChildren:e?e.map(l=>l.id):null,groupCollapsedSize:a})},M7=r=>{const e=r.getData()||{};return Object.assign(Object.assign({},e),{id:r.id,source:r.getSourceCellId(),target:r.getTargetCellId(),sourcePortId:r.getSourcePortId(),targetPortId:r.getTargetPortId(),sourcePort:r.getSourcePortId(),targetPort:r.getTargetPortId()})},YT=r=>{const e=[],t=[],n=i=>{i.isNode()&&e.push(T7(i)),i.isEdge()&&t.push(M7(i))};return r.map(i=>n(i)),{nodes:e,edges:t}},P7=100;let bu=class{constructor(){this.getGraphInstance=()=>this.graphProvider.getGraphInstance(),this.getGraphConfig=()=>this.graphProvider.getGraphOptions(),this.getGraphData=()=>(0,S.mG)(this,void 0,void 0,function*(){const t=(yield this.graphProvider.getGraphInstance()).getCells();return YT(t)}),this.getAllNodes=()=>(0,S.mG)(this,void 0,void 0,function*(){return(yield this.graphProvider.getGraphInstance()).getNodes()}),this.getNodeById=e=>(0,S.mG)(this,void 0,void 0,function*(){return(yield this.graphProvider.getGraphInstance()).getCellById(e)}),this.getAllEdges=()=>(0,S.mG)(this,void 0,void 0,function*(){return(yield this.graphProvider.getGraphInstance()).getEdges()}),this.getEdgeById=e=>(0,S.mG)(this,void 0,void 0,function*(){return(yield this.graphProvider.getGraphInstance()).getCellById(e)}),this.updateNodeAttrs=(e,t)=>(0,S.mG)(this,void 0,void 0,function*(){e instanceof ii?e.setAttrs(t):(yield this.getNodeById(e)).setAttrs(t)}),this.updateEdgeAttrs=(e,t)=>(0,S.mG)(this,void 0,void 0,function*(){e instanceof Ai?e.setAttrs(t):(yield this.getEdgeById(e)).setAttrs(t)}),this.translateGraph=(e,t)=>(0,S.mG)(this,void 0,void 0,function*(){const n=yield this.graphProvider.getGraphInstance(),i=n.translate();n.translate(i.tx+e,i.ty+t)})}start(){return(0,S.mG)(this,void 0,void 0,function*(){yield this.startContributions(),this.registerEventListeners()})}executeCommand(e,t,n=[]){return this.commandService.executeCommand(e,t,n)}executeCommandPipeline(e){return this.commandService.executeCommandPipeline(e)}registerEventListeners(){window.addEventListener("unload",()=>{this.stopContributions()})}startContributions(){return(0,S.mG)(this,void 0,void 0,function*(){console.log(this.contributions.getContributions());for(const e of this.contributions.getContributions())if(e.onStart)try{yield this.measure(`${e.constructor.name}.onStart`,()=>e.onStart(this))}catch(t){console.error("Could not start contribution",t)}})}stopContributions(){console.info(">>> Stopping frontend contributions...");for(const e of this.contributions.getContributions())if(e.onStop)try{e.onStop(this)}catch(t){console.error("Could not stop contribution",t)}console.info("<<< All frontend contributions have been stopped.")}measure(e,t){return(0,S.mG)(this,void 0,void 0,function*(){const n=`${e}-start`,i=`${e}-end`;performance.mark(n);const o=yield t();performance.mark(i),performance.measure(e,n,i);for(const s of performance.getEntriesByName(e)){const a=`Frontend ${s.name}`;s.duration>P7?console.warn(`${a} is slow, took: ${s.duration.toFixed(1)} ms`):console.debug(`${a} took: ${s.duration.toFixed(1)} ms`)}return performance.clearMeasures(e),o})}};(0,S.gn)([wr(vu),(0,S.w6)("design:type",Object)],bu.prototype,"contributions",void 0),(0,S.gn)([St(Wd),(0,S.w6)("design:type",Object)],bu.prototype,"graphProvider",void 0),(0,S.gn)([St(jd),(0,S.w6)("design:type",Object)],bu.prototype,"commandService",void 0),(0,S.gn)([St(Hd),(0,S.w6)("design:type",Object)],bu.prototype,"modelService",void 0),bu=(0,S.gn)([Yt()],bu);const O7=Nr(r=>{Mi.register(r,vu),r(bu)}),D7=r=>{const e=r.getAllExtensions(),t=new po,n=e.map(o=>{const{createModule:s,config:a}=o;return s(a)});return t.load(O7),t.load(l7),t.load(S7),n.forEach(o=>{t.load(o)}),t.get(bu)};class Zte{constructor(){this.xflowPrefixCls=XFLOW_PREFIX_CLS,this.getXflowPrefixCls=e=>`${this.xflowPrefixCls}-${e}`,this.setXflowPrefixCls=e=>this.xflowPrefixCls=e}}const N7=b.createContext({configProvider:null}),R7=()=>b.useContext(N7),Yy=r=>{const e=R7();return b.useMemo(()=>e.configProvider?e.configProvider.getXflowPrefixCls(r):`${e8}-${r}`,[r])};function k7(r){const{createModule:e,children:t}=r,n=vc(),i=b.useMemo(()=>r.config||{CONFIG_TYPE:"",getConfig:()=>(0,S.mG)(this,void 0,void 0,function*(){return{}})},[]);return b.useEffect(()=>{const o=n.addExtension({config:i,createModule:e});return()=>{o.dispose()}},[]),Array.isArray(t)||b.isValidElement(t)?b.createElement(b.Fragment,null," ",t," "):null}const yc=(r={})=>(0,b.useMemo)(()=>{const e=Object.entries(r),t=e.length>0?{position:"absolute"}:{};return e.forEach(([n,i=0])=>{t[n]=`${i}px`}),t},[r]),I7=r=>Nr(e=>{w7(e),d8(e,r)}),Ky=Qz({type:"react componnet"});kr.registerReactComponent=Ky.register,kr.unregisterReactComponent=Ky.unregister,kr.Hook.prototype.getReactComponent=function(r){const e=this.options.getReactComponent;if(typeof e=="function"){const n=dn(e,this.graph,r);if(n!=null)return n}let t=r.getComponent();if(typeof t=="string"){const n=Ky.get(t);if(n==null)return Ky.onNotFound(t);t=n}return t};class v0 extends ii{get component(){return this.getComponent()}set component(e){this.setComponent(e)}getComponent(){return this.store.get("component")}setComponent(e,t={}){return e==null?this.removeComponent(t):this.store.set("component",e,t),this}removeComponent(e={}){return this.store.remove("component",e),this}}(function(r){function e(t,n,i="rect"){const o=[],s=n?Ur.getForeignObjectMarkup():{tagName:"g",selector:"content"};return t?o.push(s):o.push({tagName:i,selector:"body"},s,{tagName:"text",selector:"label"}),o}r.config({view:"react-shape-view",markup:e(!1,!0),attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"},label:{fontSize:14,fill:"#333",refX:"50%",refY:"50%",textAnchor:"middle",textVerticalAnchor:"middle"}},propHooks(t){if(t.markup==null){const n=t.primer,i=t.useForeignObject!==!1;if(n&&n!=="rect"){t.markup=e(!1,i,n);let o={};n==="circle"?o={refCx:"50%",refCy:"50%",refR:"50%"}:n==="ellipse"&&(o={refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}),t.attrs=ir({},{body:Object.assign({refWidth:null,refHeight:null},o)},t.attrs||{})}else t.simple&&(t.markup=e(!0,i),t.attrs=ir({},{body:null,label:null},t.attrs||{}))}return t}}),ii.registry.register("react-shape",r,!0)})(v0||(v0={}));var Xf;(function(r){let e=!1,t;const n=(l,c)=>{const u=c.payload;switch(c.type){case"add":{const d=l.findIndex(h=>h.id===u.id);return d>=0?(l[d]=u,[...l]):[...l,u]}case"remove":{const d=l.findIndex(h=>h.id===u.id);if(d>=0){const h=[...l];return h.splice(d,1),h}break}default:break}return l};function i(l,c){e&&t({type:"add",payload:{id:l,portal:c}})}r.connect=i;function o(l){e&&t({type:"remove",payload:{id:l}})}r.disconnect=o;function s(){return e}r.isActive=s;function a(){return()=>{e=!0;const[l,c]=(0,b.useReducer)(n,[]);return t=c,b.createElement(b.Fragment,{children:l.map(u=>u.portal)})}}r.getProvider=a})(Xf||(Xf={}));class y0 extends b.PureComponent{constructor(e){super(e);this.scheduledAnimationFrame=!1,this.throttleUpdateFunc=()=>{this.scheduledAnimationFrame||(this.scheduledAnimationFrame=!0,window.requestAnimationFrame(()=>{this.setState(t=>(this.scheduledAnimationFrame=!1,{tick:t.tick+1}))}))},this.onChange=t=>{if(y0.throttleChangeTypes.includes(t.key)){this.throttleUpdateFunc();return}this.setState({tick:this.state.tick+1})},this.state={tick:0}}componentDidMount(){this.props.node.on("change:*",this.onChange)}componentWillUnmount(){this.props.node.off("change:*",this.onChange)}clone(e){const{node:t}=this.props;return typeof e.type=="string"?b.cloneElement(e):b.cloneElement(e,{node:t})}render(){const{graph:e,node:t,component:n}=this.props;if(b.isValidElement(n))return this.clone(n);if(typeof n=="function"){const i=dn(n,e,t);if(b.isValidElement(i))return this.clone(i)}return n}}y0.throttleChangeTypes=["position","size"];class qy extends xo{init(){super.init(),this.cell.on("removed",()=>{Xf.disconnect(this.cell.id)})}getComponentContainer(){return this.cell.prop("useForeignObject")===!1?this.selectors.content:this.selectors.foContent}confirmUpdate(e){const t=super.confirmUpdate(e);return this.handleAction(t,qy.action,()=>{Fg?Fg.scheduleTask(()=>{this.renderReactComponent()}):this.renderReactComponent()})}renderReactComponent(){this.unmountReactComponent();const e=this.getComponentContainer(),t=this.cell,n=this.graph;if(e){const i=this.graph.hook.getReactComponent(t),o=b.createElement(y0,{graph:n,node:t,component:i});Xf.isActive()?Xf.connect(this.cell.id,pu.createPortal(o,e)):pu.render(o,e)}}unmountReactComponent(){const e=this.getComponentContainer();return e&&pu.unmountComponentAtNode(e),e}unmount(){return Xf.disconnect(this.cell.id),this.unmountReactComponent(),super.unmount(),this}}(function(r){r.action="react",r.config({bootstrap:[r.action],actions:{component:r.action}}),xo.registry.register("react-shape-view",r,!0)})(qy||(qy={}));var L7=function(r,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o};const q1="react";function G7(r){const e={current:()=>{}},t=c=>{e.current(c)};let n,i;function o(c,u){n({id:c,portal:u})}function s(c){i(c)}const a=()=>{const[c,u]=(0,b.useState)([]),[d,h]=(0,b.useState)(),f=(0,b.useRef)([]),p=(0,b.useRef)([]);e.current=h,n=(0,b.useCallback)(E=>{const{id:T}=E;if(f.current.includes(T)){const P=p.current,z=P.findIndex($=>$.id===T);z>-1?P[z]=E:P.push(E),p.current=P}else u(P=>{const z=[...P],$=z.findIndex(ne=>ne.id===T);return $>-1?z[$]=E:z.push(E),z})},[]),i=(0,b.useCallback)(E=>{f.current.includes(E)&&(f.current=f.current.filter(T=>T!==E)),p.current.map(T=>T.id).includes(E)&&(p.current=p.current.filter(T=>T.id!==E)),u(T=>T.filter(P=>P.id!==E))},[]);const y=(0,b.useCallback)(E=>{const{name:T,data:P}=E,{cells:z=[]}=P||{};if(T==="add"){const $=z.filter(ne=>ne.isNode()).map(ne=>ne.id);f.current=Array.from(new Set([...f.current,...$]))}},[]),x=(0,b.useCallback)(({name:E})=>{if(E==="add"){const T=p.current;if(T.length){const P=T.map(z=>z.id);f.current=f.current.filter(z=>!P.includes(z)),p.current=[],u(z=>{const $=[...z];return T.forEach(ne=>{const De=$.findIndex(fe=>fe.id===ne.id);De>-1?$[De]=ne:$.push(ne)}),$})}}},[]);return(0,b.useLayoutEffect)(()=>(d&&(d.on("batch:start",y),d.on("batch:stop",x)),()=>{d&&(d.off("batch:start",y),d.off("batch:stop",x),u([]),f.current=[],p.current=[])}),[d,y,x]),b.createElement(b.Fragment,null,...c.map(E=>E.portal))};class l extends xo{init(){super.init(),this.cell.on("removed",()=>{s(this.cell.id)})}getComponentContainer(){return this.cell.prop("useForeignObject")===!1?this.selectors.content:this.selectors.foContent}confirmUpdate(u){const d=super.confirmUpdate(u);return this.handleAction(d,q1,()=>this.renderReactComponent())}renderReactComponent(){this.unmountReactComponent();const u=this.getComponentContainer(),d=this.cell,h=this.graph;if(u){const f=this.graph.hook.getReactComponent(d),p=b.createElement(y0,{graph:h,node:d,component:f});o(this.cell.id,pu.createPortal(p,u))}}unmountReactComponent(){const u=this.getComponentContainer();return u&&pu.unmountComponentAtNode(u),u}onMouseDown(u,d,h){const f=u.target;if(f.tagName.toLowerCase()==="input"){const g=f.getAttribute("type");if(g==null||["text","password","number","email","search","tel","url"].includes(g))return}super.onMouseDown(u,d,h)}dispose(){s(this.cell.id),this.unmountReactComponent()}}return L7([xo.dispose()],l.prototype,"dispose",null),l.config({bootstrap:[q1],actions:{component:q1}}),xo.registry.register(r,l,!0),{Portal:a,setGraph:t}}function F7(r){const e=(0,b.useRef)(!1),[t]=(0,b.useState)(()=>e.current?{}:(e.current=!0,G7(r)));return[t.Portal,t.setGraph]}const J1=r=>{const e=Yo(),t=b.useRef(null),n=b.useRef(null),i=vc(),o=b.useMemo(()=>{const d=r.config?r.config:new fT;return d.setX6Config(),d},[]),[s,a]=F7(o.graphId);b.useEffect(()=>{e&&e.getGraphInstance().then(d=>{a(d)})},[e,a]),b.useEffect(()=>{o.setRootContainer(t.current),o.setGraphContainer(n.current),o.xflowInstanceId=i.getInstanceId(),i.addCoreModule({config:o,createModule:I7});const d=()=>(0,S.mG)(void 0,void 0,void 0,function*(){o.dispose()});return()=>{d()}},[]);const l=yc(r.position),c=Yy("canvas-root"),u=Yy("x6-canvas");return b.createElement(b.Fragment,null,b.createElement("div",{ref:t,className:c,style:l,id:o.graphId,tabIndex:0},b.createElement("div",{ref:n,className:u}),r.children),b.createElement(s,null))};J1.defaultProps={isXFlowCanvas:!0};let bc=class{constructor(){this.toDispose=new $r,this.runtimeHooks=[],this.getX6Graph=()=>(0,S.mG)(this,void 0,void 0,function*(){if(this.graph)return this.graph;const e=yield this.graphProvider.getGraphInstance();return this.graph=e,e}),this.getGraphConfig=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.graphProvider.getGraphOptions()}),this.getGraphMeta=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.getModelService();return this.graphMeta||(yield Zf.useValue(e))}),this.setArgs=(e,t=[])=>(this.args=e,this.runtimeHooks=t,{args:e,hooks:t}),this.getArgs=()=>({args:Object.assign(Object.assign({},this.args),{modelService:this.getModelService(),commandService:this.getCommands(),getGraphMeta:this.getGraphMeta,getX6Graph:this.getX6Graph,getGraphConfig:this.getGraphConfig}),hooks:this.runtimeHooks}),this.setResult=e=>(this.result=e,this.result),this.getResult=()=>this.result,this.getHooks=()=>this.hookService.hookProvider(),this.getCommands=()=>this.commandService,this.getModelService=()=>this.modelService,this.addUndo=e=>{if(!Array.isArray(e))return this.addUndo([e]);this.toDispose.pushAll(e)},this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){yield this.toDispose.dispose()}),this.isUndoable=()=>!this.toDispose.disposed,this.getDisposables=()=>this.toDispose,this.setGlobal=(e,t)=>{this.commandService.setGlobal(e,t)},this.getGlobal=e=>this.commandService.getGlobal(e)}init(){this.getGraphMeta().then(e=>{this.graphMeta=e})}};(0,S.gn)([St(Wd),(0,S.w6)("design:type",Object)],bc.prototype,"graphProvider",void 0),(0,S.gn)([St(z1),(0,S.w6)("design:type",Object)],bc.prototype,"hookService",void 0),(0,S.gn)([St(jd),(0,S.w6)("design:type",Object)],bc.prototype,"commandService",void 0),(0,S.gn)([St(Hd),(0,S.w6)("design:type",Object)],bc.prototype,"modelService",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],bc.prototype,"init",null),bc=(0,S.gn)([at()],bc);const B7="CommandConfig",z7=()=>[];class Yf{constructor(){this.setCommandContributions=e=>{this.getContributions=e},this.getCommandContributions=()=>this.getContributions(),this.registerHook=e=>(0,S.mG)(this,void 0,void 0,function*(){return this.registerHookFn?this.registerHookFn(e):zT}),this.registerHookHub=e=>(0,S.mG)(this,void 0,void 0,function*(){return this.registerHookHubFn?this.registerHookHubFn(e):zT}),this.CONFIG_TYPE=B7,this.setRegisterHookFn=e=>{this.registerHookFn=e},this.setRegisterHookHubFn=e=>{this.registerHookHubFn=e},this.getConfig=()=>(0,S.mG)(this,void 0,void 0,function*(){return{registerHookFn:this.registerHookFn,getContributions:this.getContributions,CONFIG_TYPE:this.CONFIG_TYPE}}),this.getContributions=z7}}const Xte=()=>new Yf,U7=(r,e)=>{r({token:Yf,contrib:[wa],lifecycle:L.Lifecycle.singleton,useDynamic:()=>e})};var Jy;(function(r){r.command=Wr.ADD_NODE,r.hookKey="addNode"})(Jy||(Jy={}));let Qy=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),o=yield e.getHooks().addNode.call(t,s=>(0,S.mG)(this,void 0,void 0,function*(){const{createNodeService:a,cellFactory:l,commandService:c,options:u}=s,d=yield e.getX6Graph();let h=s.nodeConfig;if(a){const v=yield a(s);if(typeof v=="boolean")return{err:"createNodeService rejected"};h=v}const f=yield this.processNodeConfig(h);let p;const g=Object.assign(Object.assign({},u),{isCommand:!0});if(l){const v=yield l(f,this);p=d.addNode(v,g)}else p=d.addNode(f,g);return e.addUndo(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){const v=Object.assign({id:p.id},p.getData());c.executeCommand(Wr.DEL_NODE.id,{nodeConfig:v})}))),{nodeConfig:f,nodeCell:p}}),n);return e.setResult(o),this}),this.processNodeConfig=e=>(0,S.mG)(this,void 0,void 0,function*(){const t=this.contextProvider();if(e.data=Object.assign({},e),e.shape)return e;if(!e.view){const n=yield t.getGraphConfig();e.view=n.graphId}if(!e.component){const n=yield this.getNodeReactComponent(e),i=t.getCommands(),o=t.getModelService();e.shape="react-shape",e.component=VT(n,i,o)}return e}),this.getNodeReactComponent=e=>(0,S.mG)(this,void 0,void 0,function*(){const t=this.contextProvider(),n=t.getHooks(),i=yield t.getGraphConfig(),o=yield n.reactNodeRender.call(i.nodeRender),s=i.nodeTypeParser(e)||Sy,a=o.get(s);return a||console.error("react node component is missing:",i.nodeRender,s,a),a}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],Qy.prototype,"contextProvider",void 0),Qy=(0,S.gn)([at({token:{token:Sr,named:Jy.command.id}})],Qy);var eb;(function(r){r.command=Wr.DEL_NODE,r.hookKey="delNode",r.createHook=()=>new za})(eb||(eb={}));let tb=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),o=yield e.getHooks().delNode.call(t,s=>(0,S.mG)(this,void 0,void 0,function*(){const{commandService:a,deleteNodeService:l,options:c}=s,u=yield e.getX6Graph();if(l&&!(yield l(s)))return{err:" service rejected"};const d=(s.x6Node||s.nodeConfig).id,h=u.getCellById(d);if(h&&h.isNode()){const f=[...u.getIncomingEdges(h)||[],...u.getOutgoingEdges(h)||[]];yield Promise.all(f.map(g=>a.executeCommand(Ti.DEL_EDGE.id,{x6Edge:g})));const p=h.getData();return h.remove(Object.assign(Object.assign({},c),{isCommand:!0})),e.addUndo(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){yield a.executeCommand(Wr.ADD_NODE.id,{nodeConfig:p})}))),{err:null,nodeConfig:p}}return{err:"node is not exist"}}),n);return e.setResult(o),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()&&this.contextProvider().undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],tb.prototype,"contextProvider",void 0),tb=(0,S.gn)([at({token:{token:Sr,named:eb.command.id}})],tb);var nb;(function(r){r.command=Wr.SELECT_NODE,r.hookKey="selectNode"})(nb||(nb={}));let b0=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().selectNode.call(e,o=>(0,S.mG)(this,void 0,void 0,function*(){const s=yield this.ctx.getX6Graph(),a=s.getSelectedCells().map(d=>d.id),{nodeIds:l,resetSelection:c,commandService:u}=o;return c?s.resetSelection(l):s.select(l),this.ctx.addUndo({dispose:()=>{u.executeUndoCommand(Wr.SELECT_NODE.id,{nodeIds:a,resetSelection:!0})}}),{}}),t);return this.ctx.setResult(i),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],b0.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],b0.prototype,"init",null),b0=(0,S.gn)([at({token:{token:Sr,named:nb.command.id}})],b0);var rb;(function(r){r.command=Wr.MOVE_NODE,r.hookKey="moveNode",r.createHook=()=>new za})(rb||(rb={}));let ib=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),o=yield e.getHooks().moveNode.call(t,s=>(0,S.mG)(this,void 0,void 0,function*(){const{nodePositionService:a}=s;if(a&&!(yield a(s)))return{err:"service rejected"};const{dx:l=0,dy:c=0,x:u,y:d,duration:h=150}=s.position,p=(yield e.getX6Graph()).getCellById(s.id);if(p){let g=u,v=d;const{x:y,y:x}=p.position();let E=()=>{p.position(y,x,{silent:!1})};return l||c?(g=l+y,v=c+x,p.translate(l,c,{transition:{duration:h}}),E=()=>p.translate(-l,-c,{transition:{duration:h}})):p.position(g,v,{silent:!1}),e.addUndo(wn.create(()=>{E()})),{err:null,nextX:g,nextY:v}}}),n);return e.setResult(o),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],ib.prototype,"contextProvider",void 0),ib=(0,S.gn)([at({token:{token:Sr,named:rb.command.id}})],ib);var V7=w(51584),ob=w.n(V7),Yd;(function(r){r.command=Wr.UPDATE_NODE,r.hookKey="updateNode",r.XFlowNodeSetOptions={overwrite:!0},r.NODE_WIDTH=200,r.NODE_HEIGHT=40})(Yd||(Yd={}));let x0=class{constructor(){this.setNodeConfig=(e,t,n)=>{e.setData(t,n),e.setPosition((t==null?void 0:t.x)||0,(t==null?void 0:t.y)||0),e.setSize((t==null?void 0:t.width)||Yd.NODE_WIDTH,(t==null?void 0:t.height)||Yd.NODE_HEIGHT),e.angle((t==null?void 0:t.angle)||0,{absolute:!0}),ob()(t==null?void 0:t.visible)&&e.setVisible(t==null?void 0:t.visible),!(e instanceof v0)&&!!e.getAttrByPath("text/text")&&e.setAttrByPath("text/text",t.label),t.attrs&&e.setAttrs(t.attrs),Array.isArray(t.ports)&&e.setPropByPath("ports/items",t.ports,Object.assign({rewrite:!0},n))},this.getNodeConfig=e=>{const t=e.getData(),n=e.getPosition(),i=e.getSize();return Object.assign(Object.assign(Object.assign({},t),n),i)},this.getNodeCell=(e,t)=>{const{nodeConfig:n,setNodeConfig:i}=t;let o="";if(i&&i.node&&typeof i.node=="string"?o=i.node:n&&n.id&&typeof n.id=="string"&&(o=n.id),o)return e==null?void 0:e.getCellById(o);if(i&&i.node instanceof ii)return i.node},this.getNextNodeConfig=(e,t)=>(0,S.mG)(this,void 0,void 0,function*(){if(e&&e.setNodeConfig&&e.setNodeConfig.callback){const n=this.getNodeConfig(t);return e.setNodeConfig.callback(n)}return e.nodeConfig}),this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().updateNode.call(e,o=>(0,S.mG)(this,void 0,void 0,function*(){const{options:s=Yd.XFlowNodeSetOptions}=o,a=yield this.ctx.getX6Graph(),l=this.getNodeCell(a,o),c=yield this.getNextNodeConfig(o,l);return this.setNodeConfig(l,c,s),{nodeConfig:c,nodeCell:l}}),t);return this.ctx.setResult(i),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],x0.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],x0.prototype,"init",null),x0=(0,S.gn)([at({token:{token:Sr,named:Yd.command.id}})],x0);var sb;(function(r){r.command=Wr.CENTER_NODE,r.hookKey="centerNode"})(sb||(sb={}));let C0=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().centerNode.call(e,o=>(0,S.mG)(this,void 0,void 0,function*(){const s=yield this.ctx.getX6Graph(),{nodeConfig:a}=o,l=s==null?void 0:s.getCellById(a==null?void 0:a.id);return s==null||s.centerCell(l),{x6Node:l}}),t);return this.ctx.setResult(i),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],C0.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],C0.prototype,"init",null),C0=(0,S.gn)([at({token:{token:Sr,named:sb.command.id}})],C0);var ab;(function(r){r.command=Wr.FRONT_NODE,r.hookKey="frontNode"})(ab||(ab={}));let w0=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),o=yield e.getHooks().frontNode.call(t,s=>(0,S.mG)(this,void 0,void 0,function*(){const a=yield this.ctx.getX6Graph(),{nodeId:l}=s,c=a==null?void 0:a.getCellById(l);return c?(c.toFront(),e.addUndo(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){s.commandService.executeCommand(Wr.BACK_NODE.id,{nodeId:l})})))):console.error(l,"this nodeId is not exist"),{}}),n);return e.setResult(o),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],w0.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],w0.prototype,"init",null),w0=(0,S.gn)([at({token:{token:Sr,named:ab.command.id}})],w0);var lb;(function(r){r.command=Wr.BACK_NODE,r.hookKey="backNode"})(lb||(lb={}));let E0=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().backNode.call(e,o=>(0,S.mG)(this,void 0,void 0,function*(){const s=yield this.ctx.getX6Graph(),{nodeId:a}=o,l=s==null?void 0:s.getCellById(a);return l?(l.toBack(),this.ctx.addUndo(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){o.commandService.executeCommand(Wr.FRONT_NODE.id,{nodeId:a})})))):console.error(a,"this nodeId is not exist"),{}}),t);return this.ctx.setResult(i),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],E0.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],E0.prototype,"init",null),E0=(0,S.gn)([at({token:{token:Sr,named:lb.command.id}})],E0);var cb;(function(r){r.command=Wr.HIGHLIGHT_NODE,r.hookKey="highlightNode"})(cb||(cb={}));let S0=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().highlightNode.call(e,o=>(0,S.mG)(this,void 0,void 0,function*(){const s=yield this.ctx.getX6Graph(),{nodeId:a,stroke:l,strokeWidth:c}=o,u=s==null?void 0:s.getCellById(a);if(u){if(u==null||u.setAttrs({body:{stroke:l||"#7c68fc",strokeWidth:c||2}}),o==null?void 0:o.isHighlightRelatedLines){const{edgeStroke:d,edgeStrokeWidth:h}=o;(s==null?void 0:s.getEdges()).forEach(p=>{const g=p==null?void 0:p.getData();o==null||o.commandService.executeCommand(Ti.HIGHLIGHT_EDGE.id,{edgeId:g==null?void 0:g.id,strokeColor:d,strokeWidth:h})})}}else return console.error(a,"this nodeId is not exist"),{err:"this nodeId is not exist"};return{err:null}}),t);return this.ctx.setResult(i),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],S0.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],S0.prototype,"init",null),S0=(0,S.gn)([at({token:{token:Sr,named:cb.command.id}})],S0);var ub;(function(r){r.command=Wr.UPDATE_NODE_PORT,r.hookKey="updateNodePort"})(ub||(ub={}));let db=class{constructor(){this.getCell=(e,t)=>typeof t=="string"?e.getCellById(t):t,this.getNodeConfig=e=>{const t=e.getData(),n=e.getPosition(),i=e.getSize();return Object.assign(Object.assign(Object.assign({},t),n),i)},this.updatePortsOfNodeConfig=(e,t,n)=>{const i=this.getNodeConfig(e);this.isNodeAnchors(i.ports)&&(i.ports=[...t]),this.isPortMetaData(i.ports)&&(i.ports.items=[...t]),e.setData(i,n)},this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),i=e.getHooks(),o=yield e.getX6Graph(),s=yield i.updateNodePort.call(t,a=>(0,S.mG)(this,void 0,void 0,function*(){const{node:l,updatePorts:c,options:u,commandService:d}=a,h=this.getCell(o,l);if(!h||h.isEdge())return console.error("node_is _not_exsit",l),{err:"node_is _not_exsit"};const f=h.getPorts(),p=yield c([...f],h,o);return p===!1?{err:"service rejected"}:(h.setPropByPath("ports/items",p,Object.assign({rewrite:!0},u)),this.updatePortsOfNodeConfig(h,p,u),e.addUndo(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){d.executeCommand(Wr.UPDATE_NODE_PORT.id,{node:l,updatePorts:()=>(0,S.mG)(this,void 0,void 0,function*(){return f})})}))),{ports:p})}),n);return e.setResult(s),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isNodeAnchors(e){return Array.isArray(e)}isPortMetaData(e){return e.items&&Array.isArray(e.items)}isUndoable(){return this.contextProvider().isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],db.prototype,"contextProvider",void 0),db=(0,S.gn)([at({token:{token:Sr,named:ub.command.id}})],db);const j7=r=>{r(Qy),r(tb),r(b0),r(ib),r(x0),r(C0),r(w0),r(E0),r(S0),r(db)},H7=[Jy,eb,nb,rb,Yd,sb,ab,lb,cb,ub];var hb;(function(r){r.command=Zn.LOAD_META,r.hookKey="graphMeta"})(hb||(hb={}));let _0=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().graphMeta.call(e,a=>(0,S.mG)(this,void 0,void 0,function*(){const{graphMetaService:l}=a,c=l?yield l(a):Object.assign({},a==null?void 0:a.meta);return Object.assign({flowId:c==null?void 0:c.flowId},c)}),t),o=this.ctx.getModelService();return(yield Zf.getModel(o)).setValue(i),this.ctx.setResult(i),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],_0.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],_0.prototype,"init",null),_0=(0,S.gn)([at({token:{token:Sr,named:hb.command.id}})],_0);var fb;(function(r){r.command=Zn.SAVE_GRAPH_DATA,r.hookKey="saveGraphData"})(fb||(fb={}));let A0=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.ctx,t=e.getArgs();return yield e.getHooks().saveGraphData.call(t.args,i=>(0,S.mG)(this,void 0,void 0,function*(){const{saveGraphDataService:o,includeAttrs:s}=i,a=yield e.getX6Graph(),l=a.getNodes(),c=a.getEdges(),u=l.map(p=>{const g=p.getData(),v=p.position(),y=p.size(),x=Object.assign(Object.assign(Object.assign({id:p.id},g),v),y);return s&&(x.attrs=p.getAttrs()),x}),d=c.map(p=>{const g=p.getData(),v=Object.assign({id:p.id},g);return s&&(v.attrs=p.getAttrs()),v}),h={nodes:u,edges:d},f=yield this.ctx.getGraphMeta();if(o){const p=yield o(f,h);p&&this.ctx.setResult(p)}return{}}),t.hooks),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],A0.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],A0.prototype,"init",null),A0=(0,S.gn)([at({token:{token:Sr,named:fb.command.id}})],A0);var pb;(function(r){r.command=Zn.LOAD_DATA,r.hookKey="loadData",r.createHook=()=>new za})(pb||(pb={}));let T0=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().loadData.call(e,o=>(0,S.mG)(this,void 0,void 0,function*(){const{loadDataService:s}=o,a=yield this.ctx.getGraphMeta();return{graphData:yield s(a)}}),t);return this.ctx.setResult(i),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],T0.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],T0.prototype,"init",null),T0=(0,S.gn)([at({token:{token:Sr,named:pb.command.id}})],T0);const M0=r=>typeof r=="string",$7=r=>{const e=Object.create(null);return t=>e[t]||(e[t]=r(t))},W7=/-(\w)/g,Yte=$7(r=>r.replace(W7,(e,t)=>t?t.toUpperCase():"")),os=Array.isArray,un=r=>typeof r=="number",gb=r=>Number.isNaN(Number(r)),Kte=r=>{const e=parseFloat(r);return gb(e)?r:e},xc=r=>r!==null&&typeof r=="object",P0=r=>{if(r===null)return r;if(r instanceof Date)return new Date(r.getTime());if(r instanceof Array){const e=[];return r.forEach(t=>{e.push(t)}),e.map(t=>P0(t))}if(typeof r=="object"&&r!=={}){const e=Object.assign({},r);return Object.keys(e).forEach(t=>{e[t]=P0(e[t])}),e}return r},Xr=(r,e)=>{const t=r[e];return xc(t)?t.cell:t},O0=(r,e,t)=>{const n=[];for(let i=0;i<r;i++)n[i]=0;return t&&t.forEach(i=>{const o=Xr(i,"source"),s=Xr(i,"target");o&&(n[e[o]]+=1),s&&(n[e[s]]+=1)}),n},KT=r=>{const e=[],t=r.length;for(let n=0;n<t;n+=1){e[n]=[];for(let i=0;i<t;i+=1)n===i?e[n][i]=0:r[n][i]===0||!r[n][i]?e[n][i]=Infinity:e[n][i]=r[n][i]}for(let n=0;n<t;n+=1)for(let i=0;i<t;i+=1)for(let o=0;o<t;o+=1)e[i][o]>e[i][n]+e[n][o]&&(e[i][o]=e[i][n]+e[n][o]);return e},qT=(r,e)=>{const{nodes:t,edges:n}=r,i=[],o={};if(!t)throw new Error("invalid nodes data!");return t&&t.forEach((s,a)=>{o[s.id]=a;const l=[];i.push(l)}),n&&n.forEach(s=>{const a=Xr(s,"source"),l=Xr(s,"target"),c=o[a],u=o[l];i[c][u]=1,e||(i[u][c]=1)}),i},Z7=(r,e)=>{const t=[];return r.forEach(n=>{const i=[];n.forEach(o=>{i.push(o*e)}),t.push(i)}),t},JT=(r,e)=>{if(r&&r.children){for(let t=r.children.length-1;t>=0;t--)if(!JT(r.children[t],e))return}return!!e(r)},mb=(r,e)=>{typeof e=="function"&&JT(r,e)},xu=r=>typeof r=="function",Cu=new Map,qte=(r,e)=>{if(Cu.get(r)&&console.warn(`The layout with the name ${r} exists already, it will be overridden`),isObject(e)){class t extends Base{constructor(i){super();const o=this,s={},a=o.getDefaultCfg();Object.assign(s,a,e,i),Object.keys(s).forEach(l=>{const c=s[l];o[l]=c})}}Cu.set(r,t)}else Cu.set(r,e);return Cu.get(r)},Jte=r=>{Cu.has(r)&&Cu.delete(r)},Qte=r=>Cu.has(r)?Cu.get(r):null;class _s{constructor(){this.nodes=[],this.edges=[],this.combos=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=()=>{}}layout(e){return this.init(e),this.execute(!0)}init(e){this.nodes=e.nodes||[],this.edges=e.edges||[],this.combos=e.combos||[]}execute(e){}executeWithWorker(){}getDefaultCfg(){return{}}updateCfg(e){e&&Object.assign(this,e)}getType(){return"base"}destroy(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0}}class X7 extends _s{constructor(e){super();this.begin=[0,0],this.preventOverlap=!0,this.preventOverlapPadding=10,this.condense=!1,this.sortBy="degree",this.nodeSize=30,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.row=0,this.col=0,this.cellWidth=0,this.cellHeight=0,this.cellUsed={},this.id2manPos={},this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30}}execute(){const e=this,t=e.nodes,n=e.edges,i=t.length,o=e.begin;if(i===0)return e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n};if(i===1)return t[0].x=o[0],t[0].y=o[1],e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n};const s=[];t.forEach(u=>{s.push(u)});const a={};if(s.forEach((u,d)=>{a[u.id]=d}),(e.sortBy==="degree"||!M0(e.sortBy)||s[0][e.sortBy]===void 0)&&(e.sortBy="degree",gb(t[0].degree))){const u=O0(s.length,a,n);s.forEach((d,h)=>{d.degree=u[h]})}s.sort((u,d)=>d[e.sortBy]-u[e.sortBy]),!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight);const l=e.rows,c=e.cols!=null?e.cols:e.columns;if(e.cells=i,l!=null&&c!=null?(e.rows=l,e.cols=c):l!=null&&c==null?(e.rows=l,e.cols=Math.ceil(e.cells/e.rows)):l==null&&c!=null?(e.cols=c,e.rows=Math.ceil(e.cells/e.cols)):(e.splits=Math.sqrt(e.cells*e.height/e.width),e.rows=Math.round(e.splits),e.cols=Math.round(e.width/e.height*e.splits)),e.cols*e.rows>e.cells){const u=e.small(),d=e.large();(u-1)*d>=e.cells?e.small(u-1):(d-1)*u>=e.cells&&e.large(d-1)}else for(;e.cols*e.rows<e.cells;){const u=e.small(),d=e.large();(d+1)*u>=e.cells?e.large(d+1):e.small(u+1)}e.cellWidth=e.width/e.cols,e.cellHeight=e.height/e.rows,e.condense&&(e.cellWidth=0,e.cellHeight=0),e.preventOverlap&&s.forEach(u=>{(!u.x||!u.y)&&(u.x=0,u.y=0);let d,h;os(u.size)?(d=u.size[0],h=u.size[1]):un(u.size)?(d=u.size,h=u.size):xc(u.size)&&(d=u.size.width,h=u.size.height),(d===void 0||h===void 0)&&(os(e.nodeSize)?(d=e.nodeSize[0],h=e.nodeSize[1]):un(e.nodeSize)?(d=e.nodeSize,h=e.nodeSize):(d=30,h=30));const f=e.preventOverlapPadding,p=d+f,g=h+f;e.cellWidth=Math.max(e.cellWidth,p),e.cellHeight=Math.max(e.cellHeight,g)}),e.cellUsed={},e.row=0,e.col=0,e.id2manPos={};for(let u=0;u<s.length;u++){const d=s[u];let h;if(e.position&&(h=e.position(d)),h&&(h.row!==void 0||h.col!==void 0)){const f={row:h.row,col:h.col};if(f.col===void 0)for(f.col=0;e.used(f.row,f.col);)f.col++;else if(f.row===void 0)for(f.row=0;e.used(f.row,f.col);)f.row++;e.id2manPos[d.id]=f,e.use(f.row,f.col)}e.getPos(d)}return e.onLayoutEnd&&e.onLayoutEnd(),{edges:n,nodes:s}}small(e){const t=this;let n;const i=t.rows||5,o=t.cols||5;return e==null?n=Math.min(i,o):Math.min(i,o)===t.rows?t.rows=e:t.cols=e,n}large(e){const t=this;let n;const i=t.rows||5,o=t.cols||5;return e==null?n=Math.max(i,o):Math.max(i,o)===t.rows?t.rows=e:t.cols=e,n}used(e,t){return this.cellUsed[`c-${e}-${t}`]||!1}use(e,t){const n=this;n.cellUsed[`c-${e}-${t}`]=!0}moveToNextCell(){const e=this,t=e.cols||5;e.col++,e.col>=t&&(e.col=0,e.row++)}getPos(e){const t=this,n=t.begin,i=t.cellWidth,o=t.cellHeight;let s,a;const l=t.id2manPos[e.id];if(l)s=l.col*i+i/2+n[0],a=l.row*o+o/2+n[1];else{for(;t.used(t.row,t.col);)t.moveToNextCell();s=t.col*i+i/2+n[0],a=t.row*o+o/2+n[1],t.use(t.row,t.col),t.moveToNextCell()}e.x=s,e.y=a}getType(){return"grid"}}const Q1=(r,e)=>{let t;return r?un(r)?t=n=>r:t=r:t=n=>e||1,t};class Y7 extends _s{constructor(e){super();this.maxIteration=1e3,this.workerEnabled=!1,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.preventOverlap=!0,this.tick=()=>{},this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:500,gravity:10,enableTick:!0}}execute(){var e,t;const n=this,i=n.nodes;if(n.timeInterval!==void 0&&typeof window!="undefined"&&window.clearInterval(n.timeInterval),!i||i.length===0){(e=n.onLayoutEnd)===null||e===void 0||e.call(n);return}!n.width&&typeof window!="undefined"&&(n.width=window.innerWidth),!n.height&&typeof window!="undefined"&&(n.height=window.innerHeight),n.center||(n.center=[n.width/2,n.height/2]);const o=n.center;if(i.length===1){i[0].x=o[0],i[0].y=o[1],(t=n.onLayoutEnd)===null||t===void 0||t.call(n);return}const s={},a={};i.forEach((d,h)=>{un(d.x)||(d.x=Math.random()*n.width),un(d.y)||(d.y=Math.random()*n.height),s[d.id]=d,a[d.id]=h}),n.nodeMap=s,n.nodeIdxMap=a,n.linkDistance=Q1(n.linkDistance,1),n.nodeStrength=Q1(n.nodeStrength,1),n.edgeStrength=Q1(n.edgeStrength,1);const l=n.nodeSize;let c;if(n.preventOverlap){const d=n.nodeSpacing;let h;un(d)?h=()=>d:xu(d)?h=d:h=()=>0,l?os(l)?c=f=>(l[0]>l[1]?l[0]:l[1])+h(f):c=f=>l+h(f):c=f=>f.size?os(f.size)?(f.size[0]>f.size[1]?f.size[0]:f.size[1])+h(f):xc(f.size)?(f.size.width>f.size.height?f.size.width:f.size.height)+h(f):f.size+h(f):10+h(f)}n.nodeSize=c;const u=n.edges;n.degrees=O0(i.length,n.nodeIdxMap,u),n.getMass||(n.getMass=d=>n.degrees[n.nodeIdxMap[d.id]]||1),n.run()}run(){var e;const t=this,{maxIteration:n,nodes:i,workerEnabled:o,minMovement:s}=t;if(!!i)if(o){for(let a=0;a<n;a++){const l=t.runOneStep(a);if(t.reachMoveThreshold(i,l,s))break}(e=t.onLayoutEnd)===null||e===void 0||e.call(t)}else{if(typeof window=="undefined")return;let a=0;this.timeInterval=window.setInterval(()=>{var l,c;if(!i)return;const u=t.runOneStep(a)||[];t.reachMoveThreshold(i,u,s)&&((l=t.onLayoutEnd)===null||l===void 0||l.call(t),window.clearInterval(t.timeInterval)),a++,a>=n&&((c=t.onLayoutEnd)===null||c===void 0||c.call(t),window.clearInterval(t.timeInterval))},0)}}reachMoveThreshold(e,t,n){let i=0;return e.forEach((o,s)=>{const a=o.x-t[s].x,l=o.y-t[s].y;i+=Math.sqrt(a*a+l*l)}),i/=e.length,i<n}runOneStep(e){var t;const n=this,{nodes:i,edges:o}=n,s=[],a=[];if(!i)return;i.forEach((u,d)=>{s[2*d]=0,s[2*d+1]=0,a[2*d]=0,a[2*d+1]=0}),n.calRepulsive(s,i),o&&n.calAttractive(s,o),n.calGravity(s,i);const l=Math.max(.02,n.interval-e*.002);n.updateVelocity(s,a,l,i);const c=[];return i.forEach(u=>{c.push({x:u.x,y:u.y})}),n.updatePosition(a,l,i),(t=n.tick)===null||t===void 0||t.call(n),c}calRepulsive(e,t){const n=this,i=n.getMass,o=n.nodeStrength,s=n.factor,a=n.coulombDisScale,l=n.preventOverlap,c=n.nodeSize;t.forEach((u,d)=>{const h=i?i(u):1;t.forEach((f,p)=>{if(d>=p)return;const g=u.x-f.x,v=u.y-f.y,y=Math.sqrt(g*g+v*v)+.01,x=(y+.1)*a,E=g/y,T=v/y,P=(o(u)+o(f))/2*s/(x*x),z=i?i(f):1;if(e[2*d]+=E*P,e[2*d+1]+=T*P,e[2*p]-=E*P,e[2*p+1]-=T*P,l&&y<(c(u)+c(f))/2){const $=(o(u)+o(f))/2/(y*y);e[2*d]+=E*$/h,e[2*d+1]+=T*$/h,e[2*p]-=E*$/z,e[2*p+1]-=T*$/z}})})}calAttractive(e,t){const n=this,i=n.nodeMap,o=n.nodeIdxMap,s=n.linkDistance,a=n.edgeStrength,l=n.getMass;t.forEach((c,u)=>{const d=Xr(c,"source"),h=Xr(c,"target"),f=i[d],p=i[h],g=p.x-f.x,v=p.y-f.y,y=Math.sqrt(g*g+v*v)+.01,x=g/y,E=v/y,z=((s(c)||1)-y)*a(c),$=o[d],ne=o[h],De=l?l(f):1,fe=l?l(p):1;e[2*$]-=x*z/De,e[2*$+1]-=E*z/De,e[2*ne]+=x*z/fe,e[2*ne+1]+=E*z/fe})}calGravity(e,t){const n=this,i=n.center,o=n.gravity,s=n.degrees,a=t.length;for(let l=0;l<a;l++){const c=t[l];let u=c.x-i[0],d=c.y-i[1],h=o;if(n.getCenter){const f=n.getCenter(c,s[l]);f&&un(f[0])&&un(f[1])&&un(f[2])&&(u=c.x-f[0],d=c.y-f[1],h=f[2])}!h||(e[2*l]-=h*u,e[2*l+1]-=h*d)}}updateVelocity(e,t,n,i){const o=this,s=n*o.damping;i.forEach((a,l)=>{let c=e[2*l]*s||.01,u=e[2*l+1]*s||.01;const d=Math.sqrt(c*c+u*u);if(d>o.maxSpeed){const h=o.maxSpeed/d;c=h*c,u=h*u}t[2*l]=c,t[2*l+1]=u})}updatePosition(e,t,n){n.forEach((i,o)=>{if(un(i.fx)&&un(i.fy)){i.x=i.fx,i.y=i.fy;return}const s=e[2*o]*t,a=e[2*o+1]*t;i.x+=s,i.y+=a})}stop(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)}destroy(){const e=this;e.stop(),e.tick=null,e.nodes=null,e.edges=null,e.destroyed=!0}getType(){return"gForce"}}function K7(r){const e=+this._x.call(null,r),t=+this._y.call(null,r);return QT(this.cover(e,t),e,t,r)}function QT(r,e,t,n){if(isNaN(e)||isNaN(t))return r;var i,o=r._root,s={data:n},a=r._x0,l=r._y0,c=r._x1,u=r._y1,d,h,f,p,g,v,y,x;if(!o)return r._root=s,r;for(;o.length;)if((g=e>=(d=(a+c)/2))?a=d:c=d,(v=t>=(h=(l+u)/2))?l=h:u=h,i=o,!(o=o[y=v<<1|g]))return i[y]=s,r;if(f=+r._x.call(null,o.data),p=+r._y.call(null,o.data),e===f&&t===p)return s.next=o,i?i[y]=s:r._root=s,r;do i=i?i[y]=new Array(4):r._root=new Array(4),(g=e>=(d=(a+c)/2))?a=d:c=d,(v=t>=(h=(l+u)/2))?l=h:u=h;while((y=v<<1|g)==(x=(p>=h)<<1|f>=d));return i[x]=o,i[y]=s,r}function q7(r){var e,t,n=r.length,i,o,s=new Array(n),a=new Array(n),l=Infinity,c=Infinity,u=-Infinity,d=-Infinity;for(t=0;t<n;++t)isNaN(i=+this._x.call(null,e=r[t]))||isNaN(o=+this._y.call(null,e))||(s[t]=i,a[t]=o,i<l&&(l=i),i>u&&(u=i),o<c&&(c=o),o>d&&(d=o));if(l>u||c>d)return this;for(this.cover(l,c).cover(u,d),t=0;t<n;++t)QT(this,s[t],a[t],r[t]);return this}function J7(r,e){if(isNaN(r=+r)||isNaN(e=+e))return this;var t=this._x0,n=this._y0,i=this._x1,o=this._y1;if(isNaN(t))i=(t=Math.floor(r))+1,o=(n=Math.floor(e))+1;else{for(var s=i-t||1,a=this._root,l,c;t>r||r>=i||n>e||e>=o;)switch(c=(e<n)<<1|r<t,l=new Array(4),l[c]=a,a=l,s*=2,c){case 0:i=t+s,o=n+s;break;case 1:t=i-s,o=n+s;break;case 2:i=t+s,n=o-s;break;case 3:t=i-s,n=o-s;break}this._root&&this._root.length&&(this._root=a)}return this._x0=t,this._y0=n,this._x1=i,this._y1=o,this}function Q7(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function eV(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function As(r,e,t,n,i){this.node=r,this.x0=e,this.y0=t,this.x1=n,this.y1=i}function tV(r,e,t){var n,i=this._x0,o=this._y0,s,a,l,c,u=this._x1,d=this._y1,h=[],f=this._root,p,g;for(f&&h.push(new As(f,i,o,u,d)),t==null?t=Infinity:(i=r-t,o=e-t,u=r+t,d=e+t,t*=t);p=h.pop();)if(!(!(f=p.node)||(s=p.x0)>u||(a=p.y0)>d||(l=p.x1)<i||(c=p.y1)<o))if(f.length){var v=(s+l)/2,y=(a+c)/2;h.push(new As(f[3],v,y,l,c),new As(f[2],s,y,v,c),new As(f[1],v,a,l,y),new As(f[0],s,a,v,y)),(g=(e>=y)<<1|r>=v)&&(p=h[h.length-1],h[h.length-1]=h[h.length-1-g],h[h.length-1-g]=p)}else{var x=r-+this._x.call(null,f.data),E=e-+this._y.call(null,f.data),T=x*x+E*E;if(T<t){var P=Math.sqrt(t=T);i=r-P,o=e-P,u=r+P,d=e+P,n=f.data}}return n}function nV(r){if(isNaN(u=+this._x.call(null,r))||isNaN(d=+this._y.call(null,r)))return this;var e,t=this._root,n,i,o,s=this._x0,a=this._y0,l=this._x1,c=this._y1,u,d,h,f,p,g,v,y;if(!t)return this;if(t.length)for(;;){if((p=u>=(h=(s+l)/2))?s=h:l=h,(g=d>=(f=(a+c)/2))?a=f:c=f,e=t,!(t=t[v=g<<1|p]))return this;if(!t.length)break;(e[v+1&3]||e[v+2&3]||e[v+3&3])&&(n=e,y=v)}for(;t.data!==r;)if(i=t,!(t=t.next))return this;return(o=t.next)&&delete t.next,i?(o?i.next=o:delete i.next,this):e?(o?e[v]=o:delete e[v],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[y]=t:this._root=t),this):(this._root=o,this)}function rV(r){for(var e=0,t=r.length;e<t;++e)this.remove(r[e]);return this}function iV(){return this._root}function oV(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function sV(r){var e=[],t,n=this._root,i,o,s,a,l;for(n&&e.push(new As(n,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!r(n=t.node,o=t.x0,s=t.y0,a=t.x1,l=t.y1)&&n.length){var c=(o+a)/2,u=(s+l)/2;(i=n[3])&&e.push(new As(i,c,u,a,l)),(i=n[2])&&e.push(new As(i,o,u,c,l)),(i=n[1])&&e.push(new As(i,c,s,a,u)),(i=n[0])&&e.push(new As(i,o,s,c,u))}return this}function aV(r){var e=[],t=[],n;for(this._root&&e.push(new As(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var o,s=n.x0,a=n.y0,l=n.x1,c=n.y1,u=(s+l)/2,d=(a+c)/2;(o=i[0])&&e.push(new As(o,s,a,u,d)),(o=i[1])&&e.push(new As(o,u,a,l,d)),(o=i[2])&&e.push(new As(o,s,d,u,c)),(o=i[3])&&e.push(new As(o,u,d,l,c))}t.push(n)}for(;n=t.pop();)r(n.node,n.x0,n.y0,n.x1,n.y1);return this}function lV(r){return r[0]}function cV(r){return arguments.length?(this._x=r,this):this._x}function uV(r){return r[1]}function dV(r){return arguments.length?(this._y=r,this):this._y}function ew(r,e,t){var n=new tw(e==null?lV:e,t==null?uV:t,NaN,NaN,NaN,NaN);return r==null?n:n.addAll(r)}function tw(r,e,t,n,i,o){this._x=r,this._y=e,this._x0=t,this._y0=n,this._x1=i,this._y1=o,this._root=void 0}function eM(r){for(var e={data:r.data},t=e;r=r.next;)t=t.next={data:r.data};return e}var Ts=ew.prototype=tw.prototype;Ts.copy=function(){var r=new tw(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,n;if(!e)return r;if(!e.length)return r._root=eM(e),r;for(t=[{source:e,target:r._root=new Array(4)}];e=t.pop();)for(var i=0;i<4;++i)(n=e.source[i])&&(n.length?t.push({source:n,target:e.target[i]=new Array(4)}):e.target[i]=eM(n));return r},Ts.add=K7,Ts.addAll=q7,Ts.cover=J7,Ts.data=Q7,Ts.extent=eV,Ts.find=tV,Ts.remove=nV,Ts.removeAll=rV,Ts.root=iV,Ts.size=oV,Ts.visit=sV,Ts.visitAfter=aV,Ts.x=cV,Ts.y=dV;function Ms(r){return function(){return r}}function wu(r){return(r()-.5)*1e-6}var hV={value:function(){}};function tM(){for(var r=0,e=arguments.length,t={},n;r<e;++r){if(!(n=arguments[r]+"")||n in t||/[\s.]/.test(n))throw new Error("illegal type: "+n);t[n]=[]}return new vb(t)}function vb(r){this._=r}function fV(r,e){return r.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}vb.prototype=tM.prototype={constructor:vb,on:function(e,t){var n=this._,i=fV(e+"",n),o,s=-1,a=i.length;if(arguments.length<2){for(;++s<a;)if((o=(e=i[s]).type)&&(o=pV(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<a;)if(o=(e=i[s]).type)n[o]=nM(n[o],e.name,t);else if(t==null)for(o in n)n[o]=nM(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new vb(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),i=0,o,s;i<o;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],i=0,o=s.length;i<o;++i)s[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],o=0,s=i.length;o<s;++o)i[o].value.apply(t,n)}};function pV(r,e){for(var t=0,n=r.length,i;t<n;++t)if((i=r[t]).name===e)return i.value}function nM(r,e,t){for(var n=0,i=r.length;n<i;++n)if(r[n].name===e){r[n]=hV,r=r.slice(0,n).concat(r.slice(n+1));break}return t!=null&&r.push({name:e,value:t}),r}var gV=tM,Kf=0,D0=0,N0=0,rM=1e3,yb,R0,bb=0,Kd=0,xb=0,k0=typeof performance=="object"&&performance.now?performance:Date,iM=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function oM(){return Kd||(iM(mV),Kd=k0.now()+xb)}function mV(){Kd=0}function nw(){this._call=this._time=this._next=null}nw.prototype=sM.prototype={constructor:nw,restart:function(r,e,t){if(typeof r!="function")throw new TypeError("callback is not a function");t=(t==null?oM():+t)+(e==null?0:+e),!this._next&&R0!==this&&(R0?R0._next=this:yb=this,R0=this),this._call=r,this._time=t,rw()},stop:function(){this._call&&(this._call=null,this._time=Infinity,rw())}};function sM(r,e,t){var n=new nw;return n.restart(r,e,t),n}function vV(){oM(),++Kf;for(var r=yb,e;r;)(e=Kd-r._time)>=0&&r._call.call(null,e),r=r._next;--Kf}function aM(){Kd=(bb=k0.now())+xb,Kf=D0=0;try{vV()}finally{Kf=0,bV(),Kd=0}}function yV(){var r=k0.now(),e=r-bb;e>rM&&(xb-=e,bb=r)}function bV(){for(var r,e=yb,t,n=Infinity;e;)e._call?(n>e._time&&(n=e._time),r=e,e=e._next):(t=e._next,e._next=null,e=r?r._next=t:yb=t);R0=r,rw(n)}function rw(r){if(!Kf){D0&&(D0=clearTimeout(D0));var e=r-Kd;e>24?(r<Infinity&&(D0=setTimeout(aM,r-k0.now()-xb)),N0&&(N0=clearInterval(N0))):(N0||(bb=k0.now(),N0=setInterval(yV,rM)),Kf=1,iM(aM))}}var xV=1664525,CV=1013904223,lM=4294967296;function wV(){var r=1;return function(){return(r=(xV*r+CV)%lM)/lM}}function EV(r){return r.x}function SV(r){return r.y}var _V=10,AV=Math.PI*(3-Math.sqrt(5));function iw(r){var e,t=1,n=.001,i=1-Math.pow(n,1/300),o=0,s=.6,a=new Map,l=sM(d),c=gV("tick","end"),u=wV();r==null&&(r=[]);function d(){h(),c.call("tick",e),t<n&&(l.stop(),c.call("end",e))}function h(g){var v,y=r.length,x;g===void 0&&(g=1);for(var E=0;E<g;++E)for(t+=(o-t)*i,a.forEach(function(T){T(t)}),v=0;v<y;++v)x=r[v],x.fx==null?x.x+=x.vx*=s:(x.x=x.fx,x.vx=0),x.fy==null?x.y+=x.vy*=s:(x.y=x.fy,x.vy=0);return e}function f(){for(var g=0,v=r.length,y;g<v;++g){if(y=r[g],y.index=g,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var x=_V*Math.sqrt(.5+g),E=g*AV;y.x=x*Math.cos(E),y.y=x*Math.sin(E)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function p(g){return g.initialize&&g.initialize(r,u),g}return f(),e={tick:h,restart:function(){return l.restart(d),e},stop:function(){return l.stop(),e},nodes:function(v){return arguments.length?(r=v,f(),a.forEach(p),e):r},alpha:function(v){return arguments.length?(t=+v,e):t},alphaMin:function(v){return arguments.length?(n=+v,e):n},alphaDecay:function(v){return arguments.length?(i=+v,e):+i},alphaTarget:function(v){return arguments.length?(o=+v,e):o},velocityDecay:function(v){return arguments.length?(s=1-v,e):1-s},randomSource:function(v){return arguments.length?(u=v,a.forEach(p),e):u},force:function(v,y){return arguments.length>1?(y==null?a.delete(v):a.set(v,p(y)),e):a.get(v)},find:function(v,y,x){var E=0,T=r.length,P,z,$,ne,De;for(x==null?x=Infinity:x*=x,E=0;E<T;++E)ne=r[E],P=v-ne.x,z=y-ne.y,$=P*P+z*z,$<x&&(De=ne,x=$);return De},on:function(v,y){return arguments.length>1?(c.on(v,y),e):c.on(v)}}}function ow(){var r,e,t,n,i=Ms(-30),o,s=1,a=Infinity,l=.81;function c(f){var p,g=r.length,v=ew(r,EV,SV).visitAfter(d);for(n=f,p=0;p<g;++p)e=r[p],v.visit(h)}function u(){if(!!r){var f,p=r.length,g;for(o=new Array(p),f=0;f<p;++f)g=r[f],o[g.index]=+i(g,f,r)}}function d(f){var p=0,g,v,y=0,x,E,T;if(f.length){for(x=E=T=0;T<4;++T)(g=f[T])&&(v=Math.abs(g.value))&&(p+=g.value,y+=v,x+=v*g.x,E+=v*g.y);f.x=x/y,f.y=E/y}else{g=f,g.x=g.data.x,g.y=g.data.y;do p+=o[g.data.index];while(g=g.next)}f.value=p}function h(f,p,g,v){if(!f.value)return!0;var y=f.x-e.x,x=f.y-e.y,E=v-p,T=y*y+x*x;if(E*E/l<T)return T<a&&(y===0&&(y=wu(t),T+=y*y),x===0&&(x=wu(t),T+=x*x),T<s&&(T=Math.sqrt(s*T)),e.vx+=y*f.value*n/T,e.vy+=x*f.value*n/T),!0;if(f.length||T>=a)return;(f.data!==e||f.next)&&(y===0&&(y=wu(t),T+=y*y),x===0&&(x=wu(t),T+=x*x),T<s&&(T=Math.sqrt(s*T)));do f.data!==e&&(E=o[f.data.index]*n/T,e.vx+=y*E,e.vy+=x*E);while(f=f.next)}return c.initialize=function(f,p){r=f,t=p,u()},c.strength=function(f){return arguments.length?(i=typeof f=="function"?f:Ms(+f),u(),c):i},c.distanceMin=function(f){return arguments.length?(s=f*f,c):Math.sqrt(s)},c.distanceMax=function(f){return arguments.length?(a=f*f,c):Math.sqrt(a)},c.theta=function(f){return arguments.length?(l=f*f,c):Math.sqrt(l)},c}function cM(r,e){var t,n=1;r==null&&(r=0),e==null&&(e=0);function i(){var o,s=t.length,a,l=0,c=0;for(o=0;o<s;++o)a=t[o],l+=a.x,c+=a.y;for(l=(l/s-r)*n,c=(c/s-e)*n,o=0;o<s;++o)a=t[o],a.x-=l,a.y-=c}return i.initialize=function(o){t=o},i.x=function(o){return arguments.length?(r=+o,i):r},i.y=function(o){return arguments.length?(e=+o,i):e},i.strength=function(o){return arguments.length?(n=+o,i):n},i}function TV(r){return r.index}function uM(r,e){var t=r.get(e);if(!t)throw new Error("node not found: "+e);return t}function Cb(r){var e=TV,t=d,n,i=Ms(30),o,s,a,l,c,u=1;r==null&&(r=[]);function d(v){return 1/Math.min(a[v.source.index],a[v.target.index])}function h(v){for(var y=0,x=r.length;y<u;++y)for(var E=0,T,P,z,$,ne,De,fe;E<x;++E)T=r[E],P=T.source,z=T.target,$=z.x+z.vx-P.x-P.vx||wu(c),ne=z.y+z.vy-P.y-P.vy||wu(c),De=Math.sqrt($*$+ne*ne),De=(De-o[E])/De*v*n[E],$*=De,ne*=De,z.vx-=$*(fe=l[E]),z.vy-=ne*fe,P.vx+=$*(fe=1-fe),P.vy+=ne*fe}function f(){if(!!s){var v,y=s.length,x=r.length,E=new Map(s.map(function(P,z){return[e(P,z,s),P]})),T;for(v=0,a=new Array(y);v<x;++v)T=r[v],T.index=v,typeof T.source!="object"&&(T.source=uM(E,T.source)),typeof T.target!="object"&&(T.target=uM(E,T.target)),a[T.source.index]=(a[T.source.index]||0)+1,a[T.target.index]=(a[T.target.index]||0)+1;for(v=0,l=new Array(x);v<x;++v)T=r[v],l[v]=a[T.source.index]/(a[T.source.index]+a[T.target.index]);n=new Array(x),p(),o=new Array(x),g()}}function p(){if(!!s)for(var v=0,y=r.length;v<y;++v)n[v]=+t(r[v],v,r)}function g(){if(!!s)for(var v=0,y=r.length;v<y;++v)o[v]=+i(r[v],v,r)}return h.initialize=function(v,y){s=v,c=y,f()},h.links=function(v){return arguments.length?(r=v,f(),h):r},h.id=function(v){return arguments.length?(e=v,h):e},h.iterations=function(v){return arguments.length?(u=+v,h):u},h.strength=function(v){return arguments.length?(t=typeof v=="function"?v:Ms(+v),p(),h):t},h.distance=function(v){return arguments.length?(i=typeof v=="function"?v:Ms(+v),g(),h):i},h}function MV(r){return r.x+r.vx}function PV(r){return r.y+r.vy}function dM(r){var e,t,n,i=1,o=1;typeof r!="function"&&(r=Ms(r==null?1:+r));function s(){for(var c,u=e.length,d,h,f,p,g,v,y=0;y<o;++y)for(d=ew(e,MV,PV).visitAfter(a),c=0;c<u;++c)h=e[c],g=t[h.index],v=g*g,f=h.x+h.vx,p=h.y+h.vy,d.visit(x);function x(E,T,P,z,$){var ne=E.data,De=E.r,fe=g+De;if(ne){if(ne.index>h.index){var Ae=f-ne.x-ne.vx,de=p-ne.y-ne.vy,ct=Ae*Ae+de*de;ct<fe*fe&&(Ae===0&&(Ae=wu(n),ct+=Ae*Ae),de===0&&(de=wu(n),ct+=de*de),ct=(fe-(ct=Math.sqrt(ct)))/ct*i,h.vx+=(Ae*=ct)*(fe=(De*=De)/(v+De)),h.vy+=(de*=ct)*fe,ne.vx-=Ae*(fe=1-fe),ne.vy-=de*fe)}return}return T>f+fe||z<f-fe||P>p+fe||$<p-fe}}function a(c){if(c.data)return c.r=t[c.data.index];for(var u=c.r=0;u<4;++u)c[u]&&c[u].r>c.r&&(c.r=c[u].r)}function l(){if(!!e){var c,u=e.length,d;for(t=new Array(u),c=0;c<u;++c)d=e[c],t[d.index]=+r(d,c,e)}}return s.initialize=function(c,u){e=c,n=u,l()},s.iterations=function(c){return arguments.length?(o=+c,s):o},s.strength=function(c){return arguments.length?(i=+c,s):i},s.radius=function(c){return arguments.length?(r=typeof c=="function"?c:Ms(+c),l(),s):r},s}function hM(r){var e=Ms(.1),t,n,i;typeof r!="function"&&(r=Ms(r==null?0:+r));function o(a){for(var l=0,c=t.length,u;l<c;++l)u=t[l],u.vx+=(i[l]-u.x)*n[l]*a}function s(){if(!!t){var a,l=t.length;for(n=new Array(l),i=new Array(l),a=0;a<l;++a)n[a]=isNaN(i[a]=+r(t[a],a,t))?0:+e(t[a],a,t)}}return o.initialize=function(a){t=a,s()},o.strength=function(a){return arguments.length?(e=typeof a=="function"?a:Ms(+a),s(),o):e},o.x=function(a){return arguments.length?(r=typeof a=="function"?a:Ms(+a),s(),o):r},o}function fM(r){var e=Ms(.1),t,n,i;typeof r!="function"&&(r=Ms(r==null?0:+r));function o(a){for(var l=0,c=t.length,u;l<c;++l)u=t[l],u.vy+=(i[l]-u.y)*n[l]*a}function s(){if(!!t){var a,l=t.length;for(n=new Array(l),i=new Array(l),a=0;a<l;++a)n[a]=isNaN(i[a]=+r(t[a],a,t))?0:+e(t[a],a,t)}}return o.initialize=function(a){t=a,s()},o.strength=function(a){return arguments.length?(e=typeof a=="function"?a:Ms(+a),s(),o):e},o.y=function(a){return arguments.length?(r=typeof a=="function"?a:Ms(+a),s(),o):r},o}function OV(){function r(Nt){return()=>Nt}let e=Nt=>Nt.cluster,t=r(1),n=r(-1),i=r(100),o=r(.1),s=[0,0],a=[],l={},c=[],u=100,d=100,h={none:{x:0,y:0}},f=[],p,g="force",v=!0,y=.1;function x(Nt){if(!v)return x;p.tick(),ne();for(let fn=0,Kn=a.length,Pn,vr=Nt*y;fn<Kn;++fn)Pn=a[fn],Pn.vx+=(h[e(Pn)].x-Pn.x)*vr,Pn.vy+=(h[e(Pn)].y-Pn.y)*vr}function E(){!a||T()}function T(){if(!a||!a.length)return;if(e(a[0])===void 0)throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInABox.groupBy('clusterAttr') before calling .links()");const Nt=P();p=iw(Nt.nodes).force("x",hM(u).strength(.1)).force("y",fM(d).strength(.1)).force("collide",dM(fn=>fn.r).iterations(4)).force("charge",ow().strength(n)).force("links",Cb(Nt.nodes.length?Nt.links:[]).distance(i).strength(o)),f=p.nodes(),ne()}function P(){const Nt=[],fn=[],Kn={};let Pn=[],vr={},Gn=[];return vr=z(a),Gn=$(c),Pn=Object.keys(vr),Pn.forEach((ci,Bo)=>{const ui=vr[ci];Nt.push({id:ci,size:ui.count,r:Math.sqrt(ui.sumforceNodeSize/Math.PI)}),Kn[ci]=Bo}),Gn.forEach(ci=>{const Bo=Xr(ci,"source"),ui=Xr(ci,"target"),Aa=Kn[Bo],Ta=Kn[ui];Aa!==void 0&&Ta!==void 0&&fn.push({source:Aa,target:Ta,count:ci.count})}),{nodes:Nt,links:fn}}function z(Nt){const fn={};return Nt.forEach(Kn=>{const Pn=e(Kn);fn[Pn]||(fn[Pn]={count:0,sumforceNodeSize:0})}),Nt.forEach(Kn=>{const Pn=e(Kn),vr=t(Kn),Gn=fn[Pn];Gn.count=Gn.count+1,Gn.sumforceNodeSize=Gn.sumforceNodeSize+Math.PI*(vr*vr)*1.3,fn[Pn]=Gn}),fn}function $(Nt){const fn={},Kn=[];return Nt.forEach(vr=>{const Gn=De(vr);let ci=0;fn[Gn]!==void 0&&(ci=fn[Gn]),ci+=1,fn[Gn]=ci}),Object.entries(fn).forEach(([vr,Gn])=>{const ci=vr.split("~")[0],Bo=vr.split("~")[1];ci!==void 0&&Bo!==void 0&&Kn.push({source:ci,target:Bo,count:Gn})}),Kn}function ne(){return h={none:{x:0,y:0}},f.forEach(Nt=>{h[Nt.id]={x:Nt.x-s[0],y:Nt.y-s[1]}}),h}function De(Nt){const fn=Xr(Nt,"source"),Kn=Xr(Nt,"target"),Pn=e(l[fn]),vr=e(l[Kn]);return Pn<=vr?`${Pn}~${vr}`:`${vr}~${Pn}`}function fe(Nt){l={},Nt.forEach(fn=>{l[fn.id]=fn})}function Ae(Nt){return arguments.length?(g=Nt,E(),x):g}function de(Nt){return arguments.length?typeof Nt=="string"?(e=fn=>fn[Nt],x):(e=Nt,x):e}function ct(Nt){return arguments.length?(v=Nt,x):v}function bt(Nt){return arguments.length?(y=Nt,x):y}function Pe(Nt){return arguments.length?(u=Nt,x):u}function tt(Nt){return arguments.length?(d=Nt,x):d}function Kt(Nt){return arguments.length?(fe(Nt||[]),a=Nt||[],x):a}function tn(Nt){return arguments.length?(c=Nt||[],E(),x):c}function Bn(Nt){return arguments.length?(typeof Nt=="function"?t=Nt:t=r(+Nt),E(),x):t}function cr(Nt){return arguments.length?(typeof Nt=="function"?n=Nt:n=r(+Nt),E(),x):n}function gn(Nt){return arguments.length?(typeof Nt=="function"?i=Nt:i=r(+Nt),E(),x):i}function si(Nt){return arguments.length?(typeof Nt=="function"?o=Nt:o=r(+Nt),E(),x):o}function xi(Nt){return arguments.length?(s=Nt,x):s}return x.initialize=Nt=>{a=Nt,E()},x.template=Ae,x.groupBy=de,x.enableGrouping=ct,x.strength=bt,x.centerX=Pe,x.centerY=tt,x.nodes=Kt,x.links=tn,x.forceNodeSize=Bn,x.nodeSize=x.forceNodeSize,x.forceCharge=cr,x.forceLinkDistance=gn,x.forceLinkStrength=si,x.offset=xi,x.getFocis=ne,x}const sw={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"};class DV extends _s{constructor(e){super();this.center=[0,0],this.nodeStrength=null,this.edgeStrength=null,this.preventOverlap=!1,this.clusterNodeStrength=null,this.clusterEdgeStrength=null,this.clusterEdgeDistance=null,this.clusterNodeSize=null,this.clusterFociStrength=null,this.linkDistance=50,this.alphaDecay=.028,this.alphaMin=.001,this.alpha=.3,this.collideStrength=1,this.workerEnabled=!1,this.tick=()=>{},this.onLayoutEnd=()=>{},this.ticking=void 0,e&&this.updateCfg(e)}getDefaultCfg(){return{center:[0,0],nodeStrength:null,edgeStrength:null,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10,tick(){},onLayoutEnd(){},workerEnabled:!1}}init(e){const t=this;t.nodes=e.nodes||[];const n=e.edges||[];t.edges=n.map(i=>{const o={},s=["targetNode","sourceNode","startPoint","endPoint"];return Object.keys(i).forEach(a=>{s.indexOf(a)>-1||(o[a]=i[a])}),o}),t.ticking=!1}execute(e){const t=this,n=t.nodes,i=t.edges;if(t.ticking)return;let o=t.forceSimulation;const s=t.alphaMin,a=t.alphaDecay,l=t.alpha;if(o){if(e){if(t.clustering&&t.clusterForce&&(t.clusterForce.nodes(n),t.clusterForce.links(i)),o.nodes(n),i&&t.edgeForce)t.edgeForce.links(i);else if(i&&!t.edgeForce){const c=Cb().id(u=>u.id).links(i);t.edgeStrength&&c.strength(t.edgeStrength),t.linkDistance&&c.distance(t.linkDistance),t.edgeForce=c,o.force("link",c)}}t.preventOverlap&&t.overlapProcess(o),o.alpha(l).restart(),this.ticking=!0}else try{const c=ow();if(t.nodeStrength&&c.strength(t.nodeStrength),o=iw().nodes(n),t.clustering){const u=OV();u.centerX(t.center[0]).centerY(t.center[1]).template("force").strength(t.clusterFociStrength),i&&u.links(i),n&&u.nodes(n),u.forceLinkDistance(t.clusterEdgeDistance).forceLinkStrength(t.clusterEdgeStrength).forceCharge(t.clusterNodeStrength).forceNodeSize(t.clusterNodeSize),t.clusterForce=u,o.force("group",u)}if(o.force("center",cM(t.center[0],t.center[1])).force("charge",c).alpha(l).alphaDecay(a).alphaMin(s),t.preventOverlap&&t.overlapProcess(o),i){const u=Cb().id(d=>d.id).links(i);t.edgeStrength&&u.strength(t.edgeStrength),t.linkDistance&&u.distance(t.linkDistance),t.edgeForce=u,o.force("link",u)}if(t.workerEnabled&&!RV()&&(t.workerEnabled=!1,console.warn("workerEnabled option is only supported when running in web worker.")),!t.workerEnabled)o.on("tick",()=>{t.tick()}).on("end",()=>{t.ticking=!1,t.onLayoutEnd&&t.onLayoutEnd()}),t.ticking=!0;else{o.stop();const u=NV(o);for(let d=1;d<=u;d++)o.tick(),postMessage({nodes:n,currentTick:d,totalTicks:u,type:sw.TICK},void 0);t.ticking=!1}t.forceSimulation=o,t.ticking=!0}catch(c){t.ticking=!1,console.warn(c)}}overlapProcess(e){const t=this,n=t.nodeSize,i=t.nodeSpacing;let o,s;const a=t.collideStrength;if(un(i)?s=()=>i:xu(i)?s=i:s=()=>0,!n)o=l=>l.size?os(l.size)?(l.size[0]>l.size[1]?l.size[0]:l.size[1])/2+s(l):xc(l.size)?(l.size.width>l.size.height?l.size.width:l.size.height)/2+s(l):l.size/2+s(l):10+s(l);else if(xu(n))o=l=>n(l)+s(l);else if(os(n)){const c=(n[0]>n[1]?n[0]:n[1])/2;o=u=>c+s(u)}else if(un(n)){const l=n/2;o=c=>l+s(c)}else o=()=>10;e.force("collisionForce",dM(o).strength(a))}updateCfg(e){const t=this;t.ticking&&(t.forceSimulation.stop(),t.ticking=!1),t.forceSimulation=null,Object.assign(t,e)}destroy(){const e=this;e.ticking&&(e.forceSimulation.stop(),e.ticking=!1),e.nodes=null,e.edges=null,e.destroyed=!0}}function NV(r){const e=r.alphaMin(),t=r.alphaTarget(),n=r.alpha(),i=Math.log((e-t)/(n-t))/Math.log(1-r.alphaDecay());return Math.ceil(i)}function RV(){return typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope}function kV(r,e,t,n){r.forEach((i,o)=>{r[o].children=[],r[o].parent=[]}),n?e.forEach(i=>{const o=Xr(i,"source"),s=Xr(i,"target");let a=0;o&&(a=t[o]);let l=0;s&&(l=t[s]);const c=r[a].children,u=r[l].parent;c.push(r[l].id),u.push(r[a].id)}):e.forEach(i=>{const o=Xr(i,"source"),s=Xr(i,"target");let a=0;o&&(a=t[o]);let l=0;s&&(l=t[s]);const c=r[a].children,u=r[l].children;c.push(r[l].id),u.push(r[a].id)})}function IV(r,e,t){const n=t.length;for(let i=0;i<n;i++){const o=Xr(t[i],"source"),s=Xr(t[i],"target");if(r.id===o&&e.id===s||e.id===o&&r.id===s)return!0}return!1}function LV(r,e){const t=r.degree,n=e.degree;return t<n?-1:t>n?1:0}class GV extends _s{constructor(e){super();this.radius=null,this.startRadius=null,this.endRadius=null,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.divisions=1,this.ordering=null,this.angleRatio=1,this.nodes=[],this.edges=[],this.nodeMap={},this.degrees=[],this.width=300,this.height=300,this.updateCfg(e)}getDefaultCfg(){return{radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1}}execute(){const e=this,t=e.nodes,n=e.edges,i=t.length;if(i===0){e.onLayoutEnd&&e.onLayoutEnd();return}!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const o=e.center;if(i===1){t[0].x=o[0],t[0].y=o[1],e.onLayoutEnd&&e.onLayoutEnd();return}let s=e.radius,a=e.startRadius,l=e.endRadius;const c=e.divisions,u=e.startAngle,d=e.endAngle,h=(d-u)/i,f={};t.forEach((P,z)=>{f[P.id]=z}),e.nodeMap=f;const p=O0(t.length,f,n);e.degrees=p,!s&&!a&&!l?s=e.height>e.width?e.width/2:e.height/2:!a&&l?a=l:a&&!l&&(l=a);const g=e.angleRatio,v=h*g,y=e.ordering;let x=[];y==="topology"?x=e.topologyOrdering():y==="topology-directed"?x=e.topologyOrdering(!0):y==="degree"?x=e.degreeOrdering():x=t;const E=e.clockwise,T=Math.ceil(i/c);for(let P=0;P<i;++P){let z=s;!z&&a!==null&&l!==null&&(z=a+P*(l-a)/(i-1)),z||(z=10+P*100/(i-1));let $=u+P%T*v+2*Math.PI/c*Math.floor(P/T);E||($=d-P%T*v-2*Math.PI/c*Math.floor(P/T)),x[P].x=o[0]+Math.cos($)*z,x[P].y=o[1]+Math.sin($)*z,x[P].weight=p[P]}return e.onLayoutEnd&&e.onLayoutEnd(),{nodes:x,edges:this.edges}}topologyOrdering(e=!1){const t=this,n=t.degrees,i=t.edges,o=t.nodes,s=P0(o),a=t.nodeMap,l=[s[0]],c=[o[0]],u=[],d=o.length;u[0]=!0,kV(s,i,a,e);let h=0;return s.forEach((f,p)=>{if(p!==0)if((p===d-1||n[p]!==n[p+1]||IV(l[h],f,i))&&!u[p])l.push(f),c.push(o[a[f.id]]),u[p]=!0,h++;else{const g=l[h].children;let v=!1;for(let x=0;x<g.length;x++){const E=a[g[x]];if(n[E]===n[p]&&!u[E]){l.push(s[E]),c.push(o[a[s[E].id]]),u[E]=!0,v=!0;break}}let y=0;for(;!v&&(u[y]||(l.push(s[y]),c.push(o[a[s[y].id]]),u[y]=!0,v=!0),y++,y!==d););}}),c}degreeOrdering(){const e=this,t=e.nodes,n=[],i=e.degrees;return t.forEach((o,s)=>{o.degree=i[s],n.push(o)}),n.sort(LV),n}getType(){return"circular"}}var FV=w(85788),BV=w.n(FV);let aw=BV();!aw&&typeof window!="undefined"&&(aw=window.graphlib),Array.prototype.flat||(Array.prototype.flat=function(r){let e=r||1;if(!isFinite(e))return;const t=this.length;let n=[];if(this.length===0)return this;for(;e--;){const i=[];let o=!1;if(n.length===0){o=!0;for(let s=0;s<t;s++)this[s]instanceof Array?n.push(...this[s]):n.push(this[s])}else{for(let s=0;s<n.length;s++)n[s]instanceof Array?(o=!0,i.push(...n[s])):i.push(n[s]);n=i}if(!o&&e===Infinity)break}return n});var Cc=aw;const pM=r=>{r._prev._next=r._next,r._next._prev=r._prev,delete r._next,delete r._prev},zV=(r,e)=>{if(r!=="_next"&&r!=="_prev")return e};class UV{constructor(){const e={};e._next=e._prev=e,this.isentinel=e}dequeue(){const e=this.isentinel,t=e._prev;if(t!==e)return pM(t),t}enqueue(){const e=this.isentinel,t=e._prev;if(t!==e)return pM(t),t}toString(){const e=[],t=this.isentinel;let n=t._prev;for(;n!==t;)e.push(JSON.stringify(n,zV)),n=n._prev;return`[${e.join(", ")}]`}}var VV=UV;const jV=Cc.Graph,HV=()=>1,$V=(r,e)=>{var t;if(r.nodeCount()<=1)return[];const n=ZV(r,e||HV);return(t=WV(n.graph,n.buckets,n.zeroIdx).map(o=>r.outEdges(o.v,o.w)))===null||t===void 0?void 0:t.flat()},WV=(r,e,t)=>{let n=[];const i=e[e.length-1],o=e[0];let s;for(;r.nodeCount();){for(;s=o.dequeue();)lw(r,e,t,s);for(;s=i.dequeue();)lw(r,e,t,s);if(r.nodeCount()){for(let a=e.length-2;a>0;--a)if(s=e[a].dequeue(),s){n=n.concat(lw(r,e,t,s,!0));break}}}return n},lw=(r,e,t,n,i)=>{var o,s;const a=i?[]:void 0;return(o=r.inEdges(n.v))===null||o===void 0||o.forEach(l=>{const c=r.edge(l),u=r.node(l.v);i&&a.push({v:l.v,w:l.w}),u.out===void 0&&(u.out=0),u.out-=c,cw(e,t,u)}),(s=r.outEdges(n.v))===null||s===void 0||s.forEach(l=>{const c=r.edge(l),u=l.w,d=r.node(u);d.in===void 0&&(d.in=0),d.in-=c,cw(e,t,d)}),r.removeNode(n.v),a},ZV=(r,e)=>{const t=new jV;let n=0,i=0;r.nodes().forEach(l=>{t.setNode(l,{v:l,in:0,out:0})}),r.edges().forEach(l=>{const c=t.edge(l.v,l.w)||0,u=e==null?void 0:e(l),d=c+u;t.setEdge(l.v,l.w,d),i=Math.max(i,t.node(l.v).out+=u),n=Math.max(n,t.node(l.w).in+=u)});const o=[],s=i+n+3;for(let l=0;l<s;l++)o.push(new VV);const a=n+1;return t.nodes().forEach(l=>{cw(o,a,t.node(l))}),{buckets:o,zeroIdx:a,graph:t}},cw=(r,e,t)=>{t.out?t.in?r[t.out-t.in+e].enqueue(t):r[r.length-1].enqueue(t):r[0].enqueue(t)};var XV=$V;const YV=r=>{const e=n=>i=>n.edge(i).weight,t=r.graph().acyclicer==="greedy"?XV(r,e(r)):KV(r);t==null||t.forEach(n=>{const i=r.edge(n);r.removeEdge(n),i.forwardName=n.name,i.reversed=!0,r.setEdge(n.w,n.v,i,`rev-${Math.random()}`)})},KV=r=>{const e=[],t={},n={},i=o=>{var s;n.hasOwnProperty(o)||(n[o]=!0,t[o]=!0,(s=r.outEdges(o))===null||s===void 0||s.forEach(a=>{t.hasOwnProperty(a.w)?e.push(a):i(a.w)}),delete t[o])};return r.nodes().forEach(i),e};var gM={run:YV,undo:r=>{r.edges().forEach(e=>{const t=r.edge(e);if(t.reversed){r.removeEdge(e);const n=t.forwardName;delete t.reversed,delete t.forwardName,r.setEdge(e.w,e.v,t,n)}})}};const mM=Cc.Graph,vM=(r,e,t,n)=>{let i;do i=`${n}${Math.random()}`;while(r.hasNode(i));return t.dummy=e,r.setNode(i,t),i},yM=r=>{const e=new mM().setGraph(r.graph());return r.nodes().forEach(t=>{e.setNode(t,r.node(t))}),r.edges().forEach(t=>{const n=e.edge(t.v,t.w)||{weight:0,minlen:1},i=r.edge(t);e.setEdge(t.v,t.w,{weight:n.weight+i.weight,minlen:Math.max(n.minlen,i.minlen)})}),e},qV=r=>{const e=new mM({multigraph:r.isMultigraph()}).setGraph(r.graph());return r.nodes().forEach(t=>{var n;((n=r.children(t))===null||n===void 0?void 0:n.length)||e.setNode(t,r.node(t))}),r.edges().forEach(t=>e.setEdge(t,r.edge(t))),e},wb=(r,e)=>{const t={};return r==null||r.forEach((n,i)=>{t[n]=e[i]}),t},JV=r=>{const e=r.nodes().map(t=>{var n;const i={};return(n=r.outEdges(t))===null||n===void 0||n.forEach(o=>{i[o.w]=(i[o.w]||0)+r.edge(o).weight}),i});return wb(r.nodes(),e)},QV=r=>{const e=r.nodes().map(t=>{var n;const i={};return(n=r.inEdges(t))===null||n===void 0||n.forEach(o=>{i[o.v]=(i[o.v]||0)+r.edge(o).weight}),i});return wb(r.nodes(),e)},e9=(r,e)=>{const t=r.x,n=r.y,i=e.x-t,o=e.y-n;let s=r.width/2,a=r.height/2;if(!i&&!o)return{x:0,y:0};let l,c;return Math.abs(o)*s>Math.abs(i)*a?(o<0&&(a=-a),l=a*i/o,c=a):(i<0&&(s=-s),l=s,c=s*o/i),{x:t+l,y:n+c}},t9=r=>{const e=[],t=[],n=CM(r)+1;for(let i=0;i<n;i++)e.push([]),t.push([]);return r.nodes().forEach(i=>{const s=r.node(i).rank;s!==void 0&&e[s]&&t[s].push(i)}),t==null||t.forEach((i,o)=>{i==null||i.sort((s,a)=>{var l,c;return((l=r.node(s))===null||l===void 0?void 0:l.order)-((c=r.node(a))===null||c===void 0?void 0:c.order)}),i.forEach(s=>{e[o].push(s)})}),e},bM=r=>{const e=r.nodes().filter(n=>r.node(n).rank!==void 0).map(n=>r.node(n).rank),t=Math.min(...e);r.nodes().forEach(n=>{const i=r.node(n);i.hasOwnProperty("rank")&&(i.rank||(i.rank=0),i.rank-=t)})},xM=r=>{const e=r.nodes().filter(s=>r.node(s).rank!==void 0).map(s=>r.node(s).rank),t=Math.min(...e),n=[];r.nodes().forEach(s=>{var a;const l=(((a=r.node(s))===null||a===void 0?void 0:a.rank)||0)-t;n[l]||(n[l]=[]),n[l].push(s)});let i=0;const o=r.graph().nodeRankFactor||0;for(let s=0;s<n.length;s++){const a=n[s];a===void 0&&s%o!=0?--i:i&&(a==null||a.forEach(l=>{r.node(l).rank||(r.node(l).rank=0),r.node(l).rank+=i}))}},n9=(r,e,t,n)=>{const i={width:0,height:0};return un(t)&&un(n)&&(i.rank=t,i.order=n),vM(r,"border",i,e)},CM=r=>{const e=r.nodes().map(t=>{const n=r.node(t).rank;return n!==void 0?n:-Infinity});return Math.max(...e)},r9=(r,e)=>{const t={lhs:[],rhs:[]};return r==null||r.forEach(n=>{e(n)?t.lhs.push(n):t.rhs.push(n)}),t},wM=(r,e)=>{const t=Date.now();try{return e()}finally{console.log(`${r} time: ${Date.now()-t}ms`)}},EM=(r,e)=>e(),uw=(r,e)=>{let t=Infinity,n;return r==null||r.forEach(i=>{const o=e(i);t>o&&(t=o,n=i)}),n};var lo={addDummyNode:vM,simplify:yM,asNonCompoundGraph:qV,successorWeights:JV,predecessorWeights:QV,intersectRect:e9,buildLayerMatrix:t9,normalizeRanks:bM,removeEmptyRanks:xM,addBorderNode:n9,maxRank:CM,partition:r9,time:wM,notime:EM,zipObject:wb,minBy:uw};const i9=r=>{r.graph().dummyChains=[],r.edges().forEach(e=>o9(r,e))},o9=(r,e)=>{var t,n;let i=e.v,o=r.node(i).rank;const s=e.w,a=r.node(s).rank,l=e.name,c=r.edge(e),u=c.labelRank;if(a===o+1)return;r.removeEdge(e);let d,h,f;for(f=0,++o;o<a;++f,++o)c.points=[],h={edgeLabel:c,width:0,height:0,edgeObj:e,rank:o},d=lo.addDummyNode(r,"edge",h,"_d"),o===u&&(h.width=c.width,h.height=c.height,h.dummy="edge-label",h.labelpos=c.labelpos),r.setEdge(i,d,{weight:c.weight},l),f===0&&(r.graph().dummyChains||(r.graph().dummyChains=[]),(n=(t=r.graph())===null||t===void 0?void 0:t.dummyChains)===null||n===void 0||n.push(d)),i=d;r.setEdge(i,s,{weight:c.weight},l)};var SM={run:i9,undo:r=>{var e;(e=r.graph().dummyChains)===null||e===void 0||e.forEach(t=>{var n;let i=r.node(t);const o=i.edgeLabel;let s;i.edgeObj&&r.setEdge(i.edgeObj,o);let a=t;for(;i.dummy;)s=(n=r.successors(a))===null||n===void 0?void 0:n[0],r.removeNode(a),o.points.push({x:i.x,y:i.y}),i.dummy==="edge-label"&&(o.x=i.x,o.y=i.y,o.width=i.width,o.height=i.height),a=s,i=r.node(a)})}};const dw=r=>{var e;const t={},n=i=>{var o;const s=r.node(i);if(t.hasOwnProperty(i))return s.rank;t[i]=!0;const a=(o=r.outEdges(i))===null||o===void 0?void 0:o.map(c=>n(c.w)-r.edge(c).minlen||Infinity);let l=Math.min(...a);return(l===Number.POSITIVE_INFINITY||l===void 0||l===null)&&(l=0),s.rank=l,l};(e=r.sources())===null||e===void 0||e.forEach(i=>n(i))},_M=r=>{var e;const t={};let n=0;const i=s=>{var a;const l=r.node(s);if(t.hasOwnProperty(s))return l.rank;t[s]=!0;const c=(a=r.outEdges(s))===null||a===void 0?void 0:a.map(d=>i(d.w)-r.edge(d).minlen||Infinity);let u=Math.min(...c);return(u===Number.POSITIVE_INFINITY||u===void 0||u===null)&&(u=0),l.rank=u,n=Math.min(l.rank,n),l.rank};(e=r.sources())===null||e===void 0||e.forEach(s=>i(s)),n+=1;const o=(s,a)=>{var l;const c=r.node(s),u=isNaN(c.layer)?a:c.layer;(c.rank===void 0||c.rank<u)&&(c.rank=u),(l=r.outEdges(s))===null||l===void 0||l.map(d=>{o(d.w,u+r.edge(d).minlen)})};r.nodes().forEach(s=>{const a=r.node(s);isNaN(a.layer)?a.rank-=n:o(s,a.layer)})},wc=(r,e)=>r.node(e.w).rank-r.node(e.v).rank-r.edge(e).minlen;var nne={longestPath:dw,longestPathWithLayer:_M,slack:wc};const AM=Cc.Graph,TM=r=>{const e=new AM({directed:!1}),t=r.nodes()[0],n=r.nodeCount();e.setNode(t,{});let i,o;for(;s9(e,r)<n;)i=PM(e,r),o=e.hasNode(i.v)?wc(r,i):-wc(r,i),OM(e,r,o);return e},s9=(r,e)=>{const t=n=>{e.nodeEdges(n).forEach(i=>{const o=i.v,s=n===o?i.w:o;!r.hasNode(s)&&!wc(e,i)&&(r.setNode(s,{}),r.setEdge(n,s,{}),t(s))})};return r.nodes().forEach(t),r.nodeCount()},MM=r=>{const e=new AM({directed:!1}),t=r.nodes()[0],n=r.nodeCount();e.setNode(t,{});let i,o;for(;a9(e,r)<n;)i=PM(e,r),o=e.hasNode(i.v)?wc(r,i):-wc(r,i),OM(e,r,o);return e},a9=(r,e)=>{const t=n=>{var i;(i=e.nodeEdges(n))===null||i===void 0||i.forEach(o=>{const s=o.v,a=n===s?o.w:s;!r.hasNode(a)&&(e.node(a).layer!==void 0||!wc(e,o))&&(r.setNode(a,{}),r.setEdge(n,a,{}),t(a))})};return r.nodes().forEach(t),r.nodeCount()},PM=(r,e)=>uw(e.edges(),t=>r.hasNode(t.v)!==r.hasNode(t.w)?wc(e,t):Infinity),OM=(r,e,t)=>{r.nodes().forEach(n=>{e.node(n).rank||(e.node(n).rank=0),e.node(n).rank+=t})};var rne={feasibleTree:TM,feasibleTreeWithLayer:MM};const l9=Cc.alg,{preorder:c9,postorder:u9}=l9,qd=r=>{r=yM(r),dw(r);const e=TM(r);fw(e),hw(e,r);let t,n;for(;t=RM(e);)n=kM(e,r,t),IM(e,r,t,n)},hw=(r,e)=>{let t=u9(r,r.nodes());t=t==null?void 0:t.slice(0,(t==null?void 0:t.length)-1),t==null||t.forEach(n=>{d9(r,e,n)})},d9=(r,e,t)=>{const i=r.node(t).parent;r.edge(t,i).cutvalue=DM(r,e,t)},DM=(r,e,t)=>{var n;const o=r.node(t).parent;let s=!0,a=e.edge(t,o),l=0;return a||(s=!1,a=e.edge(o,t)),l=a.weight,(n=e.nodeEdges(t))===null||n===void 0||n.forEach(c=>{const u=c.v===t,d=u?c.w:c.v;if(d!==o){const h=u===s,f=e.edge(c).weight;if(l+=h?f:-f,f9(r,t,d)){const p=r.edge(t,d).cutvalue;l+=h?-p:p}}}),l},fw=(r,e)=>{e!==void 0&&(e=r.nodes()[0]),NM(r,{},1,e)},NM=(r,e,t,n,i)=>{var o;const s=t;let a=t;const l=r.node(n);return e[n]=!0,(o=r.neighbors(n))===null||o===void 0||o.forEach(c=>{e.hasOwnProperty(c)||(a=NM(r,e,a,c,n))}),l.low=s,l.lim=a++,i?l.parent=i:delete l.parent,a},RM=r=>r.edges().find(e=>r.edge(e).cutvalue<0),kM=(r,e,t)=>{let n=t.v,i=t.w;e.hasEdge(n,i)||(n=t.w,i=t.v);const o=r.node(n),s=r.node(i);let a=o,l=!1;o.lim>s.lim&&(a=s,l=!0);const c=e.edges().filter(u=>l===LM(r,r.node(u.v),a)&&l!==LM(r,r.node(u.w),a));return uw(c,u=>wc(e,u))},IM=(r,e,t,n)=>{const i=t.v,o=t.w;r.removeEdge(i,o),r.setEdge(n.v,n.w,{}),fw(r),hw(r,e),h9(r,e)},h9=(r,e)=>{const t=r.nodes().find(i=>!e.node(i).parent);let n=c9(r,t);n=n==null?void 0:n.slice(1),n==null||n.forEach(i=>{const o=r.node(i).parent;let s=e.edge(i,o),a=!1;s||(s=e.edge(o,i),a=!0),e.node(i).rank=e.node(o).rank+(a?s.minlen:-s.minlen)})},f9=(r,e,t)=>r.hasEdge(e,t),LM=(r,e,t)=>t.low<=e.lim&&e.lim<=t.lim;qd.initLowLimValues=fw,qd.initCutValues=hw,qd.calcCutValue=DM,qd.leaveEdge=RM,qd.enterEdge=kM,qd.exchangeEdges=IM;var p9=qd;const g9=r=>{switch(r.graph().ranker){case"network-simplex":v9(r);break;case"tight-tree":GM(r);break;case"longest-path":m9(r);break;default:GM(r)}},m9=dw,GM=r=>{_M(r),MM(r)},v9=r=>{p9(r)};var y9=g9;const b9=r=>{var e;const t=C9(r);(e=r.graph().dummyChains)===null||e===void 0||e.forEach(n=>{var i,o;let s=r.node(n);const a=s.edgeObj;if(!a)return;const l=x9(r,t,a.v,a.w),c=l.path,u=l.lca;let d=0,h=c[d],f=!0;for(;n!==a.w;){if(s=r.node(n),f){for(;(h=c[d])!==u&&r.node(h).maxRank<s.rank;)d++;h===u&&(f=!1)}if(!f){for(;d<c.length-1&&((i=r.node(h=c[d+1]))===null||i===void 0?void 0:i.minRank)<=s.rank;)d++;h=c[d]}r.setParent(n,h),n=(o=r.successors(n))===null||o===void 0?void 0:o[0]}})},x9=(r,e,t,n)=>{const i=[],o=[],s=Math.min(e[t].low,e[n].low),a=Math.max(e[t].lim,e[n].lim);let l,c;l=t;do l=r.parent(l),i.push(l);while(l&&(e[l].low>s||a>e[l].lim));for(c=l,l=n;(l=r.parent(l))!==c;)o.push(l);return{lca:c,path:i.concat(o.reverse())}},C9=r=>{var e;const t={};let n=0;const i=o=>{var s;const a=n;(s=r.children(o))===null||s===void 0||s.forEach(i),t[o]={low:a,lim:n++}};return(e=r.children())===null||e===void 0||e.forEach(i),t};var w9=b9;const E9=r=>{var e;const t=lo.addDummyNode(r,"root",{},"_root"),n=S9(r),i=Math.max(...Object.values(n))-1,o=2*i+1;r.graph().nestingRoot=t,r.edges().forEach(a=>{r.edge(a).minlen*=o});const s=_9(r)+1;(e=r.children())===null||e===void 0||e.forEach(a=>{FM(r,t,o,s,i,n,a)}),r.graph().nodeRankFactor=o},FM=(r,e,t,n,i,o,s)=>{const a=r.children(s);if(!(a==null?void 0:a.length)){s!==e&&r.setEdge(e,s,{weight:0,minlen:t});return}const l=lo.addBorderNode(r,"_bt"),c=lo.addBorderNode(r,"_bb"),u=r.node(s);r.setParent(l,s),u.borderTop=l,r.setParent(c,s),u.borderBottom=c,a==null||a.forEach(d=>{FM(r,e,t,n,i,o,d);const h=r.node(d),f=h.borderTop?h.borderTop:d,p=h.borderBottom?h.borderBottom:d,g=h.borderTop?n:2*n,v=f!==p?1:i-o[s]+1;r.setEdge(l,f,{minlen:v,weight:g,nestingEdge:!0}),r.setEdge(p,c,{minlen:v,weight:g,nestingEdge:!0})}),r.parent(s)||r.setEdge(e,l,{weight:0,minlen:i+o[s]})},S9=r=>{var e;const t={},n=(i,o)=>{const s=r.children(i);s==null||s.forEach(a=>n(a,o+1)),t[i]=o};return(e=r.children())===null||e===void 0||e.forEach(i=>n(i,1)),t},_9=r=>{let e=0;return r.edges().forEach(t=>{e+=r.edge(t).weight}),e};var BM={run:E9,cleanup:r=>{const e=r.graph();e.nestingRoot&&r.removeNode(e.nestingRoot),delete e.nestingRoot,r.edges().forEach(t=>{r.edge(t).nestingEdge&&r.removeEdge(t)})}};const A9=r=>{var e;const t=n=>{const i=r.children(n),o=r.node(n);if((i==null?void 0:i.length)&&i.forEach(s=>t(s)),o.hasOwnProperty("minRank")){o.borderLeft=[],o.borderRight=[];for(let s=o.minRank,a=o.maxRank+1;s<a;++s)zM(r,"borderLeft","_bl",n,o,s),zM(r,"borderRight","_br",n,o,s)}};(e=r.children())===null||e===void 0||e.forEach(n=>t(n))},zM=(r,e,t,n,i,o)=>{const s={rank:o,width:0,height:0,borderType:e},a=i[e][o-1],l=lo.addDummyNode(r,"border",s,t);i[e][o]=l,r.setParent(l,n),a&&r.setEdge(a,l,{weight:1})};var T9=A9;const M9=r=>{var e;const t=(e=r.graph().rankdir)===null||e===void 0?void 0:e.toLowerCase();(t==="lr"||t==="rl")&&UM(r)},P9=r=>{var e;const t=(e=r.graph().rankdir)===null||e===void 0?void 0:e.toLowerCase();(t==="bt"||t==="rl")&&O9(r),(t==="lr"||t==="rl")&&(D9(r),UM(r))},UM=r=>{r.nodes().forEach(e=>{VM(r.node(e))}),r.edges().forEach(e=>{VM(r.edge(e))})},VM=r=>{const e=r.width;r.width=r.height,r.height=e},O9=r=>{r.nodes().forEach(e=>{pw(r.node(e))}),r.edges().forEach(e=>{var t;const n=r.edge(e);(t=n.points)===null||t===void 0||t.forEach(i=>pw(i)),n.hasOwnProperty("y")&&pw(n)})},pw=r=>{r.y=-r.y},D9=r=>{r.nodes().forEach(e=>{gw(r.node(e))}),r.edges().forEach(e=>{var t;const n=r.edge(e);(t=n.points)===null||t===void 0||t.forEach(i=>gw(i)),n.hasOwnProperty("x")&&gw(n)})},gw=r=>{const e=r.x;r.x=r.y,r.y=e};var jM={adjust:M9,undo:P9},HM=r=>{const e={},t=r.nodes().filter(u=>{var d;return!((d=r.children(u))===null||d===void 0?void 0:d.length)}),n=t.map(u=>r.node(u).rank),i=Math.max(...n),o=[];for(let u=0;u<i+1;u++)o.push([]);const s=u=>{var d;if(e.hasOwnProperty(u))return;e[u]=!0;const h=r.node(u);isNaN(h.rank)||o[h.rank].push(u),(d=r.successors(u))===null||d===void 0||d.forEach(f=>s(f))},a=t.sort((u,d)=>r.node(u).rank-r.node(d).rank),c=a.filter(u=>r.node(u).fixorder!==void 0).sort((u,d)=>r.node(u).fixorder-r.node(d).fixorder);return c==null||c.forEach(u=>{isNaN(r.node(u).rank)||o[r.node(u).rank].push(u),e[u]=!0}),a==null||a.forEach(s),o};const N9=(r,e,t)=>{const n=wb(t,t.map((u,d)=>d)),o=e.map(u=>{var d;const h=(d=r.outEdges(u))===null||d===void 0?void 0:d.map(f=>({pos:n[f.w]||0,weight:r.edge(f).weight}));return h==null?void 0:h.sort((f,p)=>f.pos-p.pos)}).flat().filter(u=>u!==void 0);let s=1;for(;s<t.length;)s<<=1;const a=2*s-1;s-=1;const l=Array(a).fill(0,0,a);let c=0;return o==null||o.forEach(u=>{let d=u.pos+s;l[d]+=u.weight;let h=0;for(;d>0;)d%2&&(h+=l[d+1]),d=d-1>>1,l[d]+=u.weight;c+=u.weight*h}),c};var $M=(r,e)=>{let t=0;for(let n=1;n<(e==null?void 0:e.length);++n)t+=N9(r,e[n-1],e[n]);return t};const R9=Cc.Graph,k9=(r,e,t)=>{const n=I9(r),i=new R9({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(o=>r.node(o));return r.nodes().forEach(o=>{const s=r.node(o),a=r.parent(o);(s.rank===e||s.minRank<=e&&e<=s.maxRank)&&(i.setNode(o),i.setParent(o,a||n),r[t](o).forEach(l=>{const c=l.v===o?l.w:l.v,u=i.edge(c,o),d=u!==void 0?u.weight:0;i.setEdge(c,o,{weight:r.edge(l).weight+d})}),s.hasOwnProperty("minRank")&&i.setNode(o,{borderLeft:s.borderLeft[e],borderRight:s.borderRight[e]}))}),i},I9=r=>{let e;for(;r.hasNode(e=`_root${Math.random()}`););return e};var L9=k9,G9=(r,e,t)=>{const n={};let i;t==null||t.forEach(o=>{let s=r.parent(o),a,l;for(;s;){if(a=r.parent(s),a?(l=n[a],n[a]=s):(l=i,i=s),l&&l!==s){e.setEdge(l,s);return}s=a}})},F9=(r,e)=>e.map(t=>{const n=r.inEdges(t);if(!(n==null?void 0:n.length))return{v:t};{const i={sum:0,weight:0};return n==null||n.forEach(o=>{const s=r.edge(o),a=r.node(o.v);i.sum+=s.weight*a.order,i.weight+=s.weight}),{v:t,barycenter:i.sum/i.weight,weight:i.weight}}});const B9=(r,e)=>{var t,n,i;const o={};r==null||r.forEach((a,l)=>{const c=o[a.v]={i:l,indegree:0,in:[],out:[],vs:[a.v]};a.barycenter!==void 0&&(c.barycenter=a.barycenter,c.weight=a.weight)}),(t=e.edges())===null||t===void 0||t.forEach(a=>{const l=o[a.v],c=o[a.w];l!==void 0&&c!==void 0&&(c.indegree++,l.out.push(o[a.w]))});const s=(i=(n=Object.values(o)).filter)===null||i===void 0?void 0:i.call(n,a=>!a.indegree);return z9(s)},z9=r=>{var e,t;const n=[],i=l=>c=>{c.merged||(c.barycenter===void 0||l.barycenter===void 0||c.barycenter>=l.barycenter)&&U9(l,c)},o=l=>c=>{c.in.push(l),--c.indegree==0&&r.push(c)};for(;r==null?void 0:r.length;){const l=r.pop();n.push(l),(e=l.in.reverse())===null||e===void 0||e.forEach(c=>i(l)(c)),(t=l.out)===null||t===void 0||t.forEach(c=>o(l)(c))}const s=n.filter(l=>!l.merged),a=["vs","i","barycenter","weight"];return s.map(l=>{const c={};return a==null||a.forEach(u=>{l[u]!==void 0&&(c[u]=l[u])}),c})},U9=(r,e)=>{var t;let n=0,i=0;r.weight&&(n+=r.barycenter*r.weight,i+=r.weight),e.weight&&(n+=e.barycenter*e.weight,i+=e.weight),r.vs=(t=e.vs)===null||t===void 0?void 0:t.concat(r.vs),r.barycenter=n/i,r.weight=i,r.i=Math.min(e.i,r.i),e.merged=!0};var V9=B9;const j9=(r,e,t)=>{const n=lo.partition(r,d=>d.hasOwnProperty("fixorder")&&!isNaN(d.fixorder)||d.hasOwnProperty("barycenter")),i=n.lhs,o=n.rhs.sort((d,h)=>-d.i- -h.i),s=[];let a=0,l=0,c=0;i==null||i.sort(H9(!!e,!!t)),c=WM(s,o,c),i==null||i.forEach(d=>{var h;c+=(h=d.vs)===null||h===void 0?void 0:h.length,s.push(d.vs),a+=d.barycenter*d.weight,l+=d.weight,c=WM(s,o,c)});const u={vs:s.flat()};return l&&(u.barycenter=a/l,u.weight=l),u},WM=(r,e,t)=>{let n=t,i;for(;e.length&&(i=e[e.length-1]).i<=n;)e.pop(),r==null||r.push(i.vs),n++;return n},H9=(r,e)=>(t,n)=>{if(t.fixorder!==void 0&&n.fixorder!==void 0)return t.fixorder-n.fixorder;if(t.barycenter<n.barycenter)return-1;if(t.barycenter>n.barycenter)return 1;if(e&&t.order!==void 0&&n.order!==void 0){if(t.order<n.order)return-1;if(t.order>n.order)return 1}return r?n.i-t.i:t.i-n.i};var $9=j9;const ZM=(r,e,t,n,i)=>{var o,s,a,l;let c=r.children(e);const u=r.node(e),d=u?u.borderLeft:void 0,h=u?u.borderRight:void 0,f={};d&&(c=c==null?void 0:c.filter(y=>y!==d&&y!==h));const p=F9(r,c||[]);p==null||p.forEach(y=>{var x;if((x=r.children(y.v))===null||x===void 0?void 0:x.length){const E=ZM(r,y.v,t,n);f[y.v]=E,E.hasOwnProperty("barycenter")&&Z9(y,E)}});const g=V9(p,t);W9(g,f),(o=g.filter(y=>{var x;return!!y.vs||((x=y.vs)===null||x===void 0?void 0:x.length)>0}))===null||o===void 0||o.forEach(y=>{const x=r.node(y.vs[0]);y.fixorder=x.fixorder,y.order=x.order});const v=$9(g,n,i);if(d&&(v.vs=[d,v.vs,h].flat(),(s=r.predecessors(d))===null||s===void 0?void 0:s.length)){const y=r.node(((a=r.predecessors(d))===null||a===void 0?void 0:a[0])||{}),x=r.node(((l=r.predecessors(h))===null||l===void 0?void 0:l[0])||{});v.hasOwnProperty("barycenter")||(v.barycenter=0,v.weight=0),v.barycenter=(v.barycenter*v.weight+y.order+x.order)/(v.weight+2),v.weight+=2}return v},W9=(r,e)=>{r==null||r.forEach(t=>{var n;const i=(n=t.vs)===null||n===void 0?void 0:n.map(o=>e[o]?e[o].vs:o);t.vs=i.flat()})},Z9=(r,e)=>{r.barycenter!==void 0?(r.barycenter=(r.barycenter*r.weight+e.barycenter*e.weight)/(r.weight+e.weight),r.weight+=e.weight):(r.barycenter=e.barycenter,r.weight=e.weight)};var X9=ZM;const Y9=Cc.Graph,K9=r=>{const e=lo.maxRank(r),t=[],n=[];for(let c=1;c<e+1;c++)t.push(c);for(let c=e-1;c>-1;c--)n.push(c);const i=XM(r,t,"inEdges"),o=XM(r,n,"outEdges");let s=HM(r);mw(r,s);let a=Number.POSITIVE_INFINITY,l;for(let c=0,u=0;u<4;++c,++u){YM(c%2?i:o,c%4>=2),s=lo.buildLayerMatrix(r);const d=$M(r,s);d<a&&(u=0,l=P0(s),a=d)}s=HM(r),mw(r,s);for(let c=0,u=0;u<4;++c,++u){YM(c%2?i:o,c%4>=2,!0),s=lo.buildLayerMatrix(r);const d=$M(r,s);d<a&&(u=0,l=P0(s),a=d)}mw(r,l)},XM=(r,e,t)=>e.map(n=>L9(r,n,t)),YM=(r,e,t)=>{const n=new Y9;r==null||r.forEach(i=>{var o;const s=i.graph().root,a=X9(i,s,n,e,t);for(let l=0;l<((o=a.vs)===null||o===void 0?void 0:o.length);l++)i.node(a.vs[l]).order=l;G9(i,n,a.vs)})},mw=(r,e)=>{e==null||e.forEach(t=>{t==null||t.forEach((n,i)=>{r.node(n).order=i})})};var q9=K9;const J9=Cc.Graph,vw=(r,e)=>{const t={},n=(i,o)=>{let s=0,a=0;const l=i.length,c=o==null?void 0:o[(o==null?void 0:o.length)-1];return o==null||o.forEach((u,d)=>{var h;const f=Q9(r,u),p=f?r.node(f).order:l;(f||u===c)&&((h=o.slice(a,d+1))===null||h===void 0||h.forEach(g=>{var v;(v=r.predecessors(g))===null||v===void 0||v.forEach(y=>{const x=r.node(y),E=x.order;(E<s||p<E)&&!(x.dummy&&r.node(g).dummy)&&bw(t,y,g)})}),a=d+1,s=p)}),o};return(e==null?void 0:e.length)&&e.reduce(n),t},yw=(r,e)=>{const t={},n=(o,s,a,l,c)=>{let u;const d=[];for(let h=s;h<a;h++)d.push(h);d.forEach(h=>{var f;u=o[h],r.node(u).dummy&&((f=r.predecessors(u))===null||f===void 0||f.forEach(p=>{const g=r.node(p);g.dummy&&(g.order<l||g.order>c)&&bw(t,p,u)}))})},i=(o,s)=>{let a=-1,l,c=0;return s==null||s.forEach((u,d)=>{if(r.node(u).dummy==="border"){const h=r.predecessors(u)||[];h.length&&(l=r.node(h[0]).order,n(s,c,d,a,l),c=d,a=l)}n(s,c,s.length,l,o.length)}),s};return(e==null?void 0:e.length)&&e.reduce(i),t},Q9=(r,e)=>{var t;if(r.node(e).dummy)return(t=r.predecessors(e))===null||t===void 0?void 0:t.find(n=>r.node(n).dummy)},bw=(r,e,t)=>{let n=e,i=t;if(n>i){const s=n;n=i,i=s}let o=r[n];o||(r[n]=o={}),o[i]=!0},KM=(r,e,t)=>{let n=e,i=t;if(n>i){const o=e;n=i,i=o}return r[n]&&r[n].hasOwnProperty(i)},xw=(r,e,t,n)=>{const i={},o={},s={};return e==null||e.forEach(a=>{a==null||a.forEach((l,c)=>{i[l]=l,o[l]=l,s[l]=c})}),e==null||e.forEach(a=>{let l=-1;a==null||a.forEach(c=>{let u=n(c);if(u.length){u=u.sort((h,f)=>s[h]-s[f]);const d=(u.length-1)/2;for(let h=Math.floor(d),f=Math.ceil(d);h<=f;++h){const p=u[h];o[c]===c&&l<s[p]&&!KM(t,c,p)&&(o[p]=c,o[c]=i[c]=i[p],l=s[p])}}})}),{root:i,align:o}},Cw=(r,e,t,n,i)=>{var o;const s={},a=ej(r,e,t,i),l=i?"borderLeft":"borderRight",c=(h,f)=>{let p=a.nodes(),g=p.pop();const v={};for(;g;)v[g]?h(g):(v[g]=!0,p.push(g),p=p.concat(f(g))),g=p.pop()},u=h=>{s[h]=(a.inEdges(h)||[]).reduce((f,p)=>Math.max(f,(s[p.v]||0)+a.edge(p)),0)},d=h=>{const f=(a.outEdges(h)||[]).reduce((g,v)=>Math.min(g,(s[v.w]||0)-a.edge(v)),Number.POSITIVE_INFINITY),p=r.node(h);f!==Number.POSITIVE_INFINITY&&p.borderType!==l&&(s[h]=Math.max(s[h],f))};return c(u,a.predecessors.bind(a)),c(d,a.successors.bind(a)),(o=Object.values(n))===null||o===void 0||o.forEach(h=>{s[h]=s[t[h]]}),s},ej=(r,e,t,n)=>{const i=new J9,o=r.graph(),s=nj(o.nodesep,o.edgesep,n);return e==null||e.forEach(a=>{let l;a==null||a.forEach(c=>{const u=t[c];if(i.setNode(u),l){const d=t[l],h=i.edge(d,u);i.setEdge(d,u,Math.max(s(r,c,l),h||0))}l=c})}),i},ww=(r,e)=>lo.minBy(Object.values(e),t=>{var n;let i=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return(n=Object.keys(t))===null||n===void 0||n.forEach(s=>{const a=t[s],l=rj(r,s)/2;i=Math.max(a+l,i),o=Math.min(a-l,o)}),i-o});function Ew(r,e){const t=Object.values(e),n=Math.min(...t),i=Math.max(...t);["u","d"].forEach(o=>{["l","r"].forEach(s=>{const a=o+s,l=r[a];let c;if(l===e)return;const u=Object.values(l);c=s==="l"?n-Math.min(...u):i-Math.max(...u),c&&(r[a]={},Object.keys(l).forEach(d=>{r[a][d]=l[d]+c}))})})}const Sw=(r,e)=>{const t={};return Object.keys(r.ul).forEach(n=>{if(e)t[n]=r[e.toLowerCase()][n];else{const o=Object.values(r).map(s=>s[n]).sort((s,a)=>s-a);t[n]=(o[1]+o[2])/2}}),t},tj=r=>{const e=lo.buildLayerMatrix(r),t=Object.assign(vw(r,e),yw(r,e)),n={};let i;["u","d"].forEach(s=>{i=s==="u"?e:Object.values(e).reverse(),["l","r"].forEach(a=>{a==="r"&&(i=i.map(d=>Object.values(d).reverse()));const l=(s==="u"?r.predecessors:r.successors).bind(r),c=xw(r,i,t,l);let u=Cw(r,i,c.root,c.align,a==="r");a==="r"&&(u=Object.values(u).map(d=>-d)),n[s+a]=u})});const o=ww(r,n);return Ew(n,o),Sw(n,r.graph().align)},nj=(r,e,t)=>(n,i,o)=>{const s=n.node(i),a=n.node(o);let l=0,c;if(l+=s.width/2,s.hasOwnProperty("labelpos"))switch((s.labelpos||"").toLowerCase()){case"l":c=-s.width/2;break;case"r":c=s.width/2;break}if(c&&(l+=t?c:-c),c=0,l+=(s.dummy?e:r)/2,l+=(a.dummy?e:r)/2,l+=a.width/2,a.hasOwnProperty("labelpos"))switch((a.labelpos||"").toLowerCase()){case"l":c=a.width/2;break;case"r":c=-a.width/2;break}return c&&(l+=t?c:-c),c=0,l},rj=(r,e)=>{var t;return((t=r.node(e))===null||t===void 0?void 0:t.width)||0};var cne={positionX:tj,findType1Conflicts:vw,findType2Conflicts:yw,addConflict:bw,hasConflict:KM,verticalAlignment:xw,horizontalCompaction:Cw,alignCoordinates:Ew,findSmallestWidthAlignment:ww,balance:Sw};const ij=r=>{const e=lo.buildLayerMatrix(r),t=r.graph().ranksep;let n=0;e==null||e.forEach(i=>{const o=i.map(a=>r.node(a).height),s=Math.max(...o);i==null||i.forEach(a=>{r.node(a).y=n+s/2}),n+=s+t})},oj=r=>{const e=lo.buildLayerMatrix(r),t=Object.assign(vw(r,e),yw(r,e)),n={};let i;["u","d"].forEach(s=>{i=s==="u"?e:Object.values(e).reverse(),["l","r"].forEach(a=>{a==="r"&&(i=i.map(d=>Object.values(d).reverse()));const l=(s==="u"?r.predecessors:r.successors).bind(r),c=xw(r,i,t,l),u=Cw(r,i,c.root,c.align,a==="r");a==="r"&&Object.keys(u).forEach(d=>u[d]=-u[d]),n[s+a]=u})});const o=ww(r,n);return o&&Ew(n,o),Sw(n,r.graph().align)};var sj=r=>{var e;r=lo.asNonCompoundGraph(r),ij(r);const t=oj(r);(e=Object.keys(t))===null||e===void 0||e.forEach(n=>{r.node(n).x=t[n]})},aj=(r,e)=>{const n=r.nodes().filter(s=>{var a;return!((a=r.children(s))===null||a===void 0?void 0:a.length)}).map(s=>r.node(s).rank),i=Math.max(...n),o=[];for(let s=0;s<i+1;s++)o.push([]);e==null||e.forEach(s=>{const a=r.node(s);!a||a.dummy||isNaN(a.rank)||(a.fixorder=o[a.rank].length,o[a.rank].push(s))})};const lj=Cc.Graph,cj=(r,e)=>{const t=e&&e.debugTiming?lo.time:lo.notime;t("layout",()=>{e&&!e.keepNodeOrder&&e.prevGraph&&t("  inheritOrder",()=>{dj(r,e.prevGraph)});const n=t("  buildLayoutGraph",()=>yj(r));e&&e.edgeLabelSpace===!1||t("  makeSpaceForEdgeLabels",()=>{bj(n)});try{t("  runLayout",()=>{uj(n,t,e)})}catch(i){if(i.message==="Not possible to find intersection inside of the rectangle"){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,i);return}throw i}t("  updateInputGraph",()=>{hj(r,n)})})},uj=(r,e,t)=>{e("    removeSelfEdges",()=>{Mj(r)}),e("    acyclic",()=>{gM.run(r)}),e("    nestingGraph.run",()=>{BM.run(r)}),e("    rank",()=>{y9(lo.asNonCompoundGraph(r))}),e("    injectEdgeLabelProxies",()=>{xj(r)}),e("    removeEmptyRanks",()=>{xM(r)}),e("    nestingGraph.cleanup",()=>{BM.cleanup(r)}),e("    normalizeRanks",()=>{bM(r)}),e("    assignRankMinMax",()=>{Cj(r)}),e("    removeEdgeLabelProxies",()=>{wj(r)}),e("    normalize.run",()=>{SM.run(r)}),e("    parentDummyChains",()=>{w9(r)}),e("    addBorderSegments",()=>{T9(r)}),t&&t.keepNodeOrder&&e("    initDataOrder",()=>{aj(r,t.nodeOrder)}),e("    order",()=>{q9(r)}),e("    insertSelfEdges",()=>{Pj(r)}),e("    adjustCoordinateSystem",()=>{jM.adjust(r)}),e("    position",()=>{sj(r)}),e("    positionSelfEdges",()=>{Oj(r)}),e("    removeBorderNodes",()=>{Tj(r)}),e("    normalize.undo",()=>{SM.undo(r)}),e("    fixupEdgeLabelCoords",()=>{_j(r)}),e("    undoCoordinateSystem",()=>{jM.undo(r)}),e("    translateGraph",()=>{Ej(r)}),e("    assignNodeIntersects",()=>{Sj(r)}),e("    reversePoints",()=>{Aj(r)}),e("    acyclic.undo",()=>{gM.undo(r)})},dj=(r,e)=>{const t=e._nodes||{};r.nodes().forEach(n=>{const i=r.node(n);t[n]!==void 0?(i.fixorder=t[n]._order,delete t[n]._order):delete i.fixorder})},hj=(r,e)=>{r.nodes().forEach(t=>{var n;const i=r.node(t),o=e.node(t);i&&(i.x=o.x,i.y=o.y,i._order=o.order,i._rank=o.rank,((n=e.children(t))===null||n===void 0?void 0:n.length)&&(i.width=o.width,i.height=o.height))}),r.edges().forEach(t=>{const n=r.edge(t),i=e.edge(t);n.points=i.points,i.hasOwnProperty("x")&&(n.x=i.x,n.y=i.y)}),r.graph().width=e.graph().width,r.graph().height=e.graph().height},fj=["nodesep","edgesep","ranksep","marginx","marginy"],pj={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},_w=["acyclicer","ranker","rankdir","align"],gj=["width","height","layer","fixorder"],qM={width:0,height:0},mj=["minlen","weight","width","height","labeloffset"],vj={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Aw=["labelpos"],yj=r=>{const e=new lj({multigraph:!0,compound:!0}),t=Mw(r.graph()),n={};return _w==null||_w.forEach(i=>{t[i]!==void 0&&(n[i]=t[i])}),e.setGraph(Object.assign({},pj,Tw(t,fj),n)),r.nodes().forEach(i=>{const o=Mw(r.node(i)),s=Tw(o,gj);Object.keys(qM).forEach(a=>{s[a]===void 0&&(s[a]=qM[a])}),e.setNode(i,s),e.setParent(i,r.parent(i))}),r.edges().forEach(i=>{const o=Mw(r.edge(i)),s={};Aw==null||Aw.forEach(a=>{o[a]!==void 0&&(s[a]=o[a])}),e.setEdge(i,Object.assign({},vj,Tw(o,mj),s))}),e},bj=r=>{const e=r.graph();e.ranksep||(e.ranksep=0),e.ranksep/=2,r.nodes().forEach(t=>{const n=r.node(t);isNaN(n.layer)||(n.layer?n.layer*=2:n.layer=0)}),r.edges().forEach(t=>{var n;const i=r.edge(t);i.minlen*=2,((n=i.labelpos)===null||n===void 0?void 0:n.toLowerCase())!=="c"&&(e.rankdir==="TB"||e.rankdir==="BT"?i.width+=i.labeloffset:i.height+=i.labeloffset)})},xj=r=>{r.edges().forEach(e=>{const t=r.edge(e);if(t.width&&t.height){const n=r.node(e.v),i=r.node(e.w),o={e,rank:(i.rank-n.rank)/2+n.rank};lo.addDummyNode(r,"edge-proxy",o,"_ep")}})},Cj=r=>{let e=0;r.nodes().forEach(t=>{const n=r.node(t);n.borderTop&&(n.minRank=r.node(n.borderTop).rank,n.maxRank=r.node(n.borderBottom).rank,e=Math.max(e,n.maxRank||-Infinity))}),r.graph().maxRank=e},wj=r=>{r.nodes().forEach(e=>{const t=r.node(e);t.dummy==="edge-proxy"&&(r.edge(t.e).labelRank=t.rank,r.removeNode(e))})},Ej=r=>{let e=Number.POSITIVE_INFINITY,t=0,n=Number.POSITIVE_INFINITY,i=0;const o=r.graph(),s=o.marginx||0,a=o.marginy||0,l=c=>{if(!c)return;const u=c.x,d=c.y,h=c.width,f=c.height;!isNaN(u)&&!isNaN(h)&&(e=Math.min(e,u-h/2),t=Math.max(t,u+h/2)),!isNaN(d)&&!isNaN(f)&&(n=Math.min(n,d-f/2),i=Math.max(i,d+f/2))};r.nodes().forEach(c=>{l(r.node(c))}),r.edges().forEach(c=>{const u=r.edge(c);u.hasOwnProperty("x")&&l(u)}),e-=s,n-=a,r.nodes().forEach(c=>{const u=r.node(c);u.x-=e,u.y-=n}),r.edges().forEach(c=>{var u;const d=r.edge(c);(u=d.points)===null||u===void 0||u.forEach(h=>{h.x-=e,h.y-=n}),d.hasOwnProperty("x")&&(d.x-=e),d.hasOwnProperty("y")&&(d.y-=n)}),o.width=t-e+s,o.height=i-n+a},Sj=r=>{r.edges().forEach(e=>{const t=r.edge(e),n=r.node(e.v),i=r.node(e.w);let o,s;t.points?(o=t.points[0],s=t.points[t.points.length-1]):(t.points=[],o=i,s=n),t.points.unshift(lo.intersectRect(n,o)),t.points.push(lo.intersectRect(i,s))})},_j=r=>{r.edges().forEach(e=>{const t=r.edge(e);if(t.hasOwnProperty("x"))switch((t.labelpos==="l"||t.labelpos==="r")&&(t.width-=t.labeloffset),t.labelpos){case"l":t.x-=t.width/2+t.labeloffset;break;case"r":t.x+=t.width/2+t.labeloffset;break}})},Aj=r=>{r.edges().forEach(e=>{const t=r.edge(e);t.reversed&&t.points.reverse()})},Tj=r=>{r.nodes().forEach(e=>{var t,n,i;if((t=r.children(e))===null||t===void 0?void 0:t.length){const o=r.node(e),s=r.node(o.borderTop),a=r.node(o.borderBottom),l=r.node(o.borderLeft[((n=o.borderLeft)===null||n===void 0?void 0:n.length)-1]),c=r.node(o.borderRight[((i=o.borderRight)===null||i===void 0?void 0:i.length)-1]);o.width=Math.abs((c==null?void 0:c.x)-(l==null?void 0:l.x))||10,o.height=Math.abs((a==null?void 0:a.y)-(s==null?void 0:s.y))||10,o.x=((l==null?void 0:l.x)||0)+o.width/2,o.y=((s==null?void 0:s.y)||0)+o.height/2}}),r.nodes().forEach(e=>{r.node(e).dummy==="border"&&r.removeNode(e)})},Mj=r=>{r.edges().forEach(e=>{if(e.v===e.w){const t=r.node(e.v);t.selfEdges||(t.selfEdges=[]),t.selfEdges.push({e,label:r.edge(e)}),r.removeEdge(e)}})},Pj=r=>{const e=lo.buildLayerMatrix(r);e==null||e.forEach(t=>{let n=0;t==null||t.forEach((i,o)=>{var s;const a=r.node(i);a.order=o+n,(s=a.selfEdges)===null||s===void 0||s.forEach(l=>{lo.addDummyNode(r,"selfedge",{width:l.label.width,height:l.label.height,rank:a.rank,order:o+ ++n,e:l.e,label:l.label},"_se")}),delete a.selfEdges})})},Oj=r=>{r.nodes().forEach(e=>{const t=r.node(e);if(t.dummy==="selfedge"){const n=r.node(t.e.v),i=n.x+n.width/2,o=n.y,s=t.x-i,a=n.height/2;r.setEdge(t.e,t.label),r.removeNode(e),t.label.points=[{x:i+2*s/3,y:o-a},{x:i+5*s/6,y:o-a},{y:o,x:i+s},{x:i+5*s/6,y:o+a},{x:i+2*s/3,y:o+a}],t.label.x=t.x,t.label.y=t.y}})},Tw=(r,e)=>{const t={};return e==null||e.forEach(n=>{r[n]!==void 0&&(t[n]=+r[n])}),t},Mw=r=>{const e={};return Object.keys(r).forEach(t=>{const n=r[t];e[t.toLowerCase()]=n}),e};var Dj=cj,Pw={graphlib:Cc,layout:Dj,util:{time:wM,notime:EM}};class JM extends _s{constructor(e){super();this.rankdir="TB",this.nodesep=50,this.ranksep=50,this.controlPoints=!1,this.sortByCombo=!1,this.edgeLabelSpace=!0,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.layoutNode=t=>{const n=this,{nodes:i}=n,o=i.find(s=>s.id===t);return o?o.layout!==!1:!0},this.updateCfg(e)}getDefaultCfg(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1}}execute(){const e=this,{nodes:t,nodeSize:n,rankdir:i,combos:o,begin:s}=e;if(!t)return;const a=e.edges||[],l=new Pw.graphlib.Graph({multigraph:!0,compound:!0});let c;n?os(n)?c=()=>n:c=()=>[n,n]:c=g=>g.size?os(g.size)?g.size:xc(g.size)?[g.size.width||40,g.size.height||40]:[g.size,g.size]:[40,40];let u=Eb(e.nodesepFunc,e.nodesep,50),d=Eb(e.ranksepFunc,e.ranksep,50);(i==="LR"||i==="RL")&&(u=Eb(e.ranksepFunc,e.ranksep,50),d=Eb(e.nodesepFunc,e.nodesep,50)),l.setDefaultEdgeLabel(()=>({})),l.setGraph(e);const h={};t.filter(g=>g.layout!==!1).forEach(g=>{const v=c(g),y=d(g),x=u(g),E=v[0]+2*x,T=v[1]+2*y,P=g.layer;un(P)?l.setNode(g.id,{width:E,height:T,layer:P}):l.setNode(g.id,{width:E,height:T}),this.sortByCombo&&g.comboId&&(h[g.comboId]||(h[g.comboId]=!0,l.setNode(g.comboId,{})),l.setParent(g.id,g.comboId))}),this.sortByCombo&&o&&o.forEach(g=>{!g.parentId||(h[g.parentId]||(h[g.parentId]=!0,l.setNode(g.parentId,{})),l.setParent(g.id,g.parentId))}),a.forEach(g=>{const v=Xr(g,"source"),y=Xr(g,"target");this.layoutNode(v)&&this.layoutNode(y)&&l.setEdge(v,y,{weight:g.weight||1})});let f;e.preset&&(f=new Pw.graphlib.Graph({multigraph:!0,compound:!0}),e.preset.nodes.forEach(g=>{f==null||f.setNode(g.id,g)})),Pw.layout(l,{prevGraph:f,edgeLabelSpace:e.edgeLabelSpace,keepNodeOrder:Boolean(!!e.nodeOrder),nodeOrder:e.nodeOrder});const p=[0,0];if(s){let g=Infinity,v=Infinity;l.nodes().forEach(y=>{const x=l.node(y);g>x.x&&(g=x.x),v>x.y&&(v=x.y)}),l.edges().forEach(y=>{l.edge(y).points.forEach(E=>{g>E.x&&(g=E.x),v>E.y&&(v=E.y)})}),p[0]=s[0]-g,p[1]=s[1]-v}return l.nodes().forEach(g=>{const v=l.node(g),y=t.findIndex(x=>x.id===g);!t[y]||(t[y].x=v.x+p[0],t[y].y=v.y+p[1],t[y]._order=v._order)}),l.edges().forEach(g=>{const v=l.edge(g),y=a.findIndex(x=>{const E=Xr(x,"source"),T=Xr(x,"target");return E===g.v&&T===g.w});e.edgeLabelSpace&&e.controlPoints&&a[y].type!=="loop"&&(a[y].controlPoints=v.points.slice(1,v.points.length-1),a[y].controlPoints.forEach(x=>{x.x+=p[0],x.y+=p[1]}))}),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:a}}getType(){return"dagre"}}function Eb(r,e,t){let n;return r?n=r:un(e)?n=()=>e:n=()=>t,n}var Nj=w(79320),QM=w(81306),eP=w(59206),Sb=w(69610),_b=w(54941);const Rj=Object.prototype.toString;function oa(r){return Rj.call(r).endsWith("Array]")}function kj(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!oa(r))throw new TypeError("input must be an array");if(r.length===0)throw new TypeError("input must not be empty");var t=e.fromIndex,n=t===void 0?0:t,i=e.toIndex,o=i===void 0?r.length:i;if(n<0||n>=r.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=n||o>r.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=r[n],a=n+1;a<o;a++)r[a]>s&&(s=r[a]);return s}function Ij(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!oa(r))throw new TypeError("input must be an array");if(r.length===0)throw new TypeError("input must not be empty");var t=e.fromIndex,n=t===void 0?0:t,i=e.toIndex,o=i===void 0?r.length:i;if(n<0||n>=r.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=n||o>r.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=r[n],a=n+1;a<o;a++)r[a]<s&&(s=r[a]);return s}function tP(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(oa(r)){if(r.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var t;if(e.output!==void 0){if(!oa(e.output))throw new TypeError("output option must be an array if specified");t=e.output}else t=new Array(r.length);var n=Ij(r),i=kj(r);if(n===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=e.min,s=o===void 0?e.autoMinMax?n:0:o,a=e.max,l=a===void 0?e.autoMinMax?i:1:a;if(s>=l)throw new RangeError("min option must be smaller than max option");for(var c=(l-s)/(i-n),u=0;u<r.length;u++)t[u]=(r[u]-n)*c+s;return t}var Ab=" ".repeat(2),nP=" ".repeat(4);function Lj(){return rP(this)}function rP(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.maxRows,n=t===void 0?15:t,i=e.maxColumns,o=i===void 0?10:i,s=e.maxNumSize,a=s===void 0?8:s,l=e.padMinus,c=l===void 0?"auto":l;return"".concat(r.constructor.name,` {
`).concat(Ab,`[
`).concat(nP).concat(Gj(r,n,o,a,c),`
`).concat(Ab,`]
`).concat(Ab,"rows: ").concat(r.rows,`
`).concat(Ab,"columns: ").concat(r.columns,`
}`)}function Gj(r,e,t,n,i){var o=r.rows,s=r.columns,a=Math.min(o,e),l=Math.min(s,t),c=[];if(i==="auto"){i=!1;e:for(var u=0;u<a;u++)for(var d=0;d<l;d++)if(r.get(u,d)<0){i=!0;break e}}for(var h=0;h<a;h++){for(var f=[],p=0;p<l;p++)f.push(Fj(r.get(h,p),n,i));c.push("".concat(f.join(" ")))}return l!==s&&(c[c.length-1]+=" ... ".concat(s-t," more columns")),a!==o&&c.push("... ".concat(o-e," more rows")),c.join(`
`.concat(nP))}function Fj(r,e,t){return(r>=0&&t?" ".concat(iP(r,e-1)):iP(r,e)).padEnd(e)}function iP(r,e){var t=r.toString();if(t.length<=e)return t;var n=r.toFixed(e);if(n.length>e&&(n=r.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;var i=r.toExponential(e);return i.length>e&&(i=r.toExponential(Math.max(0,e-(i.length-e)))),i.slice(0)}function Bj(r,e){r.prototype.add=function(n){return typeof n=="number"?this.addS(n):this.addM(n)},r.prototype.addS=function(n){for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)+n);return this},r.prototype.addM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)+n.get(i,o));return this},r.add=function(n,i){var o=new e(n);return o.add(i)},r.prototype.sub=function(n){return typeof n=="number"?this.subS(n):this.subM(n)},r.prototype.subS=function(n){for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)-n);return this},r.prototype.subM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)-n.get(i,o));return this},r.sub=function(n,i){var o=new e(n);return o.sub(i)},r.prototype.subtract=r.prototype.sub,r.prototype.subtractS=r.prototype.subS,r.prototype.subtractM=r.prototype.subM,r.subtract=r.sub,r.prototype.mul=function(n){return typeof n=="number"?this.mulS(n):this.mulM(n)},r.prototype.mulS=function(n){for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)*n);return this},r.prototype.mulM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)*n.get(i,o));return this},r.mul=function(n,i){var o=new e(n);return o.mul(i)},r.prototype.multiply=r.prototype.mul,r.prototype.multiplyS=r.prototype.mulS,r.prototype.multiplyM=r.prototype.mulM,r.multiply=r.mul,r.prototype.div=function(n){return typeof n=="number"?this.divS(n):this.divM(n)},r.prototype.divS=function(n){for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)/n);return this},r.prototype.divM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)/n.get(i,o));return this},r.div=function(n,i){var o=new e(n);return o.div(i)},r.prototype.divide=r.prototype.div,r.prototype.divideS=r.prototype.divS,r.prototype.divideM=r.prototype.divM,r.divide=r.div,r.prototype.mod=function(n){return typeof n=="number"?this.modS(n):this.modM(n)},r.prototype.modS=function(n){for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)%n);return this},r.prototype.modM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)%n.get(i,o));return this},r.mod=function(n,i){var o=new e(n);return o.mod(i)},r.prototype.modulus=r.prototype.mod,r.prototype.modulusS=r.prototype.modS,r.prototype.modulusM=r.prototype.modM,r.modulus=r.mod,r.prototype.and=function(n){return typeof n=="number"?this.andS(n):this.andM(n)},r.prototype.andS=function(n){for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)&n);return this},r.prototype.andM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)&n.get(i,o));return this},r.and=function(n,i){var o=new e(n);return o.and(i)},r.prototype.or=function(n){return typeof n=="number"?this.orS(n):this.orM(n)},r.prototype.orS=function(n){for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)|n);return this},r.prototype.orM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)|n.get(i,o));return this},r.or=function(n,i){var o=new e(n);return o.or(i)},r.prototype.xor=function(n){return typeof n=="number"?this.xorS(n):this.xorM(n)},r.prototype.xorS=function(n){for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)^n);return this},r.prototype.xorM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)^n.get(i,o));return this},r.xor=function(n,i){var o=new e(n);return o.xor(i)},r.prototype.leftShift=function(n){return typeof n=="number"?this.leftShiftS(n):this.leftShiftM(n)},r.prototype.leftShiftS=function(n){for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)<<n);return this},r.prototype.leftShiftM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)<<n.get(i,o));return this},r.leftShift=function(n,i){var o=new e(n);return o.leftShift(i)},r.prototype.signPropagatingRightShift=function(n){return typeof n=="number"?this.signPropagatingRightShiftS(n):this.signPropagatingRightShiftM(n)},r.prototype.signPropagatingRightShiftS=function(n){for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)>>n);return this},r.prototype.signPropagatingRightShiftM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)>>n.get(i,o));return this},r.signPropagatingRightShift=function(n,i){var o=new e(n);return o.signPropagatingRightShift(i)},r.prototype.rightShift=function(n){return typeof n=="number"?this.rightShiftS(n):this.rightShiftM(n)},r.prototype.rightShiftS=function(n){for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)>>>n);return this},r.prototype.rightShiftM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,this.get(i,o)>>>n.get(i,o));return this},r.rightShift=function(n,i){var o=new e(n);return o.rightShift(i)},r.prototype.zeroFillRightShift=r.prototype.rightShift,r.prototype.zeroFillRightShiftS=r.prototype.rightShiftS,r.prototype.zeroFillRightShiftM=r.prototype.rightShiftM,r.zeroFillRightShift=r.rightShift,r.prototype.not=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,~this.get(n,i));return this},r.not=function(n){var i=new e(n);return i.not()},r.prototype.abs=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.abs(this.get(n,i)));return this},r.abs=function(n){var i=new e(n);return i.abs()},r.prototype.acos=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.acos(this.get(n,i)));return this},r.acos=function(n){var i=new e(n);return i.acos()},r.prototype.acosh=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.acosh(this.get(n,i)));return this},r.acosh=function(n){var i=new e(n);return i.acosh()},r.prototype.asin=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.asin(this.get(n,i)));return this},r.asin=function(n){var i=new e(n);return i.asin()},r.prototype.asinh=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.asinh(this.get(n,i)));return this},r.asinh=function(n){var i=new e(n);return i.asinh()},r.prototype.atan=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.atan(this.get(n,i)));return this},r.atan=function(n){var i=new e(n);return i.atan()},r.prototype.atanh=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.atanh(this.get(n,i)));return this},r.atanh=function(n){var i=new e(n);return i.atanh()},r.prototype.cbrt=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.cbrt(this.get(n,i)));return this},r.cbrt=function(n){var i=new e(n);return i.cbrt()},r.prototype.ceil=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.ceil(this.get(n,i)));return this},r.ceil=function(n){var i=new e(n);return i.ceil()},r.prototype.clz32=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.clz32(this.get(n,i)));return this},r.clz32=function(n){var i=new e(n);return i.clz32()},r.prototype.cos=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.cos(this.get(n,i)));return this},r.cos=function(n){var i=new e(n);return i.cos()},r.prototype.cosh=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.cosh(this.get(n,i)));return this},r.cosh=function(n){var i=new e(n);return i.cosh()},r.prototype.exp=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.exp(this.get(n,i)));return this},r.exp=function(n){var i=new e(n);return i.exp()},r.prototype.expm1=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.expm1(this.get(n,i)));return this},r.expm1=function(n){var i=new e(n);return i.expm1()},r.prototype.floor=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.floor(this.get(n,i)));return this},r.floor=function(n){var i=new e(n);return i.floor()},r.prototype.fround=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.fround(this.get(n,i)));return this},r.fround=function(n){var i=new e(n);return i.fround()},r.prototype.log=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.log(this.get(n,i)));return this},r.log=function(n){var i=new e(n);return i.log()},r.prototype.log1p=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.log1p(this.get(n,i)));return this},r.log1p=function(n){var i=new e(n);return i.log1p()},r.prototype.log10=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.log10(this.get(n,i)));return this},r.log10=function(n){var i=new e(n);return i.log10()},r.prototype.log2=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.log2(this.get(n,i)));return this},r.log2=function(n){var i=new e(n);return i.log2()},r.prototype.round=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.round(this.get(n,i)));return this},r.round=function(n){var i=new e(n);return i.round()},r.prototype.sign=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.sign(this.get(n,i)));return this},r.sign=function(n){var i=new e(n);return i.sign()},r.prototype.sin=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.sin(this.get(n,i)));return this},r.sin=function(n){var i=new e(n);return i.sin()},r.prototype.sinh=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.sinh(this.get(n,i)));return this},r.sinh=function(n){var i=new e(n);return i.sinh()},r.prototype.sqrt=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.sqrt(this.get(n,i)));return this},r.sqrt=function(n){var i=new e(n);return i.sqrt()},r.prototype.tan=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.tan(this.get(n,i)));return this},r.tan=function(n){var i=new e(n);return i.tan()},r.prototype.tanh=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.tanh(this.get(n,i)));return this},r.tanh=function(n){var i=new e(n);return i.tanh()},r.prototype.trunc=function(){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,Math.trunc(this.get(n,i)));return this},r.trunc=function(n){var i=new e(n);return i.trunc()},r.pow=function(n,i){var o=new e(n);return o.pow(i)},r.prototype.pow=function(n){return typeof n=="number"?this.powS(n):this.powM(n)},r.prototype.powS=function(n){for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,Math.pow(this.get(i,o),n));return this},r.prototype.powM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.set(i,o,Math.pow(this.get(i,o),n.get(i,o)));return this}}function Va(r,e,t){var n=t?r.rows:r.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function ja(r,e,t){var n=t?r.columns:r.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function qf(r,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==r.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function Jf(r,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==r.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function zj(r,e){if(!oa(e))throw new TypeError("row indices must be an array");for(var t=0;t<e.length;t++)if(e[t]<0||e[t]>=r.rows)throw new RangeError("row indices are out of range")}function Uj(r,e){if(!oa(e))throw new TypeError("column indices must be an array");for(var t=0;t<e.length;t++)if(e[t]<0||e[t]>=r.columns)throw new RangeError("column indices are out of range")}function oP(r,e,t,n,i){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(Mb("startRow",e),Mb("endRow",t),Mb("startColumn",n),Mb("endColumn",i),e>t||n>i||e<0||e>=r.rows||t<0||t>=r.rows||n<0||n>=r.columns||i<0||i>=r.columns)throw new RangeError("Submatrix indices are out of range")}function Tb(r){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=[],n=0;n<r;n++)t.push(e);return t}function Mb(r,e){if(typeof e!="number")throw new TypeError("".concat(r," must be a number"))}function Qf(r){if(r.isEmpty())throw new Error("Empty matrix has no elements to index")}function Vj(r){for(var e=Tb(r.rows),t=0;t<r.rows;++t)for(var n=0;n<r.columns;++n)e[t]+=r.get(t,n);return e}function jj(r){for(var e=Tb(r.columns),t=0;t<r.rows;++t)for(var n=0;n<r.columns;++n)e[n]+=r.get(t,n);return e}function Hj(r){for(var e=0,t=0;t<r.rows;t++)for(var n=0;n<r.columns;n++)e+=r.get(t,n);return e}function $j(r){for(var e=Tb(r.rows,1),t=0;t<r.rows;++t)for(var n=0;n<r.columns;++n)e[t]*=r.get(t,n);return e}function Wj(r){for(var e=Tb(r.columns,1),t=0;t<r.rows;++t)for(var n=0;n<r.columns;++n)e[n]*=r.get(t,n);return e}function Zj(r){for(var e=1,t=0;t<r.rows;t++)for(var n=0;n<r.columns;n++)e*=r.get(t,n);return e}function Xj(r,e,t){for(var n=r.rows,i=r.columns,o=[],s=0;s<n;s++){for(var a=0,l=0,c=0,u=0;u<i;u++)c=r.get(s,u)-t[s],a+=c,l+=c*c;e?o.push((l-a*a/i)/(i-1)):o.push((l-a*a/i)/i)}return o}function Yj(r,e,t){for(var n=r.rows,i=r.columns,o=[],s=0;s<i;s++){for(var a=0,l=0,c=0,u=0;u<n;u++)c=r.get(u,s)-t[s],a+=c,l+=c*c;e?o.push((l-a*a/n)/(n-1)):o.push((l-a*a/n)/n)}return o}function Kj(r,e,t){for(var n=r.rows,i=r.columns,o=n*i,s=0,a=0,l=0,c=0;c<n;c++)for(var u=0;u<i;u++)l=r.get(c,u)-t,s+=l,a+=l*l;return e?(a-s*s/o)/(o-1):(a-s*s/o)/o}function qj(r,e){for(var t=0;t<r.rows;t++)for(var n=0;n<r.columns;n++)r.set(t,n,r.get(t,n)-e[t])}function Jj(r,e){for(var t=0;t<r.rows;t++)for(var n=0;n<r.columns;n++)r.set(t,n,r.get(t,n)-e[n])}function Qj(r,e){for(var t=0;t<r.rows;t++)for(var n=0;n<r.columns;n++)r.set(t,n,r.get(t,n)-e)}function eH(r){for(var e=[],t=0;t<r.rows;t++){for(var n=0,i=0;i<r.columns;i++)n+=Math.pow(r.get(t,i),2)/(r.columns-1);e.push(Math.sqrt(n))}return e}function tH(r,e){for(var t=0;t<r.rows;t++)for(var n=0;n<r.columns;n++)r.set(t,n,r.get(t,n)/e[t])}function nH(r){for(var e=[],t=0;t<r.columns;t++){for(var n=0,i=0;i<r.rows;i++)n+=Math.pow(r.get(i,t),2)/(r.rows-1);e.push(Math.sqrt(n))}return e}function rH(r,e){for(var t=0;t<r.rows;t++)for(var n=0;n<r.columns;n++)r.set(t,n,r.get(t,n)/e[n])}function iH(r){for(var e=r.size-1,t=0,n=0;n<r.columns;n++)for(var i=0;i<r.rows;i++)t+=Math.pow(r.get(i,n),2)/e;return Math.sqrt(t)}function oH(r,e){for(var t=0;t<r.rows;t++)for(var n=0;n<r.columns;n++)r.set(t,n,r.get(t,n)/e)}var Lo=function(){function r(){(0,Sb.Z)(this,r)}return(0,_b.Z)(r,[{key:"size",get:function(){return this.rows*this.columns}},{key:"apply",value:function(t){if(typeof t!="function")throw new TypeError("callback must be a function");for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)t.call(this,n,i);return this}},{key:"to1DArray",value:function(){for(var t=[],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)t.push(this.get(n,i));return t}},{key:"to2DArray",value:function(){for(var t=[],n=0;n<this.rows;n++){t.push([]);for(var i=0;i<this.columns;i++)t[n].push(this.get(n,i))}return t}},{key:"toJSON",value:function(){return this.to2DArray()}},{key:"isRowVector",value:function(){return this.rows===1}},{key:"isColumnVector",value:function(){return this.columns===1}},{key:"isVector",value:function(){return this.rows===1||this.columns===1}},{key:"isSquare",value:function(){return this.rows===this.columns}},{key:"isEmpty",value:function(){return this.rows===0||this.columns===0}},{key:"isSymmetric",value:function(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var n=0;n<=t;n++)if(this.get(t,n)!==this.get(n,t))return!1;return!0}return!1}},{key:"isEchelonForm",value:function(){for(var t=0,n=0,i=-1,o=!0,s=!1;t<this.rows&&o;){for(n=0,s=!1;n<this.columns&&s===!1;)this.get(t,n)===0?n++:this.get(t,n)===1&&n>i?(s=!0,i=n):(o=!1,s=!0);t++}return o}},{key:"isReducedEchelonForm",value:function(){for(var t=0,n=0,i=-1,o=!0,s=!1;t<this.rows&&o;){for(n=0,s=!1;n<this.columns&&s===!1;)this.get(t,n)===0?n++:this.get(t,n)===1&&n>i?(s=!0,i=n):(o=!1,s=!0);for(var a=n+1;a<this.rows;a++)this.get(t,a)!==0&&(o=!1);t++}return o}},{key:"echelonForm",value:function(){for(var t=this.clone(),n=0,i=0;n<t.rows&&i<t.columns;){for(var o=n,s=n;s<t.rows;s++)t.get(s,i)>t.get(o,i)&&(o=s);if(t.get(o,i)===0)i++;else{t.swapRows(n,o);for(var a=t.get(n,i),l=i;l<t.columns;l++)t.set(n,l,t.get(n,l)/a);for(var c=n+1;c<t.rows;c++){var u=t.get(c,i)/t.get(n,i);t.set(c,i,0);for(var d=i+1;d<t.columns;d++)t.set(c,d,t.get(c,d)-t.get(n,d)*u)}n++,i++}}return t}},{key:"reducedEchelonForm",value:function(){for(var t=this.echelonForm(),n=t.columns,i=t.rows,o=i-1;o>=0;)if(t.maxRow(o)===0)o--;else{for(var s=0,a=!1;s<i&&a===!1;)t.get(o,s)===1?a=!0:s++;for(var l=0;l<o;l++)for(var c=t.get(l,s),u=s;u<n;u++){var d=t.get(l,u)-c*t.get(o,u);t.set(l,u,d)}o--}return t}},{key:"set",value:function(){throw new Error("set method is unimplemented")}},{key:"get",value:function(){throw new Error("get method is unimplemented")}},{key:"repeat",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof t!="object")throw new TypeError("options must be an object");var n=t.rows,i=n===void 0?1:n,o=t.columns,s=o===void 0?1:o;if(!Number.isInteger(i)||i<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(s)||s<=0)throw new TypeError("columns must be a positive integer");for(var a=new or(this.rows*i,this.columns*s),l=0;l<i;l++)for(var c=0;c<s;c++)a.setSubMatrix(this,this.rows*l,this.columns*c);return a}},{key:"fill",value:function(t){for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,t);return this}},{key:"neg",value:function(){return this.mulS(-1)}},{key:"getRow",value:function(t){Va(this,t);for(var n=[],i=0;i<this.columns;i++)n.push(this.get(t,i));return n}},{key:"getRowVector",value:function(t){return or.rowVector(this.getRow(t))}},{key:"setRow",value:function(t,n){Va(this,t),n=qf(this,n);for(var i=0;i<this.columns;i++)this.set(t,i,n[i]);return this}},{key:"swapRows",value:function(t,n){Va(this,t),Va(this,n);for(var i=0;i<this.columns;i++){var o=this.get(t,i);this.set(t,i,this.get(n,i)),this.set(n,i,o)}return this}},{key:"getColumn",value:function(t){ja(this,t);for(var n=[],i=0;i<this.rows;i++)n.push(this.get(i,t));return n}},{key:"getColumnVector",value:function(t){return or.columnVector(this.getColumn(t))}},{key:"setColumn",value:function(t,n){ja(this,t),n=Jf(this,n);for(var i=0;i<this.rows;i++)this.set(i,t,n[i]);return this}},{key:"swapColumns",value:function(t,n){ja(this,t),ja(this,n);for(var i=0;i<this.rows;i++){var o=this.get(i,t);this.set(i,t,this.get(i,n)),this.set(i,n,o)}return this}},{key:"addRowVector",value:function(t){t=qf(this,t);for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,this.get(n,i)+t[i]);return this}},{key:"subRowVector",value:function(t){t=qf(this,t);for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,this.get(n,i)-t[i]);return this}},{key:"mulRowVector",value:function(t){t=qf(this,t);for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,this.get(n,i)*t[i]);return this}},{key:"divRowVector",value:function(t){t=qf(this,t);for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,this.get(n,i)/t[i]);return this}},{key:"addColumnVector",value:function(t){t=Jf(this,t);for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,this.get(n,i)+t[n]);return this}},{key:"subColumnVector",value:function(t){t=Jf(this,t);for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,this.get(n,i)-t[n]);return this}},{key:"mulColumnVector",value:function(t){t=Jf(this,t);for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,this.get(n,i)*t[n]);return this}},{key:"divColumnVector",value:function(t){t=Jf(this,t);for(var n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.set(n,i,this.get(n,i)/t[n]);return this}},{key:"mulRow",value:function(t,n){Va(this,t);for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*n);return this}},{key:"mulColumn",value:function(t,n){ja(this,t);for(var i=0;i<this.rows;i++)this.set(i,t,this.get(i,t)*n);return this}},{key:"max",value:function(t){if(this.isEmpty())return NaN;switch(t){case"row":{for(var n=new Array(this.rows).fill(Number.NEGATIVE_INFINITY),i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.get(i,o)>n[i]&&(n[i]=this.get(i,o));return n}case"column":{for(var s=new Array(this.columns).fill(Number.NEGATIVE_INFINITY),a=0;a<this.rows;a++)for(var l=0;l<this.columns;l++)this.get(a,l)>s[l]&&(s[l]=this.get(a,l));return s}case void 0:{for(var c=this.get(0,0),u=0;u<this.rows;u++)for(var d=0;d<this.columns;d++)this.get(u,d)>c&&(c=this.get(u,d));return c}default:throw new Error("invalid option: ".concat(t))}}},{key:"maxIndex",value:function(){Qf(this);for(var t=this.get(0,0),n=[0,0],i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.get(i,o)>t&&(t=this.get(i,o),n[0]=i,n[1]=o);return n}},{key:"min",value:function(t){if(this.isEmpty())return NaN;switch(t){case"row":{for(var n=new Array(this.rows).fill(Number.POSITIVE_INFINITY),i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.get(i,o)<n[i]&&(n[i]=this.get(i,o));return n}case"column":{for(var s=new Array(this.columns).fill(Number.POSITIVE_INFINITY),a=0;a<this.rows;a++)for(var l=0;l<this.columns;l++)this.get(a,l)<s[l]&&(s[l]=this.get(a,l));return s}case void 0:{for(var c=this.get(0,0),u=0;u<this.rows;u++)for(var d=0;d<this.columns;d++)this.get(u,d)<c&&(c=this.get(u,d));return c}default:throw new Error("invalid option: ".concat(t))}}},{key:"minIndex",value:function(){Qf(this);for(var t=this.get(0,0),n=[0,0],i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)this.get(i,o)<t&&(t=this.get(i,o),n[0]=i,n[1]=o);return n}},{key:"maxRow",value:function(t){if(Va(this,t),this.isEmpty())return NaN;for(var n=this.get(t,0),i=1;i<this.columns;i++)this.get(t,i)>n&&(n=this.get(t,i));return n}},{key:"maxRowIndex",value:function(t){Va(this,t),Qf(this);for(var n=this.get(t,0),i=[t,0],o=1;o<this.columns;o++)this.get(t,o)>n&&(n=this.get(t,o),i[1]=o);return i}},{key:"minRow",value:function(t){if(Va(this,t),this.isEmpty())return NaN;for(var n=this.get(t,0),i=1;i<this.columns;i++)this.get(t,i)<n&&(n=this.get(t,i));return n}},{key:"minRowIndex",value:function(t){Va(this,t),Qf(this);for(var n=this.get(t,0),i=[t,0],o=1;o<this.columns;o++)this.get(t,o)<n&&(n=this.get(t,o),i[1]=o);return i}},{key:"maxColumn",value:function(t){if(ja(this,t),this.isEmpty())return NaN;for(var n=this.get(0,t),i=1;i<this.rows;i++)this.get(i,t)>n&&(n=this.get(i,t));return n}},{key:"maxColumnIndex",value:function(t){ja(this,t),Qf(this);for(var n=this.get(0,t),i=[0,t],o=1;o<this.rows;o++)this.get(o,t)>n&&(n=this.get(o,t),i[0]=o);return i}},{key:"minColumn",value:function(t){if(ja(this,t),this.isEmpty())return NaN;for(var n=this.get(0,t),i=1;i<this.rows;i++)this.get(i,t)<n&&(n=this.get(i,t));return n}},{key:"minColumnIndex",value:function(t){ja(this,t),Qf(this);for(var n=this.get(0,t),i=[0,t],o=1;o<this.rows;o++)this.get(o,t)<n&&(n=this.get(o,t),i[0]=o);return i}},{key:"diag",value:function(){for(var t=Math.min(this.rows,this.columns),n=[],i=0;i<t;i++)n.push(this.get(i,i));return n}},{key:"norm",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"frobenius",n=0;if(t==="max")return this.max();if(t==="frobenius"){for(var i=0;i<this.rows;i++)for(var o=0;o<this.columns;o++)n=n+this.get(i,o)*this.get(i,o);return Math.sqrt(n)}else throw new RangeError("unknown norm type: ".concat(t))}},{key:"cumulativeSum",value:function(){for(var t=0,n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)t+=this.get(n,i),this.set(n,i,t);return this}},{key:"dot",value:function(t){r.isMatrix(t)&&(t=t.to1DArray());var n=this.to1DArray();if(n.length!==t.length)throw new RangeError("vectors do not have the same size");for(var i=0,o=0;o<n.length;o++)i+=n[o]*t[o];return i}},{key:"mmul",value:function(t){t=or.checkMatrix(t);for(var n=this.rows,i=this.columns,o=t.columns,s=new or(n,o),a=new Float64Array(i),l=0;l<o;l++){for(var c=0;c<i;c++)a[c]=t.get(c,l);for(var u=0;u<n;u++){for(var d=0,h=0;h<i;h++)d+=this.get(u,h)*a[h];s.set(u,l,d)}}return s}},{key:"strassen2x2",value:function(t){t=or.checkMatrix(t);var n=new or(2,2),i=this.get(0,0),o=t.get(0,0),s=this.get(0,1),a=t.get(0,1),l=this.get(1,0),c=t.get(1,0),u=this.get(1,1),d=t.get(1,1),h=(i+u)*(o+d),f=(l+u)*o,p=i*(a-d),g=u*(c-o),v=(i+s)*d,y=(l-i)*(o+a),x=(s-u)*(c+d),E=h+g-v+x,T=p+v,P=f+g,z=h-f+p+y;return n.set(0,0,E),n.set(0,1,T),n.set(1,0,P),n.set(1,1,z),n}},{key:"strassen3x3",value:function(t){t=or.checkMatrix(t);var n=new or(3,3),i=this.get(0,0),o=this.get(0,1),s=this.get(0,2),a=this.get(1,0),l=this.get(1,1),c=this.get(1,2),u=this.get(2,0),d=this.get(2,1),h=this.get(2,2),f=t.get(0,0),p=t.get(0,1),g=t.get(0,2),v=t.get(1,0),y=t.get(1,1),x=t.get(1,2),E=t.get(2,0),T=t.get(2,1),P=t.get(2,2),z=(i+o+s-a-l-d-h)*y,$=(i-a)*(-p+y),ne=l*(-f+p+v-y-x-E+P),De=(-i+a+l)*(f-p+y),fe=(a+l)*(-f+p),Ae=i*f,de=(-i+u+d)*(f-g+x),ct=(-i+u)*(g-x),bt=(u+d)*(-f+g),Pe=(i+o+s-l-c-u-d)*x,tt=d*(-f+g+v-y-x-E+T),Kt=(-s+d+h)*(y+E-T),tn=(s-h)*(y-T),Bn=s*E,cr=(d+h)*(-E+T),gn=(-s+l+c)*(x+E-P),si=(s-c)*(x-P),xi=(l+c)*(-E+P),Nt=o*v,fn=c*T,Kn=a*g,Pn=u*p,vr=h*P,Gn=Ae+Bn+Nt,ci=z+De+fe+Ae+Kt+Bn+cr,Bo=Ae+de+bt+Pe+Bn+gn+xi,ui=$+ne+De+Ae+Bn+gn+si,Aa=$+De+fe+Ae+fn,Ta=Bn+gn+si+xi+Kn,Gu=Ae+de+ct+tt+Kt+tn+Bn,Dc=Kt+tn+Bn+cr+Pn,Fu=Ae+de+ct+bt+vr;return n.set(0,0,Gn),n.set(0,1,ci),n.set(0,2,Bo),n.set(1,0,ui),n.set(1,1,Aa),n.set(1,2,Ta),n.set(2,0,Gu),n.set(2,1,Dc),n.set(2,2,Fu),n}},{key:"mmulStrassen",value:function(t){t=or.checkMatrix(t);var n=this.clone(),i=n.rows,o=n.columns,s=t.rows,a=t.columns;o!==s&&console.warn("Multiplying ".concat(i," x ").concat(o," and ").concat(s," x ").concat(a," matrix: dimensions do not match."));function l(h,f,p){var g=h.rows,v=h.columns;if(g===f&&v===p)return h;var y=r.zeros(f,p);return y=y.setSubMatrix(h,0,0),y}var c=Math.max(i,s),u=Math.max(o,a);n=l(n,c,u),t=l(t,c,u);function d(h,f,p,g){if(p<=512||g<=512)return h.mmul(f);p%2==1&&g%2==1?(h=l(h,p+1,g+1),f=l(f,p+1,g+1)):p%2==1?(h=l(h,p+1,g),f=l(f,p+1,g)):g%2==1&&(h=l(h,p,g+1),f=l(f,p,g+1));var v=parseInt(h.rows/2,10),y=parseInt(h.columns/2,10),x=h.subMatrix(0,v-1,0,y-1),E=f.subMatrix(0,v-1,0,y-1),T=h.subMatrix(0,v-1,y,h.columns-1),P=f.subMatrix(0,v-1,y,f.columns-1),z=h.subMatrix(v,h.rows-1,0,y-1),$=f.subMatrix(v,f.rows-1,0,y-1),ne=h.subMatrix(v,h.rows-1,y,h.columns-1),De=f.subMatrix(v,f.rows-1,y,f.columns-1),fe=d(r.add(x,ne),r.add(E,De),v,y),Ae=d(r.add(z,ne),E,v,y),de=d(x,r.sub(P,De),v,y),ct=d(ne,r.sub($,E),v,y),bt=d(r.add(x,T),De,v,y),Pe=d(r.sub(z,x),r.add(E,P),v,y),tt=d(r.sub(T,ne),r.add($,De),v,y),Kt=r.add(fe,ct);Kt.sub(bt),Kt.add(tt);var tn=r.add(de,bt),Bn=r.add(Ae,ct),cr=r.sub(fe,Ae);cr.add(de),cr.add(Pe);var gn=r.zeros(2*Kt.rows,2*Kt.columns);return gn=gn.setSubMatrix(Kt,0,0),gn=gn.setSubMatrix(tn,Kt.rows,0),gn=gn.setSubMatrix(Bn,0,Kt.columns),gn=gn.setSubMatrix(cr,Kt.rows,Kt.columns),gn.subMatrix(0,p-1,0,g-1)}return d(n,t,c,u)}},{key:"scaleRows",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof t!="object")throw new TypeError("options must be an object");var n=t.min,i=n===void 0?0:n,o=t.max,s=o===void 0?1:o;if(!Number.isFinite(i))throw new TypeError("min must be a number");if(!Number.isFinite(s))throw new TypeError("max must be a number");if(i>=s)throw new RangeError("min must be smaller than max");for(var a=new or(this.rows,this.columns),l=0;l<this.rows;l++){var c=this.getRow(l);c.length>0&&tP(c,{min:i,max:s,output:c}),a.setRow(l,c)}return a}},{key:"scaleColumns",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof t!="object")throw new TypeError("options must be an object");var n=t.min,i=n===void 0?0:n,o=t.max,s=o===void 0?1:o;if(!Number.isFinite(i))throw new TypeError("min must be a number");if(!Number.isFinite(s))throw new TypeError("max must be a number");if(i>=s)throw new RangeError("min must be smaller than max");for(var a=new or(this.rows,this.columns),l=0;l<this.columns;l++){var c=this.getColumn(l);c.length&&tP(c,{min:i,max:s,output:c}),a.setColumn(l,c)}return a}},{key:"flipRows",value:function(){for(var t=Math.ceil(this.columns/2),n=0;n<this.rows;n++)for(var i=0;i<t;i++){var o=this.get(n,i),s=this.get(n,this.columns-1-i);this.set(n,i,s),this.set(n,this.columns-1-i,o)}return this}},{key:"flipColumns",value:function(){for(var t=Math.ceil(this.rows/2),n=0;n<this.columns;n++)for(var i=0;i<t;i++){var o=this.get(i,n),s=this.get(this.rows-1-i,n);this.set(i,n,s),this.set(this.rows-1-i,n,o)}return this}},{key:"kroneckerProduct",value:function(t){t=or.checkMatrix(t);for(var n=this.rows,i=this.columns,o=t.rows,s=t.columns,a=new or(n*o,i*s),l=0;l<n;l++)for(var c=0;c<i;c++)for(var u=0;u<o;u++)for(var d=0;d<s;d++)a.set(o*l+u,s*c+d,this.get(l,c)*t.get(u,d));return a}},{key:"kroneckerSum",value:function(t){if(t=or.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");var n=this.rows,i=t.rows,o=this.kroneckerProduct(or.eye(i,i)),s=or.eye(n,n).kroneckerProduct(t);return o.add(s)}},{key:"transpose",value:function(){for(var t=new or(this.columns,this.rows),n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)t.set(i,n,this.get(n,i));return t}},{key:"sortRows",value:function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sP,n=0;n<this.rows;n++)this.setRow(n,this.getRow(n).sort(t));return this}},{key:"sortColumns",value:function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sP,n=0;n<this.columns;n++)this.setColumn(n,this.getColumn(n).sort(t));return this}},{key:"subMatrix",value:function(t,n,i,o){oP(this,t,n,i,o);for(var s=new or(n-t+1,o-i+1),a=t;a<=n;a++)for(var l=i;l<=o;l++)s.set(a-t,l-i,this.get(a,l));return s}},{key:"subMatrixRow",value:function(t,n,i){if(n===void 0&&(n=0),i===void 0&&(i=this.columns-1),n>i||n<0||n>=this.columns||i<0||i>=this.columns)throw new RangeError("Argument out of range");for(var o=new or(t.length,i-n+1),s=0;s<t.length;s++)for(var a=n;a<=i;a++){if(t[s]<0||t[s]>=this.rows)throw new RangeError("Row index out of range: ".concat(t[s]));o.set(s,a-n,this.get(t[s],a))}return o}},{key:"subMatrixColumn",value:function(t,n,i){if(n===void 0&&(n=0),i===void 0&&(i=this.rows-1),n>i||n<0||n>=this.rows||i<0||i>=this.rows)throw new RangeError("Argument out of range");for(var o=new or(i-n+1,t.length),s=0;s<t.length;s++)for(var a=n;a<=i;a++){if(t[s]<0||t[s]>=this.columns)throw new RangeError("Column index out of range: ".concat(t[s]));o.set(a-n,s,this.get(a,t[s]))}return o}},{key:"setSubMatrix",value:function(t,n,i){if(t=or.checkMatrix(t),t.isEmpty())return this;var o=n+t.rows-1,s=i+t.columns-1;oP(this,n,o,i,s);for(var a=0;a<t.rows;a++)for(var l=0;l<t.columns;l++)this.set(n+a,i+l,t.get(a,l));return this}},{key:"selection",value:function(t,n){zj(this,t),Uj(this,n);for(var i=new or(t.length,n.length),o=0;o<t.length;o++)for(var s=t[o],a=0;a<n.length;a++){var l=n[a];i.set(o,a,this.get(s,l))}return i}},{key:"trace",value:function(){for(var t=Math.min(this.rows,this.columns),n=0,i=0;i<t;i++)n+=this.get(i,i);return n}},{key:"clone",value:function(){for(var t=new or(this.rows,this.columns),n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)t.set(n,i,this.get(n,i));return t}},{key:"sum",value:function(t){switch(t){case"row":return Vj(this);case"column":return jj(this);case void 0:return Hj(this);default:throw new Error("invalid option: ".concat(t))}}},{key:"product",value:function(t){switch(t){case"row":return $j(this);case"column":return Wj(this);case void 0:return Zj(this);default:throw new Error("invalid option: ".concat(t))}}},{key:"mean",value:function(t){var n=this.sum(t);switch(t){case"row":{for(var i=0;i<this.rows;i++)n[i]/=this.columns;return n}case"column":{for(var o=0;o<this.columns;o++)n[o]/=this.rows;return n}case void 0:return n/this.size;default:throw new Error("invalid option: ".concat(t))}}},{key:"variance",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof t=="object"&&(n=t,t=void 0),typeof n!="object")throw new TypeError("options must be an object");var i=n,o=i.unbiased,s=o===void 0?!0:o,a=i.mean,l=a===void 0?this.mean(t):a;if(typeof s!="boolean")throw new TypeError("unbiased must be a boolean");switch(t){case"row":{if(!oa(l))throw new TypeError("mean must be an array");return Xj(this,s,l)}case"column":{if(!oa(l))throw new TypeError("mean must be an array");return Yj(this,s,l)}case void 0:{if(typeof l!="number")throw new TypeError("mean must be a number");return Kj(this,s,l)}default:throw new Error("invalid option: ".concat(t))}}},{key:"standardDeviation",value:function(t,n){typeof t=="object"&&(n=t,t=void 0);var i=this.variance(t,n);if(t===void 0)return Math.sqrt(i);for(var o=0;o<i.length;o++)i[o]=Math.sqrt(i[o]);return i}},{key:"center",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof t=="object"&&(n=t,t=void 0),typeof n!="object")throw new TypeError("options must be an object");var i=n,o=i.center,s=o===void 0?this.mean(t):o;switch(t){case"row":{if(!oa(s))throw new TypeError("center must be an array");return qj(this,s),this}case"column":{if(!oa(s))throw new TypeError("center must be an array");return Jj(this,s),this}case void 0:{if(typeof s!="number")throw new TypeError("center must be a number");return Qj(this,s),this}default:throw new Error("invalid option: ".concat(t))}}},{key:"scale",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof t=="object"&&(n=t,t=void 0),typeof n!="object")throw new TypeError("options must be an object");var i=n.scale;switch(t){case"row":{if(i===void 0)i=eH(this);else if(!oa(i))throw new TypeError("scale must be an array");return tH(this,i),this}case"column":{if(i===void 0)i=nH(this);else if(!oa(i))throw new TypeError("scale must be an array");return rH(this,i),this}case void 0:{if(i===void 0)i=iH(this);else if(typeof i!="number")throw new TypeError("scale must be a number");return oH(this,i),this}default:throw new Error("invalid option: ".concat(t))}}},{key:"toString",value:function(t){return rP(this,t)}}],[{key:"from1DArray",value:function(t,n,i){var o=t*n;if(o!==i.length)throw new RangeError("data length does not match given dimensions");for(var s=new or(t,n),a=0;a<t;a++)for(var l=0;l<n;l++)s.set(a,l,i[a*n+l]);return s}},{key:"rowVector",value:function(t){for(var n=new or(1,t.length),i=0;i<t.length;i++)n.set(0,i,t[i]);return n}},{key:"columnVector",value:function(t){for(var n=new or(t.length,1),i=0;i<t.length;i++)n.set(i,0,t[i]);return n}},{key:"zeros",value:function(t,n){return new or(t,n)}},{key:"ones",value:function(t,n){return new or(t,n).fill(1)}},{key:"rand",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof i!="object")throw new TypeError("options must be an object");for(var o=i.random,s=o===void 0?Math.random:o,a=new or(t,n),l=0;l<t;l++)for(var c=0;c<n;c++)a.set(l,c,s());return a}},{key:"randInt",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof i!="object")throw new TypeError("options must be an object");var o=i.min,s=o===void 0?0:o,a=i.max,l=a===void 0?1e3:a,c=i.random,u=c===void 0?Math.random:c;if(!Number.isInteger(s))throw new TypeError("min must be an integer");if(!Number.isInteger(l))throw new TypeError("max must be an integer");if(s>=l)throw new RangeError("min must be smaller than max");for(var d=l-s,h=new or(t,n),f=0;f<t;f++)for(var p=0;p<n;p++){var g=s+Math.round(u()*d);h.set(f,p,g)}return h}},{key:"eye",value:function(t,n,i){n===void 0&&(n=t),i===void 0&&(i=1);for(var o=Math.min(t,n),s=this.zeros(t,n),a=0;a<o;a++)s.set(a,a,i);return s}},{key:"diag",value:function(t,n,i){var o=t.length;n===void 0&&(n=o),i===void 0&&(i=n);for(var s=Math.min(o,n,i),a=this.zeros(n,i),l=0;l<s;l++)a.set(l,l,t[l]);return a}},{key:"min",value:function(t,n){t=this.checkMatrix(t),n=this.checkMatrix(n);for(var i=t.rows,o=t.columns,s=new or(i,o),a=0;a<i;a++)for(var l=0;l<o;l++)s.set(a,l,Math.min(t.get(a,l),n.get(a,l)));return s}},{key:"max",value:function(t,n){t=this.checkMatrix(t),n=this.checkMatrix(n);for(var i=t.rows,o=t.columns,s=new this(i,o),a=0;a<i;a++)for(var l=0;l<o;l++)s.set(a,l,Math.max(t.get(a,l),n.get(a,l)));return s}},{key:"checkMatrix",value:function(t){return r.isMatrix(t)?t:new or(t)}},{key:"isMatrix",value:function(t){return t!=null&&t.klass==="Matrix"}}]),r}();Lo.prototype.klass="Matrix",typeof Symbol!="undefined"&&(Lo.prototype[Symbol.for("nodejs.util.inspect.custom")]=Lj);function sP(r,e){return r-e}function sH(r){return r.every(function(e){return typeof e=="number"})}Lo.random=Lo.rand,Lo.randomInt=Lo.randInt,Lo.diagonal=Lo.diag,Lo.prototype.diagonal=Lo.prototype.diag,Lo.identity=Lo.eye,Lo.prototype.negate=Lo.prototype.neg,Lo.prototype.tensorProduct=Lo.prototype.kroneckerProduct;var or=function(r){(0,QM.Z)(t,r);var e=(0,eP.Z)(t);function t(n,i){var o;if((0,Sb.Z)(this,t),o=e.call(this),t.isMatrix(n))return(0,Nj.Z)(o,n.clone());if(Number.isInteger(n)&&n>=0)if(o.data=[],Number.isInteger(i)&&i>=0)for(var s=0;s<n;s++)o.data.push(new Float64Array(i));else throw new TypeError("nColumns must be a positive integer");else if(oa(n)){var a=n;if(n=a.length,i=n?a[0].length:0,typeof i!="number")throw new TypeError("Data must be a 2D array with at least one element");o.data=[];for(var l=0;l<n;l++){if(a[l].length!==i)throw new RangeError("Inconsistent array dimensions");if(!sH(a[l]))throw new TypeError("Input data contains non-numeric values");o.data.push(Float64Array.from(a[l]))}}else throw new TypeError("First argument must be a positive number or an array");return o.rows=n,o.columns=i,o}return(0,_b.Z)(t,[{key:"set",value:function(i,o,s){return this.data[i][o]=s,this}},{key:"get",value:function(i,o){return this.data[i][o]}},{key:"removeRow",value:function(i){return Va(this,i),this.data.splice(i,1),this.rows-=1,this}},{key:"addRow",value:function(i,o){return o===void 0&&(o=i,i=this.rows),Va(this,i,!0),o=Float64Array.from(qf(this,o)),this.data.splice(i,0,o),this.rows+=1,this}},{key:"removeColumn",value:function(i){ja(this,i);for(var o=0;o<this.rows;o++){for(var s=new Float64Array(this.columns-1),a=0;a<i;a++)s[a]=this.data[o][a];for(var l=i+1;l<this.columns;l++)s[l-1]=this.data[o][l];this.data[o]=s}return this.columns-=1,this}},{key:"addColumn",value:function(i,o){typeof o=="undefined"&&(o=i,i=this.columns),ja(this,i,!0),o=Jf(this,o);for(var s=0;s<this.rows;s++){for(var a=new Float64Array(this.columns+1),l=0;l<i;l++)a[l]=this.data[s][l];for(a[l++]=o[s];l<this.columns+1;l++)a[l]=this.data[s][l-1];this.data[s]=a}return this.columns+=1,this}}]),t}(Lo);Bj(Lo,or);var aH=function(r){(0,QM.Z)(t,r);var e=(0,eP.Z)(t);function t(n){var i;return(0,Sb.Z)(this,t),i=e.call(this),i.data=n,i.rows=n.length,i.columns=n[0].length,i}return(0,_b.Z)(t,[{key:"set",value:function(i,o,s){return this.data[i][o]=s,this}},{key:"get",value:function(i,o){return this.data[i][o]}}]),t}(Lo);function ep(r,e){var t=0;return Math.abs(r)>Math.abs(e)?(t=e/r,Math.abs(r)*Math.sqrt(1+t*t)):e!==0?(t=r/e,Math.abs(e)*Math.sqrt(1+t*t)):0}var aP=function(){function r(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if((0,Sb.Z)(this,r),e=aH.checkMatrix(e),e.isEmpty())throw new Error("Matrix must be non-empty");var n=e.rows,i=e.columns,o=t.computeLeftSingularVectors,s=o===void 0?!0:o,a=t.computeRightSingularVectors,l=a===void 0?!0:a,c=t.autoTranspose,u=c===void 0?!1:c,d=Boolean(s),h=Boolean(l),f=!1,p;if(n<i)if(!u)p=e.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{p=e.transpose(),n=p.rows,i=p.columns,f=!0;var g=d;d=h,h=g}else p=e.clone();for(var v=Math.min(n,i),y=Math.min(n+1,i),x=new Float64Array(y),E=new or(n,v),T=new or(i,i),P=new Float64Array(i),z=new Float64Array(n),$=new Float64Array(y),ne=0;ne<y;ne++)$[ne]=ne;for(var De=Math.min(n-1,i),fe=Math.max(0,Math.min(i-2,n)),Ae=Math.max(De,fe),de=0;de<Ae;de++){if(de<De){x[de]=0;for(var ct=de;ct<n;ct++)x[de]=ep(x[de],p.get(ct,de));if(x[de]!==0){p.get(de,de)<0&&(x[de]=-x[de]);for(var bt=de;bt<n;bt++)p.set(bt,de,p.get(bt,de)/x[de]);p.set(de,de,p.get(de,de)+1)}x[de]=-x[de]}for(var Pe=de+1;Pe<i;Pe++){if(de<De&&x[de]!==0){for(var tt=0,Kt=de;Kt<n;Kt++)tt+=p.get(Kt,de)*p.get(Kt,Pe);tt=-tt/p.get(de,de);for(var tn=de;tn<n;tn++)p.set(tn,Pe,p.get(tn,Pe)+tt*p.get(tn,de))}P[Pe]=p.get(de,Pe)}if(d&&de<De)for(var Bn=de;Bn<n;Bn++)E.set(Bn,de,p.get(Bn,de));if(de<fe){P[de]=0;for(var cr=de+1;cr<i;cr++)P[de]=ep(P[de],P[cr]);if(P[de]!==0){P[de+1]<0&&(P[de]=0-P[de]);for(var gn=de+1;gn<i;gn++)P[gn]/=P[de];P[de+1]+=1}if(P[de]=-P[de],de+1<n&&P[de]!==0){for(var si=de+1;si<n;si++)z[si]=0;for(var xi=de+1;xi<n;xi++)for(var Nt=de+1;Nt<i;Nt++)z[xi]+=P[Nt]*p.get(xi,Nt);for(var fn=de+1;fn<i;fn++)for(var Kn=-P[fn]/P[de+1],Pn=de+1;Pn<n;Pn++)p.set(Pn,fn,p.get(Pn,fn)+Kn*z[Pn])}if(h)for(var vr=de+1;vr<i;vr++)T.set(vr,de,P[vr])}}var Gn=Math.min(i,n+1);if(De<i&&(x[De]=p.get(De,De)),n<Gn&&(x[Gn-1]=0),fe+1<Gn&&(P[fe]=p.get(fe,Gn-1)),P[Gn-1]=0,d){for(var ci=De;ci<v;ci++){for(var Bo=0;Bo<n;Bo++)E.set(Bo,ci,0);E.set(ci,ci,1)}for(var ui=De-1;ui>=0;ui--)if(x[ui]!==0){for(var Aa=ui+1;Aa<v;Aa++){for(var Ta=0,Gu=ui;Gu<n;Gu++)Ta+=E.get(Gu,ui)*E.get(Gu,Aa);Ta=-Ta/E.get(ui,ui);for(var Dc=ui;Dc<n;Dc++)E.set(Dc,Aa,E.get(Dc,Aa)+Ta*E.get(Dc,ui))}for(var Fu=ui;Fu<n;Fu++)E.set(Fu,ui,-E.get(Fu,ui));E.set(ui,ui,1+E.get(ui,ui));for(var Pm=0;Pm<ui-1;Pm++)E.set(Pm,ui,0)}else{for(var dh=0;dh<n;dh++)E.set(dh,ui,0);E.set(ui,ui,1)}}if(h)for(var gs=i-1;gs>=0;gs--){if(gs<fe&&P[gs]!==0)for(var hh=gs+1;hh<i;hh++){for(var Tp=0,Bu=gs+1;Bu<i;Bu++)Tp+=T.get(Bu,gs)*T.get(Bu,hh);Tp=-Tp/T.get(gs+1,gs);for(var qe=gs+1;qe<i;qe++)T.set(qe,hh,T.get(qe,hh)+Tp*T.get(qe,gs))}for(var Ot=0;Ot<i;Ot++)T.set(Ot,gs,0);T.set(gs,gs,1)}for(var Jt=Gn-1,hn=0,$n=Number.EPSILON;Gn>0;){var bn=void 0,yr=void 0;for(bn=Gn-2;bn>=-1&&bn!==-1;bn--){var zr=Number.MIN_VALUE+$n*Math.abs(x[bn]+Math.abs(x[bn+1]));if(Math.abs(P[bn])<=zr||Number.isNaN(P[bn])){P[bn]=0;break}}if(bn===Gn-2)yr=4;else{var Tn=void 0;for(Tn=Gn-1;Tn>=bn&&Tn!==bn;Tn--){var ti=(Tn!==Gn?Math.abs(P[Tn]):0)+(Tn!==bn+1?Math.abs(P[Tn-1]):0);if(Math.abs(x[Tn])<=$n*ti){x[Tn]=0;break}}Tn===bn?yr=3:Tn===Gn-1?yr=1:(yr=2,bn=Tn)}switch(bn++,yr){case 1:{var Kr=P[Gn-2];P[Gn-2]=0;for(var Eo=Gn-2;Eo>=bn;Eo--){var zu=ep(x[Eo],Kr),FE=x[Eo]/zu,BE=Kr/zu;if(x[Eo]=zu,Eo!==bn&&(Kr=-BE*P[Eo-1],P[Eo-1]=FE*P[Eo-1]),h)for(var Uu=0;Uu<i;Uu++)zu=FE*T.get(Uu,Eo)+BE*T.get(Uu,Gn-1),T.set(Uu,Gn-1,-BE*T.get(Uu,Eo)+FE*T.get(Uu,Gn-1)),T.set(Uu,Eo,zu)}break}case 2:{var zE=P[bn-1];P[bn-1]=0;for(var Za=bn;Za<Gn;Za++){var Om=ep(x[Za],zE),UE=x[Za]/Om,VE=zE/Om;if(x[Za]=Om,zE=-VE*P[Za],P[Za]=UE*P[Za],d)for(var Vu=0;Vu<n;Vu++)Om=UE*E.get(Vu,Za)+VE*E.get(Vu,bn-1),E.set(Vu,bn-1,-VE*E.get(Vu,Za)+UE*E.get(Vu,bn-1)),E.set(Vu,Za,Om)}break}case 3:{var Dm=Math.max(Math.abs(x[Gn-1]),Math.abs(x[Gn-2]),Math.abs(P[Gn-2]),Math.abs(x[bn]),Math.abs(P[bn])),Mp=x[Gn-1]/Dm,Qk=x[Gn-2]/Dm,dx=P[Gn-2]/Dm,jE=x[bn]/Dm,BQ=P[bn]/Dm,fh=((Qk+Mp)*(Qk-Mp)+dx*dx)/2,hx=Mp*dx*(Mp*dx),Nm=0;(fh!==0||hx!==0)&&(fh<0?Nm=0-Math.sqrt(fh*fh+hx):Nm=Math.sqrt(fh*fh+hx),Nm=hx/(fh+Nm));for(var ph=(jE+Mp)*(jE-Mp)+Nm,Pp=jE*BQ,ni=bn;ni<Gn-1;ni++){var Os=ep(ph,Pp);Os===0&&(Os=Number.MIN_VALUE);var Xa=ph/Os,Ya=Pp/Os;if(ni!==bn&&(P[ni-1]=Os),ph=Xa*x[ni]+Ya*P[ni],P[ni]=Xa*P[ni]-Ya*x[ni],Pp=Ya*x[ni+1],x[ni+1]=Xa*x[ni+1],h)for(var ju=0;ju<i;ju++)Os=Xa*T.get(ju,ni)+Ya*T.get(ju,ni+1),T.set(ju,ni+1,-Ya*T.get(ju,ni)+Xa*T.get(ju,ni+1)),T.set(ju,ni,Os);if(Os=ep(ph,Pp),Os===0&&(Os=Number.MIN_VALUE),Xa=ph/Os,Ya=Pp/Os,x[ni]=Os,ph=Xa*P[ni]+Ya*x[ni+1],x[ni+1]=-Ya*P[ni]+Xa*x[ni+1],Pp=Ya*P[ni+1],P[ni+1]=Xa*P[ni+1],d&&ni<n-1)for(var Hu=0;Hu<n;Hu++)Os=Xa*E.get(Hu,ni)+Ya*E.get(Hu,ni+1),E.set(Hu,ni+1,-Ya*E.get(Hu,ni)+Xa*E.get(Hu,ni+1)),E.set(Hu,ni,Os)}P[Gn-2]=ph,hn=hn+1;break}case 4:{if(x[bn]<=0&&(x[bn]=x[bn]<0?-x[bn]:0,h))for(var fx=0;fx<=Jt;fx++)T.set(fx,bn,-T.get(fx,bn));for(;bn<Jt&&!(x[bn]>=x[bn+1]);){var Rm=x[bn];if(x[bn]=x[bn+1],x[bn+1]=Rm,h&&bn<i-1)for(var Op=0;Op<i;Op++)Rm=T.get(Op,bn+1),T.set(Op,bn+1,T.get(Op,bn)),T.set(Op,bn,Rm);if(d&&bn<n-1)for(var Dp=0;Dp<n;Dp++)Rm=E.get(Dp,bn+1),E.set(Dp,bn+1,E.get(Dp,bn)),E.set(Dp,bn,Rm);bn++}hn=0,Gn--;break}}}if(f){var zQ=T;T=E,E=zQ}this.m=n,this.n=i,this.s=x,this.U=E,this.V=T}return(0,_b.Z)(r,[{key:"solve",value:function(t){for(var n=t,i=this.threshold,o=this.s.length,s=or.zeros(o,o),a=0;a<o;a++)Math.abs(this.s[a])<=i?s.set(a,a,0):s.set(a,a,1/this.s[a]);for(var l=this.U,c=this.rightSingularVectors,u=c.mmul(s),d=c.rows,h=l.rows,f=or.zeros(d,h),p=0;p<d;p++)for(var g=0;g<h;g++){for(var v=0,y=0;y<o;y++)v+=u.get(p,y)*l.get(g,y);f.set(p,g,v)}return f.mmul(n)}},{key:"solveForDiagonal",value:function(t){return this.solve(or.diag(t))}},{key:"inverse",value:function(){for(var t=this.V,n=this.threshold,i=t.rows,o=t.columns,s=new or(i,this.s.length),a=0;a<i;a++)for(var l=0;l<o;l++)Math.abs(this.s[l])>n&&s.set(a,l,t.get(a,l)/this.s[l]);for(var c=this.U,u=c.rows,d=c.columns,h=new or(i,u),f=0;f<i;f++)for(var p=0;p<u;p++){for(var g=0,v=0;v<d;v++)g+=s.get(f,v)*c.get(p,v);h.set(f,p,g)}return h}},{key:"condition",get:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}},{key:"norm2",get:function(){return this.s[0]}},{key:"rank",get:function(){for(var t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,n=0,i=this.s,o=0,s=i.length;o<s;o++)i[o]>t&&n++;return n}},{key:"diagonal",get:function(){return Array.from(this.s)}},{key:"threshold",get:function(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}},{key:"leftSingularVectors",get:function(){return this.U}},{key:"rightSingularVectors",get:function(){return this.V}},{key:"diagonalMatrix",get:function(){return or.diag(this.s)}}]),r}();class lH{constructor(e){this.distances=e.distances,this.dimension=e.dimension||2,this.linkDistance=e.linkDistance}layout(){const e=this,{dimension:t,distances:n,linkDistance:i}=e;try{const o=or.mul(or.pow(n,2),-.5),s=o.mean("row"),a=o.mean("column"),l=o.mean();o.add(l).subRowVector(s).subColumnVector(a);const c=new aP(o),u=or.sqrt(c.diagonalMatrix).diagonal();return c.leftSingularVectors.toJSON().map(d=>or.mul([d],[u]).toJSON()[0].splice(0,t))}catch(o){const s=[];for(let a=0;a<n.length;a++){const l=Math.random()*i,c=Math.random()*i;s.push([l,c])}return s}}}const cH=800;class uH{constructor(e){this.disp=[],this.positions=e.positions,this.adjMatrix=e.adjMatrix,this.focusID=e.focusID,this.radii=e.radii,this.iterations=e.iterations||10,this.height=e.height||10,this.width=e.width||10,this.speed=e.speed||100,this.gravity=e.gravity||10,this.nodeSizeFunc=e.nodeSizeFunc,this.k=e.k||5,this.strictRadial=e.strictRadial,this.nodes=e.nodes}layout(){const e=this,t=e.positions,n=[],i=e.iterations,o=e.width/10;e.maxDisplace=o,e.disp=n;for(let s=0;s<i;s++)t.forEach((a,l)=>{n[l]={x:0,y:0}}),e.getRepulsion(),e.updatePositions();return t}getRepulsion(){const e=this,t=e.positions,n=e.nodes,i=e.disp,o=e.k,s=e.radii||[];t.forEach((a,l)=>{i[l]={x:0,y:0},t.forEach((c,u)=>{if(l===u||s[l]!==s[u])return;let d=a[0]-c[0],h=a[1]-c[1],f=Math.sqrt(d*d+h*h);if(f===0){f=1;const p=l>u?1:-1;d=.01*p,h=.01*p}if(f<e.nodeSizeFunc(n[l])/2+e.nodeSizeFunc(n[u])/2){const p=o*o/f;i[l].x+=d/f*p,i[l].y+=h/f*p}})})}updatePositions(){const e=this,t=e.positions,n=e.disp,i=e.speed,o=e.strictRadial,s=e.focusID,a=e.maxDisplace||e.width/10;o&&n.forEach((c,u)=>{const d=t[u][0]-t[s][0],h=t[u][1]-t[s][1],f=Math.sqrt(d*d+h*h);let p=h/f,g=-d/f;const v=Math.sqrt(c.x*c.x+c.y*c.y);let y=Math.acos((p*c.x+g*c.y)/v);y>Math.PI/2&&(y-=Math.PI/2,p*=-1,g*=-1);const x=Math.cos(y)*v;c.x=p*x,c.y=g*x});const l=e.radii;t.forEach((c,u)=>{if(u===s)return;const d=Math.sqrt(n[u].x*n[u].x+n[u].y*n[u].y);if(d>0&&u!==s){const h=Math.min(a*(i/cH),d);if(c[0]+=n[u].x/d*h,c[1]+=n[u].y/d*h,o){let f=c[0]-t[s][0],p=c[1]-t[s][1];const g=Math.sqrt(f*f+p*p);f=f/g*l[u],p=p/g*l[u],c[0]=t[s][0]+f,c[1]=t[s][1]+p}}})}}function dH(r){const e=r.length,t=r[0].length,n=[];for(let i=0;i<e;i++){const o=[];for(let s=0;s<t;s++)r[i][s]!==0?o.push(1/(r[i][s]*r[i][s])):o.push(0);n.push(o)}return n}function hH(r,e){let t=-1;return r.forEach((n,i)=>{n.id===e&&(t=i)}),t}function lP(r,e){return Math.sqrt((r[0]-e[0])*(r[0]-e[0])+(r[1]-e[1])*(r[1]-e[1]))}class fH extends _s{constructor(e){super();this.maxIteration=1e3,this.focusNode=null,this.unitRadius=null,this.linkDistance=50,this.preventOverlap=!1,this.strictRadial=!0,this.maxPreventOverlapIteration=200,this.sortStrength=10,this.nodes=[],this.edges=[],this.updateCfg(e)}getDefaultCfg(){return{maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,strictRadial:!0,maxPreventOverlapIteration:200,sortBy:void 0,sortStrength:10}}execute(){const e=this,t=e.nodes,n=e.edges||[];if(!t||t.length===0){e.onLayoutEnd&&e.onLayoutEnd();return}!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const i=e.center;if(t.length===1){t[0].x=i[0],t[0].y=i[1],e.onLayoutEnd&&e.onLayoutEnd();return}const o=e.linkDistance;let s=null;if(M0(e.focusNode)){let Ae=!1;for(let de=0;de<t.length;de++)t[de].id===e.focusNode&&(s=t[de],e.focusNode=s,Ae=!0,de=t.length);Ae||(s=null)}else s=e.focusNode;s||(s=t[0],e.focusNode=s);const a=hH(t,s.id);e.focusIndex=a;const l=qT({nodes:t,edges:n},!1),c=KT(l),u=e.maxToFocus(c,a);e.handleInfinity(c,a,u+1),e.distances=c;const d=c[a],h=e.width||500,f=e.height||500;let p=h-i[0]>i[0]?i[0]:h-i[0],g=f-i[1]>i[1]?i[1]:f-i[1];p===0&&(p=h/2),g===0&&(g=f/2);const v=g>p?p:g,y=Math.max(...d),x=[];d.forEach((Ae,de)=>{e.unitRadius||(e.unitRadius=v/y),x[de]=Ae*e.unitRadius}),e.radii=x;const E=e.eIdealDisMatrix();e.eIdealDistances=E;const T=dH(E);e.weights=T;let z=new lH({linkDistance:o,distances:E}).layout();z.forEach(Ae=>{gb(Ae[0])&&(Ae[0]=Math.random()*o),gb(Ae[1])&&(Ae[1]=Math.random()*o)}),e.positions=z,z.forEach((Ae,de)=>{t[de].x=Ae[0]+i[0],t[de].y=Ae[1]+i[1]}),z.forEach(Ae=>{Ae[0]-=z[a][0],Ae[1]-=z[a][1]}),e.run();const $=e.preventOverlap,ne=e.nodeSize;let De;const fe=e.strictRadial;if($){const Ae=e.nodeSpacing;let de;un(Ae)?de=()=>Ae:xu(Ae)?de=Ae:de=()=>0,ne?os(ne)?De=Pe=>(ne[0]>ne[1]?ne[0]:ne[1])+de(Pe):De=Pe=>ne+de(Pe):De=Pe=>Pe.size?os(Pe.size)?(Pe.size[0]>Pe.size[1]?Pe.size[0]:Pe.size[1])+de(Pe):xc(Pe.size)?(Pe.size.width>Pe.size.height?Pe.size.width:Pe.size.height)+de(Pe):Pe.size+de(Pe):10+de(Pe);const ct={nodes:t,nodeSizeFunc:De,adjMatrix:l,positions:z,radii:x,height:f,width:h,strictRadial:fe,focusID:a,iterations:e.maxPreventOverlapIteration||200,k:z.length/4.5};z=new uH(ct).layout()}return z.forEach((Ae,de)=>{t[de].x=Ae[0]+i[0],t[de].y=Ae[1]+i[1]}),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n}}run(){const e=this,t=e.maxIteration,n=e.positions||[],i=e.weights||[],o=e.eIdealDistances||[],s=e.radii||[];for(let a=0;a<=t;a++){const l=a/t;e.oneIteration(l,n,s,o,i)}}oneIteration(e,t,n,i,o){const s=this,a=1-e,l=s.focusIndex;t.forEach((c,u)=>{const d=lP(c,[0,0]),h=d===0?0:1/d;if(u===l)return;let f=0,p=0,g=0;t.forEach((y,x)=>{if(u===x)return;const E=lP(c,y),T=E===0?0:1/E,P=i[x][u];g+=o[u][x],f+=o[u][x]*(y[0]+P*(c[0]-y[0])*T),p+=o[u][x]*(y[1]+P*(c[1]-y[1])*T)});const v=n[u]===0?0:1/n[u];g*=a,g+=e*v*v,f*=a,f+=e*v*c[0]*h,c[0]=f/g,p*=a,p+=e*v*c[1]*h,c[1]=p/g})}eIdealDisMatrix(){const e=this,t=e.nodes;if(!t)return[];const n=e.distances,i=e.linkDistance,o=e.radii||[],s=e.unitRadius||50,a=[];return n&&n.forEach((l,c)=>{const u=[];l.forEach((d,h)=>{if(c===h)u.push(0);else if(o[c]===o[h])if(e.sortBy==="data")u.push(d*(Math.abs(c-h)*e.sortStrength)/(o[c]/s));else if(e.sortBy){let f=t[c][e.sortBy]||0,p=t[h][e.sortBy]||0;M0(f)&&(f=f.charCodeAt(0)),M0(p)&&(p=p.charCodeAt(0)),u.push(d*(Math.abs(f-p)*e.sortStrength)/(o[c]/s))}else u.push(d*i/(o[c]/s));else{const f=(i+s)/2;u.push(d*f)}}),a.push(u)}),a}handleInfinity(e,t,n){const i=e.length;for(let o=0;o<i;o++)if(e[t][o]===Infinity){e[t][o]=n,e[o][t]=n;for(let s=0;s<i;s++)e[o][s]!==Infinity&&e[t][s]===Infinity&&(e[t][s]=n+e[o][s],e[s][t]=n+e[o][s])}for(let o=0;o<i;o++)if(o!==t){for(let s=0;s<i;s++)if(e[o][s]===Infinity){let a=Math.abs(e[t][o]-e[t][s]);a=a===0?1:a,e[o][s]=a}}}maxToFocus(e,t){let n=0;for(let i=0;i<e[t].length;i++)e[t][i]!==Infinity&&(n=e[t][i]>n?e[t][i]:n);return n}getType(){return"radial"}}class pH extends _s{constructor(e){super();this.nodeSize=30,this.minNodeSpacing=10,this.preventOverlap=!1,this.equidistant=!1,this.startAngle=3/2*Math.PI,this.clockwise=!0,this.sortBy="degree",this.nodes=[],this.edges=[],this.width=300,this.height=300,this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{nodeSize:30,minNodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:3/2*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"}}execute(){const e=this,t=e.nodes,n=e.edges,i=t.length;if(i===0){e.onLayoutEnd&&e.onLayoutEnd();return}!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const o=e.center;if(i===1){t[0].x=o[0],t[0].y=o[1],e.onLayoutEnd&&e.onLayoutEnd();return}const s=[];let a;os(e.nodeSize)?a=Math.max(e.nodeSize[0],e.nodeSize[1]):a=e.nodeSize,t.forEach(p=>{s.push(p);let g=a;os(p.size)?g=Math.max(p.size[0],p.size[1]):un(p.size)?g=p.size:xc(p.size)&&(g=Math.max(p.size.width,p.size.height)),a=Math.max(a,g)}),e.clockwise=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise;const l={},c={};if(s.forEach((p,g)=>{l[p.id]=p,c[p.id]=g}),(e.sortBy==="degree"||!M0(e.sortBy)||s[0][e.sortBy]===void 0)&&(e.sortBy="degree",!un(t[0].degree))){const p=O0(t.length,c,n);s.forEach((g,v)=>{g.degree=p[v]})}s.sort((p,g)=>g[e.sortBy]-p[e.sortBy]),e.maxValueNode=s[0],e.maxLevelDiff=e.maxLevelDiff||e.maxValueNode[e.sortBy]/4;const u=[[]];let d=u[0];s.forEach(p=>{if(d.length>0){const g=Math.abs(d[0][e.sortBy]-p[e.sortBy]);e.maxLevelDiff&&g>=e.maxLevelDiff&&(d=[],u.push(d))}d.push(p)});let h=a+e.minNodeSpacing;if(!e.preventOverlap){const p=u.length>0&&u[0].length>1,v=(Math.min(e.width,e.height)/2-h)/(u.length+(p?1:0));h=Math.min(h,v)}let f=0;if(u.forEach(p=>{let g=e.sweep;g===void 0&&(g=2*Math.PI-2*Math.PI/p.length);const v=p.dTheta=g/Math.max(1,p.length-1);if(p.length>1&&e.preventOverlap){const y=Math.cos(v)-Math.cos(0),x=Math.sin(v)-Math.sin(0),E=Math.sqrt(h*h/(y*y+x*x));f=Math.max(E,f)}p.r=f,f+=h}),e.equidistant){let p=0,g=0;for(let v=0;v<u.length;v++){const x=u[v].r-g;p=Math.max(p,x)}g=0,u.forEach((v,y)=>{y===0&&(g=v.r),v.r=g,g+=p})}return u.forEach(p=>{const g=p.dTheta,v=p.r;p.forEach((y,x)=>{const E=e.startAngle+(e.clockwise?1:-1)*g*x;y.x=o[0]+v*Math.cos(E),y.y=o[1]+v*Math.sin(E)})}),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n}}getType(){return"concentric"}}class gH extends _s{constructor(e){super();this.center=[0,0],this.linkDistance=50,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{center:[0,0],linkDistance:50}}execute(){const e=this,{nodes:t,edges:n=[]}=e,i=e.center;if(!t||t.length===0){e.onLayoutEnd&&e.onLayoutEnd();return}if(t.length===1){t[0].x=i[0],t[0].y=i[1],e.onLayoutEnd&&e.onLayoutEnd();return}const o=e.linkDistance,s=qT({nodes:t,edges:n},!1),a=KT(s);e.handleInfinity(a);const l=Z7(a,o);e.scaledDistances=l;const c=e.runMDS();return e.positions=c,c.forEach((u,d)=>{t[d].x=u[0]+i[0],t[d].y=u[1]+i[1]}),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n}}runMDS(){const e=this,t=2,n=e.scaledDistances,i=or.mul(or.pow(n,2),-.5),o=i.mean("row"),s=i.mean("column"),a=i.mean();i.add(a).subRowVector(o).subColumnVector(s);const l=new aP(i),c=or.sqrt(l.diagonalMatrix).diagonal();return l.leftSingularVectors.toJSON().map(u=>or.mul([u],[c]).toJSON()[0].splice(0,t))}handleInfinity(e){let t=-999999;e.forEach(n=>{n.forEach(i=>{i!==Infinity&&t<i&&(t=i)})}),e.forEach((n,i)=>{n.forEach((o,s)=>{o===Infinity&&(e[i][s]=t)})})}getType(){return"mds"}}const mH=800;class vH extends _s{constructor(e){super();this.maxIteration=1e3,this.workerEnabled=!1,this.gravity=10,this.speed=5,this.clustering=!1,this.clusterGravity=10,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.onLayoutEnd=()=>{},this.tick=()=>{},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}}execute(){var e,t;const n=this,i=n.nodes;if(n.timeInterval!==void 0&&typeof window!="undefined"&&window.clearInterval(n.timeInterval),!i||i.length===0){(e=n.onLayoutEnd)===null||e===void 0||e.call(n);return}!n.width&&typeof window!="undefined"&&(n.width=window.innerWidth),!n.height&&typeof window!="undefined"&&(n.height=window.innerHeight),n.center||(n.center=[n.width/2,n.height/2]);const o=n.center;if(i.length===1){i[0].x=o[0],i[0].y=o[1],(t=n.onLayoutEnd)===null||t===void 0||t.call(n);return}const s={},a={};return i.forEach((l,c)=>{un(l.x)||(l.x=Math.random()*this.width),un(l.y)||(l.y=Math.random()*this.height),s[l.id]=l,a[l.id]=c}),n.nodeMap=s,n.nodeIdxMap=a,n.run()}run(){var e;const t=this,n=t.nodes;if(!n)return;const{edges:i,maxIteration:o,workerEnabled:s,clustering:a}=t,l={};if(a&&n.forEach(c=>{l[c.cluster]===void 0&&(l[c.cluster]={name:c.cluster,cx:0,cy:0,count:0})}),s){for(let c=0;c<o;c++)t.runOneStep(l);(e=t.onLayoutEnd)===null||e===void 0||e.call(t)}else{if(typeof window=="undefined")return;let c=0;this.timeInterval=window.setInterval(()=>{var u;t.runOneStep(l),c++,c>=o&&((u=t.onLayoutEnd)===null||u===void 0||u.call(t),window.clearInterval(t.timeInterval))},0)}return{nodes:n,edges:i}}runOneStep(e){var t;const n=this,i=n.nodes;if(!i)return;const{edges:o,center:s,gravity:a,speed:l,clustering:c}=n,u=n.height*n.width,d=Math.sqrt(u)/10,h=u/(i.length+1),f=Math.sqrt(h),p=[];if(i.forEach((g,v)=>{p[v]={x:0,y:0}}),n.applyCalculate(i,o,p,f,h),c){for(const v in e)e[v].cx=0,e[v].cy=0,e[v].count=0;i.forEach(v=>{const y=e[v.cluster];un(v.x)&&(y.cx+=v.x),un(v.y)&&(y.cy+=v.y),y.count++});for(const v in e)e[v].cx/=e[v].count,e[v].cy/=e[v].count;const g=n.clusterGravity||a;i.forEach((v,y)=>{if(!un(v.x)||!un(v.y))return;const x=e[v.cluster],E=Math.sqrt((v.x-x.cx)*(v.x-x.cx)+(v.y-x.cy)*(v.y-x.cy)),T=f*g;p[y].x-=T*(v.x-x.cx)/E,p[y].y-=T*(v.y-x.cy)/E})}i.forEach((g,v)=>{if(!un(g.x)||!un(g.y))return;const y=.01*f*a;p[v].x-=y*(g.x-s[0]),p[v].y-=y*(g.y-s[1])}),i.forEach((g,v)=>{if(un(g.fx)&&un(g.fy)){g.x=g.fx,g.y=g.fy;return}if(!un(g.x)||!un(g.y))return;const y=Math.sqrt(p[v].x*p[v].x+p[v].y*p[v].y);if(y>0){const x=Math.min(d*(l/mH),y);g.x+=p[v].x/y*x,g.y+=p[v].y/y*x}}),(t=n.tick)===null||t===void 0||t.call(n)}applyCalculate(e,t,n,i,o){const s=this;s.calRepulsive(e,n,o),t&&s.calAttractive(t,n,i)}calRepulsive(e,t,n){e.forEach((i,o)=>{t[o]={x:0,y:0},e.forEach((s,a)=>{if(o===a||!un(i.x)||!un(s.x)||!un(i.y)||!un(s.y))return;let l=i.x-s.x,c=i.y-s.y,u=l*l+c*c;if(u===0){u=1;const h=o>a?1:-1;l=.01*h,c=.01*h}const d=n/u;t[o].x+=l*d,t[o].y+=c*d})})}calAttractive(e,t,n){e.forEach(i=>{const o=Xr(i,"source"),s=Xr(i,"target");if(!o||!s)return;const a=this.nodeIdxMap[o],l=this.nodeIdxMap[s];if(a===l)return;const c=this.nodeMap[o],u=this.nodeMap[s];if(!un(u.x)||!un(c.x)||!un(u.y)||!un(c.y))return;const d=u.x-c.x,h=u.y-c.y,f=Math.sqrt(d*d+h*h),p=f*f/n;t[l].x-=d/f*p,t[l].y-=h/f*p,t[a].x+=d/f*p,t[a].y+=h/f*p})}stop(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)}destroy(){const e=this;e.stop(),e.tick=null,e.nodes=null,e.edges=null,e.destroyed=!0}getType(){return"fruchterman"}}var In=w(55770),Sn=w(6610),Hn=w(5991),Ln=w(3473),yH=w(87757),yn=w.n(yH),Yr=w(92137),bH=-1,xH=1;function Dl(){return xH++}var Jd=function r(e){(0,Sn.Z)(this,r)},Qd=function(){function r(e){(0,Sn.Z)(this,r),this.clazz=void 0,this.components=[],this.entities=[],this.lookup={},this.clazz=e}return(0,Hn.Z)(r,[{key:"clear",value:function(){this.components=[],this.entities=[],this.lookup={}}},{key:"contains",value:function(t){return this.lookup[t]>-1}},{key:"create",value:function(t,n){this.lookup[t]=this.components.length;var i=new this.clazz(n||{});return this.components.push(i),this.entities.push(t),i}},{key:"remove",value:function(t){var n=this.lookup[t];n>-1&&n<this.components.length-1&&(this.components[n]=this.components[this.components.length-1],this.entities[n]=this.entities[this.entities.length-1],this.lookup[this.entities[n]]=n),this.components.pop(),this.entities.pop(),delete this.lookup[t]}},{key:"removeKeepSorted",value:function(t){var n=this.lookup[t];if(n>-1){var i=this.entities[n];if(n<this.components.length-1){for(var o=n+1;o<this.components.length;++o)this.components[o-1]=this.components[o];for(var s=n+1;s<this.entities.length;++s)this.entities[s-1]=this.entities[s],this.lookup[this.entities[s-1]]=s-1}this.components.pop(),this.entities.pop(),delete this.lookup[i]}}},{key:"moveItem",value:function(t,n){if(t!==n){for(var i=this.components[t],o=this.entities[t],s=t<n?1:-1,a=t;a!==n;a+=s){var l=a+s;this.components[a]=this.components[l],this.entities[a]=this.entities[l],this.lookup[this.entities[a]]=a}this.components[n]=i,this.entities[n]=o,this.lookup[o]=n}}},{key:"getEntity",value:function(t){return this.entities[t]}},{key:"getComponent",value:function(t){return this.components[t]}},{key:"getComponentByEntity",value:function(t){var n=this.lookup[t];return n>-1?this.components[n]:null}},{key:"getCount",value:function(){return this.components.length}},{key:"getEntityByComponentIndex",value:function(t){for(var n=0,i=Object.keys(this.lookup);n<i.length;n++){var o=i[n],s=Number(o);if(this.lookup[s]===t)return s}return bH}},{key:"find",value:function(t){for(var n=0;n<this.getCount();n++){var i=this.getComponent(n);if(t(i,n))return i}return null}},{key:"findIndex",value:function(t){for(var n=0;n<this.getCount();n++){var i=this.getComponent(n);if(t(i,n))return n}return-1}},{key:"forEach",value:function(t){for(var n=0,i=Object.keys(this.lookup);n<i.length;n++){var o=i[n],s=Number(o),a=this.lookup[s];t(s,this.getComponent(a))}}},{key:"forEachAsync",value:function(){var e=(0,Yr.Z)(yn().mark(function n(i){var o,s,a,l,c;return yn().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:o=0,s=Object.keys(this.lookup);case 1:if(!(o<s.length)){d.next=10;break}return a=s[o],l=Number(a),c=this.lookup[l],d.next=7,i(l,this.getComponent(c));case 7:o++,d.next=1;break;case 10:case"end":return d.stop()}},n,this)}));function t(n){return e.apply(this,arguments)}return t}()},{key:"map",value:function(t){for(var n=[],i=0,o=Object.keys(this.lookup);i<o.length;i++){var s=o[i],a=Number(s),l=this.lookup[a];n.push(t(a,this.getComponent(l)))}return n}}]),r}(),I0=w(28481),Ct={HierarchyComponentManager:Symbol("HierarchyComponentManager"),TransformComponentManager:Symbol("TransformComponentManager"),NameComponentManager:Symbol("NameComponentManager"),SceneGraphSystem:Symbol("SceneGraphSystem"),FrameGraphSystem:Symbol("FrameGraphSystem"),ResourcePool:Symbol("ResourcePool"),ResourceHandleComponentManager:Symbol("ResourceHandleComponentManager"),PassNodeComponentManager:Symbol("PassNodeComponentManager"),RendererSystem:Symbol("RendererSystem"),RenderPass:Symbol("RenderPass"),RenderPassFactory:Symbol("Factory<IRenderPass>"),Renderable:Symbol("Factory<IRenderPass>"),MeshSystem:Symbol("MeshSystem"),MeshComponentManager:Symbol("MeshComponentManager"),CullableComponentManager:Symbol("CullableComponentManager"),Geometry:Symbol("Geometry"),GeometrySystem:Symbol("GeometrySystem"),GeometryComponentManager:Symbol("GeometryComponentManager"),Material:Symbol("Material"),MaterialSystem:Symbol("MaterialSystem"),MaterialComponentManager:Symbol("MaterialComponentManager"),ForwardRenderPath:Symbol("ForwardRenderPath"),ComputeSystem:Symbol("ComputeSystem"),ComputeComponentManager:Symbol("ComputeComponentManager"),ComputeStrategy:Symbol("ComputeStrategy"),Systems:Symbol("Systems"),World:Symbol("World"),RenderEngine:Symbol("RenderEngine"),WebGPUEngine:Symbol("WebGPUEngine"),WebGLEngine:Symbol("WebGLEngine"),ShaderModuleService:Symbol("ShaderModuleService"),ConfigService:Symbol("ConfigService"),InteractorService:Symbol("InteractorService"),IEventEmitter:Symbol("IEventEmitter"),Light:Symbol("Light")},CH=function r(){(0,Sn.Z)(this,r),this.index=void 0},wH=function r(){(0,Sn.Z)(this,r),this.name=void 0,this.data=void 0,this.execute=void 0,this.tearDown=void 0},EH=function(){function r(){(0,Sn.Z)(this,r),this.name=void 0,this.refCount=0,this.hasSideEffect=!1,this.devirtualize=[],this.destroy=[],this.reads=[],this.writes=[]}return(0,Hn.Z)(r,[{key:"read",value:function(t){return this.reads.find(function(n){return n.index===t.index})||this.reads.push(t),t}},{key:"sample",value:function(t){return this.read(t),t}},{key:"write",value:function(t,n){var i=this.writes.find(function(l){return l.index===n.index});if(i)return n;var o=t.getResourceNode(n);o.resource.version++,o.resource.imported&&(this.hasSideEffect=!0);var s=t.createResourceNode(o.resource),a=t.getResourceNode(s);return a.writer=this,this.writes.push(s),s}}]),r}(),us=w(10379),ds=w(46070),li=w(77608),SH=function r(){(0,Sn.Z)(this,r),this.first=void 0,this.last=void 0};function _H(r){var e=AH();return function(){var n=(0,li.Z)(r),i;if(e){var o=(0,li.Z)(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return(0,ds.Z)(this,i)}}function AH(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var cP=function(r){(0,us.Z)(t,r);var e=_H(t);function t(){var n;(0,Sn.Z)(this,t);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=e.call.apply(e,[this].concat(o)),n.version=0,n.refs=0,n.name=void 0,n.imported=void 0,n.priority=void 0,n.discardStart=!0,n.discardEnd=!1,n.descriptor=void 0,n.resource=void 0,n}return(0,Hn.Z)(t,[{key:"preExecuteDestroy",value:function(){this.discardEnd=!0}},{key:"postExecuteDestroy",value:function(){!this.imported}},{key:"postExecuteDevirtualize",value:function(){this.discardStart=!1}},{key:"preExecuteDevirtualize",value:function(){!this.imported}}]),t}(SH),TH=function r(){(0,Sn.Z)(this,r),this.resource=void 0,this.writer=void 0,this.readerCount=0,this.version=void 0},uP,dP,hP,Ow,fP,pP;function Ea(r,e){var t;if(typeof Symbol=="undefined"||r[Symbol.iterator]==null){if(Array.isArray(r)||(t=MH(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,s=!1,a;return{s:function(){t=r[Symbol.iterator]()},n:function(){var c=t.next();return o=c.done,c},e:function(c){s=!0,a=c},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(s)throw a}}}}function MH(r,e){if(!!r){if(typeof r=="string")return gP(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return gP(r,e)}}function gP(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var PH=(uP=(0,R.b2)(),dP=(0,R.f3)(Ct.RenderEngine),uP(hP=(Ow=(pP=function(){function r(){(0,Sn.Z)(this,r),this.passNodes=[],this.resourceNodes=[],this.frameGraphPasses=[],(0,In.Z)(this,"engine",fP,this)}return(0,Hn.Z)(r,[{key:"execute",value:function(){var e=(0,Yr.Z)(yn().mark(function n(i){return yn().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return this.compile(),s.next=3,this.executePassNodes(i);case 3:case"end":return s.stop()}},n,this)}));function t(n){return e.apply(this,arguments)}return t}()},{key:"tearDown",value:function(){this.frameGraphPasses.forEach(function(t){t.tearDown&&t.tearDown()}),this.reset()}},{key:"addPass",value:function(t,n,i,o){var s=new wH;s.execute=i,o&&(s.tearDown=o),s.name=t;var a=new EH;return a.name=t,this.passNodes.push(a),this.frameGraphPasses.push(s),n(this,a,s),s}},{key:"getPass",value:function(t){return this.frameGraphPasses.find(function(n){return n.name===t})}},{key:"compile",value:function(){var t=this,n=Ea(this.passNodes),i;try{for(n.s();!(i=n.n()).done;){var o=i.value;o.refCount=o.writes.length+(o.hasSideEffect?1:0),o.reads.forEach(function(tn){t.resourceNodes[tn.index].readerCount++})}}catch(tn){n.e(tn)}finally{n.f()}var s=[],a=Ea(this.resourceNodes),l;try{for(a.s();!(l=a.n()).done;){var c=l.value;c.readerCount===0&&s.push(c)}}catch(tn){a.e(tn)}finally{a.f()}for(;s.length;){var u=s.pop(),d=u&&u.writer;if(d&&--d.refCount==0){var h=Ea(d.reads),f;try{for(h.s();!(f=h.n()).done;){var p=f.value,g=this.resourceNodes[p.index];--g.readerCount==0&&s.push(g)}}catch(tn){h.e(tn)}finally{h.f()}}}this.resourceNodes.forEach(function(tn){tn.resource.refs+=tn.readerCount});var v=Ea(this.passNodes),y;try{for(v.s();!(y=v.n()).done;){var x=y.value;if(!!x.refCount){var E=Ea(x.reads),T;try{for(E.s();!(T=E.n()).done;){var P=T.value,z=this.resourceNodes[P.index].resource;z.first=z.first?z.first:x,z.last=x}}catch(tn){E.e(tn)}finally{E.f()}var $=Ea(x.writes),ne;try{for($.s();!(ne=$.n()).done;){var De=ne.value,fe=this.resourceNodes[De.index].resource;fe.first=fe.first?fe.first:x,fe.last=x}}catch(tn){$.e(tn)}finally{$.f()}}}}catch(tn){v.e(tn)}finally{v.f()}for(var Ae=0;Ae<2;Ae++){var de=Ea(this.resourceNodes),ct;try{for(de.s();!(ct=de.n()).done;){var bt=ct.value,Pe=bt.resource;if(Pe.priority===Ae&&Pe.refs){var tt=Pe.first,Kt=Pe.last;tt&&Kt&&(tt.devirtualize.push(Pe),Kt.destroy.push(Pe))}}}catch(tn){de.e(tn)}finally{de.f()}}}},{key:"executePassNodes",value:function(){var e=(0,Yr.Z)(yn().mark(function n(i){var o,s,a,l,c,u,d,h,f,p,g,v,y,x,E,T,P;return yn().wrap(function($){for(;;)switch($.prev=$.next){case 0:o=Ea(this.passNodes.entries()),$.prev=1,o.s();case 3:if((s=o.n()).done){$.next=18;break}if(a=(0,I0.Z)(s.value,2),l=a[0],c=a[1],!c.refCount){$.next=16;break}u=Ea(c.devirtualize);try{for(u.s();!(d=u.n()).done;)h=d.value,h.preExecuteDevirtualize(this.engine)}catch(ne){u.e(ne)}finally{u.f()}f=Ea(c.destroy);try{for(f.s();!(p=f.n()).done;)g=p.value,g.preExecuteDestroy(this.engine)}catch(ne){f.e(ne)}finally{f.f()}return $.next=12,this.frameGraphPasses[l].execute(this,this.frameGraphPasses[l],i);case 12:v=Ea(c.devirtualize);try{for(v.s();!(y=v.n()).done;)x=y.value,x.postExecuteDevirtualize(this.engine)}catch(ne){v.e(ne)}finally{v.f()}E=Ea(c.destroy);try{for(E.s();!(T=E.n()).done;)P=T.value,P.postExecuteDestroy(this.engine)}catch(ne){E.e(ne)}finally{E.f()}case 16:$.next=3;break;case 18:$.next=23;break;case 20:$.prev=20,$.t0=$.catch(1),o.e($.t0);case 23:return $.prev=23,o.f(),$.finish(23);case 26:this.reset();case 27:case"end":return $.stop()}},n,this,[[1,20,23,26]])}));function t(n){return e.apply(this,arguments)}return t}()},{key:"reset",value:function(){this.passNodes=[],this.resourceNodes=[],this.frameGraphPasses=[]}},{key:"getResourceNode",value:function(t){return this.resourceNodes[t.index]}},{key:"createResourceNode",value:function(t){var n=new TH;n.resource=t,n.version=t.version,this.resourceNodes.push(n);var i=new CH;return i.index=this.resourceNodes.length-1,i}},{key:"createTexture",value:function(t,n,i){var o=new cP;return o.name=n,o.descriptor=i,this.createResourceNode(o)}},{key:"createRenderTarget",value:function(t,n,i){var o=new cP;return o.name=n,o.descriptor=i,this.createResourceNode(o)}},{key:"present",value:function(t){this.addPass("Present",function(n,i){i.read(t),i.hasSideEffect=!0},(0,Yr.Z)(yn().mark(function n(){return yn().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:case"end":return o.stop()}},n)})))}}]),r}(),pP),fP=(0,Ln.Z)(Ow.prototype,"engine",[dP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ow))||hP),it=w(96156),co=w(63349),ro=w(98333),eh=w(35600),Xe=w(77160),th=w(90484),OH=9007199254740991,DH="[object Arguments]",NH="[object Array]",RH="[object Boolean]",kH="[object Date]",IH="[object Error]",LH="[object Function]",GH="[object Map]",FH="[object Number]",BH="[object Object]",zH="[object RegExp]",UH="[object Set]",VH="[object String]",jH="[object WeakMap]",HH="[object ArrayBuffer]",$H="[object DataView]",WH="[object Float32Array]",ZH="[object Float64Array]",XH="[object Int8Array]",YH="[object Int16Array]",KH="[object Int32Array]",qH="[object Uint8Array]",JH="[object Uint8ClampedArray]",QH="[object Uint16Array]",e$="[object Uint32Array]",Li={};Li[WH]=Li[ZH]=Li[XH]=Li[YH]=Li[KH]=Li[qH]=Li[JH]=Li[QH]=Li[e$]=!0,Li[DH]=Li[NH]=Li[HH]=Li[RH]=Li[$H]=Li[kH]=Li[IH]=Li[LH]=Li[GH]=Li[FH]=Li[BH]=Li[zH]=Li[UH]=Li[VH]=Li[jH]=!1;function hne(r){return function(e){return r(e)}}var t$=Object.prototype,n$=t$.toString;function r$(r){return o$(r)&&i$(r.length)&&!!Li[n$.call(r)]}function i$(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=OH}function o$(r){return!!r&&(0,th.Z)(r)==="object"}var mP=r$;function vP(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function yP(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?vP(Object(t),!0).forEach(function(n){(0,it.Z)(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):vP(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function s$(r){var e=a$();return function(){var n=(0,li.Z)(r),i;if(e){var o=(0,li.Z)(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return(0,ds.Z)(this,i)}}function a$(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var l$=function(r){(0,us.Z)(t,r);var e=s$(t);function t(n){var i;return(0,Sn.Z)(this,t),i=e.call(this,n),i.dirty=!0,i.attributes=[],i.indices=void 0,i.indicesBuffer=void 0,i.vertexCount=0,i.maxInstancedCount=void 0,i.aabb=void 0,i.entity=void 0,Object.assign((0,co.Z)(i),n),i}return(0,Hn.Z)(t,[{key:"setAttribute",value:function(i,o,s,a){var l=this.attributes.find(function(c){return c.name===i});return l?(l.data=o,l.dirty=!0):this.attributes.push(yP(yP({dirty:!0,name:i,data:o},s),{},{bufferGetter:a})),this.dirty=!0,this}},{key:"setIndex",value:function(i){return this.indices=new Uint32Array(i.buffer?i.buffer:i),this.dirty=!0,this}},{key:"applyMatrix",value:function(i){var o=this.attributes.find(function(h){var f=h.name;return f==="position"}),s=this.attributes.find(function(h){var f=h.name;return f==="normal"});if(o&&(o.dirty=!0,o.data&&o.data.length))for(var a=0;a<o.data.length;a+=3){var l=ro.al(o.data[a],o.data[a+1],o.data[a+2],1);ro.fF(l,l,i),mP(o.data)?o.data.set([l[0],l[1],l[2]],a):(o.data[a]=l[0],o.data[a+1]=l[1],o.data[a+2]=l[2])}if(s){var c=eh.XL(eh.Ue(),i);if(s.data&&s.data.length)for(var u=0;u<s.data.length;u+=3){var d=Xe.fromValues(s.data[u],s.data[u+1],s.data[u+2]);Xe.transformMat3(d,d,c),Xe.normalize(d,d),mP(s.data)?s.data.set([d[0],d[1],d[2]],u):(s.data[u]=d[0],s.data[u+1]=d[1],s.data[u+2]=d[2])}}}}]),t}(Jd),Fe;(function(r){r[r.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",r[r.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",r[r.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN",r[r.ZERO=0]="ZERO",r[r.ONE=1]="ONE",r[r.SRC_COLOR=768]="SRC_COLOR",r[r.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",r[r.SRC_ALPHA=770]="SRC_ALPHA",r[r.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",r[r.DST_ALPHA=772]="DST_ALPHA",r[r.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",r[r.DST_COLOR=774]="DST_COLOR",r[r.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",r[r.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",r[r.FUNC_ADD=32774]="FUNC_ADD",r[r.BLEND_EQUATION=32777]="BLEND_EQUATION",r[r.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",r[r.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",r[r.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",r[r.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",r[r.MAX_EXT=32776]="MAX_EXT",r[r.MIN_EXT=32775]="MIN_EXT",r[r.BLEND_DST_RGB=32968]="BLEND_DST_RGB",r[r.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",r[r.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",r[r.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",r[r.CONSTANT_COLOR=32769]="CONSTANT_COLOR",r[r.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",r[r.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",r[r.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",r[r.BLEND_COLOR=32773]="BLEND_COLOR",r[r.ARRAY_BUFFER=34962]="ARRAY_BUFFER",r[r.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",r[r.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",r[r.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",r[r.STREAM_DRAW=35040]="STREAM_DRAW",r[r.STATIC_DRAW=35044]="STATIC_DRAW",r[r.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",r[r.BUFFER_SIZE=34660]="BUFFER_SIZE",r[r.BUFFER_USAGE=34661]="BUFFER_USAGE",r[r.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",r[r.FRONT=1028]="FRONT",r[r.BACK=1029]="BACK",r[r.FRONT_AND_BACK=1032]="FRONT_AND_BACK",r[r.CULL_FACE=2884]="CULL_FACE",r[r.BLEND=3042]="BLEND",r[r.DITHER=3024]="DITHER",r[r.STENCIL_TEST=2960]="STENCIL_TEST",r[r.DEPTH_TEST=2929]="DEPTH_TEST",r[r.SCISSOR_TEST=3089]="SCISSOR_TEST",r[r.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",r[r.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",r[r.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",r[r.NO_ERROR=0]="NO_ERROR",r[r.INVALID_ENUM=1280]="INVALID_ENUM",r[r.INVALID_VALUE=1281]="INVALID_VALUE",r[r.INVALID_OPERATION=1282]="INVALID_OPERATION",r[r.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",r[r.CW=2304]="CW",r[r.CCW=2305]="CCW",r[r.LINE_WIDTH=2849]="LINE_WIDTH",r[r.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",r[r.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",r[r.CULL_FACE_MODE=2885]="CULL_FACE_MODE",r[r.FRONT_FACE=2886]="FRONT_FACE",r[r.DEPTH_RANGE=2928]="DEPTH_RANGE",r[r.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",r[r.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",r[r.DEPTH_FUNC=2932]="DEPTH_FUNC",r[r.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",r[r.STENCIL_FUNC=2962]="STENCIL_FUNC",r[r.STENCIL_FAIL=2964]="STENCIL_FAIL",r[r.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",r[r.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",r[r.STENCIL_REF=2967]="STENCIL_REF",r[r.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",r[r.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",r[r.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",r[r.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",r[r.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",r[r.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",r[r.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",r[r.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",r[r.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",r[r.VIEWPORT=2978]="VIEWPORT",r[r.SCISSOR_BOX=3088]="SCISSOR_BOX",r[r.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",r[r.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",r[r.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",r[r.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",r[r.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",r[r.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",r[r.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",r[r.RED_BITS=3410]="RED_BITS",r[r.GREEN_BITS=3411]="GREEN_BITS",r[r.BLUE_BITS=3412]="BLUE_BITS",r[r.ALPHA_BITS=3413]="ALPHA_BITS",r[r.DEPTH_BITS=3414]="DEPTH_BITS",r[r.STENCIL_BITS=3415]="STENCIL_BITS",r[r.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",r[r.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",r[r.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",r[r.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",r[r.SAMPLES=32937]="SAMPLES",r[r.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",r[r.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",r[r.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",r[r.DONT_CARE=4352]="DONT_CARE",r[r.FASTEST=4353]="FASTEST",r[r.NICEST=4354]="NICEST",r[r.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",r[r.BYTE=5120]="BYTE",r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.SHORT=5122]="SHORT",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.INT=5124]="INT",r[r.UNSIGNED_INT=5125]="UNSIGNED_INT",r[r.FLOAT=5126]="FLOAT",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.ALPHA=6406]="ALPHA",r[r.RGB=6407]="RGB",r[r.RGBA=6408]="RGBA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",r[r.VERTEX_SHADER=35633]="VERTEX_SHADER",r[r.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",r[r.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",r[r.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",r[r.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",r[r.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",r[r.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",r[r.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",r[r.SHADER_TYPE=35663]="SHADER_TYPE",r[r.DELETE_STATUS=35712]="DELETE_STATUS",r[r.LINK_STATUS=35714]="LINK_STATUS",r[r.VALIDATE_STATUS=35715]="VALIDATE_STATUS",r[r.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",r[r.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",r[r.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",r[r.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",r[r.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",r[r.NEVER=512]="NEVER",r[r.LESS=513]="LESS",r[r.EQUAL=514]="EQUAL",r[r.LEQUAL=515]="LEQUAL",r[r.GREATER=516]="GREATER",r[r.NOTEQUAL=517]="NOTEQUAL",r[r.GEQUAL=518]="GEQUAL",r[r.ALWAYS=519]="ALWAYS",r[r.KEEP=7680]="KEEP",r[r.REPLACE=7681]="REPLACE",r[r.INCR=7682]="INCR",r[r.DECR=7683]="DECR",r[r.INVERT=5386]="INVERT",r[r.INCR_WRAP=34055]="INCR_WRAP",r[r.DECR_WRAP=34056]="DECR_WRAP",r[r.VENDOR=7936]="VENDOR",r[r.RENDERER=7937]="RENDERER",r[r.VERSION=7938]="VERSION",r[r.NEAREST=9728]="NEAREST",r[r.LINEAR=9729]="LINEAR",r[r.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",r[r.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",r[r.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",r[r.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",r[r.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",r[r.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",r[r.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",r[r.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE=5890]="TEXTURE",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",r[r.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",r[r.TEXTURE0=33984]="TEXTURE0",r[r.TEXTURE1=33985]="TEXTURE1",r[r.TEXTURE2=33986]="TEXTURE2",r[r.TEXTURE3=33987]="TEXTURE3",r[r.TEXTURE4=33988]="TEXTURE4",r[r.TEXTURE5=33989]="TEXTURE5",r[r.TEXTURE6=33990]="TEXTURE6",r[r.TEXTURE7=33991]="TEXTURE7",r[r.TEXTURE8=33992]="TEXTURE8",r[r.TEXTURE9=33993]="TEXTURE9",r[r.TEXTURE10=33994]="TEXTURE10",r[r.TEXTURE11=33995]="TEXTURE11",r[r.TEXTURE12=33996]="TEXTURE12",r[r.TEXTURE13=33997]="TEXTURE13",r[r.TEXTURE14=33998]="TEXTURE14",r[r.TEXTURE15=33999]="TEXTURE15",r[r.TEXTURE16=34e3]="TEXTURE16",r[r.TEXTURE17=34001]="TEXTURE17",r[r.TEXTURE18=34002]="TEXTURE18",r[r.TEXTURE19=34003]="TEXTURE19",r[r.TEXTURE20=34004]="TEXTURE20",r[r.TEXTURE21=34005]="TEXTURE21",r[r.TEXTURE22=34006]="TEXTURE22",r[r.TEXTURE23=34007]="TEXTURE23",r[r.TEXTURE24=34008]="TEXTURE24",r[r.TEXTURE25=34009]="TEXTURE25",r[r.TEXTURE26=34010]="TEXTURE26",r[r.TEXTURE27=34011]="TEXTURE27",r[r.TEXTURE28=34012]="TEXTURE28",r[r.TEXTURE29=34013]="TEXTURE29",r[r.TEXTURE30=34014]="TEXTURE30",r[r.TEXTURE31=34015]="TEXTURE31",r[r.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",r[r.REPEAT=10497]="REPEAT",r[r.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",r[r.FLOAT_VEC2=35664]="FLOAT_VEC2",r[r.FLOAT_VEC3=35665]="FLOAT_VEC3",r[r.FLOAT_VEC4=35666]="FLOAT_VEC4",r[r.INT_VEC2=35667]="INT_VEC2",r[r.INT_VEC3=35668]="INT_VEC3",r[r.INT_VEC4=35669]="INT_VEC4",r[r.BOOL=35670]="BOOL",r[r.BOOL_VEC2=35671]="BOOL_VEC2",r[r.BOOL_VEC3=35672]="BOOL_VEC3",r[r.BOOL_VEC4=35673]="BOOL_VEC4",r[r.FLOAT_MAT2=35674]="FLOAT_MAT2",r[r.FLOAT_MAT3=35675]="FLOAT_MAT3",r[r.FLOAT_MAT4=35676]="FLOAT_MAT4",r[r.SAMPLER_2D=35678]="SAMPLER_2D",r[r.SAMPLER_CUBE=35680]="SAMPLER_CUBE",r[r.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",r[r.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",r[r.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",r[r.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",r[r.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",r[r.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",r[r.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",r[r.COMPILE_STATUS=35713]="COMPILE_STATUS",r[r.LOW_FLOAT=36336]="LOW_FLOAT",r[r.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",r[r.HIGH_FLOAT=36338]="HIGH_FLOAT",r[r.LOW_INT=36339]="LOW_INT",r[r.MEDIUM_INT=36340]="MEDIUM_INT",r[r.HIGH_INT=36341]="HIGH_INT",r[r.FRAMEBUFFER=36160]="FRAMEBUFFER",r[r.RENDERBUFFER=36161]="RENDERBUFFER",r[r.RGBA4=32854]="RGBA4",r[r.RGB5_A1=32855]="RGB5_A1",r[r.RGB565=36194]="RGB565",r[r.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",r[r.STENCIL_INDEX=6401]="STENCIL_INDEX",r[r.STENCIL_INDEX8=36168]="STENCIL_INDEX8",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL",r[r.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",r[r.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",r[r.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",r[r.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",r[r.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",r[r.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",r[r.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",r[r.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",r[r.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",r[r.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",r[r.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",r[r.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",r[r.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",r[r.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",r[r.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",r[r.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",r[r.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",r[r.NONE=0]="NONE",r[r.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",r[r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",r[r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",r[r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",r[r.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",r[r.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",r[r.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",r[r.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",r[r.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",r[r.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",r[r.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",r[r.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",r[r.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",r[r.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",r[r.COPY_SRC=1]="COPY_SRC",r[r.COPY_DST=2]="COPY_DST",r[r.SAMPLED=4]="SAMPLED",r[r.STORAGE=8]="STORAGE",r[r.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(Fe||(Fe={}));var bP,xP,CP,wP,Pb,EP,SP,_P,c$=(bP=(0,R.b2)(),xP=(0,R.f3)(Ct.GeometryComponentManager),CP=(0,R.f3)(Ct.RenderEngine),bP(wP=(Pb=(_P=function(){function r(){(0,Sn.Z)(this,r),(0,In.Z)(this,"geometry",EP,this),(0,In.Z)(this,"engine",SP,this)}return(0,Hn.Z)(r,[{key:"execute",value:function(){var e=(0,Yr.Z)(yn().mark(function n(){var i=this;return yn().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:this.geometry.forEach(function(a,l){l.dirty&&(l.attributes.forEach(function(c){if(c.dirty&&c.data){if(!c.buffer)c.buffer=i.engine.createBuffer({data:c.data,type:Fe.FLOAT});else{var u;(u=c.buffer)===null||u===void 0||u.subData({data:c.data,offset:0})}c.dirty=!1}}),l.indices&&(l.indicesBuffer?l.indicesBuffer.subData({data:l.indices,offset:0}):l.indicesBuffer=i.engine.createElements({data:l.indices,count:l.indices.length,type:Fe.UNSIGNED_INT,usage:Fe.STATIC_DRAW})),l.dirty=!1)});case 1:case"end":return s.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"tearDown",value:function(){this.geometry.forEach(function(t,n){n.indicesBuffer&&n.indicesBuffer.destroy(),n.attributes.forEach(function(i){i.buffer&&i.buffer.destroy()})}),this.geometry.clear()}},{key:"createBufferGeometry",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{vertexCount:3},n=t.vertexCount,i=Dl();return this.geometry.create(i,{vertexCount:n})}},{key:"createInstancedBufferGeometry",value:function(t){var n=t.maxInstancedCount,i=t.vertexCount,o=Dl();return this.geometry.create(o,{maxInstancedCount:n,vertexCount:i})}}]),r}(),_P),EP=(0,Ln.Z)(Pb.prototype,"geometry",[xP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SP=(0,Ln.Z)(Pb.prototype,"engine",[CP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pb))||wP);function AP(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function TP(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?AP(Object(t),!0).forEach(function(n){(0,it.Z)(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):AP(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function u$(r){var e=d$();return function(){var n=(0,li.Z)(r),i;if(e){var o=(0,li.Z)(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return(0,ds.Z)(this,i)}}function d$(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var h$=function(r){(0,us.Z)(t,r);var e=u$(t);function t(n){var i;return(0,Sn.Z)(this,t),i=e.call(this,n),i.vertexShaderGLSL=void 0,i.fragmentShaderGLSL=void 0,i.defines={},i.dirty=!0,i.uniforms=[],i.cull={enable:!0,face:Fe.BACK},i.depth={enable:!0},i.blend=void 0,i.entity=void 0,i.type=void 0,Object.assign((0,co.Z)(i),n),i}return(0,Hn.Z)(t,[{key:"setDefines",value:function(i){return this.defines=TP(TP({},this.defines),i),this}},{key:"setCull",value:function(i){return this.cull=i,this}},{key:"setDepth",value:function(i){return this.depth=i,this}},{key:"setBlend",value:function(i){return this.blend=i,this}},{key:"setUniform",value:function(i,o){var s=this;if(typeof i!="string")return Object.keys(i).forEach(function(l){return s.setUniform(l,i[l])}),this;var a=this.uniforms.find(function(l){return l.name===i});return a?(a.dirty=!0,a.data=o):this.uniforms.push({name:i,dirty:!0,data:o}),this.dirty=!0,this}}]),t}(Jd),MP,PP,OP,DP,NP,L0,RP,kP,IP,LP;function GP(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function FP(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?GP(Object(t),!0).forEach(function(n){(0,it.Z)(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):GP(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var f$=(MP=(0,R.b2)(),PP=(0,R.f3)(Ct.MaterialComponentManager),OP=(0,R.f3)(Ct.RenderEngine),DP=(0,R.f3)(Ct.ShaderModuleService),MP(NP=(L0=(LP=function(){function r(){(0,Sn.Z)(this,r),(0,In.Z)(this,"material",RP,this),(0,In.Z)(this,"engine",kP,this),(0,In.Z)(this,"shaderModule",IP,this)}return(0,Hn.Z)(r,[{key:"execute",value:function(){var e=(0,Yr.Z)(yn().mark(function n(){return yn().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:case"end":return o.stop()}},n)}));function t(){return e.apply(this,arguments)}return t}()},{key:"tearDown",value:function(){this.material.clear()}},{key:"createShaderMaterial",value:function(t){var n=Dl(),i=t.vertexShader,o=t.fragmentShader,s=[];if(!this.engine.supportWebGPU){var a="material-".concat(n);this.shaderModule.registerModule(a,{vs:t.vertexShader,fs:t.fragmentShader});var l=this.shaderModule.getModule(a);i=l.vs,o=l.fs,l.uniforms&&(s=Object.keys(l.uniforms).map(function(c){return{dirty:!0,name:c,data:l.uniforms[c]}}))}return this.material.create(n,FP(FP({vertexShaderGLSL:i,fragmentShaderGLSL:o},t),{},{uniforms:s}))}}]),r}(),LP),RP=(0,Ln.Z)(L0.prototype,"material",[PP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kP=(0,Ln.Z)(L0.prototype,"engine",[OP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IP=(0,Ln.Z)(L0.prototype,"shaderModule",[DP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L0))||NP);function p$(r){var e=g$();return function(){var n=(0,li.Z)(r),i;if(e){var o=(0,li.Z)(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return(0,ds.Z)(this,i)}}function g$(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var Dw;(function(r){r[r.Standard=0]="Standard"})(Dw||(Dw={}));var m$=function(r){(0,us.Z)(t,r);var e=p$(t);function t(n){var i;return(0,Sn.Z)(this,t),i=e.call(this,n),i.strategy=Dw.Standard,i.visibilityPlaneMask=0,i.visible=!1,Object.assign((0,co.Z)(i),n),i}return t}(Jd),Nw=function(){function r(e,t){(0,Sn.Z)(this,r),this.center=void 0,this.halfExtents=void 0,this.min=Xe.create(),this.max=Xe.create(),this.update(e,t)}return(0,Hn.Z)(r,[{key:"update",value:function(t,n){this.center=t||Xe.create(),this.halfExtents=n||Xe.fromValues(.5,.5,.5),this.min=Xe.sub(this.min,this.center,this.halfExtents),this.max=Xe.add(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(t,n){Xe.add(this.center,n,t),Xe.scale(this.center,this.center,.5),Xe.sub(this.halfExtents,n,t),Xe.scale(this.halfExtents,this.halfExtents,.5),Xe.copy(this.min,t),Xe.copy(this.max,n)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(t){var n=this.center,i=n[0],o=n[1],s=n[2],a=this.halfExtents,l=a[0],c=a[1],u=a[2],d=i-l,h=i+l,f=o-c,p=o+c,g=s-u,v=s+u,y=t.center,x=y[0],E=y[1],T=y[2],P=t.halfExtents,z=P[0],$=P[1],ne=P[2],De=x-z,fe=x+z,Ae=E-$,de=E+$,ct=T-ne,bt=T+ne;De<d&&(d=De),fe>h&&(h=fe),Ae<f&&(f=Ae),de>p&&(p=de),ct<g&&(g=ct),bt>v&&(v=bt),n[0]=(d+h)*.5,n[1]=(f+p)*.5,n[2]=(g+v)*.5,a[0]=(h-d)*.5,a[1]=(p-f)*.5,a[2]=(v-g)*.5,this.min[0]=d,this.min[1]=f,this.min[2]=g,this.max[0]=h,this.max[1]=p,this.max[2]=v}},{key:"intersects",value:function(t){var n=this.getMax(),i=this.getMin(),o=t.getMax(),s=t.getMin();return i[0]<=o[0]&&n[0]>=s[0]&&i[1]<=o[1]&&n[1]>=s[1]&&i[2]<=o[2]&&n[2]>=s[2]}},{key:"containsPoint",value:function(t){var n=this.getMin(),i=this.getMax();return!(t[0]<n[0]||t[0]>i[0]||t[1]<n[1]||t[1]>i[1]||t[2]<n[2]||t[2]>i[2])}},{key:"getNegativeFarPoint",value:function(t){return t.pnVertexFlag===273?Xe.copy(Xe.create(),this.min):t.pnVertexFlag===272?Xe.fromValues(this.min[0],this.min[1],this.max[2]):t.pnVertexFlag===257?Xe.fromValues(this.min[0],this.max[1],this.min[2]):t.pnVertexFlag===256?Xe.fromValues(this.min[0],this.max[1],this.max[2]):t.pnVertexFlag===17?Xe.fromValues(this.max[0],this.min[1],this.min[2]):t.pnVertexFlag===16?Xe.fromValues(this.max[0],this.min[1],this.max[2]):t.pnVertexFlag===1?Xe.fromValues(this.max[0],this.max[1],this.min[2]):Xe.fromValues(this.max[0],this.max[1],this.max[2])}},{key:"getPositiveFarPoint",value:function(t){return t.pnVertexFlag===273?Xe.copy(Xe.create(),this.max):t.pnVertexFlag===272?Xe.fromValues(this.max[0],this.max[1],this.min[2]):t.pnVertexFlag===257?Xe.fromValues(this.max[0],this.min[1],this.max[2]):t.pnVertexFlag===256?Xe.fromValues(this.max[0],this.min[1],this.min[2]):t.pnVertexFlag===17?Xe.fromValues(this.min[0],this.max[1],this.max[2]):t.pnVertexFlag===16?Xe.fromValues(this.min[0],this.max[1],this.min[2]):t.pnVertexFlag===1?Xe.fromValues(this.min[0],this.min[1],this.max[2]):Xe.fromValues(this.min[0],this.min[1],this.min[2])}}]),r}();function v$(r){var e=y$();return function(){var n=(0,li.Z)(r),i;if(e){var o=(0,li.Z)(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return(0,ds.Z)(this,i)}}function y$(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var b$=function(r){(0,us.Z)(t,r);var e=v$(t);function t(n){var i;return(0,Sn.Z)(this,t),i=e.call(this,n),i.material=void 0,i.geometry=void 0,i.aabb=new Nw,i.aabbDirty=!0,i.model=void 0,i.visible=!0,i.children=[],Object.assign((0,co.Z)(i),n),i}return t}(Jd),x$=function(){function r(e,t){(0,Sn.Z)(this,r),this.distance=void 0,this.normal=void 0,this.pnVertexFlag=void 0,this.distance=e||0,this.normal=t||Xe.fromValues(0,1,0),this.updatePNVertexFlag()}return(0,Hn.Z)(r,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(t){return Xe.dot(t,this.normal)-this.distance}},{key:"normalize",value:function(){var t=1/Xe.len(this.normal);Xe.scale(this.normal,this.normal,t),this.distance*=t}},{key:"intersectsLine",value:function(t,n,i){var o=this.distanceToPoint(t),s=this.distanceToPoint(n),a=o/(o-s),l=a>=0&&a<=1;return l&&i&&Xe.lerp(i,t,n,a),l}}]),r}(),Eu;(function(r){r[r.OUTSIDE=4294967295]="OUTSIDE",r[r.INSIDE=0]="INSIDE",r[r.INDETERMINATE=2147483647]="INDETERMINATE"})(Eu||(Eu={}));var C$=function(){function r(e){if((0,Sn.Z)(this,r),this.planes=[],e)this.planes=e;else for(var t=0;t<6;t++)this.planes.push(new x$)}return(0,Hn.Z)(r,[{key:"extractFromVPMatrix",value:function(t){var n=(0,I0.Z)(t,16),i=n[0],o=n[1],s=n[2],a=n[3],l=n[4],c=n[5],u=n[6],d=n[7],h=n[8],f=n[9],p=n[10],g=n[11],v=n[12],y=n[13],x=n[14],E=n[15];Xe.set(this.planes[0].normal,a-i,d-l,g-h),this.planes[0].distance=-(E-v),Xe.set(this.planes[1].normal,a+i,d+l,g+h),this.planes[1].distance=-(E+v),Xe.set(this.planes[2].normal,a+o,d+c,g+f),this.planes[2].distance=-(E+y),Xe.set(this.planes[3].normal,a-o,d-c,g-f),this.planes[3].distance=-(E-y),Xe.set(this.planes[4].normal,a-s,d-u,g-p),this.planes[4].distance=-(E-x),Xe.set(this.planes[5].normal,a+s,d+u,g+p),this.planes[5].distance=-(E+x),this.planes.forEach(function(T){T.normalize(),T.updatePNVertexFlag()})}}]),r}();function fne(r){return typeof r=="number"}function pne(r){return r===void 0?0:r>360||r<-360?r%360:r}function gne(r,e,t){return isNumber(r)?vec3.fromValues(r,e,t):r.length===3?vec3.clone(r):vec3.fromValues(r[0],r[1],r[2])}function w$(r,e){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[4],e[4]=r[5],e[5]=r[6],e[6]=r[8],e[7]=r[9],e[8]=r[10],e}function E$(r){var e=(0,I0.Z)(r,3),t=e[0],n=e[1],i=e[2],o=t+n*256+i*65536-1;return o}function mne(r){return[r+1&255,r+1>>8&255,r+1>>8>>8&255]}var BP,zP,UP,VP,jP,HP,$P,nh,WP,ZP,XP,YP,KP,qP;function JP(r,e){var t;if(typeof Symbol=="undefined"||r[Symbol.iterator]==null){if(Array.isArray(r)||(t=S$(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,s=!1,a;return{s:function(){t=r[Symbol.iterator]()},n:function(){var c=t.next();return o=c.done,c},e:function(c){s=!0,a=c},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(s)throw a}}}}function S$(r,e){if(!!r){if(typeof r=="string")return QP(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return QP(r,e)}}function QP(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var _$=(BP=(0,R.b2)(),zP=(0,R.f3)(Ct.MeshComponentManager),UP=(0,R.f3)(Ct.CullableComponentManager),VP=(0,R.f3)(Ct.GeometryComponentManager),jP=(0,R.f3)(Ct.HierarchyComponentManager),HP=(0,R.f3)(Ct.TransformComponentManager),BP($P=(nh=(qP=function(){function r(){(0,Sn.Z)(this,r),(0,In.Z)(this,"mesh",WP,this),(0,In.Z)(this,"cullable",ZP,this),(0,In.Z)(this,"geometry",XP,this),(0,In.Z)(this,"hierarchy",YP,this),(0,In.Z)(this,"transform",KP,this),this.planes=void 0}return(0,Hn.Z)(r,[{key:"setFrustumPlanes",value:function(t){this.planes=t}},{key:"execute",value:function(){var e=(0,Yr.Z)(yn().mark(function n(i){var o,s,a,l,c,u,d,h,f,p,g,v,y,x,E,T,P,z,$,ne,De;return yn().wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:o=JP(i);try{for(o.s();!(s=o.n()).done;){a=s.value,l=a.getScene(),c=a.getCamera(),u=JP(l.getEntities());try{for(u.s();!(d=u.n()).done;)h=d.value,f=this.mesh.getComponentByEntity(h),f&&(p=this.hierarchy.getComponentByEntity(h),g=this.cullable.getComponentByEntity(h),v=f.geometry,y=this.transform.getComponentByEntity(h),v&&v.aabb&&y&&f.aabbDirty&&(x=y.worldTransform,E=v.aabb,T=E.center,P=E.halfExtents,z=Xe.transformMat4(Xe.create(),T,x),$=w$(x,eh.Ue()),ne=Xe.transformMat3(Xe.create(),P,$),f.aabb.update(z,ne),f.aabbDirty=!1),g&&v&&(De=this.cullable.getComponentByEntity((p==null?void 0:p.parentID)||-1),g.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(f.aabb,(De==null?void 0:De.visibilityPlaneMask)||Eu.INDETERMINATE,this.planes||c.getFrustum().planes),g.visible=g.visibilityPlaneMask!==Eu.OUTSIDE))}catch(de){u.e(de)}finally{u.f()}}}catch(de){o.e(de)}finally{o.f()}case 2:case"end":return Ae.stop()}},n,this)}));function t(n){return e.apply(this,arguments)}return t}()},{key:"tearDown",value:function(){this.cullable.clear(),this.mesh.clear()}},{key:"computeVisibilityWithPlaneMask",value:function(t,n,i){if(n===Eu.OUTSIDE||n===Eu.INSIDE)return n;for(var o=Eu.INSIDE,s=0,a=i.length;s<a;++s){var l=s<31?1<<s:0;if(!(s<31&&(n&l)==0)){var c=i[s],u=c.normal,d=c.distance;if(Xe.dot(u,t.getNegativeFarPoint(i[s]))+d>0)return Eu.OUTSIDE;Xe.dot(u,t.getPositiveFarPoint(i[s]))+d>0&&(o|=l)}}return o}}]),r}(),qP),WP=(0,Ln.Z)(nh.prototype,"mesh",[zP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZP=(0,Ln.Z)(nh.prototype,"cullable",[UP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XP=(0,Ln.Z)(nh.prototype,"geometry",[VP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YP=(0,Ln.Z)(nh.prototype,"hierarchy",[jP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KP=(0,Ln.Z)(nh.prototype,"transform",[HP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nh))||$P),jn=w(85975),eO,tO,nO,rO,iO,oO,sO,aO,lO,cO,uO,dO,Ha,hO,fO,pO,gO,mO,vO,yO,bO,xO,CO,wO;function Ob(r,e){var t;if(typeof Symbol=="undefined"||r[Symbol.iterator]==null){if(Array.isArray(r)||(t=A$(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,s=!1,a;return{s:function(){t=r[Symbol.iterator]()},n:function(){var c=t.next();return o=c.done,c},e:function(c){s=!0,a=c},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(s)throw a}}}}function A$(r,e){if(!!r){if(typeof r=="string")return EO(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return EO(r,e)}}function EO(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var tp=(eO=(0,R.b2)(),tO=(0,R.f3)(Ct.MeshComponentManager),nO=(0,R.f3)(Ct.GeometryComponentManager),rO=(0,R.f3)(Ct.MaterialComponentManager),iO=(0,R.f3)(Ct.CullableComponentManager),oO=(0,R.f3)(Ct.TransformComponentManager),sO=(0,R.f3)(Ct.HierarchyComponentManager),aO=(0,R.f3)(Ct.Systems),lO=(0,R.t6)(Ct.FrameGraphSystem),cO=(0,R.f3)(Ct.RenderEngine),uO=(0,R.f3)(Ct.ResourcePool),eO(dO=(Ha=(wO=CO=function(){function r(){var e=this;(0,Sn.Z)(this,r),(0,In.Z)(this,"mesh",hO,this),(0,In.Z)(this,"geometry",fO,this),(0,In.Z)(this,"material",pO,this),(0,In.Z)(this,"cullable",gO,this),(0,In.Z)(this,"transform",mO,this),(0,In.Z)(this,"hierarchy",vO,this),(0,In.Z)(this,"frameGraphSystem",yO,this),(0,In.Z)(this,"engine",bO,this),(0,In.Z)(this,"resourcePool",xO,this),this.modelCache={},this.setup=function(t,n,i){var o=t.createRenderTarget(n,"color buffer",{width:1,height:1,usage:Fe.RENDER_ATTACHMENT|Fe.SAMPLED|Fe.COPY_SRC});i.data={output:n.write(t,o)}},this.execute=function(){var t=(0,Yr.Z)(yn().mark(function n(i,o,s){var a,l,c,u,d,h;return yn().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:a=i.getResourceNode(o.data.output),l=e.resourcePool.getOrCreateResource(a.resource),c=Ob(s),p.prev=3,c.s();case 5:if((u=c.n()).done){p.next=11;break}return d=u.value,p.next=9,e.initView(d);case 9:p.next=5;break;case 11:p.next=16;break;case 13:p.prev=13,p.t0=p.catch(3),c.e(p.t0);case 16:return p.prev=16,c.f(),p.finish(16);case 19:h=e.engine.getCanvas(),l.resize({width:h.width,height:h.height}),e.engine.setScissor({enable:!1}),e.engine.clear({framebuffer:l,color:s[0].getClearColor(),depth:1}),e.engine.useFramebuffer(l,function(){var g=Ob(s),v;try{for(g.s();!(v=g.n()).done;){var y=v.value;e.renderView(y)}}catch(x){g.e(x)}finally{g.f()}});case 24:case"end":return p.stop()}},n,null,[[3,13,16,19]])}));return function(n,i,o){return t.apply(this,arguments)}}()}return(0,Hn.Z)(r,[{key:"renderView",value:function(t){var n=t.getScene(),i=t.getCamera(),o=i.getViewTransform(),s=jn.multiply(jn.create(),i.getPerspective(),o);i.getFrustum().extractFromVPMatrix(s);var a=t.getViewport(),l=a.x,c=a.y,u=a.width,d=a.height;this.engine.viewport({x:l,y:c,width:u,height:d});var h=Ob(n.getEntities()),f;try{for(h.s();!(f=h.n()).done;){var p=f.value;this.renderMesh(p,{camera:i,view:t,viewMatrix:o})}}catch(g){h.e(g)}finally{h.f()}}},{key:"renderMesh",value:function(t,n){var i=n.camera,o=n.view,s=n.viewMatrix,a=this.mesh.getComponentByEntity(t);if(!(!a||!a.visible)){var l=a.material,c=a.geometry;if(!(!c||c.dirty||!l)){var u=this.transform.getComponentByEntity(t),d=jn.multiply(jn.create(),s,u.worldTransform),h=o.getViewport(),f=h.width,p=h.height;l.setUniform({projectionMatrix:i.getPerspective(),modelViewMatrix:d,modelMatrix:u.worldTransform,viewMatrix:s,cameraPosition:i.getPosition(),u_viewport:[f,p]}),a.model&&(a.model.draw({uniforms:l.uniforms.reduce(function(g,v){return g[v.name]=v.data,g},{})}),l.uniforms.forEach(function(g){g.dirty=!1}),l.dirty=!1)}}}},{key:"initMesh",value:function(){var e=(0,Yr.Z)(yn().mark(function n(i,o){var s,a,l,c,u,d,h,f;return yn().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(s=this.mesh.getComponentByEntity(i),s){g.next=3;break}return g.abrupt("return");case 3:if(a=s.material,l=s.geometry,!(!l||l.dirty||!a)){g.next=7;break}return g.abrupt("return");case 7:if(s.model){g.next=24;break}if(c="m-".concat(a.entity,"-g-").concat(l.entity),!this.modelCache[c]){g.next=12;break}return s.model=this.modelCache[c],g.abrupt("return");case 12:return a.setUniform({projectionMatrix:1,modelViewMatrix:1,modelMatrix:1,viewMatrix:1,cameraPosition:1,u_viewport:1}),u=this.engine,d=u.createModel,h=u.createAttribute,f={vs:a.vertexShaderGLSL,fs:a.fragmentShaderGLSL,defines:a.defines,attributes:l.attributes.reduce(function(v,y){return y.data&&y.buffer&&(v[y.name]=h({buffer:y.buffer,attributes:y.attributes,arrayStride:y.arrayStride,stepMode:y.stepMode,divisor:y.stepMode==="vertex"?0:1})),v},{}),uniforms:a.uniforms.reduce(function(v,y){return v[y.name]=y.data,v},{}),scissor:{enable:!0,box:function(){return o.getViewport()}}},a.cull&&(f.cull=a.cull),a.depth&&(f.depth=a.depth),a.blend&&(f.blend=a.blend),l.indicesBuffer&&(f.elements=l.indicesBuffer),l.maxInstancedCount&&(f.instances=l.maxInstancedCount,f.count=l.vertexCount||3),g.next=22,d(f);case 22:s.model=g.sent,this.modelCache[c]=s.model;case 24:case"end":return g.stop()}},n,this)}));function t(n,i){return e.apply(this,arguments)}return t}()},{key:"initView",value:function(){var e=(0,Yr.Z)(yn().mark(function n(i){var o,s,a,l;return yn().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:o=i.getScene(),s=Ob(o.getEntities()),u.prev=2,s.s();case 4:if((a=s.n()).done){u.next=10;break}return l=a.value,u.next=8,this.initMesh(l,i);case 8:u.next=4;break;case 10:u.next=15;break;case 12:u.prev=12,u.t0=u.catch(2),s.e(u.t0);case 15:return u.prev=15,s.f(),u.finish(15);case 18:case"end":return u.stop()}},n,this,[[2,12,15,18]])}));function t(n){return e.apply(this,arguments)}return t}()}]),r}(),CO.IDENTIFIER="Render Pass",wO),hO=(0,Ln.Z)(Ha.prototype,"mesh",[tO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fO=(0,Ln.Z)(Ha.prototype,"geometry",[nO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pO=(0,Ln.Z)(Ha.prototype,"material",[rO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gO=(0,Ln.Z)(Ha.prototype,"cullable",[iO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mO=(0,Ln.Z)(Ha.prototype,"transform",[oO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vO=(0,Ln.Z)(Ha.prototype,"hierarchy",[sO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yO=(0,Ln.Z)(Ha.prototype,"frameGraphSystem",[aO,lO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bO=(0,Ln.Z)(Ha.prototype,"engine",[cO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xO=(0,Ln.Z)(Ha.prototype,"resourcePool",[uO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ha))||dO),SO,_O,AO,TO,MO,PO,np,OO,DO,NO,RO,kO,IO;function Rw(r,e){var t;if(typeof Symbol=="undefined"||r[Symbol.iterator]==null){if(Array.isArray(r)||(t=T$(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,s=!1,a;return{s:function(){t=r[Symbol.iterator]()},n:function(){var c=t.next();return o=c.done,c},e:function(c){s=!0,a=c},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(s)throw a}}}}function T$(r,e){if(!!r){if(typeof r=="string")return LO(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return LO(r,e)}}function LO(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var kw={NONE:0,ENCODE:1,HIGHLIGHT:2},Iw=(SO=(0,R.b2)(),_O=(0,R.f3)(Ct.RenderEngine),AO=(0,R.f3)(Ct.ResourcePool),TO=(0,R.f3)(Ct.RenderPassFactory),MO=(0,R.f3)(Ct.MeshComponentManager),SO(PO=(np=(IO=kO=function(){function r(){var e=this;(0,Sn.Z)(this,r),(0,In.Z)(this,"engine",OO,this),(0,In.Z)(this,"resourcePool",DO,this),(0,In.Z)(this,"renderPassFactory",NO,this),(0,In.Z)(this,"mesh",RO,this),this.pickingFBO=void 0,this.views=void 0,this.highlightEnabled=!0,this.highlightColor=[255,0,0,255],this.alreadyInRendering=!1,this.setup=function(t,n,i){var o=t.createRenderTarget(n,"picking fbo",{width:1,height:1});i.data={output:n.write(t,o)},n.hasSideEffect=!0},this.execute=function(){var t=(0,Yr.Z)(yn().mark(function n(i,o,s){var a,l,c;return yn().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(e.views=s,!e.alreadyInRendering){d.next=3;break}return d.abrupt("return");case 3:a=Rw(s);try{for(c=function(){var f=l.value,p=f.getViewport(),g=p.width,v=p.height;e.alreadyInRendering=!0;var y=i.getResourceNode(o.data.output);e.pickingFBO=e.resourcePool.getOrCreateResource(y.resource),e.pickingFBO.resize({width:g,height:v}),e.engine.useFramebuffer(e.pickingFBO,function(){e.engine.clear({framebuffer:e.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var x=e.renderPassFactory(tp.IDENTIFIER),E=[],T=f.getScene(),P=Rw(T.getEntities()),z;try{for(P.s();!(z=P.n()).done;){var $=z.value,ne=e.mesh.getComponentByEntity($),De=ne.material;De.setUniform("u_PickingStage",kw.ENCODE),E.push(ne)}}catch(fe){P.e(fe)}finally{P.f()}x.renderView(f),E.forEach(function(fe){var Ae=fe.material;Ae.setUniform("u_PickingStage",kw.HIGHLIGHT)}),e.alreadyInRendering=!1})},a.s();!(l=a.n()).done;)c()}catch(h){a.e(h)}finally{a.f()}case 5:case"end":return d.stop()}},n)}));return function(n,i,o){return t.apply(this,arguments)}}(),this.pick=function(t,n){var i=t.x,o=t.y,s=e.engine,a=s.readPixels,l=s.useFramebuffer,c=n.getViewport(),u=c.width,d=c.height,h=i*window.devicePixelRatio,f=o*window.devicePixelRatio;if(!(h>u||h<0||f>d||f<0)){var p,g;return l(e.pickingFBO,function(){p=a({x:Math.round(h),y:Math.round(d-(o+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:e.pickingFBO}),(p[0]!==0||p[1]!==0||p[2]!==0)&&(g=E$(p),e.highlightEnabled&&e.highlightPickedFeature(p,n))}),g}}}return(0,Hn.Z)(r,[{key:"enableHighlight",value:function(t){this.highlightEnabled=t}},{key:"setHighlightColor",value:function(t){this.highlightColor=t}},{key:"highlightPickedFeature",value:function(t,n){if(t){var i=Rw(n.getScene().getEntities()),o;try{for(i.s();!(o=i.n()).done;){var s=o.value,a=this.mesh.getComponentByEntity(s),l=a.material;l.setUniform("u_PickingStage",kw.HIGHLIGHT),l.setUniform("u_PickingColor",[t[0],t[1],t[2]]),l.setUniform("u_HighlightColor",this.highlightColor)}}catch(c){i.e(c)}finally{i.f()}}}}]),r}(),kO.IDENTIFIER="PixelPicking Pass",IO),OO=(0,Ln.Z)(np.prototype,"engine",[_O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DO=(0,Ln.Z)(np.prototype,"resourcePool",[AO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NO=(0,Ln.Z)(np.prototype,"renderPassFactory",[TO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RO=(0,Ln.Z)(np.prototype,"mesh",[MO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),np))||PO),GO,FO,BO,zO,Db,UO,VO,jO,HO,M$=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,P$=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,O$=`layout(set = 0, binding = 0) uniform sampler u_TextureSampler;
layout(set = 0, binding = 1) uniform texture2D u_Texture;

layout(location = 0) in vec2 v_UV;
layout(location = 0) out vec4 outColor;

void main() {
  outColor = texture(sampler2D(u_Texture, u_TextureSampler), v_UV);
}`,D$=`layout(location = 0) in vec2 a_Position;
layout(location = 0) out vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Nb=(GO=(0,R.b2)(),FO=(0,R.f3)(Ct.RenderEngine),BO=(0,R.f3)(Ct.ResourcePool),GO(zO=(Db=(HO=jO=function r(){var e=this;(0,Sn.Z)(this,r),(0,In.Z)(this,"engine",UO,this),(0,In.Z)(this,"resourcePool",VO,this),this.model=void 0,this.setup=function(t,n,i){var o=t.getPass(tp.IDENTIFIER);if(o){var s=t.createRenderTarget(n,"render to screen",{width:1,height:1});i.data={input:n.read(o.data.output),output:n.write(t,s)}}},this.execute=function(){var t=(0,Yr.Z)(yn().mark(function n(i,o){var s,a,l,c,u,d,h;return yn().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(s=e.engine,a=s.createModel,l=s.createAttribute,c=s.createBuffer,e.model){p.next=6;break}return p.next=4,a({vs:e.engine.supportWebGPU?D$:P$,fs:e.engine.supportWebGPU?O$:M$,attributes:{a_Position:l({buffer:c({data:[-4,-4,4,-4,0,4],type:Fe.FLOAT}),size:2,arrayStride:2*4,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]})},uniforms:{u_Texture:null},depth:{enable:!1},count:3,blend:{enable:!0}});case 4:u=p.sent,e.model=u;case 6:d=i.getResourceNode(o.data.input),h=e.resourcePool.getOrCreateResource(d.resource),e.engine.useFramebuffer(null,function(){e.engine.clear({framebuffer:null,color:[0,0,0,0],depth:1,stencil:0}),e.model.draw({uniforms:{u_Texture:h}})});case 9:case"end":return p.stop()}},n)}));return function(n,i){return t.apply(this,arguments)}}(),this.tearDown=function(){e.model=void 0}},jO.IDENTIFIER="Copy Pass",HO),UO=(0,Ln.Z)(Db.prototype,"engine",[FO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VO=(0,Ln.Z)(Db.prototype,"resourcePool",[BO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Db))||zO),$O,WO,ZO,XO,YO,KO,qO,rp,JO,QO,eD,tD,nD,N$=($O=(0,R.b2)(),WO=(0,R.f3)(Ct.Systems),ZO=(0,R.t6)(Ct.FrameGraphSystem),XO=(0,R.f3)(Ct.RenderPassFactory),YO=(0,R.f3)(Ct.ConfigService),KO=(0,R.f3)(Ct.ResourcePool),$O(qO=(rp=(nD=function(){function r(){(0,Sn.Z)(this,r),(0,In.Z)(this,"frameGraphSystem",JO,this),(0,In.Z)(this,"renderPassFactory",QO,this),(0,In.Z)(this,"configService",eD,this),(0,In.Z)(this,"resourcePool",tD,this)}return(0,Hn.Z)(r,[{key:"execute",value:function(){var e=(0,Yr.Z)(yn().mark(function n(i){var o,s,a,l,c,u,d,h,f;return yn().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:o=this.renderPassFactory(tp.IDENTIFIER),s=o.setup,a=o.execute,l=this.frameGraphSystem.addPass(tp.IDENTIFIER,s,a),c=this.renderPassFactory(Nb.IDENTIFIER),u=c.setup,d=c.execute,h=c.tearDown,f=this.frameGraphSystem.addPass(Nb.IDENTIFIER,u,d,h),this.frameGraphSystem.present(f.data.output);case 5:case"end":return g.stop()}},n,this)}));function t(n){return e.apply(this,arguments)}return t}()},{key:"tearDown",value:function(){this.resourcePool.clean()}},{key:"pick",value:function(t,n){var i=this.renderPassFactory(Iw.IDENTIFIER);return i.pick(t,n)}}]),r}(),nD),JO=(0,Ln.Z)(rp.prototype,"frameGraphSystem",[WO,ZO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QO=(0,Ln.Z)(rp.prototype,"renderPassFactory",[XO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eD=(0,Ln.Z)(rp.prototype,"configService",[YO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tD=(0,Ln.Z)(rp.prototype,"resourcePool",[KO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rp))||qO);function R$(r){var e=k$();return function(){var n=(0,li.Z)(r),i;if(e){var o=(0,li.Z)(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return(0,ds.Z)(this,i)}}function k$(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var I$=function(r){(0,us.Z)(t,r);var e=R$(t);function t(n){var i;return(0,Sn.Z)(this,t),i=e.call(this,n),i.parentID=void 0,Object.assign((0,co.Z)(i),n),i}return t}(Jd),rD,iD,oD,sD,aD,G0,lD,cD,uD,dD,L$=(rD=(0,R.b2)(),iD=(0,R.f3)(Ct.HierarchyComponentManager),oD=(0,R.f3)(Ct.TransformComponentManager),sD=(0,R.f3)(Ct.MeshComponentManager),rD(aD=(G0=(dD=function(){function r(){(0,Sn.Z)(this,r),(0,In.Z)(this,"hierarchy",lD,this),(0,In.Z)(this,"transform",cD,this),(0,In.Z)(this,"mesh",uD,this)}return(0,Hn.Z)(r,[{key:"execute",value:function(){var e=(0,Yr.Z)(yn().mark(function n(){return yn().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:this.runTransformUpdateSystem(),this.runHierarchyUpdateSystem();case 2:case"end":return o.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"tearDown",value:function(){this.hierarchy.clear(),this.transform.clear()}},{key:"getHierarchyComponentManager",value:function(){return this.hierarchy}},{key:"getTransformComponentManager",value:function(){return this.transform}},{key:"runTransformUpdateSystem",value:function(){var t=this;this.transform.forEach(function(n,i){(i.isDirty()||i.isLocalDirty())&&(t.setMeshAABBDirty(t.mesh.getComponentByEntity(n)),i.updateTransform())})}},{key:"runHierarchyUpdateSystem",value:function(){var t=this;this.hierarchy.forEach(function(n,i){var o=t.transform.getComponentByEntity(n),s=t.transform.getComponentByEntity(i.parentID);o!==null&&s!==null&&o.updateTransformWithParent(s)})}},{key:"attach",value:function(t,n,i){this.hierarchy.contains(t)&&this.detach(t),this.hierarchy.create(t,{parentID:n});var o=this.mesh.getComponentByEntity(n);if(this.setMeshAABBDirty(o),o&&o.children.indexOf(t)===-1&&o.children.push(t),this.hierarchy.getCount()>1)for(var s=this.hierarchy.getCount()-1;s>0;--s)for(var a=this.hierarchy.getEntity(s),l=0;l<s;++l){var c=this.hierarchy.getComponent(l);if(c.parentID===a){this.hierarchy.moveItem(s,l),++s;break}}var u=this.hierarchy.getComponentByEntity(t),d=this.transform.getComponentByEntity(n);d===null&&(d=this.transform.create(n));var h=this.transform.getComponentByEntity(t);h===null&&(h=this.transform.create(t),d=this.transform.getComponentByEntity(n)),h.parent=d,!i&&d&&(h.matrixTransform(jn.invert(jn.create(),d.worldTransform)),h.updateTransform()),d&&h.updateTransformWithParent(d)}},{key:"detach",value:function(t){var n=this.hierarchy.getComponentByEntity(t);if(n!==null){var i=this.transform.getComponentByEntity(t);i!==null&&(i.parent=null,i.applyTransform()),this.hierarchy.removeKeepSorted(t);var o=this.mesh.getComponentByEntity(n.parentID);if(o){var s=o.children.indexOf(t);o.children.splice(s,1)}this.setMeshAABBDirty(o)}}},{key:"detachChildren",value:function(t){var n=this.mesh.getComponentByEntity(t);n&&(n.children=[]);for(var i=0;i<this.hierarchy.getCount();){var o;if(((o=this.hierarchy.getComponent(i))===null||o===void 0?void 0:o.parentID)===t){var s=this.hierarchy.getEntity(i);this.detach(s)}else++i}}},{key:"setMeshAABBDirty",value:function(t){t&&(t.aabbDirty=!0)}}]),r}(),dD),lD=(0,Ln.Z)(G0.prototype,"hierarchy",[iD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cD=(0,Ln.Z)(G0.prototype,"transform",[oD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uD=(0,Ln.Z)(G0.prototype,"mesh",[sD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G0))||aD),Lw=w(49685);function Go(){var r=new Lw.WT(4);return Lw.WT!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function vne(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function rh(r,e,t){t=t*.5;var n=Math.sin(t);return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=Math.cos(t),r}function yne(r,e){var t=Math.acos(e[3])*2,n=Math.sin(t/2);return n>glMatrix.EPSILON?(r[0]=e[0]/n,r[1]=e[1]/n,r[2]=e[2]/n):(r[0]=1,r[1]=0,r[2]=0),t}function bne(r,e){var t=V$(r,e);return Math.acos(2*t*t-1)}function Sa(r,e,t){var n=e[0],i=e[1],o=e[2],s=e[3],a=t[0],l=t[1],c=t[2],u=t[3];return r[0]=n*u+s*a+i*c-o*l,r[1]=i*u+s*l+o*a-n*c,r[2]=o*u+s*c+n*l-i*a,r[3]=s*u-n*a-i*l-o*c,r}function xne(r,e,t){t*=.5;var n=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(t),l=Math.cos(t);return r[0]=n*l+s*a,r[1]=i*l+o*a,r[2]=o*l-i*a,r[3]=s*l-n*a,r}function Cne(r,e,t){t*=.5;var n=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(t),l=Math.cos(t);return r[0]=n*l-o*a,r[1]=i*l+s*a,r[2]=o*l+n*a,r[3]=s*l-i*a,r}function wne(r,e,t){t*=.5;var n=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(t),l=Math.cos(t);return r[0]=n*l+i*a,r[1]=i*l-n*a,r[2]=o*l+s*a,r[3]=s*l-o*a,r}function Ene(r,e){var t=e[0],n=e[1],i=e[2];return r[0]=t,r[1]=n,r[2]=i,r[3]=Math.sqrt(Math.abs(1-t*t-n*n-i*i)),r}function G$(r,e){var t=e[0],n=e[1],i=e[2],o=e[3],s=Math.sqrt(t*t+n*n+i*i),a=Math.exp(o),l=s>0?a*Math.sin(s)/s:0;return r[0]=t*l,r[1]=n*l,r[2]=i*l,r[3]=a*Math.cos(s),r}function F$(r,e){var t=e[0],n=e[1],i=e[2],o=e[3],s=Math.sqrt(t*t+n*n+i*i),a=s>0?Math.atan2(s,o)/s:0;return r[0]=t*a,r[1]=n*a,r[2]=i*a,r[3]=.5*Math.log(t*t+n*n+i*i+o*o),r}function Sne(r,e,t){return F$(r,e),U$(r,r,t),G$(r,r),r}function Rb(r,e,t,n){var i=e[0],o=e[1],s=e[2],a=e[3],l=t[0],c=t[1],u=t[2],d=t[3],h,f,p,g,v;return f=i*l+o*c+s*u+a*d,f<0&&(f=-f,l=-l,c=-c,u=-u,d=-d),1-f>Lw.Ib?(h=Math.acos(f),p=Math.sin(h),g=Math.sin((1-n)*h)/p,v=Math.sin(n*h)/p):(g=1-n,v=n),r[0]=g*i+v*l,r[1]=g*o+v*c,r[2]=g*s+v*u,r[3]=g*a+v*d,r}function _ne(r){var e=glMatrix.RANDOM(),t=glMatrix.RANDOM(),n=glMatrix.RANDOM(),i=Math.sqrt(1-e),o=Math.sqrt(e);return r[0]=i*Math.sin(2*Math.PI*t),r[1]=i*Math.cos(2*Math.PI*t),r[2]=o*Math.sin(2*Math.PI*n),r[3]=o*Math.cos(2*Math.PI*n),r}function hD(r,e){var t=e[0],n=e[1],i=e[2],o=e[3],s=t*t+n*n+i*i+o*o,a=s?1/s:0;return r[0]=-t*a,r[1]=-n*a,r[2]=-i*a,r[3]=o*a,r}function Ane(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r}function B$(r,e){var t=e[0]+e[4]+e[8],n;if(t>0)n=Math.sqrt(t+1),r[3]=.5*n,n=.5/n,r[0]=(e[5]-e[7])*n,r[1]=(e[6]-e[2])*n,r[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var o=(i+1)%3,s=(i+2)%3;n=Math.sqrt(e[i*3+i]-e[o*3+o]-e[s*3+s]+1),r[i]=.5*n,n=.5/n,r[3]=(e[o*3+s]-e[s*3+o])*n,r[o]=(e[o*3+i]+e[i*3+o])*n,r[s]=(e[s*3+i]+e[i*3+s])*n}return r}function Gw(r,e,t,n){var i=.5*Math.PI/180;e*=i,t*=i,n*=i;var o=Math.sin(e),s=Math.cos(e),a=Math.sin(t),l=Math.cos(t),c=Math.sin(n),u=Math.cos(n);return r[0]=o*l*u-s*a*c,r[1]=s*a*u+o*l*c,r[2]=s*l*c-o*a*u,r[3]=s*l*u+o*a*c,r}function Tne(r){return"quat("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"}var Mne=ro.d9,Fw=ro.al,F0=ro.JG,Pne=ro.t8,One=ro.IH,z$=Sa,U$=ro.bA,V$=ro.AK,Dne=ro.t7,Nne=ro.kE,Rne=null,kne=ro.we,Ine=null,ip=ro.Fv,Lne=ro.I6,Gne=ro.fS,Fne=function(){var r=Xe.create(),e=Xe.fromValues(1,0,0),t=Xe.fromValues(0,1,0);return function(n,i,o){var s=Xe.dot(i,o);return s<-.999999?(Xe.cross(r,e,i),Xe.len(r)<1e-6&&Xe.cross(r,t,i),Xe.normalize(r,r),rh(n,r,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Xe.cross(r,i,o),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=1+s,ip(n,n))}}(),Bne=function(){var r=Go(),e=Go();return function(t,n,i,o,s,a){return Rb(r,n,s,a),Rb(e,i,o,a),Rb(t,r,e,2*a*(1-a)),t}}(),zne=function(){var r=eh.Ue();return function(e,t,n,i){return r[0]=n[0],r[3]=n[1],r[6]=n[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=-t[0],r[5]=-t[1],r[8]=-t[2],ip(e,B$(e,r))}}();function j$(r){var e=H$();return function(){var n=(0,li.Z)(r),i;if(e){var o=(0,li.Z)(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return(0,ds.Z)(this,i)}}function H$(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var fD=function(r){(0,us.Z)(t,r);var e=j$(t);function t(n){var i;return(0,Sn.Z)(this,t),i=e.call(this,n),i.dirtyFlag=void 0,i.localDirtyFlag=void 0,i.parent=null,i.localPosition=Xe.fromValues(0,0,0),i.localRotation=Fw(0,0,0,1),i.localScale=Xe.fromValues(1,1,1),i.localTransform=jn.create(),i.position=Xe.fromValues(0,0,0),i.rotation=Fw(0,0,0,1),i.scaling=Xe.fromValues(1,1,1),i.worldTransform=jn.create(),i.matrixTransform=function(){var o=jn.create();return function(s){jn.multiply(o,i.getLocalTransform(),s),jn.getScaling(i.localScale,o),jn.getTranslation(i.localPosition,o),jn.getRotation(i.localRotation,o)}}(),i.rotateRollPitchYaw=function(){var o=Go(),s=Go(),a=Go();return function(l,c,u){i.setDirty(),Gw(o,l,0,0),Gw(s,0,c,0),Gw(a,0,0,u),Sa(i.localRotation,o,i.localRotation),Sa(i.localRotation,i.localRotation,s),Sa(i.localRotation,a,i.localRotation),ip(i.localRotation,i.localRotation)}}(),i.lerp=function(){var o=Xe.create(),s=Go(),a=Xe.create(),l=Xe.create(),c=Go(),u=Xe.create();return function(d,h,f){i.setDirty(),jn.getScaling(o,d.worldTransform),jn.getTranslation(a,d.worldTransform),jn.getRotation(s,d.worldTransform),jn.getScaling(l,h.worldTransform),jn.getTranslation(u,h.worldTransform),jn.getRotation(c,h.worldTransform),Xe.lerp(i.localScale,o,l,f),Rb(i.localRotation,s,c,f),Xe.lerp(i.localPosition,a,u,f)}}(),i.translate=function(){var o=Xe.create();return function(s){return Xe.add(o,i.getPosition(),s),i.setPosition(o),i.setDirty(!0),(0,co.Z)(i)}}(),i.translateLocal=function(){return function(o){return Xe.transformQuat(o,o,i.localRotation),Xe.add(i.localPosition,i.localPosition,o),i.setLocalDirty(!0),(0,co.Z)(i)}}(),i.setPosition=function(){var o=jn.create();return function(s){return i.position=s,i.setLocalDirty(!0),i.parent===null?Xe.copy(i.localPosition,s):(jn.copy(o,i.parent.worldTransform),jn.invert(o,o),Xe.transformMat4(i.localPosition,s,o)),(0,co.Z)(i)}}(),i.rotate=function(){var o=Go();return function(s){if(i.parent===null)Sa(i.localRotation,i.localRotation,s),ip(i.localRotation,i.localRotation);else{var a=i.getRotation(),l=i.parent.getRotation();F0(o,l),hD(o,o),Sa(o,o,s),Sa(i.localRotation,s,a),ip(i.localRotation,i.localRotation)}return i.setLocalDirty(),(0,co.Z)(i)}}(),i.rotateLocal=function(){return function(o){return Sa(i.localRotation,i.localRotation,o),ip(i.localRotation,i.localRotation),i.setLocalDirty(!0),(0,co.Z)(i)}}(),i.setRotation=function(){var o=Go();return function(s){return i.parent===null?F0(i.localRotation,s):(F0(o,i.parent.getRotation()),hD(o,o),F0(i.localRotation,o),z$(i.localRotation,i.localRotation,s)),i.setLocalDirty(!0),(0,co.Z)(i)}}(),i}return(0,Hn.Z)(t,[{key:"setLocalPosition",value:function(i){Xe.copy(this.localPosition,i),this.setLocalDirty(!0)}},{key:"setLocalScale",value:function(i){Xe.copy(this.localScale,i),this.setLocalDirty(!0)}},{key:"setLocalRotation",value:function(i){return F0(this.localRotation,i),this.setLocalDirty(!0),this}},{key:"isDirty",value:function(){return this.dirtyFlag}},{key:"setDirty",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i?this.dirtyFlag|=t.DIRTY:this.dirtyFlag&=~t.DIRTY}},{key:"isLocalDirty",value:function(){return this.localDirtyFlag}},{key:"setLocalDirty",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i?(this.localDirtyFlag|=t.DIRTY,this.setDirty(!0)):this.localDirtyFlag&=~t.DIRTY}},{key:"updateTransform",value:function(){this.isLocalDirty()&&this.getLocalTransform(),this.isDirty()&&this.parent===null&&(jn.copy(this.worldTransform,this.getLocalTransform()),this.setDirty(!1))}},{key:"updateTransformWithParent",value:function(i){jn.multiply(this.worldTransform,i.worldTransform,this.getLocalTransform())}},{key:"applyTransform",value:function(){this.setDirty(),jn.getScaling(this.localScale,this.worldTransform),jn.getTranslation(this.localPosition,this.worldTransform),jn.getRotation(this.localRotation,this.worldTransform)}},{key:"clearTransform",value:function(){this.setDirty(),this.localPosition=Xe.fromValues(0,0,0),this.localRotation=Fw(0,0,0,1),this.localScale=Xe.fromValues(1,1,1)}},{key:"scaleLocal",value:function(i){return this.setLocalDirty(),Xe.multiply(this.localScale,this.localScale,i),this}},{key:"getLocalPosition",value:function(){return this.localPosition}},{key:"getLocalRotation",value:function(){return this.localRotation}},{key:"getLocalScale",value:function(){return this.localScale}},{key:"getLocalTransform",value:function(){return this.localDirtyFlag&&(jn.fromRotationTranslationScale(this.localTransform,this.localRotation,this.localPosition,this.localScale),this.setLocalDirty(!1)),this.localTransform}},{key:"getWorldTransform",value:function(){return!this.isLocalDirty()&&!this.isDirty()?this.worldTransform:(this.parent&&this.parent.getWorldTransform(),this.updateTransform(),this.worldTransform)}},{key:"getPosition",value:function(){return jn.getTranslation(this.position,this.worldTransform),this.position}},{key:"getRotation",value:function(){return jn.getRotation(this.rotation,this.worldTransform),this.rotation}},{key:"getScale",value:function(){return jn.getScaling(this.scaling,this.worldTransform),this.scaling}}]),t}(Jd);fD.DIRTY=1<<0;var $$=w(84879),pD,gD,mD,Bw,vD,yD,W$=(pD=(0,R.b2)(),gD=(0,R.f3)(Ct.RenderEngine),pD(mD=(Bw=(yD=function(){function r(){(0,Sn.Z)(this,r),(0,In.Z)(this,"engine",vD,this),this.resourcePool={}}return(0,Hn.Z)(r,[{key:"getOrCreateResource",value:function(t){if(!this.resourcePool[t.name]){var n=t.descriptor,i=n.width,o=n.height,s=n.usage;this.resourcePool[t.name]=this.engine.createFramebuffer({color:this.engine.createTexture2D({width:i,height:o,wrapS:Fe.CLAMP_TO_EDGE,wrapT:Fe.CLAMP_TO_EDGE,usage:s})})}return this.resourcePool[t.name]}},{key:"clean",value:function(){this.resourcePool={}}}]),r}(),yD),vD=(0,Ln.Z)(Bw.prototype,"engine",[gD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bw))||mD);function Z$(r){var e=X$();return function(){var n=(0,li.Z)(r),i;if(e){var o=(0,li.Z)(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return(0,ds.Z)(this,i)}}function X$(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var Y$=function(r){(0,us.Z)(t,r);var e=Z$(t);function t(n){var i;return(0,Sn.Z)(this,t),i=e.call(this,n),i.name=void 0,i.name=n.name||"",i}return t}(Jd),bD,xD,CD,K$=(bD=(0,R.b2)(),bD(xD=(CD=function(){function r(){(0,Sn.Z)(this,r),this.config=void 0}return(0,Hn.Z)(r,[{key:"get",value:function(){return this.config}},{key:"set",value:function(t){this.config=t}}]),r}(),CD))||xD),wD,ED,SD;(function(r){r.PANSTART="PANSTART",r.PANEND="PANEND",r.PANMOVE="PANMOVE",r.PINCH="PINCH",r.KEYDOWN="KEYDOWN",r.KEYUP="KEYUP",r.HOVER="HOVER"})(SD||(SD={}));var q$=(wD=(0,R.b2)(),wD(ED=function(){function r(){(0,Sn.Z)(this,r)}return(0,Hn.Z)(r,[{key:"listen",value:function(t){}},{key:"on",value:function(t,n){}},{key:"connect",value:function(){}},{key:"disconnect",value:function(){}},{key:"destroy",value:function(){}}]),r}())||ED);function J$(r){var e=0;switch(r){case"vec2":case"ivec2":e=2;break;case"vec3":case"ivec3":e=3;break;case"vec4":case"ivec4":case"mat2":e=4;break;case"mat3":e=9;break;case"mat4":e=16;break;default:}return e}var Q$=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function _D(r){var e={};return r=r.replace(Q$,function(t,n,i){var o=i.split(":"),s=o[0].trim(),a="";switch(o.length>1&&(a=o[1].trim()),n){case"bool":a=a==="true";break;case"float":case"int":a=Number(a);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":a?a=a.replace("[","").replace("]","").split(",").reduce(function(l,c){return l.push(Number(c.trim())),l},[]):a=new Array(J$(n)).fill(0);break;default:}return e[s]=a,"uniform ".concat(n," ").concat(s,`;
`)}),{content:r,uniforms:e}}function eW(r){return r.filter(function(e,t,n){return n.indexOf(e)===t})}var AD,TD,MD;function PD(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function B0(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?PD(Object(t),!0).forEach(function(n){(0,it.Z)(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):PD(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var tW=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;

#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color) {
  bool selected = bool(v_PickingResult.a);

  if (selected) {
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(resultRGB, color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  return filterPickingColor(filterHighlightColor(color));
}
`,nW=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;

#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  // compares only in highlight stage
  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}`,rW=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}`,iW=/precision\s+(high|low|medium)p\s+float/,oW=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,sW=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,aW=(AD=(0,R.b2)(),AD(TD=(MD=function(){function r(){(0,Sn.Z)(this,r),this.moduleCache={},this.rawContentCache={}}return(0,Hn.Z)(r,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("picking",{vs:nW,fs:tW}),this.registerModule("sdf2d",{vs:"",fs:rW})}},{key:"registerModule",value:function(t,n){if(!this.rawContentCache[t]){var i=n.vs,o=i===void 0?"":i,s=n.fs,a=s===void 0?"":s,l=n.uniforms,c=_D(o),u=c.content,d=c.uniforms,h=_D(a),f=h.content,p=h.uniforms;this.rawContentCache[t]={fs:f,uniforms:B0(B0(B0({},d),p),l),vs:u}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(t){var n=this;if(this.moduleCache[t])return this.moduleCache[t];var i=this.rawContentCache[t].vs||"",o=this.rawContentCache[t].fs||"",s=this.processModule(i,[],"vs"),a=s.content,l=s.includeList,c=this.processModule(o,[],"fs"),u=c.content,d=c.includeList,h=u,f=eW(l.concat(d).concat(t)).reduce(function(p,g){return B0(B0({},p),n.rawContentCache[g].uniforms)},{});return iW.test(u)||(h=oW+u),this.moduleCache[t]={fs:h.trim(),uniforms:f,vs:a.trim()},this.moduleCache[t]}},{key:"processModule",value:function(t,n,i){var o=this,s=t.replace(sW,function(a,l){var c=l.split(" "),u=c[0].replace(/"/g,"");if(n.indexOf(u)>-1)return"";var d=o.rawContentCache[u][i];n.push(u);var h=o.processModule(d||"",n,i),f=h.content;return f});return{content:s,includeList:n}}}]),r}(),MD))||TD),Nl=new R.W2,OD=(0,$$.Z)(Nl,!1),Une=function(e){var t=OD.lazyInject(e);return function(n,i,o){t.call(this,n,i),o&&(o.initializer=function(){return n[i]})}},Vne=function(e){var t=OD.lazyMultiInject(e);return function(n,i,o){t.call(this,n,i),o&&(o.initializer=function(){return n[i]})}};Nl.bind(Ct.ShaderModuleService).to(aW).inSingletonScope(),Nl.bind(Ct.NameComponentManager).toConstantValue(new Qd(Y$)),Nl.bind(Ct.HierarchyComponentManager).toConstantValue(new Qd(I$)),Nl.bind(Ct.TransformComponentManager).toConstantValue(new Qd(fD)),Nl.bind(Ct.MeshComponentManager).toConstantValue(new Qd(b$)),Nl.bind(Ct.CullableComponentManager).toConstantValue(new Qd(m$)),Nl.bind(Ct.GeometryComponentManager).toConstantValue(new Qd(l$)),Nl.bind(Ct.MaterialComponentManager).toConstantValue(new Qd(h$));function lW(){var r=new R.W2;return r.parent=Nl,r.bind(Ct.Systems).to(L$).inSingletonScope().whenTargetNamed(Ct.SceneGraphSystem),r.bind(Ct.Systems).to(PH).inSingletonScope().whenTargetNamed(Ct.FrameGraphSystem),r.bind(Ct.Systems).to(_$).inSingletonScope().whenTargetNamed(Ct.MeshSystem),r.bind(Ct.Systems).to(c$).inSingletonScope().whenTargetNamed(Ct.GeometrySystem),r.bind(Ct.Systems).to(f$).inSingletonScope().whenTargetNamed(Ct.MaterialSystem),r.bind(Ct.Systems).to(N$).inSingletonScope().whenTargetNamed(Ct.RendererSystem),r.bind(Ct.ResourcePool).to(W$).inSingletonScope(),r.bind(Ct.ConfigService).to(K$).inSingletonScope(),r.bind(Ct.InteractorService).to(q$).inSingletonScope(),r.bind(Ct.RenderPass).to(tp).inSingletonScope().whenTargetNamed(tp.IDENTIFIER),r.bind(Ct.RenderPass).to(Nb).inSingletonScope().whenTargetNamed(Nb.IDENTIFIER),r.bind(Ct.RenderPass).to(Iw).inSingletonScope().whenTargetNamed(Iw.IDENTIFIER),r.bind(Ct.RenderPassFactory).toFactory(function(e){return function(t){return e.container.getNamed(Ct.RenderPass,t)}}),r}function zw(r){for(var e=new Nw,t=Xe.fromValues(r[0],r[1],r[2]),n=Xe.fromValues(r[0],r[1],r[2]),i=3;i<r.length;){var o=r[i++],s=r[i++],a=r[i++];o<t[0]&&(t[0]=o),s<t[1]&&(t[1]=s),a<t[2]&&(t[2]=a),o>n[0]&&(n[0]=o),s>n[1]&&(n[1]=s),a>n[2]&&(n[2]=a)}return e.setMinMax(t,n),e}var $s=typeof navigator!="undefined"&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),jne=Xe.create(),Hne=null,$ne=Xe.create(),Wne=Xe.create(),Zne=Xe.create(),Xne=Xe.create(),Yne=Xe.create(),Kne=null,qne=w(59518),Jne=w(26199),Qne=w(14156),ere=w(71468),tre=w(48871),nre=w(9871),DD;(function(r){r.Normal="normal",r.PostProcessing="post-processing"})(DD||(DD={}));var rre=w(25612),ire=w(92777),ore=w(20159),sre=w(61622),are=w(20499),lre=w(64851),ih;(function(r){r.Void="Void",r.Boolean="Boolean",r.Float="Float",r.Uint32="Uint32",r.Int32="Int32",r.Vector="Vector",r.Vector2Float="vec2<f32>",r.Vector3Float="vec3<f32>",r.Vector4Float="vec4<f32>",r.Vector2Boolean="vec2<bool>",r.Vector3Boolean="vec3<bool>",r.Vector4Boolean="vec4<bool>",r.Vector2Uint="vec2<u32>",r.Vector3Uint="vec3<u32>",r.Vector4Uint="vec4<u32>",r.Vector2Int="vec2<i32>",r.Vector3Int="vec3<i32>",r.Vector4Int="vec4<i32>",r.Matrix="Matrix",r.Matrix3x3Float="mat3x3<f32>",r.Matrix4x4Float="mat4x4<i32>",r.Struct="Struct",r.FloatArray="Float[]",r.Vector4FloatArray="vec4<f32>[]"})(ih||(ih={}));var ND;(function(r){r.Program="Program",r.Identifier="Identifier",r.VariableDeclaration="VariableDeclaration",r.BlockStatement="BlockStatement",r.ReturnStatement="ReturnStatement",r.FunctionDeclaration="FunctionDeclaration",r.VariableDeclarator="VariableDeclarator",r.AssignmentExpression="AssignmentExpression",r.LogicalExpression="LogicalExpression",r.BinaryExpression="BinaryExpression",r.ArrayExpression="ArrayExpression",r.UnaryExpression="UnaryExpression",r.UpdateExpression="UpdateExpression",r.FunctionExpression="FunctionExpression",r.MemberExpression="MemberExpression",r.ConditionalExpression="ConditionalExpression",r.ExpressionStatement="ExpressionStatement",r.CallExpression="CallExpression",r.NumThreadStatement="NumThreadStatement",r.StorageStatement="StorageStatement",r.DoWhileStatement="DoWhileStatement",r.WhileStatement="WhileStatement",r.ForStatement="ForStatement",r.BreakStatement="BreakStatement",r.ContinueStatement="ContinueStatement",r.IfStatement="IfStatement",r.ImportedFunctionStatement="ImportedFunctionStatement"})(ND||(ND={}));var Su;(function(r){r.Input="Input",r.Output="Output",r.Uniform="Uniform",r.Workgroup="Workgroup",r.UniformConstant="UniformConstant",r.Image="Image",r.StorageBuffer="StorageBuffer",r.Private="Private",r.Function="Function"})(Su||(Su={}));var z0;(function(r){r.GLSL100="GLSL100",r.GLSL450="GLSL450",r.WGSL="WGSL"})(z0||(z0={}));var cW="__DefineValuePlaceholder__";function Uw(r){return typeof r=="number"}function Ec(r){return r===void 0?0:r>360||r<-360?r%360:r}function oh(r,e,t){return Uw(r)?Xe.fromValues(r,e,t):r.length===3?Xe.clone(r):Xe.fromValues(r[0],r[1],r[2])}var RD=function(){function r(e,t){(0,Sn.Z)(this,r),this.name=void 0,this.matrix=void 0,this.right=void 0,this.up=void 0,this.forward=void 0,this.position=void 0,this.focalPoint=void 0,this.distanceVector=void 0,this.distance=void 0,this.dollyingStep=void 0,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.name=e,this.matrix=jn.clone(t.matrix),this.right=Xe.clone(t.right),this.up=Xe.clone(t.up),this.forward=Xe.clone(t.forward),this.position=Xe.clone(t.position),this.focalPoint=Xe.clone(t.focalPoint),this.distanceVector=Xe.clone(t.distanceVector),this.azimuth=t.azimuth,this.elevation=t.elevation,this.roll=t.roll,this.relAzimuth=t.relAzimuth,this.relElevation=t.relElevation,this.relRoll=t.relRoll,this.dollyingStep=t.dollyingStep,this.distance=t.distance}return(0,Hn.Z)(r,[{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getRoll",value:function(){return this.roll}},{key:"retrieve",value:function(t){t.matrix=jn.copy(t.matrix,this.matrix),t.right=Xe.copy(t.right,this.right),t.up=Xe.copy(t.up,this.up),t.forward=Xe.copy(t.forward,this.forward),t.position=Xe.copy(t.position,this.position),t.focalPoint=Xe.copy(t.focalPoint,this.focalPoint),t.distanceVector=Xe.copy(t.distanceVector,this.distanceVector),t.azimuth=this.azimuth,t.elevation=this.elevation,t.roll=this.roll,t.relAzimuth=this.relAzimuth,t.relElevation=this.relElevation,t.relRoll=this.relRoll,t.dollyingStep=this.dollyingStep,t.distance=this.distance}}]),r}(),kD,ID,LD,Vw,GD,FD,BD,mi;(function(r){r.ORBITING="ORBITING",r.EXPLORING="EXPLORING",r.TRACKING="TRACKING"})(mi||(mi={}));var kb;(function(r){r.DEFAULT="DEFAULT",r.ROTATIONAL="ROTATIONAL",r.TRANSLATIONAL="TRANSLATIONAL",r.CINEMATIC="CINEMATIC"})(kb||(kb={}));var sh;(function(r){r.ORTHOGRAPHIC="ORTHOGRAPHIC",r.PERSPECTIVE="PERSPECTIVE"})(sh||(sh={}));var Sc=Math.PI/180,_u=180/Math.PI,zD=(kD=(0,R.b2)(),ID=(0,R.f3)(Ct.InteractorService),kD(LD=(Vw=(BD=FD=function(){function r(){(0,Sn.Z)(this,r),this.matrix=jn.create(),this.right=Xe.fromValues(1,0,0),this.up=Xe.fromValues(0,1,0),this.forward=Xe.fromValues(0,0,1),this.position=Xe.fromValues(0,0,1),this.focalPoint=Xe.fromValues(0,0,0),this.distanceVector=Xe.fromValues(0,0,0),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=Infinity,this.minDistance=-Infinity,this.rotateWorld=!1,(0,In.Z)(this,"interactor",GD,this),this.fov=30,this.near=.1,this.far=1e4,this.aspect=1,this.left=void 0,this.rright=void 0,this.top=void 0,this.bottom=void 0,this.zoom=1,this.perspective=jn.create(),this.view=void 0,this.following=void 0,this.type=mi.EXPLORING,this.trackingMode=kb.DEFAULT,this.projectionMode=sh.PERSPECTIVE,this.frustum=new C$,this.landmarks=[],this.landmarkAnimationID=void 0}return(0,Hn.Z)(r,[{key:"clone",value:function(){var t=new r;return t.setType(this.type,void 0),t.interactor=this.interactor,t}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.perspective}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"setType",value:function(t,n){return this.type=t,this.type===mi.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===mi.TRACKING&&n!==void 0&&this.setTrackingMode(n),this}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this}},{key:"setTrackingMode",value:function(t){if(this.type!==mi.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this}},{key:"setWorldRotation",value:function(t){this.rotateWorld=t,this._getAngles()}},{key:"getViewTransform",value:function(){return jn.invert(jn.create(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this}},{key:"setViewOffset",value:function(t,n,i,o,s,a){return this.aspect=t/n,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=o,this.view.width=s,this.view.height=a,this.projectionMode===sh.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===sh.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setPerspective",value:function(t,n,i,o){return this.projectionMode=sh.PERSPECTIVE,this.fov=i,this.near=t,this.far=n,this.aspect=o,jn.perspective(this.perspective,this.fov*Sc,this.aspect,this.near,this.far),this}},{key:"setOrthographic",value:function(t,n,i,o,s,a){this.projectionMode=sh.ORTHOGRAPHIC,this.rright=n,this.left=t,this.top=i,this.bottom=o,this.near=s,this.far=a;var l=(this.rright-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,d=(this.top+this.bottom)/2,h=u-l,f=u+l,p=d+c,g=d-c;if(this.view!==void 0&&this.view.enabled){var v=(this.rright-this.left)/this.view.fullWidth/this.zoom,y=(this.top-this.bottom)/this.view.fullHeight/this.zoom;h+=v*this.view.offsetX,f=h+v*this.view.width,p-=y*this.view.offsetY,g=p-y*this.view.height}return jn.ortho(this.perspective,h,f,p,g,s,a),this}},{key:"setPosition",value:function(t,n,i){return this._setPosition(t,n,i),this.setFocalPoint(this.focalPoint),this}},{key:"setFocalPoint",value:function(t,n,i){var o=Xe.fromValues(0,1,0);if(this.focalPoint=oh(t,n,i),this.trackingMode===kb.CINEMATIC){var s=Xe.subtract(Xe.create(),this.focalPoint,this.position);t=s[0],n=s[1],i=s[2];var a=Xe.length(s),l=Math.asin(n/a)*_u,c=90+Math.atan2(i,t)*_u,u=jn.create();jn.rotateY(u,u,c*Sc),jn.rotateX(u,u,l*Sc),o=Xe.transformMat4(Xe.create(),[0,1,0],u)}return jn.invert(this.matrix,jn.lookAt(jn.create(),this.position,this.focalPoint,o)),this._getAxes(),this._getDistance(),this._getAngles(),this}},{key:"setDistance",value:function(t){if(!(this.distance===t||t<0)){this.distance=t,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var n=Xe.create();t=this.distance;var i=this.forward,o=this.focalPoint;return n[0]=t*i[0]+o[0],n[1]=t*i[1]+o[1],n[2]=t*i[2]+o[2],this._setPosition(n),this}}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this}},{key:"changeAzimuth",value:function(t){return this.setAzimuth(this.azimuth+t),this}},{key:"changeElevation",value:function(t){return this.setElevation(this.elevation+t),this}},{key:"changeRoll",value:function(t){return this.setRoll(this.roll+t),this}},{key:"setAzimuth",value:function(t){return this.azimuth=Ec(t),this.computeMatrix(),this._getAxes(),this.type===mi.ORBITING||this.type===mi.EXPLORING?this._getPosition():this.type===mi.TRACKING&&this._getFocalPoint(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(t){return this.elevation=Ec(t),this.computeMatrix(),this._getAxes(),this.type===mi.ORBITING||this.type===mi.EXPLORING?this._getPosition():this.type===mi.TRACKING&&this._getFocalPoint(),this}},{key:"setRoll",value:function(t){return this.roll=Ec(t),this.computeMatrix(),this._getAxes(),this.type===mi.ORBITING||this.type===mi.EXPLORING?this._getPosition():this.type===mi.TRACKING&&this._getFocalPoint(),this}},{key:"rotate",value:function(t,n,i){if(this.type===mi.EXPLORING){t=Ec(t),n=Ec(n),i=Ec(i);var o=rh(Go(),[1,0,0],(this.rotateWorld?1:-1)*n*Sc),s=rh(Go(),[0,1,0],(this.rotateWorld?1:-1)*t*Sc),a=rh(Go(),[0,0,1],i*Sc),l=Sa(Go(),s,o);l=Sa(Go(),l,a);var c=jn.fromQuat(jn.create(),l);jn.translate(this.matrix,this.matrix,[0,0,-this.distance]),jn.multiply(this.matrix,this.matrix,c),jn.translate(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation+n)>90)return;this.relElevation=Ec(n),this.relAzimuth=Ec(t),this.relRoll=Ec(i),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.computeMatrix()}return this._getAxes(),this.type===mi.ORBITING||this.type===mi.EXPLORING?this._getPosition():this.type===mi.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(t,n){var i=oh(t,n,0),o=Xe.clone(this.position);return Xe.add(o,o,Xe.scale(Xe.create(),this.right,i[0])),Xe.add(o,o,Xe.scale(Xe.create(),this.up,i[1])),this._setPosition(o),this}},{key:"dolly",value:function(t){var n=this.forward,i=Xe.clone(this.position),o=t*this.dollyingStep,s=this.distance+t*this.dollyingStep;return o=Math.max(Math.min(s,this.maxDistance),this.minDistance)-this.distance,i[0]+=o*n[0],i[1]+=o*n[1],i[2]+=o*n[2],this._setPosition(i),this.type===mi.ORBITING||this.type===mi.EXPLORING?this._getDistance():this.type===mi.TRACKING&&Xe.add(this.focalPoint,i,this.distanceVector),this}},{key:"createLandmark",value:function(t,n){var i=this.clone();i.setPosition(n.position),i.setFocalPoint(n.focalPoint),n.roll!==void 0&&i.setRoll(n.roll);var o=new RD(t,i);return this.landmarks.push(o),o}},{key:"setLandmark",value:function(t){var n=new RD(t,this);return this.landmarks.push(n),this}},{key:"gotoLandmark",value:function(t){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3,o=this.landmarks.find(function(d){return d.name===t});if(o){if(i===0){o.retrieve(this);return}this.landmarkAnimationID!==void 0&&window.cancelAnimationFrame(this.landmarkAnimationID),this.interactor.disconnect();var s=o.getPosition(),a=o.getFocalPoint(),l=o.getRoll(),c,u=function d(h){c===void 0&&(c=h);var f=h-c,p=(1-Math.cos(f/i*Math.PI))/2,g=Xe.create(),v=Xe.create(),y=0;Xe.lerp(g,n.focalPoint,a,p),Xe.lerp(v,n.position,s,p),y=n.roll*(1-p)+l*p,n.setFocalPoint(g),n.setPosition(v),n.setRoll(y),n.computeMatrix();var x=Xe.dist(g,a)+Xe.dist(v,s);if(!(x>.01)){n.setFocalPoint(g),n.setPosition(v),n.setRoll(y),n.computeMatrix(),n.interactor.connect();return}f<i&&(n.landmarkAnimationID=window.requestAnimationFrame(d))};window.requestAnimationFrame(u)}}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles()}},{key:"computeMatrix",value:function(){var t,n,i=rh(Go(),[0,0,1],this.roll*Sc);jn.identity(this.matrix),t=rh(Go(),[1,0,0],(this.rotateWorld&&this.type!==mi.TRACKING||this.type===mi.TRACKING?1:-1)*this.elevation*Sc),n=rh(Go(),[0,1,0],(this.rotateWorld&&this.type!==mi.TRACKING||this.type===mi.TRACKING?1:-1)*this.azimuth*Sc);var o=Sa(Go(),n,t);o=Sa(Go(),o,i);var s=jn.fromQuat(jn.create(),o);this.type===mi.ORBITING||this.type===mi.EXPLORING?(jn.translate(this.matrix,this.matrix,this.focalPoint),jn.multiply(this.matrix,this.matrix,s),jn.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===mi.TRACKING&&(jn.translate(this.matrix,this.matrix,this.position),jn.multiply(this.matrix,this.matrix,s))}},{key:"_setPosition",value:function(t,n,i){this.position=oh(t,n,i);var o=this.matrix;o[12]=this.position[0],o[13]=this.position[1],o[14]=this.position[2],o[15]=1}},{key:"_getAxes",value:function(){Xe.copy(this.right,oh(ro.fF(ro.Ue(),[1,0,0,0],this.matrix))),Xe.copy(this.up,oh(ro.fF(ro.Ue(),[0,1,0,0],this.matrix))),Xe.copy(this.forward,oh(ro.fF(ro.Ue(),[0,0,1,0],this.matrix))),Xe.normalize(this.right,this.right),Xe.normalize(this.up,this.up),Xe.normalize(this.forward,this.forward)}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],n=this.distanceVector[1],i=this.distanceVector[2],o=Xe.length(this.distanceVector);if(o===0){this.elevation=0,this.azimuth=0;return}this.type===mi.TRACKING?(this.elevation=Math.asin(n/o)*_u,this.azimuth=Math.atan2(-t,-i)*_u):this.rotateWorld?(this.elevation=Math.asin(n/o)*_u,this.azimuth=Math.atan2(-t,-i)*_u):(this.elevation=-Math.asin(n/o)*_u,this.azimuth=-Math.atan2(-t,-i)*_u)}},{key:"_getPosition",value:function(){Xe.copy(this.position,oh(ro.fF(ro.Ue(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){Xe.transformMat3(this.distanceVector,[0,0,-this.distance],eh.xO(eh.Ue(),this.matrix)),Xe.add(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=Xe.subtract(Xe.create(),this.focalPoint,this.position),this.distance=Xe.length(this.distanceVector),this.dollyingStep=this.distance/100}}]),r}(),FD.ProjectionMode={ORTHOGRAPHIC:"ORTHOGRAPHIC",PERSPECTIVE:"PERSPECTIVE"},BD),GD=(0,Ln.Z)(Vw.prototype,"interactor",[ID],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vw))||LD),UD,VD,jD,jw,HD,U0,$D,Au=(UD=(0,R.b2)(),VD=(0,R.f3)(Ct.GeometryComponentManager),UD(jD=(jw=($D=U0=function(){function r(){(0,Sn.Z)(this,r),this.config=void 0,(0,In.Z)(this,"geometry",HD,this),this.entity=void 0,this.component=void 0}return(0,Hn.Z)(r,[{key:"getEntity",value:function(){return this.entity}},{key:"getComponent",value:function(){return this.component}},{key:"setConfig",value:function(t){this.config=t}},{key:"setEntity",value:function(t){this.entity=t,this.component=this.geometry.create(t),this.component.entity=t,this.onEntityCreated()}},{key:"onEntityCreated",value:function(){}}]),r}(),U0.BOX="box",U0.SPHERE="sphere",U0.PLANE="plane",U0.MERGED="merged",$D),HD=(0,Ln.Z)(jw.prototype,"geometry",[VD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jw))||jD),qt=w(49469);function WD(){if(typeof document!="undefined")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}var uW={}.toString,dW=function(e,t){return uW.call(e)==="[object "+t+"]"},hW=dW,fW=function(r){return Array.isArray?Array.isArray(r):hW(r,"Array")},pW=9007199254740991,gW="[object Arguments]",mW="[object Array]",vW="[object Boolean]",yW="[object Date]",bW="[object Error]",xW="[object Function]",CW="[object Map]",wW="[object Number]",EW="[object Object]",SW="[object RegExp]",_W="[object Set]",AW="[object String]",TW="[object WeakMap]",MW="[object ArrayBuffer]",PW="[object DataView]",OW="[object Float32Array]",DW="[object Float64Array]",NW="[object Int8Array]",RW="[object Int16Array]",kW="[object Int32Array]",IW="[object Uint8Array]",LW="[object Uint8ClampedArray]",GW="[object Uint16Array]",FW="[object Uint32Array]",Gi={};Gi[OW]=Gi[DW]=Gi[NW]=Gi[RW]=Gi[kW]=Gi[IW]=Gi[LW]=Gi[GW]=Gi[FW]=!0,Gi[gW]=Gi[mW]=Gi[MW]=Gi[vW]=Gi[PW]=Gi[yW]=Gi[bW]=Gi[xW]=Gi[CW]=Gi[wW]=Gi[EW]=Gi[SW]=Gi[_W]=Gi[AW]=Gi[TW]=!1;function cre(r){return function(e){return r(e)}}var BW=Object.prototype,zW=BW.toString;function UW(r){return jW(r)&&VW(r.length)&&!!Gi[zW.call(r)]}function VW(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=pW}function jW(r){return!!r&&(0,th.Z)(r)==="object"}var ZD=UW,XD,YD,KD,qD,Ib,JD,QD,e3;function t3(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function n3(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?t3(Object(t),!0).forEach(function(n){(0,it.Z)(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):t3(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var r3=(XD=(0,R.b2)(),YD=(0,R.f3)(Ct.RenderEngine),KD=(0,R.f3)(Ct.ConfigService),XD(qD=(Ib=(e3=function(){function r(){(0,Sn.Z)(this,r),(0,In.Z)(this,"engine",JD,this),(0,In.Z)(this,"configService",QD,this),this.entity=Dl(),this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}return(0,Hn.Z)(r,[{key:"init",value:function(){var t=this.configService.get(),n=t.canvas,i=t.engineOptions;this.initPromise=this.engine.init(n3({canvas:n||WD(),swapChainFormat:qt.EV.BGRA8Unorm,antialiasing:!1},i))}},{key:"setBundle",value:function(t){this.compiledBundle=JSON.parse(JSON.stringify(t))}},{key:"setDispatch",value:function(t){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=t),this}},{key:"setMaxIteration",value:function(t){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=t),this}},{key:"setBinding",value:function(t,n){var i=this;if(typeof t=="string"){var o=Uw(n)||ZD(n)||fW(n);if(this.compiledBundle&&this.compiledBundle.context){var s=this.compiledBundle.context.defines.find(function(l){return l.name===t});if(s)return s.value=n,this;var a=this.compiledBundle.context.uniforms.find(function(l){return l.name===t});a&&(o?(a.data=n,a.isReferer=!1,a.storageClass===Su.Uniform?this.model&&this.model.updateUniform(t,n):this.model&&this.model.updateBuffer(t,n)):(a.isReferer=!0,a.data=n))}}else Object.keys(t).forEach(function(l){i.setBinding(l,t[l])});return this}},{key:"execute",value:function(){var e=(0,Yr.Z)(yn().mark(function n(){var i=this,o,s,a=arguments;return yn().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(o=a.length>0&&a[0]!==void 0?a[0]:1,!this.dirty){c.next=6;break}return this.compiledBundle.context&&(o>1?this.compiledBundle.context.maxIteration=o:this.compiledBundle.context.maxIteration++),c.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter(function(u){var d=u.isReferer;return d}).forEach(function(u){var d=u.data,h=u.name;i.model.confirmInput(d.model,h)}),s=0;s<o;s++)this.model.run();return this.engine.endFrame(),c.abrupt("return",this);case 12:case"end":return c.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getOutput",value:function(){var e=(0,Yr.Z)(yn().mark(function n(){return yn().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.model.readData());case 1:case"end":return o.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"compile",value:function(){var e=(0,Yr.Z)(yn().mark(function n(){var i,o,s;return yn().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.initPromise;case 2:return i=n3({},this.compiledBundle.context),o=this.engine.supportWebGPU?this.engine.useWGSL?z0.WGSL:z0.GLSL450:z0.GLSL100,s=this.compiledBundle.shaders[o],i.defines.filter(function(c){return c.runtime}).forEach(function(c){var u="".concat(cW).concat(c.name);s=s.replace(u,"".concat(c.value))}),i.shader=s,i.uniforms.forEach(function(c){if(!c.data&&c.storageClass===Su.StorageBuffer){var u=1;c.type===ih.FloatArray?u=1:c.type===ih.Vector4FloatArray&&(u=4),c.data=new Float32Array(i.output.length*u).fill(0)}}),this.compiledBundle.context=i,l.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=l.sent;case 12:case"end":return l.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()}]),r}(),e3),JD=(0,Ln.Z)(Ib.prototype,"engine",[YD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QD=(0,Ln.Z)(Ib.prototype,"configService",[KD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ib))||qD),i3,o3,s3,Hw,a3,l3,c3,u3=(i3=(0,R.b2)(),o3=(0,R.f3)(Ct.MaterialComponentManager),i3(s3=(Hw=(c3=l3=function(){function r(){(0,Sn.Z)(this,r),this.config=void 0,(0,In.Z)(this,"material",a3,this),this.entity=void 0,this.component=void 0}return(0,Hn.Z)(r,[{key:"getEntity",value:function(){return this.entity}},{key:"getComponent",value:function(){return this.component}},{key:"setConfig",value:function(t){this.config=t}},{key:"setEntity",value:function(t,n){this.entity=t,this.component=this.material.create(t),this.component.entity=t,this.component.type=n,this.onEntityCreated()}},{key:"onEntityCreated",value:function(){}}]),r}(),l3.BASIC="basic",c3),a3=(0,Ln.Z)(Hw.prototype,"material",[o3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hw))||s3),d3,h3,f3,p3,g3,m3,v3,op,y3,b3,x3,C3,Lb,w3,Tu=(d3=(0,R.b2)(),h3=(0,R.f3)(Ct.MeshComponentManager),f3=(0,R.f3)(Ct.CullableComponentManager),p3=(0,R.f3)(Ct.TransformComponentManager),g3=(0,R.f3)(Ct.Systems),m3=(0,R.t6)(Ct.SceneGraphSystem),d3(v3=(op=(w3=Lb=function(){function r(){(0,Sn.Z)(this,r),this.attributes={},this.config=void 0,(0,In.Z)(this,"mesh",y3,this),(0,In.Z)(this,"cullable",b3,this),(0,In.Z)(this,"transform",x3,this),(0,In.Z)(this,"sceneGraphSystem",C3,this),this.meshComponent=void 0,this.transformComponent=void 0,this.entity=void 0}return(0,Hn.Z)(r,[{key:"getEntity",value:function(){return this.entity}},{key:"getTransformComponent",value:function(){return this.transformComponent}},{key:"getMeshComponent",value:function(){return this.meshComponent}},{key:"setConfig",value:function(t){this.config=t}},{key:"setEntity",value:function(t){this.entity=t,this.cullable.create(t),this.meshComponent=this.mesh.create(t),this.transformComponent=this.transform.create(t),this.onEntityCreated()}},{key:"setMaterial",value:function(t){return this.meshComponent.material=t,this}},{key:"setGeometry",value:function(t){return this.meshComponent.geometry=t,this}},{key:"setAttributes",value:function(t){var n=this;Object.keys(t).forEach(function(i){t[i]!==void 0&&t[i]!==n.attributes[i]&&(n.onAttributeChanged({name:i,data:t[i]}),n.attributes[i]=t[i])})}},{key:"setVisible",value:function(t){var n=this;return this.meshComponent.visible=t,this.meshComponent.children.forEach(function(i){var o=n.mesh.getComponentByEntity(i);o&&(o.visible=t)}),this}},{key:"isVisible",value:function(){return this.meshComponent.visible}},{key:"attach",value:function(t){return this.sceneGraphSystem.attach(this.entity,t.entity),this}},{key:"detach",value:function(){return this.sceneGraphSystem.detach(this.entity),this}},{key:"detachChildren",value:function(){return this.sceneGraphSystem.detachChildren(this.entity),this}},{key:"onEntityCreated",value:function(){}},{key:"onAttributeChanged",value:function(t){var n=t.name,i=t.data;this.meshComponent&&this.meshComponent.material&&this.meshComponent.material.setUniform(this.convertAttributeName2UniformName(n),i)}},{key:"convertAttributeName2UniformName",value:function(t){return t}}]),r}(),Lb.POINT="point",Lb.LINE="line",Lb.GRID="grid",w3),y3=(0,Ln.Z)(op.prototype,"mesh",[h3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b3=(0,Ln.Z)(op.prototype,"cullable",[f3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x3=(0,Ln.Z)(op.prototype,"transform",[p3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C3=(0,Ln.Z)(op.prototype,"sceneGraphSystem",[g3,m3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),op))||v3),HW=w(81550),$W=w.n(HW),WW=function(){function r(e,t){(0,Sn.Z)(this,r),this.attribute=void 0,this.buffer=void 0;var n=t.buffer,i=t.offset,o=t.stride,s=t.normalized,a=t.size,l=t.divisor;this.buffer=n,this.attribute={buffer:n.get(),offset:i||0,stride:o||0,normalized:s||!1,divisor:l||0},a&&(this.attribute.size=a)}return(0,Hn.Z)(r,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),r}(),_c,V0,Ac,_a,j0,Mu,H0,Gb,Rl,ah,ss,kl,Il,Fb,ZW=(_c={},(0,it.Z)(_c,Fe.POINTS,"points"),(0,it.Z)(_c,Fe.LINES,"lines"),(0,it.Z)(_c,Fe.LINE_LOOP,"line loop"),(0,it.Z)(_c,Fe.LINE_STRIP,"line strip"),(0,it.Z)(_c,Fe.TRIANGLES,"triangles"),(0,it.Z)(_c,Fe.TRIANGLE_FAN,"triangle fan"),(0,it.Z)(_c,Fe.TRIANGLE_STRIP,"triangle strip"),_c),E3=(V0={},(0,it.Z)(V0,Fe.STATIC_DRAW,"static"),(0,it.Z)(V0,Fe.DYNAMIC_DRAW,"dynamic"),(0,it.Z)(V0,Fe.STREAM_DRAW,"stream"),V0),$w=(Ac={},(0,it.Z)(Ac,Fe.BYTE,"int8"),(0,it.Z)(Ac,Fe.UNSIGNED_INT,"int16"),(0,it.Z)(Ac,Fe.INT,"int32"),(0,it.Z)(Ac,Fe.UNSIGNED_BYTE,"uint8"),(0,it.Z)(Ac,Fe.UNSIGNED_SHORT,"uint16"),(0,it.Z)(Ac,Fe.UNSIGNED_INT,"uint32"),(0,it.Z)(Ac,Fe.FLOAT,"float"),Ac),XW=(_a={},(0,it.Z)(_a,Fe.ALPHA,"alpha"),(0,it.Z)(_a,Fe.LUMINANCE,"luminance"),(0,it.Z)(_a,Fe.LUMINANCE_ALPHA,"luminance alpha"),(0,it.Z)(_a,Fe.RGB,"rgb"),(0,it.Z)(_a,Fe.RGBA,"rgba"),(0,it.Z)(_a,Fe.RGBA4,"rgba4"),(0,it.Z)(_a,Fe.RGB5_A1,"rgb5 a1"),(0,it.Z)(_a,Fe.RGB565,"rgb565"),(0,it.Z)(_a,Fe.DEPTH_COMPONENT,"depth"),(0,it.Z)(_a,Fe.DEPTH_STENCIL,"depth stencil"),_a),YW=(j0={},(0,it.Z)(j0,Fe.DONT_CARE,"dont care"),(0,it.Z)(j0,Fe.NICEST,"nice"),(0,it.Z)(j0,Fe.FASTEST,"fast"),j0),S3=(Mu={},(0,it.Z)(Mu,Fe.NEAREST,"nearest"),(0,it.Z)(Mu,Fe.LINEAR,"linear"),(0,it.Z)(Mu,Fe.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,it.Z)(Mu,Fe.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,it.Z)(Mu,Fe.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,it.Z)(Mu,Fe.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Mu),_3=(H0={},(0,it.Z)(H0,Fe.REPEAT,"repeat"),(0,it.Z)(H0,Fe.CLAMP_TO_EDGE,"clamp"),(0,it.Z)(H0,Fe.MIRRORED_REPEAT,"mirror"),H0),KW=(Gb={},(0,it.Z)(Gb,Fe.NONE,"none"),(0,it.Z)(Gb,Fe.BROWSER_DEFAULT_WEBGL,"browser"),Gb),qW=(Rl={},(0,it.Z)(Rl,Fe.NEVER,"never"),(0,it.Z)(Rl,Fe.ALWAYS,"always"),(0,it.Z)(Rl,Fe.LESS,"less"),(0,it.Z)(Rl,Fe.LEQUAL,"lequal"),(0,it.Z)(Rl,Fe.GREATER,"greater"),(0,it.Z)(Rl,Fe.GEQUAL,"gequal"),(0,it.Z)(Rl,Fe.EQUAL,"equal"),(0,it.Z)(Rl,Fe.NOTEQUAL,"notequal"),Rl),A3=(ah={},(0,it.Z)(ah,Fe.FUNC_ADD,"add"),(0,it.Z)(ah,Fe.MIN_EXT,"min"),(0,it.Z)(ah,Fe.MAX_EXT,"max"),(0,it.Z)(ah,Fe.FUNC_SUBTRACT,"subtract"),(0,it.Z)(ah,Fe.FUNC_REVERSE_SUBTRACT,"reverse subtract"),ah),Bb=(ss={},(0,it.Z)(ss,Fe.ZERO,"zero"),(0,it.Z)(ss,Fe.ONE,"one"),(0,it.Z)(ss,Fe.SRC_COLOR,"src color"),(0,it.Z)(ss,Fe.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,it.Z)(ss,Fe.SRC_ALPHA,"src alpha"),(0,it.Z)(ss,Fe.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,it.Z)(ss,Fe.DST_COLOR,"dst color"),(0,it.Z)(ss,Fe.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,it.Z)(ss,Fe.DST_ALPHA,"dst alpha"),(0,it.Z)(ss,Fe.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,it.Z)(ss,Fe.CONSTANT_COLOR,"constant color"),(0,it.Z)(ss,Fe.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,it.Z)(ss,Fe.CONSTANT_ALPHA,"constant alpha"),(0,it.Z)(ss,Fe.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,it.Z)(ss,Fe.SRC_ALPHA_SATURATE,"src alpha saturate"),ss),JW=(kl={},(0,it.Z)(kl,Fe.NEVER,"never"),(0,it.Z)(kl,Fe.ALWAYS,"always"),(0,it.Z)(kl,Fe.LESS,"less"),(0,it.Z)(kl,Fe.LEQUAL,"lequal"),(0,it.Z)(kl,Fe.GREATER,"greater"),(0,it.Z)(kl,Fe.GEQUAL,"gequal"),(0,it.Z)(kl,Fe.EQUAL,"equal"),(0,it.Z)(kl,Fe.NOTEQUAL,"notequal"),kl),sp=(Il={},(0,it.Z)(Il,Fe.ZERO,"zero"),(0,it.Z)(Il,Fe.KEEP,"keep"),(0,it.Z)(Il,Fe.REPLACE,"replace"),(0,it.Z)(Il,Fe.INVERT,"invert"),(0,it.Z)(Il,Fe.INCR,"increment"),(0,it.Z)(Il,Fe.DECR,"decrement"),(0,it.Z)(Il,Fe.INCR_WRAP,"increment wrap"),(0,it.Z)(Il,Fe.DECR_WRAP,"decrement wrap"),Il),QW=(Fb={},(0,it.Z)(Fb,Fe.FRONT,"front"),(0,it.Z)(Fb,Fe.BACK,"back"),Fb),eZ=function(){function r(e,t){(0,Sn.Z)(this,r),this.buffer=void 0;var n=t.data,i=t.usage,o=t.type;this.buffer=e.buffer({data:n,usage:E3[i||Fe.STATIC_DRAW],type:$w[o||Fe.UNSIGNED_BYTE]})}return(0,Hn.Z)(r,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(t){var n=t.data,i=t.offset;this.buffer.subdata(n,i)}}]),r}(),wo=w(85061),tZ=9007199254740991,nZ="[object Arguments]",rZ="[object Array]",iZ="[object Boolean]",oZ="[object Date]",sZ="[object Error]",aZ="[object Function]",lZ="[object Map]",cZ="[object Number]",uZ="[object Object]",dZ="[object RegExp]",hZ="[object Set]",fZ="[object String]",pZ="[object WeakMap]",gZ="[object ArrayBuffer]",mZ="[object DataView]",vZ="[object Float32Array]",yZ="[object Float64Array]",bZ="[object Int8Array]",xZ="[object Int16Array]",CZ="[object Int32Array]",wZ="[object Uint8Array]",EZ="[object Uint8ClampedArray]",SZ="[object Uint16Array]",_Z="[object Uint32Array]",Fi={};Fi[vZ]=Fi[yZ]=Fi[bZ]=Fi[xZ]=Fi[CZ]=Fi[wZ]=Fi[EZ]=Fi[SZ]=Fi[_Z]=!0,Fi[nZ]=Fi[rZ]=Fi[gZ]=Fi[iZ]=Fi[mZ]=Fi[oZ]=Fi[sZ]=Fi[aZ]=Fi[lZ]=Fi[cZ]=Fi[uZ]=Fi[dZ]=Fi[hZ]=Fi[fZ]=Fi[pZ]=!1;function ure(r){return function(e){return r(e)}}var AZ=Object.prototype,TZ=AZ.toString;function MZ(r){return OZ(r)&&PZ(r.length)&&!!Fi[TZ.call(r)]}function PZ(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=tZ}function OZ(r){return!!r&&(0,th.Z)(r)==="object"}var Ww=MZ;function T3(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function M3(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?T3(Object(t),!0).forEach(function(n){(0,it.Z)(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):T3(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var DZ=`attribute vec3 a_Position;
attribute vec2 a_TexCoord;

varying vec2 v_TexCoord;

void main() {
  gl_Position = vec4(a_Position, 1.0);
  v_TexCoord = a_TexCoord;
}`,P3=0,zb=!1,NZ=function(){function r(e,t){var n=this;(0,Sn.Z)(this,r),this.reGl=e,this.context=t,this.entity=Dl(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var i={};this.context.uniforms.forEach(function(c){var u=c.name,d=c.type,h=c.data,f=c.isReferer,p=c.storageClass;if(p===Su.StorageBuffer){if(f)n.textureCache[u]={data:void 0},i["".concat(u,"Size")]=function(){return h.compiledBundle.context.output.textureSize};else{n.textureCache[u]=n.calcDataTexture(u,d,h);var g=n.textureCache[u],v=g.textureWidth,y=g.isOutput;i["".concat(u,"Size")]=[v,v],y&&(n.outputTextureName=u,n.context.needPingpong&&(n.outputTextureName="".concat(u,"Output"),n.textureCache[n.outputTextureName]=n.calcDataTexture(u,d,h)))}i[u]=function(){return zb&&console.log("[".concat(n.entity,"]: ").concat(u," ").concat(n.textureCache[u].id)),n.textureCache[u].texture}}else if(p===Su.Uniform){if(h&&(Array.isArray(h)||Ww(h))&&h.length>16)throw new Error("invalid data type ".concat(d));i[u]=function(){return c.data}}});var o=this.getOuputDataTexture(),s=o.textureWidth,a=o.texelCount;i.u_OutputTextureSize=[s,s],i.u_OutputTexelCount=a,this.context.output.textureSize=[s,s];var l={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(this.context.shader),uniforms:i,vert:DZ,primitive:"triangle strip",count:4};this.computeCommand=this.reGl(l)}return(0,Hn.Z)(r,[{key:"run",value:function(){var t=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use(function(){t.computeCommand()}),zb&&console.log("[".concat(this.entity,"]: output ").concat(this.getOuputDataTexture().id))}},{key:"readData",value:function(){var e=(0,Yr.Z)(yn().mark(function n(){var i=this,o,s,a,l,c,u,d,h;return yn().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(this.reGl({framebuffer:this.texFBO})(function(){o=i.reGl.read()}),!o){p.next=6;break}if(s=this.getOuputDataTexture(),a=s.originalDataLength,l=s.elementsPerTexel,c=s.typedArrayConstructor,u=c===void 0?Float32Array:c,d=[],l!==4)for(h=0;h<o.length;h+=4)l===1?d.push(o[h]):l===2?d.push(o[h],o[h+1]):d.push(o[h],o[h+1],o[h+2]);else d=o;return p.abrupt("return",new u(d.slice(0,a)));case 6:return p.abrupt("return",new Float32Array);case 7:case"end":return p.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"confirmInput",value:function(t,n){var i;this.entity===t.entity?(this.dynamicPingpong=!0,i=this):i=t,this.textureCache[n].id=i.getOuputDataTexture().id,this.textureCache[n].texture=i.getOuputDataTexture().texture,zb&&console.log("[".concat(this.entity,"]: confirm input ").concat(n," from model ").concat(i.entity,", ").concat(i.getOuputDataTexture().id))}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=this.context.uniforms.find(function(c){var u=c.name;return u===t});if(o){var s=this.calcDataTexture(t,o.type,n),a=s.texture,l=s.data;this.textureCache[t].data=l,this.textureCache[t].texture=a}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var t=this.context.output.name;this.textureCache[t].id=this.getOuputDataTexture().id,this.textureCache[t].texture=this.getOuputDataTexture().texture}var n=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=n,zb&&console.log("[".concat(this.entity,"]: after swap, output ").concat(this.getOuputDataTexture().id))}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var t=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=t}},{key:"cloneDataTexture",value:function(t){var n=t.data,i=t.textureWidth;return M3(M3({},t),{},{id:P3++,texture:this.reGl.texture({width:i,height:i,data:n,type:"float"})})}},{key:"calcDataTexture",value:function(t,n,i){var o=1;n===ih.Vector4FloatArray&&(o=4);for(var s=[],a=0;a<i.length;a+=o)o===1?s.push(i[a],0,0,0):o===2?s.push(i[a],i[a+1],0,0):o===3?s.push(i[a],i[a+1],i[a+2],0):o===4&&s.push(i[a],i[a+1],i[a+2],i[a+3]);var l=i.length,c=Math.ceil(l/o),u=Math.ceil(Math.sqrt(c)),d=u*u;c<d&&s.push.apply(s,(0,wo.Z)(new Array((d-c)*4).fill(0)));var h=this.reGl.texture({width:u,height:u,data:s,type:"float"});return{id:P3++,data:s,originalDataLength:l,typedArrayConstructor:Ww(i)?i.constructor:void 0,textureWidth:u,texture:h,texelCount:c,elementsPerTexel:o,isOutput:t===this.context.output.name}}}]),r}(),RZ=function(){function r(e,t){(0,Sn.Z)(this,r),this.elements=void 0;var n=t.data,i=t.usage,o=t.type,s=t.count;this.elements=e.elements({data:n,usage:E3[i||Fe.STATIC_DRAW],type:$w[o||Fe.UNSIGNED_BYTE],count:s})}return(0,Hn.Z)(r,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(t){var n=t.data;this.elements.subdata(n)}},{key:"destroy",value:function(){this.elements.destroy()}}]),r}(),kZ=function(){function r(e,t){(0,Sn.Z)(this,r),this.framebuffer=void 0;var n=t.width,i=t.height,o=t.color,s=t.colors,a=t.depth,l=t.stencil,c={width:n,height:i};Array.isArray(s)&&(c.colors=s.map(function(u){return u.get()})),o&&typeof o!="boolean"&&(c.color=o.get()),this.framebuffer=e.framebuffer(c)}return(0,Hn.Z)(r,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(t){var n=t.width,i=t.height;this.framebuffer.resize(n,i)}}]),r}();function IZ(r){var e=(0,th.Z)(r);return r!=null&&(e==="object"||e==="function")}function $0(r){var e={};return Object.keys(r).forEach(function(t){Zw(t,r[t],e,"")}),e}function Zw(r,e,t,n){if(e===null||typeof e=="number"||typeof e=="boolean"||Array.isArray(e)&&typeof e[0]=="number"||Ww(e)||e===""||e.resize!==void 0){t["".concat(n&&n+".").concat(r)]=e;return}IZ(e)&&Object.keys(e).forEach(function(i){Zw(i,e[i],t,"".concat(n&&n+".").concat(r))}),Array.isArray(e)&&e.forEach(function(i,o){Object.keys(i).forEach(function(s){Zw(s,i[s],t,"".concat(n&&n+".").concat(r,"[").concat(o,"]"))})})}function O3(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function ap(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?O3(Object(t),!0).forEach(function(n){(0,it.Z)(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):O3(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var LZ=function(){function r(e,t){(0,Sn.Z)(this,r),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=e;var n=t.vs,i=t.fs,o=t.defines,s=t.attributes,a=t.uniforms,l=t.primitive,c=t.count,u=t.elements,d=t.depth,h=t.blend,f=t.stencil,p=t.cull,g=t.instances,v=t.scissor,y=t.viewport,x={};a&&(this.uniforms=$0(a),Object.keys(a).forEach(function(z){x[z]=e.prop(z)}));var E={};Object.keys(s).forEach(function(z){E[z]=s[z].get()});var T=o&&this.generateDefines(o)||"",P={attributes:E,frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(T,`
`).concat(i),uniforms:x,vert:`
`.concat(T,`
`).concat(n),primitive:ZW[l===void 0?Fe.TRIANGLES:l]};g&&(P.instances=g),c&&(P.count=c),u&&(P.elements=u.get()),v&&(P.scissor=v),y&&(P.viewport=y),this.initDepthDrawParams({depth:d},P),this.initBlendDrawParams({blend:h},P),this.initStencilDrawParams({stencil:f},P),this.initCullDrawParams({cull:p},P),this.drawCommand=e(P)}return(0,Hn.Z)(r,[{key:"addUniforms",value:function(t){this.uniforms=ap(ap({},this.uniforms),$0(t))}},{key:"draw",value:function(t){var n=ap(ap({},this.uniforms),$0(t.uniforms||{})),i={};Object.keys(n).forEach(function(o){var s=(0,th.Z)(n[o]);s==="boolean"||s==="number"||Array.isArray(n[o])||n[o].BYTES_PER_ELEMENT?i[o]=n[o]:s==="string"||(i[o]=n[o].get())}),this.drawCommand(i)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(t,n){var i=t.depth;i&&(n.depth={enable:i.enable===void 0?!0:!!i.enable,mask:i.mask===void 0?!0:!!i.mask,func:qW[i.func||Fe.LESS],range:i.range||[0,1]})}},{key:"initBlendDrawParams",value:function(t,n){var i=t.blend;if(i){var o=i.enable,s=i.func,a=i.equation,l=i.color,c=l===void 0?[0,0,0,0]:l;n.blend={enable:!!o,func:{srcRGB:Bb[s&&s.srcRGB||Fe.SRC_ALPHA],srcAlpha:Bb[s&&s.srcAlpha||Fe.SRC_ALPHA],dstRGB:Bb[s&&s.dstRGB||Fe.ONE_MINUS_SRC_ALPHA],dstAlpha:Bb[s&&s.dstAlpha||Fe.ONE_MINUS_SRC_ALPHA]},equation:{rgb:A3[a&&a.rgb||Fe.FUNC_ADD],alpha:A3[a&&a.alpha||Fe.FUNC_ADD]},color:c}}}},{key:"initStencilDrawParams",value:function(t,n){var i=t.stencil;if(i){var o=i.enable,s=i.mask,a=s===void 0?-1:s,l=i.func,c=l===void 0?{cmp:Fe.ALWAYS,ref:0,mask:-1}:l,u=i.opFront,d=u===void 0?{fail:Fe.KEEP,zfail:Fe.KEEP,zpass:Fe.KEEP}:u,h=i.opBack,f=h===void 0?{fail:Fe.KEEP,zfail:Fe.KEEP,zpass:Fe.KEEP}:h;n.stencil={enable:!!o,mask:a,func:ap(ap({},c),{},{cmp:JW[c.cmp]}),opFront:{fail:sp[d.fail],zfail:sp[d.zfail],zpass:sp[d.zpass]},opBack:{fail:sp[f.fail],zfail:sp[f.zfail],zpass:sp[f.zpass]}}}}},{key:"initCullDrawParams",value:function(t,n){var i=t.cull;if(i){var o=i.enable,s=i.face,a=s===void 0?Fe.BACK:s;n.cull={enable:!!o,face:QW[a]}}}},{key:"generateDefines",value:function(t){return Object.keys(t).map(function(n){return"#define ".concat(n," ").concat(Number(t[n]))}).join(`
`)}}]),r}(),GZ=function(){function r(e,t){(0,Sn.Z)(this,r),this.texture=void 0,this.width=void 0,this.height=void 0;var n=t.data,i=t.type,o=i===void 0?Fe.UNSIGNED_BYTE:i,s=t.width,a=t.height,l=t.flipY,c=l===void 0?!1:l,u=t.format,d=u===void 0?Fe.RGBA:u,h=t.mipmap,f=h===void 0?!1:h,p=t.wrapS,g=p===void 0?Fe.CLAMP_TO_EDGE:p,v=t.wrapT,y=v===void 0?Fe.CLAMP_TO_EDGE:v,x=t.aniso,E=x===void 0?0:x,T=t.alignment,P=T===void 0?1:T,z=t.premultiplyAlpha,$=z===void 0?!1:z,ne=t.mag,De=ne===void 0?Fe.NEAREST:ne,fe=t.min,Ae=fe===void 0?Fe.NEAREST:fe,de=t.colorSpace,ct=de===void 0?Fe.BROWSER_DEFAULT_WEBGL:de;this.width=s,this.height=a;var bt={width:s,height:a,type:$w[o],format:XW[d],wrapS:_3[g],wrapT:_3[y],mag:S3[De],min:S3[Ae],alignment:P,flipY:c,colorSpace:KW[ct],premultiplyAlpha:$,aniso:E};n&&(bt.data=n),typeof f=="number"?bt.mipmap=YW[f]:typeof f=="boolean"&&(bt.mipmap=f),this.texture=e.texture(bt)}return(0,Hn.Z)(r,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(t){var n=t.width,i=t.height;this.texture.resize(n,i),this.width=n,this.height=i}},{key:"destroy",value:function(){this.texture.destroy()}}]),r}(),D3,N3,R3,FZ=(D3=(0,R.b2)(),D3(N3=(R3=function(){function r(){var e=this;(0,Sn.Z)(this,r),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var t=(0,Yr.Z)(yn().mark(function n(i){return yn().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!i.uniforms){s.next=3;break}return s.next=3,Promise.all(Object.keys(i.uniforms).map(function(){var a=(0,Yr.Z)(yn().mark(function l(c){var u;return yn().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!(i.uniforms[c]&&i.uniforms[c].load!==void 0)){h.next=5;break}return h.next=3,i.uniforms[c].load();case 3:u=h.sent,i.uniforms[c]=u;case 5:case"end":return h.stop()}},l)}));return function(l){return a.apply(this,arguments)}}()));case 3:return s.abrupt("return",new LZ(e.gl,i));case 4:case"end":return s.stop()}},n)}));return function(n){return t.apply(this,arguments)}}(),this.createAttribute=function(t){return new WW(e.gl,t)},this.createBuffer=function(t){return new eZ(e.gl,t)},this.createElements=function(t){return new RZ(e.gl,t)},this.createTexture2D=function(t){return new GZ(e.gl,t)},this.createFramebuffer=function(t){return new kZ(e.gl,t)},this.useFramebuffer=function(t,n){e.gl({framebuffer:t?t.get():null})(n)},this.createComputeModel=function(){var t=(0,Yr.Z)(yn().mark(function n(i){return yn().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",new NZ(e.gl,i));case 1:case"end":return s.stop()}},n)}));return function(n){return t.apply(this,arguments)}}(),this.clear=function(t){var n=t.color,i=t.depth,o=t.stencil,s=t.framebuffer,a=s===void 0?null:s,l={color:n,depth:i,stencil:o};l.framebuffer=a===null?a:a.get(),e.gl.clear(l)},this.setScissor=function(t){e.gl&&e.gl._gl&&(t.enable&&t.box?(e.gl._gl.enable(Fe.SCISSOR_TEST),e.gl._gl.scissor(t.box.x,t.box.y,t.box.width,t.box.height)):e.gl._gl.disable(Fe.SCISSOR_TEST),e.gl._refresh())},this.viewport=function(t){var n=t.x,i=t.y,o=t.width,s=t.height;e.gl&&e.gl._gl&&(e.gl._gl.viewport(n,i,o,s),e.gl._refresh())},this.readPixels=function(t){var n=t.framebuffer,i=t.x,o=t.y,s=t.width,a=t.height,l={x:i,y:o,width:s,height:a};return n&&(l.framebuffer=n.get()),e.gl.read(l)},this.getCanvas=function(){return e.$canvas},this.getGLContext=function(){return e.gl._gl},this.destroy=function(){e.gl&&(e.gl.destroy(),e.inited=!1)}}return(0,Hn.Z)(r,[{key:"init",value:function(){var e=(0,Yr.Z)(yn().mark(function n(i){return yn().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this.inited){s.next=2;break}return s.abrupt("return");case 2:return this.$canvas=i.canvas,s.next=5,new Promise(function(a,l){$W()({canvas:i.canvas,attributes:{alpha:!0,antialias:i.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(u,d){(u||!d)&&l(u),a(d)}})});case 5:this.gl=s.sent,this.inited=!0;case 7:case"end":return s.stop()}},n,this)}));function t(n){return e.apply(this,arguments)}return t}()},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),r}(),R3))||N3);function BZ(){return typeof window!="undefined"}function zZ(r,e,t,n){if(!!BZ()){var i=document.getElementsByTagName("head")[0],o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src",r),n&&(o.id=n),o.onload=function(){e&&e()},o.onerror=function(s){t&&t("Unable to load script '".concat(r,"'"),s)},i.appendChild(o)}}function UZ(r,e){return new Promise(function(t,n){zZ(r,function(){t()},function(i,o){n(o)})})}var Ub;function VZ(){return Xw.apply(this,arguments)}function Xw(){return Xw=(0,Yr.Z)(yn().mark(function r(){return yn().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!Ub){t.next=2;break}return t.abrupt("return",Ub);case 2:return t.next=4,UZ("https://preview.babylonjs.com/glslang/glslang.js");case 4:return Ub=window.glslang("https://preview.babylonjs.com/glslang/glslang.wasm"),t.abrupt("return",Ub);case 6:case"end":return t.stop()}},r)})),Xw.apply(this,arguments)}var jZ=function(){function r(e,t){(0,Sn.Z)(this,r),this.engine=e,this.options=t,this.attribute=void 0,this.buffer=void 0;var n=t,i=n.buffer,o=n.offset,s=n.stride,a=n.normalized,l=n.size,c=n.divisor,u=n.arrayStride,d=n.attributes,h=n.stepMode;this.buffer=i,this.attribute={buffer:i.get(),offset:o||0,stride:s||0,normalized:a||!1,divisor:c||0,arrayStride:u||0,attributes:d,stepMode:h||"vertex"},l&&(this.attribute.size=l)}return(0,Hn.Z)(r,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),r}(),lp=function(){function r(e,t){(0,Sn.Z)(this,r),this.engine=e,this.options=t,this.buffer=void 0;var n=t,i=n.data,o=n.usage,s=n.type;this.buffer=this.createBuffer(i instanceof Array?new Float32Array(i):i,o||qt.FB.Vertex|qt.FB.CopyDst)}return(0,Hn.Z)(r,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(t){var n=t.data,i=t.offset;this.setSubData(this.buffer,i,n instanceof Array?new Float32Array(n):n)}},{key:"createBuffer",value:function(t,n){var i=t.byteLength%4,o={size:t.byteLength+i,usage:n},s=this.engine.device.createBuffer(o);return this.setSubData(s,0,t),s}},{key:"setSubData",value:function(t,n,i){var o=$s?this.engine.device.getQueue():this.engine.device.defaultQueue;o.writeBuffer(t,n,i)}}]),r}();function HZ(r){return typeof r=="number"}var $Z=function(){function r(e,t){(0,Sn.Z)(this,r),this.engine=e,this.context=t,this.entity=Dl(),this.uniformGPUBufferLayout=[],this.uniformBuffer=void 0,this.vertexBuffers={},this.outputBuffer=void 0,this.bindGroupEntries=void 0,this.bindGroup=void 0,this.computePipeline=void 0}return(0,Hn.Z)(r,[{key:"init",value:function(){var e=(0,Yr.Z)(yn().mark(function n(){var i=this,o,s,a,l,c,u,d;return yn().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.compileComputePipelineStageDescriptor(this.context.shader);case 2:o=f.sent,s=o.computeStage,a=this.context.uniforms.filter(function(p){return p.storageClass===Su.StorageBuffer}),l=this.context.uniforms.filter(function(p){return p.storageClass===Su.Uniform}),c=l.length?1:0,this.bindGroupEntries=[],c&&(u=0,d=[],l.forEach(function(p){if(HZ(p.data))i.uniformGPUBufferLayout.push({name:p.name,offset:u}),u+=4,d.push(p.data);else{var g,v=((g=p.data)===null||g===void 0?void 0:g.length)||1;v===3&&(v=4,p.data.push(0));var y=u/4%4;if(y>0){var x=4-y;if(v>1&&v<=x)v===2&&(x===3&&(u+=4,d.push(0)),d.push.apply(d,(0,wo.Z)(p.data)),i.uniformGPUBufferLayout.push({name:p.name,offset:u}));else{for(var E=0;E<x;E++)u+=4,d.push(0);d.push.apply(d,(0,wo.Z)(p.data)),i.uniformGPUBufferLayout.push({name:p.name,offset:u})}}u+=4*v}}),this.uniformBuffer=new lp(this.engine,{data:d instanceof Array?new Float32Array(d):d,usage:qt.FB.Uniform|qt.FB.CopyDst}),this.bindGroupEntries.push({binding:0,resource:{buffer:this.uniformBuffer.get()}})),a.forEach(function(p){if(p.data!==null&&(p.type===ih.Vector4FloatArray||p.type===ih.FloatArray)){var g;p.name===i.context.output.name?(g=new lp(i.engine,{data:isFinite(Number(p.data))?[p.data]:p.data,usage:qt.FB.Storage|qt.FB.CopyDst|qt.FB.CopySrc}),i.outputBuffer=g,i.context.output={name:p.name,length:isFinite(Number(p.data))?1:p.data.length,typedArrayConstructor:Float32Array,gpuBuffer:g.get()}):p.isReferer?p.data.model&&p.data.model.outputBuffer&&(g=p.data.model.outputBuffer):g=new lp(i.engine,{data:isFinite(Number(p.data))?[p.data]:p.data,usage:qt.FB.Storage|qt.FB.CopyDst|qt.FB.CopySrc}),i.vertexBuffers[p.name]=g,i.bindGroupEntries.push({binding:c,resource:{name:p.name,refer:g?void 0:p.data,buffer:g?g.get():void 0}}),c++}}),this.computePipeline=this.engine.device.createComputePipeline({computeStage:s}),console.log(this.bindGroupEntries),this.bindGroup=this.engine.device.createBindGroup({layout:this.computePipeline.getBindGroupLayout(0),entries:this.bindGroupEntries});case 13:case"end":return f.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"destroy",value:function(){var t=this;this.uniformBuffer&&this.uniformBuffer.destroy(),Object.keys(this.vertexBuffers).forEach(function(n){return t.vertexBuffers[n].destroy()})}},{key:"readData",value:function(){var e=(0,Yr.Z)(yn().mark(function n(){var i,o,s,a,l,c,u,d,h,f;return yn().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(i=this.context.output,!i){g.next=16;break}if(o=i.length,s=i.typedArrayConstructor,a=i.gpuBuffer,!a){g.next=16;break}return l=o*s.BYTES_PER_ELEMENT,c=this.engine.device.createBuffer({size:l,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),u=this.engine.device.createCommandEncoder(),u.copyBufferToBuffer(a,0,c,0,l),d=$s?this.engine.device.getQueue():this.engine.device.defaultQueue,d.submit([u.finish()]),g.next=12,c.mapAsync(qt.gc.Read);case 12:return h=c.getMappedRange(),f=new s(h.slice(0)),c.unmap(),g.abrupt("return",f);case 16:return g.abrupt("return",new Float32Array);case 17:case"end":return g.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"run",value:function(){if(this.engine.currentComputePass){var t;this.engine.currentComputePass.setPipeline(this.computePipeline),this.engine.currentComputePass.setBindGroup(0,this.bindGroup),(t=this.engine.currentComputePass).dispatch.apply(t,(0,wo.Z)(this.context.dispatch))}}},{key:"updateBuffer",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=this.vertexBuffers[t];o&&o.subData({data:n,offset:i})}},{key:"updateUniform",value:function(t,n){var i=this.uniformGPUBufferLayout.find(function(o){return o.name===t});i&&this.uniformBuffer.subData({data:Number.isFinite(n)?new Float32Array([n]):new Float32Array(n),offset:i.offset})}},{key:"confirmInput",value:function(t,n){var i=this.vertexBuffers[n],o=t.outputBuffer;if(i&&o&&i!==o){var s=this.engine.device.createCommandEncoder(),a=t.context.output,l=a.length,c=a.typedArrayConstructor,u=l*c.BYTES_PER_ELEMENT;s.copyBufferToBuffer(o.get(),0,i.get(),0,u);var d=$s?this.engine.device.getQueue():this.engine.device.defaultQueue;d.submit([s.finish()])}}},{key:"compileShaderToSpirV",value:function(t,n,i){return this.compileRawShaderToSpirV(i+t,n)}},{key:"compileRawShaderToSpirV",value:function(t,n){return this.engine.glslang.compileGLSL(t,n)}},{key:"compileComputePipelineStageDescriptor",value:function(){var e=(0,Yr.Z)(yn().mark(function n(i){var o,s;return yn().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(o=i,s=`#version 450
`,this.engine.options.useWGSL){l.next=6;break}return l.next=5,this.compileShaderToSpirV(i,"compute",s);case 5:o=l.sent;case 6:return l.abrupt("return",{computeStage:{module:this.engine.device.createShaderModule({code:o,isWHLSL:$s}),entryPoint:"main"}});case 7:case"end":return l.stop()}},n,this)}));function t(n){return e.apply(this,arguments)}return t}()}]),r}(),WZ=function(){function r(e,t){(0,Sn.Z)(this,r),this.engine=e,this.options=t,this.indexCount=void 0,this.buffer=void 0;var n=t,i=n.data,o=n.usage,s=n.type,a=n.count;this.indexCount=a||0,this.buffer=new lp(e,{data:i instanceof Array?new Uint16Array(i):i,usage:qt.FB.Index|qt.FB.CopyDst})}return(0,Hn.Z)(r,[{key:"get",value:function(){return this.buffer}},{key:"subData",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),r}(),ZZ=function(){function r(e,t){(0,Sn.Z)(this,r),this.engine=e,this.options=t,this.colorTexture=void 0,this.depthTexture=void 0,this.width=0,this.height=0;var n=t,i=n.width,o=n.height,s=n.color,a=n.colors,l=n.depth,c=n.stencil;s&&(this.colorTexture=s),l&&(this.depthTexture=l)}return(0,Hn.Z)(r,[{key:"get",value:function(){var t,n;return{color:(t=this.colorTexture)===null||t===void 0?void 0:t.get(),depth:(n=this.depthTexture)===null||n===void 0?void 0:n.get()}}},{key:"destroy",value:function(){var t,n;(t=this.colorTexture)===null||t===void 0||t.destroy(),(n=this.depthTexture)===null||n===void 0||n.destroy()}},{key:"resize",value:function(t){var n=t.width,i=t.height;if(n!==this.width||i!==this.height){var o,s;(o=this.colorTexture)===null||o===void 0||o.resize({width:n,height:i}),(s=this.depthTexture)===null||s===void 0||s.resize({width:n,height:i})}this.width=n,this.height=i}}]),r}(),Tc,Ll,lh,Ps,cp,Vb,W0,XZ=(Tc={},(0,it.Z)(Tc,Fe.POINTS,qt.YV.PointList),(0,it.Z)(Tc,Fe.LINES,qt.YV.LineList),(0,it.Z)(Tc,Fe.LINE_LOOP,qt.YV.LineList),(0,it.Z)(Tc,Fe.LINE_STRIP,qt.YV.LineStrip),(0,it.Z)(Tc,Fe.TRIANGLES,qt.YV.TriangleList),(0,it.Z)(Tc,Fe.TRIANGLE_FAN,qt.YV.TriangleList),(0,it.Z)(Tc,Fe.TRIANGLE_STRIP,qt.YV.TriangleStrip),Tc),YZ=(Ll={},(0,it.Z)(Ll,Fe.NEVER,qt.wb.Never),(0,it.Z)(Ll,Fe.ALWAYS,qt.wb.Always),(0,it.Z)(Ll,Fe.LESS,qt.wb.Less),(0,it.Z)(Ll,Fe.LEQUAL,qt.wb.LessEqual),(0,it.Z)(Ll,Fe.GREATER,qt.wb.Greater),(0,it.Z)(Ll,Fe.GEQUAL,qt.wb.GreaterEqual),(0,it.Z)(Ll,Fe.EQUAL,qt.wb.Equal),(0,it.Z)(Ll,Fe.NOTEQUAL,qt.wb.NotEqual),Ll),k3=(lh={},(0,it.Z)(lh,Fe.FUNC_ADD,qt.db.Add),(0,it.Z)(lh,Fe.MIN_EXT,qt.db.Min),(0,it.Z)(lh,Fe.MAX_EXT,qt.db.Max),(0,it.Z)(lh,Fe.FUNC_SUBTRACT,qt.db.Subtract),(0,it.Z)(lh,Fe.FUNC_REVERSE_SUBTRACT,qt.db.ReverseSubtract),lh),jb=(Ps={},(0,it.Z)(Ps,Fe.ZERO,qt.zi.Zero),(0,it.Z)(Ps,Fe.ONE,qt.zi.One),(0,it.Z)(Ps,Fe.SRC_COLOR,qt.zi.SrcColor),(0,it.Z)(Ps,Fe.ONE_MINUS_SRC_COLOR,qt.zi.OneMinusSrcColor),(0,it.Z)(Ps,Fe.SRC_ALPHA,qt.zi.SrcAlpha),(0,it.Z)(Ps,Fe.ONE_MINUS_SRC_ALPHA,qt.zi.OneMinusSrcAlpha),(0,it.Z)(Ps,Fe.DST_COLOR,qt.zi.DstColor),(0,it.Z)(Ps,Fe.ONE_MINUS_DST_COLOR,qt.zi.OneMinusDstColor),(0,it.Z)(Ps,Fe.DST_ALPHA,qt.zi.DstAlpha),(0,it.Z)(Ps,Fe.ONE_MINUS_DST_ALPHA,qt.zi.OneMinusDstAlpha),(0,it.Z)(Ps,Fe.CONSTANT_COLOR,qt.zi.BlendColor),(0,it.Z)(Ps,Fe.ONE_MINUS_CONSTANT_COLOR,qt.zi.OneMinusBlendColor),(0,it.Z)(Ps,Fe.SRC_ALPHA_SATURATE,qt.zi.SrcAlphaSaturated),Ps),KZ=(cp={},(0,it.Z)(cp,Fe.ALPHA,"r8unorm"),(0,it.Z)(cp,Fe.RGBA,"rgba8unorm"),(0,it.Z)(cp,Fe.DEPTH_COMPONENT,"depth32float"),(0,it.Z)(cp,Fe.DEPTH_STENCIL,"depth24plus-stencil8"),cp),I3=(Vb={},(0,it.Z)(Vb,Fe.NEAREST,"nearest"),(0,it.Z)(Vb,Fe.LINEAR,"linear"),Vb),Yw=(W0={},(0,it.Z)(W0,Fe.REPEAT,"repeat"),(0,it.Z)(W0,Fe.CLAMP_TO_EDGE,"clamp-to-edge"),(0,it.Z)(W0,Fe.MIRRORED_REPEAT,"mirror-repeat"),W0);function qZ(r){var e=r.cull;if(!e||!e.enable)return qt.Wf.None;if(e.face)return e.face===Fe.FRONT?qt.Wf.Front:qt.Wf.Back}function JZ(r){var e=r.depth,t=r.stencil,n={compare:qt.wb.Always,depthFailOp:qt.xS.Keep,failOp:qt.xS.Keep,passOp:qt.xS.Keep};return{depthWriteEnabled:e&&e.enable,depthCompare:YZ[(e==null?void 0:e.func)||Fe.ALWAYS],format:qt.EV.Depth24PlusStencil8,stencilFront:n,stencilBack:n,stencilReadMask:4294967295,stencilWriteMask:4294967295}}function QZ(r,e){var t=r.blend;return[{format:e,alphaBlend:{srcFactor:jb[t&&t.func&&t.func.srcAlpha||Fe.ONE],dstFactor:jb[t&&t.func&&t.func.dstAlpha||Fe.ZERO],operation:k3[t&&t.equation&&t.equation.alpha||Fe.FUNC_ADD]},colorBlend:{srcFactor:jb[t&&t.func&&t.func.srcRGB||Fe.ONE],dstFactor:jb[t&&t.func&&t.func.dstRGB||Fe.ZERO],operation:k3[t&&t.equation&&t.equation.rgb||Fe.FUNC_ADD]},writeMask:qt.Yw.All}]}function L3(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function up(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?L3(Object(t),!0).forEach(function(n){(0,it.Z)(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):L3(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function eX(r){for(var e=0,t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var o=0,s=n;o<s.length;o++){var a=s[o];e+=a.length}for(var l=new r(e),c=0,u=0,d=n;u<d.length;u++){var h=d[u];l.set(h,c),c+=h.length}return l}var tX=function(){function r(e,t){(0,Sn.Z)(this,r),this.engine=e,this.options=t,this.pipelineLayout=void 0,this.renderPipeline=void 0,this.uniformsBindGroupLayout=void 0,this.uniformBindGroup=void 0,this.uniformBuffer=void 0,this.uniforms={},this.uniformGPUBufferLayout=[],this.attributeCache={},this.indexBuffer=void 0,this.indexCount=void 0}return(0,Hn.Z)(r,[{key:"init",value:function(){var e=(0,Yr.Z)(yn().mark(function n(){var i=this,o,s,a,l,c,u,d,h,f,p,g,v,y,x,E,T,P,z;return yn().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return o=this.options,s=o.vs,a=o.fs,l=o.attributes,c=o.uniforms,u=o.primitive,d=o.count,h=o.elements,f=o.depth,p=o.blend,g=o.stencil,v=o.cull,y=o.instances,ne.next=3,this.compilePipelineStageDescriptor(s,a,null);case 3:x=ne.sent,E=x.vertexStage,T=x.fragmentStage,c&&this.buildUniformBindGroup(c),h&&(this.indexBuffer=h.get(),this.indexCount=h.indexCount),P={vertexBuffers:Object.keys(l).map(function(De,fe){var Ae=l[De],de=Ae.get(),ct=de.arrayStride,bt=de.stepMode,Pe=de.attributes;return i.attributeCache[De]=Ae,{arrayStride:ct,stepMode:bt,attributes:Pe}})},z={sampleCount:this.engine.mainPassSampleCount,primitiveTopology:XZ[u||Fe.TRIANGLES],rasterizationState:up(up({},this.getDefaultRasterizationStateDescriptor()),{},{cullMode:qZ({cull:v})}),depthStencilState:JZ({depth:f,stencil:g}),colorStates:QZ({blend:p},this.engine.options.swapChainFormat),layout:this.pipelineLayout,vertexStage:E,fragmentStage:T,vertexState:P},this.renderPipeline=this.engine.device.createRenderPipeline(z);case 11:case"end":return ne.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"addUniforms",value:function(t){this.uniforms=up(up({},this.uniforms),$0(t))}},{key:"draw",value:function(t){var n=this,i=this.engine.getCurrentRenderPass(),o=up(up({},this.uniforms),$0(t.uniforms||{})),s=[];Object.keys(o).forEach(function(a){var l=(0,th.Z)(o[a]);if(l==="boolean"||l==="number"||Array.isArray(o[a])||o[a].BYTES_PER_ELEMENT){var c,u=(c=n.uniformGPUBufferLayout.find(function(y){var x=y.name;return x===a}))===null||c===void 0?void 0:c.offset;u!==null&&n.uniformBuffer.subData({data:o[a],offset:u})}else{var d,h=(d=n.uniformGPUBufferLayout.find(function(y){var x=y.name;return x===a}))===null||d===void 0?void 0:d.offset;if(h!==null){var f=o[a].get(),p=f.color||f,g=p.texture,v=p.sampler;v&&(s.push({binding:h,resource:v}),h++),s.push({binding:h,resource:g.createView()})}}}),this.uniformBuffer&&(s[0]={binding:0,resource:{buffer:this.uniformBuffer.get()}}),this.uniformBindGroup=this.engine.device.createBindGroup({layout:this.uniformsBindGroupLayout,entries:s}),this.renderPipeline&&i.setPipeline(this.renderPipeline),i.setBindGroup(0,this.uniformBindGroup),this.indexBuffer&&i.setIndexBuffer(this.indexBuffer.get(),qt.iD.Uint32,0),Object.keys(this.attributeCache).forEach(function(a,l){i.setVertexBuffer(0+l,n.attributeCache[a].get().buffer,0)}),this.indexBuffer?i.drawIndexed(this.indexCount,this.options.instances||1,0,0,0):i.draw(this.options.count||0,this.options.instances||0,0,0)}},{key:"destroy",value:function(){throw new Error("Method not implemented.")}},{key:"compilePipelineStageDescriptor",value:function(){var e=(0,Yr.Z)(yn().mark(function n(i,o,s){var a,l,c;return yn().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(a=`#version 450
`,l=i,c=o,this.engine.options.useWGSL){d.next=10;break}return d.next=6,this.compileShaderToSpirV(i,"vertex",a);case 6:return l=d.sent,d.next=9,this.compileShaderToSpirV(o,"fragment",a);case 9:c=d.sent;case 10:return d.abrupt("return",this.createPipelineStageDescriptor(l,c));case 11:case"end":return d.stop()}},n,this)}));function t(n,i,o){return e.apply(this,arguments)}return t}()},{key:"compileShaderToSpirV",value:function(t,n,i){return this.compileRawShaderToSpirV(i+t,n)}},{key:"compileRawShaderToSpirV",value:function(t,n){return this.engine.glslang.compileGLSL(t,n)}},{key:"createPipelineStageDescriptor",value:function(t,n){return{vertexStage:{module:this.engine.device.createShaderModule({code:t,isWHLSL:$s}),entryPoint:"main"},fragmentStage:{module:this.engine.device.createShaderModule({code:n,isWHLSL:$s}),entryPoint:"main"}}}},{key:"getDefaultRasterizationStateDescriptor",value:function(){return{frontFace:qt.zX.CCW,cullMode:qt.Wf.None,depthBias:0,depthBiasSlopeScale:0,depthBiasClamp:0}}},{key:"buildUniformBindGroup",value:function(t){var n=this,i=0,o=eX.apply(void 0,[Float32Array].concat((0,wo.Z)(Object.keys(t).map(function(l){return t[l]?(n.uniformGPUBufferLayout.push({name:l,offset:i}),i+=(t[l].length||1)*4,t[l]):[]})))),s=[],a=!1;o.length&&(a=!0,s.push({binding:0,visibility:qt.$X.Fragment|qt.$X.Vertex,type:qt.$l.UniformBuffer})),Object.keys(t).filter(function(l){return t[l]===null}).forEach(function(l,c){n.uniformGPUBufferLayout.push({name:l,offset:c*2+(a?1:0)}),s.push({binding:c*2+(a?1:0),visibility:qt.$X.Fragment,type:qt.$l.Sampler},{binding:c*2+(a?1:0)+1,visibility:qt.$X.Fragment,type:qt.$l.SampledTexture})}),this.uniformsBindGroupLayout=this.engine.device.createBindGroupLayout({entries:s}),this.pipelineLayout=this.engine.device.createPipelineLayout({bindGroupLayouts:[this.uniformsBindGroupLayout]}),a&&(this.uniformBuffer=new lp(this.engine,{data:o instanceof Array?new Float32Array(o):o,usage:qt.FB.Uniform|qt.FB.CopyDst}))}}]),r}(),nX=function(){function r(e,t){(0,Sn.Z)(this,r),this.engine=e,this.options=t,this.texture=void 0,this.sampler=void 0,this.width=void 0,this.height=void 0,this.createTexture()}return(0,Hn.Z)(r,[{key:"get",value:function(){return{texture:this.texture,sampler:this.sampler}}},{key:"update",value:function(){}},{key:"resize",value:function(t){var n=t.width,i=t.height;(n!==this.width||i!==this.height)&&(this.destroy(),this.createTexture()),this.width=n,this.height=i}},{key:"destroy",value:function(){this.texture&&this.texture.destroy()}},{key:"createTexture",value:function(){var t=this.options,n=t.data,i=t.type,o=i===void 0?Fe.UNSIGNED_BYTE:i,s=t.width,a=t.height,l=t.flipY,c=l===void 0?!1:l,u=t.format,d=u===void 0?Fe.RGBA:u,h=t.mipmap,f=h===void 0?!1:h,p=t.wrapS,g=p===void 0?Fe.CLAMP_TO_EDGE:p,v=t.wrapT,y=v===void 0?Fe.CLAMP_TO_EDGE:v,x=t.aniso,E=x===void 0?0:x,T=t.alignment,P=T===void 0?1:T,z=t.premultiplyAlpha,$=z===void 0?!1:z,ne=t.mag,De=ne===void 0?Fe.NEAREST:ne,fe=t.min,Ae=fe===void 0?Fe.NEAREST:fe,de=t.colorSpace,ct=de===void 0?Fe.BROWSER_DEFAULT_WEBGL:de,bt=t.usage;this.width=s,this.height=a,this.texture=this.engine.device.createTexture({size:[s,a,1],mipLevelCount:1,sampleCount:1,dimension:qt.kd.E2d,format:KZ[d],usage:bt||qt.v2.Sampled|qt.v2.CopyDst}),(!bt||bt&qt.v2.Sampled)&&(this.sampler=this.engine.device.createSampler({addressModeU:Yw[g],addressModeV:Yw[y],addressModeW:Yw[g],magFilter:I3[De],minFilter:I3[Ae],maxAnisotropy:E}))}}]),r}(),G3,F3,B3,rX=(G3=(0,R.b2)(),G3(F3=(B3=function(){function r(){var e=this;(0,Sn.Z)(this,r),this.supportWebGPU=!0,this.useWGSL=!1,this.options=void 0,this.canvas=void 0,this.context=void 0,this.glslang=void 0,this.adapter=void 0,this.device=void 0,this.swapChain=void 0,this.mainPassSampleCount=void 0,this.mainTexture=void 0,this.depthTexture=void 0,this.mainColorAttachments=void 0,this.mainTextureExtends=void 0,this.mainDepthAttachment=void 0,this.uploadEncoder=void 0,this.renderEncoder=void 0,this.computeEncoder=void 0,this.renderTargetEncoder=void 0,this.commandBuffers=new Array(4).fill(void 0),this.currentRenderPass=null,this.mainRenderPass=null,this.currentRenderTargetViewDescriptor=void 0,this.currentComputePass=null,this.bundleEncoder=void 0,this.tempBuffers=[],this.currentRenderTarget=null,this.uploadEncoderDescriptor={label:"upload"},this.renderEncoderDescriptor={label:"render"},this.renderTargetEncoderDescriptor={label:"renderTarget"},this.computeEncoderDescriptor={label:"compute"},this.pipelines={},this.computePipelines={},this.defaultSampleCount=4,this.clearDepthValue=1,this.clearStencilValue=0,this.transientViewport={x:Infinity,y:0,width:0,height:0},this.cachedViewport={x:0,y:0,width:0,height:0},this.clear=function(t){var n=t.framebuffer,i=t.color,o=t.depth,s=t.stencil;e.options.supportCompute&&e.startComputePass(),e.currentRenderTarget?(e.currentRenderPass&&e.endRenderTargetRenderPass(),e.startRenderTargetRenderPass(e.currentRenderTarget,i||null,!!o,!!s)):(e.mainColorAttachments[0].loadValue=i||qt.Ws.Load,e.mainDepthAttachment.depthLoadValue=o||qt.Ws.Load,e.mainDepthAttachment.stencilLoadValue=s?e.clearStencilValue:qt.Ws.Load,e.mainRenderPass&&e.endMainRenderPass(),e.startMainRenderPass())},this.createModel=function(){var t=(0,Yr.Z)(yn().mark(function n(i){var o;return yn().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o=new tX(e,i),a.next=3,o.init();case 3:return a.abrupt("return",o);case 4:case"end":return a.stop()}},n)}));return function(n){return t.apply(this,arguments)}}(),this.createAttribute=function(t){return new jZ(e,t)},this.createBuffer=function(t){return new lp(e,t)},this.createElements=function(t){return new WZ(e,t)},this.createTexture2D=function(t){return new nX(e,t)},this.createFramebuffer=function(t){return new ZZ(e,t)},this.useFramebuffer=function(t,n){e.currentRenderTarget&&e.unbindFramebuffer(e.currentRenderTarget),e.currentRenderTarget=t,e.currentRenderTargetViewDescriptor={dimension:qt.p_.E2d,arrayLayerCount:1,aspect:qt.H7.All},e.currentRenderPass=null,n()},this.createComputeModel=function(){var t=(0,Yr.Z)(yn().mark(function n(i){var o;return yn().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o=new $Z(e,i),a.next=3,o.init();case 3:return a.abrupt("return",o);case 4:case"end":return a.stop()}},n)}));return function(n){return t.apply(this,arguments)}}(),this.getCanvas=function(){return e.canvas},this.getGLContext=function(){throw new Error("Method not implemented.")},this.viewport=function(t){var n=t.x,i=t.y,o=t.width,s=t.height;if(!e.currentRenderPass)e.transientViewport={x:n,y:i,width:o,height:s};else if(e.transientViewport.x!==Infinity){var a=e.getCurrentRenderPass();a.setViewport(e.transientViewport.x,e.transientViewport.y,e.transientViewport.width,e.transientViewport.height,0,1)}else if(n!==e.cachedViewport.x||i!==e.cachedViewport.y||o!==e.cachedViewport.width||s!==e.cachedViewport.height){e.cachedViewport={x:n,y:i,width:o,height:s};var l=e.getCurrentRenderPass();l.setViewport(n,i,o,s,0,1)}},this.readPixels=function(t){throw new Error("Method not implemented.")}}return(0,Hn.Z)(r,[{key:"isFloatSupported",value:function(){return!0}},{key:"init",value:function(){var e=(0,Yr.Z)(yn().mark(function n(i){return yn().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return this.canvas=i.canvas,this.options=i,this.useWGSL=!!i.useWGSL,this.mainPassSampleCount=i.antialiasing?this.defaultSampleCount:1,s.next=6,this.initGlslang();case 6:this.initContextAndSwapChain(),this.initMainAttachments();case 8:case"end":return s.stop()}},n,this)}));function t(n){return e.apply(this,arguments)}return t}()},{key:"setScissor",value:function(t){throw new Error("Method not implemented.")}},{key:"destroy",value:function(){this.mainTexture&&this.mainTexture.destroy(),this.depthTexture&&this.depthTexture.destroy(),this.tempBuffers.forEach(function(t){return t.destroy()}),this.tempBuffers=[]}},{key:"beginFrame",value:function(){this.uploadEncoder=this.device.createCommandEncoder(this.uploadEncoderDescriptor),this.renderEncoder=this.device.createCommandEncoder(this.renderEncoderDescriptor),this.renderTargetEncoder=this.device.createCommandEncoder(this.renderTargetEncoderDescriptor),this.options.supportCompute&&(this.computeEncoder=this.device.createCommandEncoder(this.computeEncoderDescriptor))}},{key:"endFrame",value:function(){this.options.supportCompute&&this.endComputePass(),this.endMainRenderPass(),this.commandBuffers[0]=this.uploadEncoder.finish(),this.commandBuffers[1]=this.renderEncoder.finish(),this.options.supportCompute&&(this.commandBuffers[2]=this.computeEncoder.finish()),this.commandBuffers[3]=this.renderTargetEncoder.finish(),$s?this.device.getQueue().submit(this.commandBuffers.filter(function(t){return t})):this.device.defaultQueue.submit(this.commandBuffers.filter(function(t){return t}))}},{key:"getCurrentRenderPass",value:function(){return this.currentRenderTarget&&!this.currentRenderPass?this.startRenderTargetRenderPass(this.currentRenderTarget,null,!1,!1):this.currentRenderPass||this.startMainRenderPass(),this.currentRenderPass}},{key:"initGlslang",value:function(){var e=(0,Yr.Z)(yn().mark(function n(){var i,o;return yn().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,VZ();case 2:return this.glslang=a.sent,a.next=5,(i=navigator)===null||i===void 0||(o=i.gpu)===null||o===void 0?void 0:o.requestAdapter();case 5:return this.adapter=a.sent,a.next=8,this.adapter.requestDevice();case 8:this.device=a.sent;case 9:case"end":return a.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"initContextAndSwapChain",value:function(){this.context=this.canvas.getContext($s?"gpu":"gpupresent"),this.swapChain=this.context.configureSwapChain({device:this.device,format:this.options.swapChainFormat,usage:qt.v2.OutputAttachment|qt.v2.CopySrc})}},{key:"initMainAttachments",value:function(){if(this.mainTextureExtends={width:this.canvas.width,height:this.canvas.height,depth:1},this.options.antialiasing){var t={size:this.mainTextureExtends,mipLevelCount:1,sampleCount:this.mainPassSampleCount,dimension:qt.kd.E2d,format:qt.EV.BGRA8Unorm,usage:qt.v2.OutputAttachment};this.mainTexture&&this.mainTexture.destroy(),this.mainTexture=this.device.createTexture(t),this.mainColorAttachments=[{attachment:$s?this.mainTexture.createDefaultView():this.mainTexture.createView(),loadValue:[0,0,0,1],storeOp:qt.EG.Store}]}else this.mainColorAttachments=[{attachment:$s?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView(),loadValue:[0,0,0,1],storeOp:qt.EG.Store}];var n={size:this.mainTextureExtends,mipLevelCount:1,sampleCount:this.mainPassSampleCount,dimension:qt.kd.E2d,format:$s?"depth32float-stencil8":qt.EV.Depth24PlusStencil8,usage:qt.v2.OutputAttachment};this.depthTexture&&this.depthTexture.destroy(),this.depthTexture=this.device.createTexture(n),this.mainDepthAttachment={attachment:$s?this.depthTexture.createDefaultView():this.depthTexture.createView(),depthLoadValue:this.clearDepthValue,depthStoreOp:qt.EG.Store,stencilLoadValue:this.clearStencilValue,stencilStoreOp:qt.EG.Store}}},{key:"startComputePass",value:function(){this.currentComputePass&&this.endComputePass(),this.currentComputePass=this.computeEncoder.beginComputePass()}},{key:"startMainRenderPass",value:function(){this.currentRenderPass&&!this.currentRenderTarget&&this.endMainRenderPass(),this.options.antialiasing?this.mainColorAttachments[0].resolveTarget=$s?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView():this.mainColorAttachments[0].attachment=$s?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView(),this.currentRenderPass=this.renderEncoder.beginRenderPass({colorAttachments:this.mainColorAttachments,depthStencilAttachment:this.mainDepthAttachment}),this.mainRenderPass=this.currentRenderPass,this.cachedViewport&&this.viewport(this.cachedViewport)}},{key:"startRenderTargetRenderPass",value:function(t,n,i){var o,s,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=(o=t.get().color)===null||o===void 0?void 0:o.texture,c;l&&(c=l.createView(this.currentRenderTargetViewDescriptor));var u=(s=t.get().depth)===null||s===void 0?void 0:s.texture,d;u&&(d=u.createView());var h=this.renderTargetEncoder.beginRenderPass({colorAttachments:[{attachment:c,loadValue:n!==null?n:qt.Ws.Load,storeOp:qt.EG.Store}],depthStencilAttachment:u&&d?{attachment:d,depthLoadValue:i?this.clearDepthValue:qt.Ws.Load,depthStoreOp:qt.EG.Store,stencilLoadValue:a?this.clearStencilValue:qt.Ws.Load,stencilStoreOp:qt.EG.Store}:void 0});this.currentRenderPass=h,this.cachedViewport&&this.viewport(this.cachedViewport)}},{key:"endMainRenderPass",value:function(){this.currentRenderPass===this.mainRenderPass&&this.currentRenderPass!==null&&(this.currentRenderPass.endPass(),this.resetCachedViewport(),this.currentRenderPass=null,this.mainRenderPass=null)}},{key:"endComputePass",value:function(){this.currentComputePass&&(this.currentComputePass.endPass(),this.currentComputePass=null)}},{key:"endRenderTargetRenderPass",value:function(){this.currentRenderPass&&(this.currentRenderPass.endPass(),this.resetCachedViewport())}},{key:"resetCachedViewport",value:function(){this.cachedViewport={x:0,y:0,width:0,height:0}}},{key:"unbindFramebuffer",value:function(t){this.currentRenderPass&&this.currentRenderPass!==this.mainRenderPass&&this.endRenderTargetRenderPass(),this.transientViewport.x=Infinity,this.currentRenderTarget=null,this.currentRenderPass=this.mainRenderPass}}]),r}(),B3))||F3),z3,U3;function iX(r){var e=oX();return function(){var n=(0,li.Z)(r),i;if(e){var o=(0,li.Z)(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return(0,ds.Z)(this,i)}}function oX(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var Kw=4/64,V3=1-Kw*2,sX=(z3=(0,R.b2)(),z3(U3=function(r){(0,us.Z)(t,r);var e=iX(t);function t(){return(0,Sn.Z)(this,t),e.apply(this,arguments)}return(0,Hn.Z)(t,[{key:"onEntityCreated",value:function(){var i=this.config,o=i.widthSegments,s=o===void 0?1:o,a=i.heightSegments,l=a===void 0?1:a,c=i.depthSegments,u=c===void 0?1:c,d=i.halfExtents,h=d===void 0?Xe.fromValues(.5,.5,.5):d,f=s,p=l,g=u,v=(0,I0.Z)(h,3),y=v[0],x=v[1],E=v[2],T=[Xe.fromValues(-y,-x,E),Xe.fromValues(y,-x,E),Xe.fromValues(y,x,E),Xe.fromValues(-y,x,E),Xe.fromValues(y,-x,-E),Xe.fromValues(-y,-x,-E),Xe.fromValues(-y,x,-E),Xe.fromValues(y,x,-E)],P=[[0,1,3],[4,5,7],[3,2,6],[1,0,4],[1,4,2],[5,0,6]],z=[[0,0,1],[0,0,-1],[0,1,0],[0,-1,0],[1,0,0],[-1,0,0]],$={FRONT:0,BACK:1,TOP:2,BOTTOM:3,RIGHT:4,LEFT:5},ne=[],De=[],fe=[],Ae=[],de=[],ct=0,bt=function(tn,Bn,cr){var gn,si,xi,Nt;for(xi=0;xi<=Bn;xi++)for(Nt=0;Nt<=cr;Nt++){var fn=Xe.create(),Kn=Xe.create(),Pn=Xe.create(),vr=Xe.create();Xe.lerp(fn,T[P[tn][0]],T[P[tn][1]],xi/Bn),Xe.lerp(Kn,T[P[tn][0]],T[P[tn][2]],Nt/cr),Xe.sub(Pn,Kn,T[P[tn][0]]),Xe.add(vr,fn,Pn),gn=xi/Bn,si=Nt/cr,ne.push(vr[0],vr[1],vr[2]),De.push(z[tn][0],z[tn][1],z[tn][2]),fe.push(gn,si),gn/=3,si/=3,gn=gn*V3+Kw,si=si*V3+Kw,gn+=tn%3/3,si+=Math.floor(tn/3)/3,Ae.push(gn,si),xi<Bn&&Nt<cr&&(de.push(ct+cr+1,ct+1,ct),de.push(ct+cr+1,ct+cr+2,ct+1)),ct++}};bt($.FRONT,f,p),bt($.BACK,f,p),bt($.TOP,f,g),bt($.BOTTOM,f,g),bt($.RIGHT,g,p),bt($.LEFT,g,p);var Pe=zw(ne),tt=this.getComponent();tt.indices=Uint32Array.from(de),tt.aabb=Pe,tt.vertexCount=ct,tt.attributes=[{dirty:!0,name:"position",data:Float32Array.from(ne),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(De),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(fe),arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),t}(Au))||U3);function aX(r,e){if(!r&&!e)throw new Error("Please specify valid arguments for parameters a and b.");if(!e||e.length===0)return r;if(!r||r.length===0)return e;if(Object.prototype.toString.call(r)!==Object.prototype.toString.call(e))throw new Error("The types of the two arguments passed for parameters a and b do not match.");var t=new r.constructor(r.length+e.length);return t.set(r),t.set(e,r.length),t}var j3,H3;function lX(r){var e=cX();return function(){var n=(0,li.Z)(r),i;if(e){var o=(0,li.Z)(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return(0,ds.Z)(this,i)}}function cX(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var uX=(j3=(0,R.b2)(),j3(H3=function(r){(0,us.Z)(t,r);var e=lX(t);function t(){return(0,Sn.Z)(this,t),e.apply(this,arguments)}return(0,Hn.Z)(t,[{key:"onEntityCreated",value:function(){var i=this.config.geometries,o=i===void 0?[]:i,s=this.getComponent();s.aabb=new Nw;var a=[],l=[],c=0;o.forEach(function(u){var d=u.aabb,h=u.indices,f=u.vertexCount,p=u.attributes;s.aabb.add(d),s.vertexCount+=f,h&&l.push.apply(l,(0,wo.Z)(h.map(function(g){return g+c}))),c+=f,p.forEach(function(g,v){a[v]?g.data&&(Uw(g.data)?a[v].push(g.data):ZD(g.data)?a[v].data=aX(a[v].data,g.data):a[v].data=a[v].data.concat(g.data)):(a[v]=g,a[v].dirty=!0)})}),s.attributes=a,s.indices=Uint32Array.from(l),s.dirty=!0}}]),t}(Au))||H3),$3,W3;function dX(r){var e=hX();return function(){var n=(0,li.Z)(r),i;if(e){var o=(0,li.Z)(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return(0,ds.Z)(this,i)}}function hX(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var fX=($3=(0,R.b2)(),$3(W3=function(r){(0,us.Z)(t,r);var e=dX(t);function t(){return(0,Sn.Z)(this,t),e.apply(this,arguments)}return(0,Hn.Z)(t,[{key:"onEntityCreated",value:function(){for(var i=this.config,o=i.halfExtents,s=o===void 0?[.5,.5]:o,a=i.widthSegments,l=a===void 0?5:a,c=i.lengthSegments,u=c===void 0?5:c,d=[],h=[],f=[],p=[],g=0,v=0;v<=l;v++)for(var y=0;y<=u;y++){var x=-s[0]+2*s[0]*v/l,E=0,T=-(-s[1]+2*s[1]*y/u),P=v/l,z=y/u;d.push(x,E,T),h.push(0,1,0),f.push(P,z),v<l&&y<u&&(p.push(g+u+1,g+1,g),p.push(g+u+1,g+u+2,g+1)),g++}var $=zw(d),ne=this.getComponent();ne.indices=Uint32Array.from(p),ne.aabb=$,ne.vertexCount=g,ne.attributes=[{dirty:!0,name:"position",data:Float32Array.from(d),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(h),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(f),arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),t}(Au))||W3),Z3,X3;function pX(r){var e=gX();return function(){var n=(0,li.Z)(r),i;if(e){var o=(0,li.Z)(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return(0,ds.Z)(this,i)}}function gX(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var mX=(Z3=(0,R.b2)(),Z3(X3=function(r){(0,us.Z)(t,r);var e=pX(t);function t(){return(0,Sn.Z)(this,t),e.apply(this,arguments)}return(0,Hn.Z)(t,[{key:"onEntityCreated",value:function(){for(var i=this.config,o=i.radius,s=o===void 0?.5:o,a=i.latitudeBands,l=a===void 0?16:a,c=i.longitudeBands,u=c===void 0?16:c,d=[],h=[],f=[],p=[],g=0;g<=l;g++)for(var v=g*Math.PI/l,y=Math.sin(v),x=Math.cos(v),E=0;E<=u;E++){var T=E*2*Math.PI/u-Math.PI/2,P=Math.sin(T),z=Math.cos(T),$=z*y,ne=x,De=P*y,fe=1-E/u,Ae=1-g/l;d.push($*s,ne*s,De*s),h.push($,ne,De),f.push(fe,Ae)}for(var de=0;de<l;++de)for(var ct=0;ct<u;++ct){var bt=de*(u+1)+ct,Pe=bt+u+1;p.push(bt+1,Pe,bt),p.push(bt+1,Pe+1,Pe)}var tt=zw(d),Kt=this.getComponent();Kt.indices=Uint32Array.from(p),Kt.aabb=tt,Kt.vertexCount=d.length/3,Kt.attributes=[{dirty:!0,name:"position",data:Float32Array.from(d),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(h),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(f),arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),t}(Au))||X3),Y3,K3,q3,J3,Hb,Q3,eN,tN;function vX(r){var e=yX();return function(){var n=(0,li.Z)(r),i;if(e){var o=(0,li.Z)(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return(0,ds.Z)(this,i)}}function yX(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var bX=`varying vec4 fragColor;

#pragma include "uv.frag.declaration"
#pragma include "map.frag.declaration"

void main() {
  vec4 diffuseColor = fragColor;

  #pragma include "map.frag.main"

  gl_FragColor = diffuseColor;
}`,xX=`attribute vec3 position;
attribute vec3 normal;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;
uniform vec4 color;

varying vec4 fragColor;

#pragma include "uv.vert.declaration"

void main() {
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  fragColor = color;

  #pragma include "uv.vert.main"
}`,CX=`// layout(set = 0, binding = 1) uniform WireframeUniforms {
//   float lineWidth;
//   vec4 lineColor;
// } wireframe;

layout(location = 0) in vec4 fragColor;
// layout(location = 1) in vec3 v_Barycentric;

layout(location = 0) out vec4 outColor;

// wireframe
// float edgeFactor() {
//   vec3 d = fwidth(v_Barycentric);
//   vec3 a3 = smoothstep(vec3(0.0), d * wireframe.lineWidth, v_Barycentric);
//   return min(min(a3.x, a3.y), a3.z);
// }

void main() {
  // outColor = mix(fragColor, wireframe.lineColor, (1.0 - edgeFactor()));
  outColor = fragColor;
}`,wX=`layout(set = 0, binding = 0) uniform Uniforms {
  vec4 color;
  mat4 projectionMatrix;
  mat4 modelViewMatrix;
} uniforms;

layout(location = 0) in vec3 position;
// layout(location = 1) in vec3 barycentric;

layout(location = 0) out vec4 fragColor;
// layout(location = 1) out vec3 v_Barycentric;

void main() {
  gl_Position = uniforms.projectionMatrix * uniforms.modelViewMatrix * vec4(position, 1.0);
  fragColor = uniforms.color;
  // v_Barycentric = barycentric;
}`,EX=(Y3=(0,R.b2)(),K3=(0,R.f3)(Ct.RenderEngine),q3=(0,R.f3)(Ct.ShaderModuleService),Y3(J3=(Hb=(tN=function(r){(0,us.Z)(t,r);var e=vX(t);function t(){var n;(0,Sn.Z)(this,t);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=e.call.apply(e,[this].concat(o)),(0,In.Z)(n,"engine",Q3,(0,co.Z)(n)),(0,In.Z)(n,"shaderModuleService",eN,(0,co.Z)(n)),n}return(0,Hn.Z)(t,[{key:"onEntityCreated",value:function(){var i=this.getComponent(),o=this.engine.supportWebGPU?wX:xX,s=this.engine.supportWebGPU?CX:bX;this.shaderModuleService.registerModule("material-basic",{vs:o,fs:s});var a=this.shaderModuleService.getModule("material-basic"),l=a.vs,c=a.fs,u=a.uniforms;i.vertexShaderGLSL=l,i.fragmentShaderGLSL=c,i.setUniform(u),this.config.map&&(i.setDefines({USE_UV:1,USE_MAP:1}),i.setUniform({map:this.config.map,uvTransform:eh.Ue()}))}}]),t}(u3),tN),Q3=(0,Ln.Z)(Hb.prototype,"engine",[K3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eN=(0,Ln.Z)(Hb.prototype,"shaderModuleService",[q3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hb))||J3),nN,rN,iN,oN,sN,aN,lN,Z0,cN,uN,dN,hN;function SX(r){var e=_X();return function(){var n=(0,li.Z)(r),i;if(e){var o=(0,li.Z)(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return(0,ds.Z)(this,i)}}function _X(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var AX=`// generate grid, borrow from clay.gl viewer
// @see https://github.com/pissang/clay-viewer/blob/master/src/graphic/ground.glsl
#extension GL_OES_standard_derivatives : enable

varying vec3 v_Position;
// varying vec3 v_Normal;

uniform float u_GridSize : 5;
uniform float u_GridSize2 : .5;
uniform vec4 u_GridColor : [0, 0, 0, 1];
uniform vec4 u_GridColor2 : [0.3, 0.3, 0.3, 1];
uniform bool u_GridEnabled : true;

// uniform vec3 u_LightDirection;
// uniform vec3 u_LightColor;
// uniform vec3 u_Camera;

void main() {
  // vec3 n = v_Normal;
  // vec3 l = normalize(u_LightDirection);
  // float NdotL = clamp(dot(n, l), 0.001, 1.0);

  gl_FragColor = vec4(1.);

  if (u_GridEnabled) {
    float wx = v_Position.x;
    float wz = v_Position.z;
    // float x0 = abs(fract(wx / u_GridSize - 0.5) - 0.5) / fwidth(wx) * u_GridSize / 2.0;
    // float z0 = abs(fract(wz / u_GridSize - 0.5) - 0.5) / fwidth(wz) * u_GridSize / 2.0;

    float x1 = abs(fract(wx / u_GridSize2 - 0.5) - 0.5) / fwidth(wx) * u_GridSize2;
    float z1 = abs(fract(wz / u_GridSize2 - 0.5) - 0.5) / fwidth(wz) * u_GridSize2;

    // float v0 = 1.0 - clamp(min(x0, z0), 0.0, 1.0);
    float v1 = 1.0 - clamp(min(x1, z1), 0.0, 1.0);
    // if (v0 > 0.1) {
        // gl_FragColor = mix(gl_FragColor, u_GridColor, v0);
    // }
    // else {
        gl_FragColor = mix(gl_FragColor, u_GridColor2, v1);
    // }
  }

  // float shadowFactor = calcShadow(u_ShadowMap, v_PositionFromLight, l, n);
  // vec3 diffuseColor = u_LightColor * NdotL * shadowFactor;

  // gl_FragColor.rgb *= diffuseColor;
}`,TX=`attribute vec3 a_Position;

varying vec3 v_Position;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;

void main() {
  v_Position = a_Position;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_Position, 1.);
}`,MX=(nN=(0,R.b2)(),rN=(0,R.f3)(Ct.Systems),iN=(0,R.t6)(Ct.MaterialSystem),oN=(0,R.f3)(Ct.Systems),sN=(0,R.t6)(Ct.GeometrySystem),aN=(0,R.f3)(Ct.ShaderModuleService),nN(lN=(Z0=(hN=function(r){(0,us.Z)(t,r);var e=SX(t);function t(){var n;(0,Sn.Z)(this,t);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=e.call.apply(e,[this].concat(o)),(0,In.Z)(n,"materialSystem",cN,(0,co.Z)(n)),(0,In.Z)(n,"geometrySystem",uN,(0,co.Z)(n)),(0,In.Z)(n,"shaderModuleService",dN,(0,co.Z)(n)),n}return(0,Hn.Z)(t,[{key:"onAttributeChanged",value:function(i){var o=i.name,s=i.data,a=this.getMeshComponent();a&&a.material&&(o==="gridColor"?(a.material.setUniform("u_GridColor",s),a.material.setUniform("u_GridColor2",s)):o==="gridSize"&&(a.material.setUniform("u_GridSize",s),a.material.setUniform("u_GridSize2",s)))}},{key:"onEntityCreated",value:function(){this.shaderModuleService.registerModule("grid",{vs:TX,fs:AX});var i=this.shaderModuleService.getModule("grid"),o=i.vs,s=i.fs,a=i.uniforms,l=this.materialSystem.createShaderMaterial({vertexShader:o,fragmentShader:s});this.setMaterial(l);var c=this.geometrySystem.createBufferGeometry({vertexCount:4});this.setGeometry(c),l.setCull({enable:!1,face:Fe.BACK}).setDepth({enable:!0,func:Fe.LESS}),l.setUniform(a),this.setAttributes({gridColor:this.config.gridColor,gridSize:this.config.gridSize}),c.setIndex([0,3,2,2,1,0]),c.setAttribute("a_Position",Float32Array.from([-4,-1,-4,4,-1,-4,4,-1,4,-4,-1,4]),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]})}}]),t}(Tu),hN),cN=(0,Ln.Z)(Z0.prototype,"materialSystem",[rN,iN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uN=(0,Ln.Z)(Z0.prototype,"geometrySystem",[oN,sN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dN=(0,Ln.Z)(Z0.prototype,"shaderModuleService",[aN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z0))||lN),$b=w(32644),ch=w(40582);function Wb(r,e,t,n,i){X0(e,n,-i),X0(e,n,i),r.push(t),r.push(t)}function X0(r,e,t){r.push([[e[0],e[1]],t])}function PX(r,e,t){var n=[0,0],i=[0,0],o=[0,0],s=[0,0],a=-1,l=!1,c=null,u=(0,$b.create)(),d=t||0,h=3,f=[],p=[],g=[],v=[0,0];e&&(r=r.slice(),r.push(r[0]));for(var y=r.length,x=1;x<y;x++){var E=d,T=r[x-1],P=r[x],z=x<r.length-1?r[x+1]:null;if(v.push(x/y,x/y),(0,ch.o7)(n,P,T),c||(c=[0,0],(0,ch.mJ)(c,n)),l||(l=!0,Wb(p,f,T,c,1)),g.push([E+0,E+1,E+2]),!z)(0,ch.mJ)(c,n),Wb(p,f,P,c,1),g.push(a===1?[E,E+2,E+3]:[E+2,E+1,E+3]),d+=2;else{(0,ch.o7)(i,z,P);var $=(0,ch.x7)(o,s,n,i,1),ne=(0,$b.dot)(o,c)<0?-1:1,De=$>h;if(!isFinite($)){(0,ch.mJ)(c,n),Wb(p,f,P,c,1),g.push(a===1?[E,E+2,E+3]:[E+2,E+1,E+3]),d+=2,a=ne;continue}De?($=h,v.push(x/y),X0(f,c,-ne),p.push(P),X0(f,s,$*ne),p.push(P),g.push(a!==-ne?[E,E+2,E+3]:[E+2,E+1,E+3]),g.push([E+2,E+3,E+4]),(0,ch.mJ)(u,i),(0,$b.copy)(c,u),X0(f,c,-ne),p.push(P),d+=3):(Wb(p,f,P,s,$),g.push(a===1?[E,E+2,E+3]:[E+2,E+1,E+3]),ne=-1,(0,$b.copy)(c,s),d+=2),a=ne}}return{normals:f,attrIndex:g,attrPos:p,attrCounters:v}}var fN,pN,gN,mN,vN,yN,bN,Y0,xN,CN,wN,EN;function OX(r){var e=DX();return function(){var n=(0,li.Z)(r),i;if(e){var o=(0,li.Z)(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return(0,ds.Z)(this,i)}}function DX(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var NX=`uniform float u_dash_array : 0.02;
uniform float u_dash_offset : 0;
uniform float u_dash_ratio : 0;
uniform float u_thickness : 0.02;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_counters;

void main() {
    float blur = 1. - smoothstep(0.98, 1., length(v_normal));

    gl_FragColor = v_color;
    gl_FragColor.a *= blur * ceil(mod(v_counters + u_dash_offset, u_dash_array) - (u_dash_array * u_dash_ratio));
}`,RX=`attribute vec2 a_pos;
attribute vec4 a_color;
attribute float a_line_miter;
attribute vec2 a_line_normal;
attribute float a_counters;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;
uniform float u_thickness : 0.02;
uniform vec2 u_viewport;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_counters;

void main() {
  v_color = a_color;
  v_counters = a_counters;

  vec3 normal = normalize(vec3(a_line_normal, 0.0));

  vec4 offset = vec4(normal * u_thickness / 2.0 * a_line_miter, 0.0);

  v_normal = vec2(normal * sign(a_line_miter));

  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_pos, 0.0, 1.0) + offset;
}
`,kX=(fN=(0,R.b2)(),pN=(0,R.f3)(Ct.Systems),gN=(0,R.t6)(Ct.MaterialSystem),mN=(0,R.f3)(Ct.Systems),vN=(0,R.t6)(Ct.GeometrySystem),yN=(0,R.f3)(Ct.ShaderModuleService),fN(bN=(Y0=(EN=function(r){(0,us.Z)(t,r);var e=OX(t);function t(){var n;(0,Sn.Z)(this,t);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=e.call.apply(e,[this].concat(o)),(0,In.Z)(n,"materialSystem",xN,(0,co.Z)(n)),(0,In.Z)(n,"geometrySystem",CN,(0,co.Z)(n)),(0,In.Z)(n,"shaderModuleService",wN,(0,co.Z)(n)),n.vertexCount=void 0,n}return(0,Hn.Z)(t,[{key:"onAttributeChanged",value:function(i){var o=i.name,s=i.data,a=this.getMeshComponent();if(a&&a.material)switch(o){case"dashArray":a.material.setUniform("u_dash_array",s);break;case"dashOffset":a.material.setUniform("u_dash_offset",s);break;case"dashRatio":a.material.setUniform("u_dash_ratio",s);break;case"thickness":a.material.setUniform("u_thickness",s);break;case"color":var l=new Array(this.vertexCount).fill(void 0).map(function(){return s}).reduce(function(c,u){return[].concat((0,wo.Z)(c),(0,wo.Z)(u))},[]);a.geometry.setAttribute("a_color",Float32Array.from(l),{arrayStride:4*4,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float4"}]});break}}},{key:"onEntityCreated",value:function(){var i=this;this.shaderModuleService.registerModule("line",{vs:RX,fs:NX});var o=this.shaderModuleService.getModule("line"),s=o.vs,a=o.fs,l=o.uniforms,c=this.materialSystem.createShaderMaterial({vertexShader:s,fragmentShader:a}),u=PX(this.config.points,!1),d=u.normals,h=u.attrIndex,f=u.attrPos,p=u.attrCounters,g=f.length;this.vertexCount=g;var v=this.geometrySystem.createBufferGeometry({vertexCount:g});this.setMaterial(c),this.setGeometry(v),c.setCull({enable:!1,face:Fe.BACK}).setUniform(l),this.setAttributes({dashArray:this.config.dashArray,dashOffset:this.config.dashOffset,dashRatio:this.config.dashRatio,thickness:this.config.thickness});var y=[],x=[];d.forEach(function(T){var P=T[0],z=T[1];y.push([P[0],P[1]]),x.push(z)}),v.setIndex(h.reduce(function(T,P){return[].concat((0,wo.Z)(T),(0,wo.Z)(P))},[])),v.setAttribute("a_pos",Float32Array.from(f.reduce(function(T,P){return[].concat((0,wo.Z)(T),(0,wo.Z)(P))},[])),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]});var E=new Array(g).fill(void 0).map(function(){return(0,wo.Z)(i.config.color)}).reduce(function(T,P){return[].concat((0,wo.Z)(T),(0,wo.Z)(P))},[]);v.setAttribute("a_color",Float32Array.from(E),{arrayStride:4*4,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float4"}]}),v.setAttribute("a_line_miter",Float32Array.from(x),{arrayStride:4*1,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float"}]}),v.setAttribute("a_line_normal",Float32Array.from(y.reduce(function(T,P){return[].concat((0,wo.Z)(T),(0,wo.Z)(P))},[])),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:3,offset:0,format:"float2"}]}),v.setAttribute("a_counters",Float32Array.from(p),{arrayStride:4*1,stepMode:"vertex",attributes:[{shaderLocation:4,offset:0,format:"float"}]})}}]),t}(Tu),EN),xN=(0,Ln.Z)(Y0.prototype,"materialSystem",[pN,gN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CN=(0,Ln.Z)(Y0.prototype,"geometrySystem",[mN,vN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wN=(0,Ln.Z)(Y0.prototype,"shaderModuleService",[yN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y0))||bN);function IX(r){return[r+1&255,r+1>>8&255,r+1>>8>>8&255]}var SN,_N,AN,TN,MN,PN,ON,K0,DN,NN,RN,kN;function IN(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function LX(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?IN(Object(t),!0).forEach(function(n){(0,it.Z)(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):IN(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function GX(r){var e=FX();return function(){var n=(0,li.Z)(r),i;if(e){var o=(0,li.Z)(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return(0,ds.Z)(this,i)}}function FX(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var BX=`uniform float u_blur : 0.05;
uniform float u_opacity : 0.7;
uniform float u_stroke_width : 0.01;
uniform vec4 u_stroke_color : [0, 0, 0, 0];
uniform float u_stroke_opacity : 1;

varying vec4 v_color;
varying vec4 v_data;
varying float v_radius;

#pragma include "sdf2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  float antialiasblur = v_data.z;
  float antialiased_blur = -max(u_blur, antialiasblur);
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  // if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  // } else if (shape == 1) {
  //   outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
  //   inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  // } else if (shape == 2) {
  //   outer_df = sdBox(v_data.xy, vec2(1.));
  //   inner_df = sdBox(v_data.xy, vec2(r));
  // } else if (shape == 3) {
  //   outer_df = sdPentagon(v_data.xy, 0.8);
  //   inner_df = sdPentagon(v_data.xy, r * 0.8);
  // } else if (shape == 4) {
  //   outer_df = sdHexagon(v_data.xy, 0.8);
  //   inner_df = sdHexagon(v_data.xy, r * 0.8);
  // } else if (shape == 5) {
  //   outer_df = sdOctogon(v_data.xy, 1.0);
  //   inner_df = sdOctogon(v_data.xy, r);
  // } else if (shape == 6) {
  //   outer_df = sdHexagram(v_data.xy, 0.52);
  //   inner_df = sdHexagram(v_data.xy, r * 0.52);
  // } else if (shape == 7) {
  //   outer_df = sdRhombus(v_data.xy, vec2(1.0));
  //   inner_df = sdRhombus(v_data.xy, vec2(r));
  // } else if (shape == 8) {
  //   outer_df = sdVesica(v_data.xy, 1.1, 0.8);
  //   inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  // }

  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiased_blur,
    0.0,
    inner_df
  );
  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;

  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor.a = gl_FragColor.a * opacity_t;

  gl_FragColor = filterColor(gl_FragColor);
}`,zX=`attribute vec2 position;
attribute vec4 color;
attribute float shape;
attribute vec2 offset;
attribute float size;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;

uniform float u_stroke_width : 0.01;
uniform float u_device_pixel_ratio;
uniform vec2 u_viewport;

varying vec4 v_color;
varying vec4 v_data;
varying float v_radius;

#pragma include "picking"

void main() {
  v_color = color;
  v_radius = size;

  lowp float antialiasblur = 1.0 / u_device_pixel_ratio * (size + u_stroke_width);

  // construct point coords
  v_data = vec4(position, antialiasblur, shape);

  gl_Position = projectionMatrix * modelViewMatrix
    * vec4(position * size + offset, 0.0, 1.0);

  setPickingColor(a_PickingColor);
}`,UX=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],VX=(SN=(0,R.b2)(),_N=(0,R.f3)(Ct.Systems),AN=(0,R.t6)(Ct.MaterialSystem),TN=(0,R.f3)(Ct.Systems),MN=(0,R.t6)(Ct.GeometrySystem),PN=(0,R.f3)(Ct.ShaderModuleService),SN(ON=(K0=(kN=function(r){(0,us.Z)(t,r);var e=GX(t);function t(){var n;(0,Sn.Z)(this,t);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=e.call.apply(e,[this].concat(o)),(0,In.Z)(n,"materialSystem",DN,(0,co.Z)(n)),(0,In.Z)(n,"geometrySystem",NN,(0,co.Z)(n)),(0,In.Z)(n,"shaderModuleService",RN,(0,co.Z)(n)),n}return(0,Hn.Z)(t,[{key:"onAttributeChanged",value:function(i){var o=i.name,s=i.data,a=this.getMeshComponent();a&&a.material&&(o==="strokeWidth"?a.material.setUniform("u_stroke_width",s):o==="strokeColor"?a.material.setUniform("u_stroke_color",s):o==="strokeOpacity"?a.material.setUniform("u_stroke_opacity",s):o==="opacity"?a.material.setUniform("u_opacity",s):o==="blur"&&a.material.setUniform("u_blur",s))}},{key:"onEntityCreated",value:function(){this.shaderModuleService.registerModule("grid",{vs:zX,fs:BX});var i=this.shaderModuleService.getModule("grid"),o=i.vs,s=i.fs,a=i.uniforms,l=this.materialSystem.createShaderMaterial({vertexShader:o,fragmentShader:s,cull:{enable:!1},depth:{enable:!1},blend:{enable:!0,func:{srcRGB:Fe.SRC_ALPHA,dstRGB:Fe.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}});l.setUniform(LX({u_device_pixel_ratio:window.devicePixelRatio},a));var c=this.buildAttributes(),u=this.geometrySystem.createInstancedBufferGeometry({maxInstancedCount:c.instancedOffsets.length/2,vertexCount:6});u.setIndex([0,2,1,0,3,2]),u.setAttribute("position",Float32Array.from(c.positions),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]}),u.setAttribute("offset",Float32Array.from(c.instancedOffsets),{arrayStride:4*2,stepMode:"instance",attributes:[{shaderLocation:1,offset:0,format:"float2"}]}),u.setAttribute("color",Float32Array.from(c.instancedColors),{arrayStride:4*4,stepMode:"instance",attributes:[{shaderLocation:2,offset:0,format:"float4"}]}),u.setAttribute("size",Float32Array.from(c.instancedSizes),{arrayStride:4,stepMode:"instance",attributes:[{shaderLocation:3,offset:0,format:"float"}]}),u.setAttribute("shape",Float32Array.from(c.instancedShapes),{arrayStride:4,stepMode:"instance",attributes:[{shaderLocation:4,offset:0,format:"float"}]}),u.setAttribute("a_PickingColor",Float32Array.from(c.instancedPickingColors),{arrayStride:4*3,stepMode:"instance",attributes:[{shaderLocation:6,offset:0,format:"float3"}]}),this.setMaterial(l),this.setGeometry(u)}},{key:"buildAttribute",value:function(i,o,s){var a,l,c,u;(a=o.instancedPickingColors).push.apply(a,(0,wo.Z)(IX(i.id||s))),o.instancedShapes.push(UX.indexOf(i.shape||"circle")),(l=o.instancedColors).push.apply(l,(0,wo.Z)(i.color||[1,0,0,1])),(c=o.instancedOffsets).push.apply(c,(0,wo.Z)(i.position||[0,0])),(u=o.instancedSizes).push.apply(u,(0,wo.Z)(i.size||[.2,.2]))}},{key:"buildAttributes",value:function(){var i=this,o={positions:[1,1,1,-1,-1,-1,-1,1],instancedOffsets:[],instancedColors:[],instancedSizes:[],instancedShapes:[],instancedPickingColors:[]};return Array.isArray(this.config)?this.config.forEach(function(s,a){i.buildAttribute(s,o,a)}):this.buildAttribute(this.config,o,0),o}}]),t}(Tu),kN),DN=(0,Ln.Z)(K0.prototype,"materialSystem",[_N,AN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NN=(0,Ln.Z)(K0.prototype,"geometrySystem",[TN,MN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RN=(0,Ln.Z)(K0.prototype,"shaderModuleService",[PN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K0))||ON),LN,GN,FN,BN,zN,q0,UN,VN,jN,HN;function $N(r,e){var t;if(typeof Symbol=="undefined"||r[Symbol.iterator]==null){if(Array.isArray(r)||(t=jX(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,s=!1,a;return{s:function(){t=r[Symbol.iterator]()},n:function(){var c=t.next();return o=c.done,c},e:function(c){s=!0,a=c},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(s)throw a}}}}function jX(r,e){if(!!r){if(typeof r=="string")return WN(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return WN(r,e)}}function WN(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var HX=`#ifdef USE_MAP
  uniform sampler2D map;
#endif`,$X=`#ifdef USE_MAP
  vec4 texelColor = texture2D(map, vUv);
  // texelColor = mapTexelToLinear(texelColor);
  diffuseColor *= texelColor;
#endif`,WX=`#if (defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ))
  varying vec2 vUv;
#endif`,ZX=`#ifdef USE_UV
  attribute vec2 uv;
	#ifdef UVS_VERTEX_ONLY
    vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,XX=`#ifdef USE_UV
  vUv = (uvTransform * vec3(uv, 1)).xy;
#endif`,ZN=(LN=(0,R.b2)(),GN=(0,R.f3)(Ct.RenderEngine),FN=(0,R.f3)(Ct.ShaderModuleService),BN=(0,R.f3)(Ct.ConfigService),LN(zN=(q0=(HN=function(){function r(){(0,Sn.Z)(this,r),this.container=void 0,(0,In.Z)(this,"engine",UN,this),(0,In.Z)(this,"shaderModule",VN,this),(0,In.Z)(this,"configService",jN,this),this.inited=!1,this.rendering=!1,this.pendings=[],this.views=[],this.size=void 0}return(0,Hn.Z)(r,[{key:"init",value:function(){var e=(0,Yr.Z)(yn().mark(function n(){var i,o,s,a,l;return yn().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.shaderModule.registerBuiltinModules(),this.shaderModule.registerModule("uv.vert.declaration",{vs:ZX}),this.shaderModule.registerModule("uv.vert.main",{vs:XX}),this.shaderModule.registerModule("uv.frag.declaration",{fs:WX}),this.shaderModule.registerModule("map.frag.declaration",{fs:HX}),this.shaderModule.registerModule("map.frag.main",{fs:$X}),i=this.container.getAll(Ct.Systems),o=this.configService.get(),!o.canvas){u.next=30;break}return u.next=11,this.engine.init({canvas:o.canvas,swapChainFormat:qt.EV.BGRA8Unorm,antialiasing:!1});case 11:s=$N(i),u.prev=12,s.s();case 14:if((a=s.n()).done){u.next=21;break}if(l=a.value,!l.initialize){u.next=19;break}return u.next=19,l.initialize();case 19:u.next=14;break;case 21:u.next=26;break;case 23:u.prev=23,u.t0=u.catch(12),s.e(u.t0);case 26:return u.prev=26,s.f(),u.finish(26);case 29:this.inited=!0;case 30:case"end":return u.stop()}},n,this,[[12,23,26,29]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"render",value:function(){var e=(0,Yr.Z)(yn().mark(function n(){var i,o,s,a,l,c,u,d=arguments;return yn().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(!this.inited||this.rendering)){f.next=2;break}return f.abrupt("return");case 2:for(this.pendings.length&&this.pendings.forEach(function(p){p()}),this.rendering=!0,this.engine.beginFrame(),i=this.container.getAll(Ct.Systems),o=d.length,s=new Array(o),a=0;a<o;a++)s[a]=d[a];l=$N(i),f.prev=8,l.s();case 10:if((c=l.n()).done){f.next=17;break}if(u=c.value,!u.execute){f.next=15;break}return f.next=15,u.execute(s);case 15:f.next=10;break;case 17:f.next=22;break;case 19:f.prev=19,f.t0=f.catch(8),l.e(f.t0);case 22:return f.prev=22,l.f(),f.finish(22);case 25:this.engine.endFrame(),this.rendering=!1;case 27:case"end":return f.stop()}},n,this,[[8,19,22,25]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"clear",value:function(t){var n=this;return this.inited?this.engine.clear(t):this.pendings.unshift(function(){n.engine.clear(t),n.pendings.shift()}),this}},{key:"setSize",value:function(t){var n=t.width,i=t.height,o=this.engine.getCanvas();return this.size={width:n,height:i},o.width=n,o.height=i,this}},{key:"getSize",value:function(){return this.size}}]),r}(),HN),UN=(0,Ln.Z)(q0.prototype,"engine",[GN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VN=(0,Ln.Z)(q0.prototype,"shaderModule",[FN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jN=(0,Ln.Z)(q0.prototype,"configService",[BN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q0))||zN),XN,YN,KN,qN=(XN=(0,R.b2)(),XN(YN=(KN=function(){function r(){(0,Sn.Z)(this,r),this.entities=[]}return(0,Hn.Z)(r,[{key:"getEntities",value:function(){return this.entities}},{key:"addRenderable",value:function(t){return this.addEntity(t.getEntity()),this}},{key:"removeRenderable",value:function(t){return this.removeEntity(t.getEntity()),this}},{key:"addLight",value:function(){}},{key:"addEntity",value:function(t){return this.entities.indexOf(t)===-1&&this.entities.push(t),this}},{key:"removeEntity",value:function(t){var n=this.entities.indexOf(t);return this.entities.splice(n,1),this}}]),r}(),KN))||YN),JN,QN,eR,tR=(JN=(0,R.b2)(),JN(QN=(eR=function(){function r(){(0,Sn.Z)(this,r),this.cache={}}return(0,Hn.Z)(r,[{key:"get",value:function(t){return this.cache[t]}},{key:"set",value:function(t,n){this.cache[t]=n}}]),r}(),eR))||QN),nR,rR,iR,oR,Zb,sR,aR,lR;function cR(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function uR(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?cR(Object(t),!0).forEach(function(n){(0,it.Z)(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):cR(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var dR=(nR=(0,R.b2)(),rR=(0,R.f3)(tR),iR=(0,R.f3)(Ct.RenderEngine),nR(oR=(Zb=(lR=function(){function r(){(0,Sn.Z)(this,r),(0,In.Z)(this,"textureCache",sR,this),(0,In.Z)(this,"engine",aR,this),this.config=void 0,this.loaded=!1,this.texture=void 0}return(0,Hn.Z)(r,[{key:"setConfig",value:function(t){this.config=t}},{key:"isLoaded",value:function(){return this.loaded}},{key:"load",value:function(){var e=(0,Yr.Z)(yn().mark(function n(){var i=this;return yn().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this.config.url){s.next=4;break}return s.abrupt("return",new Promise(function(a,l){var c=i.textureCache.get(i.config.url);if(c)a(c);else{var u=new Image;u.crossOrigin="Anonymous",u.src=i.config.url,u.onload=function(){var d=i.engine.createTexture2D(uR(uR({},i.config),{},{data:u,width:u.width,height:u.height,flipY:!0}));i.textureCache.set(i.config.url,d),i.texture=d,i.loaded=!0,a(d)},u.onerror=function(){l()}}}));case 4:return this.loaded=!0,this.texture=this.engine.createTexture2D(this.config),s.abrupt("return",this.texture);case 7:case"end":return s.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()}]),r}(),lR),sR=(0,Ln.Z)(Zb.prototype,"textureCache",[rR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aR=(0,Ln.Z)(Zb.prototype,"engine",[iR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zb))||oR),hR,fR,pR,gR,qw,mR,vR,yR=(hR=(0,R.b2)(),fR=(0,R.f3)(Ct.Systems),pR=(0,R.t6)(Ct.RendererSystem),hR(gR=(qw=(vR=function(){function r(){(0,Sn.Z)(this,r),(0,In.Z)(this,"rendererSystem",mR,this),this.camera=void 0,this.scene=void 0,this.viewport={x:0,y:0,width:0,height:0},this.clearColor=[1,1,1,1]}return(0,Hn.Z)(r,[{key:"getCamera",value:function(){return this.camera}},{key:"getScene",value:function(){return this.scene}},{key:"getViewport",value:function(){return this.viewport}},{key:"getClearColor",value:function(){return this.clearColor}},{key:"setCamera",value:function(t){return this.camera=t,this}},{key:"setScene",value:function(t){return this.scene=t,this}},{key:"setViewport",value:function(t){return this.viewport=t,this}},{key:"setClearColor",value:function(t){return this.clearColor=t,this}},{key:"pick",value:function(t){return this.rendererSystem.pick(t,this)}}]),r}(),vR),mR=(0,Ln.Z)(qw.prototype,"rendererSystem",[fR,pR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qw))||gR),bR,xR,CR,Jw,wR,ER;function SR(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function YX(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?SR(Object(t),!0).forEach(function(n){(0,it.Z)(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):SR(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var Xb=(bR=(0,R.b2)(),xR=(0,R.f3)(Ct.ConfigService),bR(CR=(Jw=(ER=function(){function r(){(0,Sn.Z)(this,r),(0,In.Z)(this,"configService",wR,this),this.container=void 0}return(0,Hn.Z)(r,[{key:"getEngine",value:function(){var e=(0,Yr.Z)(yn().mark(function n(){var i,o,s,a;return yn().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return i=this.container.get(Ct.RenderEngine),o=this.configService.get(),s=o.canvas,a=o.engineOptions,c.next=4,i.init(YX({canvas:s||WD(),swapChainFormat:qt.EV.BGRA8Unorm,antialiasing:!1},a));case 4:return c.abrupt("return",i);case 5:case"end":return c.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getTransformComponent",value:function(t){var n=this.container.get(Ct.TransformComponentManager);return n.getComponentByEntity(t)}},{key:"getMeshComponent",value:function(t){var n=this.container.get(Ct.MeshComponentManager);return n.getComponentByEntity(t)}},{key:"setConfig",value:function(t){this.configService.set(t)}},{key:"setContainer",value:function(t){this.container=t}},{key:"getContainer",value:function(){return this.container}},{key:"createEntity",value:function(){return Dl()}},{key:"createScene",value:function(){return this.container.get(qN)}},{key:"createCamera",value:function(){return this.container.get(zD)}},{key:"createView",value:function(){return this.container.get(yR)}},{key:"createRenderable",value:function(t,n){var i=t?this.container.getNamed(Ct.Renderable,t):this.container.get(Tu),o=Dl();return i.setConfig(n||{}),i.setEntity(o),i}},{key:"createGeometry",value:function(t,n){var i=this.container.getNamed(Ct.Geometry,t),o=Dl();return i.setConfig(n||{}),i.setEntity(o),i.getComponent()}},{key:"createMaterial",value:function(t,n){var i=this.container.getNamed(Ct.Material,t),o=Dl();return i.setConfig(n||{}),i.setEntity(o,t),i.getComponent()}},{key:"createTexture2D",value:function(t){var n=this.container.get(dR);return n.setConfig(t),n}},{key:"createBufferGeometry",value:function(t){var n=this.container.getNamed(Ct.Systems,Ct.GeometrySystem);return n.createBufferGeometry(t)}},{key:"createInstancedBufferGeometry",value:function(t){var n=this.container.getNamed(Ct.Systems,Ct.GeometrySystem);return n.createInstancedBufferGeometry(t)}},{key:"createShaderMaterial",value:function(t){var n=this.container.getNamed(Ct.Systems,Ct.MaterialSystem);return n.createShaderMaterial(t)}},{key:"createKernel",value:function(t){var n=this.container.get(r3);return typeof t=="string"?n.setBundle(JSON.parse(t)):n.setBundle(t),n.init(),n}},{key:"createRenderer",value:function(){var t=this.container.get(ZN);return t.container=this.container,t.init(),t}},{key:"destroy",value:function(){var t=this.container.getAll(Ct.Systems);t.forEach(function(o){o.tearDown&&o.tearDown()});var n=this.container.get(Ct.RenderEngine);n.destroy();var i=this.container.get(Ct.InteractorService);i.destroy()}}],[{key:"create",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=lW(),i=navigator.gpu?rX:FZ;n.isBound(Ct.RenderEngine)||n.bind(Ct.RenderEngine).to(i).inSingletonScope(),n.bind(ZN).toSelf(),n.bind(r3).toSelf(),n.bind(Tu).toSelf(),n.bind(yR).toSelf(),n.bind(zD).toSelf(),n.bind(qN).toSelf(),n.bind(r).toSelf(),n.bind(tR).toSelf(),n.bind(dR).toSelf(),n.bind(Ct.Geometry).to(sX).whenTargetNamed(Au.BOX),n.bind(Ct.Geometry).to(mX).whenTargetNamed(Au.SPHERE),n.bind(Ct.Geometry).to(fX).whenTargetNamed(Au.PLANE),n.bind(Ct.Geometry).to(uX).whenTargetNamed(Au.MERGED),n.bind(Ct.Material).to(EX).whenTargetNamed(u3.BASIC),n.bind(Ct.Renderable).to(VX).whenTargetNamed(Tu.POINT),n.bind(Ct.Renderable).to(kX).whenTargetNamed(Tu.LINE),n.bind(Ct.Renderable).to(MX).whenTargetNamed(Tu.GRID);var o=n.get(r);return o.setContainer(n),o.setConfig(t),o}}]),r}(),ER),wR=(0,Ln.Z)(Jw.prototype,"configService",[xR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jw))||CR);const dp=(r,e)=>{let t;return r?un(r)?t=()=>r:t=r:t=()=>e||1,t},KX=(r,e)=>{const t=[],n=[],i={};let o=0;for(o=0;o<r.length;o++){const a=r[o];i[a.id]=o,t.push(a.x),t.push(a.y),t.push(0),t.push(0),n.push([])}for(o=0;o<e.length;o++){const a=e[o],l=Xr(a,"source"),c=Xr(a,"target");n[i[l]].push(i[c]),n[i[c]].push(i[l])}let s=0;for(o=0;o<r.length;o++){const a=t.length,l=n[o],c=l.length;t[o*4+2]=a,t[o*4+3]=l.length,s=Math.max(s,l.length);for(let u=0;u<c;++u){const d=l[u];t.push(+d)}}for(;t.length%4!=0;)t.push(0);return{maxEdgePerVetex:s,array:new Float32Array(t)}},qX=(r,e,t,n)=>{const i=[],o=[],s={};let a=0;for(a=0;a<r.length;a++){const c=r[a];s[c.id]=a,i.push(c.x),i.push(c.y),i.push(0),i.push(0),o.push([])}for(a=0;a<e.length;a++){const c=e[a],u=Xr(c,"source"),d=Xr(c,"target");o[s[u]].push(s[d]),o[s[u]].push(t(c)),o[s[u]].push(n(c)),o[s[u]].push(0),o[s[d]].push(s[u]),o[s[d]].push(t(c)),o[s[d]].push(n(c)),o[s[d]].push(0)}let l=0;for(a=0;a<r.length;a++){const c=i.length,u=o[a],d=u.length;i[a*4+2]=c+1048576*d/4,i[a*4+3]=0,l=Math.max(l,d/4);for(let h=0;h<d;++h){const f=u[h];i.push(+f)}}for(;i.length%4!=0;)i.push(0);return{maxEdgePerVetex:l,array:new Float32Array(i)}},JX=(r,e)=>{const t=[],n=r.length,i={};return e.forEach(o=>{r.forEach((s,a)=>{if(i[o[s]]===void 0&&(i[o[s]]=Object.keys(i).length),t.push(i[o[s]]),a===n-1)for(;t.length%4!=0;)t.push(0)})}),{array:new Float32Array(t),count:Object.keys(i).length}},_R=r=>{const e=[],t=r.length,n=r[0].length;for(let i=0;i<n;i++)r.forEach((o,s)=>{if(e.push(o[i]),s===t-1)for(;e.length%4!=0;)e.push(0)});return new Float32Array(e)},dre=null,QX='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_K : f32;\\n  [[offset 4]] u_K2 : f32;\\n  [[offset 8]] u_Center : vec2<f32>;\\n  [[offset 16]] u_Gravity : f32;\\n  [[offset 20]] u_ClusterGravity : f32;\\n  [[offset 24]] u_Speed : f32;\\n  [[offset 28]] u_MaxDisplace : f32;\\n  [[offset 32]] u_Clustering : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AttributeArray : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_ClusterCenters : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 3, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn calcRepulsive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {if (i != j) {var nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nvar xDist : f32 = currentNode.x - nextNode.x;\\nvar yDist : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nvar param : f32 = gWebGPUUniformParams.u_K2 / dist;\\nif (dist > 0.0) {dx = dx + param * xDist;\\ndy = dy + param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {var sign : f32 = select(1.0, -1.0, i < j);\\ndx = dx + param * std::sign;\\ndy = dy + param * std::sign;}}}}\\nreturn vec2<f32>(dx, dy);}\\nfn calcGravity(currentNode : vec4<f32>, nodeAttributes : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nvar vx : f32 = currentNode.x - gWebGPUUniformParams.u_Center.x;\\nvar vy : f32 = currentNode.y - gWebGPUUniformParams.u_Center.y;\\nvar gf : f32 = (0.01 * gWebGPUUniformParams.u_K) * gWebGPUUniformParams.u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (gWebGPUUniformParams.u_Clustering == 1.0) {var clusterIdx : i32 = i32(nodeAttributes.x);\\nvar center : vec4<f32> = gWebGPUBuffer2.u_ClusterCenters[clusterIdx];\\nvar cvx : f32 = currentNode.x - center.x;\\nvar cvy : f32 = currentNode.y - center.y;\\nvar dist : f32 = std::sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nvar parma : f32 = (gWebGPUUniformParams.u_K * gWebGPUUniformParams.u_ClusterGravity) / dist;\\ndx = dx + parma * cvx;\\ndy = dy + parma * cvy;}\\nreturn vec2<f32>(dx, dy);}\\nfn calcAttractive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nvar arr_offset : i32 = i32(std::floor(currentNode.z + 0.5));\\nvar length : i32 = i32(std::floor(currentNode.w + 0.5));\\nvar node_buffer : vec4<f32>;\\nfor (var p : i32 = 0; p < __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX; p = p + 1) {if (p >= length) {break;}\\nvar arr_idx : i32 = arr_offset + i32(p);\\nvar buf_offset : i32 = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[i32(arr_idx / 4)];}\\nvar float_j : f32 = select(node_buffer.x, select(node_buffer.y, select(node_buffer.z, node_buffer.w, buf_offset == 2), buf_offset == 1), buf_offset == 0);\\nvar nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[i32(float_j)];\\nvar xDist : f32 = currentNode.x - nextNode.x;\\nvar yDist : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = std::sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nvar attractiveF : f32 = dist / gWebGPUUniformParams.u_K;\\nif (dist > 0.0) {dx = dx - xDist * attractiveF;\\ndy = dy - yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {var sign : f32 = select(1.0, -1.0, i < i32(float_j));\\ndx = dx - std::sign * attractiveF;\\ndy = dy - std::sign * attractiveF;}}}\\nreturn vec2<f32>(dx, dy);}\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar currentNode : vec4<f32> = gWebGPUBuffer0.u_Data[i];\\nvar dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nif (i >= __DefineValuePlaceholder__VERTEX_COUNT) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvar nodeAttributes : vec4<f32> = gWebGPUBuffer1.u_AttributeArray[i];\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4<f32>(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w);\\nreturn ;}\\nvar repulsive : vec2<f32> = calcRepulsive(i, currentNode);\\ndx = dx + repulsive.x;\\ndy = dy + repulsive.y;\\nvar attractive : vec2<f32> = calcAttractive(i, currentNode);\\ndx = dx + attractive.x;\\ndy = dy + attractive.y;\\nvar gravity : vec2<f32> = calcGravity(currentNode, nodeAttributes);\\ndx = dx - gravity.x;\\ndy = dy - gravity.y;\\ndx = dx * gWebGPUUniformParams.u_Speed;\\ndy = dy * gWebGPUUniformParams.u_Speed;\\nvar distLength : f32 = std::sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {var limitedDist : f32 = std::min(gWebGPUUniformParams.u_MaxDisplace * gWebGPUUniformParams.u_Speed, distLength);\\ngWebGPUBuffer0.u_Data[i] = vec4<f32>(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w);}\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_K;\\n  float u_K2;\\n  vec2 u_Center;\\n  float u_Gravity;\\n  float u_ClusterGravity;\\n  float u_Speed;\\n  float u_MaxDisplace;\\n  float u_Clustering;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer   GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_AttributeArray[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 3) buffer readonly  GWebGPUBuffer2 {\\n  vec4 u_ClusterCenters[];\\n} gWebGPUBuffer2;\\n\\n\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nvec2 calcRepulsive(int i, vec4 currentNode) {float dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = gWebGPUBuffer0.u_Data[j];\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = gWebGPUUniformParams.u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {float dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - gWebGPUUniformParams.u_Center.x;\\nfloat vy = currentNode.y - gWebGPUUniformParams.u_Center.y;\\nfloat gf = (0.01 * gWebGPUUniformParams.u_K) * gWebGPUUniformParams.u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (gWebGPUUniformParams.u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = gWebGPUBuffer2.u_ClusterCenters[clusterIdx];\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (gWebGPUUniformParams.u_K * gWebGPUUniformParams.u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {float dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[int(arr_idx / 4)];}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = gWebGPUBuffer0.u_Data[int(float_j)];\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / gWebGPUUniformParams.u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {int i = globalInvocationID.x;\\nvec4 currentNode = gWebGPUBuffer0.u_Data[i];\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvec4 nodeAttributes = gWebGPUBuffer1.u_AttributeArray[i];\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w);\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= gWebGPUUniformParams.u_Speed;\\ndy *= gWebGPUUniformParams.u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(gWebGPUUniformParams.u_MaxDisplace * gWebGPUUniformParams.u_Speed, distLength);\\ngWebGPUBuffer0.u_Data[i] = vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w);}}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',hre=null,eY='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\n\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 0, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributes : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_ClusterCenters : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar center : vec4<f32> = gWebGPUBuffer2.u_ClusterCenters[i];\\nvar sumx : f32 = 0.0;\\nvar sumy : f32 = 0.0;\\nvar count : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {var attributes : vec4<f32> = gWebGPUBuffer1.u_NodeAttributes[j];\\nvar clusterIdx : i32 = i32(attributes.x);\\nvar vertex : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nif (clusterIdx == i) {sumx = sumx + vertex.x;\\nsumy = sumy + vertex.y;\\ncount = count + 1.0;}}\\ngWebGPUBuffer2.u_ClusterCenters[i] = vec4<f32>(sumx / count, sumy / count, count, i);\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\n\\nlayout(std430, set = 0, binding = 0) buffer readonly  GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 1) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_NodeAttributes[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 2) buffer   GWebGPUBuffer2 {\\n  vec4 u_ClusterCenters[];\\n} gWebGPUBuffer2;\\n\\n\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\nvoid main() {int i = globalInvocationID.x;\\nvec4 center = gWebGPUBuffer2.u_ClusterCenters[i];\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = gWebGPUBuffer1.u_NodeAttributes[j];\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = gWebGPUBuffer0.u_Data[j];\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngWebGPUBuffer2.u_ClusterCenters[i] = vec4(sumx / count, sumy / count, count, i);}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}';var Yb=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(n.next(u))}catch(d){s(d)}}function l(u){try{c(n.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};class tY extends _s{constructor(e){super();this.maxIteration=1e3,this.gravity=10,this.speed=1,this.clustering=!1,this.clusterField="cluster",this.clusterGravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}}execute(){return Yb(this,void 0,void 0,function*(){const e=this,t=e.nodes;if(!t||t.length===0){e.onLayoutEnd&&e.onLayoutEnd();return}!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const n=e.center;if(t.length===1){t[0].x=n[0],t[0].y=n[1],e.onLayoutEnd&&e.onLayoutEnd();return}const i={},o={};t.forEach((s,a)=>{un(s.x)||(s.x=Math.random()*this.width),un(s.y)||(s.y=Math.random()*this.height),i[s.id]=s,o[s.id]=a}),e.nodeMap=i,e.nodeIdxMap=o,yield e.run()})}executeWithWorker(e,t){return Yb(this,void 0,void 0,function*(){const n=this,i=n.nodes,o=n.center;if(!i||i.length===0)return;if(i.length===1){i[0].x=o[0],i[0].y=o[1];return}const s={},a={};i.forEach((l,c)=>{un(l.x)||(l.x=Math.random()*this.width),un(l.y)||(l.y=Math.random()*this.height),s[l.id]=l,a[l.id]=c}),n.nodeMap=s,n.nodeIdxMap=a,yield n.run(e,t)})}run(e,t){return Yb(this,void 0,void 0,function*(){const n=this,i=n.nodes,o=n.edges,s=n.maxIteration,a=n.center,l=n.height*n.width;let c=Math.sqrt(l)/10;const u=l/(i.length+1),d=Math.sqrt(u),h=n.speed,f=n.clustering,{array:p,count:g}=JX([n.clusterField],i);i.forEach((fe,Ae)=>{let de=0,ct=0;un(fe.fx)&&un(fe.fy)&&(de=fe.fx||.001,ct=fe.fy||.001),p[4*Ae+1]=de,p[4*Ae+2]=ct});const v=i.length,{maxEdgePerVetex:y,array:x}=KX(i,o),E=n.workerEnabled;let T;E?T=Xb.create({canvas:e,engineOptions:{supportCompute:!0}}):T=Xb.create({engineOptions:{supportCompute:!0}});const P=n.onLayoutEnd,z=[];for(let fe=0;fe<g;fe++)z.push(0,0,0,0);const $=T.createKernel(QX).setDispatch([v,1,1]).setBinding({u_Data:x,u_K:d,u_K2:u,u_Gravity:n.gravity,u_ClusterGravity:n.clusterGravity||n.gravity||1,u_Speed:h,u_MaxDisplace:c,u_Clustering:f?1:0,u_Center:a,u_AttributeArray:p,u_ClusterCenters:z,MAX_EDGE_PER_VERTEX:y,VERTEX_COUNT:v});let ne;f&&(ne=T.createKernel(eY).setDispatch([g,1,1]).setBinding({u_Data:x,u_NodeAttributes:p,u_ClusterCenters:z,VERTEX_COUNT:v,CLUSTER_COUNT:g})),yield(()=>Yb(this,void 0,void 0,function*(){for(let Ae=0;Ae<s;Ae++)yield $.execute(),f&&(ne.setBinding({u_Data:$}),yield ne.execute(),$.setBinding({u_ClusterCenters:ne})),$.setBinding({u_MaxDisplace:c*=.99});const fe=yield $.getOutput();e?t.postMessage({type:sw.GPUEND,vertexEdgeData:fe}):i.forEach((Ae,de)=>{const ct=fe[4*de],bt=fe[4*de+1];Ae.x=ct,Ae.y=bt}),P&&P()}))()})}getType(){return"fruchterman-gpu"}}const fre=null,nY='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_damping : f32;\\n  [[offset 4]] u_maxSpeed : f32;\\n  [[offset 8]] u_minMovement : f32;\\n  \\n  [[offset 12]] u_coulombDisScale : f32;\\n  [[offset 16]] u_factor : f32;\\n  \\n  \\n  [[offset 20]] u_interval : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AveMovement : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributeArray1 : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 3, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\ntype GWebGPUBuffer3 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributeArray2 : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 4, set 0]] var<storage_buffer> gWebGPUBuffer3 : GWebGPUBuffer3;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn unpack_float(packedValue : f32) -> vec2<i32> {var packedIntValue : i32 = i32(packedValue);\\nvar v0 : i32 = packedIntValue / 1048576;\\nreturn vec2<i32>(v0, packedIntValue - (v0 * 1048576));}\\nfn calcRepulsive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {if (i != j) {var nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nvar vx : f32 = currentNode.x - nextNode.x;\\nvar vy : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.01;\\nvar n_dist : f32 = (dist + 0.1) * gWebGPUUniformParams.u_coulombDisScale;\\nvar direx : f32 = vx / dist;\\nvar direy : f32 = vy / dist;\\nvar attributesi : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvar attributesj : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[j];\\nvar massi : f32 = attributesi.x;\\nvar nodeStrengthi : f32 = attributesi.z;\\nvar nodeStrengthj : f32 = attributesj.z;\\nvar nodeStrength : f32 = (nodeStrengthi + nodeStrengthj) / 2.0;\\nvar param : f32 = (nodeStrength * gWebGPUUniformParams.u_factor) / (n_dist * n_dist);\\nax = ax + direx * param;\\nay = ay + direy * param;}}\\nreturn vec2<f32>(ax, ay);}\\nfn calcGravity(i : i32, currentNode : vec4<f32>, attributes2 : vec4<f32>) -> vec2<f32> {var vx : f32 = currentNode.x - attributes2.x;\\nvar vy : f32 = currentNode.y - attributes2.y;\\nvar ax : f32 = vx * attributes2.z;\\nvar ay : f32 = vy * attributes2.z;\\nreturn vec2<f32>(ax, ay);}\\nfn calcAttractive(i : i32, currentNode : vec4<f32>, attributes1 : vec4<f32>) -> vec2<f32> {var mass : f32 = attributes1.x;\\nvar ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nvar compressed : vec2<i32> = unpack_float(currentNode.z);\\nvar length : i32 = compressed.x;\\nvar arr_offset : i32 = compressed.y;\\nvar node_buffer : vec4<f32>;\\nfor (var p : i32 = 0; p < __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX; p = p + 1) {if (p >= length) {break;}\\nvar arr_idx : i32 = arr_offset + (4 * p);\\nvar buf_offset : i32 = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[i32(arr_idx / 4)];}\\nvar float_j : f32 = node_buffer.x;\\nvar nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[i32(float_j)];\\nvar vx : f32 = nextNode.x - currentNode.x;\\nvar vy : f32 = nextNode.y - currentNode.y;\\nvar dist : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.01;\\nvar direx : f32 = vx / dist;\\nvar direy : f32 = vy / dist;\\nvar edgeLength : f32 = node_buffer.y;\\nvar edgeStrength : f32 = node_buffer.z;\\nvar diff : f32 = edgeLength - dist;\\nvar param : f32 = (diff * edgeStrength) / mass;\\nax = ax - direx * param;\\nay = ay - direy * param;}\\nreturn vec2<f32>(ax, ay);}\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar currentNode : vec4<f32> = gWebGPUBuffer0.u_Data[i];\\nvar movement : vec4<f32> = gWebGPUBuffer1.u_AveMovement[0];\\nvar ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nif ((i >= __DefineValuePlaceholder__VERTEX_COUNT) || (movement.x < gWebGPUUniformParams.u_minMovement)) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvar nodeAttributes1 : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvar nodeAttributes2 : vec4<f32> = gWebGPUBuffer3.u_NodeAttributeArray2[i];\\nvar repulsive : vec2<f32> = calcRepulsive(i, currentNode);\\nax = ax + repulsive.x;\\nay = ay + repulsive.y;\\nvar attractive : vec2<f32> = calcAttractive(i, currentNode, nodeAttributes1);\\nax = ax + attractive.x;\\nay = ay + attractive.y;\\nvar gravity : vec2<f32> = calcGravity(i, currentNode, nodeAttributes2);\\nax = ax - gravity.x;\\nay = ay - gravity.y;\\nvar param : f32 = gWebGPUUniformParams.u_interval * gWebGPUUniformParams.u_damping;\\nvar vx : f32 = ax * param;\\nvar vy : f32 = ay * param;\\nvar vlength : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > gWebGPUUniformParams.u_maxSpeed) {var param2 : f32 = gWebGPUUniformParams.u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nvar distx : f32 = vx * gWebGPUUniformParams.u_interval;\\nvar disty : f32 = vy * gWebGPUUniformParams.u_interval;\\nvar distLength : f32 = std::sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4<f32>(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0);}else {gWebGPUBuffer0.u_Data[i] = vec4<f32>(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength);}\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_damping;\\n  float u_maxSpeed;\\n  float u_minMovement;\\n  \\n  float u_coulombDisScale;\\n  float u_factor;\\n  \\n  \\n  float u_interval;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer   GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_AveMovement[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 3) buffer readonly  GWebGPUBuffer2 {\\n  vec4 u_NodeAttributeArray1[];\\n} gWebGPUBuffer2;\\n\\nlayout(std430, set = 0, binding = 4) buffer readonly  GWebGPUBuffer3 {\\n  vec4 u_NodeAttributeArray2[];\\n} gWebGPUBuffer3;\\n\\n\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nivec2 unpack_float(float packedValue) {int packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {float ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = gWebGPUBuffer0.u_Data[j];\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * gWebGPUUniformParams.u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvec4 attributesj = gWebGPUBuffer2.u_NodeAttributeArray1[j];\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * gWebGPUUniformParams.u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {float vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {float mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[int(arr_idx / 4)];}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = gWebGPUBuffer0.u_Data[int(float_j)];\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {int i = globalInvocationID.x;\\nvec4 currentNode = gWebGPUBuffer0.u_Data[i];\\nvec4 movement = gWebGPUBuffer1.u_AveMovement[0];\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < gWebGPUUniformParams.u_minMovement)) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvec4 nodeAttributes1 = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvec4 nodeAttributes2 = gWebGPUBuffer3.u_NodeAttributeArray2[i];\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = gWebGPUUniformParams.u_interval * gWebGPUUniformParams.u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > gWebGPUUniformParams.u_maxSpeed) {float param2 = gWebGPUUniformParams.u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nfloat distx = vx * gWebGPUUniformParams.u_interval;\\nfloat disty = vy * gWebGPUUniformParams.u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0);}else {gWebGPUBuffer0.u_Data[i] = vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength);}}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nfloat distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {gl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',pre=null,rY='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_iter : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AveMovement : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\n\\n\\n\\n\\n\\n\\n\\n\\nfn main() -> void {var movement : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {var vertex : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nmovement = movement + vertex.w;}\\nmovement = movement / f32(__DefineValuePlaceholder__VERTEX_COUNT);\\ngWebGPUBuffer1.u_AveMovement[0] = vec4<f32>(movement, 0.0, 0.0, 0.0);\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_iter;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer readonly  GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer   GWebGPUBuffer1 {\\n  vec4 u_AveMovement[];\\n} gWebGPUBuffer1;\\n\\n\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\nvoid main() {float movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = gWebGPUBuffer0.u_Data[j];\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngWebGPUBuffer1.u_AveMovement[0] = vec4(movement, 0.0, 0.0, 0.0);}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}';var Qw=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(n.next(u))}catch(d){s(d)}}function l(u){try{c(n.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};class iY extends _s{constructor(e){super();this.maxIteration=1e3,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:2e3,gravity:10,clustering:!1,clusterGravity:10}}execute(){return Qw(this,void 0,void 0,function*(){const e=this,t=e.nodes;if(!t||t.length===0){e.onLayoutEnd&&e.onLayoutEnd();return}!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const n=e.center;if(t.length===1){t[0].x=n[0],t[0].y=n[1],e.onLayoutEnd&&e.onLayoutEnd();return}const i={},o={};t.forEach((s,a)=>{un(s.x)||(s.x=Math.random()*e.width),un(s.y)||(s.y=Math.random()*e.height),i[s.id]=s,o[s.id]=a}),e.nodeMap=i,e.nodeIdxMap=o,e.nodeStrength=dp(e.nodeStrength,1),e.edgeStrength=dp(e.edgeStrength,1),yield e.run()})}executeWithWorker(e,t){const n=this,i=n.nodes,o=n.center;if(!i||i.length===0)return;if(i.length===1){i[0].x=o[0],i[0].y=o[1];return}const s={},a={};i.forEach((l,c)=>{un(l.x)||(l.x=Math.random()*n.width),un(l.y)||(l.y=Math.random()*n.height),s[l.id]=l,a[l.id]=c}),n.nodeMap=s,n.nodeIdxMap=a,n.nodeStrength=dp(n.nodeStrength,1),n.edgeStrength=dp(n.edgeStrength,1),n.run(e,t)}run(e,t){return Qw(this,void 0,void 0,function*(){const n=this,i=n.nodes,o=n.edges,s=n.maxIteration;!n.width&&typeof window!="undefined"&&(n.width=window.innerWidth),!n.height&&typeof window!="undefined"&&(n.height=window.innerHeight);const a=i.length;n.linkDistance=dp(n.linkDistance),n.edgeStrength=dp(n.edgeStrength);const{maxEdgePerVetex:l,array:c}=qX(i,o,n.linkDistance,n.edgeStrength);n.degrees=O0(i.length,n.nodeIdxMap,o);const u=[],d=[],h=[],f=[],p=[],g=[],v=[];n.getMass||(n.getMass=de=>n.degrees[n.nodeIdxMap[de.id]]||1);const y=n.gravity,x=n.center;i.forEach((de,ct)=>{u.push(n.getMass(de)),d.push(n.nodeStrength(de)),n.degrees[ct]||(n.degrees[ct]=0);let bt=[x[0],x[1],y];if(n.getCenter){const Pe=n.getCenter(de,n.degrees[ct]);Pe&&un(Pe[0])&&un(Pe[1])&&un(Pe[2])&&(bt=Pe)}h.push(bt[0]),f.push(bt[1]),p.push(bt[2]),un(de.fx)&&un(de.fy)?(g.push(de.fx||.001),v.push(de.fy||.001)):(g.push(0),v.push(0))});const E=_R([u,n.degrees,d,g]),T=_R([h,f,p,v]),P=n.workerEnabled;let z;P?z=Xb.create({canvas:e,engineOptions:{supportCompute:!0}}):z=Xb.create({engineOptions:{supportCompute:!0}});const $=n.onLayoutEnd,ne=[];c.forEach(de=>{ne.push(de)});for(let de=0;de<4;de++)ne.push(0);const De=z.createKernel(nY).setDispatch([a,1,1]).setBinding({u_Data:c,u_damping:n.damping,u_maxSpeed:n.maxSpeed,u_minMovement:n.minMovement,u_coulombDisScale:n.coulombDisScale,u_factor:n.factor,u_NodeAttributeArray1:E,u_NodeAttributeArray2:T,MAX_EDGE_PER_VERTEX:l,VERTEX_COUNT:a,u_AveMovement:ne,u_interval:n.interval}),fe=z.createKernel(rY).setDispatch([1,1,1]).setBinding({u_Data:c,VERTEX_COUNT:a,u_AveMovement:[0,0,0,0]});yield(()=>Qw(this,void 0,void 0,function*(){for(let ct=0;ct<s;ct++){yield De.execute(),fe.setBinding({u_Data:De}),yield fe.execute();const bt=Math.max(.02,n.interval-ct*.002);De.setBinding({u_interval:bt,u_AveMovement:fe})}const de=yield De.getOutput();e?t.postMessage({type:sw.GPUEND,vertexEdgeData:de}):i.forEach((ct,bt)=>{const Pe=de[4*bt],tt=de[4*bt+1];ct.x=Pe,ct.y=tt}),$&&$()}))()})}getType(){return"gForce-gpu"}}class oY extends _s{constructor(e){super();this.center=[0,0],this.maxIteration=100,this.gravity=10,this.comboGravity=10,this.linkDistance=10,this.alpha=1,this.alphaMin=.001,this.alphaDecay=1-Math.pow(this.alphaMin,1/300),this.alphaTarget=0,this.velocityDecay=.6,this.edgeStrength=.6,this.nodeStrength=30,this.preventOverlap=!1,this.preventNodeOverlap=!1,this.preventComboOverlap=!1,this.collideStrength=void 0,this.nodeCollideStrength=.5,this.comboCollideStrength=.5,this.comboSpacing=20,this.comboPadding=10,this.optimizeRangeFactor=1,this.onTick=()=>{},this.onLayoutEnd=()=>{},this.depthAttractiveForceScale=1,this.depthRepulsiveForceScale=2,this.nodes=[],this.edges=[],this.combos=[],this.comboTrees=[],this.width=300,this.height=300,this.bias=[],this.nodeMap={},this.oriComboMap={},this.indexMap={},this.comboMap={},this.previousLayouted=!1,this.updateCfg(e)}getDefaultCfg(){return{maxIteration:100,center:[0,0],gravity:10,speed:1,comboGravity:30,preventOverlap:!1,preventComboOverlap:!0,preventNodeOverlap:!0,nodeSpacing:void 0,collideStrength:void 0,nodeCollideStrength:.5,comboCollideStrength:.5,comboSpacing:20,comboPadding:10,edgeStrength:.6,nodeStrength:30,linkDistance:10}}execute(){const e=this,t=e.nodes,n=e.center;if(e.comboTree={id:"comboTreeRoot",depth:-1,children:e.comboTrees},!t||t.length===0){e.onLayoutEnd&&e.onLayoutEnd();return}if(t.length===1){t[0].x=n[0],t[0].y=n[1],e.onLayoutEnd&&e.onLayoutEnd();return}e.initVals(),e.run(),e.onLayoutEnd&&e.onLayoutEnd()}run(){const e=this,t=e.nodes,n=e.previousLayouted?e.maxIteration/5:e.maxIteration;!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight);const i=e.center,o=e.velocityDecay,s=e.comboMap;e.previousLayouted||e.initPos(s);for(let c=0;c<n;c++){const u=[];t.forEach((d,h)=>{u[h]={x:0,y:0}}),e.applyCalculate(u),e.applyComboCenterForce(u),t.forEach((d,h)=>{!un(d.x)||!un(d.y)||(d.x+=u[h].x*o,d.y+=u[h].y*o)}),e.alpha+=(e.alphaTarget-e.alpha)*e.alphaDecay,e.onTick()}const a=[0,0];t.forEach(c=>{!un(c.x)||!un(c.y)||(a[0]+=c.x,a[1]+=c.y)}),a[0]/=t.length,a[1]/=t.length;const l=[i[0]-a[0],i[1]-a[1]];t.forEach((c,u)=>{!un(c.x)||!un(c.y)||(c.x+=l[0],c.y+=l[1])}),e.combos.forEach(c=>{const u=s[c.id];u&&u.empty&&(c.x=u.cx||c.x,c.y=u.cy||c.y)}),e.previousLayouted=!0}initVals(){const e=this,t=e.edges,n=e.nodes,i=e.combos,o={},s={},a={};n.forEach((fe,Ae)=>{s[fe.id]=fe,a[fe.id]=Ae}),e.nodeMap=s,e.indexMap=a;const l={};i.forEach(fe=>{l[fe.id]=fe}),e.oriComboMap=l,e.comboMap=e.getComboMap();const c=e.preventOverlap;e.preventComboOverlap=e.preventComboOverlap||c,e.preventNodeOverlap=e.preventNodeOverlap||c;const u=e.collideStrength;u&&(e.comboCollideStrength=u,e.nodeCollideStrength=u),e.comboCollideStrength=e.comboCollideStrength?e.comboCollideStrength:0,e.nodeCollideStrength=e.nodeCollideStrength?e.nodeCollideStrength:0;for(let fe=0;fe<t.length;++fe){const Ae=Xr(t[fe],"source"),de=Xr(t[fe],"target");o[Ae]?o[Ae]++:o[Ae]=1,o[de]?o[de]++:o[de]=1}const d=[];for(let fe=0;fe<t.length;++fe){const Ae=Xr(t[fe],"source"),de=Xr(t[fe],"target");d[fe]=o[Ae]/(o[Ae]+o[de])}this.bias=d;const h=e.nodeSize,f=e.nodeSpacing;let p,g;if(un(f)?g=()=>f:xu(f)?g=f:g=()=>0,this.nodeSpacing=g,!h)p=fe=>fe.size?os(fe.size)?(fe.size[0]>fe.size[1]?fe.size[0]:fe.size[1])/2:xc(fe.size)?(fe.size.width>fe.size.height?fe.size.width:fe.size.height)/2:fe.size/2:10;else if(xu(h))p=fe=>h(fe);else if(os(h)){const Ae=(h[0]>h[1]?h[0]:h[1])/2;p=de=>Ae}else{const fe=h/2;p=Ae=>fe}this.nodeSize=p;const v=e.comboSpacing;let y;un(v)?y=()=>v:xu(v)?y=v:y=()=>0,this.comboSpacing=y;const x=e.comboPadding;let E;un(x)?E=()=>x:os(x)?E=()=>Math.max.apply(null,x):xu(x)?E=x:E=()=>0,this.comboPadding=E;let T=this.linkDistance,P;T||(T=10),un(T)?P=fe=>T:P=T,this.linkDistance=P;let z=this.edgeStrength,$;z||(z=1),un(z)?$=fe=>z:$=z,this.edgeStrength=$;let ne=this.nodeStrength,De;ne||(ne=30),un(ne)?De=fe=>ne:De=ne,this.nodeStrength=De}initPos(e){this.nodes.forEach((i,o)=>{const s=i.comboId,a=e[s];s&&a?(i.x=a.cx+100/(o+1),i.y=a.cy+100/(o+1)):(i.x=100/(o+1),i.y=100/(o+1))})}getComboMap(){const e=this,t=e.nodeMap,n=e.comboTrees,i=e.oriComboMap,o={};return(n||[]).forEach(s=>{const a=[];mb(s,l=>{if(l.itemType==="node"||!i[l.id])return!0;if(o[l.id]===void 0){const d={id:l.id,name:l.id,cx:0,cy:0,count:0,depth:e.oriComboMap[l.id].depth||0,children:[]};o[l.id]=d}const c=l.children;c&&c.forEach(d=>{if(!o[d.id]&&!t[d.id])return!0;a.push(d)});const u=o[l.id];if(u.cx=0,u.cy=0,a.length===0){u.empty=!0;const d=i[l.id];u.cx=d.x,u.cy=d.y}return a.forEach(d=>{if(u.count++,d.itemType!=="node"){const f=o[d.id];un(f.cx)&&(u.cx+=f.cx),un(f.cy)&&(u.cy+=f.cy);return}const h=t[d.id];!h||(un(h.x)&&(u.cx+=h.x),un(h.y)&&(u.cy+=h.y))}),u.cx/=u.count||1,u.cy/=u.count||1,u.children=a,!0})}),o}applyComboCenterForce(e){const t=this,n=t.gravity,i=t.comboGravity||n,o=this.alpha,s=t.comboTrees,a=t.indexMap,l=t.nodeMap,c=t.comboMap;(s||[]).forEach(u=>{mb(u,d=>{if(d.itemType==="node"||!c[d.id])return!0;const f=c[d.id],p=(f.depth+1)/10*.5,g=f.cx,v=f.cy;return f.cx=0,f.cy=0,f.children.forEach(y=>{if(y.itemType!=="node"){const ne=c[y.id];ne&&un(ne.cx)&&(f.cx+=ne.cx),ne&&un(ne.cy)&&(f.cy+=ne.cy);return}const x=l[y.id],E=x.x-g||.005,T=x.y-v||.005,P=Math.sqrt(E*E+T*T),z=a[x.id],$=i*o/P*p;e[z].x-=E*$,e[z].y-=T*$,un(x.x)&&(f.cx+=x.x),un(x.y)&&(f.cy+=x.y)}),f.cx/=f.count||1,f.cy/=f.count||1,!0})})}applyCalculate(e){const t=this,n=t.comboMap,i=t.nodes,o={};i.forEach((a,l)=>{i.forEach((c,u)=>{if(l<u)return;const d=a.x-c.x||.005,h=a.y-c.y||.005;let f=d*d+h*h;const p=Math.sqrt(f);f<1&&(f=p),o[`${a.id}-${c.id}`]={vx:d,vy:h,vl2:f,vl:p},o[`${c.id}-${a.id}`]={vl2:f,vl:p,vx:-d,vy:-h}})}),t.updateComboSizes(n),t.calRepulsive(e,o),t.calAttractive(e,o),t.preventComboOverlap&&t.comboNonOverlapping(e,n)}updateComboSizes(e){const t=this,n=t.comboTrees,i=t.nodeMap,o=t.nodeSize,s=t.comboSpacing,a=t.comboPadding;(n||[]).forEach(l=>{const c=[];mb(l,u=>{if(u.itemType==="node")return!0;const d=e[u.id];if(!d)return!1;const h=u.children;h&&h.forEach(g=>{!e[g.id]&&!i[g.id]||c.push(g)}),d.minX=Infinity,d.minY=Infinity,d.maxX=-Infinity,d.maxY=-Infinity,c.forEach(g=>{if(g.itemType!=="node")return!0;const v=i[g.id];if(!v)return!0;const y=o(v),x=v.x-y,E=v.y-y,T=v.x+y,P=v.y+y;d.minX>x&&(d.minX=x),d.minY>E&&(d.minY=E),d.maxX<T&&(d.maxX=T),d.maxY<P&&(d.maxY=P)});let f=t.oriComboMap[u.id].size||10;os(f)&&(f=f[0]);const p=Math.max(d.maxX-d.minX,d.maxY-d.minY,f);return d.r=p/2+s(d)/2+a(d),!0})})}comboNonOverlapping(e,t){const n=this,i=n.comboTree,o=n.comboCollideStrength,s=n.indexMap,a=n.nodeMap;mb(i,l=>{if(!t[l.id]&&!a[l.id]&&l.id!=="comboTreeRoot")return!1;const c=l.children;return c&&c.length>1&&c.forEach((u,d)=>{if(u.itemType==="node")return!1;const h=t[u.id];!h||c.forEach((f,p)=>{if(d<=p||f.itemType==="node")return!1;const g=t[f.id];if(!g)return!1;const v=h.cx-g.cx||.005,y=h.cy-g.cy||.005,x=v*v+y*y,E=h.r||1,T=g.r||1,P=E+T,z=T*T,$=E*E;if(x<P*P){const ne=u.children;if(!ne||ne.length===0)return!1;const De=f.children;if(!De||De.length===0)return!1;const fe=Math.sqrt(x),Ae=(P-fe)/fe*o,de=v*Ae,ct=y*Ae,bt=z/($+z),Pe=1-bt;ne.forEach(tt=>{if(tt.itemType!=="node")return!1;if(!a[tt.id])return;const Kt=s[tt.id];De.forEach(tn=>{if(tn.itemType!=="node"||!a[tn.id])return!1;const Bn=s[tn.id];e[Kt].x+=de*bt,e[Kt].y+=ct*bt,e[Bn].x-=de*Pe,e[Bn].y-=ct*Pe})})}})}),!0})}calRepulsive(e,t){const n=this,i=n.nodes,o=n.width*n.optimizeRangeFactor,s=n.nodeStrength,a=n.alpha,l=n.nodeCollideStrength,c=n.preventNodeOverlap,u=n.nodeSize,d=n.nodeSpacing,h=n.depthRepulsiveForceScale,f=n.center;i.forEach((p,g)=>{if(!(!p.x||!p.y)){if(f){const v=n.gravity,y=p.x-f[0]||.005,x=p.y-f[1]||.005,E=Math.sqrt(y*y+x*x);e[g].x-=y*v*a/E,e[g].y-=x*v*a/E}i.forEach((v,y)=>{if(g===y||!v.x||!v.y)return;const{vl2:x,vl:E}=t[`${p.id}-${v.id}`];if(E>o)return;const{vx:T,vy:P}=t[`${p.id}-${v.id}`];let z=Math.log(Math.abs(v.depth-p.depth)/10)+1||1;z=z<1?1:z,v.comboId!==p.comboId&&(z+=1);const $=z?Math.pow(h,z):1,ne=s(v)*a/x*$;if(e[g].x+=T*ne,e[g].y+=P*ne,g<y&&c){const De=u(p)+d(p)||1,fe=u(v)+d(v)||1,Ae=De+fe;if(x<Ae*Ae){const de=(Ae-E)/E*l,ct=fe*fe;let bt=ct/(De*De+ct);const Pe=T*de,tt=P*de;e[g].x+=Pe*bt,e[g].y+=tt*bt,bt=1-bt,e[y].x-=Pe*bt,e[y].y-=tt*bt}}})}})}calAttractive(e,t){const n=this,i=n.edges,o=n.linkDistance,s=n.alpha,a=n.edgeStrength,l=n.bias,c=n.depthAttractiveForceScale;i.forEach((u,d)=>{const h=Xr(u,"source"),f=Xr(u,"target");if(!h||!f||h===f)return;const p=n.indexMap[h],g=n.indexMap[f],v=n.nodeMap[h],y=n.nodeMap[f];if(!v||!y)return;let x=v.depth===y.depth?0:Math.log(Math.abs(v.depth-y.depth)/10);v.comboId===y.comboId&&(x=x/2);let E=x?Math.pow(c,x):1;if(v.comboId!==y.comboId&&E===1?E=c/2:v.comboId===y.comboId&&(E=2),!un(y.x)||!un(v.x)||!un(y.y)||!un(v.y))return;const{vl:T,vx:P,vy:z}=t[`${f}-${h}`],$=(T-o(u))/T*s*a(u)*E,ne=P*$,De=z*$,fe=l[d];e[g].x-=ne*fe,e[g].y-=De*fe,e[p].x+=ne*(1-fe),e[p].y+=De*(1-fe)})}getType(){return"comboForce"}}class eE{constructor(e){this.id=e.id||0,this.rx=e.rx,this.ry=e.ry,this.fx=0,this.fy=0,this.mass=e.mass,this.degree=e.degree,this.g=e.g||0}distanceTo(e){const t=this.rx-e.rx,n=this.ry-e.ry;return Math.hypot(t,n)}setPos(e,t){this.rx=e,this.ry=t}resetForce(){this.fx=0,this.fy=0}addForce(e){const t=e.rx-this.rx,n=e.ry-this.ry;let i=Math.hypot(t,n);i=i<1e-4?1e-4:i;const o=this.g*(this.degree+1)*(e.degree+1)/i;this.fx+=o*t/i,this.fy+=o*n/i}in(e){return e.contains(this.rx,this.ry)}add(e){const t=this.mass+e.mass,n=(this.rx*this.mass+e.rx*e.mass)/t,i=(this.ry*this.mass+e.ry*e.mass)/t,o=this.degree+e.degree,s={rx:n,ry:i,mass:t,degree:o};return new eE(s)}}class hp{constructor(e){this.xmid=e.xmid,this.ymid=e.ymid,this.length=e.length,this.massCenter=e.massCenter||[0,0],this.mass=e.mass||1}getLength(){return this.length}contains(e,t){const n=this.length/2;return e<=this.xmid+n&&e>=this.xmid-n&&t<=this.ymid+n&&t>=this.ymid-n}NW(){const e=this.xmid-this.length/4,t=this.ymid+this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new hp(i)}NE(){const e=this.xmid+this.length/4,t=this.ymid+this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new hp(i)}SW(){const e=this.xmid-this.length/4,t=this.ymid-this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new hp(i)}SE(){const e=this.xmid+this.length/4,t=this.ymid-this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new hp(i)}}class fp{constructor(e){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,e!=null&&(this.quad=e)}insert(e){if(this.body==null){this.body=e;return}this._isExternal()?(this.quad&&(this.NW=new fp(this.quad.NW()),this.NE=new fp(this.quad.NE()),this.SW=new fp(this.quad.SW()),this.SE=new fp(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e))}_putBody(e){!this.quad||(e.in(this.quad.NW())&&this.NW?this.NW.insert(e):e.in(this.quad.NE())&&this.NE?this.NE.insert(e):e.in(this.quad.SW())&&this.SW?this.SW.insert(e):e.in(this.quad.SE())&&this.SE&&this.SE.insert(e))}_isExternal(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null}updateForce(e){if(!(this.body==null||e===this.body))if(this._isExternal())e.addForce(this.body);else{const t=this.quad?this.quad.getLength():0,n=this.body.distanceTo(e);t/n<this.theta?e.addForce(this.body):(this.NW&&this.NW.updateForce(e),this.NE&&this.NE.updateForce(e),this.SW&&this.SW.updateForce(e),this.SE&&this.SE.updateForce(e))}}}class sY extends _s{constructor(e){super();this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.kr=5,this.kg=1,this.mode="normal",this.preventOverlap=!1,this.dissuadeHubs=!1,this.barnesHut=void 0,this.maxIteration=0,this.ks=.1,this.ksmax=10,this.tao=.1,this.onLayoutEnd=()=>{},this.prune=void 0,this.updateCfg(e)}getDefaultCfg(){return{}}execute(){const e=this,{nodes:t,onLayoutEnd:n,prune:i}=e;let o=e.maxIteration;!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight);const s=[],a=t.length;for(let l=0;l<a;l+=1){const c=t[l];let u=10,d=10;un(c.size)&&(u=c.size,d=c.size),os(c.size)?(isNaN(c.size[0])||(u=c.size[0]),isNaN(c.size[1])||(d=c.size[1])):xc(c.size)&&(u=c.size.width,d=c.size.height),e.getWidth&&!isNaN(e.getWidth(c))&&(d=e.getWidth(c)),e.getHeight&&!isNaN(e.getHeight(c))&&(u=e.getHeight(c));const h=Math.max(u,d);s.push(h)}e.barnesHut===void 0&&a>250&&(e.barnesHut=!0),e.prune===void 0&&a>100&&(e.prune=!0),this.maxIteration===0&&!e.prune?(o=250,a<=200&&a>100?o=1e3:a>200&&(o=1200),this.maxIteration=o):this.maxIteration===0&&i&&(o=100,a<=200&&a>100?o=500:a>200&&(o=950),this.maxIteration=o),e.kr||(e.kr=50,a>100&&a<=500?e.kr=20:a>500&&(e.kr=1)),e.kg||(e.kg=20,a>100&&a<=500?e.kg=10:a>500&&(e.kg=1)),this.nodes=e.updateNodesByForces(s),n()}updateNodesByForces(e){const t=this,{edges:n,maxIteration:i}=t;let o=t.nodes;const s=n.filter(p=>{const g=Xr(p,"source"),v=Xr(p,"target");return g!==v}),a=o.length,l=s.length,c=[],u={},d={},h=[];for(let p=0;p<a;p+=1)u[o[p].id]=p,c[p]=0,(o[p].x===void 0||isNaN(o[p].x))&&(o[p].x=Math.random()*1e3),(o[p].y===void 0||isNaN(o[p].y))&&(o[p].y=Math.random()*1e3),h.push({x:o[p].x,y:o[p].y});for(let p=0;p<l;p+=1){let g,v,y=0,x=0;for(let E=0;E<a;E+=1){const T=Xr(s[p],"source"),P=Xr(s[p],"target");o[E].id===T?(g=o[E],y=E):o[E].id===P&&(v=o[E],x=E),d[p]={sourceIdx:y,targetIdx:x}}g&&(c[u[g.id]]+=1),v&&(c[u[v.id]]+=1)}let f=i;if(o=this.iterate(f,u,d,l,c,e),t.prune){for(let p=0;p<l;p+=1)c[d[p].sourceIdx]<=1?(o[d[p].sourceIdx].x=o[d[p].targetIdx].x,o[d[p].sourceIdx].y=o[d[p].targetIdx].y):c[d[p].targetIdx]<=1&&(o[d[p].targetIdx].x=o[d[p].sourceIdx].x,o[d[p].targetIdx].y=o[d[p].sourceIdx].y);t.prune=!1,t.barnesHut=!1,f=100,o=this.iterate(f,u,d,l,c,e)}return o}iterate(e,t,n,i,o,s){const a=this;let{nodes:l}=a;const{kr:c,preventOverlap:u}=a,{barnesHut:d}=a,h=l.length;let f=0;const p=100;let g=e;const v=50;let y=[];const x=[],E=[];for(let T=0;T<h;T+=1)if(y[2*T]=0,y[2*T+1]=0,d){const P={id:T,rx:l[T].x,ry:l[T].y,mass:1,g:c,degree:o[T]};E[T]=new eE(P)}for(;g>0;){for(let P=0;P<h;P+=1)x[2*P]=y[2*P],x[2*P+1]=y[2*P+1],y[2*P]=0,y[2*P+1]=0;y=this.getAttrForces(g,v,i,t,n,o,s,y),d&&(u&&g>v||!u)?y=this.getOptRepGraForces(y,E,o):y=this.getRepGraForces(g,v,y,p,s,o);const T=this.updatePos(y,x,f,o);l=T.nodes,f=T.sg,g--,a.tick&&a.tick()}return l}getAttrForces(e,t,n,i,o,s,a,l){const c=this,{nodes:u,preventOverlap:d,dissuadeHubs:h,mode:f,prune:p}=c;for(let g=0;g<n;g+=1){const v=u[o[g].sourceIdx],y=o[g].sourceIdx,x=u[o[g].targetIdx],E=o[g].targetIdx;if(p&&(s[y]<=1||s[E]<=1))continue;const T=[x.x-v.x,x.y-v.y];let P=Math.hypot(T[0],T[1]);P=P<1e-4?1e-4:P,T[0]=T[0]/P,T[1]=T[1]/P,d&&e<t&&(P=P-a[y]-a[E]);let z=P,$=z;f==="linlog"&&(z=Math.log(1+P),$=z),h&&(z=P/s[y],$=P/s[E]),d&&e<t&&P<=0?(z=0,$=0):d&&e<t&&P>0&&(z=P,$=P),l[2*i[v.id]]+=z*T[0],l[2*i[x.id]]-=$*T[0],l[2*i[v.id]+1]+=z*T[1],l[2*i[x.id]+1]-=$*T[1]}return l}getRepGraForces(e,t,n,i,o,s){const a=this,{nodes:l,preventOverlap:c,kr:u,kg:d,center:h,prune:f}=a,p=l.length;for(let g=0;g<p;g+=1){for(let E=g+1;E<p;E+=1){if(f&&(s[g]<=1||s[E]<=1))continue;const T=[l[E].x-l[g].x,l[E].y-l[g].y];let P=Math.hypot(T[0],T[1]);P=P<1e-4?1e-4:P,T[0]=T[0]/P,T[1]=T[1]/P,c&&e<t&&(P=P-o[g]-o[E]);let z=u*(s[g]+1)*(s[E]+1)/P;c&&e<t&&P<0?z=i*(s[g]+1)*(s[E]+1):c&&e<t&&P===0?z=0:c&&e<t&&P>0&&(z=u*(s[g]+1)*(s[E]+1)/P),n[2*g]-=z*T[0],n[2*E]+=z*T[0],n[2*g+1]-=z*T[1],n[2*E+1]+=z*T[1]}const v=[l[g].x-h[0],l[g].y-h[1]],y=Math.hypot(v[0],v[1]);v[0]=v[0]/y,v[1]=v[1]/y;const x=d*(s[g]+1);n[2*g]-=x*v[0],n[2*g+1]-=x*v[1]}return n}getOptRepGraForces(e,t,n){const i=this,{nodes:o,kg:s,center:a,prune:l}=i,c=o.length;let u=9e10,d=-9e10,h=9e10,f=-9e10;for(let x=0;x<c;x+=1)l&&n[x]<=1||(t[x].setPos(o[x].x,o[x].y),o[x].x>=d&&(d=o[x].x),o[x].x<=u&&(u=o[x].x),o[x].y>=f&&(f=o[x].y),o[x].y<=h&&(h=o[x].y));const p=Math.max(d-u,f-h),g={xmid:(d+u)/2,ymid:(f+h)/2,length:p,massCenter:a,mass:c},v=new hp(g),y=new fp(v);for(let x=0;x<c;x+=1)l&&n[x]<=1||t[x].in(v)&&y.insert(t[x]);for(let x=0;x<c;x+=1){if(l&&n[x]<=1)continue;t[x].resetForce(),y.updateForce(t[x]),e[2*x]-=t[x].fx,e[2*x+1]-=t[x].fy;const E=[o[x].x-a[0],o[x].y-a[1]];let T=Math.hypot(E[0],E[1]);T=T<1e-4?1e-4:T,E[0]=E[0]/T,E[1]=E[1]/T;const P=s*(n[x]+1);e[2*x]-=P*E[0],e[2*x+1]-=P*E[1]}return e}updatePos(e,t,n,i){const o=this,{nodes:s,ks:a,tao:l,prune:c,ksmax:u}=o,d=s.length,h=[],f=[];let p=0,g=0;for(let y=0;y<d;y+=1){if(c&&i[y]<=1)continue;const x=[e[2*y]-t[2*y],e[2*y+1]-t[2*y+1]],E=Math.hypot(x[0],x[1]),T=[e[2*y]+t[2*y],e[2*y+1]+t[2*y+1]],P=Math.hypot(T[0],T[1]);h[y]=E,f[y]=P/2,p+=(i[y]+1)*h[y],g+=(i[y]+1)*f[y]}const v=n;n=l*g/p,v!==0&&(n=n>1.5*v?1.5*v:n);for(let y=0;y<d;y+=1){if(c&&i[y]<=1)continue;let x=a*n/(1+n*Math.sqrt(h[y])),E=Math.hypot(e[2*y],e[2*y+1]);E=E<1e-4?1e-4:E;const T=u/E;x=x>T?T:x;const P=x*e[2*y],z=x*e[2*y+1];s[y].x+=P,s[y].y+=z}return{nodes:s,sg:n}}}class Mc{constructor(){this.cells=[],this.columnNum=0,this.rowNum=0,this.additionColumn=[],this.additionRow=[]}init(e,t,n){this.cells=[],this.CELL_W=n.CELL_W||Mc.DEFAULT_CELL_W,this.CELL_H=n.CELL_H||Mc.DEFAULT_CELL_H,this.columnNum=Math.ceil(e/this.CELL_W),this.rowNum=Math.ceil(t/this.CELL_H),Mc.MIN_DIST=Math.pow(e,2)+Math.pow(t,2);for(let i=0;i<this.columnNum;i++){const o=[];for(let s=0;s<this.rowNum;s++){const a={dx:i,dy:s,x:i*this.CELL_W,y:s*this.CELL_H,occupied:!1};o.push(a)}this.cells.push(o)}}findGridByNodeId(e){var t,n;for(let i=0;i<this.columnNum;i++)for(let o=0;o<this.rowNum;o++)if(this.cells[i][o].node&&((n=(t=this.cells[i][o])===null||t===void 0?void 0:t.node)===null||n===void 0?void 0:n.id)===e)return{column:i,row:o};return null}sqdist(e,t){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)}occupyNearest(e){let t=Mc.MIN_DIST,n,i=null;for(let o=0;o<this.columnNum;o++)for(let s=0;s<this.rowNum;s++)!this.cells[o][s].occupied&&(n=this.sqdist(e,this.cells[o][s]))<t&&(t=n,i=this.cells[o][s]);return i&&(i.occupied=!0),i}insertColumn(e,t){if(!(t<=0)){for(let n=0;n<t;n++){this.cells[n+this.columnNum]=[];for(let i=0;i<this.rowNum;i++)this.cells[n+this.columnNum][i]={dx:n,dy:i,x:n*this.CELL_W,y:i*this.CELL_H,occupied:!1,node:null}}for(let n=this.columnNum-1;n>e;n--)for(let i=0;i<this.rowNum;i++)this.cells[n+t][i]=Object.assign(Object.assign({},this.cells[n][i]),{x:(n+t)*this.CELL_W,y:i*this.CELL_H}),this.cells[n][i]={x:n*this.CELL_W,y:i*this.CELL_H,occupied:!0,node:null};for(let n=0;n<this.additionColumn.length;n++)this.additionColumn[n]>=e&&(this.additionColumn[n]+=t);for(let n=0;n<t;n++)this.additionColumn.push(e+n+1);this.columnNum+=t}}insertRow(e,t){if(!(t<=0)){for(let n=0;n<t;n++)for(let i=0;i<this.columnNum;i++)this.cells[i][n+this.rowNum]={dx:i,dy:n,x:i*this.CELL_W,y:n*this.CELL_H,occupied:!1,node:null};for(let n=0;n<this.columnNum;n++)for(let i=this.rowNum-1;i>e;i--)this.cells[n][i+t]=Object.assign(Object.assign({},this.cells[n][i]),{dx:n,dy:i+t,x:n*this.CELL_W,y:(i+t)*this.CELL_H}),this.cells[n][i]={dx:n,dy:i,x:n*this.CELL_W,y:i*this.CELL_H,occupied:!1,node:null};for(let n=0;n<this.additionRow.length;n++)this.additionRow[n]>=e&&(this.additionRow[n]+=t);for(let n=0;n<t;n++)this.additionRow.push(e+n+1);this.rowNum+=t}}getNodes(){const e=[];for(let t=0;t<this.columnNum;t++)for(let n=0;n<this.rowNum;n++)this.cells[t][n].node&&e.push(this.cells[t][n]);return e}}Mc.MIN_DIST=50,Mc.DEFAULT_CELL_W=80,Mc.DEFAULT_CELL_H=80;function aY(r,e){if(!r.nodes||r.nodes.length===0)return r;const t=e.width,n=e.height,i=e.nodeMinGap;let o=1e4,s=1e4;r.nodes.forEach(l=>{const c=l.size[0]||50,u=l.size[1]||50;o=Math.min(c,o),s=Math.min(u,s)});const a=new Mc;a.init(t,n,{CELL_H:s,CELL_W:o}),r.nodes.forEach(l=>{const c=a.occupyNearest(l);c&&(c.node={id:l.id,size:l.size},l.x=c.x,l.y=c.y,l.dx=c.dx,l.dy=c.dy)});for(let l=0;l<r.nodes.length;l++){const c=r.nodes[l],u=a.findGridByNodeId(c.id);if(!u)throw new Error("can not find node cell");const{column:d,row:h}=u;if(c.size[0]+i>o){const f=Math.ceil((c.size[0]+i)/o)-1;let p=f;for(let g=0;g<f&&(a.additionColumn.indexOf(d+g+1)>-1&&!a.cells[d+g+1][h].node);g++)p--;a.insertColumn(d,p)}if(c.size[1]+i>s){const f=Math.ceil((c.size[1]+i)/s)-1;let p=f;for(let g=0;g<f&&(a.additionRow.indexOf(h+g+1)>-1&&!a.cells[d][h+g+1].node);g++)p--;a.insertRow(h,p)}}for(let l=0;l<a.columnNum;l++)for(let c=0;c<a.rowNum;c++){const u=a.cells[l][c];if(u.node){const d=r.nodes.find(h=>{var f;return h.id===((f=u==null?void 0:u.node)===null||f===void 0?void 0:f.id)});d&&(d.x=u.x+d.size[0]/2,d.y=u.y+d.size[1]/2)}}}const AR=1200,TR=800,Kb=1e7,J0=10,MR=3.141592653589793,tE=1.5707963267948966,lY=MR*.375,cY=MR*.625,qb=new Map,uY=10,dY=10;let nE=.8;const PR=.1,hY=.5;function fY(r,e,t){const n=r.x-r.size[0]/2,i=r.y-r.size[1]/2,o=r.x+r.size[0]/2,s=r.y+r.size[1]/2,a=e.x-e.size[0]/2,l=e.y-e.size[1]/2,c=e.x+e.size[0]/2,u=e.y+e.size[1]/2,d=r.x,h=r.y,f=e.x,p=e.y,g=f-d,v=Math.atan2(g,p-h);let y=0,x=0,E=0,T=0;v>tE?(x=i-u,y=a-o,E=parseFloat(x?(x/Math.cos(v)).toFixed(2):y.toFixed(2)),T=parseFloat(y?(y/Math.sin(v)).toFixed(2):x.toFixed(2))):0<v&&v<=tE?(x=l-s,y=a-o,x>y?E=T=parseFloat(x?(x/Math.cos(v)).toFixed(2):y.toFixed(2)):E=T=parseFloat(y?(y/Math.sin(v)).toFixed(2):x.toFixed(2))):v<-tE?(x=i-u,y=-(c-n),x>y?E=T=parseFloat(x?(x/Math.cos(v)).toFixed(2):y.toFixed(2)):E=T=parseFloat(y?(y/Math.sin(v)).toFixed(2):x.toFixed(2))):(x=l-s,Math.abs(g)>(o-n)/2?y=n-c:y=g,x>y?E=T=parseFloat(x?(x/Math.cos(v)).toFixed(2):y.toFixed(2)):E=T=parseFloat(y&&v!==0?(y/Math.sin(v)).toFixed(2):x.toFixed(2)));const P=parseFloat(v.toFixed(2));let z=t;return t&&(z=lY<P&&P<cY),{distance:Math.abs(E<T?E:T),isHoriz:z}}function OR(r,e){const n=(qb.get(r.id)||[]).find($=>$.source===e.id||$.target===e.id),i=r.size[0]*r.size[1],o=e.size[0]*e.size[1],s=i>o?e:r,a=i>o?r:e,l=s.x-s.size[0]/2,c=s.y-s.size[1]/2,u=s.x+s.size[0]/2,d=s.y+s.size[1]/2,h=a.x-a.size[0]/2,f=a.y-a.size[1]/2,p=a.x+a.size[0]/2,g=a.y+a.size[1]/2,v=s.x,y=s.y,x=a.x,E=a.y,T=u>=h&&p>=l&&d>=f&&g>=c;let P=0,z=0;if(T){z=Math.sqrt(Math.pow(x-v,2)+Math.pow(E-y,2));const $=l>h?l:h,ne=c>f?c:f,De=u<p?u:p,fe=d<g?d:g,Ae=De-$,de=fe-ne,ct=Ae*de;z===0&&(z=1e-7),P=J0*1/z*100+ct,P*=Kb}else{let $=!1;const ne=fY(s,a,$);z=ne.distance,$=ne.isHoriz,z<=J0?z!==0?n?P+=J0+Kb*1/z:P+=J0+Kb*J0/z:P+=Kb:(P+=z,n&&(P+=z*z))}return P}function DR(r){let e=0;for(let t=0;t<r.length;t++){const n=r[t];(n.x<0||n.y<0||n.x>AR||n.y>TR)&&(e+=1e12);for(let i=t+1;i<r.length;i++)e+=OR(n,r[i])}return e}function pY(r,e,t,n){const i=new Map;t.forEach((l,c)=>{i.set(l.id,l)});const o=n.filter(l=>l.source===r.id||l.target===r.id)||[],s=[];o.forEach(l=>{const c=l.source===r.id?l.target:l.source,u=i.get(c);u&&s.push(u)});let a=!0;for(let l=0;l<s.length;l++){const c=s[l],u=Math.atan((r.y-c.y)/(c.x-r.y))*180,d=Math.atan((e.y-c.y)/(c.x-e.y))*180,h=u<30||u>150,f=d<30||d>150,p=u>70&&u<110,g=d>70&&d<110;if(h&&!f||u*d<0){a=!1;break}else if(p&&!g||u*d<0){a=!1;break}else if((c.x-r.x)*(c.x-e.x)<0){a=!1;break}else if((c.y-r.y)*(c.y-e.y)<0){a=!1;break}}return a}function gY(r,e){let t=!1;const n=1,i=uY*n,o=dY*n,s=[i,-i,0,0],a=[0,0,o,-o];for(let l=0;l<r.length;++l){const c=r[l];let u=NR(c,r);for(let d=0;d<s.length;d++)if(pY(c,{x:c.x+s[d],y:c.y+a[d]},r,e)){c.x+=s[d],c.y+=a[d];const f=NR(c,r),p=Math.random();f<u||p<nE&&p>PR?(u=f,t=!0):(c.x-=s[d],c.y-=a[d])}}return nE>PR&&(nE*=hY),t?DR(r):0}function NR(r,e){let t=0;(r.x<0||r.y<0||r.x+r.size[0]+20>AR||r.y+r.size[1]+20>TR)&&(t+=1e12);for(let n=0;n<e.length;++n)r.id!==e[n].id&&(t+=OR(r,e[n]));return t}function mY(r,e){if(r.length===0)return{nodes:r,edges:e};r.forEach(l=>{const c=e.filter(u=>u.source===l.id||u.target===l.id);qb.set(l,c)}),r.sort((l,c)=>{var u,d;return((u=qb.get(l.id))===null||u===void 0?void 0:u.length)-((d=qb.get(c.id))===null||d===void 0?void 0:d.length)});let t=DR(r),n=20,i=1,o=0;const s=50;let a=0;for(;n>0&&(a++,!(a>=s));){const l=gY(r,e);l!==0&&(o=l),i=o-t,t=o,i===0?--n:n=20}return r.forEach(l=>{l.x=l.x-l.size[0]/2,l.y=l.y-l.size[1]/2}),{nodes:r,edges:e}}var vY=mY;function yY(r,e){const{nodes:t,edges:n}=r,i=e.width,o=e.height;if(!(t==null?void 0:t.length))return Promise.resolve();const s=[];t.forEach(p=>{if(n.filter(v=>v.source===p.id||v.target===p.id).length>1){const v=Object.assign({},p);delete v.size,s.push(v)}});const a=[];n.forEach(p=>{const g=s.find(y=>y.id===p.source),v=s.find(y=>y.id===p.target);g&&v&&a.push(p)});const l=new JM({type:"dagre",ranksep:e.nodeMinGap,nodesep:e.nodeMinGap}),{nodes:c}=l.layout({nodes:s,edges:a});t.forEach(p=>{const g=(c||[]).find(v=>v.id===p.id);p.x=(g==null?void 0:g.x)||i/2,p.y=(g==null?void 0:g.y)||o/2});const u=JSON.parse(JSON.stringify(t)),d=JSON.parse(JSON.stringify(n)),h=iw().nodes(u).force("link",Cb(d).id(p=>p.id).distance(p=>a.find(v=>v.source===p.source&&v.target===p.target)?30:20)).force("charge",ow()).force("center",cM(i/2,o/2)).force("x",hM(i/2)).force("y",fM(o/2)).alpha(.3).alphaDecay(.08).alphaMin(.001);return new Promise(p=>{h.on("end",()=>{t.forEach(P=>{const z=u.find($=>$.id===P.id);z&&(P.x=z.x,P.y=z.y)});const g=Math.min(...t.map(P=>P.x)),v=Math.max(...t.map(P=>P.x)),y=Math.min(...t.map(P=>P.y)),x=Math.max(...t.map(P=>P.y)),E=i/(v-g),T=o/(x-y);t.forEach(P=>{P.x!==void 0&&E<1&&(P.x=(P.x-g)*E),P.y!==void 0&&T<1&&(P.y=(P.y-y)*T)}),t.forEach(P=>{P.sizeTemp=P.size,P.size=[10,10]}),vY(t,n),t.forEach(P=>{P.size=P.sizeTemp||[],delete P.sizeTemp}),aY({nodes:t,edges:n},e),p()})})}class bY extends _s{constructor(e){super();this.width=300,this.height=300,this.nodeMinGap=50,this.onLayoutEnd=()=>{},e&&this.updateCfg(e)}getDefaultCfg(){return{width:300,height:300,nodeMinGap:50}}execute(){const e=this,t=e.nodes,n=e.edges;return t==null||t.forEach(i=>{i.size||(i.size=[50,50])}),yY({nodes:t,edges:n},{width:this.width,height:this.height,nodeMinGap:this.nodeMinGap}).then(()=>{e.onLayoutEnd&&e.onLayoutEnd()})}getType(){return"er"}}class xY extends _s{constructor(e){super();this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{center:[0,0],width:300,height:300}}execute(){const e=this,t=e.nodes,n=.9,i=e.center;return!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight),t&&t.forEach(o=>{o.x=(Math.random()-.5)*n*e.width+i[0],o.y=(Math.random()-.5)*n*e.height+i[1]}),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:this.edges}}getType(){return"random"}}class gre{constructor(e){const t=getLayoutByName(e.type);this.layoutInstance=new t(e)}layout(e){return this.layoutInstance.layout(e)}updateCfg(e){this.layoutInstance.updateCfg(e)}init(e){this.layoutInstance.init(e)}execute(){this.layoutInstance.execute()}getDefaultCfg(){return this.layoutInstance.getDefaultCfg()}destroy(){return this.layoutInstance.destroy()}}const CY={force:DV,fruchterman:vH,forceAtlas2:sY,gForce:Y7,dagre:JM,circular:GV,radial:fH,concentric:pH,grid:X7,mds:gH,comboForce:oY,random:xY,"gForce-gpu":iY,"fruchterman-gpu":tY,er:bY};var Jb;(function(r){r.command=Zn.GRAPH_LAYOUT,r.hookKey="graphLayout"})(Jb||(Jb={}));let Q0=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().graphLayout.call(e,o=>(0,S.mG)(this,void 0,void 0,function*(){const{layoutType:s,layoutOptions:a,customLayout:l}=o;return yield(l||(d=>{const h=CY[s];return new h(Object.assign({},a)).layout(d)}))(o.graphData),{graphData:o.graphData}}),t);return this.ctx.setResult(i),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],Q0.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],Q0.prototype,"init",null),Q0=(0,S.gn)([at({token:{token:Sr,named:Jb.command.id}})],Q0);var Qb;(function(r){function e(n,i){return(0,Ua.isEqual)(n,i)}r.isNodeEqual=e;function t(n,i){return(0,Ua.isEqual)(n,i)}r.isEdgeEqual=t})(Qb||(Qb={}));var e2;(function(r){r.command=Zn.GRAPH_RENDER,r.hookKey="graphRender"})(e2||(e2={}));let em=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().graphRender.call(e,o=>(0,S.mG)(this,void 0,void 0,function*(){const s=yield this.ctx.getX6Graph(),a=yield this.ctx.getGraphMeta(),{beforeRender:l,graphData:c,isNodeEqual:u,isEdgeEqual:d,afterRender:h}=o;return l&&l(a),yield this.doLoadGraph(s,c,u,d),h&&h(c,a),{}}),t);return this.ctx.setResult(i),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this}),this.doLoadGraph=(e,t,n,i)=>(0,S.mG)(this,void 0,void 0,function*(){(e==null?void 0:e.isFrozen())||e==null||e.freeze();const o=this.ctx.getCommands(),{addNodeConfigs:s,addEdgeConfigs:a,removeNodes:l,removeEdges:c,updateNodes:u,updateEdges:d}=this.graphDataDiff(e,t,n,i);for(const h of u){const f=h==null?void 0:h.getData();yield o.executeCommand(Wr.UPDATE_NODE.id,{nodeConfig:f})}for(const h of d){const f=h==null?void 0:h.getData();yield o.executeCommand(Ti.UPDATE_EDGE.id,{edgeConfig:f})}for(const h of s)yield o.executeCommand(Wr.ADD_NODE.id,{nodeConfig:h,options:{isRenderGraph:!0}},{name:"remove servcie",handler:f=>(0,S.mG)(this,void 0,void 0,function*(){delete f.createNodeService})});yield o.executeCommand(Co.INIT_GROUP.id,{graphData:{nodes:s,edges:[]}});for(const h of a)yield o.executeCommand(Ti.ADD_EDGE.id,{edgeConfig:h,options:{isRenderGraph:!0}},{name:"remove servcie",handler:f=>(0,S.mG)(this,void 0,void 0,function*(){delete f.createEdgeService})});for(const h of l){const f=h==null?void 0:h.getData();f.isGroup?yield o.executeCommand(Co.DEL_GROUP.id,{nodeConfig:f}):yield o.executeCommand(Wr.DEL_NODE.id,{nodeConfig:f})}for(const h of c){const f=h==null?void 0:h.getData();yield o.executeCommand(Ti.DEL_EDGE.id,{edgeConfig:f})}(e==null?void 0:e.isFrozen())&&(e==null||e.unfreeze())})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}graphDataDiff(e,t,n,i){const{nodes:o,edges:s}=t,a=[];o.forEach(y=>{e.getCellById(y==null?void 0:y.id)||a.push(y)});const l=[],c=[],u=[];e.getNodes().forEach(y=>{const x=o.find(E=>(E==null?void 0:E.id)===(y==null?void 0:y.id));if(!x)u.push(y);else{let E=!0;n?E=n(y==null?void 0:y.data,x):(y==null?void 0:y.data)&&x&&(E=Qb.isNodeEqual(y==null?void 0:y.data,x)),E||y.setData(x,{deep:!1}),E===!0?l.push(y):c.push(y)}});const h=[];s.forEach(y=>{e.getCellById(y==null?void 0:y.id)||h.push(y)});const f=[],p=[],g=[];return e.getEdges().forEach(y=>{const x=s.find(E=>(E==null?void 0:E.id)===(y==null?void 0:y.id));if(!x)g.push(y);else{let E=!0;i?E=i(y==null?void 0:y.data,x):(y==null?void 0:y.data)&&x&&(E=Qb.isEdgeEqual(y==null?void 0:y.data,x)),E||y.setData(x,{deep:!1}),E===!0?f.push(y):p.push(y)}}),{addNodeConfigs:a,addEdgeConfigs:h,retainNodes:l,retainEdges:f,removeNodes:u,removeEdges:g,updateNodes:c,updateEdges:p}}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],em.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],em.prototype,"init",null),em=(0,S.gn)([at({token:{token:Sr,named:e2.command.id}})],em);var t2;(function(r){r.command=Zn.GRAPH_RESIZE,r.hookKey="graphResize"})(t2||(t2={}));let tm=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield this.ctx.getGraphConfig(),o=i.rootContainer.clientHeight,s=i.rootContainer.clientWidth,a=yield n.graphResize.call(e,l=>(0,S.mG)(this,void 0,void 0,function*(){const c=yield this.ctx.getX6Graph(),{width:u=s,height:d=o}=l;return c==null||c.resize(u,d),{}}),t);return this.ctx.setResult(a),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],tm.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],tm.prototype,"init",null),tm=(0,S.gn)([at({token:{token:Sr,named:t2.command.id}})],tm);var n2;(function(r){r.command=Zn.GRAPH_FULLSCREEN,r.hookKey="graphFullscreen"})(n2||(n2={}));let nm=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield this.ctx.getGraphConfig(),{appContainer:o}=i;if(!o)return;const s=yield n.graphFullscreen.call(e,()=>(0,S.mG)(this,void 0,void 0,function*(){var a,l;let c=!1;return document.fullscreenElement?(l=document.exitFullscreen)===null||l===void 0||l.call(document):((a=o.requestFullscreen)===null||a===void 0||a.call(o),c=!0),{fulllscreen:c}}),t);return this.ctx.setResult(s),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],nm.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],nm.prototype,"init",null),nm=(0,S.gn)([at({token:{token:Sr,named:n2.command.id}})],nm);var rm;(function(r){r.command=Zn.GRAPH_ZOOM,r.MAX_SCALE=1.5,r.MIN_SCALE=.05,r.defaultZoomOptions={maxScale:r.MAX_SCALE,minScale:r.MIN_SCALE},r.hookKey="graphZoom"})(rm||(rm={}));let im=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().graphZoom.call(e,o=>(0,S.mG)(this,void 0,void 0,function*(){const s=yield this.ctx.getX6Graph(),{factor:a,zoomFitPadding:l=12,zoomOptions:c=rm.defaultZoomOptions}=o;return typeof a=="number"?s==null||s.zoom(a,c||{}):a==="fit"?s==null||s.zoomToFit(Object.assign(Object.assign({},c),{padding:l})):a==="real"&&(s==null||s.scale(1),s==null||s.centerContent()),{factor:a,zoomFitPadding:l,zoomOptions:c}}),t);return this.ctx.setResult(i),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],im.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],im.prototype,"init",null),im=(0,S.gn)([at({token:{token:Sr,named:rm.command.id}})],im);var r2;(function(r){r.command=Zn.GRAPH_COPY,r.hookKey="graphCopySelection"})(r2||(r2={}));let i2=class{constructor(){this.parseCells=e=>{e.forEach(o=>{const s=o.getData();o.isNode()&&s.isGroup&&o.getChildren().forEach(l=>{e.push(l)})});const t=e.filter(o=>o.isNode()).map(o=>o.id),n=e.reduce((o,s)=>{if(s.isEdge()){const a=s.getSourceCellId(),l=s.getTargetCellId();a&&l&&t.includes(a)&&t.includes(l)&&o.set(s.id,s)}else o.set(s.id,s);return o},new Map),i=Array.from(n.values());return YT(i)},this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),o=yield e.getHooks().graphCopySelection.call(t,()=>(0,S.mG)(this,void 0,void 0,function*(){const s=yield e.getX6Graph(),a=s.getSelectedCells(),l=s.getEdges(),c=this.parseCells([...a,...l]),u=window.localStorage.getItem(i0);return window.localStorage.setItem(i0,JSON.stringify(c)),e.addUndo(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){window.localStorage.setItem(i0,u)}))),{err:null}}),n);return e.setResult(o),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],i2.prototype,"contextProvider",void 0),i2=(0,S.gn)([at({token:{token:Sr,named:r2.command.id}})],i2);function wY(r,e=null){try{return JSON.parse(r)||e}catch(t){return console.error(t),e}}let om=class{constructor(){this.groupNodeMap=new Map,this.nodeMap=new Map,this.nodeMappingRecord=new Map,this.portMap=new Map,this.portMappingRecord=new Map,this.edgeMap=new Map,this.edgeMappingRecord=new Map,this.getNodesByType=e=>e.reduce((t,n)=>(n.isGroup?t.groupNodes.push(n):t.normalNodes.push(n),t),{normalNodes:[],groupNodes:[]}),this.getNodePorts=e=>Array.isArray(e.ports)?e.ports:e.ports&&Array.isArray(e.ports.items)?e.ports.items:[],this.addNodes=e=>{e.forEach(t=>{if(t.isGroup)this.groupNodeMap.set(t.id,t);else{const n=this.getNodePorts(t);this.nodeMap.set(t.id,t),n.forEach(i=>{this.portMap.set(i.id,i)})}})},this.addEdge=e=>{e.forEach(t=>{this.edgeMap.set(t.id,t)})},this.buildNodeMapping=(e,t)=>{const n=e.id||e.originalId,i=t.id;this.nodeMappingRecord.set(n,i),this.getNodePorts(e).forEach((s,a)=>{const l=t.ports[a];l&&(this.portMap.set(l.id,l),this.portMappingRecord.set(s.id,l.id))})},this.createEdgeBetweenNodes=e=>{const{id:t,source:n,sourcePortId:i,target:o,targetPortId:s}=e,a=(0,S._T)(e,["id","source","sourcePortId","target","targetPortId"]);return Object.assign(Object.assign({},a),{id:void 0,originalId:t,source:this.nodeMappingRecord.get(n),target:this.nodeMappingRecord.get(o),sourcePortId:this.portMappingRecord.get(i),targetPortId:this.portMappingRecord.get(s),sourcePort:this.portMappingRecord.get(i),targetPort:this.portMappingRecord.get(s)})},this.buildGroupRelations=e=>{const{groupChildren:t}=e,n=t.map(i=>this.nodeMappingRecord.get(i));return Object.assign(Object.assign({},e),{groupChildren:n})}}};om=(0,S.gn)([at()],om);var sm,o2;(function(r){r.command=Zn.GRAPH_PASTE,r.hookKey="graphPasteSelection"})(o2||(o2={}));function s2(r,e=0){return Math.floor(Math.random()*(r-e)+e)}let pp=sm=class{constructor(){this.updateNodeCopiedProps=(e,t)=>{let n=s2(100),i=s2(100);return e&&(n=t.x-e.x+s2(30),i=t.y-e.y+s2(30)),t.x+=n,t.y+=i,t.originalId=t.id,delete t.id,t.label=t.label?`${t.label}_copied`:"",t.isCollapsed=!1,t},this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),i=e.getHooks();if(sm.doing)return this;sm.doing=!0;const o=yield i.graphPasteSelection.call(t,s=>(0,S.mG)(this,void 0,void 0,function*(){const{commandService:a,position:l}=s,c=window.localStorage.getItem(i0),u=wY(c,{nodes:[],edges:[]}),{nodes:d=[],edges:h=[]}=u,{normalNodes:f,groupNodes:p}=this.mappingHelper.getNodesByType(d);return this.mappingHelper.addNodes(d),yield Promise.all(f.map(g=>(0,S.mG)(this,void 0,void 0,function*(){const x=(yield a.executeCommand(Wr.ADD_NODE.id,{nodeConfig:this.updateNodeCopiedProps(l,g)})).contextProvider().getResult();this.mappingHelper.buildNodeMapping(g,x.nodeConfig)}))),yield Promise.all(p.map(g=>(0,S.mG)(this,void 0,void 0,function*(){const v=this.mappingHelper.buildGroupRelations(g);yield a.executeCommand(Co.ADD_GROUP.id,{nodeConfig:this.updateNodeCopiedProps(l,v)})}))),yield Promise.all(h.map(g=>{const v=this.mappingHelper.createEdgeBetweenNodes(g);return a.executeCommand(Ti.ADD_EDGE.id,{edgeConfig:v})})),e.addUndo(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){window.localStorage.setItem(i0,null)}))),{err:null}}),n);return e.setResult(o),sm.doing=!1,this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};pp.doing=!1,(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],pp.prototype,"contextProvider",void 0),(0,S.gn)([St(om),(0,S.w6)("design:type",om)],pp.prototype,"mappingHelper",void 0),pp=sm=(0,S.gn)([at({token:{token:Sr,named:o2.command.id}})],pp);var a2;(function(r){r.command=Zn.GRAPH_TOGGLE_MULTI_SELECT,r.hookKey="toggleMultiSelect"})(a2||(a2={}));let am=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().toggleMultiSelect.call(e,o=>(0,S.mG)(this,void 0,void 0,function*(){const s=yield this.ctx.getX6Graph(),a=yield this.ctx.getGraphConfig(),{isEnable:l,modelService:c}=o,u=yield $f.getModel(c),d=typeof l=="boolean"?l:!s.isRubberbandEnabled();return d?(s.enableRubberband(),s.scroller&&s.scroller.widget?s.scroller.disablePanning():s.disablePanning(),a.graphContainer.style.cursor="crosshair"):(s.disableRubberband(),s.scroller&&s.scroller.widget?s.scroller.enablePanning():s.enablePanning(),a.graphContainer.style.cursor="grab"),u.setValue({isEnable:d}),{isEnable:d}}),t);return this.ctx.setResult(i),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],am.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],am.prototype,"init",null),am=(0,S.gn)([at({token:{token:Sr,named:a2.command.id}})],am);var l2;(function(r){r.command=Zn.GRAPH_HISTORY_UNDO,r.hookKey="historyUndo"})(l2||(l2={}));let c2=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),o=yield e.getHooks().historyUndo.call(t,s=>(0,S.mG)(this,void 0,void 0,function*(){const a=yield e.getX6Graph();return a.isHistoryEnabled()===!1?{err:"history is disabled"}:(a.undo(),e.addUndo(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){const{commandService:l}=s;l.executeCommand(Zn.GRAPH_HISTORY_REDO.id,{})}))),{err:null})}),n);return e.setResult(o),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],c2.prototype,"contextProvider",void 0),c2=(0,S.gn)([at({token:{token:Sr,named:l2.command.id}})],c2);var u2;(function(r){r.command=Zn.GRAPH_HISTORY_REDO,r.hookKey="historyRedo"})(u2||(u2={}));let d2=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),o=yield e.getHooks().historyRedo.call(t,s=>(0,S.mG)(this,void 0,void 0,function*(){const a=yield e.getX6Graph();return a.isHistoryEnabled()===!1?{err:"history is disabled"}:(a.redo(),e.addUndo(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){const{commandService:l}=s;l.executeCommand(Zn.GRAPH_HISTORY_UNDO.id,{})}))),{err:null})}),n);return e.setResult(o),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],d2.prototype,"contextProvider",void 0),d2=(0,S.gn)([at({token:{token:Sr,named:u2.command.id}})],d2);var h2;(function(r){r.command=Zn.GRAPH_HISTORY_TOGGLE,r.hookKey="historyToggle"})(h2||(h2={}));let f2=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),o=yield e.getHooks().historyToggle.call(t,s=>(0,S.mG)(this,void 0,void 0,function*(){const a=yield e.getX6Graph();if(a.isHistoryEnabled()===!1)return{err:"history is disabled"};const l=a.isHistoryEnabled(),{enabled:c}=s;return a.toggleHistory(c),e.addUndo(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){const{commandService:u}=s;u.executeCommand(Zn.GRAPH_HISTORY_TOGGLE.id,{enabled:l})}))),{err:null}}),n);return e.setResult(o),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],f2.prototype,"contextProvider",void 0),f2=(0,S.gn)([at({token:{token:Sr,named:h2.command.id}})],f2);var p2;(function(r){r.command=Zn.GRAPH_HISTORY_RESET,r.hookKey="historyReset"})(p2||(p2={}));let g2=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),o=yield e.getHooks().historyReset.call(t,()=>(0,S.mG)(this,void 0,void 0,function*(){return(yield e.getX6Graph()).cleanHistory(),{err:null}}),n);return e.setResult(o),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],g2.prototype,"contextProvider",void 0),g2=(0,S.gn)([at({token:{token:Sr,named:p2.command.id}})],g2);var m2;(function(r){r.command=Zn.GRAPH_ADD_TOOL,r.hookKey="addTool"})(m2||(m2={}));let v2=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),o=yield e.getHooks().addTool.call(t,s=>(0,S.mG)(this,void 0,void 0,function*(){const{cellId:a,toolConfig:l,commandService:c}=s,d=(yield e.getX6Graph()).getCellById(a);return d&&(d.addTools(l.items,l.options),e.addUndo(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){Array.isArray(l.items)&&l.items.forEach(h=>{c.executeCommand(Zn.GRAPH_DEL_TOOL.id,{cellId:a,toolname:h})})})))),{err:null}}),n);return e.setResult(o),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],v2.prototype,"contextProvider",void 0),v2=(0,S.gn)([at({token:{token:Sr,named:m2.command.id}})],v2);var y2;(function(r){r.command=Zn.GRAPH_DEL_TOOL,r.hookKey="delTool"})(y2||(y2={}));let b2=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),o=yield e.getHooks().delTool.call(t,s=>(0,S.mG)(this,void 0,void 0,function*(){const{cellId:a,toolName:l,toolConfig:c}=s,d=(yield e.getX6Graph()).getCellById(a);return d&&(l==="*"?d.removeTools(c):d.removeTool(l,c)),{err:null}}),n);return e.setResult(o),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],b2.prototype,"contextProvider",void 0),b2=(0,S.gn)([at({token:{token:Sr,named:y2.command.id}})],b2);var x2;(function(r){r.command=Zn.REDO_CMD,r.hookKey="redoCommand"})(x2||(x2={}));let lm=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.ctx,{args:t,hooks:n}=e.getArgs();return yield e.getHooks().redoCommand.call(t,()=>(0,S.mG)(this,void 0,void 0,function*(){const o=e.getCommands();return o.isRedoable&&o.redoCommand(),this.ctx.addUndo(wn.create(()=>{o.redoCommand()})),{}}),n),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],lm.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],lm.prototype,"init",null),lm=(0,S.gn)([at({token:{token:Sr,named:x2.command.id}})],lm);var C2;(function(r){r.command=Zn.UNDO_CMD,r.hookKey="undoCommand"})(C2||(C2={}));let cm=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.ctx,{args:t,hooks:n}=e.getArgs();return yield e.getHooks().undoCommand.call(t,()=>(0,S.mG)(this,void 0,void 0,function*(){const o=e.getCommands();return o.isUndoable&&o.undoCommand(),this.ctx.addUndo(wn.create(()=>{o.redoCommand()})),{}}),n),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],cm.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],cm.prototype,"init",null),cm=(0,S.gn)([at({token:{token:Sr,named:C2.command.id}})],cm);const EY=r=>{r(_0),r(T0),r(A0),r(Q0),r(em),r(tm),r(c2),r(d2),r(f2),r(g2),r(lm),r(cm),r(im),r(am),r(i2),r(pp),r(nm),r(v2),r(b2)},SY=[hb,fb,pb,l2,u2,p2,h2,Jb,e2,t2,n2,x2,C2,rm,a2,r2,o2,m2,y2];var um;(function(r){r.command=Ti.ADD_EDGE,r.hookKey="addEdge",r.createEdgeId=n=>{if(fC(n.source))return`${n.source}:${n.sourcePortId}-${n.target}:${n.targetPortId}`;if(e(n)){const i=n;return`${i.source.cell}:${i.source.port}-${i.target.cell}:${i.target.port}`}if(t(n)){const i=n;return`${i.sourceCell}:${i.sourcePort}-${i.targetCell}:${i.targetPort}`}};function e(n){return n.source&&n.source.cell&&fC(n.source.cell)}r.isX6EdgeConfig=e;function t(n){return n.sourceCell&&fC(n.sourceCell)}r.isX6EdgePlainConfig=t})(um||(um={}));let dm=class{constructor(){this.processEdgeConfig=(e,t)=>(0,S.mG)(this,void 0,void 0,function*(){if(!t.id){const{createIdService:n=um.createEdgeId}=e;t.id=yield n(t)}return t.sourcePortId&&!t.sourcePort&&(t.sourcePort=t.sourcePortId,t.targetPort=t.targetPortId),t}),this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().addEdge.call(e,o=>(0,S.mG)(this,void 0,void 0,function*(){const{cellFactory:s,createEdgeService:a,commandService:l,options:c}=o,u=yield this.ctx.getX6Graph();let d=o.edgeConfig;if(a){const v=yield a(o);if(typeof v=="boolean")return{err:"createEdgeService rejected"};d=v}const h=yield this.processEdgeConfig(o,d);let f;const p=Object.assign(Object.assign({},c),{isCommand:!0});if(s){const v=yield s(h,this);f=u.addEdge(v,p)}else f=u.addEdge(Object.assign(Object.assign({},h),{label:(h==null?void 0:h.label)||h,data:Object.assign({},h)}),p);const g=wn.create(()=>{l.executeCommand(Ti.DEL_EDGE.id,{x6Edge:f})});return this.ctx.addUndo(g),{edgeConfig:h,edgeCell:f}}),t);return this.ctx.setResult(i),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],dm.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],dm.prototype,"init",null),dm=(0,S.gn)([at({token:{token:Sr,named:um.command.id}})],dm);var $a;(function(r){r.command=Ti.DEL_EDGE,r.hookKey="delEdge";let e;(function(t){t.EDGE_NOT_EXIST="edge is not exist",t.EDGE_INVALID_CELL="this is not a valid cell",t.X6_DELETE_FAILED="x6 throw err when call delete edge",t.SERVICE_REJECT="service reject to delete"})(e=r.ErrEnum||(r.ErrEnum={}))})($a||($a={}));let hm=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().delEdge.call(e,o=>(0,S.mG)(this,void 0,void 0,function*(){const{edgeConfig:s,x6Edge:a,deleteEdgeService:l,commandService:c,options:u}=o;let d=a;if(!d&&(d=yield this.findEdgeById(s),!d))return console.error($a.ErrEnum.EDGE_NOT_EXIST,s),{err:$a.ErrEnum.EDGE_NOT_EXIST};if(!(d&&d.isEdge()))return console.error($a.ErrEnum.EDGE_NOT_EXIST,d),{err:$a.ErrEnum.EDGE_NOT_EXIST};if(l&&!(yield l(o)))return{err:$a.ErrEnum.SERVICE_REJECT};try{const f=d.getTargetCell(),p=d.getSourceCell(),g=d.getSourcePortId(),v=d.getTargetPortId(),y=p?p.id:p.source,x=f?f.id:f.target;d.remove(Object.assign(Object.assign({},u),{isCommand:!0}));const E=wn.create(()=>{c.executeCommand(Ti.ADD_EDGE.id,{edgeConfig:{source:y,target:x,sourcePortId:g,targetPortId:v}})});return this.ctx.addUndo(E),{err:null,edgeConfig:{source:y,target:x,sourcePortId:g,targetPortId:v},targetCell:f,sourceCell:p,sourcePortId:g,targetPortId:v}}catch(f){return console.error($a.ErrEnum.X6_DELETE_FAILED,f),{err:$a.ErrEnum.X6_DELETE_FAILED}}}),t);return this.ctx.setResult(i),this}),this.findEdgeById=e=>(0,S.mG)(this,void 0,void 0,function*(){return(yield this.ctx.getX6Graph()).getCellById(e.id)}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],hm.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],hm.prototype,"init",null),hm=(0,S.gn)([at({token:{token:Sr,named:$a.command.id}})],hm);var _Y=w(13218),RR=w.n(_Y),gp;(function(r){r.command=Ti.UPDATE_EDGE,r.hookKey="updateEdge",r.XFlowEdgeSetOptions={overwrite:!0},r.XFlowUpdateLabelService=(e,t,n=r.XFlowEdgeSetOptions)=>(0,S.mG)(this,void 0,void 0,function*(){e==null||e.setLabelAt(0,(t==null?void 0:t.label)||t,n)})})(gp||(gp={}));let fm=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().updateEdge.call(e,o=>(0,S.mG)(this,void 0,void 0,function*(){const s=yield this.ctx.getX6Graph(),{updateEdgeService:a,updateEdgeLabelService:l=gp.XFlowUpdateLabelService,options:c=gp.XFlowEdgeSetOptions}=o,u=a?yield a(o):o==null?void 0:o.edgeConfig,d=s==null?void 0:s.getCellById(u==null?void 0:u.id);return d==null||d.setData(u,c),(u==null?void 0:u.hasOwnProperty("label"))&&(yield l(d,u,c)),ob()(u==null?void 0:u.visible)&&d.setVisible(u==null?void 0:u.visible),u.attrs&&d.setAttrs(u.attrs),u.vertices&&d.setVertices(u.vertices),u.router&&d.setRouter(u.router),u.connector&&d.setConnector(u.connector),RR()(u.source)&&d.setSource(u.source),RR()(u.target)&&d.setTarget(u.target),{edgeConfig:u,edgeCell:d}}),t);return this.ctx.setResult(i),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],fm.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],fm.prototype,"init",null),fm=(0,S.gn)([at({token:{token:Sr,named:gp.command.id}})],fm);var w2;(function(r){r.command=Ti.HIGHLIGHT_EDGE,r.hookKey="highlightEdge"})(w2||(w2={}));let pm=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().highlightEdge.call(e,o=>(0,S.mG)(this,void 0,void 0,function*(){var s,a;const l=yield this.ctx.getX6Graph(),{edgeId:c,strokeColor:u,strokeWidth:d}=o,h=l.getEdges(),f=h.find(g=>g.id===c),p=h.filter(g=>g.id!==c);if(!f)console.error(c,"this edgeId is not exist");else{const g=f.getAttrs();((s=g==null?void 0:g.line)===null||s===void 0?void 0:s.stroke)===u&&((a=g==null?void 0:g.line)===null||a===void 0?void 0:a.strokeWidth)===d||(f==null||f.setAttrs({line:{stroke:u,strokeWidth:d||2}}),p.forEach(v=>{v.setAttrs({line:g==null?void 0:g.line})}),o.commandService.executeCommand(Ti.FRONT_EDGE.id,{edgeId:c}))}return{}}),t);return this.ctx.setResult(i),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],pm.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],pm.prototype,"init",null),pm=(0,S.gn)([at({token:{token:Sr,named:w2.command.id}})],pm);var E2;(function(r){r.command=Ti.FRONT_EDGE,r.hookKey="frontEdge"})(E2||(E2={}));let gm=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().frontEdge.call(e,o=>(0,S.mG)(this,void 0,void 0,function*(){const s=yield this.ctx.getX6Graph(),{edgeId:a}=o,l=s==null?void 0:s.getCellById(a);return l?(l.toFront(),this.ctx.addUndo(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){o.commandService.executeCommand(Ti.BACK_EDGE.id,{edgeId:a})})))):console.error(a,"this edgeId is not exist"),{}}),t);return this.ctx.setResult(i),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],gm.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],gm.prototype,"init",null),gm=(0,S.gn)([at({token:{token:Sr,named:E2.command.id}})],gm);var S2;(function(r){r.command=Ti.BACK_EDGE,r.hookKey="frontEdge"})(S2||(S2={}));let mm=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().frontEdge.call(e,o=>(0,S.mG)(this,void 0,void 0,function*(){const s=yield this.ctx.getX6Graph(),{edgeId:a}=o,l=s==null?void 0:s.getCellById(a);return l?(l.toBack(),this.ctx.addUndo(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){o.commandService.executeCommand(Ti.FRONT_EDGE.id,{edgeId:a})})))):console.error(a,"this edgeId is not exist"),{}}),t);return this.ctx.setResult(i),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],mm.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],mm.prototype,"init",null),mm=(0,S.gn)([at({token:{token:Sr,named:S2.command.id}})],mm);const AY=r=>{r(dm),r(hm),r(fm),r(pm),r(gm),r(mm)},TY=[um,$a,gp,w2,E2,S2];var mp;(function(r){r.command=Co.ADD_GROUP,r.hookKey="addGroup",r.GROUP_PADDING=12,r.GROUP_HEADER_HEIGHT=40})(mp||(mp={}));let _2=class{constructor(){this.getBBox=(e,t,n)=>{const{groupHeaderHeight:i=mp.GROUP_HEADER_HEIGHT,groupPadding:o=mp.GROUP_PADDING}=t,s=n.getCellsBBox(e.children);return s.moveAndExpand({x:-o,y:-(o+i),width:o*2,height:o*2+i}),s},this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),o=yield e.getHooks().addGroup.call(t,s=>(0,S.mG)(this,void 0,void 0,function*(){const{nodeConfig:a,createService:l,cellFactory:c,commandService:u}=s,d=yield e.getX6Graph(),h=yield u.executeCommand(Wr.ADD_NODE.id,{cellFactory:c,createNodeService:l,nodeConfig:a}),{nodeCell:f}=h.contextProvider().getResult(),{id:p}=f,{groupChildren:g}=a;if(g.length){g.forEach(y=>{const x=d.getCellById(y);x&&(x.setData(Object.assign(Object.assign({},x.getData()),{group:p,isCollapsed:!1})),x.prop("group",p),f.addChild(x),d.unselect(x))});const v=this.getBBox(f,a,d);f.position(v.x,v.y),f.size(v.width,v.height),f.setZIndex(0),f.prop("isGroup",!0),f.setData(Object.assign(Object.assign({},f.getData()),{width:v.width,height:v.height,groupChildrenSize:{width:v.width,height:v.height},x:v.x,y:v.y,isGroup:!0})),d.select(f)}return a.isCollapsed&&(yield u.executeCommand(Co.COLLAPSE_GROUP.id,{nodeId:a.id,isCollapsed:a.isCollapsed})),e.addUndo(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){u.executeCommand(Co.DEL_GROUP.id,{nodeConfig:a})}))),{nodeConfig:a,nodeCell:f}}),n);return e.setResult(o),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],_2.prototype,"contextProvider",void 0),_2=(0,S.gn)([at({token:{token:Sr,named:mp.command.id}})],_2);var A2;(function(r){r.command=Co.DEL_GROUP,r.hookKey="delGroup"})(A2||(A2={}));let T2=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),o=yield e.getHooks().delGroup.call(t,s=>(0,S.mG)(this,void 0,void 0,function*(){const a=yield e.getX6Graph(),{nodeConfig:l,commandService:c,deleteService:u}=s,{id:d}=l,h=a.getCellById(d);if(u&&!(yield u(s)))return{err:"service rejected"};if(!h)return{err:"target node is not exist"};if(h.getProp("isGroup")!==!0)return{err:"target node is not group"};const{isCollapsed:f}=h.getData();f&&(yield c.executeCommand(Co.COLLAPSE_GROUP.id,{nodeId:h.id,isCollapsed:!1,collapsedSize:{width:0,height:0}}));const p=h.getChildren();return p&&p.forEach(g=>{h.unembed(g),g.prop("group",""),g.setData(Object.assign(Object.assign({},g.getData()),{group:""}))}),yield c.executeCommand(Wr.DEL_NODE.id,{nodeConfig:l}),e.addUndo(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){c.executeCommand(Co.ADD_GROUP.id,{nodeConfig:l})}))),{err:null}}),n);return e.setResult(o),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],T2.prototype,"contextProvider",void 0),T2=(0,S.gn)([at({token:{token:Sr,named:A2.command.id}})],T2);var M2;(function(r){r.command=Co.INIT_GROUP,r.hookKey="initGroup"})(M2||(M2={}));let P2=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),o=yield e.getHooks().initGroup.call(t,s=>(0,S.mG)(this,void 0,void 0,function*(){const{graphData:a,commandService:l}=s,c=yield e.getX6Graph(),{nodes:u}=a,d={};return u.forEach(h=>{const{id:f,group:p}=h;p&&(d[p]?d[p].push(f):d[p]=[f])}),Object.keys(d).forEach(h=>(0,S.mG)(this,void 0,void 0,function*(){const f=c.getCellById(h),p=f.getData(),g=d[h]||[];f.prop("isGroup",!0),f.setData(Object.assign(Object.assign({},p),{isGroup:!0,groupChildren:g})),g.forEach(x=>{const E=c.getCellById(x);f.embed(E)}),f.toBack();const{isCollapsed:v,groupCollapsedSize:y}=p;if(v){const x=s.collapsedSize||y||oT;yield l.executeCommand(Co.COLLAPSE_GROUP.id,{collapsedSize:x,isCollapsed:!0,nodeId:f.id})}})),{}}),n);return e.setResult(o),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],P2.prototype,"contextProvider",void 0),P2=(0,S.gn)([at({token:{token:Sr,named:M2.command.id}})],P2);var O2;(function(r){r.command=Co.COLLAPSE_GROUP,r.hookKey="collapseGroup"})(O2||(O2={}));let vm=class{constructor(){this.toggleVisible=(e,t,n)=>{e.forEach(i=>{const o=n.findViewByCell(i).container;o.style.visibility=t?"visible":"hidden"})},this.toggleCollapse=(e,t,n)=>{const i=e.getChildren().filter(l=>l.isNode()),o=e.getData(),{isCollapsed:s,gap:a=0}=n;if(s){const l=n.collapsedSize||o.groupCollapsedSize||oT;e.prop("previousSize",e.size()),e.size(l)}else e.size(e.prop("previousSize"));i&&i.forEach(l=>{const c=e.position(),u=t.getConnectedEdges(l).filter(d=>{const h=d.getSourceNode(),f=d.getTargetNode();return i.includes(h)&&i.includes(f)});if(s){this.toggleVisible([l,...u],!1,t),l.prop("previousSize",l.size()),l.prop("previousRelativePosition",l.position({relative:!0})),l.position(c.x+a,c.y+a);const d=e.size();l.size({width:d.width-a*2,height:d.height-a*2})}else{this.toggleVisible([l,...u],!0,t);const d=l.prop("previousRelativePosition"),h=l.prop("previousSize");l.position(d.x,d.y,{relative:!0}),l.size(h)}}),e.prop("isCollapsed",s),e.setData(Object.assign(Object.assign({},e.getData()),{isCollapsed:s}))},this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const{args:e,hooks:t}=this.ctx.getArgs(),i=yield this.ctx.getHooks().collapseGroup.call(e,o=>(0,S.mG)(this,void 0,void 0,function*(){const s=yield this.ctx.getX6Graph(),a=s.getCellById(e.nodeId),{toggleService:l}=o;return l&&!(yield l(o))?{err:"service rejected"}:(a&&(this.toggleCollapse(a,s,e),this.ctx.addUndo(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){a&&this.toggleCollapse(a,s,Object.assign(e,{isCollapsed:!e.isCollapsed}))})))),{err:null})}),t);return this.ctx.setResult(i),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],vm.prototype,"contextProvider",void 0),(0,S.gn)([(0,R.zY)(),(0,S.w6)("design:type",Function),(0,S.w6)("design:paramtypes",[]),(0,S.w6)("design:returntype",void 0)],vm.prototype,"init",null),vm=(0,S.gn)([at({token:{token:Sr,named:O2.command.id}})],vm);const MY=r=>{r(_2),r(T2),r(P2),r(vm)},PY=[mp,A2,M2,O2];var D2;(function(r){r.command=b1.UPDATE_MODEL,r.hookKey="updateModel"})(D2||(D2={}));let N2=class{constructor(){this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),o=yield e.getHooks().updateModel.call(t,s=>(0,S.mG)(this,void 0,void 0,function*(){const{updateModel:a,getModel:l,modelService:c}=s,u=yield l(c),d=u.getValue(),h=s7(d);yield a(h);const f=a7(h);return u.setValue(f),e.addUndo(wn.create(()=>(0,S.mG)(this,void 0,void 0,function*(){u.setValue(f)}))),{model:u,value:f}}),n);return e.setResult(o),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],N2.prototype,"contextProvider",void 0),N2=(0,S.gn)([at({token:{token:Sr,named:D2.command.id}})],N2);const mre=()=>{},OY=r=>{r(N2)},DY=[D2],kR=[...H7,...TY,...PY,...SY,...DY],IR=()=>new za;let ym=class{constructor(){this.registerHook=e=>(0,S.mG)(this,void 0,void 0,function*(){const t=e.x6Events.registerHook({name:"bind group node move event",handler:n=>(0,S.mG)(this,void 0,void 0,function*(){const i={eventName:"node:moving",callback:({node:o})=>(0,S.mG)(this,void 0,void 0,function*(){if(o.prop("isGroup")){o.prop("originPosition",o.getPosition());return}const a=o.model.graph,{group:l}=o.getData(),c=a.getNodes().find(E=>E.id===l);if(!c)return;const u=c.getProp("isCollapsed");let d=c.getProp("originSize"),h=!1;d==null&&(d=c.size(),c.prop("originSize",d));let f=c.prop("originPosition");f==null&&(f=c.getPosition(),c.prop("originPosition",f));let p=f.x,g=f.y,v=f.x+d.width,y=f.y+d.height;const x=c.getChildren();if(x&&x.forEach(E=>{const T=E.getBBox().inflate(12),P=T.getCorner();T.x<p&&(p=T.x,h=!0),T.y<g&&(g=T.y,h=!0),P.x>v&&(v=P.x,h=!0),P.y>y&&(y=P.y,h=!0)}),h){c.prop({position:{x:p,y:g},size:{width:v-p,height:y-g}});const E=Object.assign(Object.assign({},c.getData()),{x:p,y:g,width:v-p,height:y-g});u!==!0&&(E.groupChildrenSize={width:v-p,height:y-g}),c.setData(E)}})};n.push(i)})});return wn.create(()=>{t.dispose()})}),this.registerHookHub=e=>(0,S.mG)(this,void 0,void 0,function*(){const t=new $r;return kR.forEach(({hookKey:n,createHook:i=IR})=>{const o=e.registerHookHub(n,i());t.push(o)}),this.commandConfig.getConfig().then(({getContributions:n})=>{n().forEach(({hookKey:o,createHook:s=IR})=>{const a=e.registerHookHub(o,s());t.push(a)})}),t})}registerGraphCommands(e){kR.forEach(({command:t})=>{e.registerCommand(t,{createCommand:this.commandFactory})}),this.commandConfig.getConfig().then(({getContributions:t})=>{t().forEach(i=>{e.registerCommand(i.command,{createCommand:this.commandFactory})})})}};(0,S.gn)([St(G1),(0,S.w6)("design:type",Function)],ym.prototype,"commandFactory",void 0),(0,S.gn)([St(Yf),(0,S.w6)("design:type",Yf)],ym.prototype,"commandConfig",void 0),ym=(0,S.gn)([Yt({contrib:[Ly,wa]})],ym);const NY=(r,e)=>{e.getCommandContributions().forEach(n=>{const{CommandHandler:i,command:o}=n;r({token:{token:Sr,named:o.id},useClass:i})}),EY(r),j7(r),AY(r),MY(r),OY(r),r(ym)},RY=r=>Nr(e=>{e(om),U7(e,r),NY(e,r),e(bc),e(G1,{useFactory:t=>(n,i,o)=>{const s=t.container.createChild(),a=s.get(bc);s.register(Dr,{useDynamic:()=>()=>a});const l=s.getNamed(Sr,n);return a.setArgs(i,o),a.handlerInstance=l,l}})}),kY=r=>{const e=vc(),t=b.useMemo(()=>r.config?r.config:new Yf,[]);return b.useEffect(()=>{e.addCoreModule({config:t,createModule:RY})},[]),null},IY=r=>e=>{const t=b.useMemo(()=>({getValue:()=>({})}),[]);return t.getValue=()=>e,b.useMemo(()=>{const i=new Yf;return r(i,t),i},[t])},LY=Symbol("IToolbarService"),LR=L.defineToken("IToolbarContribution");var GY=w(23279),FY=w.n(GY),BY=w(50361),zY=w.n(BY);let vp=class{constructor(){this.toDispose=new $r,this.toolbarItems=new Map,this.onDidChangeEvent=new Vd(null),this.onDidChange=this.onDidChangeEvent.watch,this.fireOnDidChange=FY()(()=>this.onDidChangeEvent.setValue(void 0),16),this.registerDisposableToolbar=e=>{const t=new $r;return e({registerToolbarItem:i=>{const o=this.registerItem(i);return t.push(o),o}}),this.toDispose.push(t),t},this.getToolbarModel=e=>{const{layout:t,mainGroups:n=[],extraGroups:i=[]}=e;return new Vd({layout:t,mainGroups:this.createToolbarGroupModel(n),extraGroups:this.createToolbarGroupModel(i)})},this.createToolbarGroupModel=e=>e.map(n=>{const{items:i=[]}=n;return Object.assign(Object.assign({},n),{items:i.map(o=>this.createToolbarModel({id:o.id})).filter(o=>!!o)})})}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerToolbarItems(this)}onStop(){this.toDispose.dispose()}registerItem(e){return this.toolbarItems.has(e.id)&&console.warn(`ToolbarRegistry ${e.id} is duplicated, in`,e),this.toolbarItems.set(e.id,e),this.fireOnDidChange(),new $r(wn.create(()=>this.fireOnDidChange()),wn.create(()=>this.toolbarItems.delete(e.id)))}createToolbarModel(e){const t=zY()(this.toolbarItems.get(e.id)),n=ob()(t.isEnabled)?t.isEnabled:!0,i=ob()(t.isVisible)?t.isVisible:!0;return Object.assign(Object.assign({},t),{isEnabled:n,isVisible:i,iconName:t.iconName,text:t.text})}};(0,S.gn)([St(jd),(0,S.w6)("design:type",Object)],vp.prototype,"commandService",void 0),(0,S.gn)([St(Hd),(0,S.w6)("design:type",Object)],vp.prototype,"modelService",void 0),(0,S.gn)([wr(LR),(0,S.w6)("design:type",Object)],vp.prototype,"contributionProvider",void 0),vp=(0,S.gn)([Yt({contrib:[vu,LY]})],vp);const UY=()=>Nr(r=>{Mi.register(r,LR),r(vp)}),GR=r=>{const{}=r,e=vc();return b.useEffect(()=>{const t=e.addCoreModule({config:{CONFIG_TYPE:"ToolbarRegistry",getConfig:()=>(0,S.mG)(void 0,void 0,void 0,function*(){})},createModule:UY});return()=>{t.dispose()}},[e]),null};GR.defaultProps={XFlowModuleType:"ToolbarRegistry"};const vre=Symbol("xflow-menu-root"),VY=Symbol("IMenuService"),FR=L.defineToken("IMenuContribution");var Pu;(function(r){r.Separator="separator",r.Submenu="submenu",r.Root="root",r.Leaf="leaf"})(Pu||(Pu={}));let R2=class{constructor(){this.toDispose=new $r,this.menuMap=new Map,this.getMenu=e=>this.menuMap.get(e),this.registerDisposableMenu=e=>{const t=new $r;return e({registerMenu:i=>{const o=this.registerMenu(i);return t.push(o),o}}),this.toDispose.push(t),t}}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerMenu(this)}onStop(){this.toDispose.dispose()}registerMenu(e){return this.menuMap.set(e.id,e),wn.create(()=>this.menuMap.delete(e.id))}};(0,S.gn)([wr(FR),(0,S.w6)("design:type",Object)],R2.prototype,"contributionProvider",void 0),R2=(0,S.gn)([Yt({contrib:[vu,VY]})],R2);const jY=()=>Nr(r=>{Mi.register(r,FR),r(R2)}),BR=r=>{const{}=r,e=vc();return b.useEffect(()=>{const t=e.addCoreModule({config:{CONFIG_TYPE:"MenuRegistry",getConfig:()=>(0,S.mG)(void 0,void 0,void 0,function*(){})},createModule:jY});return()=>{t.dispose()}},[]),null};BR.defaultProps={XFlowModuleType:"MenuRegistry"};const zR=r=>{const{meta:e,graphConfig:t,graphData:n,graphLayout:i,onLoad:o,isAutoCenter:s,hookConfig:a,modelServiceConfig:l,commandConfig:c,onAppConfigReady:u,onAppDestroy:d,children:h=[],className:f,style:p}=r,[g,v]=b.useState(),y=b.useRef(null),x=y7();b.useEffect(()=>{u&&u(x);const P=D7(x);P.start().then(()=>(0,S.mG)(void 0,void 0,void 0,function*(){var $;v(P),($=x.getExtension("GraphConfig"))===null||$===void 0||$.config.setAppContainer(y.current),e&&(yield P.commandService.executeCommand(Zn.LOAD_META.id,{meta:e})),o&&o(P,x),n&&(i&&(yield P.commandService.executeCommand(Zn.GRAPH_LAYOUT.id,Object.assign({graphData:n},i))),yield P.commandService.executeCommand(Zn.GRAPH_RENDER.id,{graphData:n}))}));const z=()=>(0,S.mG)(void 0,void 0,void 0,function*(){d&&d(P)});return()=>{z()}},[]),b.useEffect(()=>{g&&g.commandService.executeCommand(Zn.LOAD_META.id,{meta:e})},[e]),b.useEffect(()=>{(()=>(0,S.mG)(void 0,void 0,void 0,function*(){g&&(n&&i&&(yield g.commandService.executeCommand(Zn.GRAPH_LAYOUT.id,Object.assign({graphData:n},i))),yield g.commandService.executeCommand(Zn.GRAPH_RENDER.id,{graphData:n}),s&&(yield g.getGraphInstance()).centerContent())}))()},[n]);const E=Cr()("xflow-app-workspace",f,...x.getContainerClassNames()),T=(Array.isArray(h)?h:[h]).some(P=>P&&P.props.isXFlowCanvas);return b.createElement(cT,{app:g},b.createElement(UT.Provider,{value:x},b.createElement("div",{className:E,id:x.getInstanceId(),ref:y,style:p},!T&&b.createElement(J1,{config:t,position:{top:0,bottom:0,left:0,right:0}}),h,b.createElement(XT,{config:l}),b.createElement(kY,{config:c}),b.createElement(b7,{config:a}),b.createElement(GR,null),b.createElement(BR,null))))};zR.defaultProps={};var yre=null;const HY=r=>r&&r.current,UR=()=>{const r=b.useRef(!0);return b.useEffect(()=>()=>{r.current=!1},[]),r},VR=r=>{const e=UR(),[t,n]=b.useState(r.getValue());b.useEffect(()=>{const a=r.watch(l=>{HY(e)&&n(l)});return()=>{a.dispose()}},[n]);const i=t,o=Ba.isValidValue(i),s=b.useCallback(a=>r.setValue(a),[r]);return[i,s,o]},rE=r=>{const e=b.useMemo(()=>new Vd(r),[]),[t,n,i]=VR(e);return b.useEffect(()=>()=>{e.dispose()},[e]),[t,n,e,i]},$Y=r=>{const{getModel:e,initialState:t}=r,n=UR(),i=b.useRef(),[o,s]=b.useState(t);return b.useEffect(()=>{let a;return e().then(l=>(0,S.mG)(void 0,void 0,void 0,function*(){i.current=l;const c=yield l.getValidValue();!n.current||(s(c),a=l.watch(u=>{n.current&&s(u)}))})),()=>{a&&a.dispose&&a.dispose()}},[]),[o,s,i.current]},WY=Symbol("IKeyBindingService"),jR=L.defineToken("IKeyBindingContribution"),HR=Symbol("IKeyBindingOptionProvider");let Ou=class{constructor(){this.toDispose=new $r,this.keyBindingMap=new Map,this.enabledKeyBindingMap=new Map,this.registerExternalKeybindings=()=>(0,S.mG)(this,void 0,void 0,function*(){const{registerKeybindingFunc:e}=yield this.optionProvider.getOption();return e(this)}),this.registerKeybinding=(e=[])=>{const t=new $r;return e.forEach(n=>{this.keyBindingMap.set(n.id,n),this.enableKeyBindings(n.id).then(i=>{t.push(wn.create(()=>{i.dispose(),this.keyBindingMap.delete(n.id)}))})}),this.toDispose.push(t),t},this.enableKeyBindings=e=>(0,S.mG)(this,void 0,void 0,function*(){this.disableKeyBindings([e]);const t=this.keyBindingMap.get(e),n=yield this.getX6Graph(),i=this.runCommand(t);n.bindKey(t.keybinding,i);const o=wn.create(()=>{n.unbindKey(t.keybinding),this.enabledKeyBindingMap.delete(t.id)});return this.enabledKeyBindingMap.set(t.id,o),o}),this.disableKeyBindings=e=>{e.forEach(t=>{const n=this.enabledKeyBindingMap.get(t);n&&n.dispose()})},this.runCommand=e=>t=>(0,S.mG)(this,void 0,void 0,function*(){yield e.callback(e,this.modelService,this.commandService,t)}),this.getX6Graph=()=>(0,S.mG)(this,void 0,void 0,function*(){return yield this.graphProvider.getGraphInstance()})}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerKeybinding(this);this.registerExternalKeybindings()}onStop(){this.toDispose.dispose()}};(0,S.gn)([St(HR),(0,S.w6)("design:type",Object)],Ou.prototype,"optionProvider",void 0),(0,S.gn)([St(jd),(0,S.w6)("design:type",Object)],Ou.prototype,"commandService",void 0),(0,S.gn)([St(Hd),(0,S.w6)("design:type",Object)],Ou.prototype,"modelService",void 0),(0,S.gn)([wr(jR),(0,S.w6)("design:type",Object)],Ou.prototype,"contributionProvider",void 0),(0,S.gn)([St(Wd),(0,S.w6)("design:type",Object)],Ou.prototype,"graphProvider",void 0),Ou=(0,S.gn)([Yt({contrib:[vu,WY]})],Ou);const ZY=(r,e)=>{r(HR,{useDynamic:()=>({getOption:()=>(0,S.mG)(void 0,void 0,void 0,function*(){return e.getConfig()})}),lifecycle:L.Lifecycle.singleton})},XY=r=>Nr(e=>{ZY(e,r),Mi.register(e,jR),e(Ou)});var iE;(function(r){r.CONFIG_TYPE="CONTEXT_CONFIG"})(iE||(iE={}));const $R=()=>wn.create(()=>{});class WR{constructor(){this.CONFIG_TYPE=iE.CONFIG_TYPE,this.keybindingFunc=$R,this.isMounted=new ta,this.setKeybindingFunc=e=>{this.keybindingFunc=e},this.setMountState=()=>{this.isMounted.resolve(!0)},this.getConfig=()=>(0,S.mG)(this,void 0,void 0,function*(){return yield this.isMounted.promise,{CONFIG_TYPE:this.CONFIG_TYPE,registerKeybindingFunc:this.keybindingFunc}}),this.dispose=()=>{this.keybindingFunc=$R,this.isMounted=new ta}}}const YY=r=>{const{config:e}=r,t=vc(),n=b.useMemo(()=>e||new WR,[e]);return b.useEffect(()=>{const i=t.addCoreModule({config:n,createModule:XY});return n.setMountState(),()=>{i.dispose(),n.dispose()}},[t,n]),null},KY=r=>e=>{const t=b.useMemo(()=>({getValue:()=>({})}),[]);return t.getValue=()=>e,b.useMemo(()=>{const i=new WR;return r(i,t),i},[t])};function qY(r){return new Promise(e=>setTimeout(()=>e(!0),r))}var k2=w(1870);class JY{constructor(){this.map=new Map([["default",k2.Z],["QuestionCircleOutlined",k2.Z]]),this.map.set("default",k2.Z),this.map.set("QuestionCircleOutlined",k2.Z)}get(e){return this.map.get(e)}set(e,t){this.map.set(e,t)}has(e){return this.map.has(e)}}const uo=new JY;var bre=null;let ZR=class{constructor(){this.toDispose=new $r,this.registerHookHub=()=>(0,S.mG)(this,void 0,void 0,function*(){return wn.create(()=>{})}),this.registerHook=e=>(0,S.mG)(this,void 0,void 0,function*(){const t=new $r,n=[e.graphOptions.registerHook({name:"add snapline options",handler:i=>(0,S.mG)(this,void 0,void 0,function*(){i.snapline={enabled:!0,className:"xflow-snapline",clean:5e3}})})];return t.pushAll(n),wn.create(()=>{})})}};ZR=(0,S.gn)([Yt({contrib:wa})],ZR);const xre=()=>ManaSyringe.Module(r=>{r(HookContribution)}),QY="CanvasSnapline",eK="#faad14",Cre=r=>{const{color:e=eK}=r,t=useExtensionRegistry(),n=React.useMemo(()=>({CONFIG_TYPE:QY,getConfig:()=>__awaiter(void 0,void 0,void 0,function*(){return{}})}),[]);return React.useEffect(()=>{const i=`xflow-snapline-${Date.now()}`;t.addContainerClassNames(i);const o=`
    .${i} .xflow-snapline .x6-widget-snapline-horizontal,
    .${i} .xflow-snapline .x6-widget-snapline-vertical {
      border-color: ${e};
    }`,s=insertCss(o);return()=>{document.head.removeChild(s)}},[e,t]),React.createElement(XFlowAppExtensionModule,{config:n,createModule})};var Du;(function(r){r.MOUSE_ENTER="node-port:mouseenter",r.MOUSE_LEAVE="node-port:mouseleave"})(Du||(Du={}));var oE;(function(r){r.id="ACTIVE_NODE_PORT",r.useModel=e=>(0,S.mG)(this,void 0,void 0,function*(){const t=yield e.awaitModel(r.id);return{data:yield t.getValidValue(),model:t}})})(oE||(oE={}));let sE=class{constructor(){this.toDispose=new $r,this.getGraphInstance=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=yield this.graphProvider.getGraphInstance(),t=yield this.graphProvider.getGraphOptions();return{graph:e,config:t}}),this.getPortRenderConfig=()=>({onPortRendered(t){const n=this,{port:i,node:o}=t,{contentSelectors:s}=t,a=s&&s["xflow-port-group"];a instanceof Element&&(a.setAttribute("class",Cr()("xflow-port-group",{connected:i.connected&&i.group!=="out",groupPort:(o==null?void 0:o.isGroup)&&(o==null?void 0:o.isGroup())})),a.addEventListener("mouseenter",l=>{const c={e:l,portId:i.id,nodeId:o.id,portData:i,nodeData:o.getData(),tooltip:i.tooltip,placement:i.group};n.trigger(Du.MOUSE_ENTER,c)}),a.addEventListener("mouseleave",l=>{const c={e:l,portId:i.id,nodeId:o.id,portData:i,nodeData:o.getData(),tooltip:i.tooltip,placement:i.group};n.trigger(Du.MOUSE_LEAVE,c)}))}}),this.registerHookHub=()=>(0,S.mG)(this,void 0,void 0,function*(){return wn.create(()=>{})}),this.registerHook=e=>(0,S.mG)(this,void 0,void 0,function*(){const t=new $r,n=[e.graphOptions.registerHook({name:"add onPortRendered options ",handler:i=>(0,S.mG)(this,void 0,void 0,function*(){Object.assign(i,this.getPortRenderConfig())})})];return t.pushAll(n),wn.create(()=>{})})}registerModel(e){e.registerModel({id:oE.id,watchChange:t=>(0,S.mG)(this,void 0,void 0,function*(){const{graph:n,config:i}=yield this.getGraphInstance(),o=l=>{const{x:c,y:u,width:d,height:h}=l.target.getBoundingClientRect(),f=i.rootContainer.getBoundingClientRect();return{x:c-((f==null?void 0:f.x)||0)+d/2,y:u-((f==null?void 0:f.y)||0)+h/2}},s=l=>{t.setValue(Object.assign(Object.assign({},l),{position:o(l.e)}))},a=()=>{t.setValue(null)};return n.on(Du.MOUSE_ENTER,s),n.on(Du.MOUSE_LEAVE,a),n.on("cell:mouseleave",a),wn.create(()=>{n.off(Du.MOUSE_ENTER,s),n.off(Du.MOUSE_LEAVE,a)})})})}};(0,S.gn)([St(Wd),(0,S.w6)("design:type",Object)],sE.prototype,"graphProvider",void 0),sE=(0,S.gn)([Yt({contrib:[wa,$d]})],sE);const wre=()=>ManaSyringe.Module(r=>{r(NodePortTooltipContribution)}),tK="CanvasNodePortTooltip",nK=r=>{const e=useXFlowApp(),[t,,n]=createComponentModel(null);React.useEffect(()=>{if(!e)return;const a=(()=>__awaiter(void 0,void 0,void 0,function*(){const{model:l}=yield ACTIVE_NODE_PORT.useModel(e.modelService);return l.watch(c=>{n.setValue(c)})}))();return()=>{a.then(l=>{l.dispose()})}},[n,e]);const i=!!(t&&t.position&&t.position.x);if(!i)return null;const o=r.getTooltip?r.getTooltip(t):t.tooltip;return React.createElement(Tooltip,{visible:i,title:o,placement:t.placement||"top"},React.createElement("span",{className:"canvas-node-port-tooltip",style:{position:"absolute",left:t.position.x,top:t.position.y}}))},Ere=r=>{const e=React.useCallback(()=>__awaiter(void 0,void 0,void 0,function*(){return null}),[]);return React.createElement(XFlowAppExtensionModule,{createModule,config:{CONFIG_TYPE:tK,getConfig:e}},React.createElement(nK,Object.assign({},r)))};var aE;(function(r){r.CONFIG_TYPE="ContextMenuConfig"})(aE||(aE={}));class bm{constructor(e){this.CONFIG_TYPE=aE.CONFIG_TYPE,this.setMenuModelService=t=>{this.menuModelService=t},this.setCustomMenuRender=t=>{this.menuCustomRender=t},this.getConfig=()=>(0,S.mG)(this,void 0,void 0,function*(){return{CONFIG_TYPE:this.CONFIG_TYPE,menuCustomRender:this.menuCustomRender,menuModelService:this.menuModelService}}),this.moduleId=e||na()}dispose(){}}var I2;(function(r){r.id="CONTEXT_MENU_MODEL",r.useValue=no(r.id),r.getModel=to(r.id)})(I2||(I2={}));const{inject:XR,singleton:rK}=k;let xm=class{constructor(){this.toDispose=new $r,this.getMenuModelValue=e=>(0,S.mG)(this,void 0,void 0,function*(){const t=yield this.menuConfig.getConfig(),{anchor:n,type:i,cell:o}=e,s=new $r;this.toDispose.push(s);const a=o?o.getData():null,l=new Vd({id:"menuroot",type:Pu.Root,submenu:[]});s.push(wn.create(()=>{l.dispose()}));const c={toDispose:s,anchor:n,target:{data:a,type:i},customRender:null,menuModel:l};return t.menuCustomRender&&(c.customRender=yield t.menuCustomRender(e,this.modelService)),t.menuModelService&&(yield t.menuModelService(e,c.menuModel,this.modelService,s)),c})}registerModel(e){const t=[e.registerModel({id:I2.id,getInitialValue:()=>null,watchChange:(n,i)=>(0,S.mG)(this,void 0,void 0,function*(){return(yield Hy.getModel(i)).watch(s=>(0,S.mG)(this,void 0,void 0,function*(){const a=yield this.getMenuModelValue(s);n.setValue(a)}))})})];this.toDispose.pushAll(t)}};(0,S.gn)([XR(bm),(0,S.w6)("design:type",bm)],xm.prototype,"menuConfig",void 0),(0,S.gn)([XR(Hd),(0,S.w6)("design:type",Object)],xm.prototype,"modelService",void 0),xm=(0,S.gn)([rK({contrib:[$d]})],xm);const iK=r=>Nr(e=>{e(xm),e(bm,{useValue:r})});var YR=w(28991),oK=w(81253),sK=w(2306),yp={adjustX:1,adjustY:1},bp=[0,0],aK={topLeft:{points:["bl","tl"],overflow:yp,offset:[0,-4],targetOffset:bp},topCenter:{points:["bc","tc"],overflow:yp,offset:[0,-4],targetOffset:bp},topRight:{points:["br","tr"],overflow:yp,offset:[0,-4],targetOffset:bp},bottomLeft:{points:["tl","bl"],overflow:yp,offset:[0,4],targetOffset:bp},bottomCenter:{points:["tc","bc"],overflow:yp,offset:[0,4],targetOffset:bp},bottomRight:{points:["tr","br"],overflow:yp,offset:[0,4],targetOffset:bp}},lK=aK,lr={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var t=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||t>=lr.F1&&t<=lr.F12)return!1;switch(t){case lr.ALT:case lr.CAPS_LOCK:case lr.CONTEXT_MENU:case lr.CTRL:case lr.DOWN:case lr.END:case lr.ESC:case lr.HOME:case lr.INSERT:case lr.LEFT:case lr.MAC_FF_META:case lr.META:case lr.NUMLOCK:case lr.NUM_CENTER:case lr.PAGE_DOWN:case lr.PAGE_UP:case lr.PAUSE:case lr.PRINT_SCREEN:case lr.RIGHT:case lr.SHIFT:case lr.UP:case lr.WIN_KEY:case lr.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=lr.ZERO&&e<=lr.NINE||e>=lr.NUM_ZERO&&e<=lr.NUM_MULTIPLY||e>=lr.A&&e<=lr.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&e===0)return!0;switch(e){case lr.SPACE:case lr.QUESTION_MARK:case lr.NUM_PLUS:case lr.NUM_MINUS:case lr.NUM_PERIOD:case lr.NUM_DIVISION:case lr.SEMICOLON:case lr.DASH:case lr.EQUALS:case lr.COMMA:case lr.PERIOD:case lr.SLASH:case lr.APOSTROPHE:case lr.SINGLE_QUOTE:case lr.OPEN_SQUARE_BRACKET:case lr.BACKSLASH:case lr.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},KR=lr,qR=function(e){return+setTimeout(e,16)},JR=function(e){return clearTimeout(e)};typeof window!="undefined"&&"requestAnimationFrame"in window&&(qR=function(e){return window.requestAnimationFrame(e)},JR=function(e){return window.cancelAnimationFrame(e)});var QR=0,lE=new Map;function ek(r){lE.delete(r)}function tk(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;QR+=1;var t=QR;function n(i){if(i===0)ek(t),r();else{var o=qR(function(){n(i-1)});lE.set(t,o)}}return n(e),t}tk.cancel=function(r){var e=lE.get(r);return ek(e),JR(e)};var cK=KR.ESC,uK=KR.TAB;function dK(r){var e=r.visible,t=r.setTriggerVisible,n=r.triggerRef,i=r.menuRef,o=r.onVisibleChange,s=r.autoFocus,a=b.useRef(!1),l=function(){if(e&&n.current){var h,f,p,g;(h=n.current)===null||h===void 0||(f=h.triggerRef)===null||f===void 0||(p=f.current)===null||p===void 0||(g=p.focus)===null||g===void 0||g.call(p),t(!1),typeof o=="function"&&o(!1)}},c=function(){var h,f;(h=i.current)===null||h===void 0||(f=h.focus)===null||f===void 0||f.call(h),a.current=!0},u=function(h){var f;switch(h.keyCode){case cK:l();break;case uK:!a.current&&((f=i.current)===null||f===void 0?void 0:f.focus)?(h.preventDefault(),c()):l();break}};b.useEffect(function(){return e?(window.addEventListener("keydown",u),s&&tk(c,3),function(){window.removeEventListener("keydown",u),a.current=!1}):function(){a.current=!1}},[e])}var hK=w(59864);function Sre(r,e,t){var n=React.useRef({});return(!("value"in n.current)||t(n.current.condition,e))&&(n.current.value=r(),n.current.condition=e),n.current.value}function fK(r,e){typeof r=="function"?r(e):(0,th.Z)(r)==="object"&&r&&"current"in r&&(r.current=e)}function nk(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];var n=e.filter(function(i){return i});return n.length<=1?n[0]:function(i){e.forEach(function(o){fK(o,i)})}}function _re(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return useMemo(function(){return nk.apply(void 0,e)},e,function(n,i){return n.length===i.length&&n.every(function(o,s){return o===i[s]})})}function pK(r){var e,t,n=(0,hK.isMemo)(r)?r.type.type:r.type;return!(typeof n=="function"&&!((e=n.prototype)===null||e===void 0?void 0:e.render)||typeof r=="function"&&!((t=r.prototype)===null||t===void 0?void 0:t.render))}var gK=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus"];function mK(r,e){var t=r.arrow,n=t===void 0?!1:t,i=r.prefixCls,o=i===void 0?"rc-dropdown":i,s=r.transitionName,a=r.animation,l=r.align,c=r.placement,u=c===void 0?"bottomLeft":c,d=r.placements,h=d===void 0?lK:d,f=r.getPopupContainer,p=r.showAction,g=r.hideAction,v=r.overlayClassName,y=r.overlayStyle,x=r.visible,E=r.trigger,T=E===void 0?["hover"]:E,P=r.autoFocus,z=(0,oK.Z)(r,gK),$=b.useState(),ne=(0,I0.Z)($,2),De=ne[0],fe=ne[1],Ae="visible"in r?x:De,de=b.useRef(null);b.useImperativeHandle(e,function(){return de.current});var ct=b.useRef(null),bt="".concat(o,"-menu");dK({visible:Ae,setTriggerVisible:fe,triggerRef:de,menuRef:ct,onVisibleChange:r.onVisibleChange,autoFocus:P});var Pe=function(){var fn=r.overlay,Kn;return typeof fn=="function"?Kn=fn():Kn=fn,Kn},tt=function(fn){var Kn=r.onOverlayClick,Pn=Pe().props;fe(!1),Kn&&Kn(fn),Pn.onClick&&Pn.onClick(fn)},Kt=function(fn){var Kn=r.onVisibleChange;fe(fn),typeof Kn=="function"&&Kn(fn)},tn=function(){var fn,Kn=Pe(),Pn=nk(ct,Kn.ref),vr=(fn={prefixCls:bt},(0,it.Z)(fn,"data-dropdown-inject",!0),(0,it.Z)(fn,"onClick",tt),(0,it.Z)(fn,"ref",pK(Kn)?Pn:void 0),fn);return typeof Kn.type=="string"&&(delete vr.prefixCls,delete vr["data-dropdown-inject"]),b.createElement(b.Fragment,null,n&&b.createElement("div",{className:"".concat(o,"-arrow")}),b.cloneElement(Kn,vr))},Bn=function(){var fn=r.overlay;return typeof fn=="function"?tn:tn()},cr=function(){var fn=r.minOverlayWidthMatchTrigger,Kn=r.alignPoint;return"minOverlayWidthMatchTrigger"in r?fn:!Kn},gn=function(){var fn=r.openClassName;return fn!==void 0?fn:"".concat(o,"-open")},si=function(){var fn=r.children,Kn=fn.props?fn.props:{},Pn=Cr()(Kn.className,gn());return Ae&&fn?b.cloneElement(fn,{className:Pn}):fn},xi=g;return!xi&&T.indexOf("contextMenu")!==-1&&(xi=["click"]),b.createElement(sK.Z,(0,YR.Z)((0,YR.Z)({builtinPlacements:h},z),{},{prefixCls:o,ref:de,popupClassName:Cr()(v,(0,it.Z)({},"".concat(o,"-show-arrow"),n)),popupStyle:y,action:T,showAction:p,hideAction:xi||[],popupPlacement:u,popupAlign:l,popupTransitionName:s,popupAnimation:a,popupVisible:Ae,stretch:cr()?"minWidth":"",popup:Bn(),onPopupVisibleChange:Kt,getPopupContainer:f}),si())}var vK=b.forwardRef(mK),yK=vK;class L2 extends b.Component{render(){const{children:e,trigger:t,disabled:n}=this.props,i=`${this.props.prefixCls}-dropdown`,o=b.Children.only(e),s=b.cloneElement(o,{className:Cr()(e.props.className,`${i}-trigger`),disabled:n}),a=n?[]:Array.isArray(t)?t:[t];let l=!1;a&&a.indexOf("contextMenu")!==-1&&(l=!0);const c=b.Children.only(this.props.overlay),u=b.createElement("div",{className:`${i}-overlay`},c);return b.createElement(yK,Object.assign({},this.props,{prefixCls:i,overlay:u,alignPoint:l,trigger:a}),s)}}(function(r){r.defaultProps={trigger:"hover",prefixCls:"x6",mouseEnterDelay:.15,mouseLeaveDelay:.1,placement:"bottomLeft"}})(L2||(L2={}));const G2=b.createContext({});class Nu extends b.PureComponent{constructor(){super(...arguments);this.onHotkey=()=>{this.triggerHandler()},this.onClick=e=>{this.triggerHandler(e)}}componentDidMount(){const{hotkey:e}=this.props;e&&this.props.context.registerHotkey(e,this.onHotkey)}componentWillUnmount(){const{hotkey:e}=this.props;e&&this.props.context.unregisterHotkey(e,this.onHotkey)}triggerHandler(e){!this.props.disabled&&!this.props.hidden&&(this.props.name&&this.props.context.onClick(this.props.name,e),this.props.onClick&&this.props.onClick())}render(){return b.createElement("div",Object.assign({},Nu.getProps(this.props)),Nu.getContent(this.props,this.onClick))}}(function(r){function e(n,i){const{className:o,disabled:s,active:a,hidden:l}=n,{prefixCls:c}=n.context,u=`${c}-item`;return{className:Cr()(u,i,{[`${u}-active`]:a,[`${u}-hidden`]:l,[`${u}-disabled`]:s},o)}}r.getProps=e;function t(n,i,o,s){const{icon:a,text:l,hotkey:c,children:u}=n,{prefixCls:d}=n.context,h=`${d}-item`;return b.createElement(b.Fragment,null,b.createElement("button",{type:"button",className:`${h}-button`,onClick:i},a&&b.isValidElement(a)&&b.createElement("span",{className:`${h}-icon`},a),b.createElement("span",{className:`${h}-text`},l||u),c&&b.createElement("span",{className:`${h}-hotkey`},c),o),s)}r.getContent=t})(Nu||(Nu={}));const bK=r=>b.createElement(G2.Consumer,null,e=>b.createElement(Nu,Object.assign({context:e},r))),xK=()=>b.createElement(G2.Consumer,null,({prefixCls:r})=>b.createElement("div",{className:`${r}-item ${r}-item-divider`}));var CK=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const wK=r=>{const{hotkey:e,children:t}=r,n=CK(r,["hotkey","children"]);return b.createElement(G2.Consumer,null,i=>{const{prefixCls:o}=i,s=Nu.getProps(Object.assign({context:i},r),`${o}-submenu`);return b.createElement("div",Object.assign({},s),Nu.getContent(Object.assign({context:i},n),null,b.createElement("span",{className:`${o}-submenu-arrow`}),b.createElement("div",{className:`${o}-submenu-menu`},t)))})};class Ru extends b.PureComponent{constructor(){super(...arguments);this.onClick=(e,t)=>{this.props.stopPropagation&&t!=null&&t.stopPropagation(),this.props.onClick&&this.props.onClick(e)},this.registerHotkey=(e,t)=>{this.props.registerHotkey&&this.props.registerHotkey(e,t)},this.unregisterHotkey=(e,t)=>{this.props.unregisterHotkey&&this.props.unregisterHotkey(e,t)}}render(){const{prefixCls:e,className:t,children:n,hasIcon:i}=this.props,o=`${e}-menu`,s=G2.Provider,a={prefixCls:o,onClick:this.onClick,registerHotkey:this.registerHotkey,unregisterHotkey:this.unregisterHotkey};return b.createElement("div",{className:Cr()(o,{[`${o}-has-icon`]:i},t)},b.createElement(s,{value:a},n))}}(function(r){r.Item=bK,r.Divider=xK,r.SubMenu=wK,r.defaultProps={prefixCls:"x6",stopPropagation:!1}})(Ru||(Ru={}));const cE=r=>{const{idx:e,menuOptions:t,target:n,modelService:i,commandService:o,onHide:s}=r,{id:a,label:l,isEnabled:c=!0,isVisible:u=!0,iconName:d,submenu:h=[],active:f,hotkey:p,render:g,onClick:v}=t;if(!u)return null;if(t.type==="separator")return b.createElement(Ru.Divider,{key:String(t.id)+e});if(t.type==="root")return b.createElement(Ru,{hasIcon:!0},h.map((x,E)=>cE({idx:E,target:n,commandService:o,modelService:i,menuOptions:x,onHide:s})));if(t.submenu&&Array.isArray(t.submenu)){const x=uo.get(d),E=!c;return b.createElement(Ru.SubMenu,{key:String(a),text:l,disabled:E||h.length===0,icon:x?b.createElement(x,null):null,active:f,hotkey:p},h.map((T,P)=>cE({idx:P,target:n,commandService:o,modelService:i,menuOptions:T,onHide:s})))}const y=uo.get(d);return g?b.createElement(g,{menuItem:t,target:n,commandService:o,modelService:i,onHide:s},[b.createElement(Ru.Item,{key:String(a),text:l,disabled:!c,icon:y?b.createElement(y,null):null,active:f,hotkey:p})]):b.createElement(Ru.Item,{key:String(a),text:l,disabled:!c,icon:y?b.createElement(y,null):null,active:f,hotkey:p,onClick:()=>(0,S.mG)(void 0,void 0,void 0,function*(){yield v({menuItem:t,target:n,commandService:o,modelService:i}),s&&s()})})},EK=r=>{const{menuModel:e,target:t,onHide:n}=r,{modelService:i,commandService:o}=Yo(),[s]=VR(e);return cE({idx:-1,target:t,commandService:o,modelService:i,menuOptions:s,onHide:n})},SK=({toDispose:r})=>(b.useEffect(()=>()=>{r.dispose()},[r]),null),_K=()=>{const r=b.useRef(),e=Yo(),[t,,n]=$Y({getModel:()=>(0,S.mG)(void 0,void 0,void 0,function*(){return yield I2.getModel(e.modelService)}),initialState:{anchor:null,menuModel:null,target:null,customRender:null,toDispose:null}}),{target:i,anchor:o,menuModel:s,customRender:a,toDispose:l}=t;if(!i||!o||!s)return null;const c=()=>{n.setValue({anchor:null,menuModel:null,target:null,customRender:null,toDispose:null})},u=a?b.createElement(a,{target:i,modelService:e.modelService,onHide:c}):b.createElement(EK,{target:i,menuModel:s,onHide:c});return b.createElement("div",{className:"xflow-menu-mask",ref:r,onClick:c,onContextMenu:d=>{d.preventDefault(),d.stopPropagation()}},b.createElement(SK,{toDispose:l}),b.createElement(L2,{visible:!0,getPopupContainer:()=>r.current,overlay:u},b.createElement("div",{className:"xflow-context-menu-anchor",style:{top:o.y,left:o.x}})))},Are="CanvasContextMenu",AK=r=>{const t=!!Yo(),n=b.useMemo(()=>r.config?r.config:new bm,[r.config]);return b.createElement(k7,{createModule:iK,config:n},t&&b.createElement(_K,{config:n}))},TK=r=>e=>{const t=b.useMemo(()=>({getValue:()=>({})}),[]);return t.getValue=()=>e,b.useMemo(()=>{const i=new bm;return r(i,t),i},[t])},uE="CanvasToolbar";class rk{constructor(){this.CONFIG_TYPE=uE,this.setToolbarName=e=>{this.moduleId=uE+"__"+e},this.setToolbarModelService=e=>{this.toolbarModelService=e},this.setCustomToolbarRender=e=>{this.customRenderService=e},this.getConfig=()=>({CONFIG_TYPE:this.CONFIG_TYPE,toolbarCustomRender:this.customRenderService,toolbarModelService:this.toolbarModelService}),this.moduleId=uE+"__"+na()}dispose(){}}var ik=w(11382),dE=w(45777);const hE=b.createContext({});class MK extends b.PureComponent{constructor(){super(...arguments);this.handleClick=()=>{this.processClick()},this.handleDropdownItemClick=e=>{this.processClick(e,!1)}}processClick(e=this.props.name,t=this.props.dropdown){!this.props.disabled&&!t&&(e&&this.props.context.onClick(e),this.props.onClick&&this.props.onClick(e))}renderButton(){const{className:e,hidden:t,disabled:n,active:i,icon:o,text:s,dropdown:a,dropdownArrow:l,tooltip:c,tooltipProps:u,tooltipAsTitle:d,children:h}=this.props,{prefixCls:f}=this.props.context,p=`${f}-item`,g={onClick:this.handleClick,className:Cr()(p,{[`${p}-hidden`]:t,[`${p}-active`]:i,[`${p}-disabled`]:n,[`${p}-dropdown`]:a},e)};c&&d&&(g.title=c);const v=b.createElement("button",Object.assign({type:"button"},g),o&&b.isValidElement(o)&&b.createElement("span",{className:`${p}-icon`},o),(s||h)&&b.createElement("span",{className:`${p}-text`},s||h),a&&l&&b.createElement("span",{className:`${p}-dropdown-arrow`}));return c&&!d&&!n?b.createElement(dE.Z,Object.assign({title:c,placement:"bottom",mouseEnterDelay:0,mouseLeaveDelay:0},u),v):v}render(){const{dropdown:e,dropdownProps:t,disabled:n}=this.props,i=this.renderButton();if(e!=null&&!n){const o=b.createElement("div",null,e.type===Ru?b.cloneElement(e,{onClick:this.handleDropdownItemClick}):e),s=Object.assign(Object.assign({trigger:["click"]},t),{disabled:n,overlay:o});return b.createElement(L2,Object.assign({},s),i)}return i}}const ok=r=>b.createElement(hE.Consumer,null,e=>b.createElement(MK,Object.assign({context:e},r)));ok.defaultProps={dropdownArrow:!0};const PK=({children:r,className:e})=>b.createElement(hE.Consumer,null,({prefixCls:t})=>b.createElement("div",{className:Cr()(`${t}-group`,e)},r));class xp extends b.PureComponent{constructor(){super(...arguments);this.onClick=(e,t)=>{this.props.onClick&&this.props.onClick(e,t)}}render(){const{prefixCls:e,className:t,children:n,extra:i,size:o,align:s,hoverEffect:a}=this.props,l=`${e}-toolbar`;return b.createElement("div",{className:Cr()(l,t,{[`${l}-${o}`]:o,[`${l}-align-right`]:s==="right",[`${l}-hover-effect`]:a})},b.createElement("div",{className:`${l}-content`},b.createElement("div",{className:`${l}-content-inner`},b.createElement(hE.Provider,{value:{prefixCls:l,onClick:this.onClick}},n)),i&&b.createElement("div",{className:`${l}-content-extras`},i)))}}(function(r){r.Item=ok,r.Group=PK,r.defaultProps={prefixCls:"x6",hoverEffect:!1}})(xp||(xp={}));const OK=r=>{const e=Yo(),{item:t,layout:n}=r,i=Cr()({["xflow-toolbar-item"]:!0}),o=n==="vertical"?"":t.text;let s;if(t.icon)s=t.icon;else if(t.iconName){const h=uo.get(t.iconName);s=b.createElement(h,null)}const a=t.render,{isEnabled:l=!0}=t,{commandService:c,modelService:u}=e,d=()=>{t.onClick&&t.onClick({toolbarItem:t,commandService:c,modelService:u})};return a?b.createElement(a,Object.assign({},t,{onClick:d}),b.createElement(xp.Item,Object.assign({},t,{icon:s,text:o,className:i,disabled:!l,tooltip:t.tooltip||t.text,tooltipProps:Object.assign({placement:n==="vertical"?"left":"bottom"},t.tooltipProps),onClick:()=>{}}))):b.createElement(xp.Item,Object.assign({},t,{icon:s,text:o,className:i,hidden:!t,disabled:!l,tooltip:t.tooltip||t.text,onClick:d,tooltipProps:Object.assign(Object.assign({},t.tooltipProps),{placement:n==="vertical"?"left":"bottom"})}))},DK=r=>{const{group:e,layout:t}=r,n=b.useMemo(()=>e.name||na(),[e.name]),{items:i=[]}=e;if(i.length===0)return null;const o=Cr()({["xflow-toolbar-group"]:!0});return b.createElement(xp.Group,{className:o,key:n},i.map(s=>b.createElement(OK,{item:s,layout:t,key:s.id})))},NK=r=>{const{config:e}=r,t=e.moduleId,n=Yo(),[i,o,s,a]=rE({name:t,layout:r.layout,mainGroups:[],extraGroups:[],customRender:null});return b.useEffect(()=>{const l=new $r;if(!n.modelService.findDeferredModel(t)){const{toolbarCustomRender:u,toolbarModelService:d}=e.getConfig(),h=n.modelService.registerModel({id:t,modelFactory:()=>s,watchChange:f=>(0,S.mG)(void 0,void 0,void 0,function*(){if(d&&(yield d(f,n.modelService,l)),u){const p=g=>{f.setValue(v=>v.customRender=g)};yield u(n.modelService,p)}return l})});l.push(h)}return()=>{l.dispose()}},[]),{isModelReady:a,state:i,setState:o,toolbarModel:s}},sk=r=>{const{idx:e,groups:t,layout:n,toolbarOptions:i}=r,{hoverEffect:o=!0}=i;return b.createElement(xp,{hoverEffect:o},t.map((s,a)=>{const l=e+a;return b.createElement(DK,{key:l,group:s,layout:n})}))},RK=r=>{const{isModelReady:e,state:t}=NK(r),n=yc(r.position),{mainGroups:i=[],extraGroups:o=[],layout:s,customRender:a}=t,l=Cr()(r.className,s,"xflow-toolbar"),c=Cr()({[s]:!0,["xflow-toolbar-root"]:!0});return e?a?b.createElement("div",{className:l,style:Object.assign(Object.assign({},n),r.style)},b.createElement(a,{config:t})):b.createElement("div",{className:l,style:Object.assign(Object.assign({},n),r.style)},b.createElement("div",{className:c},i.length>0&&b.createElement(sk,{idx:"mainGroups",groups:i,layout:s,toolbarOptions:t}),o.length>0&&b.createElement(sk,{idx:"extraGroups",groups:o,layout:s,toolbarOptions:t}))):b.createElement("div",{className:l,style:Object.assign(Object.assign({},n),r.style)},b.createElement(ik.Z,{spinning:!0,size:"small"}))},kK=b.memo(RK),ak=r=>{const t=!!Yo(),n=b.useMemo(()=>r.config?r.config:new rk,[r.config]);return t?b.createElement(kK,Object.assign({},r,{config:n})):null},lk=r=>e=>{const t=b.useMemo(()=>({getValue:()=>({})}),[]);return t.getValue=()=>e,b.useMemo(()=>{const i=new rk;return r(i,t),i},[t])};var IK=w(72504),LK=w(16130),GK=w(80068),FK=w(22699),BK=w(38296),zK=w(21444),Cm;(function(r){uo.set("ZoomInOutlined",IK.Z),uo.set("ZoomOutOutlined",LK.Z),uo.set("OneToOneOutlined",GK.Z),uo.set("CompressOutlined",FK.Z),uo.set("FullscreenOutlined",BK.Z),uo.set("FullscreenExitOutlined",zK.Z),r.ZOOM_IN=Zn.GRAPH_ZOOM.id+"-zoom-in",r.ZOOM_OUT=Zn.GRAPH_ZOOM.id+"-zoom-out",r.SCALE_TO_ONE=Zn.GRAPH_ZOOM.id+"-scale-to-one",r.SCALE_TO_FIT=Zn.GRAPH_ZOOM.id+"-scale-to-fit",r.FULLSCREEN=Zn.GRAPH_ZOOM.id+"-fullscreen",r.MAX_SCALE=1.5,r.MIN_SCALE=.05,r.zoomOptions={maxScale:r.MAX_SCALE,minScale:r.MIN_SCALE},r.getToolbarConfig=({zoomFactor:e,fullscreen:t})=>[{name:"main",items:[{id:r.ZOOM_IN,tooltip:"\u653E\u5927",iconName:"ZoomInOutlined",onClick:({commandService:n})=>{n.executeCommand(Zn.GRAPH_ZOOM.id,{factor:.1,zoomOptions:r.zoomOptions})}},{id:r.ZOOM_OUT,tooltip:"\u7F29\u5C0F",iconName:"ZoomOutOutlined",onClick:({commandService:n})=>{n.executeCommand(Zn.GRAPH_ZOOM.id,{factor:-.1,zoomOptions:r.zoomOptions})}},{id:r.SCALE_TO_ONE,iconName:"OneToOneOutlined",tooltip:"\u7F29\u653E\u52301:1",isEnabled:e!==1,onClick:({commandService:n})=>{n.executeCommand(Zn.GRAPH_ZOOM.id,{factor:"real",zoomOptions:r.zoomOptions})}},{id:r.SCALE_TO_FIT,tooltip:"\u7F29\u653E\u5230\u9002\u5E94\u5C4F\u5E55",iconName:"CompressOutlined",onClick:({commandService:n})=>{n.executeCommand(Zn.GRAPH_ZOOM.id,{factor:"fit",zoomOptions:r.zoomOptions})}},{id:r.FULLSCREEN,tooltip:t?"\u9000\u51FA\u5168\u5C4F":"\u5168\u5C4F",iconName:t?"FullscreenExitOutlined":"FullscreenOutlined",onClick:({commandService:n})=>{n.executeCommand(Zn.GRAPH_FULLSCREEN.id,{})}}]}]})(Cm||(Cm={}));const Tre="CANVAS_SCALE_TOOLBAR",UK=lk(r=>{r.setToolbarModelService((e,t)=>(0,S.mG)(void 0,void 0,void 0,function*(){const n=yield m0.useValue(t);e.setValue(s=>{s.mainGroups=Cm.getToolbarConfig({zoomFactor:n.zoomFactor,fullscreen:!1})});const i=yield Wf.getModel(t);i.setValue(!1),i.watch(s=>{e.setValue(a=>{a.mainGroups=Cm.getToolbarConfig({zoomFactor:n.zoomFactor,fullscreen:s})})}),(yield m0.getModel(t)).watch(({zoomFactor:s})=>(0,S.mG)(void 0,void 0,void 0,function*(){const a=yield Wf.useValue(t);e.setValue(l=>{l.mainGroups=Cm.getToolbarConfig({zoomFactor:s,fullscreen:a})})}))}))}),VK=r=>{const e=UK(r);return b.createElement(ak,Object.assign({layout:"vertical"},r,{config:e,position:r.position||{top:12,right:12}}))};function Mre(r){const{className:e,layout:t,initialValues:n,form:i,formItems:o=[],onFinish:s,submitButton:a,buttonProps:l}=r;if(!i)return null;const c=t==="vertical"?{padding:"0px 12px"}:{padding:"8px 12px"};return React.createElement(Form,{size:"small",form:i,style:c,layout:t,onFinish:s,className:e,initialValues:n,labelCol:t==="vertical"?{span:24}:{span:8},wrapperCol:t==="vertical"?{span:24}:{span:16}},o.map(u=>React.createElement(Form.Item,Object.assign({label:u.label,name:u.name,rules:u.rules},u.itemProps),React.createElement(u.render,u.renderProps))),React.createElement(Form.Item,{wrapperCol:{offset:0,span:24}},a||React.createElement(Button,Object.assign({type:"primary",htmlType:"submit",style:{width:"100%"}},l),"\u6267\u884C\u547D\u4EE4")))}const jK=Symbol("IMinimapConfigProvider");let fE=class{constructor(){this.toDispose=new $r,this.registerHookHub=()=>(0,S.mG)(this,void 0,void 0,function*(){return wn.create(()=>{})}),this.registerHook=e=>(0,S.mG)(this,void 0,void 0,function*(){const t=new $r,n=[e.graphOptions.registerHook({name:"add minimap options",handler:i=>(0,S.mG)(this,void 0,void 0,function*(){const o=yield this.minimapConfig.getConfig();i.minimap=Object.assign({},o)})})];return t.pushAll(n),wn.create(()=>{})})}};(0,S.gn)([St(jK),(0,S.w6)("design:type",Object)],fE.prototype,"minimapConfig",void 0),fE=(0,S.gn)([Yt({contrib:wa})],fE);const Pre=r=>ManaSyringe.Module(e=>{e(IMinimapConfigProvider,{useDynamic:()=>r}),e(HookContribution)});class wm extends xo{renderMarkup(){return this.renderJSONMarkup({tagName:"rect",selector:"body"})}update(){super.update({body:{refWidth:"100%",refHeight:"100%",fill:wm.nodeFillColor}})}}wm.nodeFillColor="#31d0c6",wm.setNodeFillColor=r=>{wm.nodeFillColor=r};const HK="CanvasMiniMap",$K=()=>({grid:!1,enabled:!0,width:200,height:120,padding:8,graphOptions:{async:!0,getCellView(r){if(r.isNode())return SimpleNodeView},createCellView(r){if(r.isEdge())return null}}}),Ore=r=>{const{nodeFillColor:e,borderColor:t="#ced4de",handlerColor:n="rgba(0,0,0,.3)",miniMapClz:i="",position:o={bottom:12,right:12},minimapOptions:s={}}=r,a=React.useRef(null),l=React.useRef(r.minimapOptions),c=React.useMemo(()=>new Set([i,"xflow-minimap","minimap-instacne-"+Date.now().toString()]),[i]),u=React.useMemo(()=>()=>__awaiter(void 0,void 0,void 0,function*(){return Object.assign(Object.assign(Object.assign({},$K()),l.current),{container:a.current})}),[a]),d=usePositionStyle(o);React.useEffect(()=>{l.current=s},[l,s]),React.useEffect(()=>{e&&SimpleNodeView.setNodeFillColor(e)},[e]),React.useEffect(()=>{const f=Array.from(c).reduce((v,y)=>y?`${v}.${y}`:v,""),p=`
      ${f} .x6-widget-minimap-viewport {
        border: 1px solid ${t};
        margin: 0;
      }
      ${f} .x6-widget-minimap-viewport-zoom {
        border: 1px solid ${n};
      }
    `,g=insertCss(p);return()=>{document.head.removeChild(g)}},[t,c,n]);const h=Array.from(c).join(" ");return React.createElement(XFlowAppExtensionModule,{config:{getConfig:u,CONFIG_TYPE:HK},createModule},React.createElement("div",{ref:a,className:h,style:d}))};class WK{constructor(){this.getValue=()=>({})}dispose(){this.getValue=()=>null}}class Dre{constructor(e){this.moduleId=e}dispose(){}}const ck=b.createContext({propsProxy:null,commandService:null,modelService:null}),F2=()=>b.useContext(ck),Cp=r=>{const{className:e,position:t,style:n,children:i}=r,o=Yo(),s=yc(t),a=b.useMemo(()=>new WK,[]);if(b.useEffect(()=>()=>{a.dispose()},[a]),!o||!o.modelService)return null;a.getValue=()=>r;const l=Cr()({[e]:!!e,"xflow-workspace-panel":!0}),{commandService:c,modelService:u}=o;return b.createElement(ck.Provider,{value:{propsProxy:a,commandService:c,modelService:u}},b.createElement("div",{className:l,style:Object.assign(Object.assign({},s),n)},i))};var ZK=w(7573),XK=w(55241);const wp={HORIRONTAL_NODE:"xflow-node-horizontal-edge",VERTICAL_NODE:"xflow-node-vertical-edge",VERTICAL_GROUP:"xflow-group-vertical-edge"},B2={EDGE:"xflow-edge"},pE="XFLOW_NODE_SHAPE",uk="processing",YK=160,KK=32;var Ep;(function(r){r.id="GRAPH_STATUS_INFO";let e;(function(t){t.SUCCESS="success",t.PROCESSING="processing",t.ERROR="error",t.DEFAULT="default",t.WARNING="warning"})(e=r.StatusEnum||(r.StatusEnum={})),r.getModel=to(r.id),r.useValue=no(r.id)})(Ep||(Ep={}));var gE;(function(r){r.QUERY_GRAPH_STATUS={id:"xflow:query-graph-status",label:"\u67E5\u8BE2\u753B\u5E03\u8282\u70B9\u72B6\u6001"}})(gE||(gE={}));let z2;const{AnchorGroup:U2}=zi;ii.registry.exist(pE)?z2=ii.registry.get(pE):z2=v0.define({width:YK,height:KK,shape:pE,view:tT,ports:{groups:{top:{zIndex:2,position:{name:U2.TOP}},bottom:{zIndex:2,position:{name:U2.BOTTOM}},right:{zIndex:2,position:{name:U2.RIGHT}},left:{zIndex:2,position:{name:U2.LEFT}}}},attrs:{body:{magnet:!1,fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%",zIndex:1}},portMarkup:[{tagName:"g",selector:"xflow-port-group",className:"xflow-port-group",attrs:{width:8,height:8,x:-4,y:-4,zIndex:10,magnet:"true"},children:[{tagName:"circle",selector:"xflow-port",className:"xflow-port",attrs:{r:4,fill:"#fff",stroke:"#d9d9d9",zIndex:12}},{tagName:"polygon",selector:"xflow-port-arrow",className:"xflow-port-arrow",attrs:{points:"0,0 8,0 4,4 ",fill:"#d9d9d9",stroke:"#d9d9d9",zIndex:13,transform:"translate(-4,0)"}}]}]});const{DirectoryTree:qK,TreeNode:dk}=ZK.Z,JK=({expanded:r})=>r?React.createElement(FolderOpenFilled,null):React.createElement(FolderFilled,null),hk=r=>new z2(r),fk=r=>{const{nodeConfig:e,onMouseDown:t,graphConfig:n,modelService:i,commandService:o}=r;if(!n)return b.createElement("div",null);if(e.renderComponent)return b.createElement("div",{onMouseDown:t},b.createElement(e.renderComponent,{data:e,isNodeTreePanel:!0}));const s=n.nodeTypeParser(e)||Sy,a=n.nodeRender.get(s);return b.createElement("div",{onMouseDown:t},b.createElement(a,{commandService:o,modelService:i,data:e,isNodeTreePanel:!0}))},mE=r=>{const[e,t]=(0,b.useState)(!1),[n,i]=(0,b.useState)(),{getGraphConfig:o}=Yo();b.useEffect(()=>{o().then(f=>{i(f.appContainer)})});const{prefixClz:s,graphConfig:a,commandService:l,modelService:c,popoverContent:u,onMouseDown:d,item:h}=r;return b.createElement(b.Fragment,null,u&&b.createElement(XK.Z,{placement:"right",destroyTooltipOnHide:!0,content:u,visible:e,onVisibleChange:f=>{t(f)},getPopupContainer:()=>n||document.body},b.createElement("div",{className:`${s}-node-wrapper`,onMouseEnter:()=>{t(!0)}},fk({graphConfig:a,commandService:l,onMouseDown:d,modelService:c,nodeConfig:h}))),!u&&b.createElement("div",{className:`${s}-node-wrapper`,onMouseEnter:()=>{t(!0)}},fk({graphConfig:a,commandService:l,onMouseDown:d,modelService:c,nodeConfig:h})))},Nre=r=>{const{x6NodeFactory:e,dndOptions:t,onNodeDrop:n,state:i,onFolderExpand:o,prefixClz:s}=r,{graphProvider:a,modelService:l,commandService:c}=useXFlowApp(),[u,d]=React.useState(),[h,f]=React.useState(),[p,g]=React.useState();React.useEffect(()=>{a.getGraphInstance().then(x=>{g(x)})}),React.useEffect(()=>{if(a.getGraphOptions().then(E=>{d(E)}),!p)return;const x=new Addon.Dnd(Object.assign(Object.assign({scaled:!1,animation:!1},t),{target:p,validateNode:E=>__awaiter(void 0,void 0,void 0,function*(){const T=Object.assign(Object.assign({},E.getData()),E.getPosition());return n?yield n(T,c,l):console.error("onNodeDrop method is required in NodeTree Panel"),!1})}));f(x)},[c,t,p,a,l,n]);const v=React.useCallback(x=>E=>{if(!p||!h||!u)return;const T=u.nodeTypeParser(x),P=x.renderComponent?x.renderComponent:u.nodeRender.get(T),z=getNodeReactComponent(P,c,l),$={data:x,width:x.width||180,height:x.height||40,view:u.graphId,component:z},ne=e?e($):hk($);h.start(ne,E.nativeEvent)},[c,h,p,u,l,e]),y=React.useCallback((x=[])=>x.map(E=>{const{isDirectory:T,children:P,popoverContent:z}=E;return T?React.createElement(dk,{icon:JK,key:E.id,title:E.label,className:`${s}-tree-folder`},y(P)):React.createElement(dk,{isLeaf:!0,key:E.id,className:`${s}-tree-leaf`,icon:React.createElement("span",null),title:React.createElement(mE,{item:E,onMouseDown:v(E),popoverContent:z,prefixClz:s,modelService:l,commandService:c,graphConfig:u})})}),[c,u,l,v,s]);return React.createElement(React.Fragment,null,React.createElement("div",{className:`${s}-body`,style:r.style},!i.keyword&&React.createElement(qK,{showIcon:!0,selectable:!1,autoExpandParent:!1,onExpand:o,expandedKeys:i.expandedKeys,className:`${s}-tree`},y(i.treeData)),i.searchList.length>0&&React.createElement("ul",{className:`${s}-body-list`},i.searchList.map(x=>React.createElement("li",{key:x.id,className:`${s}-body-list-item`},React.createElement(mE,{item:x,onMouseDown:v(x),popoverContent:x.popoverContent,prefixClz:s,modelService:l,commandService:c,graphConfig:u})))),i.keyword&&i.searchList.length===0&&React.createElement(Empty,{style:{marginTop:"48px"}})))},Rre=r=>{const{prefixClz:e,onKeywordChange:t}=r,{propsProxy:n}=usePanelContext(),i=n.getValue();return React.createElement(React.Fragment,null,React.createElement("div",{className:`${e}-header`,style:r.style},i.header&&React.isValidElement(i.header)&&i.header,i.searchService&&React.createElement("div",{className:`${e}-header-search`},React.createElement(Input,{placeholder:"\u641C\u7D22\u7EC4\u4EF6",allowClear:!0,onChange:o=>t(o.target.value),style:{width:"100%",border:0}}))))},kre=r=>{const{prefixClz:e}=r,{propsProxy:t}=usePanelContext(),n=t.getValue();return React.createElement(React.Fragment,null,React.createElement("div",{className:`${e}-footer`,style:r.style},n.footer&&React.isValidElement(n.footer)&&n.footer))},QK=40,eq=40,Ire="XFLOW_TREE_PANEL_ROOT_ID",tq=r=>{const e=r&&r.headerPosition&&r.headerPosition.height||QK,t=r.footerPosition&&r.footerPosition.height||eq;return{headerStyle:yc(Object.assign({height:e,lineHeight:e,top:0,left:0,right:0},r.headerPosition)),bodyStyle:yc(Object.assign({left:0,right:0,top:e,bottom:t},r.bodyPosition)),footerStyle:yc(Object.assign({left:0,right:0,lineHeight:t,height:t,bottom:0},r.footerPosition))}};var Lre=w(45578),Em;(function(r){r.id="TREE_PANEL_MODEL",r.useModel=e=>(0,S.mG)(this,void 0,void 0,function*(){return e.awaitModel(r.id)})})(Em||(Em={}));const Gre=(r,e)=>{r.executeCommand(XFlowModelCommands.UPDATE_MODEL.id,{getModel:t=>__awaiter(void 0,void 0,void 0,function*(){return Em.useModel(t)}),updateModel:e})},Fre=r=>{const{treeDataService:e,searchService:t}=r,{modelService:n}=useXFlowApp(),[i,o,s]=createComponentModel({treeData:[],searchList:[],treeNodeList:[],expandedKeys:[],defaultExpandAll:!1,keyword:""});React.useEffect(()=>{n.findDeferredModel(Em.id)||n.registerModel({id:Em.id,modelFactory:()=>s,watchChange:c=>__awaiter(void 0,void 0,void 0,function*(){const u=yield MODELS.GRAPH_META.getModel(n),d=f=>__awaiter(void 0,void 0,void 0,function*(){const p=yield e(f,n),{treeData:g,rootNodes:v}=nq(p),y=yield c.getValidValue(),x=y.expandedKeys.length>0?y.expandedKeys:v.map(E=>E.id);return{listData:p,treeData:g,expandedKeys:x}}),h=u.watch(f=>__awaiter(void 0,void 0,void 0,function*(){const p=yield d(f);c.setValue({treeNodeList:p.listData,treeData:p.treeData,expandedKeys:p.expandedKeys,defaultExpandAll:!1,keyword:"",searchList:[]})}));return Disposable.create(()=>{h.dispose()})})})},[]);const a=React.useCallback(c=>{o(u=>{u.expandedKeys=c})},[o]),l=React.useCallback(c=>__awaiter(void 0,void 0,void 0,function*(){if(!t)return console.warn("searchService is not defined");if(c){const u=yield t(i.treeNodeList,c);o(d=>{d.keyword=c,d.searchList=u})}else o(u=>{u.keyword="",u.searchList=[]})}),[t,i.treeNodeList]);return{state:i,setState:o,onKeywordChange:l,onFolderExpand:a}};function nq(r=[]){const t=(s=>uniqBy(s,"id").reduce((c,u)=>{const d=u.parentId||TREE_ROOT_ID;return c.has(d)||c.set(d,[]),c.get(d).push(u),c},new Map))(cloneDeep(r));function n(s,a){return s.map(l=>{if(a.has(l.id)){const c=a.get(l.id);l.key=l.id,l.isDirectory=!0,l.children=n(c,a)||[]}else l.isLeaf=!0;return l})}const i=t.get(TREE_ROOT_ID)||[];return{treeData:n(i,t),rootNodes:i}}var pk;(function(r){r.id="TREE_PANEL_DATA"})(pk||(pk={}));const rq=r=>{const{headerStyle:e,bodyStyle:t,footerStyle:n}=usePanelLyaoutStyle(r),{state:i,onFolderExpand:o,onKeywordChange:s}=useTreePanelData(r);return React.createElement(React.Fragment,null,React.createElement(NodePanelHeader,Object.assign({},r,{state:i,style:e,onKeywordChange:s})),React.createElement(NodePanelBody,Object.assign({},r,{state:i,style:t,onFolderExpand:o})),React.createElement(NodePanelFooter,Object.assign({},r,{state:i,style:n})))},Bre=r=>{const e=useXflowPrefixCls("node-dnd-panel");return React.createElement(WorkspacePanel,Object.assign({},r,{className:e}),React.createElement(rq,Object.assign({},r,{prefixClz:e})))},iq=r=>new XFlowNode(r),zre=r=>{const{x6NodeFactory:e,dndOptions:t,onNodeDrop:n}=r,{graphProvider:i,modelService:o,commandService:s}=useXFlowApp(),[a,l]=React.useState(),[c,u]=React.useState(),[d,h]=React.useState();React.useEffect(()=>{i.getGraphInstance().then(p=>{h(p)}),i.getGraphOptions().then(p=>{l(p)})},[i,h,l]),React.useEffect(()=>{if(!d)return;const p=new Addon.Dnd(Object.assign(Object.assign({scaled:!1,animation:!1},t),{target:d,validateNode:g=>__awaiter(void 0,void 0,void 0,function*(){const v=Object.assign(Object.assign({},g.getData()),g.getPosition());return n?yield n(v,s,o):console.error("onNodeDrop method is required in NodeTree Panel"),!1})}));return u(p),()=>{p.dispose()}},[s,o,t,d,n]);const f=React.useCallback(p=>g=>{if(!d||!c||!a||p.isDisabled)return;const v=a.nodeTypeParser(p),y=p.renderComponent?p.renderComponent:a.nodeRender.get(v),x=getNodeReactComponent(y,s,o),E={data:p,width:p.width||180,height:p.height||40,view:a.graphId,component:x},T=e?e(E):iq(E);c.start(T,g.nativeEvent)},[s,c,d,a,o,e]);return{graphConfig:a,onMouseDown:f,modelService:o,commandService:s}},gk=r=>{const{nodeConfig:e,onMouseDown:t,graphConfig:n,modelService:i,commandService:o}=r;if(!n)return React.createElement("div",null);if(e.renderComponent)return React.createElement("div",{onMouseDown:t},React.createElement(e.renderComponent,{data:e,isNodePanel:!0}));const s=n.nodeTypeParser(e)||XFlowConstants.XFLOW_DEFAULT_NODE,a=n.nodeRender.get(s);return React.createElement("div",{onMouseDown:t},React.createElement(a,{commandService:o,modelService:i,data:e,isNodeTreePanel:!0}))},Ure=r=>{const[e,t]=React.useState(!1),{prefixClz:n,graphConfig:i,commandService:o,modelService:s,popoverContent:a,onMouseDown:l,item:c}=r;return React.createElement(React.Fragment,null,a?React.createElement(Popover,{placement:"right",destroyTooltipOnHide:!0,content:a,visible:e,onVisibleChange:u=>{t(u)}},React.createElement("div",{className:`${n}-node-wrapper`,onMouseEnter:()=>{t(!0)}},gk({graphConfig:i,commandService:o,onMouseDown:l,modelService:s,nodeConfig:c}))):React.createElement("div",{className:`${n}-node-wrapper`},gk({graphConfig:i,commandService:o,onMouseDown:l,modelService:s,nodeConfig:c})))},Vre=r=>{const{searchResult:e,prefixClz:t,onMouseDown:n,modelService:i,commandService:o,graphConfig:s}=r;return e.length===0?React.createElement(Empty,{style:{marginTop:"24px"}}):React.createElement("ul",{className:"xflow-collapse-search-list"},e.map(a=>React.createElement("li",{className:`xflow-collapse-search-list-item ${a.isDisabled?"disabled":""}`,key:a.id},React.createElement(PanelNode,{item:a,onMouseDown:n(a),popoverContent:a.popoverContent,prefixClz:t,modelService:i,commandService:o,graphConfig:s}))))},jre=r=>{const{onActiveKeyChange:e,collapseData:t,prefixClz:n,onMouseDown:i,modelService:o,commandService:s,graphConfig:a}=r,l=u=>{const{header:d,extra:h,icon:f,isCollapsed:p}=u,g=v=>{v.preventDefault(),e(u.id)};return React.createElement("div",{className:"xflow-collapse-header",onClick:g},React.createElement("div",{className:"xflow-collapse-header-icon"},isReactComponent(f)?React.createElement(f,{isCollapsed:p}):React.createElement(CaretRightOutlined,{rotate:p?0:90,style:{fontSize:"12px"}})),React.createElement("div",{className:"xflow-collapse-header-label"},isReactComponent(d)?React.createElement(d,u):d),React.createElement("div",{className:"xflow-collapse-header-extra"},isReactComponent(h)?React.createElement(h,u):h))},c=u=>React.createElement("div",{className:"xflow-collapse-content"},u.map(d=>React.createElement("div",{className:`xflow-collapse-content-item ${d.isDisabled?"disabled":""}`,key:d.id},React.createElement(PanelNode,{item:d,onMouseDown:i(d),popoverContent:d.popoverContent,prefixClz:n,modelService:o,commandService:s,graphConfig:a}))));return React.createElement("ul",{className:"xflow-collapse-list"},t.length===0&&React.createElement(Empty,{style:{marginTop:"24px"}}),t.map(u=>{const{children:d=[],isCollapsed:h,render:f}=u,p=h?"close":"open";return React.createElement("li",{className:`xflow-collapse-list-item ${p}`,key:u.id},l(u),isReactComponent(f)?React.createElement(f,u):c(d))}))},Hre=r=>{const{state:e,prefixClz:t,onActiveKeyChange:n}=r,{graphConfig:i,onMouseDown:o,modelService:s,commandService:a}=useGraphDnd(r),{searchResult:l,collapseData:c,keyword:u}=e;return React.createElement("div",{className:`${t}-body`,style:r.style},u.length===0&&React.createElement(CollapseList,{onActiveKeyChange:n,collapseData:c,onMouseDown:o,modelService:s,commandService:a,graphConfig:i,prefixClz:t}),u.length>0&&React.createElement(SearchResult,{searchResult:l,onMouseDown:o,modelService:s,commandService:a,graphConfig:i,prefixClz:t}))},$re=r=>{const{prefixClz:e,onKeywordChange:t,state:n}=r,{propsProxy:i}=usePanelContext(),o=i.getValue(),s=a=>{const l=n.collapseData.reduce((c,u)=>(u.children&&c.push(...u.children),c),[]);t(a.target.value,l)};return React.createElement(React.Fragment,null,React.createElement("div",{className:`${e}-header`,style:r.style},o.header&&React.isValidElement(o.header)&&o.header,o.searchService&&React.createElement("div",{className:`${e}-header-search`},React.createElement(Input,{placeholder:"\u641C\u7D22\u7EC4\u4EF6",allowClear:!0,onChange:a=>s(a),style:{width:"100%",border:0}}))))},Wre=r=>{const{prefixClz:e}=r,{propsProxy:t}=usePanelContext(),n=t.getValue();return React.createElement(React.Fragment,null,React.createElement("div",{className:`${e}-footer`,style:r.style},n.footer&&React.isValidElement(n.footer)&&n.footer))},Zre=r=>{const{prefixClz:e,onCollapseBtnClick:t,isCollapsed:n,collapseButtonStyle:i,style:o}=r;return React.createElement(React.Fragment,null,React.createElement("div",{className:`${e}-header`,style:Object.assign(Object.assign({},o),i),onClick:t},React.createElement(CaretLeftOutlined,{rotate:n?180:0})))},Xre=r=>{const e=r&&r.headerPosition&&r.headerPosition.height||PANEL_HEADER_HEIGHT,t=r.footerPosition&&r.footerPosition.height||PANEL_FOOTER_HEIGHT;return{headerStyle:usePositionStyle(Object.assign({height:e,lineHeight:e,top:0,left:0,right:0},r.headerPosition)),bodyStyle:usePositionStyle(Object.assign({left:0,right:0,top:e,bottom:t},r.bodyPosition)),footerStyle:usePositionStyle(Object.assign({left:0,right:0,lineHeight:t,height:t,bottom:0},r.footerPosition))}};var mk;(function(r){r.id="COLLAPSE_PANEL_DATA",r.useModel=e=>(0,S.mG)(this,void 0,void 0,function*(){return e.awaitModel(r.id)})})(mk||(mk={}));const Yre=(r,e)=>{r.executeCommand(XFlowModelCommands.UPDATE_MODEL.id,{getModel:t=>__awaiter(void 0,void 0,void 0,function*(){return NsCollapsePanelModel.useModel(t)}),updateModel:e})},Kre=r=>{const{collapsible:e,nodeDataService:t,searchService:n,onCollapseChange:i}=r,{modelService:o}=useXFlowApp(),[s,a,l]=createComponentModel({keyword:"",collapseData:[],searchResult:[]});React.useEffect(()=>{o.findDeferredModel(NsCollapsePanelModel.id)||o.registerModel({id:NsCollapsePanelModel.id,modelFactory:()=>l,watchChange:d=>__awaiter(void 0,void 0,void 0,function*(){const h=yield MODELS.GRAPH_META.getModel(o),f=g=>__awaiter(void 0,void 0,void 0,function*(){return{collapseData:yield t(g,o)}}),p=h.watch(g=>__awaiter(void 0,void 0,void 0,function*(){const{collapseData:v}=yield f(g);d.setValue(y=>{y.keyword="",y.collapseData=v,y.searchResult=[]})}));return Disposable.create(()=>{p.dispose()})})})},[]);const c=React.useCallback(d=>{a(h=>{h.collapseData.forEach(f=>{f.id===d&&f.collapsible!==!1&&(f.isCollapsed=!f.isCollapsed)})})},[a]),u=React.useCallback((d,h)=>__awaiter(void 0,void 0,void 0,function*(){if(!n)return console.warn("searchService is not defined");if(d){const f=yield n(h,d);a(p=>{p.keyword=d,p.searchResult=f})}else a(f=>{f.keyword="",f.searchResult=[]})}),[n]);return{state:s,collapsible:e,setState:a,onKeywordChange:u,onActiveKeyChange:c,onCollapseChange:i}},oq=r=>{const{headerStyle:e,bodyStyle:t,footerStyle:n}=usePanelLyaoutStyle(r),{state:i,onActiveKeyChange:o,onKeywordChange:s}=useCollapsePanelData(r);return React.createElement(React.Fragment,null,React.createElement(NodePanelHeader,Object.assign({},r,{state:i,style:e,onKeywordChange:s})),React.createElement(CollapsePanelBody,Object.assign({},r,{state:i,style:t,onActiveKeyChange:o})),React.createElement(NodePanelFooter,Object.assign({},r,{state:i,style:n})))},qre=r=>{const{position:e,collapsible:t,onCollapseChange:n}=r,{width:i=200,left:o}=e,s=useXflowPrefixCls("collapse-panel"),[a,l]=useState(!1),c=useCallback(()=>{l(!a),n(!a)},[a,n]);return React.createElement(WorkspacePanel,Object.assign({},r,{className:s,position:Object.assign(Object.assign({},e),{left:a?-i:o}),style:{transition:"left 0.5s"}}),React.createElement(oq,Object.assign({},r,{prefixClz:s})),t&&React.createElement(NodePanelCollapseBtn,Object.assign({},r,{prefixClz:s,isCollapsed:a,onCollapseBtnClick:c,style:{position:"absolute",zIndex:1,width:13,right:-13,bottom:20,padding:"12px 0px",textAlign:"center",borderWidth:"1px 1px 1px 0",borderStyle:"solid solid solid",borderColor:"rgb(232, 232, 232) rgb(232, 232, 232) rgb(232, 232, 232)",cursor:"pointer"}})))},sq=r=>{const{state:e}=r,{propsProxy:t}=F2(),n=t.getValue(),i=Yo(),o=n.footer&&typeof n.footer=="function";return b.createElement(b.Fragment,null,b.createElement("div",{className:`${r.prefixClz}-footer`,style:r.style},o&&b.createElement(n.footer,Object.assign(Object.assign({},r),{headerStyle:{},bodyStyle:{},footerStyle:r.style,targetData:e.targetData,targetType:e.targetType,modelService:i.modelService,commandService:i.commandService})),!n.footer&&b.createElement("div",{className:`${r.prefixClz}-footer-title`},n.footerText)))},aq=r=>{const{prefixClz:e,hasSchema:t,state:n}=r,{propsProxy:i}=F2(),o=i.getValue(),s=Yo();if(t)return null;const a=o.header&&typeof o.header=="function";return b.createElement(b.Fragment,null,b.createElement("div",{className:`${e}-header`,style:r.style},a&&b.createElement(o.header,Object.assign(Object.assign({},r),{headerStyle:r.style,bodyStyle:{},footerStyle:{},targetData:n.targetData,targetType:n.targetType,modelService:s.modelService,commandService:s.commandService})),!o.header&&b.createElement("div",{className:`${e}-header-title`},o.headerText||"Panel")))};var V2=w(14277),vk=w(6416),Pc=w(71257),j2=w(4107);const lq=r=>{const{text:e}=r,t=(0,S._T)(r,["text"]);return e?b.createElement(dE.Z,Object.assign({placement:"left",title:e},t),b.createElement("div",{className:"text-truncate"},e)):null};function Sp(r){if(!!r)return b.createElement(lq,{text:r})}var cq=w(27361),yk=w.n(cq);function uq(r,e){return(t,n)=>r.some(o=>typeof(o==null?void 0:o.condition)=="function")?(typeof e=="function"&&e(void 0),!0):r.some(o=>{const{name:s}=o;return s?yk()(t,s)!==yk()(n,s)?(typeof e=="function"&&e(s),!0):!1:(console.error("[Schema form]: A dependent name must be provided in the updater when the dependency condition is not a function."),!1)})}function dq(r){return r===""||r===void 0}function hq(r,e,t){const{getFieldValue:n,getFieldsValue:i}=r,{dependencies:o,hidden:s,disabled:a}=e;let l=s,c=a;return o==null||o.forEach(u=>{const{name:d,condition:h,hidden:f,disabled:p}=u;if(typeof h!="function"&&t&&d!==t)return;let g=!1;if(typeof h=="function"){const v=i();g=!!h(v)}else{if(!d){console.error("[Schema form]: A dependent name must be provided in the props genarator when the dependency condition is not a function.");return}g=n(d)===h}g&&(f!==void 0&&(l=f),p!==void 0&&(c=p))}),{hidden:l,disabled:c}}const uh=r=>{const{schema:e,children:t}=r,[n,i]=(0,b.useState)(),{dependencies:o,value:s,defaultValue:a,hidden:l,disabled:c}=e,u=(0,b.useMemo)(()=>(o==null?void 0:o.length)?uq(o,i):void 0,[o]);if(typeof t!="function")throw new Error("[Schema Form]: chilren of FormItemWrapper should be a render prop.");const d=dq(s)?a:s;return u?b.createElement(Pc.Z.Item,{noStyle:!0,shouldUpdate:u},h=>{const{hidden:f,disabled:p}=hq(h,e,n);return t({hidden:f,disabled:p,initialValue:d})}):t({hidden:l,disabled:c,initialValue:d})},bk=r=>{const{controlSchema:e}=r,{required:t,tooltip:n,extra:i,name:o,label:s,placeholder:a,rules:l}=e;return b.createElement(uh,{schema:e},({disabled:c,hidden:u,initialValue:d})=>b.createElement(Pc.Z.Item,{name:o,label:s,initialValue:d,tooltip:n,extra:Sp(i),required:t,hidden:u,rules:l},b.createElement(j2.Z,{className:"xflow-form-input",allowClear:!0,placeholder:a,disabled:c})))};var fq=w(9676);const pq=r=>{const{controlSchema:e}=r,{required:t,tooltip:n,extra:i,name:o,label:s,rules:a}=e;return b.createElement(uh,{schema:e},({hidden:l,disabled:c,initialValue:u})=>b.createElement(Pc.Z.Item,{className:"xflow-form-checkbox",name:o,rules:a,initialValue:u,tooltip:n,extra:Sp(i),required:t,hidden:l,valuePropName:"checked",getValueProps:d=>({checked:!!{true:!0,false:!1}[d]})},b.createElement(fq.Z,{disabled:c},s)))},gq=r=>{const{controlSchema:e}=r,{required:t,tooltip:n,extra:i,name:o,label:s,placeholder:a,rules:l}=e;return b.createElement(uh,{schema:e},({hidden:c,disabled:u,initialValue:d})=>b.createElement(Pc.Z.Item,{name:o,label:s,initialValue:d,tooltip:n,extra:Sp(i),required:t,hidden:c,rules:l},b.createElement(j2.Z.TextArea,{allowClear:!0,placeholder:a,rows:3,disabled:u})))};var vE=w(34041);const mq=r=>{const{controlSchema:e}=r,{required:t,tooltip:n,extra:i,name:o,label:s,placeholder:a,options:l=[],rules:c}=e;return b.createElement(uh,{schema:e},({hidden:u,disabled:d,initialValue:h})=>b.createElement(Pc.Z.Item,{name:o,label:s,initialValue:h,tooltip:n,extra:Sp(i),required:t,hidden:u,rules:c},b.createElement(vE.Z,{disabled:d,placeholder:a},l.map(f=>{const{title:p,value:g}=f;return b.createElement(vE.Z.Option,{key:g.toString(),value:g},p)}))))};var vq=w(91774),yq=w(30381),yE=w.n(yq);const bq=r=>{const{className:e,style:t,disabled:n,value:i,onChange:o}=r,[s,a]=(0,b.useState)(i?yE()(i):void 0),l=(0,b.useRef)(!1);(0,b.useEffect)(()=>{if(!l.current){l.current=!0;return}const u=yE()(i);u.isValid()&&a(u)},[i]);const c=(0,b.useCallback)((u,d)=>{const h=yE()(d);a(h.isValid()?h:void 0),typeof o=="function"&&o(h.isValid()?h.format("YYYY-MM-DD HH:mm:ss"):"")},[o]);return b.createElement(vq.Z,{showTime:!0,allowClear:!0,className:e,style:t,disabled:n,value:s,onChange:c})},xq=r=>{const{controlSchema:e}=r,{required:t,tooltip:n,extra:i,name:o,label:s,rules:a}=e;return b.createElement(uh,{schema:e},({disabled:l,hidden:c,initialValue:u})=>b.createElement(Pc.Z.Item,{name:o,label:s,initialValue:u,tooltip:n,extra:Sp(i),required:t,hidden:c,rules:a},b.createElement(bq,{style:{width:"100%"},disabled:l})))};var bE=w(85986);function H2(r){const e=Number(r);return Number.isNaN(e)?void 0:e}const Cq=r=>{const{disabled:e,placeholder:t,value:n,onChange:i}=r,[o,s]=(0,b.useState)(H2(n)),a=(0,b.useRef)(!1);(0,b.useEffect)(()=>{a.current||(a.current=!0),s(H2(n))},[n]);const l=(0,b.useCallback)(c=>{s(c),typeof i=="function"&&(c===void 0?i(""):typeof H2(c)=="number"&&i(H2(c)))},[i]);return b.createElement(bE.Z,{style:{width:"100%"},size:"small",placeholder:t,value:o,onChange:l,disabled:e})},wq=r=>{const{controlSchema:e}=r,{required:t,tooltip:n,extra:i,name:o,label:s,placeholder:a,rules:l}=e;return b.createElement(uh,{schema:e},({disabled:c,hidden:u,initialValue:d})=>b.createElement(Pc.Z.Item,{name:o,label:s,initialValue:d,tooltip:n,extra:Sp(i),required:t,hidden:u,rules:l},b.createElement(Cq,{placeholder:a,disabled:c})))};var ku;(function(r){r.INPUT="input",r.CHECKBOX="checkbox",r.TEXTAREA="textArea",r.SELECT="select",r.DATETIME="datetime",r.FLOAT="float"})(ku||(ku={}));const xk=[[ku.INPUT,bk],[ku.CHECKBOX,pq],[ku.TEXTAREA,gq],[ku.DATETIME,xq],[ku.SELECT,mq],[ku.FLOAT,wq]],Ck=r=>{const e=new Map;return r.forEach(t=>{const[n,i]=t,o=n.toLowerCase();e.has(o)&&console.error(`${n} is duplicated in controlMap:`,e),e.set(o,i)}),e},Eq=(r,e,t=bk)=>{if(e.has(r))return e.get(r);const n=r.toLowerCase();return e.has(n)?e.get(n):(console.warn(`${r} is not exist in controlmap, fallback to defaultControl`),t)},{TabPane:Sq}=vk.Z,_q=r=>{var e;const{schema:t,form:n,className:i,triggerUpdate:o,defaultControlRender:s,afterUpdatingCb:a,controlMap:l}=r,c=(0,S._T)(r,["schema","form","className","triggerUpdate","defaultControlRender","afterUpdatingCb","controlMap"]),{tabs:u}=t,[d]=Pc.Z.useForm(n),h=b.useMemo(()=>r.controlMap?r.controlMap:Ck(xk),[r.controlMap]),f=(0,b.useCallback)(g=>{typeof o=="function"&&o(d,g)},[d,o]);(0,b.useEffect)(()=>{d.setFieldsValue({})},[d]);const p=(0,b.useCallback)(()=>{requestAnimationFrame(()=>{d.setFieldsValue({})})},[d]);return b.createElement(Pc.Z,Object.assign({size:"small",form:d,layout:"vertical",className:Cr()("xflow-json-form",i)},c),b.createElement(vk.Z,{type:"card",defaultActiveKey:(e=u[0])===null||e===void 0?void 0:e.name,className:Cr()({tabs:!0,xTab:!0,singleTab:(u==null?void 0:u.length)===1,coupleTab:(u==null?void 0:u.length)===2,ternateTab:(u==null?void 0:u.length)===3}),onTabClick:p},u.map(g=>{const{name:v,groups:y}=g;return b.createElement(Sq,{key:v,tab:v},y.length===0&&b.createElement(V2.Z,{style:{padding:"24px 0"}}),y.length>0&&y.map(x=>{const{controls:E=[]}=x;return E.length===0?b.createElement(V2.Z,{style:{padding:"24px 0"}}):E.map(T=>{const{shape:P,name:z}=T,$=Eq(P,h,s);return $?b.createElement($,{key:z,form:d,controlSchema:T,triggerUpdate:f,afterUpdatingCb:a}):(console.error("\u672A\u627E\u5230\u5BF9\u5E94\u7684\u63A7\u4EF6:",P),null)})}))})))},Aq=r=>{const{schema:e={tabs:[]},triggerUpdate:t,onFieldsChange:n,afterUpdatingCb:i,defaultControlRender:o,loading:s,controlMapService:a,defaultControls:l=[]}=r,c=b.useMemo(()=>{const u=Ck([...xk,...l]);return a&&a(u),u},[a,l]);return s?b.createElement("div",{className:`${r.prefixClz}-body`,style:Object.assign(Object.assign({},r.style),{display:"flex",justifyContent:"center",alignItems:"center"})},b.createElement(ik.Z,{spinning:!0})):b.createElement("div",{className:`${r.prefixClz}-body`,style:r.style},e.tabs.length>0&&b.createElement(_q,{schema:e,onFieldsChange:n,controlMap:c,defaultControlRender:o,afterUpdatingCb:i,triggerUpdate:t}),e.tabs.length===0&&b.createElement(V2.Z,{style:{paddingTop:"64px"}}))},Tq=40,Mq=40,Pq=(r,e)=>{const t=r&&r.headerPosition&&r.headerPosition.height||Tq,n=r.footerPosition&&r.footerPosition.height||Mq;return{headerStyle:yc(Object.assign(Object.assign({height:0,top:0,left:0,right:0},e?{height:t,lineHeight:t}:{}),r.headerPosition)),bodyStyle:yc(Object.assign(Object.assign({left:0,right:0,top:0},e?{top:t,bottom:n}:{bottom:n}),r.bodyPosition)),footerStyle:yc(Object.assign(Object.assign({left:0,right:0,lineHeight:n,height:n,bottom:0},e?{lineHeight:n,height:n}:{bottom:0}),r.footerPosition))}};var Sm;(function(r){r.id="XFLOW_JSON_SCHEMA_FORM",r.useModel=e=>(0,S.mG)(this,void 0,void 0,function*(){return e.awaitModel(r.id)})})(Sm||(Sm={}));const Jre=(r,e)=>{r.executeCommand(XFlowModelCommands.UPDATE_MODEL.id,{getModel:t=>__awaiter(void 0,void 0,void 0,function*(){return Sm.useModel(t)}),updateModel:e})},Oq=r=>{const e=Yo(),{commandService:t,modelService:n,getGraphInstance:i}=e,{formSchemaService:o}=r,[s,a,l,c]=rE({schema:{tabs:[]},targetType:null,targetData:null,targetCell:null,loading:!1});return b.useEffect(()=>{if(!e||!e.modelService)return;const u=new $r;if(!e.modelService.findDeferredModel(Sm.id)){const h=e.modelService.registerModel({id:Sm.id,modelFactory:()=>l,watchChange:(f,p)=>(0,S.mG)(void 0,void 0,void 0,function*(){const v=(yield g0.getModel(p)).watch(y=>(0,S.mG)(void 0,void 0,void 0,function*(){const x=(P,z)=>(0,S.mG)(void 0,void 0,void 0,function*(){f.setValue(fe=>{fe.loading=!0,fe.schema={tabs:[]},fe.targetType=null,fe.targetData=null,fe.targetCell=null});const $=P?P.getData():null;if(!o)return;const ne=yield i(),De=yield o({commandService:t,modelService:n,targetData:$,cell:P,targetType:z,graph:ne});f.setValue({loading:!1,schema:De,targetType:z,targetCell:P,targetData:$})}),T=(P=>P?P.isNode&&P.isNode()&&P.getProp("isGroup")?"group":P.isNode&&P.isNode()?"node":P.isEdge&&P.isEdge()?"edge":"canvas":"canvas")(y);(r.targetType||["node","canvas"]).includes(T)&&(yield x(y,T))}));return wn.create(()=>{v.dispose(),u.push(v)})})});u.push(h)}return()=>{u.dispose()}},[]),{commandService:t,modelService:n,state:s,setState:a,model:l,isModelReady:c}},Dq=r=>{const{prefixClz:e}=r,{getCustomRenderComponent:t,afterUpdatingCb:n,formValueUpdateService:i=()=>{}}=r,{state:o,commandService:s,modelService:a}=Oq(r),l=b.useCallback((p,g={})=>(0,S.mG)(void 0,void 0,void 0,function*(){p.setFieldsValue(g);const v=Object.entries(g).map(([E,T])=>({name:E,value:T})),y=Object.entries(o.targetData).map(([E,T])=>({name:E,value:T})),x=yield i({allFields:y,values:v,modelService:a,commandService:s,targetData:o.targetData,targetType:o.targetType});n&&n(x)}),[n,s,i,a,o.targetData,o.targetType]),c=b.useCallback((p,g)=>(0,S.mG)(void 0,void 0,void 0,function*(){const v=yield i({values:p,allFields:g,modelService:a,commandService:s,targetData:o.targetData,targetType:o.targetType});n&&n(v)}),[n,s,i,a,o.targetData,o.targetType]),u=b.useMemo(()=>{try{return o.schema.tabs.length===0||!o.schema}catch(p){return!0}},[o.schema]),{headerStyle:d,bodyStyle:h,footerStyle:f}=Pq(r,u);if(t){const p=t(o.targetType,o.targetData,a,s);if(p)return b.createElement(p,Object.assign(Object.assign({},r),{headerStyle:d,bodyStyle:h,footerStyle:f,targetData:o.targetData,targetType:o.targetType,modelService:a,commandService:s}))}return b.createElement("div",{className:e},b.createElement(aq,Object.assign({hasSchema:!u},r,{state:o,style:d,prefixClz:r.prefixClz})),b.createElement(Aq,Object.assign({},r,{key:o.targetData&&o.targetData.id,style:h,prefixClz:r.prefixClz,loading:o.loading,schema:o.schema,triggerUpdate:l,onFieldsChange:c})),b.createElement(sq,Object.assign({},r,{state:o,style:f})))},Nq=r=>{const e=Yy("json-schema-form");return b.createElement(Cp,Object.assign({},r,{className:e}),b.createElement(Dq,Object.assign({},r,{prefixClz:e})))};wl.registry.exist(wp.VERTICAL_NODE)||kr.registerConnector(wp.VERTICAL_NODE,(r,e)=>{const t=16,n=Math.abs(e.y-r.y),i=Math.floor(n/3*2),o={x:r.x,y:r.y+t+i},s={x:e.x,y:e.y-t-i};return Dn.normalize(`M ${r.x} ${r.y}
         L ${r.x} ${r.y+t}
         C ${o.x} ${o.y} ${s.x} ${s.y} ${e.x} ${e.y-t}
         L ${e.x} ${e.y}
        `)},!0),wl.registry.exist(wp.VERTICAL_GROUP)||kr.registerConnector(wp.VERTICAL_GROUP,(r,e)=>{const t=4,n=Math.abs(e.y-r.y),i={x:r.x,y:r.y+t+n},o={x:e.x,y:e.y-t-n};return Dn.normalize(`M ${r.x} ${r.y}
       L ${r.x} ${r.y+t}
       C ${i.x} ${i.y} ${o.x} ${o.y} ${e.x} ${e.y-t}
       L ${e.x} ${e.y}
      `)},!0),wl.registry.exist(wp.HORIRONTAL_NODE)||kr.registerConnector(wp.HORIRONTAL_NODE,(r,e)=>{const t=4,n=Math.abs(e.y-r.y),i=Math.floor(n/3*2),o={x:r.x,y:r.y+t+i},s={x:e.x,y:e.y-t-i};return Dn.normalize(`M ${r.x} ${r.y}
         L ${r.x} ${r.y+t}
         C ${o.x} ${o.y} ${s.x} ${s.y} ${e.x} ${e.y-t}
         L ${e.x} ${e.y}
        `)},!0);let xE=_l.registry.get(B2.EDGE);_l.registry.exist(B2.EDGE)||(xE=_l.registry.register(B2.EDGE,_l.define({zIndex:1,highlight:!1,shape:B2.EDGE}),!0));var Wa;(function(r){r.MODEL=Ep,r.command=gE.QUERY_GRAPH_STATUS,r.hookKey="queryGraphStatus";let e;(function(t){t.SUCCESS="success",t.PROCESSING="processing",t.ERROR="error",t.DEFAULT="default",t.WARNING="warning"})(e=r.StatusEnum||(r.StatusEnum={})),r.initStatusMap=()=>({[r.StatusEnum.DEFAULT]:[],[r.StatusEnum.PROCESSING]:[],[r.StatusEnum.ERROR]:[],[r.StatusEnum.WARNING]:[],[r.StatusEnum.SUCCESS]:[]}),r.groupByStatus=t=>{const n=r.initStatusMap();return Object.entries(t).reduce((i,[o,s])=>(i[s.status].push(o),i),n)},r.statusDiff=(t,n)=>{const i=new Set([...t,...n]),o={current:[],add:[],remove:[]};return i.forEach(s=>{n.includes(s)&&!t.includes(s)&&o.add.push(s),!n.includes(s)&&t.includes(s)&&o.remove.push(s)}),o},r.shouldStop=t=>(0,S.mG)(this,void 0,void 0,function*(){return[e.ERROR,e.SUCCESS].includes(t.graphStatus)})})(Wa||(Wa={}));let CE=class{constructor(){this.statusInfo=Wa.initStatusMap(),this.getStatusModel=()=>(0,S.mG)(this,void 0,void 0,function*(){const t=this.contextProvider().getModelService();return yield Ep.getModel(t)}),this.updateModelValue=e=>(0,S.mG)(this,void 0,void 0,function*(){(yield this.getStatusModel()).setValue(e)}),this.stopCurrentStatusLooping=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=yield this.getStatusModel(),{subscription:t}=yield e.getValidValue();t.dispose()}),this.addStopDispose=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=yield this.getStatusModel(),{subscription:t}=yield e.getValidValue();t.push({dispose:()=>{this.updateEdges(this.statusInfo,Wa.initStatusMap()),this.isLooping=!1}})}),this.updateGraph=(e,t,n)=>{this.updateNodes(e,t,n),this.updateEdges(e,t)},this.updateNodeData=(e,t)=>{const n=this.x6Graph.getCellById(e);!n||n.setData(Object.assign(Object.assign(Object.assign(Object.assign({},n.getData()),n.getSize()),n.getPosition()),t))},this.updateNodes=(e,t,n)=>{Object.keys(e).forEach(i=>{const o=Wa.statusDiff(e[i],t[i]);o.add.forEach(s=>{this.updateNodeData(s,n[s])}),o.remove.forEach(s=>{this.updateNodeData(s,n[s])})})},this.updateEdges=(e,t)=>{const n=Wa.statusDiff(e.processing,t.processing);this.x6Graph.getEdges().forEach(o=>{var s;const a=(s=this.x6Graph)===null||s===void 0?void 0:s.findViewByCell(o.id),l=o.getTargetCellId();if(!l)return;const c=l.toString();if(!!a){if(n.add.includes(c))return a.addClass(uk);if(n.remove.includes(c))return a.removeClass(uk)}})},this.execute=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),i=e.getHooks();this.x6Graph=yield e.getX6Graph();const o=yield i.queryGraphStatus.call(t,s=>(0,S.mG)(this,void 0,void 0,function*(){const{graphStatusService:a,shouldStop:l=Wa.shouldStop,doOnce:c}=s;yield this.stopCurrentStatusLooping();const u=(d,h=1e4)=>(0,S.mG)(this,void 0,void 0,function*(){const f=yield d(s);this.updateModelValue(g=>{Object.entries(f.statusMap).forEach(([v,y])=>{g.statusMap.set(v,y)}),g.graphStatus=f.graphStatus});const p=Wa.groupByStatus(f.statusMap);this.updateGraph(this.statusInfo,p,f.statusMap),this.statusInfo=p,yield qY(h),!!this.isLooping&&(l&&(yield l(f,s))||(yield u(d,h)))});return this.isLooping=s.loop===void 0?!0:s.loop,yield this.addStopDispose(),c&&(yield c(s)),u(a,s.loopInterval),{}}),n);return e.setResult(o),this}),this.undo=()=>(0,S.mG)(this,void 0,void 0,function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this}),this.redo=()=>(0,S.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};(0,S.gn)([St(Dr),(0,S.w6)("design:type",Object)],CE.prototype,"contextProvider",void 0),CE=(0,S.gn)([at({token:{token:Sr,named:Wa.command.id}})],CE);const Qre=()=>{};var Iu;(function(r){r.TOP_BOTTOM="TB",r.LEFT_RIGHT="LR"})(Iu||(Iu={}));const Rq=L.defineToken("DAG_EXTENSION_CONFIG");var $2;(function(r){r.EVENT_NAME="ADD_EDGE_CMD_EVENT"})($2||($2={}));var W2;(function(r){r.router={name:"manhattan"},r.connector={name:"rounded",args:{radius:15}}})(W2||(W2={}));const eie="ant",kq=r=>{const{layout:e,router:t=W2.router,connector:n=W2.connector}=r;return{grid:!1,keyboard:{enabled:!0},selecting:{enabled:!0,multiple:!0,selectCellOnMoved:!0,showNodeSelectionBox:!1,rubberEdge:!0,rubberNode:!0,movable:!0},connecting:{sourceAnchor:e?e===Iu.TOP_BOTTOM?"bottom":"right":"center",targetAnchor:e?e===Iu.TOP_BOTTOM?"center":"left":"center",connectionPoint:"anchor",snap:{radius:20},router:t,connector:n,highlight:!0,dangling:!1,createEdge(){const o=this,s=new xE({attrs:{line:{strokeDasharray:"5 5",stroke:"#888",strokeWidth:1,targetMarker:{name:"block",args:{size:"6"}}}}}),a=l=>{const{isNew:c}=l,u=l.edge;if(c&&u.isEdge()&&u===s){const d=u.getTargetPortId(),h=u.getTargetCell();if(h&&h.isNode()){h.setPortProp(d,"connected",!1),u.attr({line:{strokeDasharray:"",targetMarker:"",stroke:"#d5d5d5"}});const f=u.getTargetPortId(),p=u.getSourcePortId(),g=u.getSourceCellId(),v=u.getTargetCellId();o.trigger($2.EVENT_NAME,{targetPortId:f,sourcePortId:p,source:g,target:v,edge:s})}}};return o.once("edge:connected",a),s},validateEdge:o=>{var s;const{edge:a}=o;return!!((s=a==null?void 0:a.target)===null||s===void 0?void 0:s.port)},validateMagnet({magnet:o,cell:s}){const a=s.getData().ports.filter(l=>l.type===zi.AnchorType.INPUT);return a.length>0?o.getAttribute("port-group")!==a[0].group:!1},validateConnection({sourceView:o,targetView:s,sourceMagnet:a,targetMagnet:l}){if(o===s||!a||!l)return!1;if(e){const g=e===Iu.TOP_BOTTOM?zi.AnchorGroup.TOP:zi.AnchorGroup.LEFT;if(a.getAttribute("port-group")===g||l.getAttribute("port-group")!==g)return!1}const c=o.cell,u=a.getAttribute("port");if(!u||c.getPort(u).type!==zi.AnchorType.OUTPUT)return!1;const h=s.cell,f=l.getAttribute("port");if(!f)return!1;const p=h.getPort(f);return p.type!==zi.AnchorType.INPUT?!1:!(p&&p.connected)}},highlighting:{nodeAvailable:{name:"className",args:{className:"available"}},magnetAvailable:{name:"className",args:{className:"available"}},magnetAdsorbed:{name:"className",args:{className:"adsorbed"}}},scaling:{max:1.05,min:.01}}};let Z2=class{constructor(){this.registerGraphCommands=e=>{e.registerCommand(Wa.command,{createCommand:this.commandFactory})},this.toDispose=new $r,this.registerHook=e=>(0,S.mG)(this,void 0,void 0,function*(){const t=new $r,n=[e.addNode.registerHook({name:"dag-add-node",handler:i=>(0,S.mG)(this,void 0,void 0,function*(){const o=s=>(0,S.mG)(this,void 0,void 0,function*(){return new z2(Object.assign({},s))});i.cellFactory=o})}),e.addEdge.registerHook({name:"dag-add-edge",handler:i=>(0,S.mG)(this,void 0,void 0,function*(){const{layout:o=Iu.TOP_BOTTOM}=yield this.propConfig.getConfig(),s=a=>(0,S.mG)(this,void 0,void 0,function*(){return new xE(Object.assign(Object.assign({},a),{id:a.id,source:{cell:a.source,port:a.sourcePortId,anchor:{name:o===Iu.TOP_BOTTOM?"bottom":"right"}},target:{cell:a.target,port:a.targetPortId,anchor:{name:o===Iu.TOP_BOTTOM?"center":"right"}},attrs:{line:{strokeDasharray:"",targetMarker:"",stroke:"#d5d5d5",strokeWidth:1}},data:Object.assign({},a)}))});i.cellFactory=s})}),e.addEdge.registerHook({name:"after add edge, set target port props",handler:(i,o)=>(0,S.mG)(this,void 0,void 0,function*(){return a=>(0,S.mG)(this,void 0,void 0,function*(){const l=yield o(a);if(l&&l.edgeCell){const c=l.edgeCell.getTargetCell(),u=l.edgeCell.getTargetPortId();c.setPortProp(u,"connected",!0)}return l})})}),e.delEdge.registerHook({name:"afetr del edge, reset target node port props",handler:(i,o)=>(0,S.mG)(this,void 0,void 0,function*(){return a=>(0,S.mG)(this,void 0,void 0,function*(){const l=yield o(a),{targetCell:c,targetPortId:u}=l;return c&&c.isNode()&&u&&c.setPortProp(u,"connected",!1),l})})}),e.afterGraphInit.registerHook({name:"call add edge to replace temp edge",handler:i=>(0,S.mG)(this,void 0,void 0,function*(){const{commandService:o,graph:s}=i;s.on($2.EVENT_NAME,a=>{o.executeCommand(Ti.ADD_EDGE.id,{edgeConfig:a}),a.edge.remove()})})}),e.graphOptions.registerHook({name:"dag-extension-x6-options",handler:i=>(0,S.mG)(this,void 0,void 0,function*(){const o=yield this.propConfig.getConfig(),s=kq(o);Object.assign(i,s)})})];return t.pushAll(n),wn.create(()=>{})}),this.registerHookHub=e=>(0,S.mG)(this,void 0,void 0,function*(){return e.registerHookHub(Wa.hookKey,new za)})}registerModel(e){e.registerModel({id:Ep.id,getInitialValue:()=>({statusMap:new Map,subscription:new $r,graphStatus:Ep.StatusEnum.DEFAULT}),watchChange:t=>(0,S.mG)(this,void 0,void 0,function*(){const{subscription:n}=yield t.getValidValue();return n})})}};(0,S.gn)([St(G1),(0,S.w6)("design:type",Function)],Z2.prototype,"commandFactory",void 0),(0,S.gn)([St(Rq),(0,S.w6)("design:type",Object)],Z2.prototype,"propConfig",void 0),Z2=(0,S.gn)([Yt({contrib:[wa,$d,Ly]})],Z2);const tie=r=>ManaSyringe.Module(e=>{e(DagHooksContribution),e(QueryGraphStatusCommand),e(IComponentConfig,{useValue:r})}),nie=r=>{const e=useExtensionRegistry();React.useEffect(()=>{e.addContainerClassNames("dag-extension-container");const n=r.layout||"TB";e.addContainerClassNames(n==="TB"?"layout-top-bottom":"layout-left-right")},[e,r.layout]);const t=React.useMemo(()=>({CONFIG_TYPE:"DAG_EXTENSION",getConfig:()=>__awaiter(void 0,void 0,void 0,function*(){return r})}),[r]);return React.createElement(XFlowAppExtensionModule,{config:t,createModule:createDagExtensionModule})},wE="XFLOW_FLOW_NODE_SHAPE",Iq=150,Lq=60;let EE;const{AnchorGroup:X2}=zi,Y2={circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}};ii.registry.exist(wE)?EE=ii.registry.get(wE):EE=v0.define({width:Iq,height:Lq,shape:wE,view:tT,ports:{groups:{top:{position:X2.TOP,attrs:Y2},bottom:{position:X2.BOTTOM,attrs:Y2},right:{position:X2.RIGHT,attrs:Y2},left:{position:X2.LEFT,attrs:Y2}}},attrs:{body:{magnet:!1,fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"}}});const Gq={grid:!0,mousewheel:{enabled:!0,zoomAtMousePosition:!0,modifiers:"ctrl",minScale:.5,maxScale:3},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:8}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,snap:{radius:20},createEdge(){return new _l({attrs:{line:{stroke:"#A2B1C3",strokeWidth:2,targetMarker:{name:"block",width:12,height:8}}},zIndex:0})},validateConnection({targetMagnet:r}){return!!r}},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5F95FF",stroke:"#5F95FF"}}}},resizing:!0,rotating:!0,selecting:{enabled:!0,rubberband:!0,showNodeSelectionBox:!0,modifiers:"shift"},snapline:!0,keyboard:!0,clipboard:!0};let wk=class{constructor(){this.toDispose=new $r,this.registerHookHub=()=>(0,S.mG)(this,void 0,void 0,function*(){return wn.create(()=>{})}),this.registerHook=e=>(0,S.mG)(this,void 0,void 0,function*(){const t=new $r,n=[e.addNode.registerHook({name:"flow-add-node",handler:i=>(0,S.mG)(this,void 0,void 0,function*(){const o=s=>(0,S.mG)(this,void 0,void 0,function*(){return new EE(Object.assign({},s))});i.cellFactory=o})}),e.addEdge.registerHook({name:"flow-add-edge",handler:i=>(0,S.mG)(this,void 0,void 0,function*(){const o=s=>(0,S.mG)(this,void 0,void 0,function*(){return delete s.id,new _l({source:{cell:s.source,port:s.sourcePortId},target:{cell:s.target,port:s.targetPortId},attrs:{line:{stroke:"#A2B1C3",strokeWidth:2,targetMarker:{name:"block",width:12,height:8}}},zIndex:-1,data:Object.assign({},s)})});i.cellFactory=o})}),e.graphOptions.registerHook({name:"assign options ",handler:i=>(0,S.mG)(this,void 0,void 0,function*(){Object.assign(i,Gq)})})];return t.pushAll(n),wn.create(()=>{})})}};wk=(0,S.gn)([Yt({contrib:wa})],wk);const rie=()=>ManaSyringe.Module(r=>{r(FlowHooksContribution)}),iie=()=>{const r=useExtensionRegistry(),e=React.useMemo(()=>({CONFIG_TYPE:"DAG_EXTENSION",getConfig:()=>__awaiter(void 0,void 0,void 0,function*(){})}),[]);return React.useEffect(()=>{const t=r.addExtension({config:e,createModule:createFlowExtensionModule});return r.addContainerClassNames("flow-extension-container"),()=>{t.dispose()}},[e,r]),null};var Fq=w(88182),Bq=w(82492),Ek=w.n(Bq),Sk=w(98244),_k=w(65425);const SE={config:{}},Ak=r=>{SE.config=Object.assign({},SE.config,r)},_m=r=>{var e;return(e=SE.config)===null||e===void 0?void 0:e[r]},Tk=new Map,Mk=new Map,zq=r=>(0,S.mG)(void 0,void 0,void 0,function*(){const e=yield r.getGraphInstance();Tk.set("x6graph",e),Mk.set("app",r)}),Pk=()=>Tk.get("x6graph"),Uq=()=>Mk.get("app"),Vq=()=>(0,S.mG)(void 0,void 0,void 0,function*(){return Uq().getGraphData()}),Am=(0,Ua.debounce)(r=>{const e=_m("onConfigChange");if(!(!e||typeof e!="function"))return e(Object.assign({data:Vq()},r))},300,{trailing:!0}),jq=(r,e)=>(0,S.mG)(void 0,void 0,void 0,function*(){const{node:t}=r;if(!t)return;const{data:n}=t;if(n==null?void 0:n.groupChildren){const o=Pk();n==null||n.groupChildren.forEach(s=>(0,S.mG)(void 0,void 0,void 0,function*(){var a,l;const c=o.getCellById(s);c&&c.isNode()&&(yield e.executeCommand(Wr.UPDATE_NODE.id,{nodeConfig:Object.assign(Object.assign(Object.assign({},c.data),(a=c.getSize)===null||a===void 0?void 0:a.call(c)),(l=c.getPosition)===null||l===void 0?void 0:l.call(c))}))}))}const i=Object.assign(Object.assign(Object.assign({},t.data),t.getPosition()),t.getSize());yield e.executeCommand(Wr.UPDATE_NODE.id,{nodeConfig:i}),Am({type:"move:node",config:i})}),Hq=(r,e)=>(0,S.mG)(void 0,void 0,void 0,function*(){const{node:t}=r;if(!t)return;const n=Object.assign(Object.assign(Object.assign({},t.data),t.getPosition()),t.size());yield e.executeCommand(Wr.UPDATE_NODE.id,{nodeConfig:n}),Am({type:"resize:node",config:n})}),$q=r=>{var e;let t=(e=r==null?void 0:r.e)===null||e===void 0?void 0:e.currentTarget;if(!t)return document.getElementsByClassName("xflow-canvas-root");let n=null;for(;!n;){const i=t.getElementsByClassName("xflow-canvas-root");(i==null?void 0:i.length)>0&&(n=i),t=t.parentNode}return n},Wq=r=>{const e=document.getElementsByClassName("x6-node-selected");if(!e)return;let t=e[0];return Array.from(e).forEach(n=>{n.getAttribute("data-cell-id")===r&&(t=n)}),t.getElementsByClassName("x6-port")},Ok=(r,e)=>{const n=r.getAttribute("transform").split(",");n[0]=`matrix(${Number(n[0].split("(")[1])*e}`,n[3]=Number(n[3])*e,r.setAttribute("transform",n.join(","))},Zq=r=>{if(!(r==null?void 0:r.length))return;const e=2;r.forEach(t=>{t.getAttribute("data-scale")||(Ok(t,e),t.setAttribute("data-scale",`${e}`))})},Xq=()=>{const r=document.getElementsByClassName("x6-port");!r||Array.from(r).forEach(e=>{const t=e.getAttribute("data-scale");t&&(Ok(e,1/Number(t)),e.removeAttribute("data-scale"))})},_E=(r,e,t)=>{var n;r||Xq();const i=$q(e),s=(n=Pk().getSelectedCells())===null||n===void 0?void 0:n[0];(s==null?void 0:s.isNode())&&t&&Zq(Wq(s.id)),Array.from(i).forEach(a=>{const l=a.querySelectorAll(".x6-port-body"),c=s==null?void 0:s.isNode();for(let u=0,d=l.length;u<d;u=u+1)l[u].style.visibility=(!c||t)&&r?"visible":"hidden"})},Yq=r=>(0,S.mG)(void 0,void 0,void 0,function*(){const{edge:e}=r;!e||e.addTools("vertices","ondbclick")}),Kq=(r,e)=>(0,S.mG)(void 0,void 0,void 0,function*(){const{edge:t}=r;!t||t.hasTools("ondbclick")&&(e.executeCommand(Ti.UPDATE_EDGE.id,{edgeConfig:Object.assign(Object.assign({},(0,Ua.get)(t,"data")),{vertices:t.getVertices()})}),t.removeTools())}),Dk=40,K2="xflow-node-panel-collpase",qq="GROUP_NODE_RENDER_ID",Bi=60,oi=40,Te=1,Tt={stroke:"#A2B1C3",fill:"#FFFFFF",fontFill:"#000",fontSize:12,label:""},Nk=[{name:"Terminal"},{name:"Process"},{name:"Decision"},{name:"Multi Document"},{name:"Connector",width:oi,height:oi},{name:"DataIO",ports:["top","bottom"]},{name:"Database"},{name:"Hard Disk"},{name:"Stroed Data"},{name:"Document"},{name:"Predefined Process"},{name:"Extract"},{name:"Merge"},{name:"Or",width:oi,height:oi},{name:"Manual Input"},{name:"Preparation"},{name:"Delay"},{name:"Manual Operation"},{name:"Display"},{name:"Off Page Link"},{name:"Note Left",label:"\u2263"},{name:"Note Right",label:"\u2263"},{name:"Internal Storage"},{name:"Text",label:"text"}],Jq=["Connector","Or"],Qq=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=[["M",Te,Te],["L",l-2*Te,Te],["L",l-2*Te,c-2*Te],["L",Te,c-2*Te],["Z"]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(u),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},eJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=[["M",l/2,Te],["L",l-2*Te,c/2],["L",l/2,c-2*Te],["L",Te,c/2],["Z"]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(u),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},tJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=c-2*Te;return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:`M ${Te},${c/2} a ${u/2} ${u/2} 0 1 1 0 1 z`,fill:o,stroke:n}),b.createElement("text",{x:c/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},nJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=c/2,d=[["M",u-Te,Te],["L",l-2*Te,Te],["L",l-u,c-2*Te],["L",Te,c-2*Te],["Z"]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(d),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},rJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=Math.min(c,l)/2,d=[["M",u,Te],["L",l-u,Te],["C",l-2*Te,Te,l-2*Te,c/2],["",l-2*Te,c/2],["C",l-2*Te,c/2,l-2*Te,c-2*Te],["",l-u,c-2*Te],["L",u,c-2*Te],["C",Te,c-2*Te,Te,c/2],["",Te,c/2],["C",Te,c/2,Te,Te],["",u,Te]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(d),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},iJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=l/4,d=Math.min(c/10,12),h=[["M",Te,Te+d],["C",Te+u,Te,Te+l-u,Te],["",l-2*Te,Te+d],["L",l-2*Te,c-2*Te-d],["C",l-2*Te-u,c-2*Te,Te+u,c-2*Te],["",Te,c-2*Te-d],["Z"]],f=[["M",Te,Te+d],["C",Te+u,Te+2*d,Te+l-u,Te+2*d],["",l-2*Te,Te+d]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(h),fill:o,stroke:n}),b.createElement("path",{d:Si(f),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},oJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=Math.min(l/10,c/4),d=Math.min(c/4,l/4),h=[["M",Te+u,Te],["L",l-2*Te-u,Te],["C",l-2*Te,Te+d,l-2*Te,c-2*Te-d],["",l-2*Te-u,c-2*Te],["L",Te+u,c-2*Te],["C",Te,c-2*Te-d,Te,Te+d],["",Te+u,Te]],f=[["M",l-2*Te-u,Te],["C",l-2*Te-2*u,Te+d,l-2*Te-2*u,c-2*Te-d],["",l-2*Te-u,c-2*Te]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(h),fill:o,stroke:n}),b.createElement("path",{d:Si(f),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},sJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=Math.min(l/10,c/4),d=Math.min(c/4,l/4),h=[["M",Te+u,Te],["L",l-2*Te-u,Te],["C",l-2*Te-2*u,Te+d,l-2*Te-2*u,c-2*Te-d],["",l-2*Te-u,c-2*Te],["L",Te+u,c-2*Te],["C",Te,c-2*Te-d,Te,Te+d],["",Te+u,Te]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(h),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},aJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=l/8,d=c/8,h=[["M",Te,Te],["L",l-2*Te,Te],["L",l-2*Te,c-2*Te-d],["C",l-2*Te-u,c-2*Te-2*d,l/2+u,c-2*Te-2*d],["",l/2,c-2*Te-d],["S",l/4,c-2*Te,Te,c-2*Te-2*d],["L",Te,Te]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(h),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},lJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,l=6,c=Te,u=l/2;let{width:d,height:h}=e;d+=l,h+=l;const f=d/8,p=h/8,g=[["M",c+u,c],["L",d-2*c,c],["L",d-2*c,h-2*c-p],["C",d-2*c-f,h-2*c-2*p,d/2+f,h-2*c-2*p],["",d/2,h-2*c-p],["S",d/4,h-2*c,c+u,h-2*c-2*p],["L",c+u,c]];return b.createElement("svg",{viewBox:`0 0 ${d} ${h}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(g),fill:o,stroke:n}),b.createElement("path",{d:Si(g,-l/2,l/2),fill:o,stroke:n}),b.createElement("text",{x:d/2,y:h/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},cJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=l/8,d=[["M",Te,Te],["L",l-2*Te,Te],["L",l-2*Te,c-2*Te],["L",Te,c-2*Te],["Z"]],h=[["M",u,Te],["L",u,c-2*Te]],f=[["M",l-u,Te],["L",l-u,c-2*Te]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(d),fill:o,stroke:n}),b.createElement("path",{d:Si(h),stroke:n}),b.createElement("path",{d:Si(f),stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},uJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=[["M",l/2,Te],["L",l-2*Te,c-2*Te],["L",Te,c-2*Te],["Z"]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(u),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},dJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=[["M",Te,Te],["L",l-2*Te,Te],["L",l/2,c-2*Te],["Z"]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(u),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},hJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=[["M",c/2,Te],["L",c/2,c-2*Te]],d=[["M",Te,c/2],["L",c-2*Te,c/2]],h=c-2*Te;return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:`M ${Te},${c/2} a ${h/2} ${h/2} 0 1 1 0 1 z`,fill:o,stroke:n}),b.createElement("path",{d:Si(u),stroke:n}),b.createElement("path",{d:Si(d),stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},fJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=[["M",Te,c/5],["L",l-2*Te,Te],["L",l-2*Te,c-2*Te],["L",Te,c-2*Te],["Z"]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(u),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},pJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=Math.tan(Math.PI/6)*(c/2),d=[["M",u,Te],["L",l-u,Te],["L",l-2*Te,c/2],["L",l-u,c-2*Te],["L",u,c-2*Te],["L",Te,c/2],["Z"]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(d),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},gJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=Math.min(c,l)/2,d=[["M",Te,Te],["L",l-u,Te],["C",l-2*Te,Te,l-2*Te,c/2],["",l-2*Te,c/2],["C",l-2*Te,c/2,l-2*Te,c-2*Te],["",l-u,c-2*Te],["L",Te,c-2*Te],["Z"]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(d),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},mJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=Math.min(Math.tan(Math.PI/6)*c,l/2),d=[["M",Te,Te],["L",l-2*Te,Te],["L",l-u,c-2*Te],["L",u,c-2*Te],["Z"]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(d),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},vJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=Math.min(c,l)/3,d=Math.min(Math.tan(Math.PI/6)*(c/2),l/3),h=[["M",d,Te],["L",l-u,Te],["C",l-2*Te,Te,l-2*Te,c/2],["",l-2*Te,c/2],["C",l-2*Te,c/2,l-2*Te,c-2*Te],["",l-u,c-2*Te],["L",d,c-2*Te],["L",Te,c/2],["Z"]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(h),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},yJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=Math.min(Math.tan(Math.PI/6)*(l/2),c/4),d=[["M",Te,Te],["L",l-2*Te,Te],["L",l-2*Te,c-u],["L",l/2,c-2*Te],["L",Te,c-u],["Z"]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(d),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},bJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o="transparent",fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=6,d=l-2*Te,h=[["M",d,Te],["C",d-u,Te,d-u,u],["",d-u,(c-u)/2],["L",d-2*u,c/2],["L",d-u,(c+u)/2],["L",d-u,c-2*Te-u],["C",d-u,c-2*Te,d,c-2*Te],["",d,c-2*Te]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(h),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},xJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o="transparent",fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=6,d=[["M",Te,Te],["C",u,Te,u,u],["",u,(c-u)/2],["L",2*u,c/2],["L",u,(c+u)/2],["L",u,c-2*Te-u],["C",u,c-2*Te,Te,c-2*Te],["",Te,c-2*Te]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(d),fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},CJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{stroke:n=Tt.stroke,label:i=Tt.label,fill:o=Tt.fill,fontFill:s=Tt.fontFill,fontSize:a=Tt.fontSize}=t,{width:l,height:c}=e,u=l-2*Te,d=c-2*Te,h=6,f=[["M",Te,Te],["L",u-h,Te],["C",u,Te,u,h],["",u,c/2],["L",u,d-h],["C",u,d,u-h,d],["",u-h,d],["L",h,d],["C",Te,d,Te,d-h],["",Te,d-h],["Z"]];return b.createElement("svg",{viewBox:`0 0 ${l} ${c}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("path",{d:Si(f),fill:o,stroke:n}),b.createElement("path",{d:`M ${Te},${h} L ${u-1} ${h} `,fill:o,stroke:n}),b.createElement("path",{d:`M ${h},${Te} L ${h} ${d} `,fill:o,stroke:n}),b.createElement("text",{x:l/2,y:c/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:a},i),"Sorry, your browser does not support inline SVG.")},wJ=r=>{const{size:e={width:Bi,height:oi},data:t={}}=r,{label:n=Tt.label,fontFill:i=Tt.fontFill,fontSize:o=Tt.fontSize}=t,{width:s,height:a}=e,l=2;return b.createElement("svg",{viewBox:`0 0 ${s/l} ${a/l}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},b.createElement("text",{x:s/(2*l),y:a/(2*l),fill:i,textAnchor:"middle",alignmentBaseline:"middle",fontSize:o},n),"Sorry, your browser does not support inline SVG.")},q2=r=>({position:{name:r},attrs:{circle:{r:4,magnet:!0,stroke:"#31d0c6",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}},zIndex:10}),Rk=(r=["top","right","bottom","left"])=>({items:r.map(e=>({group:e,id:na()})),groups:{top:q2("top"),right:q2("right"),bottom:q2("bottom"),left:q2("left")}}),EJ=r=>(r||[]).map(e=>{const{name:t,popover:n,label:i="",width:o=oi,height:s=oi,ports:a,parentKey:l}=e;return{id:na(),renderKey:t,name:t,label:i,popoverContent:n,width:o,height:s,ports:a||Rk(),originData:Object.assign({},e),isCustom:!0,parentKey:l}}),SJ=r=>(0,S.mG)(void 0,void 0,void 0,function*(){return[...EJ(r),...Nk.map(({name:t,ports:n,width:i=Bi,height:o=oi,label:s=""})=>({id:na(),renderKey:t,name:t,label:s,popoverContent:()=>t,width:i,height:o,ports:Rk(n)}))]}),kk=r=>{const e=r?(0,Ua.isArray)(r)?r:[r]:[];let t=[];e.forEach(o=>{t=t.concat(o.nodes.map(s=>Object.assign(Object.assign({},s),{parentKey:o.key})))}),t.length&&Ak({registerNode:t});const n=_m("graphConfig"),i=_m("registerNode");!n||!(i==null?void 0:i.length)||i.forEach(o=>{const{name:s,component:a}=o;n.setNodeRender(s,a)})},_J=r=>{kk(),r.nodeRender.get("Terminal")||Nk.forEach(e=>{r.setNodeRender(e.name,j[`${e.name.replace(/\s+/g,"")}Node`])})},Si=(r,e=0,t=0)=>{if(!r.length)return null;let n="";return r.forEach(i=>{const[o,s,a,l,c]=i;n+=(0,Ua.isNumber)(a)?` ${o} ${s+e} ${a+t}`:` ${o}`,c&&(n+=` ${l+e} ${c+t}`)}),n};var Ik=w(27279);const{Panel:Lk}=Ik.Z,AJ=r=>{const{x6NodeFactory:e,dndOptions:t,state:n,prefixClz:i,defaultActiveKey:o=["official"],showOfficial:s=!0}=r,a=r.registerNode?(0,Ua.isArray)(r.registerNode)?r.registerNode:[r.registerNode]:[],{graphProvider:l,modelService:c,commandService:u}=Yo(),[d,h]=b.useState(),[f,p]=b.useState();b.useEffect(()=>{l.getGraphInstance().then($=>{p($)})});let g;l.getGraphOptions().then($=>{g=$});const v=(0,b.useCallback)($=>(0,S.mG)(void 0,void 0,void 0,function*(){var ne;const{ports:De}=$,fe=Object.assign(Object.assign({},$),{id:`node-${na()}`,zIndex:10,ports:Object.assign(Object.assign({},De),{items:(ne=De.items)===null||ne===void 0?void 0:ne.map(ct=>Object.assign(Object.assign({},ct),{id:na()}))})}),Ae={nodeConfig:fe};yield u.executeCommand(Wr.ADD_NODE.id,Ae);const de=_m("onAddNode");typeof de=="function"&&de(fe)}),[u]);b.useEffect(()=>{if(!f)return;const $=new pc(Object.assign(Object.assign({scaled:!1,animation:!1},t),{target:f,validateNode:ne=>(0,S.mG)(void 0,void 0,void 0,function*(){const De=Object.assign(Object.assign({},ne.getData()),ne.getPosition());return yield v(De),!1})}));h($)},[u,t,f,c,v]);const y=b.useCallback($=>ne=>{if(!f||!d||!g)return;const De=g.nodeTypeParser($),{width:fe=180,height:Ae=40}=$,de=g.nodeRender.get(De),ct=VT(de,u,c),bt={data:$,width:fe,height:Ae,view:g.graphId,component:ct},Pe=e?e(bt):hk(bt);d.start(Pe,ne.nativeEvent)},[u,d,f,g,c,e]),x=b.useCallback(($=[])=>$.map(ne=>{const{popoverContent:De}=ne;return b.createElement(mE,{item:ne,key:ne.id,onMouseDown:y(ne),popoverContent:De,prefixClz:i,modelService:c,commandService:u,graphConfig:g})}),[u,g,c,y,i]),E=n.nodeList.filter($=>!$.isCustom),T=n.searchList.filter($=>!$.isCustom),P=$=>n.nodeList.filter(ne=>ne.isCustom&&ne.parentKey===$),z=$=>n.searchList.filter(ne=>ne.isCustom&&ne.parentKey===$);return b.createElement(b.Fragment,null,b.createElement("div",{className:`${i}-body`},b.createElement(Ik.Z,{defaultActiveKey:o,style:{border:"none"}},s&&b.createElement(Lk,{header:"\u901A\u7528\u8282\u70B9",key:"official",style:{border:"none"}},!n.keyword&&b.createElement("div",{className:`${i}-official`},x(E)),n.searchList.length>0&&b.createElement("div",{className:`${i}-official`},x(T))),(a==null?void 0:a.length)>0&&a.map($=>!$.hidden&&$.nodes.length>0&&b.createElement(Lk,{header:$.title,key:$.key,style:{border:"none"}},!n.keyword&&b.createElement("div",{className:`${i}-custom`},x(P($.key))),n.searchList.length>0&&b.createElement("div",{className:`${i}-custom`},x(z($.key)))))),n.keyword&&n.searchList.length===0&&b.createElement(V2.Z,{style:{marginTop:"48px"}})))},TJ=r=>{const{prefixClz:e,onKeywordChange:t}=r,{propsProxy:n}=F2(),i=n.getValue();return b.createElement(b.Fragment,null,b.createElement("div",{className:`${e}-header`,style:Object.assign({zIndex:1},r.style)},i.header&&b.isValidElement(i.header)&&i.header,b.createElement("div",{className:`${e}-header-search`},b.createElement(j2.Z,{placeholder:"\u641C\u7D22\u7EC4\u4EF6",allowClear:!0,onChange:o=>t(o.target.value),style:{width:"100%",border:0}}))))};var J2;(function(r){r.id="NODE_PANEL_DATA"})(J2||(J2={}));const MJ=(r=[],e)=>(0,S.mG)(void 0,void 0,void 0,function*(){return r.filter(n=>{var i,o;return n.isDirectory||((i=n.label)===null||i===void 0?void 0:i.includes(e))||((o=n.name)===null||o===void 0?void 0:o.includes(e))})}),PJ=r=>{const{searchService:e=MJ}=r,t=r.registerNode?(0,Ua.isArray)(r.registerNode)?r.registerNode:[r.registerNode]:[];let n=[];t.forEach(c=>{n=n.concat(c.nodes.map(u=>Object.assign(Object.assign({},u),{parentKey:c.key})))});const{modelService:i}=Yo(),[o,s,a]=rE({searchList:[],nodeList:[],defaultExpandAll:!1,keyword:""});b.useEffect(()=>{i.findDeferredModel(J2.id)||i.registerModel({id:J2.id,modelFactory:()=>a,watchChange:c=>(0,S.mG)(void 0,void 0,void 0,function*(){const u=yield Zf.getModel(i),d=()=>(0,S.mG)(void 0,void 0,void 0,function*(){return{listData:yield SJ(n)}}),h=u.watch(()=>(0,S.mG)(void 0,void 0,void 0,function*(){const f=yield d();c.setValue({nodeList:f.listData,defaultExpandAll:!1,keyword:"",searchList:[]})}));return wn.create(()=>{h.dispose()})})})},[]);const l=b.useCallback(c=>(0,S.mG)(void 0,void 0,void 0,function*(){if(!!e)if(c){const u=yield e(o.nodeList,c);s(d=>{d.keyword=c,d.searchList=u})}else s(u=>{u.keyword="",u.searchList=[]})}),[e,o.nodeList,s]);return{state:o,setState:s,onKeywordChange:l}},OJ=r=>{const{cell:e,data:{label:t,stroke:n,fill:i,fontSize:o,fontFill:s,width:a=200,isCollapsed:l=!1}}=r,c=Yo(),u=()=>{c.executeCommand(Co.COLLAPSE_GROUP.id,{nodeId:e.id,isCollapsed:!1,collapsedSize:{width:a,height:40}})},d=()=>{c.executeCommand(Co.COLLAPSE_GROUP.id,{nodeId:e.id,isCollapsed:!0,collapsedSize:{width:a,height:40},gap:3})};return b.createElement("div",{className:"xflow-group-node",style:{borderColor:n,backgroundColor:i,fontSize:o,color:s}},b.createElement("div",{className:"xflow-group-header"},b.createElement("div",{className:"header-left"},t),b.createElement("div",{className:"header-right"},l&&b.createElement(sT.Z,{onClick:u}),!l&&b.createElement(aT.Z,{onClick:d}))))},DJ=r=>{r.setNodeRender(qq,OJ)};var Gk;(function(r){r.id="FLOWCHART_PANEL_DATA"})(Gk||(Gk={}));const NJ=r=>{const{prefixClz:e,position:t={width:240,top:0,bottom:0,left:0},showHeader:n=!0}=r,i=(0,S._T)(r,["prefixClz","position","showHeader"]),{width:o=200}=t,{headerStyle:s,bodyStyle:a}=tq(r),{state:l,onKeywordChange:c}=PJ(r);return b.createElement(b.Fragment,null,n&&b.createElement(Cp,Object.assign({},i,{position:{top:0,left:0,height:Dk,width:o}}),b.createElement(TJ,Object.assign({},r,{state:l,style:s,onKeywordChange:c}))),b.createElement(Cp,Object.assign({className:`${K2}-nodes`},i,{position:Object.assign(Object.assign({},t),{top:n?Dk:0})}),b.createElement(AJ,Object.assign({},r,{state:l,style:a}))))},RJ=r=>{kk((0,Ua.get)(r,"registerNode"));const e=Yy("node-panel"),[t,n]=(0,b.useState)(!1),{show:i=!0,position:o={width:240,top:40,bottom:0,left:0}}=r,s=(0,S._T)(r,["show","position"]);if(!i)return null;const{width:a=200,left:l}=o;return b.createElement(Cp,{className:K2,position:Object.assign(Object.assign({},o),{left:t?-a:l})},b.createElement("div",{className:`${K2}-wrapper`},b.createElement(Cp,Object.assign({className:e},s,{position:{top:0,bottom:0,left:0,right:0}}),b.createElement(NJ,Object.assign({},r,{prefixClz:e,position:o}))),b.createElement("div",{className:`${K2}-icon`,style:{top:21,right:t?-20:-10,borderRadius:t?"0 50% 50% 0":"50%",borderLeft:t?"none":""},onClick:()=>{n(!t)}},t?b.createElement(Sk.Z,null):b.createElement(_k.Z,null))))},kJ="flowchart-connecting-edge",IJ="ant";var Q2;(function(r){r.EVENT_NAME="ADD_FLOWCHART_EDGE_CMD_EVENT"})(Q2||(Q2={}));const Fk={attrs:{line:{stroke:"#A2B1C3",targetMarker:{name:"block",width:12,height:8},strokeDasharray:"5 5",strokeWidth:1}}},LJ=_l.registry.register("xflow",_l.define({zIndex:1,highlight:!0,name:kJ,label:"",anchor:{name:"midSide",args:{dx:10}},attrs:Fk.attrs,data:{label:""}}),!0),GJ=h8((r,e)=>{const{config:t={},useConfig:n,mode:i="edit",showPortsOnNodeSelected:o=!1,edgeConfig:s={}}=e.getValue();r.setEdgeTypeParser(a=>a==null?void 0:a.renderKey),Ak(Object.assign(Object.assign({},e.getValue()),{graphConfig:r})),_J(r),DJ(r),r.setX6Config(Ek()({grid:!0,history:!0,resizing:{enabled:!0,minWidth:oi,minHeight:oi,preserveAspectRatio:a=>{const{data:l}=a;return Jq.includes(l.name)}},snapline:{enabled:!0},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:8}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,snap:{radius:20},createEdge(){const a=new LJ({});return this.once("edge:connected",l=>{const{edge:c,isNew:u}=l;if(u&&c&&c.isEdge()&&a===c){const d=c.getTargetCell();if(d&&d.isNode()){const h=c.getTargetPortId(),f=c.getSourcePortId(),p=c.getSourceCellId(),g=c.getTargetCellId(),v=typeof s=="function"?s(c):s;this.trigger(Q2.EVENT_NAME,Object.assign({targetPortId:h,sourcePortId:f,source:p,target:g,edge:c,tempEdgeId:a.id},Ek()(Fk,v)))}}}),a},validateEdge:a=>{var l;const{edge:c}=a;return!!((l=c==null?void 0:c.target)===null||l===void 0?void 0:l.port)},validateMagnet(){return!0},validateConnection({sourceView:a,targetView:l,targetMagnet:c}){if(a===l)return!1;const u=l.cell;if(c){const d=c.getAttribute("port"),h=u.getPort(d);return!(h&&h.connected)}}},highlighting:{nodeAvailable:{name:"className",args:{className:"available"}},magnetAvailable:{name:"className",args:{className:"available"}},magnetAdsorbed:{name:"className",args:{className:"adsorbed"}}},onPortRendered(a){const{port:l}=a,{contentSelectors:c}=a,u=c&&c.content,d=l.group,h=Cr()("xflow-port",{connected:l.connected});u&&pu.render(b.createElement(Fq.ZP,{prefixCls:IJ},b.createElement(dE.Z,{title:l.tooltip,placement:d},b.createElement("span",{className:h}))),u)}},t)),r.setEvents([{eventName:"node:selected",callback:()=>{i==="edit"&&_E(!1)}},{eventName:"edge:dblclick",callback:a=>{Yq(a)}},{eventName:"edge:mouseleave",callback:(a,l)=>{Kq(a,l)}},{eventName:"node:mouseenter",callback:a=>{i==="edit"&&_E(!0,a,o)}},{eventName:"node:mouseleave",callback:a=>{_E(!1,a)}},{eventName:"node:moved",callback:(a,l)=>{jq(a,l)}},{eventName:"node:resized",callback:(a,l)=>{Hq(a,l)}}]),typeof n=="function"&&n(r)});let AE=class{constructor(){this.toDispose=new $r,this.registerHookHub=()=>(0,S.mG)(this,void 0,void 0,function*(){return wn.create(()=>{})}),this.registerHook=e=>(0,S.mG)(this,void 0,void 0,function*(){const t=new $r,n=[e.afterGraphInit.registerHook({name:"call add edge to replace temp edge",handler:i=>(0,S.mG)(this,void 0,void 0,function*(){const{commandService:o,graph:s}=i;s.on(Q2.EVENT_NAME,a=>(0,S.mG)(this,void 0,void 0,function*(){const{edge:l}=a,c=(0,S._T)(a,["edge"]),{tempEdgeId:u}=c,d=(0,S._T)(c,["tempEdgeId"]),h={edgeConfig:Object.assign(Object.assign({},d),{source:{cell:c.source,port:c.sourcePortId},target:{cell:c.target,port:c.targetPortId},zIndex:1,data:Object.assign({},d)})};yield o.executeCommand(Ti.ADD_EDGE.id,h),yield o.executeCommand(Ti.DEL_EDGE.id,{edgeConfig:{id:u}});const f=s.getCellById(c.source),p=s.getCellById(c.target);yield o.executeCommand(Wr.UPDATE_NODE.id,{nodeConfig:Object.assign(Object.assign({},f.data),{incomingEdges:s.getIncomingEdges(f),outgoingEdges:s.getOutgoingEdges(f)})}),yield o.executeCommand(Wr.UPDATE_NODE.id,{nodeConfig:Object.assign(Object.assign({},p.data),{incomingEdges:s.getIncomingEdges(p),outgoingEdges:s.getOutgoingEdges(p)})});const g=_m("onAddEdge");typeof g=="function"&&g(h.edgeConfig),a.edge.remove()}))})})];return t.pushAll(n),wn.create(()=>{})})}};AE=(0,S.gn)([Yt({contrib:wa})],AE);const FJ=()=>{const r=vc(),e=b.useMemo(()=>({CONFIG_TYPE:"FLOWCHART_EXTENSION",getConfig:()=>(0,S.mG)(void 0,void 0,void 0,function*(){})}),[]);return b.useEffect(()=>{const t=r.addExtension({config:e,createModule:BJ});return r.addContainerClassNames("flowchart-extension-container"),()=>{t.dispose()}},[e,r]),null},BJ=()=>Nr(r=>{r(AE)}),Bk=r=>{const{position:e={top:40,left:240,right:240,bottom:0}}=r,t=GJ(r),n=Yo();return(0,b.useEffect)(()=>{n&&zq(n)},[n]),b.createElement(J1,Object.assign({},r,{config:t,position:e}),r.children)};Bk.defaultProps={isXFlowCanvas:!0};const zJ=r=>(0,S.mG)(void 0,void 0,void 0,function*(){var e;const{targetType:t}=r,n=(e=r.targetData)===null||e===void 0?void 0:e.isGroup,i={tabs:[{name:"\u8BBE\u7F6E",groups:[{name:"groupName",controls:[{label:"\u5206\u7EC4\u540D",name:"group-service",shape:"group-service",placeholder:"\u5206\u7EC4\u540D\u79F0"}]}]}]},o={tabs:[{name:"\u8BBE\u7F6E",groups:[{name:"groupName",controls:[{label:"\u8282\u70B9\u540D",name:"node-service",shape:"node-service",placeholder:"\u8282\u70B9\u540D\u79F0"}]}]}]},s={tabs:[{name:"\u8BBE\u7F6E",groups:[{name:"groupName",controls:[{label:"\u8FB9",name:"edge-service",shape:"edge-service",placeholder:"\u8FB9\u540D\u79F0"}]}]}]};return n?i:t==="node"?o:t==="edge"?s:{tabs:[{name:"\u8BBE\u7F6E",groups:[{name:"groupName",controls:[{label:"",name:"canvas-service",shape:"canvas-service"}]}]}]}});function UJ(r){const[e,t]=(0,b.useState)({loading:!0}),n=(0,b.useCallback)(()=>{r().then(i=>{t({loading:!1,data:i})},i=>{t({loading:!1}),console.error(i)})},[r]);return(0,b.useEffect)(()=>{n()},[n]),e}const TE=r=>{const{controlSchema:e,children:t,type:n="node"}=r,{commandService:i,modelService:o}=F2(),s=(0,b.useCallback)(()=>(0,S.mG)(void 0,void 0,void 0,function*(){const{data:f}=yield Zd.useValue(o);return f}),[o]),a=(0,b.useCallback)(()=>(0,S.mG)(void 0,void 0,void 0,function*(){const f=yield g0.useValue(o),p=f.getData();return Object.assign({id:f.id},p)}),[o]),{data:l,loading:c}=UJ(n==="edge"?a:s);b.useEffect(()=>{i.executeCommand(Zn.SAVE_GRAPH_DATA.id,{saveGraphDataService:(f,p)=>(0,S.mG)(void 0,void 0,void 0,function*(){return{err:null,data:p,meta:f}})})},[i]);const u=f=>(0,S.mG)(void 0,void 0,void 0,function*(){const p=yield s(),g=Object.assign(Object.assign({},p),f);yield i.executeCommand(Wr.UPDATE_NODE.id,{nodeConfig:g}),Am({type:"update:node",config:g})}),d=(f,p="line",g)=>(0,S.mG)(void 0,void 0,void 0,function*(){var v;const y=yield a(),x=Object.assign(Object.assign(Object.assign({},y),g?f[g]:f),{attrs:Object.assign(Object.assign({},y.attrs),{[p]:Object.assign(Object.assign({},(v=y.attrs)===null||v===void 0?void 0:v[p]),g?f[g]:f)})});yield i.executeCommand(Ti.UPDATE_EDGE.id,{edgeConfig:x}),Am({type:"update:edge",config:x})}),h=f=>(0,S.mG)(void 0,void 0,void 0,function*(){const p=yield s(),g=Object.assign(Object.assign({},p),f);yield i.executeCommand(Wr.UPDATE_NODE.id,{nodeConfig:g}),Am({type:"update:group",config:g})});return c?null:b.createElement(uh,{schema:e},()=>t(Object.assign({},l),{updateNode:u,updateEdge:d,updateGroup:h}))},Fo="flowchart-editor",ex=24,zk={attrs:{line:{stroke:"#A2B1C3",strokeWidth:1},text:{fill:"#000",fontSize:12,textAnchor:"middle",textVerticalAnchor:"middle"}}},tx={width:12,height:8,name:"block"},nx={width:0,height:0,name:""},VJ={target:{sourceMarker:nx,targetMarker:tx},source:{sourceMarker:tx,targetMarker:nx},all:{sourceMarker:tx,targetMarker:tx},none:{sourceMarker:nx,targetMarker:nx}},jJ={solid:[0,0],dash:[5,5]};var rx=r=>{const{label:e="\u6807\u7B7E",value:t,onChange:n}=r;return b.createElement("div",{className:"group"},b.createElement("label",null,e),b.createElement(j2.Z,{value:t,style:{height:ex},onChange:i=>{n==null||n(i.target.value)}}))},Uk=w(71577),HJ=w(24198);const $J=r=>{const{label:e,value:t="",onChange:n,getContainer:i}=r,[o,s]=(0,b.useState)(!1),a=(0,b.useRef)(t),l=(0,b.useRef)(),{graphProvider:c}=Yo(),u=(0,b.useRef)();c.getGraphOptions().then(p=>{u.current=p});const d=()=>b.createElement("div",{className:`${Fo}-pick-color-container`},b.createElement("div",{className:`${Fo}-popover`},b.createElement(HJ.xS,{onChange:p=>{a.current=p.hex}}),b.createElement("div",{className:"foolter"},b.createElement(Uk.Z,{onClick:()=>{s(!1)}},"\u53D6\u6D88"),b.createElement(Uk.Z,{type:"primary",onClick:()=>{n==null||n(a.current),s(!1)}},"\u786E\u8BA4")))),h=(p,g)=>{const v=document.getElementsByClassName(g);if(v.length===1)return v[0];let y=null,x=p.parentElement;for(;!y;){const E=x.getElementsByClassName(g);(E==null?void 0:E.length)>0&&(y=E[0]),x=x.parentElement}return y},f=()=>{var p;const g=(p=i==null?void 0:i())!==null&&p!==void 0?p:h(l.current,"flowchart-editor-panel-body");return(0,pu.createPortal)(b.createElement(d,null),g)};return b.createElement("div",{className:"group",ref:l},e&&b.createElement("label",null,e),b.createElement("div",{className:`${Fo}-color-container`,onClick:()=>{s(!0)}},b.createElement("div",{className:`${Fo}-color`,style:{backgroundColor:t,height:"100%"}})),o&&f())};var Oc=(0,b.memo)($J,(r,e)=>r.label===e.label&&r.value===e.value),Tm=r=>{const{label:e,value:t,onChange:n,min:i,width:o}=r;return b.createElement("div",{className:"group"},e&&b.createElement("label",null,e),b.createElement(bE.Z,{value:t,min:i,style:{width:o,height:ex},onChange:s=>{n==null||n(s)}}))};const ix=({value:r,onChangeItem:e,addonBefore:t})=>b.createElement("div",{className:"addon-before-group"},b.createElement(bE.Z,{value:r,style:{height:ex,border:"none"},onChange:n=>{e(n)}}),b.createElement("span",null,t));var ME=r=>{const{label:e="\u4F4D\u7F6E",x:t,y:n,onChange:i}=r;return b.createElement("div",{className:"group"},b.createElement("label",null,e),b.createElement("div",{className:"split"},b.createElement(ix,{addonBefore:"X",value:t,onChangeItem:o=>{i==null||i("x",o)}}),b.createElement(ix,{addonBefore:"Y",value:n,onChangeItem:o=>{i==null||i("y",o)}})))},PE=r=>{const{width:e,height:t,label:n="\u5C3A\u5BF8",onChange:i}=r;return b.createElement("div",{className:"group"},b.createElement("label",null,n),b.createElement("div",{className:"split"},b.createElement(ix,{addonBefore:"W",value:e,onChangeItem:o=>{i==null||i("width",o)}}),b.createElement(ix,{addonBefore:"H",value:t,onChangeItem:o=>{i==null||i("height",o)}})))},OE=r=>{const{label:e="\u7BAD\u5934",value:t,onChange:n,options:i=[],width:o}=r;return b.createElement("div",{className:"group"},b.createElement("label",null,e),b.createElement(vE.Z,{size:"small",value:t,style:{width:o,height:ex},getPopupContainer:s=>s.parentNode,optionFilterProp:"children",onChange:s=>{n==null||n(s)},filterOption:(s,a)=>{const{label:l=""}=a;return typeof l=="string"?l.toLowerCase().indexOf(s.toLowerCase())>=0:l.toString().indexOf(s.toLowerCase())>=0},options:i}))};const uie={InputFiled:rx,ColorPicker:Oc,InputNumberFiled:Tm,Size:PE,Position:ME,SelectField:OE},WJ=r=>{const{config:e,plugin:t={}}=r,{updateNode:n}=t,[i,o]=(0,b.useState)(Object.assign(Object.assign({},Tt),e)),s=(a,l)=>{o(Object.assign(Object.assign({},i),{[a]:l})),n({[a]:l})};return(0,b.useEffect)(()=>{o(Object.assign(Object.assign({},Tt),e))},[e]),b.createElement("div",{className:`${Fo}-panel-body`},b.createElement("div",{className:`${Fo}-panel-group`},b.createElement("h5",null,"\u5185\u5BB9"),b.createElement(rx,{label:"\u6807\u9898",value:i.label,onChange:a=>{s("label",a)}})),b.createElement("div",{className:`${Fo}-panel-group`},b.createElement("h5",null,"\u6837\u5F0F"),b.createElement(ME,{x:i.x,y:i.y,onChange:(a,l)=>{s(a,l)}}),b.createElement(PE,{width:i.width,height:i.height,onChange:(a,l)=>{s(a,l)}}),b.createElement(Oc,{label:"\u586B\u5145",value:i.fill,onChange:a=>{s("fill",a)}}),b.createElement(Oc,{label:"\u8FB9\u6846",value:i.stroke,onChange:a=>{s("stroke",a)}}),b.createElement("div",{className:`${Fo}-node-text-style`},b.createElement(Tm,{label:"\u5B57\u53F7",value:i.fontSize,width:68,onChange:a=>{s("fontSize",a)}}),b.createElement(Oc,{value:i.fontFill,onChange:a=>{s("fontFill",a)}}))))},Vk=r=>b.createElement(TE,Object.assign({},r),(e,t)=>b.createElement(WJ,Object.assign({},r,{plugin:t,config:e}))),ZJ=r=>{const{config:e,plugin:t={}}=r,{updateEdge:n}=t,[i,o]=(0,b.useState)(Object.assign(Object.assign({},zk),e));(0,b.useEffect)(()=>{o(Object.assign(Object.assign({},zk),e))},[e]);const s=(u,d="line")=>{var h;const{attrs:f={}}=i;return(h=f[d])===null||h===void 0?void 0:h[u]},a=()=>{var u,d,h,f,p;const{attrs:g={}}=i,{line:v={}}=g;return((u=v.sourceMarker)===null||u===void 0?void 0:u.name)&&((d=v.targetMarker)===null||d===void 0?void 0:d.name)?"all":!((h=v.sourceMarker)===null||h===void 0?void 0:h.name)&&!((f=v.targetMarker)===null||f===void 0?void 0:f.name)?"none":((p=v.sourceMarker)===null||p===void 0?void 0:p.name)?"source":"target"},l=()=>{const{attrs:u={}}=i,{line:d={}}=u;return d.strokeDasharray?"dash":"solid"},c=(u,d,h="line")=>{var f,p;o(u==="arrow"?Object.assign(Object.assign({},i),{attrs:Object.assign(Object.assign({},i.attrs),{[h]:Object.assign(Object.assign({},(f=i.attrs)===null||f===void 0?void 0:f[h]),d)})}):Object.assign(Object.assign({},i),{[u]:d,attrs:Object.assign(Object.assign({},i.attrs),{[h]:Object.assign(Object.assign({},(p=i.attrs)===null||p===void 0?void 0:p[h]),{[u]:d})})})),n({[u]:d},h,u==="arrow"?"arrow":"")};return b.createElement("div",{className:`${Fo}-panel-body`},b.createElement("div",{className:`${Fo}-panel-group`},b.createElement("h5",null,"\u5185\u5BB9"),b.createElement(rx,{label:"\u6807\u7B7E",value:i.label,onChange:u=>{c("label",u)}})),b.createElement("h5",{style:{marginBottom:12}},"\u6837\u5F0F"),b.createElement("div",{className:`${Fo}-panel-group`,style:{marginBottom:0}},b.createElement("h5",null,"\u7EBF"),b.createElement(OE,{label:"\u7BAD\u5934",value:a(),width:"100%",options:[{label:"\u6B63\u5411",value:"target"},{label:"\u9006\u5411",value:"source"},{label:"\u53CC\u5411",value:"all"},{label:"\u65E0",value:"none"}],onChange:u=>{c("arrow",VJ[u],"line")}}),b.createElement("div",{className:`${Fo}-edge-stroke-style`},b.createElement(OE,{label:"\u7EBF\u5F62",width:68,value:l(),options:[{label:"\u5B9E\u7EBF",value:"solid"},{label:"\u865A\u7EBF",value:"dash"}],onChange:u=>{c("strokeDasharray",jJ[u],"line")}}),b.createElement(Tm,{value:s("strokeWidth"),min:1,onChange:u=>{c("strokeWidth",u,"line")}})),b.createElement(Oc,{label:"\u8FB9\u6846",value:s("stroke"),onChange:u=>{c("stroke",u,"line")}})),b.createElement("div",{className:`${Fo}-panel-group`},b.createElement("h5",null,"\u6807\u7B7E"),b.createElement("div",{className:`${Fo}-edge-text-style`},b.createElement(Tm,{label:"\u5B57\u53F7",min:10,width:68,value:s("fontSize","text")||12,onChange:u=>{c("fontSize",u,"text")}}),b.createElement(Oc,{value:s("fill","text")||"#000",onChange:u=>{c("fill",u,"text")}}))))},jk=r=>b.createElement(TE,Object.assign({},r,{type:"edge"}),(e,t)=>b.createElement(ZJ,Object.assign({},r,{plugin:t,config:e}))),XJ=r=>{const{config:e,plugin:t={}}=r,{updateGroup:n}=t,[i,o]=(0,b.useState)(Object.assign(Object.assign({},Tt),e)),s=(a,l)=>{o(Object.assign(Object.assign({},i),{[a]:l})),n({[a]:l})};return(0,b.useEffect)(()=>{o(Object.assign(Object.assign({},Tt),e))},[e]),b.createElement("div",{className:`${Fo}-panel-body`},b.createElement("div",{className:`${Fo}-panel-group`},b.createElement("h5",null,"\u5185\u5BB9"),b.createElement(rx,{label:"\u6807\u9898",value:i.label,onChange:a=>{s("label",a)}})),b.createElement("div",{className:`${Fo}-panel-group`},b.createElement("h5",null,"\u6837\u5F0F"),b.createElement(ME,{x:i.x,y:i.y,onChange:(a,l)=>{s(a,l)}}),b.createElement(PE,{width:i.width,height:i.height,onChange:(a,l)=>{s(a,l)}}),b.createElement(Oc,{label:"\u586B\u5145",value:i.fill,onChange:a=>{s("fill",a)}}),b.createElement(Oc,{label:"\u8FB9\u6846",value:i.stroke,onChange:a=>{s("stroke",a)}}),b.createElement("div",{className:`${Fo}-node-text-style`},b.createElement(Tm,{label:"\u5B57\u53F7",value:i.fontSize,width:68,onChange:a=>{s("fontSize",a)}}),b.createElement(Oc,{value:i.fontFill,onChange:a=>{s("fontFill",a)}}))))},Hk=r=>b.createElement(TE,Object.assign({},r),(e,t)=>b.createElement(XJ,Object.assign({},r,{plugin:t,config:e}))),$k=()=>b.createElement("div",{className:`${Fo}-canvas-panel`},b.createElement("span",null,"\u672A\u9009\u4E2D")),YJ=r=>(r.set("node-service",Vk),r.set("edge-service",jk),r.set("group-service",Hk),r.set("canvas-service",$k),r),die={NodeService:Vk,EdgeService:jk,GroupService:Hk,CanvasService:$k},DE="xflow-editor-panel-collpase",KJ=r=>{const[e,t]=(0,b.useState)(!1),{controlMapService:n=YJ,formSchemaService:i=zJ,position:o={width:240,top:0,bottom:0,right:0},show:s=!0}=r,a=(0,S._T)(r,["controlMapService","formSchemaService","position","show"]);if(!s)return null;const{width:l=200,right:c}=o;return b.createElement(Cp,{className:DE,position:Object.assign(Object.assign({},o),{right:e?-l:c})},b.createElement("div",{className:`${DE}-wrapper`},b.createElement(Nq,Object.assign({targetType:["node","edge","canvas","group"],controlMapService:n,formSchemaService:i,position:Object.assign(Object.assign({},o),{top:0}),prefixClz:"xflow-form-editor"},a)),b.createElement("div",{className:`${DE}-icon`,style:{top:21,left:e?-20:-10,borderRadius:e?"50% 0 0  50%":"50%",borderRight:e?"none":""},onClick:()=>{t(!e)}},e?b.createElement(_k.Z,null):b.createElement(Sk.Z,null))))};var NE={},qJ=function(r,e,t){NE[e]={config:r,container:t}},Wk=new Map,Zk=new Map,JJ=function(r,e,t){Wk.set("".concat(t,"-x6graph"),r),Zk.set("".concat(t,"-app"),e)},Xk=function(r){return Wk.get("".concat(r,"-x6graph"))},QJ=function(r){return Zk.get("".concat(r,"-app"))},RE=function(r,e){var t,n;return(n=(t=NE[r])===null||t===void 0?void 0:t.config)===null||n===void 0?void 0:n[e]},hie=function(r,e){var t,n;return e===void 0&&(e="container"),(n=(t=NE[r])===null||t===void 0?void 0:t[e])===null||n===void 0?void 0:n.current},kE=function(){return kE=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},kE.apply(this,arguments)},ox=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(n.next(u))}catch(d){s(d)}}function l(u){try{c(n.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},sx=function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(t=0)),t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(u){c=[6,u],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},eQ=window.console,Yk=function(r){return ox(void 0,void 0,void 0,function(){var e,t;return sx(this,function(n){switch(n.label){case 0:return e=QJ(r),[4,e.executeCommand(Zn.SAVE_GRAPH_DATA.id,{saveGraphDataService:function(i,o){return ox(void 0,void 0,void 0,function(){return sx(this,function(s){return t=o,[2]})})}})];case 1:return n.sent(),[2,t]}})})},Kk=function(r,e){return ox(void 0,void 0,void 0,function(){var t,n,i,o;return sx(this,function(s){switch(s.label){case 0:return((i=e==null?void 0:e.nodes)===null||i===void 0?void 0:i.length)?[4,r.executeCommand(Zn.LOAD_DATA.id,{loadDataService:function(){return ox(void 0,void 0,void 0,function(){return sx(this,function(a){return[2,e]})})}})]:[2];case 1:return t=s.sent(),n=((o=t==null?void 0:t.contextProvider())===null||o===void 0?void 0:o.getResult()).graphData,[4,r.executeCommand(Zn.GRAPH_RENDER.id,{graphData:n})];case 2:return s.sent(),[2]}})})},fie=function(r){var e,t,n,i=(e=r==null?void 0:r.e)===null||e===void 0?void 0:e.currentTarget;if(!i)return(t=document.getElementsByClassName("xflow-canvas-container")[0])===null||t===void 0?void 0:t.getAttribute("data-flowchart-id");for(var o=null;!o;){var s=i.getElementsByClassName("xflow-canvas-container");(s==null?void 0:s.length)>0&&(o=s),i=i.parentNode}return(n=o[0])===null||n===void 0?void 0:n.getAttribute("data-flowchart-id")},tQ=function(r,e,t){t===void 0&&(t=!1);var n;return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var s=this;if(t){r.apply(s,i),t=!1;return}clearTimeout(n),n=window.setTimeout(function(){r.apply(s,i)},e)}},nQ=function(r){return Xk(r).history},pie=tQ(function(r,e){var t=RE(e,"onConfigChange");if(!(!t||typeof t!="function"))return t(kE({data:Yk(e)},r))},300,!0),rQ=w(92104),iQ=w(258),oQ=w(55934),sQ=w(81455),aQ=w(18094),lQ=w(36371),cQ=w(50827),uQ=w(99165),dQ=w(13105),hQ="undo-cmd",fQ="redo-cmd",pQ="save-graph-data",gQ="front-node",mQ="back-node",vQ="graph-toggle-multi-select",yQ="add-group",bQ="del-group",xQ="graph-copy-selection",CQ="graph-paste-selection",ho={UNDO_CMD:hQ,REDO_CMD:fQ,SAVE_GRAPH_DATA:pQ,FRONT_NODE:gQ,BACK_NODE:mQ,MULTI_SELECT:vQ,ADD_GROUP:yQ,DEL_GROUP:bQ,COPY:xQ,PASTE:CQ},fo=function(){return fo=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},fo.apply(this,arguments)},hs=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(n.next(u))}catch(d){s(d)}}function l(u){try{c(n.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},fs=function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(t=0)),t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(u){c=[6,u],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},ps;(function(r){r.BACK_NODE=Wr.BACK_NODE.id,r.FRONT_NODE=Wr.FRONT_NODE.id,r.SAVE_GRAPH_DATA=Zn.SAVE_GRAPH_DATA.id,r.REDO_CMD="".concat(Zn.REDO_CMD.id),r.UNDO_CMD="".concat(Zn.UNDO_CMD.id),r.MULTI_SELECT="".concat(Zn.GRAPH_TOGGLE_MULTI_SELECT.id),r.ADD_GROUP="".concat(Co.ADD_GROUP.id),r.DEL_GROUP="".concat(Co.DEL_GROUP.id),r.COPY="".concat(Zn.GRAPH_COPY.id),r.PASTE="".concat(Zn.GRAPH_PASTE.id)})(ps||(ps={}));var Mm;(function(r){var e=this;r.getDependencies=function(t){return hs(e,void 0,void 0,function(){var n;return fs(this,function(i){switch(i.label){case 0:return[4,Xd.getModel(t)];case 1:return n=[i.sent()],[4,$f.getModel(t)];case 2:return[2,n.concat([i.sent()])]}})})},r.getToolbarState=function(t){return hs(e,void 0,void 0,function(){var n,i,o,s,a;return fs(this,function(l){switch(l.label){case 0:return[4,$f.useValue(t)];case 1:return n=l.sent().isEnable,[4,Vy.useValue(t)];case 2:return i=l.sent(),[4,jy.useValue(t)];case 3:return o=l.sent(),[4,Wy.useValue(t)];case 4:return s=l.sent(),[4,$y.useValue(t)];case 5:return a=l.sent(),[2,{isUndoable:s,isRedoable:a,isNodeSelected:o,isGroupSelected:i,isMultiSelctionActive:n}]}})})},r.getToolbarItems=function(t,n,i,o){return hs(e,void 0,void 0,function(){var s,a,l,c,u=this;return fs(this,function(d){return s=[],a=nQ(o),l=Xk(o),c=l.getSelectedCells(),s.push(fo(fo({},n(ho.UNDO_CMD)),{id:ps.UNDO_CMD,isEnabled:a.canUndo(),onClick:function(){return hs(u,void 0,void 0,function(){return fs(this,function(h){return a.undo(),[2]})})}})),s.push(fo(fo({},n(ho.REDO_CMD)),{id:ps.REDO_CMD,isEnabled:a.canRedo(),onClick:function(){return hs(u,void 0,void 0,function(){return fs(this,function(h){return a.redo(),[2]})})}})),s.push(fo(fo({},n(ho.FRONT_NODE)),{id:ps.FRONT_NODE,isEnabled:t.isNodeSelected,onClick:function(h){var f=h.commandService,p=h.modelService;return hs(u,void 0,void 0,function(){var g;return fs(this,function(v){switch(v.label){case 0:return[4,Zd.useValue(p)];case 1:return g=v.sent(),f.executeCommand(ps.FRONT_NODE,{nodeId:g==null?void 0:g.id}),[2]}})})}})),s.push(fo(fo({},n(ho.BACK_NODE)),{id:ps.BACK_NODE,isEnabled:t.isNodeSelected,onClick:function(h){var f=h.commandService,p=h.modelService;return hs(u,void 0,void 0,function(){var g;return fs(this,function(v){switch(v.label){case 0:return[4,Zd.useValue(p)];case 1:return g=v.sent(),f.executeCommand(ps.BACK_NODE,{nodeId:g==null?void 0:g.id}),[2]}})})}})),s.push(fo(fo({},n(ho.MULTI_SELECT)),{id:ps.MULTI_SELECT,active:t.isMultiSelctionActive,onClick:function(h){var f=h.commandService;return hs(u,void 0,void 0,function(){return fs(this,function(p){return f.executeCommand(ps.MULTI_SELECT,{}),[2]})})}})),s.push(fo(fo({},n(ho.ADD_GROUP)),{id:ps.ADD_GROUP,isEnabled:t.isNodeSelected,onClick:function(h){var f=h.commandService,p=h.modelService;return hs(u,void 0,void 0,function(){var g,v;return fs(this,function(y){switch(y.label){case 0:return[4,Ol.useValue(p)];case 1:return g=y.sent(),v=g.map(function(x){return x.id}),f.executeCommand(ps.ADD_GROUP,{nodeConfig:{id:na(),renderKey:"GROUP_NODE_RENDER_ID",groupChildren:v,groupCollapsedSize:{width:200,height:40},label:"\u65B0\u5EFA\u7FA4\u7EC4"}}),[2]}})})}})),s.push(fo(fo({},n(ho.DEL_GROUP)),{id:ps.DEL_GROUP,isEnabled:t.isGroupSelected,onClick:function(h){var f=h.commandService,p=h.modelService;return hs(u,void 0,void 0,function(){var g,v;return fs(this,function(y){switch(y.label){case 0:return[4,Zd.useValue(p)];case 1:return g=y.sent(),v=g.getData(),f.executeCommand(Co.DEL_GROUP.id,{nodeConfig:v}),[2]}})})}})),s.push(fo(fo({},n(ho.COPY)),{id:ps.COPY,isEnabled:!!(c==null?void 0:c.length),onClick:function(h){var f=h.commandService;return hs(u,void 0,void 0,function(){return fs(this,function(p){return f.executeCommand(Zn.GRAPH_COPY.id,{}),[2]})})}})),s.push(fo(fo({},n(ho.PASTE)),{id:ho.PASTE,isEnabled:!0,onClick:function(h){var f=h.commandService;return hs(u,void 0,void 0,function(){return fs(this,function(p){return f.executeCommand(Zn.GRAPH_PASTE.id,{}),[2]})})}})),s.push(fo(fo({},n(ho.SAVE_GRAPH_DATA)),{id:ps.SAVE_GRAPH_DATA,onClick:function(h){var f=h.commandService;return hs(u,void 0,void 0,function(){return fs(this,function(p){return f.executeCommand(ps.SAVE_GRAPH_DATA,{saveGraphDataService:function(g,v){var y=RE(o,"onSave");if(y)return y(v)}}),[2]})})}})),[2,[{name:"graphData",items:s.filter(function(h){return!!(h==null?void 0:h.iconName)}).sort(function(h,f){return i.findIndex(function(p){return p.command===h.command})-i.findIndex(function(p){return p.command===f.command})})}]]})})}})(Mm||(Mm={}));var wQ=function(){uo.set("SaveOutlined",rQ.Z),uo.set("UndoOutlined",iQ.Z),uo.set("RedoOutlined",dT.Z),uo.set("VerticalAlignTopOutlined",oQ.Z),uo.set("VerticalAlignBottomOutlined",sQ.Z),uo.set("GatewayOutlined",aQ.Z),uo.set("GroupOutlined",lQ.Z),uo.set("UngroupOutlined",cQ.Z),uo.set("CopyOutlined",uQ.Z),uo.set("SnippetsOutlined",dQ.Z)},EQ=lk(function(r,e){var t,n=e.getValue().flowchartId,i=(t=RE(n,"toolbarPanelProps"))!==null&&t!==void 0?t:{};wQ();var o=i.commands,s=o===void 0?[{command:ho.REDO_CMD,tooltip:"\u91CD\u505A",iconName:"RedoOutlined"},{command:ho.UNDO_CMD,tooltip:"\u64A4\u9500",iconName:"UndoOutlined"},{command:ho.FRONT_NODE,tooltip:"\u7F6E\u524D",iconName:"VerticalAlignTopOutlined"},{command:ho.BACK_NODE,tooltip:"\u7F6E\u540E",iconName:"VerticalAlignBottomOutlined"},{command:ho.MULTI_SELECT,tooltip:"\u5F00\u542F\u6846\u9009",iconName:"GatewayOutlined"},{command:ho.ADD_GROUP,tooltip:"\u65B0\u5EFA\u7FA4\u7EC4",iconName:"GroupOutlined"},{command:ho.DEL_GROUP,tooltip:"\u89E3\u6563\u7FA4\u7EC4",iconName:"UngroupOutlined"},{command:ho.COPY,tooltip:"\u590D\u5236",iconName:"CopyOutlined"},{command:ho.PASTE,tooltip:"\u7C98\u8D34",iconName:"SnippetsOutlined"},{command:ho.SAVE_GRAPH_DATA,tooltip:"\u4FDD\u5B58",iconName:"SaveOutlined"}]:o,a=function(l){return Object.values(ho).includes(l)?s.find(function(c){return c.command===l}):(eQ.warn("unknown command: ".concat(l)),{})};r.setToolbarModelService(function(l,c,u){return hs(void 0,void 0,void 0,function(){var d,h,f;return fs(this,function(p){switch(p.label){case 0:return d=function(){return hs(void 0,void 0,void 0,function(){var g,v;return fs(this,function(y){switch(y.label){case 0:return[4,Mm.getToolbarState(c)];case 1:return g=y.sent(),[4,Mm.getToolbarItems(g,a,s,n)];case 2:return v=y.sent(),l.setValue(function(x){x.mainGroups=v}),[2]}})})},[4,Mm.getDependencies(c)];case 1:return h=p.sent(),f=h.map(function(g){return g.watch(function(){return hs(void 0,void 0,void 0,function(){return fs(this,function(v){return d(),[2]})})})}),u.pushAll(f),[2]}})})})}),IE=function(){return IE=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},IE.apply(this,arguments)},SQ=function(r){var e=r.layout,t=e===void 0?"horizontal":e,n=r.position,i=n===void 0?{top:0,left:240,right:240,bottom:0}:n,o=r.show,s=o===void 0?!0:o,a=r.className,l=r.style,c=EQ(r);return s?b.createElement(ak,{className:a,layout:t,config:c,style:IE({borderBottom:"1px solid #d9d9d9"},l),position:i}):null},gie=null,_Q=w(73171),AQ=w(8212),TQ=w(15360),Gl=function(){return Gl=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Gl.apply(this,arguments)},LE=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(n.next(u))}catch(d){s(d)}}function l(u){try{c(n.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},GE=function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(t=0)),t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(u){c=[6,u],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},_p;(function(r){var e=this;uo.set("DeleteOutlined",_Q.Z),uo.set("EditOutlined",AQ.Z),uo.set("StopOutlined",TQ.Z),r.DELETE_EDGE={id:Ti.DEL_EDGE.id,label:"\u5220\u9664\u8FB9",iconName:"DeleteOutlined",onClick:function(t){var n=t.target,i=t.commandService;return LE(e,void 0,void 0,function(){return GE(this,function(o){return n.data&&i.executeCommand(Ti.DEL_EDGE.id,{edgeConfig:n.data}),[2]})})}},r.DELETE_NODE=function(t){return{id:Wr.DEL_NODE.id,label:"\u5220\u9664\u8282\u70B9",iconName:"DeleteOutlined",onClick:function(n){var i=n.target,o=n.commandService;return LE(e,void 0,void 0,function(){var s,a;return GE(this,function(l){return i.data&&((s=i==null?void 0:i.data)===null||s===void 0?void 0:s.id)&&(o.executeCommand(Wr.DEL_NODE.id,{nodeConfig:{id:(a=i==null?void 0:i.data)===null||a===void 0?void 0:a.id}}),typeof t=="function"&&t(i.data)),[2]})})}}},r.EMPTY_MENU={id:"EMPTY_MENU_ITEM",label:"\u6682\u65E0\u53EF\u7528",isEnabled:!1,iconName:"DeleteOutlined"},r.SEPARATOR={id:"separator",type:Pu.Separator}})(_p||(_p={}));var MQ=TK(function(r,e){var t=e.getValue(),n=t.showOfficial,i=n===void 0?!0:n,o=t.submenu,s=t.onDelNode;r.setMenuModelService(function(a,l){return LE(void 0,void 0,void 0,function(){var c;return GE(this,function(u){if(!a)return[2];switch(c=a.type,c){case"node":l.setValue({id:"root",type:Pu.Root,submenu:(i?[_p.DELETE_NODE(s)]:[]).concat(o?o(Gl(Gl({},r),{menuType:"node"})):[])});break;case"edge":l.setValue({id:"root",type:Pu.Root,submenu:(i?[_p.DELETE_EDGE]:[]).concat(o?o(Gl(Gl({},r),{menuType:"edge"})):[])});break;case"blank":l.setValue({id:"root",type:Pu.Root,submenu:(i?[_p.EMPTY_MENU]:[]).concat(o?o(Gl(Gl({},r),{menuType:"blank"})):[])});break;default:l.setValue({id:"root",type:Pu.Root,submenu:(i?[_p.EMPTY_MENU]:[]).concat(o?o(Gl(Gl({},r),{menuType:"blank"})):[])});break}return[2]})})})}),ax=function(){return ax=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},ax.apply(this,arguments)},PQ=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(n.next(u))}catch(d){s(d)}}function l(u){try{c(n.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},OQ=function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(t=0)),t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(u){c=[6,u],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},DQ=IY(function(r,e){r.setRegisterHookFn(function(t){var n=[t.addNode.registerHook({name:"get node config from backend api",handler:function(o){return PQ(void 0,void 0,void 0,function(){var s,a;return OQ(this,function(l){return o.nodeConfig=ax(ax({},o.nodeConfig),{id:o.nodeConfig.id||"node-".concat(na()),zIndex:o.nodeConfig.zIndex||10,label:(a=(s=o.nodeConfig.label)===null||s===void 0?void 0:s.replace)===null||a===void 0?void 0:a.call(s,/\_copied/g,"")}),[2]})})}})],i=new $r;return i.pushAll(n),i})}),Ap=function(){return Ap=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Ap.apply(this,arguments)},lx=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(n.next(u))}catch(d){s(d)}}function l(u){try{c(n.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},cx=function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(t=0)),t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(u){c=[6,u],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},NQ=KY(function(r,e){var t=e.getValue(),n=t.onDelNode,i=t.onCopy,o=t.onPaste,s=function(a,l){return lx(void 0,void 0,void 0,function(){var c;return cx(this,function(u){switch(u.label){case 0:return[4,Ol.useValue(a)];case 1:return c=u.sent(),typeof l=="function"&&l(c.map(function(d){return d.data})),[2]}})})};r.setKeybindingFunc(function(a){return a.registerKeybinding([{id:"delete node or edge",keybinding:["delete","backspace"],callback:function(l,c,u,d){return lx(this,void 0,void 0,function(){var h;return cx(this,function(f){switch(f.label){case 0:return[4,Ol.useValue(c)];case 1:return h=f.sent(),[4,Promise.all(h.map(function(p){return p.isEdge()?u.executeCommand(Ti.DEL_EDGE.id,{edgeConfig:Ap(Ap({},p.getData()),{id:p.id})}):null}))];case 2:return f.sent(),[4,Promise.all(h.map(function(p){return p.isNode()?u.executeCommand(Wr.DEL_NODE.id,{nodeConfig:Ap(Ap({},p.getData()),{id:p.id})}):null}))];case 3:return f.sent(),s(c,n),[2]}})})}},{id:"copy",keybinding:["command+c","ctrl+c"],callback:function(l,c,u,d){return lx(this,void 0,void 0,function(){return cx(this,function(h){return d.preventDefault(),u.executeCommand(Zn.GRAPH_COPY.id,{}),s(c,i),[2]})})}},{id:"paste",keybinding:["command+v","ctrl+v"],callback:function(l,c,u,d){return lx(this,void 0,void 0,function(){return cx(this,function(h){return d.preventDefault(),u.executeCommand(Zn.GRAPH_PASTE.id,{}),s(c,o),[2]})})}}])})}),RQ=(0,b.createContext)({}),kQ=RQ,ux=function(){return ux=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},ux.apply(this,arguments)},IQ=function(r,e){var t=r,n=function(i,o,s){var a=t.getCellById(i);a&&t.getCellById(i).prop(o,ux(ux({},a[o]),s))};return t.updateNodeKeyById=n,t.getGraphData=Yk,t.loadData=function(i){Kk(e,i)},t},LQ={layout:"horizontal",position:{right:0,top:-140},style:{width:150,background:"transparent",left:"auto"}},Lu=function(){return Lu=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Lu.apply(this,arguments)},qk=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(n.next(u))}catch(d){s(d)}}function l(u){try{c(n.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},Jk=function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(t=0)),t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(u){c=[6,u],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},GQ=function(r){var e=r,t=e.className,n=e.style,i=e.detailPanelProps,o=e.toolbarPanelProps,s=e.nodePanelProps,a=s===void 0?{}:s,l=e.scaleToolbarPanelProps,c=l===void 0?{}:l,u=e.contextMenuPanelProps,d=u===void 0?{}:u,h=e.canvasProps,f=h===void 0?{}:h,p=e.keyBindingProps,g=e.onAddNode,v=e.onDelNode,y=e.onCopy,x=e.onPaste,E=e.onAddEdge,T=e.onConfigChange,P=e.onDestroy,z=e.onConfigReady,$=e.isAutoCenter,ne=e.data,De=e.mode,fe=e.onReady,Ae=(0,b.useRef)(na()),de=(0,b.useRef)();qJ(r,Ae.current,de);var ct=f.position,bt=ct===void 0?{top:40,left:240,right:240,bottom:0}:ct,Pe=f.showPortsOnNodeSelected,tt=f.edgeConfig,Kt=tt===void 0?{}:tt,tn=(0,b.useRef)(),Bn=MQ(Lu(Lu({},d),{onDelNode:v})),cr=DQ({flowchartId:Ae.current}),gn=p||NQ({onDelNode:v,onCopy:y,onPaste:x}),si=c.show,xi=si===void 0?!0:si,Nt=d.show,fn=Nt===void 0?!0:Nt,Kn=(0,b.useCallback)(function(Pn){return qk(void 0,void 0,void 0,function(){return Jk(this,function(vr){return ne&&Kk(Pn,ne),[2]})})},[ne]);return(0,b.useEffect)(function(){return function(){var Pn;(Pn=tn.current)===null||Pn===void 0||Pn.dispose()}},[]),b.createElement(kQ.Provider,{value:{flowchartId:Ae.current}},b.createElement("div",{className:"xflow-canvas-container","data-flowchart-id":Ae.current,ref:de,style:{width:"100%",height:"100%",backgroundColor:"#fff"}},b.createElement(zR,{className:t,style:n,commandConfig:cr,onAppDestroy:P,isAutoCenter:$,onAppConfigReady:z,onLoad:function(Pn){return qk(void 0,void 0,void 0,function(){var vr;return Jk(this,function(Gn){switch(Gn.label){case 0:return[4,Pn.getGraphInstance()];case 1:return vr=Gn.sent(),JJ(vr,Pn,Ae.current),vr.flowchartId=Ae.current,tn.current=vr,Kn(Pn),fe==null||fe(IQ(vr,Pn),Pn),[2]}})})}},b.createElement(FJ,null),b.createElement(SQ,Lu({},o,{flowchartId:Ae.current})),b.createElement(RJ,Lu({},a)),b.createElement(Bk,{config:f.config,mode:De,onAddNode:g,onAddEdge:E,onConfigChange:T,position:bt,showPortsOnNodeSelected:Pe,edgeConfig:Kt},xi&&b.createElement(VK,Lu({},Object.assign({},LQ,c))),fn&&b.createElement(AK,{config:Bn})),b.createElement(KJ,Lu({},i)),p!==!1&&b.createElement(YY,{config:gn}))))},FQ=GQ},20499:function(){},64851:function(){},59518:function(){},26199:function(){},14156:function(){},71468:function(){},48871:function(){},9871:function(){},25612:function(){},92777:function(){},20159:function(){},61622:function(){},85788:function(Se,N,w){var k=w(58579);Se.exports={Graph:k.Graph,json:w(62485),alg:w(39100),version:k.version}},74774:function(Se,N,w){var k=w(77163);Se.exports=D;function D(F){var U={},X=[],me;function K(q){k.has(U,q)||(U[q]=!0,me.push(q),k.each(F.successors(q),K),k.each(F.predecessors(q),K))}return k.each(F.nodes(),function(q){me=[],K(q),me.length&&X.push(me)}),X}},65179:function(Se,N,w){var k=w(77163);Se.exports=D;function D(U,X,me){k.isArray(X)||(X=[X]);var K=(U.isDirected()?U.successors:U.neighbors).bind(U),q=[],ae={};return k.each(X,function(ee){if(!U.hasNode(ee))throw new Error("Graph does not have node: "+ee);F(U,ee,me==="post",ae,K,q)}),q}function F(U,X,me,K,q,ae){k.has(K,X)||(K[X]=!0,me||ae.push(X),k.each(q(X),function(ee){F(U,ee,me,K,q,ae)}),me&&ae.push(X))}},73897:function(Se,N,w){var k=w(69205),D=w(77163);Se.exports=F;function F(U,X,me){return D.transform(U.nodes(),function(K,q){K[q]=k(U,q,X,me)},{})}},69205:function(Se,N,w){var k=w(77163),D=w(96129);Se.exports=U;var F=k.constant(1);function U(me,K,q,ae){return X(me,String(K),q||F,ae||function(ee){return me.outEdges(ee)})}function X(me,K,q,ae){var ee={},V=new D,W,ce,B=function(se){var j=se.v!==W?se.v:se.w,b=ee[j],R=q(se),Me=ce.distance+R;if(R<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+se+" Weight: "+R);Me<b.distance&&(b.distance=Me,b.predecessor=W,V.decrease(j,Me))};for(me.nodes().forEach(function(se){var j=se===K?0:Number.POSITIVE_INFINITY;ee[se]={distance:j},V.add(se,j)});V.size()>0&&(W=V.removeMin(),ce=ee[W],ce.distance!==Number.POSITIVE_INFINITY);)ae(W).forEach(B);return ee}},32630:function(Se,N,w){var k=w(77163),D=w(93070);Se.exports=F;function F(U){return k.filter(D(U),function(X){return X.length>1||X.length===1&&U.hasEdge(X[0],X[0])})}},3171:function(Se,N,w){var k=w(77163);Se.exports=F;var D=k.constant(1);function F(X,me,K){return U(X,me||D,K||function(q){return X.outEdges(q)})}function U(X,me,K){var q={},ae=X.nodes();return ae.forEach(function(ee){q[ee]={},q[ee][ee]={distance:0},ae.forEach(function(V){ee!==V&&(q[ee][V]={distance:Number.POSITIVE_INFINITY})}),K(ee).forEach(function(V){var W=V.v===ee?V.w:V.v,ce=me(V);q[ee][W]={distance:ce,predecessor:ee}})}),ae.forEach(function(ee){var V=q[ee];ae.forEach(function(W){var ce=q[W];ae.forEach(function(B){var se=ce[ee],j=V[B],b=ce[B],R=se.distance+j.distance;R<b.distance&&(b.distance=R,b.predecessor=j.predecessor)})})}),q}},39100:function(Se,N,w){Se.exports={components:w(74774),dijkstra:w(69205),dijkstraAll:w(73897),findCycles:w(32630),floydWarshall:w(3171),isAcyclic:w(78149),postorder:w(85979),preorder:w(5340),prim:w(74975),tarjan:w(93070),topsort:w(37034)}},78149:function(Se,N,w){var k=w(37034);Se.exports=D;function D(F){try{k(F)}catch(U){if(U instanceof k.CycleException)return!1;throw U}return!0}},85979:function(Se,N,w){var k=w(65179);Se.exports=D;function D(F,U){return k(F,U,"post")}},5340:function(Se,N,w){var k=w(65179);Se.exports=D;function D(F,U){return k(F,U,"pre")}},74975:function(Se,N,w){var k=w(77163),D=w(1053),F=w(96129);Se.exports=U;function U(X,me){var K=new D,q={},ae=new F,ee;function V(ce){var B=ce.v===ee?ce.w:ce.v,se=ae.priority(B);if(se!==void 0){var j=me(ce);j<se&&(q[B]=ee,ae.decrease(B,j))}}if(X.nodeCount()===0)return K;k.each(X.nodes(),function(ce){ae.add(ce,Number.POSITIVE_INFINITY),K.setNode(ce)}),ae.decrease(X.nodes()[0],0);for(var W=!1;ae.size()>0;){if(ee=ae.removeMin(),k.has(q,ee))K.setEdge(ee,q[ee]);else{if(W)throw new Error("Input graph is not connected: "+X);W=!0}X.nodeEdges(ee).forEach(V)}return K}},93070:function(Se,N,w){var k=w(77163);Se.exports=D;function D(F){var U=0,X=[],me={},K=[];function q(ae){var ee=me[ae]={onStack:!0,lowlink:U,index:U++};if(X.push(ae),F.successors(ae).forEach(function(ce){k.has(me,ce)?me[ce].onStack&&(ee.lowlink=Math.min(ee.lowlink,me[ce].index)):(q(ce),ee.lowlink=Math.min(ee.lowlink,me[ce].lowlink))}),ee.lowlink===ee.index){var V=[],W;do W=X.pop(),me[W].onStack=!1,V.push(W);while(ae!==W);K.push(V)}}return F.nodes().forEach(function(ae){k.has(me,ae)||q(ae)}),K}},37034:function(Se,N,w){var k=w(77163);Se.exports=D,D.CycleException=F;function D(U){var X={},me={},K=[];function q(ae){if(k.has(me,ae))throw new F;k.has(X,ae)||(me[ae]=!0,X[ae]=!0,k.each(U.predecessors(ae),q),delete me[ae],K.push(ae))}if(k.each(U.sinks(),q),k.size(X)!==U.nodeCount())throw new F;return K}function F(){}},96129:function(Se,N,w){var k=w(77163);Se.exports=D;function D(){this._arr=[],this._keyIndices={}}D.prototype.size=function(){return this._arr.length},D.prototype.keys=function(){return this._arr.map(function(F){return F.key})},D.prototype.has=function(F){return k.has(this._keyIndices,F)},D.prototype.priority=function(F){var U=this._keyIndices[F];if(U!==void 0)return this._arr[U].priority},D.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},D.prototype.add=function(F,U){var X=this._keyIndices;if(F=String(F),!k.has(X,F)){var me=this._arr,K=me.length;return X[F]=K,me.push({key:F,priority:U}),this._decrease(K),!0}return!1},D.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var F=this._arr.pop();return delete this._keyIndices[F.key],this._heapify(0),F.key},D.prototype.decrease=function(F,U){var X=this._keyIndices[F];if(U>this._arr[X].priority)throw new Error("New priority is greater than current priority. Key: "+F+" Old: "+this._arr[X].priority+" New: "+U);this._arr[X].priority=U,this._decrease(X)},D.prototype._heapify=function(F){var U=this._arr,X=2*F,me=X+1,K=F;X<U.length&&(K=U[X].priority<U[K].priority?X:K,me<U.length&&(K=U[me].priority<U[K].priority?me:K),K!==F&&(this._swap(F,K),this._heapify(K)))},D.prototype._decrease=function(F){for(var U=this._arr,X=U[F].priority,me;F!==0&&(me=F>>1,!(U[me].priority<X));)this._swap(F,me),F=me},D.prototype._swap=function(F,U){var X=this._arr,me=this._keyIndices,K=X[F],q=X[U];X[F]=q,X[U]=K,me[q.key]=F,me[K.key]=U}},1053:function(Se,N,w){"use strict";var k=w(77163);Se.exports=X;var D="\0",F="\0",U="";function X(V){this._isDirected=k.has(V,"directed")?V.directed:!0,this._isMultigraph=k.has(V,"multigraph")?V.multigraph:!1,this._isCompound=k.has(V,"compound")?V.compound:!1,this._label=void 0,this._defaultNodeLabelFn=k.constant(void 0),this._defaultEdgeLabelFn=k.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[F]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}X.prototype._nodeCount=0,X.prototype._edgeCount=0,X.prototype.isDirected=function(){return this._isDirected},X.prototype.isMultigraph=function(){return this._isMultigraph},X.prototype.isCompound=function(){return this._isCompound},X.prototype.setGraph=function(V){return this._label=V,this},X.prototype.graph=function(){return this._label},X.prototype.setDefaultNodeLabel=function(V){return k.isFunction(V)||(V=k.constant(V)),this._defaultNodeLabelFn=V,this},X.prototype.nodeCount=function(){return this._nodeCount},X.prototype.nodes=function(){return k.keys(this._nodes)},X.prototype.sources=function(){return k.filter(this.nodes(),k.bind(function(V){return k.isEmpty(this._in[V])},this))},X.prototype.sinks=function(){return k.filter(this.nodes(),k.bind(function(V){return k.isEmpty(this._out[V])},this))},X.prototype.setNodes=function(V,W){var ce=arguments;return k.each(V,k.bind(function(B){ce.length>1?this.setNode(B,W):this.setNode(B)},this)),this},X.prototype.setNode=function(V,W){return k.has(this._nodes,V)?(arguments.length>1&&(this._nodes[V]=W),this):(this._nodes[V]=arguments.length>1?W:this._defaultNodeLabelFn(V),this._isCompound&&(this._parent[V]=F,this._children[V]={},this._children[F][V]=!0),this._in[V]={},this._preds[V]={},this._out[V]={},this._sucs[V]={},++this._nodeCount,this)},X.prototype.node=function(V){return this._nodes[V]},X.prototype.hasNode=function(V){return k.has(this._nodes,V)},X.prototype.removeNode=function(V){var W=this;if(k.has(this._nodes,V)){var ce=function(B){W.removeEdge(W._edgeObjs[B])};delete this._nodes[V],this._isCompound&&(this._removeFromParentsChildList(V),delete this._parent[V],k.each(this.children(V),k.bind(function(B){this.setParent(B)},this)),delete this._children[V]),k.each(k.keys(this._in[V]),ce),delete this._in[V],delete this._preds[V],k.each(k.keys(this._out[V]),ce),delete this._out[V],delete this._sucs[V],--this._nodeCount}return this},X.prototype.setParent=function(V,W){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(k.isUndefined(W))W=F;else{W+="";for(var ce=W;!k.isUndefined(ce);ce=this.parent(ce))if(ce===V)throw new Error("Setting "+W+" as parent of "+V+" would create create a cycle");this.setNode(W)}return this.setNode(V),this._removeFromParentsChildList(V),this._parent[V]=W,this._children[W][V]=!0,this},X.prototype._removeFromParentsChildList=function(V){delete this._children[this._parent[V]][V]},X.prototype.parent=function(V){if(this._isCompound){var W=this._parent[V];if(W!==F)return W}},X.prototype.children=function(V){if(k.isUndefined(V)&&(V=F),this._isCompound){var W=this._children[V];if(W)return k.keys(W)}else{if(V===F)return this.nodes();if(this.hasNode(V))return[]}},X.prototype.predecessors=function(V){var W=this._preds[V];if(W)return k.keys(W)},X.prototype.successors=function(V){var W=this._sucs[V];if(W)return k.keys(W)},X.prototype.neighbors=function(V){var W=this.predecessors(V);if(W)return k.union(W,this.successors(V))},X.prototype.isLeaf=function(V){var W;return this.isDirected()?W=this.successors(V):W=this.neighbors(V),W.length===0},X.prototype.filterNodes=function(V){var W=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});W.setGraph(this.graph()),k.each(this._nodes,k.bind(function(j,b){V(b)&&W.setNode(b,j)},this)),k.each(this._edgeObjs,k.bind(function(j){W.hasNode(j.v)&&W.hasNode(j.w)&&W.setEdge(j,this.edge(j))},this));var ce=this,B={};function se(j){var b=ce.parent(j);return b===void 0||W.hasNode(b)?(B[j]=b,b):b in B?B[b]:se(b)}return this._isCompound&&k.each(W.nodes(),function(j){W.setParent(j,se(j))}),W},X.prototype.setDefaultEdgeLabel=function(V){return k.isFunction(V)||(V=k.constant(V)),this._defaultEdgeLabelFn=V,this},X.prototype.edgeCount=function(){return this._edgeCount},X.prototype.edges=function(){return k.values(this._edgeObjs)},X.prototype.setPath=function(V,W){var ce=this,B=arguments;return k.reduce(V,function(se,j){return B.length>1?ce.setEdge(se,j,W):ce.setEdge(se,j),j}),this},X.prototype.setEdge=function(){var V,W,ce,B,se=!1,j=arguments[0];typeof j=="object"&&j!==null&&"v"in j?(V=j.v,W=j.w,ce=j.name,arguments.length===2&&(B=arguments[1],se=!0)):(V=j,W=arguments[1],ce=arguments[3],arguments.length>2&&(B=arguments[2],se=!0)),V=""+V,W=""+W,k.isUndefined(ce)||(ce=""+ce);var b=q(this._isDirected,V,W,ce);if(k.has(this._edgeLabels,b))return se&&(this._edgeLabels[b]=B),this;if(!k.isUndefined(ce)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(V),this.setNode(W),this._edgeLabels[b]=se?B:this._defaultEdgeLabelFn(V,W,ce);var R=ae(this._isDirected,V,W,ce);return V=R.v,W=R.w,Object.freeze(R),this._edgeObjs[b]=R,me(this._preds[W],V),me(this._sucs[V],W),this._in[W][b]=R,this._out[V][b]=R,this._edgeCount++,this},X.prototype.edge=function(V,W,ce){var B=arguments.length===1?ee(this._isDirected,arguments[0]):q(this._isDirected,V,W,ce);return this._edgeLabels[B]},X.prototype.hasEdge=function(V,W,ce){var B=arguments.length===1?ee(this._isDirected,arguments[0]):q(this._isDirected,V,W,ce);return k.has(this._edgeLabels,B)},X.prototype.removeEdge=function(V,W,ce){var B=arguments.length===1?ee(this._isDirected,arguments[0]):q(this._isDirected,V,W,ce),se=this._edgeObjs[B];return se&&(V=se.v,W=se.w,delete this._edgeLabels[B],delete this._edgeObjs[B],K(this._preds[W],V),K(this._sucs[V],W),delete this._in[W][B],delete this._out[V][B],this._edgeCount--),this},X.prototype.inEdges=function(V,W){var ce=this._in[V];if(ce){var B=k.values(ce);return W?k.filter(B,function(se){return se.v===W}):B}},X.prototype.outEdges=function(V,W){var ce=this._out[V];if(ce){var B=k.values(ce);return W?k.filter(B,function(se){return se.w===W}):B}},X.prototype.nodeEdges=function(V,W){var ce=this.inEdges(V,W);if(ce)return ce.concat(this.outEdges(V,W))};function me(V,W){V[W]?V[W]++:V[W]=1}function K(V,W){--V[W]||delete V[W]}function q(V,W,ce,B){var se=""+W,j=""+ce;if(!V&&se>j){var b=se;se=j,j=b}return se+U+j+U+(k.isUndefined(B)?D:B)}function ae(V,W,ce,B){var se=""+W,j=""+ce;if(!V&&se>j){var b=se;se=j,j=b}var R={v:se,w:j};return B&&(R.name=B),R}function ee(V,W){return q(V,W.v,W.w,W.name)}},58579:function(Se,N,w){Se.exports={Graph:w(1053),version:w(82321)}},62485:function(Se,N,w){var k=w(77163),D=w(1053);Se.exports={write:F,read:me};function F(K){var q={options:{directed:K.isDirected(),multigraph:K.isMultigraph(),compound:K.isCompound()},nodes:U(K),edges:X(K)};return k.isUndefined(K.graph())||(q.value=k.clone(K.graph())),q}function U(K){return k.map(K.nodes(),function(q){var ae=K.node(q),ee=K.parent(q),V={v:q};return k.isUndefined(ae)||(V.value=ae),k.isUndefined(ee)||(V.parent=ee),V})}function X(K){return k.map(K.edges(),function(q){var ae=K.edge(q),ee={v:q.v,w:q.w};return k.isUndefined(q.name)||(ee.name=q.name),k.isUndefined(ae)||(ee.value=ae),ee})}function me(K){var q=new D(K.options).setGraph(K.value);return k.each(K.nodes,function(ae){q.setNode(ae.v,ae.value),ae.parent&&q.setParent(ae.v,ae.parent)}),k.each(K.edges,function(ae){q.setEdge({v:ae.v,w:ae.w,name:ae.name},ae.value)}),q}},77163:function(Se,N,w){var k;try{k=w(96486)}catch(D){}k||(k=window._),Se.exports=k},82321:function(Se){Se.exports="2.1.4"},70597:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var k=Object.assign||function(K){for(var q=1;q<arguments.length;q++){var ae=arguments[q];for(var ee in ae)Object.prototype.hasOwnProperty.call(ae,ee)&&(K[ee]=ae[ee])}return K},D=w(67294),F=U(D);function U(K){return K&&K.__esModule?K:{default:K}}function X(K,q){var ae={};for(var ee in K)q.indexOf(ee)>=0||!Object.prototype.hasOwnProperty.call(K,ee)||(ae[ee]=K[ee]);return ae}var me=24;N.default=function(K){var q=K.fill,ae=q===void 0?"currentColor":q,ee=K.width,V=ee===void 0?me:ee,W=K.height,ce=W===void 0?me:W,B=K.style,se=B===void 0?{}:B,j=X(K,["fill","width","height","style"]);return F.default.createElement("svg",k({viewBox:"0 0 "+me+" "+me,style:k({fill:ae,width:V,height:ce},se)},j),F.default.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))}},43891:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var k=Object.assign||function(K){for(var q=1;q<arguments.length;q++){var ae=arguments[q];for(var ee in ae)Object.prototype.hasOwnProperty.call(ae,ee)&&(K[ee]=ae[ee])}return K},D=w(67294),F=U(D);function U(K){return K&&K.__esModule?K:{default:K}}function X(K,q){var ae={};for(var ee in K)q.indexOf(ee)>=0||!Object.prototype.hasOwnProperty.call(K,ee)||(ae[ee]=K[ee]);return ae}var me=24;N.default=function(K){var q=K.fill,ae=q===void 0?"currentColor":q,ee=K.width,V=ee===void 0?me:ee,W=K.height,ce=W===void 0?me:W,B=K.style,se=B===void 0?{}:B,j=X(K,["fill","width","height","style"]);return F.default.createElement("svg",k({viewBox:"0 0 "+me+" "+me,style:k({fill:ae,width:V,height:ce},se)},j),F.default.createElement("path",{d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}))}},60674:function(){},49469:function(Se,N){"use strict";var w;w={value:!0};var k;(function(le){le.TextureCompressionBC="texture-compression-bc"})(k=N.UX||(N.UX={}));var D;(function(le){le.ClampToEdge="clamp-to-edge",le.Repeat="repeat",le.MirrorRepeat="mirror-repeat"})(D=N.OB||(N.OB={}));var F;(function(le){le.UniformBuffer="uniform-buffer",le.StorageBuffer="storage-buffer",le.ReadonlyStorageBuffer="readonly-storage-buffer",le.Sampler="sampler",le.ComparisonSampler="comparison-sampler",le.SampledTexture="sampled-texture",le.ReadonlyStorageTexture="readonly-storage-texture",le.WriteonlyStorageTexture="writeonly-storage-texture"})(F=N.$l||(N.$l={}));var U;(function(le){le.Zero="zero",le.One="one",le.SrcColor="src-color",le.OneMinusSrcColor="one-minus-src-color",le.SrcAlpha="src-alpha",le.OneMinusSrcAlpha="one-minus-src-alpha",le.DstColor="dst-color",le.OneMinusDstColor="one-minus-dst-color",le.DstAlpha="dst-alpha",le.OneMinusDstAlpha="one-minus-dst-alpha",le.SrcAlphaSaturated="src-alpha-saturated",le.BlendColor="blend-color",le.OneMinusBlendColor="one-minus-blend-color"})(U=N.zi||(N.zi={}));var X;(function(le){le.Add="add",le.Subtract="subtract",le.ReverseSubtract="reverse-subtract",le.Min="min",le.Max="max"})(X=N.db||(N.db={}));var me;(function(le){le.Never="never",le.Less="less",le.Equal="equal",le.LessEqual="less-equal",le.Greater="greater",le.NotEqual="not-equal",le.GreaterEqual="greater-equal",le.Always="always"})(me=N.wb||(N.wb={}));var K;(function(le){le.None="none",le.Front="front",le.Back="back"})(K=N.Wf||(N.Wf={}));var q;(function(le){le.Nearest="nearest",le.Linear="linear"})(q=N.X9||(N.X9={}));var ae;(function(le){le.CCW="ccw",le.CW="cw"})(ae=N.zX||(N.zX={}));var ee;(function(le){le.Uint16="uint16",le.Uint32="uint32"})(ee=N.iD||(N.iD={}));var V;(function(le){le.Vertex="vertex",le.Instance="instance"})(V=N.V||(N.V={}));var W;(function(le){le.Load="load"})(W=N.Ws||(N.Ws={}));var ce;(function(le){le.PointList="point-list",le.LineList="line-list",le.LineStrip="line-strip",le.TriangleList="triangle-list",le.TriangleStrip="triangle-strip"})(ce=N.YV||(N.YV={}));var B;(function(le){le.Keep="keep",le.Zero="zero",le.Replace="replace",le.Invert="invert",le.IncrementClamp="increment-clamp",le.DecrementClamp="decrement-clamp",le.IncrementWrap="increment-wrap",le.DecrementWrap="decrement-wrap"})(B=N.xS||(N.xS={}));var se;(function(le){le.Store="store",le.Clear="clear"})(se=N.EG||(N.EG={}));var j;(function(le){le.E1d="1d",le.E2d="2d",le.E3d="3d"})(j=N.kd||(N.kd={}));var b;(function(le){le.R8Unorm="r8unorm",le.R8Snorm="r8snorm",le.R8Uint="r8uint",le.R8Sint="r8sint",le.R16Uint="r16uint",le.R16Sint="r16sint",le.R16Float="r16float",le.RG8Unorm="rg8unorm",le.RG8Snorm="rg8snorm",le.RG8Uint="rg8uint",le.RG8Sint="rg8sint",le.R32Uint="r32uint",le.R32Sint="r32sint",le.R32Float="r32float",le.RG16Uint="rg16uint",le.RG16Sint="rg16sint",le.RG16Float="rg16float",le.RGBA8Unorm="rgba8unorm",le.RGBA8UnormSRGB="rgba8unorm-srgb",le.RGBA8Snorm="rgba8snorm",le.RGBA8Uint="rgba8uint",le.RGBA8Sint="rgba8sint",le.BGRA8Unorm="bgra8unorm",le.BGRA8UnormSRGB="bgra8unorm-srgb",le.RGB10A2Unorm="rgb10a2unorm",le.RG11B10Float="rg11b10float",le.RG32Uint="rg32uint",le.RG32Sint="rg32sint",le.RG32Float="rg32float",le.RGBA16Uint="rgba16uint",le.RGBA16Sint="rgba16sint",le.RGBA16Float="rgba16float",le.RGBA32Uint="rgba32uint",le.RGBA32Sint="rgba32sint",le.RGBA32Float="rgba32float",le.Depth32Float="depth32float",le.Depth24Plus="depth24plus",le.Depth24PlusStencil8="depth24plus-stencil8"})(b=N.EV||(N.EV={}));var R;(function(le){le.Float="float",le.Sint="sint",le.Uint="uint"})(R=N.Ek||(N.Ek={}));var Me;(function(le){le.E1d="1d",le.E2d="2d",le.E2dArray="2d-array",le.Cube="cube",le.CubeArray="cube-array",le.E3d="3d"})(Me=N.p_||(N.p_={}));var re;(function(le){le.Uchar2="uchar2",le.Uchar4="uchar4",le.Char2="char2",le.Char4="char4",le.Uchar2Norm="uchar2norm",le.Uchar4Norm="uchar4norm",le.Char2Norm="char2norm",le.Char4Norm="char4norm",le.Ushort2="ushort2",le.Ushort4="ushort4",le.Short2="short2",le.Short4="short4",le.Ushort2Norm="ushort2norm",le.Ushort4Norm="ushort4norm",le.Short2Norm="short2norm",le.Short4Norm="short4norm",le.Half2="half2",le.Half4="half4",le.Float="float",le.Float2="float2",le.Float3="float3",le.Float4="float4",le.Uint="uint",le.Uint2="uint2",le.Uint3="uint3",le.Uint4="uint4",le.Int="int",le.Int2="int2",le.Int3="int3",le.Int4="int4"})(re=N.gB||(N.gB={}));var ve;(function(le){le.All="all",le.StencilOnly="stencil-only",le.DepthOnly="depth-only"})(ve=N.H7||(N.H7={}));var ht;(function(le){le.Error="error",le.Warning="warning",le.Info="info"})(ht=N.mj||(N.mj={}));var A;(function(le){le.Occlusion="occlusion"})(A=N.xL||(N.xL={}));var Oe;(function(le){le[le.MapRead=1]="MapRead",le[le.MapWrite=2]="MapWrite",le[le.CopySrc=4]="CopySrc",le[le.CopyDst=8]="CopyDst",le[le.Index=16]="Index",le[le.Vertex=32]="Vertex",le[le.Uniform=64]="Uniform",le[le.Storage=128]="Storage",le[le.Indirect=256]="Indirect",le[le.QueryResolve=512]="QueryResolve"})(Oe=N.FB||(N.FB={}));var Ue;(function(le){le[le.Red=1]="Red",le[le.Green=2]="Green",le[le.Blue=4]="Blue",le[le.Alpha=8]="Alpha",le[le.All=15]="All"})(Ue=N.Yw||(N.Yw={}));var At;(function(le){le[le.Vertex=1]="Vertex",le[le.Fragment=2]="Fragment",le[le.Compute=4]="Compute"})(At=N.$X||(N.$X={}));var Xt;(function(le){le[le.CopySrc=1]="CopySrc",le[le.CopyDst=2]="CopyDst",le[le.Sampled=4]="Sampled",le[le.Storage=8]="Storage",le[le.OutputAttachment=16]="OutputAttachment"})(Xt=N.v2||(N.v2={}));var On;(function(le){le[le.Read=1]="Read",le[le.Write=2]="Write"})(On=N.gc||(N.gc={}))},27279:function(Se,N,w){"use strict";w.d(N,{Z:function(){return Vt}});var k=w(22122),D=w(96156),F=w(8812),U=w(94184),X=w.n(U),me=w(85061),K=w(6610),q=w(5991),ae=w(10379),ee=w(60446),V=w(90484),W=w(50344),ce=w(67294),B=w(96774),se=w.n(B),j=w(81253),b=w(63441),R=w(28481),Me=ce.forwardRef(function(et,wt){var Qe,ft=et.prefixCls,ut=et.forceRender,$t=et.className,It=et.style,on=et.children,at=et.isActive,Yt=et.role,Cn=ce.useState(at||ut),St=(0,R.Z)(Cn,2),sr=St[0],Nn=St[1];return ce.useEffect(function(){(ut||at)&&Nn(!0)},[ut,at]),sr?ce.createElement("div",{ref:wt,className:X()("".concat(ft,"-content"),(Qe={},(0,D.Z)(Qe,"".concat(ft,"-content-active"),at),(0,D.Z)(Qe,"".concat(ft,"-content-inactive"),!at),Qe),$t),style:It,role:Yt},ce.createElement("div",{className:"".concat(ft,"-content-box")},on)):null});Me.displayName="PanelContent";var re=Me,ve=["className","id","style","prefixCls","headerClass","children","isActive","destroyInactivePanel","accordion","forceRender","openMotion","extra","collapsible"],ht=function(et){(0,ae.Z)(Qe,et);var wt=(0,ee.Z)(Qe);function Qe(){var ft;(0,K.Z)(this,Qe);for(var ut=arguments.length,$t=new Array(ut),It=0;It<ut;It++)$t[It]=arguments[It];return ft=wt.call.apply(wt,[this].concat($t)),ft.onItemClick=function(){var on=ft.props,at=on.onItemClick,Yt=on.panelKey;typeof at=="function"&&at(Yt)},ft.handleKeyPress=function(on){(on.key==="Enter"||on.keyCode===13||on.which===13)&&ft.onItemClick()},ft.renderIcon=function(){var on=ft.props,at=on.showArrow,Yt=on.expandIcon,Cn=on.prefixCls,St=on.collapsible;if(!at)return null;var sr=typeof Yt=="function"?Yt(ft.props):ce.createElement("i",{className:"arrow"});return sr&&ce.createElement("div",{className:"".concat(Cn,"-expand-icon"),onClick:St==="header"||St==="icon"?ft.onItemClick:null},sr)},ft.renderTitle=function(){var on=ft.props,at=on.header,Yt=on.prefixCls,Cn=on.collapsible;return ce.createElement("span",{className:"".concat(Yt,"-header-text"),onClick:Cn==="header"?ft.onItemClick:null},at)},ft}return(0,q.Z)(Qe,[{key:"shouldComponentUpdate",value:function(ut){return!se()(this.props,ut)}},{key:"render",value:function(){var ut,$t,It=this.props,on=It.className,at=It.id,Yt=It.style,Cn=It.prefixCls,St=It.headerClass,sr=It.children,Nn=It.isActive,Vr=It.destroyInactivePanel,an=It.accordion,br=It.forceRender,po=It.openMotion,J=It.extra,pi=It.collapsible,vi=(0,j.Z)(It,ve),Ci=pi==="disabled",_r=pi==="header",Ir=pi==="icon",ai=X()((ut={},(0,D.Z)(ut,"".concat(Cn,"-item"),!0),(0,D.Z)(ut,"".concat(Cn,"-item-active"),Nn),(0,D.Z)(ut,"".concat(Cn,"-item-disabled"),Ci),ut),on),Nr=X()("".concat(Cn,"-header"),($t={},(0,D.Z)($t,St,St),(0,D.Z)($t,"".concat(Cn,"-header-collapsible-only"),_r),(0,D.Z)($t,"".concat(Cn,"-icon-collapsible-only"),Ir),$t)),wr={className:Nr,"aria-expanded":Nn,"aria-disabled":Ci,onKeyPress:this.handleKeyPress};!_r&&!Ir&&(wr.onClick=this.onItemClick,wr.role=an?"tab":"button",wr.tabIndex=Ci?-1:0);var Mi=J!=null&&typeof J!="boolean";return delete vi.header,delete vi.panelKey,delete vi.onItemClick,delete vi.showArrow,delete vi.expandIcon,ce.createElement("div",(0,k.Z)({},vi,{className:ai,style:Yt,id:at}),ce.createElement("div",wr,this.renderIcon(),this.renderTitle(),Mi&&ce.createElement("div",{className:"".concat(Cn,"-extra")},J)),ce.createElement(b.Z,(0,k.Z)({visible:Nn,leavedClassName:"".concat(Cn,"-content-hidden")},po,{forceRender:br,removeOnLeave:Vr}),function(zi,S){var wi=zi.className,Cr=zi.style;return ce.createElement(re,{ref:S,prefixCls:Cn,className:wi,style:Cr,isActive:Nn,forceRender:br,role:an?"tabpanel":null},sr)}))}}]),Qe}(ce.Component);ht.defaultProps={showArrow:!0,isActive:!1,onItemClick:function(){},headerClass:"",forceRender:!1};var A=ht;function Oe(et){var wt=et;if(!Array.isArray(wt)){var Qe=(0,V.Z)(wt);wt=Qe==="number"||Qe==="string"?[wt]:[]}return wt.map(function(ft){return String(ft)})}var Ue=function(et){(0,ae.Z)(Qe,et);var wt=(0,ee.Z)(Qe);function Qe(ft){var ut;(0,K.Z)(this,Qe),ut=wt.call(this,ft),ut.onClickItem=function(at){var Yt=ut.state.activeKey;if(ut.props.accordion)Yt=Yt[0]===at?[]:[at];else{Yt=(0,me.Z)(Yt);var Cn=Yt.indexOf(at),St=Cn>-1;St?Yt.splice(Cn,1):Yt.push(at)}ut.setActiveKey(Yt)},ut.getNewChild=function(at,Yt){if(!at)return null;var Cn=ut.state.activeKey,St=ut.props,sr=St.prefixCls,Nn=St.openMotion,Vr=St.accordion,an=St.destroyInactivePanel,br=St.expandIcon,po=St.collapsible,J=at.key||String(Yt),pi=at.props,vi=pi.header,Ci=pi.headerClass,_r=pi.destroyInactivePanel,Ir=pi.collapsible,ai=!1;Vr?ai=Cn[0]===J:ai=Cn.indexOf(J)>-1;var Nr=Ir!=null?Ir:po,wr={key:J,panelKey:J,header:vi,headerClass:Ci,isActive:ai,prefixCls:sr,destroyInactivePanel:_r!=null?_r:an,openMotion:Nn,accordion:Vr,children:at.props.children,onItemClick:Nr==="disabled"?null:ut.onClickItem,expandIcon:br,collapsible:Nr};return typeof at.type=="string"?at:(Object.keys(wr).forEach(function(Mi){typeof wr[Mi]=="undefined"&&delete wr[Mi]}),ce.cloneElement(at,wr))},ut.getItems=function(){var at=ut.props.children;return(0,W.Z)(at).map(ut.getNewChild)},ut.setActiveKey=function(at){"activeKey"in ut.props||ut.setState({activeKey:at}),ut.props.onChange(ut.props.accordion?at[0]:at)};var $t=ft.activeKey,It=ft.defaultActiveKey,on=It;return"activeKey"in ft&&(on=$t),ut.state={activeKey:Oe(on)},ut}return(0,q.Z)(Qe,[{key:"shouldComponentUpdate",value:function(ut,$t){return!se()(this.props,ut)||!se()(this.state,$t)}},{key:"render",value:function(){var ut,$t=this.props,It=$t.prefixCls,on=$t.className,at=$t.style,Yt=$t.accordion,Cn=X()((ut={},(0,D.Z)(ut,It,!0),(0,D.Z)(ut,on,!!on),ut));return ce.createElement("div",{className:Cn,style:at,role:Yt?"tablist":null},this.getItems())}}],[{key:"getDerivedStateFromProps",value:function(ut){var $t={};return"activeKey"in ut&&($t.activeKey=Oe(ut.activeKey)),$t}}]),Qe}(ce.Component);Ue.defaultProps={prefixCls:"rc-collapse",onChange:function(){},accordion:!1,destroyInactivePanel:!1},Ue.Panel=A;var At=Ue,Xt=At,On=At.Panel,le=w(98423),Fn=w(53124),hr=w(33603),qn=w(96159),pr=function(wt){var Qe=ce.useContext(Fn.E_),ft=Qe.getPrefixCls,ut=wt.prefixCls,$t=wt.className,It=$t===void 0?"":$t,on=wt.showArrow,at=on===void 0?!0:on,Yt=ft("collapse",ut),Cn=X()((0,D.Z)({},"".concat(Yt,"-no-arrow"),!at),It);return ce.createElement(Xt.Panel,(0,k.Z)({},wt,{prefixCls:Yt,className:Cn}))},L=pr,he=function(wt){var Qe,ft=ce.useContext(Fn.E_),ut=ft.getPrefixCls,$t=ft.direction,It=wt.prefixCls,on=wt.className,at=on===void 0?"":on,Yt=wt.bordered,Cn=Yt===void 0?!0:Yt,St=wt.ghost,sr=wt.expandIconPosition,Nn=sr===void 0?"start":sr,Vr=ut("collapse",It),an=ce.useMemo(function(){return Nn==="left"?"start":Nn==="right"?"end":Nn},[Nn]),br=function(){var Ci=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_r=wt.expandIcon,Ir=_r?_r(Ci):ce.createElement(F.Z,{rotate:Ci.isActive?90:void 0});return(0,qn.Tm)(Ir,function(){return{className:X()(Ir.props.className,"".concat(Vr,"-arrow"))}})},po=X()("".concat(Vr,"-icon-position-").concat(an),(Qe={},(0,D.Z)(Qe,"".concat(Vr,"-borderless"),!Cn),(0,D.Z)(Qe,"".concat(Vr,"-rtl"),$t==="rtl"),(0,D.Z)(Qe,"".concat(Vr,"-ghost"),!!St),Qe),at),J=(0,k.Z)((0,k.Z)({},hr.ZP),{motionAppear:!1,leavedClassName:"".concat(Vr,"-content-hidden")}),pi=function(){var Ci=wt.children;return(0,W.Z)(Ci).map(function(_r,Ir){var ai;if((ai=_r.props)===null||ai===void 0?void 0:ai.disabled){var Nr=_r.key||String(Ir),wr=_r.props,Mi=wr.disabled,zi=wr.collapsible,S=(0,k.Z)((0,k.Z)({},(0,le.Z)(_r.props,["disabled"])),{key:Nr,collapsible:zi!=null?zi:Mi?"disabled":void 0});return(0,qn.Tm)(_r,S)}return _r})};return ce.createElement(Xt,(0,k.Z)({openMotion:J},wt,{expandIcon:br,prefixCls:Vr,className:po}),pi())};he.Panel=L;var lt=he,Vt=lt},7573:function(Se,N,w){"use strict";w.d(N,{Z:function(){return pr}});var k=w(96156),D=w(90484),F=w(22122),U=w(80766),X=w(94184),me=w.n(X),K=w(76513),q=w(67294),ae=w(53124),ee=w(33603),V=w(85061),W=w(28481),ce=w(86504),B=w(91816),se=w(63258),j=w(10225),b=w(1089),R;(function(L){L[L.None=0]="None",L[L.Start=1]="Start",L[L.End=2]="End"})(R||(R={}));function Me(L,he){function lt(Vt){var et=Vt.key,wt=Vt.children;he(et,Vt)!==!1&&Me(wt||[],he)}L.forEach(lt)}function re(L){var he=L.treeData,lt=L.expandedKeys,Vt=L.startKey,et=L.endKey,wt=[],Qe=R.None;if(Vt&&Vt===et)return[Vt];if(!Vt||!et)return[];function ft(ut){return ut===Vt||ut===et}return Me(he,function(ut){if(Qe===R.End)return!1;if(ft(ut)){if(wt.push(ut),Qe===R.None)Qe=R.Start;else if(Qe===R.Start)return Qe=R.End,!1}else Qe===R.Start&&wt.push(ut);return lt.includes(ut)}),wt}function ve(L,he){var lt=(0,V.Z)(he),Vt=[];return Me(L,function(et,wt){var Qe=lt.indexOf(et);return Qe!==-1&&(Vt.push(wt),lt.splice(Qe,1)),!!lt.length}),Vt}var ht=function(L,he){var lt={};for(var Vt in L)Object.prototype.hasOwnProperty.call(L,Vt)&&he.indexOf(Vt)<0&&(lt[Vt]=L[Vt]);if(L!=null&&typeof Object.getOwnPropertySymbols=="function")for(var et=0,Vt=Object.getOwnPropertySymbols(L);et<Vt.length;et++)he.indexOf(Vt[et])<0&&Object.prototype.propertyIsEnumerable.call(L,Vt[et])&&(lt[Vt[et]]=L[Vt[et]]);return lt};function A(L){var he=L.isLeaf,lt=L.expanded;return he?q.createElement(ce.Z,null):lt?q.createElement(B.Z,null):q.createElement(se.Z,null)}function Oe(L){var he=L.treeData,lt=L.children;return he||(0,b.zn)(lt)}var Ue=function(he,lt){var Vt=he.defaultExpandAll,et=he.defaultExpandParent,wt=he.defaultExpandedKeys,Qe=ht(he,["defaultExpandAll","defaultExpandParent","defaultExpandedKeys"]),ft=q.useRef(),ut=q.useRef(),$t=function(){var S=(0,b.I8)(Oe(Qe)),wi=S.keyEntities,Cr;return Vt?Cr=Object.keys(wi):et?Cr=(0,j.r7)(Qe.expandedKeys||wt||[],wi):Cr=Qe.expandedKeys||wt,Cr},It=q.useState(Qe.selectedKeys||Qe.defaultSelectedKeys||[]),on=(0,W.Z)(It,2),at=on[0],Yt=on[1],Cn=q.useState(function(){return $t()}),St=(0,W.Z)(Cn,2),sr=St[0],Nn=St[1];q.useEffect(function(){"selectedKeys"in Qe&&Yt(Qe.selectedKeys)},[Qe.selectedKeys]),q.useEffect(function(){"expandedKeys"in Qe&&Nn(Qe.expandedKeys)},[Qe.expandedKeys]);var Vr=function(S,wi){var Cr;return"expandedKeys"in Qe||Nn(S),(Cr=Qe.onExpand)===null||Cr===void 0?void 0:Cr.call(Qe,S,wi)},an=function(S,wi){var Cr,sa=Qe.multiple,Nc=wi.node,jr=wi.nativeEvent,zo=Nc.key,Di=zo===void 0?"":zo,Ws=Oe(Qe),aa=(0,F.Z)((0,F.Z)({},wi),{selected:!0}),Ka=(jr==null?void 0:jr.ctrlKey)||(jr==null?void 0:jr.metaKey),Fl=jr==null?void 0:jr.shiftKey,io;sa&&Ka?(io=S,ft.current=Di,ut.current=io,aa.selectedNodes=ve(Ws,io)):sa&&Fl?(io=Array.from(new Set([].concat((0,V.Z)(ut.current||[]),(0,V.Z)(re({treeData:Ws,expandedKeys:sr,startKey:Di,endKey:ft.current}))))),aa.selectedNodes=ve(Ws,io)):(io=[Di],ft.current=Di,ut.current=io,aa.selectedNodes=ve(Ws,io)),(Cr=Qe.onSelect)===null||Cr===void 0||Cr.call(Qe,io,aa),"selectedKeys"in Qe||Yt(io)},br=q.useContext(ae.E_),po=br.getPrefixCls,J=br.direction,pi=Qe.prefixCls,vi=Qe.className,Ci=Qe.showIcon,_r=Ci===void 0?!0:Ci,Ir=Qe.expandAction,ai=Ir===void 0?"click":Ir,Nr=ht(Qe,["prefixCls","className","showIcon","expandAction"]),wr=po("tree",pi),Mi=me()("".concat(wr,"-directory"),(0,k.Z)({},"".concat(wr,"-directory-rtl"),J==="rtl"),vi);return q.createElement(qn,(0,F.Z)({icon:A,ref:lt,blockNode:!0},Nr,{showIcon:_r,expandAction:ai,prefixCls:wr,className:Mi,expandedKeys:sr,selectedKeys:at,onSelect:an,onExpand:Vr}))},At=q.forwardRef(Ue),Xt=At,On=4;function le(L){var he,lt=L.dropPosition,Vt=L.dropLevelOffset,et=L.prefixCls,wt=L.indent,Qe=L.direction,ft=Qe===void 0?"ltr":Qe,ut=ft==="ltr"?"left":"right",$t=ft==="ltr"?"right":"left",It=(he={},(0,k.Z)(he,ut,-Vt*wt+On),(0,k.Z)(he,$t,0),he);switch(lt){case-1:It.top=-3;break;case 1:It.bottom=-3;break;default:It.bottom=-3,It[ut]=wt+On;break}return q.createElement("div",{style:It,className:"".concat(et,"-drop-indicator")})}var Fn=w(61639),hr=q.forwardRef(function(L,he){var lt,Vt=q.useContext(ae.E_),et=Vt.getPrefixCls,wt=Vt.direction,Qe=Vt.virtual,ft=L.prefixCls,ut=L.className,$t=L.showIcon,It=$t===void 0?!1:$t,on=L.showLine,at=L.switcherIcon,Yt=L.blockNode,Cn=Yt===void 0?!1:Yt,St=L.children,sr=L.checkable,Nn=sr===void 0?!1:sr,Vr=L.selectable,an=Vr===void 0?!0:Vr,br=L.draggable,po=L.motion,J=po===void 0?(0,F.Z)((0,F.Z)({},ee.ZP),{motionAppear:!1}):po,pi=et("tree",ft),vi=(0,F.Z)((0,F.Z)({},L),{checkable:Nn,selectable:an,showIcon:It,motion:J,blockNode:Cn,showLine:Boolean(on),dropIndicatorRender:le}),Ci=q.useMemo(function(){if(!br)return!1;var _r={};switch((0,D.Z)(br)){case"function":_r.nodeDraggable=br;break;case"object":_r=(0,F.Z)({},br);break;default:break}return _r.icon!==!1&&(_r.icon=_r.icon||q.createElement(U.Z,null)),_r},[br]);return q.createElement(K.Z,(0,F.Z)({itemHeight:20,ref:he,virtual:Qe},vi,{prefixCls:pi,className:me()((lt={},(0,k.Z)(lt,"".concat(pi,"-icon-hide"),!It),(0,k.Z)(lt,"".concat(pi,"-block-node"),Cn),(0,k.Z)(lt,"".concat(pi,"-unselectable"),!an),(0,k.Z)(lt,"".concat(pi,"-rtl"),wt==="rtl"),lt),ut),direction:wt,checkable:Nn&&q.createElement("span",{className:"".concat(pi,"-checkbox-inner")}),selectable:an,switcherIcon:function(Ir){return(0,Fn.Z)(pi,at,on,Ir)},draggable:Ci}),St)});hr.TreeNode=K.O,hr.DirectoryTree=Xt;var qn=hr,pr=qn},35600:function(Se,N,w){"use strict";w.d(N,{Ue:function(){return D},xO:function(){return F},U_:function(){return ee},Jp:function(){return ce},vc:function(){return b},Us:function(){return R},xJ:function(){return Me},XL:function(){return ht}});var k=w(49685);function D(){var L=new k.WT(9);return k.WT!=Float32Array&&(L[1]=0,L[2]=0,L[3]=0,L[5]=0,L[6]=0,L[7]=0),L[0]=1,L[4]=1,L[8]=1,L}function F(L,he){return L[0]=he[0],L[1]=he[1],L[2]=he[2],L[3]=he[4],L[4]=he[5],L[5]=he[6],L[6]=he[8],L[7]=he[9],L[8]=he[10],L}function U(L){var he=new glMatrix.ARRAY_TYPE(9);return he[0]=L[0],he[1]=L[1],he[2]=L[2],he[3]=L[3],he[4]=L[4],he[5]=L[5],he[6]=L[6],he[7]=L[7],he[8]=L[8],he}function X(L,he){return L[0]=he[0],L[1]=he[1],L[2]=he[2],L[3]=he[3],L[4]=he[4],L[5]=he[5],L[6]=he[6],L[7]=he[7],L[8]=he[8],L}function me(L,he,lt,Vt,et,wt,Qe,ft,ut){var $t=new glMatrix.ARRAY_TYPE(9);return $t[0]=L,$t[1]=he,$t[2]=lt,$t[3]=Vt,$t[4]=et,$t[5]=wt,$t[6]=Qe,$t[7]=ft,$t[8]=ut,$t}function K(L,he,lt,Vt,et,wt,Qe,ft,ut,$t){return L[0]=he,L[1]=lt,L[2]=Vt,L[3]=et,L[4]=wt,L[5]=Qe,L[6]=ft,L[7]=ut,L[8]=$t,L}function q(L){return L[0]=1,L[1]=0,L[2]=0,L[3]=0,L[4]=1,L[5]=0,L[6]=0,L[7]=0,L[8]=1,L}function ae(L,he){if(L===he){var lt=he[1],Vt=he[2],et=he[5];L[1]=he[3],L[2]=he[6],L[3]=lt,L[5]=he[7],L[6]=Vt,L[7]=et}else L[0]=he[0],L[1]=he[3],L[2]=he[6],L[3]=he[1],L[4]=he[4],L[5]=he[7],L[6]=he[2],L[7]=he[5],L[8]=he[8];return L}function ee(L,he){var lt=he[0],Vt=he[1],et=he[2],wt=he[3],Qe=he[4],ft=he[5],ut=he[6],$t=he[7],It=he[8],on=It*Qe-ft*$t,at=-It*wt+ft*ut,Yt=$t*wt-Qe*ut,Cn=lt*on+Vt*at+et*Yt;return Cn?(Cn=1/Cn,L[0]=on*Cn,L[1]=(-It*Vt+et*$t)*Cn,L[2]=(ft*Vt-et*Qe)*Cn,L[3]=at*Cn,L[4]=(It*lt-et*ut)*Cn,L[5]=(-ft*lt+et*wt)*Cn,L[6]=Yt*Cn,L[7]=(-$t*lt+Vt*ut)*Cn,L[8]=(Qe*lt-Vt*wt)*Cn,L):null}function V(L,he){var lt=he[0],Vt=he[1],et=he[2],wt=he[3],Qe=he[4],ft=he[5],ut=he[6],$t=he[7],It=he[8];return L[0]=Qe*It-ft*$t,L[1]=et*$t-Vt*It,L[2]=Vt*ft-et*Qe,L[3]=ft*ut-wt*It,L[4]=lt*It-et*ut,L[5]=et*wt-lt*ft,L[6]=wt*$t-Qe*ut,L[7]=Vt*ut-lt*$t,L[8]=lt*Qe-Vt*wt,L}function W(L){var he=L[0],lt=L[1],Vt=L[2],et=L[3],wt=L[4],Qe=L[5],ft=L[6],ut=L[7],$t=L[8];return he*($t*wt-Qe*ut)+lt*(-$t*et+Qe*ft)+Vt*(ut*et-wt*ft)}function ce(L,he,lt){var Vt=he[0],et=he[1],wt=he[2],Qe=he[3],ft=he[4],ut=he[5],$t=he[6],It=he[7],on=he[8],at=lt[0],Yt=lt[1],Cn=lt[2],St=lt[3],sr=lt[4],Nn=lt[5],Vr=lt[6],an=lt[7],br=lt[8];return L[0]=at*Vt+Yt*Qe+Cn*$t,L[1]=at*et+Yt*ft+Cn*It,L[2]=at*wt+Yt*ut+Cn*on,L[3]=St*Vt+sr*Qe+Nn*$t,L[4]=St*et+sr*ft+Nn*It,L[5]=St*wt+sr*ut+Nn*on,L[6]=Vr*Vt+an*Qe+br*$t,L[7]=Vr*et+an*ft+br*It,L[8]=Vr*wt+an*ut+br*on,L}function B(L,he,lt){var Vt=he[0],et=he[1],wt=he[2],Qe=he[3],ft=he[4],ut=he[5],$t=he[6],It=he[7],on=he[8],at=lt[0],Yt=lt[1];return L[0]=Vt,L[1]=et,L[2]=wt,L[3]=Qe,L[4]=ft,L[5]=ut,L[6]=at*Vt+Yt*Qe+$t,L[7]=at*et+Yt*ft+It,L[8]=at*wt+Yt*ut+on,L}function se(L,he,lt){var Vt=he[0],et=he[1],wt=he[2],Qe=he[3],ft=he[4],ut=he[5],$t=he[6],It=he[7],on=he[8],at=Math.sin(lt),Yt=Math.cos(lt);return L[0]=Yt*Vt+at*Qe,L[1]=Yt*et+at*ft,L[2]=Yt*wt+at*ut,L[3]=Yt*Qe-at*Vt,L[4]=Yt*ft-at*et,L[5]=Yt*ut-at*wt,L[6]=$t,L[7]=It,L[8]=on,L}function j(L,he,lt){var Vt=lt[0],et=lt[1];return L[0]=Vt*he[0],L[1]=Vt*he[1],L[2]=Vt*he[2],L[3]=et*he[3],L[4]=et*he[4],L[5]=et*he[5],L[6]=he[6],L[7]=he[7],L[8]=he[8],L}function b(L,he){return L[0]=1,L[1]=0,L[2]=0,L[3]=0,L[4]=1,L[5]=0,L[6]=he[0],L[7]=he[1],L[8]=1,L}function R(L,he){var lt=Math.sin(he),Vt=Math.cos(he);return L[0]=Vt,L[1]=lt,L[2]=0,L[3]=-lt,L[4]=Vt,L[5]=0,L[6]=0,L[7]=0,L[8]=1,L}function Me(L,he){return L[0]=he[0],L[1]=0,L[2]=0,L[3]=0,L[4]=he[1],L[5]=0,L[6]=0,L[7]=0,L[8]=1,L}function re(L,he){return L[0]=he[0],L[1]=he[1],L[2]=0,L[3]=he[2],L[4]=he[3],L[5]=0,L[6]=he[4],L[7]=he[5],L[8]=1,L}function ve(L,he){var lt=he[0],Vt=he[1],et=he[2],wt=he[3],Qe=lt+lt,ft=Vt+Vt,ut=et+et,$t=lt*Qe,It=Vt*Qe,on=Vt*ft,at=et*Qe,Yt=et*ft,Cn=et*ut,St=wt*Qe,sr=wt*ft,Nn=wt*ut;return L[0]=1-on-Cn,L[3]=It-Nn,L[6]=at+sr,L[1]=It+Nn,L[4]=1-$t-Cn,L[7]=Yt-St,L[2]=at-sr,L[5]=Yt+St,L[8]=1-$t-on,L}function ht(L,he){var lt=he[0],Vt=he[1],et=he[2],wt=he[3],Qe=he[4],ft=he[5],ut=he[6],$t=he[7],It=he[8],on=he[9],at=he[10],Yt=he[11],Cn=he[12],St=he[13],sr=he[14],Nn=he[15],Vr=lt*ft-Vt*Qe,an=lt*ut-et*Qe,br=lt*$t-wt*Qe,po=Vt*ut-et*ft,J=Vt*$t-wt*ft,pi=et*$t-wt*ut,vi=It*St-on*Cn,Ci=It*sr-at*Cn,_r=It*Nn-Yt*Cn,Ir=on*sr-at*St,ai=on*Nn-Yt*St,Nr=at*Nn-Yt*sr,wr=Vr*Nr-an*ai+br*Ir+po*_r-J*Ci+pi*vi;return wr?(wr=1/wr,L[0]=(ft*Nr-ut*ai+$t*Ir)*wr,L[1]=(ut*_r-Qe*Nr-$t*Ci)*wr,L[2]=(Qe*ai-ft*_r+$t*vi)*wr,L[3]=(et*ai-Vt*Nr-wt*Ir)*wr,L[4]=(lt*Nr-et*_r+wt*Ci)*wr,L[5]=(Vt*_r-lt*ai-wt*vi)*wr,L[6]=(St*pi-sr*J+Nn*po)*wr,L[7]=(sr*br-Cn*pi-Nn*an)*wr,L[8]=(Cn*J-St*br+Nn*Vr)*wr,L):null}function A(L,he,lt){return L[0]=2/he,L[1]=0,L[2]=0,L[3]=0,L[4]=-2/lt,L[5]=0,L[6]=-1,L[7]=1,L[8]=1,L}function Oe(L){return"mat3("+L[0]+", "+L[1]+", "+L[2]+", "+L[3]+", "+L[4]+", "+L[5]+", "+L[6]+", "+L[7]+", "+L[8]+")"}function Ue(L){return Math.hypot(L[0],L[1],L[2],L[3],L[4],L[5],L[6],L[7],L[8])}function At(L,he,lt){return L[0]=he[0]+lt[0],L[1]=he[1]+lt[1],L[2]=he[2]+lt[2],L[3]=he[3]+lt[3],L[4]=he[4]+lt[4],L[5]=he[5]+lt[5],L[6]=he[6]+lt[6],L[7]=he[7]+lt[7],L[8]=he[8]+lt[8],L}function Xt(L,he,lt){return L[0]=he[0]-lt[0],L[1]=he[1]-lt[1],L[2]=he[2]-lt[2],L[3]=he[3]-lt[3],L[4]=he[4]-lt[4],L[5]=he[5]-lt[5],L[6]=he[6]-lt[6],L[7]=he[7]-lt[7],L[8]=he[8]-lt[8],L}function On(L,he,lt){return L[0]=he[0]*lt,L[1]=he[1]*lt,L[2]=he[2]*lt,L[3]=he[3]*lt,L[4]=he[4]*lt,L[5]=he[5]*lt,L[6]=he[6]*lt,L[7]=he[7]*lt,L[8]=he[8]*lt,L}function le(L,he,lt,Vt){return L[0]=he[0]+lt[0]*Vt,L[1]=he[1]+lt[1]*Vt,L[2]=he[2]+lt[2]*Vt,L[3]=he[3]+lt[3]*Vt,L[4]=he[4]+lt[4]*Vt,L[5]=he[5]+lt[5]*Vt,L[6]=he[6]+lt[6]*Vt,L[7]=he[7]+lt[7]*Vt,L[8]=he[8]+lt[8]*Vt,L}function Fn(L,he){return L[0]===he[0]&&L[1]===he[1]&&L[2]===he[2]&&L[3]===he[3]&&L[4]===he[4]&&L[5]===he[5]&&L[6]===he[6]&&L[7]===he[7]&&L[8]===he[8]}function hr(L,he){var lt=L[0],Vt=L[1],et=L[2],wt=L[3],Qe=L[4],ft=L[5],ut=L[6],$t=L[7],It=L[8],on=he[0],at=he[1],Yt=he[2],Cn=he[3],St=he[4],sr=he[5],Nn=he[6],Vr=he[7],an=he[8];return Math.abs(lt-on)<=glMatrix.EPSILON*Math.max(1,Math.abs(lt),Math.abs(on))&&Math.abs(Vt-at)<=glMatrix.EPSILON*Math.max(1,Math.abs(Vt),Math.abs(at))&&Math.abs(et-Yt)<=glMatrix.EPSILON*Math.max(1,Math.abs(et),Math.abs(Yt))&&Math.abs(wt-Cn)<=glMatrix.EPSILON*Math.max(1,Math.abs(wt),Math.abs(Cn))&&Math.abs(Qe-St)<=glMatrix.EPSILON*Math.max(1,Math.abs(Qe),Math.abs(St))&&Math.abs(ft-sr)<=glMatrix.EPSILON*Math.max(1,Math.abs(ft),Math.abs(sr))&&Math.abs(ut-Nn)<=glMatrix.EPSILON*Math.max(1,Math.abs(ut),Math.abs(Nn))&&Math.abs($t-Vr)<=glMatrix.EPSILON*Math.max(1,Math.abs($t),Math.abs(Vr))&&Math.abs(It-an)<=glMatrix.EPSILON*Math.max(1,Math.abs(It),Math.abs(an))}var qn=null,pr=null},89550:function(Se){Se.exports=N;function N(w,k,D){return w[0]=k[0]+D[0],w[1]=k[1]+D[1],w}},62189:function(Se){Se.exports=N;function N(w,k){return w[0]=Math.ceil(k[0]),w[1]=Math.ceil(k[1]),w}},76057:function(Se){Se.exports=N;function N(w){var k=new Float32Array(2);return k[0]=w[0],k[1]=w[1],k}},3492:function(Se){Se.exports=N;function N(w,k){return w[0]=k[0],w[1]=k[1],w}},61589:function(Se){Se.exports=N;function N(){var w=new Float32Array(2);return w[0]=0,w[1]=0,w}},77741:function(Se){Se.exports=N;function N(w,k,D){var F=k[0]*D[1]-k[1]*D[0];return w[0]=w[1]=0,w[2]=F,w}},80278:function(Se,N,w){Se.exports=w(27953)},27953:function(Se){Se.exports=N;function N(w,k){var D=k[0]-w[0],F=k[1]-w[1];return Math.sqrt(D*D+F*F)}},49973:function(Se,N,w){Se.exports=w(6773)},6773:function(Se){Se.exports=N;function N(w,k,D){return w[0]=k[0]/D[0],w[1]=k[1]/D[1],w}},56601:function(Se){Se.exports=N;function N(w,k){return w[0]*k[0]+w[1]*k[1]}},89936:function(Se){Se.exports=1e-6},56609:function(Se,N,w){Se.exports=D;var k=w(89936);function D(F,U){var X=F[0],me=F[1],K=U[0],q=U[1];return Math.abs(X-K)<=k*Math.max(1,Math.abs(X),Math.abs(K))&&Math.abs(me-q)<=k*Math.max(1,Math.abs(me),Math.abs(q))}},39546:function(Se){Se.exports=N;function N(w,k){return w[0]===k[0]&&w[1]===k[1]}},67744:function(Se){Se.exports=N;function N(w,k){return w[0]=Math.floor(k[0]),w[1]=Math.floor(k[1]),w}},49002:function(Se,N,w){Se.exports=D;var k=w(61589)();function D(F,U,X,me,K,q){var ae,ee;for(U||(U=2),X||(X=0),me?ee=Math.min(me*U+X,F.length):ee=F.length,ae=X;ae<ee;ae+=U)k[0]=F[ae],k[1]=F[ae+1],K(k,k,q),F[ae]=k[0],F[ae+1]=k[1];return F}},69878:function(Se){Se.exports=N;function N(w,k){var D=new Float32Array(2);return D[0]=w,D[1]=k,D}},32644:function(Se,N,w){Se.exports={EPSILON:w(89936),create:w(61589),clone:w(76057),fromValues:w(69878),copy:w(3492),set:w(68854),equals:w(56609),exactEquals:w(39546),add:w(89550),subtract:w(43650),sub:w(45222),multiply:w(79920),mul:w(23113),divide:w(6773),div:w(49973),inverse:w(83793),min:w(20676),max:w(97899),rotate:w(48677),floor:w(67744),ceil:w(62189),round:w(57074),scale:w(47838),scaleAndAdd:w(21066),distance:w(27953),dist:w(80278),squaredDistance:w(14290),sqrDist:w(79569),length:w(37781),len:w(8123),squaredLength:w(26791),sqrLen:w(1791),negate:w(90549),normalize:w(36820),dot:w(56601),cross:w(77741),lerp:w(20577),random:w(85773),transformMat2:w(904),transformMat2d:w(60736),transformMat3:w(60221),transformMat4:w(37674),forEach:w(49002),limit:w(82418)}},83793:function(Se){Se.exports=N;function N(w,k){return w[0]=1/k[0],w[1]=1/k[1],w}},8123:function(Se,N,w){Se.exports=w(37781)},37781:function(Se){Se.exports=N;function N(w){var k=w[0],D=w[1];return Math.sqrt(k*k+D*D)}},20577:function(Se){Se.exports=N;function N(w,k,D,F){var U=k[0],X=k[1];return w[0]=U+F*(D[0]-U),w[1]=X+F*(D[1]-X),w}},82418:function(Se){Se.exports=N;function N(w,k,D){var F=k[0]*k[0]+k[1]*k[1];if(F>D*D){var U=Math.sqrt(F);w[0]=k[0]/U*D,w[1]=k[1]/U*D}else w[0]=k[0],w[1]=k[1];return w}},97899:function(Se){Se.exports=N;function N(w,k,D){return w[0]=Math.max(k[0],D[0]),w[1]=Math.max(k[1],D[1]),w}},20676:function(Se){Se.exports=N;function N(w,k,D){return w[0]=Math.min(k[0],D[0]),w[1]=Math.min(k[1],D[1]),w}},23113:function(Se,N,w){Se.exports=w(79920)},79920:function(Se){Se.exports=N;function N(w,k,D){return w[0]=k[0]*D[0],w[1]=k[1]*D[1],w}},90549:function(Se){Se.exports=N;function N(w,k){return w[0]=-k[0],w[1]=-k[1],w}},36820:function(Se){Se.exports=N;function N(w,k){var D=k[0],F=k[1],U=D*D+F*F;return U>0&&(U=1/Math.sqrt(U),w[0]=k[0]*U,w[1]=k[1]*U),w}},85773:function(Se){Se.exports=N;function N(w,k){k=k||1;var D=Math.random()*2*Math.PI;return w[0]=Math.cos(D)*k,w[1]=Math.sin(D)*k,w}},48677:function(Se){Se.exports=N;function N(w,k,D){var F=Math.cos(D),U=Math.sin(D),X=k[0],me=k[1];return w[0]=X*F-me*U,w[1]=X*U+me*F,w}},57074:function(Se){Se.exports=N;function N(w,k){return w[0]=Math.round(k[0]),w[1]=Math.round(k[1]),w}},47838:function(Se){Se.exports=N;function N(w,k,D){return w[0]=k[0]*D,w[1]=k[1]*D,w}},21066:function(Se){Se.exports=N;function N(w,k,D,F){return w[0]=k[0]+D[0]*F,w[1]=k[1]+D[1]*F,w}},68854:function(Se){Se.exports=N;function N(w,k,D){return w[0]=k,w[1]=D,w}},79569:function(Se,N,w){Se.exports=w(14290)},1791:function(Se,N,w){Se.exports=w(26791)},14290:function(Se){Se.exports=N;function N(w,k){var D=k[0]-w[0],F=k[1]-w[1];return D*D+F*F}},26791:function(Se){Se.exports=N;function N(w){var k=w[0],D=w[1];return k*k+D*D}},45222:function(Se,N,w){Se.exports=w(43650)},43650:function(Se){Se.exports=N;function N(w,k,D){return w[0]=k[0]-D[0],w[1]=k[1]-D[1],w}},904:function(Se){Se.exports=N;function N(w,k,D){var F=k[0],U=k[1];return w[0]=D[0]*F+D[2]*U,w[1]=D[1]*F+D[3]*U,w}},60736:function(Se){Se.exports=N;function N(w,k,D){var F=k[0],U=k[1];return w[0]=D[0]*F+D[2]*U+D[4],w[1]=D[1]*F+D[3]*U+D[5],w}},60221:function(Se){Se.exports=N;function N(w,k,D){var F=k[0],U=k[1];return w[0]=D[0]*F+D[3]*U+D[6],w[1]=D[1]*F+D[4]*U+D[7],w}},37674:function(Se){Se.exports=N;function N(w,k,D){var F=k[0],U=k[1];return w[0]=D[0]*F+D[4]*U+D[12],w[1]=D[1]*F+D[5]*U+D[13],w}},50450:function(Se,N,w){var k,D,F;/*!
* jQuery Mousewheel 3.1.13
*
* Copyright jQuery Foundation and other contributors
* Released under the MIT license
* http://jquery.org/license
*/(function(U){D=[w(19755)],k=U,F=typeof k=="function"?k.apply(N,D):k,F!==void 0&&(Se.exports=F)})(function(U){var X=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],me="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],K=Array.prototype.slice,q,ae;if(U.event.fixHooks)for(var ee=X.length;ee;)U.event.fixHooks[X[--ee]]=U.event.mouseHooks;var V=U.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var se=me.length;se;)this.addEventListener(me[--se],W,!1);else this.onmousewheel=W;U.data(this,"mousewheel-line-height",V.getLineHeight(this)),U.data(this,"mousewheel-page-height",V.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var se=me.length;se;)this.removeEventListener(me[--se],W,!1);else this.onmousewheel=null;U.removeData(this,"mousewheel-line-height"),U.removeData(this,"mousewheel-page-height")},getLineHeight:function(se){var j=U(se),b=j["offsetParent"in U.fn?"offsetParent":"parent"]();return b.length||(b=U("body")),parseInt(b.css("fontSize"),10)||parseInt(j.css("fontSize"),10)||16},getPageHeight:function(se){return U(se).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};U.fn.extend({mousewheel:function(se){return se?this.bind("mousewheel",se):this.trigger("mousewheel")},unmousewheel:function(se){return this.unbind("mousewheel",se)}});function W(se){var j=se||window.event,b=K.call(arguments,1),R=0,Me=0,re=0,ve=0,ht=0,A=0;if(se=U.event.fix(j),se.type="mousewheel","detail"in j&&(re=j.detail*-1),"wheelDelta"in j&&(re=j.wheelDelta),"wheelDeltaY"in j&&(re=j.wheelDeltaY),"wheelDeltaX"in j&&(Me=j.wheelDeltaX*-1),"axis"in j&&j.axis===j.HORIZONTAL_AXIS&&(Me=re*-1,re=0),R=re===0?Me:re,"deltaY"in j&&(re=j.deltaY*-1,R=re),"deltaX"in j&&(Me=j.deltaX,re===0&&(R=Me*-1)),!(re===0&&Me===0)){if(j.deltaMode===1){var Oe=U.data(this,"mousewheel-line-height");R*=Oe,re*=Oe,Me*=Oe}else if(j.deltaMode===2){var Ue=U.data(this,"mousewheel-page-height");R*=Ue,re*=Ue,Me*=Ue}if(ve=Math.max(Math.abs(re),Math.abs(Me)),(!ae||ve<ae)&&(ae=ve,B(j,ve)&&(ae/=40)),B(j,ve)&&(R/=40,Me/=40,re/=40),R=Math[R>=1?"floor":"ceil"](R/ae),Me=Math[Me>=1?"floor":"ceil"](Me/ae),re=Math[re>=1?"floor":"ceil"](re/ae),V.settings.normalizeOffset&&this.getBoundingClientRect){var At=this.getBoundingClientRect();ht=se.clientX-At.left,A=se.clientY-At.top}return se.deltaX=Me,se.deltaY=re,se.deltaFactor=ae,se.offsetX=ht,se.offsetY=A,se.deltaMode=0,b.unshift(se,R,Me,re),q&&clearTimeout(q),q=setTimeout(ce,200),(U.event.dispatch||U.event.handle).apply(this,b)}}function ce(){ae=null}function B(se,j){return V.settings.adjustOldDeltas&&se.type==="mousewheel"&&j%120==0}})},19755:function(Se,N){var w,k;/*!
* jQuery JavaScript Library v3.6.4
* https://jquery.com/
*
* Includes Sizzle.js
* https://sizzlejs.com/
*
* Copyright OpenJS Foundation and other contributors
* Released under the MIT license
* https://jquery.org/license
*
* Date: 2023-03-08T15:28Z
*/(function(D,F){"use strict";typeof Se.exports=="object"?Se.exports=D.document?F(D,!0):function(U){if(!U.document)throw new Error("jQuery requires a window with a document");return F(U)}:F(D)})(typeof window!="undefined"?window:this,function(D,F){"use strict";var U=[],X=Object.getPrototypeOf,me=U.slice,K=U.flat?function(m){return U.flat.call(m)}:function(m){return U.concat.apply([],m)},q=U.push,ae=U.indexOf,ee={},V=ee.toString,W=ee.hasOwnProperty,ce=W.toString,B=ce.call(Object),se={},j=function(C){return typeof C=="function"&&typeof C.nodeType!="number"&&typeof C.item!="function"},b=function(C){return C!=null&&C===C.window},R=D.document,Me={type:!0,src:!0,nonce:!0,noModule:!0};function re(m,C,_){_=_||R;var M,I,G=_.createElement("script");if(G.text=m,C)for(M in Me)I=C[M]||C.getAttribute&&C.getAttribute(M),I&&G.setAttribute(M,I);_.head.appendChild(G).parentNode.removeChild(G)}function ve(m){return m==null?m+"":typeof m=="object"||typeof m=="function"?ee[V.call(m)]||"object":typeof m}var ht="3.6.4",A=function(m,C){return new A.fn.init(m,C)};A.fn=A.prototype={jquery:ht,constructor:A,length:0,toArray:function(){return me.call(this)},get:function(m){return m==null?me.call(this):m<0?this[m+this.length]:this[m]},pushStack:function(m){var C=A.merge(this.constructor(),m);return C.prevObject=this,C},each:function(m){return A.each(this,m)},map:function(m){return this.pushStack(A.map(this,function(C,_){return m.call(C,_,C)}))},slice:function(){return this.pushStack(me.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(A.grep(this,function(m,C){return(C+1)%2}))},odd:function(){return this.pushStack(A.grep(this,function(m,C){return C%2}))},eq:function(m){var C=this.length,_=+m+(m<0?C:0);return this.pushStack(_>=0&&_<C?[this[_]]:[])},end:function(){return this.prevObject||this.constructor()},push:q,sort:U.sort,splice:U.splice},A.extend=A.fn.extend=function(){var m,C,_,M,I,G,H=arguments[0]||{},Ee=1,xe=arguments.length,Ve=!1;for(typeof H=="boolean"&&(Ve=H,H=arguments[Ee]||{},Ee++),typeof H!="object"&&!j(H)&&(H={}),Ee===xe&&(H=this,Ee--);Ee<xe;Ee++)if((m=arguments[Ee])!=null)for(C in m)M=m[C],!(C==="__proto__"||H===M)&&(Ve&&M&&(A.isPlainObject(M)||(I=Array.isArray(M)))?(_=H[C],I&&!Array.isArray(_)?G=[]:!I&&!A.isPlainObject(_)?G={}:G=_,I=!1,H[C]=A.extend(Ve,G,M)):M!==void 0&&(H[C]=M));return H},A.extend({expando:"jQuery"+(ht+Math.random()).replace(/\D/g,""),isReady:!0,error:function(m){throw new Error(m)},noop:function(){},isPlainObject:function(m){var C,_;return!m||V.call(m)!=="[object Object]"?!1:(C=X(m),C?(_=W.call(C,"constructor")&&C.constructor,typeof _=="function"&&ce.call(_)===B):!0)},isEmptyObject:function(m){var C;for(C in m)return!1;return!0},globalEval:function(m,C,_){re(m,{nonce:C&&C.nonce},_)},each:function(m,C){var _,M=0;if(Oe(m))for(_=m.length;M<_&&C.call(m[M],M,m[M])!==!1;M++);else for(M in m)if(C.call(m[M],M,m[M])===!1)break;return m},makeArray:function(m,C){var _=C||[];return m!=null&&(Oe(Object(m))?A.merge(_,typeof m=="string"?[m]:m):q.call(_,m)),_},inArray:function(m,C,_){return C==null?-1:ae.call(C,m,_)},merge:function(m,C){for(var _=+C.length,M=0,I=m.length;M<_;M++)m[I++]=C[M];return m.length=I,m},grep:function(m,C,_){for(var M,I=[],G=0,H=m.length,Ee=!_;G<H;G++)M=!C(m[G],G),M!==Ee&&I.push(m[G]);return I},map:function(m,C,_){var M,I,G=0,H=[];if(Oe(m))for(M=m.length;G<M;G++)I=C(m[G],G,_),I!=null&&H.push(I);else for(G in m)I=C(m[G],G,_),I!=null&&H.push(I);return K(H)},guid:1,support:se}),typeof Symbol=="function"&&(A.fn[Symbol.iterator]=U[Symbol.iterator]),A.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(m,C){ee["[object "+C+"]"]=C.toLowerCase()});function Oe(m){var C=!!m&&"length"in m&&m.length,_=ve(m);return j(m)||b(m)?!1:_==="array"||C===0||typeof C=="number"&&C>0&&C-1 in m}var Ue=function(m){var C,_,M,I,G,H,Ee,xe,Ve,nt,Ft,Ze,pt,Rn,ur,Mn,Wi,Ni,Uo,Jn="sizzle"+1*new Date,nr=m.document,Vo=0,gr=0,yi=ll(),Rs=ll(),ks=ll(),Oo=ll(),Is=function(Q,we){return Q===we&&(Ft=!0),0},bs={}.hasOwnProperty,mo=[],Zs=mo.pop,jo=mo.push,Xs=mo.push,Wl=mo.slice,Oa=function(Q,we){for(var ke=0,mt=Q.length;ke<mt;ke++)if(Q[ke]===we)return ke;return-1},td="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Jr="[\\x20\\t\\r\\n\\f]",Ho="(?:\\\\[\\da-fA-F]{1,6}"+Jr+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",Ls="\\["+Jr+"*("+Ho+")(?:"+Jr+"*([*^$|!~]?=)"+Jr+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+Ho+"))|)"+Jr+"*\\]",Zl=":("+Ho+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Ls+")*)|.*)\\)|)",nd=new RegExp(Jr+"+","g"),Ys=new RegExp("^"+Jr+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Jr+"+$","g"),rd=new RegExp("^"+Jr+"*,"+Jr+"*"),Fc=new RegExp("^"+Jr+"*([>+~]|"+Jr+")"+Jr+"*"),Bc=new RegExp(Jr+"|>"),id=new RegExp(Zl),Xl=new RegExp("^"+Ho+"$"),Gs={ID:new RegExp("^#("+Ho+")"),CLASS:new RegExp("^\\.("+Ho+")"),TAG:new RegExp("^("+Ho+"|[*])"),ATTR:new RegExp("^"+Ls),PSEUDO:new RegExp("^"+Zl),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Jr+"*(even|odd|(([+-]|)(\\d*)n|)"+Jr+"*(?:([+-]|)"+Jr+"*(\\d+)|))"+Jr+"*\\)|)","i"),bool:new RegExp("^(?:"+td+")$","i"),needsContext:new RegExp("^"+Jr+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Jr+"*((?:-\\d)?\\d*)"+Jr+"*\\)|)(?=[^-]|$)","i")},kh=/HTML$/i,Ih=/^(?:input|select|textarea|button)$/i,Lh=/^h\d$/i,sl=/^[^{]+\{\s*\[native \w/,Gh=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,zc=/[+~]/,$o=new RegExp("\\\\[\\da-fA-F]{1,6}"+Jr+"?|\\\\([^\\r\\n\\f])","g"),xs=function(Q,we){var ke="0x"+Q.slice(1)-65536;return we||(ke<0?String.fromCharCode(ke+65536):String.fromCharCode(ke>>10|55296,ke&1023|56320))},Uc=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,al=function(Q,we){return we?Q==="\0"?"\uFFFD":Q.slice(0,-1)+"\\"+Q.charCodeAt(Q.length-1).toString(16)+" ":"\\"+Q},Fh=function(){Ze()},Kp=Hc(function(Q){return Q.disabled===!0&&Q.nodeName.toLowerCase()==="fieldset"},{dir:"parentNode",next:"legend"});try{Xs.apply(mo=Wl.call(nr.childNodes),nr.childNodes),mo[nr.childNodes.length].nodeType}catch(Q){Xs={apply:mo.length?function(we,ke){jo.apply(we,Wl.call(ke))}:function(we,ke){for(var mt=we.length,Be=0;we[mt++]=ke[Be++];);we.length=mt-1}}}function di(Q,we,ke,mt){var Be,xt,zt,nn,sn,Wn,Un,Xn=we&&we.ownerDocument,xr=we?we.nodeType:9;if(ke=ke||[],typeof Q!="string"||!Q||xr!==1&&xr!==9&&xr!==11)return ke;if(!mt&&(Ze(we),we=we||pt,ur)){if(xr!==11&&(sn=Gh.exec(Q)))if(Be=sn[1]){if(xr===9)if(zt=we.getElementById(Be)){if(zt.id===Be)return ke.push(zt),ke}else return ke;else if(Xn&&(zt=Xn.getElementById(Be))&&Uo(we,zt)&&zt.id===Be)return ke.push(zt),ke}else{if(sn[2])return Xs.apply(ke,we.getElementsByTagName(Q)),ke;if((Be=sn[3])&&_.getElementsByClassName&&we.getElementsByClassName)return Xs.apply(ke,we.getElementsByClassName(Be)),ke}if(_.qsa&&!Oo[Q+" "]&&(!Mn||!Mn.test(Q))&&(xr!==1||we.nodeName.toLowerCase()!=="object")){if(Un=Q,Xn=we,xr===1&&(Bc.test(Q)||Fc.test(Q))){for(Xn=zc.test(Q)&&Kl(we.parentNode)||we,(Xn!==we||!_.scope)&&((nn=we.getAttribute("id"))?nn=nn.replace(Uc,al):we.setAttribute("id",nn=Jn)),Wn=H(Q),xt=Wn.length;xt--;)Wn[xt]=(nn?"#"+nn:":scope")+" "+pa(Wn[xt]);Un=Wn.join(",")}try{return Xs.apply(ke,Xn.querySelectorAll(Un)),ke}catch(Zr){Oo(Q,!0)}finally{nn===Jn&&we.removeAttribute("id")}}}return xe(Q.replace(Ys,"$1"),we,ke,mt)}function ll(){var Q=[];function we(ke,mt){return Q.push(ke+" ")>M.cacheLength&&delete we[Q.shift()],we[ke+" "]=mt}return we}function Cs(Q){return Q[Jn]=!0,Q}function Jo(Q){var we=pt.createElement("fieldset");try{return!!Q(we)}catch(ke){return!1}finally{we.parentNode&&we.parentNode.removeChild(we),we=null}}function Yl(Q,we){for(var ke=Q.split("|"),mt=ke.length;mt--;)M.attrHandle[ke[mt]]=we}function Vc(Q,we){var ke=we&&Q,mt=ke&&Q.nodeType===1&&we.nodeType===1&&Q.sourceIndex-we.sourceIndex;if(mt)return mt;if(ke){for(;ke=ke.nextSibling;)if(ke===we)return-1}return Q?1:-1}function qp(Q){return function(we){var ke=we.nodeName.toLowerCase();return ke==="input"&&we.type===Q}}function od(Q){return function(we){var ke=we.nodeName.toLowerCase();return(ke==="input"||ke==="button")&&we.type===Q}}function jc(Q){return function(we){return"form"in we?we.parentNode&&we.disabled===!1?"label"in we?"label"in we.parentNode?we.parentNode.disabled===Q:we.disabled===Q:we.isDisabled===Q||we.isDisabled!==!Q&&Kp(we)===Q:we.disabled===Q:"label"in we?we.disabled===Q:!1}}function fa(Q){return Cs(function(we){return we=+we,Cs(function(ke,mt){for(var Be,xt=Q([],ke.length,we),zt=xt.length;zt--;)ke[Be=xt[zt]]&&(ke[Be]=!(mt[Be]=ke[Be]))})})}function Kl(Q){return Q&&typeof Q.getElementsByTagName!="undefined"&&Q}_=di.support={},G=di.isXML=function(Q){var we=Q&&Q.namespaceURI,ke=Q&&(Q.ownerDocument||Q).documentElement;return!kh.test(we||ke&&ke.nodeName||"HTML")},Ze=di.setDocument=function(Q){var we,ke,mt=Q?Q.ownerDocument||Q:nr;return mt==pt||mt.nodeType!==9||!mt.documentElement||(pt=mt,Rn=pt.documentElement,ur=!G(pt),nr!=pt&&(ke=pt.defaultView)&&ke.top!==ke&&(ke.addEventListener?ke.addEventListener("unload",Fh,!1):ke.attachEvent&&ke.attachEvent("onunload",Fh)),_.scope=Jo(function(Be){return Rn.appendChild(Be).appendChild(pt.createElement("div")),typeof Be.querySelectorAll!="undefined"&&!Be.querySelectorAll(":scope fieldset div").length}),_.cssHas=Jo(function(){try{return pt.querySelector(":has(*,:jqfake)"),!1}catch(Be){return!0}}),_.attributes=Jo(function(Be){return Be.className="i",!Be.getAttribute("className")}),_.getElementsByTagName=Jo(function(Be){return Be.appendChild(pt.createComment("")),!Be.getElementsByTagName("*").length}),_.getElementsByClassName=sl.test(pt.getElementsByClassName),_.getById=Jo(function(Be){return Rn.appendChild(Be).id=Jn,!pt.getElementsByName||!pt.getElementsByName(Jn).length}),_.getById?(M.filter.ID=function(Be){var xt=Be.replace($o,xs);return function(zt){return zt.getAttribute("id")===xt}},M.find.ID=function(Be,xt){if(typeof xt.getElementById!="undefined"&&ur){var zt=xt.getElementById(Be);return zt?[zt]:[]}}):(M.filter.ID=function(Be){var xt=Be.replace($o,xs);return function(zt){var nn=typeof zt.getAttributeNode!="undefined"&&zt.getAttributeNode("id");return nn&&nn.value===xt}},M.find.ID=function(Be,xt){if(typeof xt.getElementById!="undefined"&&ur){var zt,nn,sn,Wn=xt.getElementById(Be);if(Wn){if(zt=Wn.getAttributeNode("id"),zt&&zt.value===Be)return[Wn];for(sn=xt.getElementsByName(Be),nn=0;Wn=sn[nn++];)if(zt=Wn.getAttributeNode("id"),zt&&zt.value===Be)return[Wn]}return[]}}),M.find.TAG=_.getElementsByTagName?function(Be,xt){if(typeof xt.getElementsByTagName!="undefined")return xt.getElementsByTagName(Be);if(_.qsa)return xt.querySelectorAll(Be)}:function(Be,xt){var zt,nn=[],sn=0,Wn=xt.getElementsByTagName(Be);if(Be==="*"){for(;zt=Wn[sn++];)zt.nodeType===1&&nn.push(zt);return nn}return Wn},M.find.CLASS=_.getElementsByClassName&&function(Be,xt){if(typeof xt.getElementsByClassName!="undefined"&&ur)return xt.getElementsByClassName(Be)},Wi=[],Mn=[],(_.qsa=sl.test(pt.querySelectorAll))&&(Jo(function(Be){var xt;Rn.appendChild(Be).innerHTML="<a id='"+Jn+"'></a><select id='"+Jn+"-\r\\' msallowcapture=''><option selected=''></option></select>",Be.querySelectorAll("[msallowcapture^='']").length&&Mn.push("[*^$]="+Jr+`*(?:''|"")`),Be.querySelectorAll("[selected]").length||Mn.push("\\["+Jr+"*(?:value|"+td+")"),Be.querySelectorAll("[id~="+Jn+"-]").length||Mn.push("~="),xt=pt.createElement("input"),xt.setAttribute("name",""),Be.appendChild(xt),Be.querySelectorAll("[name='']").length||Mn.push("\\["+Jr+"*name"+Jr+"*="+Jr+`*(?:''|"")`),Be.querySelectorAll(":checked").length||Mn.push(":checked"),Be.querySelectorAll("a#"+Jn+"+*").length||Mn.push(".#.+[+~]"),Be.querySelectorAll("\\\f"),Mn.push("[\\r\\n\\f]")}),Jo(function(Be){Be.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var xt=pt.createElement("input");xt.setAttribute("type","hidden"),Be.appendChild(xt).setAttribute("name","D"),Be.querySelectorAll("[name=d]").length&&Mn.push("name"+Jr+"*[*^$|!~]?="),Be.querySelectorAll(":enabled").length!==2&&Mn.push(":enabled",":disabled"),Rn.appendChild(Be).disabled=!0,Be.querySelectorAll(":disabled").length!==2&&Mn.push(":enabled",":disabled"),Be.querySelectorAll("*,:x"),Mn.push(",.*:")})),(_.matchesSelector=sl.test(Ni=Rn.matches||Rn.webkitMatchesSelector||Rn.mozMatchesSelector||Rn.oMatchesSelector||Rn.msMatchesSelector))&&Jo(function(Be){_.disconnectedMatch=Ni.call(Be,"*"),Ni.call(Be,"[s!='']:x"),Wi.push("!=",Zl)}),_.cssHas||Mn.push(":has"),Mn=Mn.length&&new RegExp(Mn.join("|")),Wi=Wi.length&&new RegExp(Wi.join("|")),we=sl.test(Rn.compareDocumentPosition),Uo=we||sl.test(Rn.contains)?function(Be,xt){var zt=Be.nodeType===9&&Be.documentElement||Be,nn=xt&&xt.parentNode;return Be===nn||!!(nn&&nn.nodeType===1&&(zt.contains?zt.contains(nn):Be.compareDocumentPosition&&Be.compareDocumentPosition(nn)&16))}:function(Be,xt){if(xt){for(;xt=xt.parentNode;)if(xt===Be)return!0}return!1},Is=we?function(Be,xt){if(Be===xt)return Ft=!0,0;var zt=!Be.compareDocumentPosition-!xt.compareDocumentPosition;return zt||(zt=(Be.ownerDocument||Be)==(xt.ownerDocument||xt)?Be.compareDocumentPosition(xt):1,zt&1||!_.sortDetached&&xt.compareDocumentPosition(Be)===zt?Be==pt||Be.ownerDocument==nr&&Uo(nr,Be)?-1:xt==pt||xt.ownerDocument==nr&&Uo(nr,xt)?1:nt?Oa(nt,Be)-Oa(nt,xt):0:zt&4?-1:1)}:function(Be,xt){if(Be===xt)return Ft=!0,0;var zt,nn=0,sn=Be.parentNode,Wn=xt.parentNode,Un=[Be],Xn=[xt];if(!sn||!Wn)return Be==pt?-1:xt==pt?1:sn?-1:Wn?1:nt?Oa(nt,Be)-Oa(nt,xt):0;if(sn===Wn)return Vc(Be,xt);for(zt=Be;zt=zt.parentNode;)Un.unshift(zt);for(zt=xt;zt=zt.parentNode;)Xn.unshift(zt);for(;Un[nn]===Xn[nn];)nn++;return nn?Vc(Un[nn],Xn[nn]):Un[nn]==nr?-1:Xn[nn]==nr?1:0}),pt},di.matches=function(Q,we){return di(Q,null,null,we)},di.matchesSelector=function(Q,we){if(Ze(Q),_.matchesSelector&&ur&&!Oo[we+" "]&&(!Wi||!Wi.test(we))&&(!Mn||!Mn.test(we)))try{var ke=Ni.call(Q,we);if(ke||_.disconnectedMatch||Q.document&&Q.document.nodeType!==11)return ke}catch(mt){Oo(we,!0)}return di(we,pt,null,[Q]).length>0},di.contains=function(Q,we){return(Q.ownerDocument||Q)!=pt&&Ze(Q),Uo(Q,we)},di.attr=function(Q,we){(Q.ownerDocument||Q)!=pt&&Ze(Q);var ke=M.attrHandle[we.toLowerCase()],mt=ke&&bs.call(M.attrHandle,we.toLowerCase())?ke(Q,we,!ur):void 0;return mt!==void 0?mt:_.attributes||!ur?Q.getAttribute(we):(mt=Q.getAttributeNode(we))&&mt.specified?mt.value:null},di.escape=function(Q){return(Q+"").replace(Uc,al)},di.error=function(Q){throw new Error("Syntax error, unrecognized expression: "+Q)},di.uniqueSort=function(Q){var we,ke=[],mt=0,Be=0;if(Ft=!_.detectDuplicates,nt=!_.sortStable&&Q.slice(0),Q.sort(Is),Ft){for(;we=Q[Be++];)we===Q[Be]&&(mt=ke.push(Be));for(;mt--;)Q.splice(ke[mt],1)}return nt=null,Q},I=di.getText=function(Q){var we,ke="",mt=0,Be=Q.nodeType;if(Be){if(Be===1||Be===9||Be===11){if(typeof Q.textContent=="string")return Q.textContent;for(Q=Q.firstChild;Q;Q=Q.nextSibling)ke+=I(Q)}else if(Be===3||Be===4)return Q.nodeValue}else for(;we=Q[mt++];)ke+=I(we);return ke},M=di.selectors={cacheLength:50,createPseudo:Cs,match:Gs,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(Q){return Q[1]=Q[1].replace($o,xs),Q[3]=(Q[3]||Q[4]||Q[5]||"").replace($o,xs),Q[2]==="~="&&(Q[3]=" "+Q[3]+" "),Q.slice(0,4)},CHILD:function(Q){return Q[1]=Q[1].toLowerCase(),Q[1].slice(0,3)==="nth"?(Q[3]||di.error(Q[0]),Q[4]=+(Q[4]?Q[5]+(Q[6]||1):2*(Q[3]==="even"||Q[3]==="odd")),Q[5]=+(Q[7]+Q[8]||Q[3]==="odd")):Q[3]&&di.error(Q[0]),Q},PSEUDO:function(Q){var we,ke=!Q[6]&&Q[2];return Gs.CHILD.test(Q[0])?null:(Q[3]?Q[2]=Q[4]||Q[5]||"":ke&&id.test(ke)&&(we=H(ke,!0))&&(we=ke.indexOf(")",ke.length-we)-ke.length)&&(Q[0]=Q[0].slice(0,we),Q[2]=ke.slice(0,we)),Q.slice(0,3))}},filter:{TAG:function(Q){var we=Q.replace($o,xs).toLowerCase();return Q==="*"?function(){return!0}:function(ke){return ke.nodeName&&ke.nodeName.toLowerCase()===we}},CLASS:function(Q){var we=yi[Q+" "];return we||(we=new RegExp("(^|"+Jr+")"+Q+"("+Jr+"|$)"))&&yi(Q,function(ke){return we.test(typeof ke.className=="string"&&ke.className||typeof ke.getAttribute!="undefined"&&ke.getAttribute("class")||"")})},ATTR:function(Q,we,ke){return function(mt){var Be=di.attr(mt,Q);return Be==null?we==="!=":we?(Be+="",we==="="?Be===ke:we==="!="?Be!==ke:we==="^="?ke&&Be.indexOf(ke)===0:we==="*="?ke&&Be.indexOf(ke)>-1:we==="$="?ke&&Be.slice(-ke.length)===ke:we==="~="?(" "+Be.replace(nd," ")+" ").indexOf(ke)>-1:we==="|="?Be===ke||Be.slice(0,ke.length+1)===ke+"-":!1):!0}},CHILD:function(Q,we,ke,mt,Be){var xt=Q.slice(0,3)!=="nth",zt=Q.slice(-4)!=="last",nn=we==="of-type";return mt===1&&Be===0?function(sn){return!!sn.parentNode}:function(sn,Wn,Un){var Xn,xr,Zr,vn,Vi,vo,Zi=xt!==zt?"nextSibling":"previousSibling",bi=sn.parentNode,cl=nn&&sn.nodeName.toLowerCase(),Jl=!Un&&!nn,Qo=!1;if(bi){if(xt){for(;Zi;){for(vn=sn;vn=vn[Zi];)if(nn?vn.nodeName.toLowerCase()===cl:vn.nodeType===1)return!1;vo=Zi=Q==="only"&&!vo&&"nextSibling"}return!0}if(vo=[zt?bi.firstChild:bi.lastChild],zt&&Jl){for(vn=bi,Zr=vn[Jn]||(vn[Jn]={}),xr=Zr[vn.uniqueID]||(Zr[vn.uniqueID]={}),Xn=xr[Q]||[],Vi=Xn[0]===Vo&&Xn[1],Qo=Vi&&Xn[2],vn=Vi&&bi.childNodes[Vi];vn=++Vi&&vn&&vn[Zi]||(Qo=Vi=0)||vo.pop();)if(vn.nodeType===1&&++Qo&&vn===sn){xr[Q]=[Vo,Vi,Qo];break}}else if(Jl&&(vn=sn,Zr=vn[Jn]||(vn[Jn]={}),xr=Zr[vn.uniqueID]||(Zr[vn.uniqueID]={}),Xn=xr[Q]||[],Vi=Xn[0]===Vo&&Xn[1],Qo=Vi),Qo===!1)for(;(vn=++Vi&&vn&&vn[Zi]||(Qo=Vi=0)||vo.pop())&&!((nn?vn.nodeName.toLowerCase()===cl:vn.nodeType===1)&&++Qo&&(Jl&&(Zr=vn[Jn]||(vn[Jn]={}),xr=Zr[vn.uniqueID]||(Zr[vn.uniqueID]={}),xr[Q]=[Vo,Qo]),vn===sn)););return Qo-=Be,Qo===mt||Qo%mt==0&&Qo/mt>=0}}},PSEUDO:function(Q,we){var ke,mt=M.pseudos[Q]||M.setFilters[Q.toLowerCase()]||di.error("unsupported pseudo: "+Q);return mt[Jn]?mt(we):mt.length>1?(ke=[Q,Q,"",we],M.setFilters.hasOwnProperty(Q.toLowerCase())?Cs(function(Be,xt){for(var zt,nn=mt(Be,we),sn=nn.length;sn--;)zt=Oa(Be,nn[sn]),Be[zt]=!(xt[zt]=nn[sn])}):function(Be){return mt(Be,0,ke)}):mt}},pseudos:{not:Cs(function(Q){var we=[],ke=[],mt=Ee(Q.replace(Ys,"$1"));return mt[Jn]?Cs(function(Be,xt,zt,nn){for(var sn,Wn=mt(Be,null,nn,[]),Un=Be.length;Un--;)(sn=Wn[Un])&&(Be[Un]=!(xt[Un]=sn))}):function(Be,xt,zt){return we[0]=Be,mt(we,null,zt,ke),we[0]=null,!ke.pop()}}),has:Cs(function(Q){return function(we){return di(Q,we).length>0}}),contains:Cs(function(Q){return Q=Q.replace($o,xs),function(we){return(we.textContent||I(we)).indexOf(Q)>-1}}),lang:Cs(function(Q){return Xl.test(Q||"")||di.error("unsupported lang: "+Q),Q=Q.replace($o,xs).toLowerCase(),function(we){var ke;do if(ke=ur?we.lang:we.getAttribute("xml:lang")||we.getAttribute("lang"))return ke=ke.toLowerCase(),ke===Q||ke.indexOf(Q+"-")===0;while((we=we.parentNode)&&we.nodeType===1);return!1}}),target:function(Q){var we=m.location&&m.location.hash;return we&&we.slice(1)===Q.id},root:function(Q){return Q===Rn},focus:function(Q){return Q===pt.activeElement&&(!pt.hasFocus||pt.hasFocus())&&!!(Q.type||Q.href||~Q.tabIndex)},enabled:jc(!1),disabled:jc(!0),checked:function(Q){var we=Q.nodeName.toLowerCase();return we==="input"&&!!Q.checked||we==="option"&&!!Q.selected},selected:function(Q){return Q.parentNode&&Q.parentNode.selectedIndex,Q.selected===!0},empty:function(Q){for(Q=Q.firstChild;Q;Q=Q.nextSibling)if(Q.nodeType<6)return!1;return!0},parent:function(Q){return!M.pseudos.empty(Q)},header:function(Q){return Lh.test(Q.nodeName)},input:function(Q){return Ih.test(Q.nodeName)},button:function(Q){var we=Q.nodeName.toLowerCase();return we==="input"&&Q.type==="button"||we==="button"},text:function(Q){var we;return Q.nodeName.toLowerCase()==="input"&&Q.type==="text"&&((we=Q.getAttribute("type"))==null||we.toLowerCase()==="text")},first:fa(function(){return[0]}),last:fa(function(Q,we){return[we-1]}),eq:fa(function(Q,we,ke){return[ke<0?ke+we:ke]}),even:fa(function(Q,we){for(var ke=0;ke<we;ke+=2)Q.push(ke);return Q}),odd:fa(function(Q,we){for(var ke=1;ke<we;ke+=2)Q.push(ke);return Q}),lt:fa(function(Q,we,ke){for(var mt=ke<0?ke+we:ke>we?we:ke;--mt>=0;)Q.push(mt);return Q}),gt:fa(function(Q,we,ke){for(var mt=ke<0?ke+we:ke;++mt<we;)Q.push(mt);return Q})}},M.pseudos.nth=M.pseudos.eq;for(C in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})M.pseudos[C]=qp(C);for(C in{submit:!0,reset:!0})M.pseudos[C]=od(C);function Bh(){}Bh.prototype=M.filters=M.pseudos,M.setFilters=new Bh,H=di.tokenize=function(Q,we){var ke,mt,Be,xt,zt,nn,sn,Wn=Rs[Q+" "];if(Wn)return we?0:Wn.slice(0);for(zt=Q,nn=[],sn=M.preFilter;zt;){(!ke||(mt=rd.exec(zt)))&&(mt&&(zt=zt.slice(mt[0].length)||zt),nn.push(Be=[])),ke=!1,(mt=Fc.exec(zt))&&(ke=mt.shift(),Be.push({value:ke,type:mt[0].replace(Ys," ")}),zt=zt.slice(ke.length));for(xt in M.filter)(mt=Gs[xt].exec(zt))&&(!sn[xt]||(mt=sn[xt](mt)))&&(ke=mt.shift(),Be.push({value:ke,type:xt,matches:mt}),zt=zt.slice(ke.length));if(!ke)break}return we?zt.length:zt?di.error(Q):Rs(Q,nn).slice(0)};function pa(Q){for(var we=0,ke=Q.length,mt="";we<ke;we++)mt+=Q[we].value;return mt}function Hc(Q,we,ke){var mt=we.dir,Be=we.next,xt=Be||mt,zt=ke&&xt==="parentNode",nn=gr++;return we.first?function(sn,Wn,Un){for(;sn=sn[mt];)if(sn.nodeType===1||zt)return Q(sn,Wn,Un);return!1}:function(sn,Wn,Un){var Xn,xr,Zr,vn=[Vo,nn];if(Un){for(;sn=sn[mt];)if((sn.nodeType===1||zt)&&Q(sn,Wn,Un))return!0}else for(;sn=sn[mt];)if(sn.nodeType===1||zt)if(Zr=sn[Jn]||(sn[Jn]={}),xr=Zr[sn.uniqueID]||(Zr[sn.uniqueID]={}),Be&&Be===sn.nodeName.toLowerCase())sn=sn[mt]||sn;else{if((Xn=xr[xt])&&Xn[0]===Vo&&Xn[1]===nn)return vn[2]=Xn[2];if(xr[xt]=vn,vn[2]=Q(sn,Wn,Un))return!0}return!1}}function sd(Q){return Q.length>1?function(we,ke,mt){for(var Be=Q.length;Be--;)if(!Q[Be](we,ke,mt))return!1;return!0}:Q[0]}function zh(Q,we,ke){for(var mt=0,Be=we.length;mt<Be;mt++)di(Q,we[mt],ke);return ke}function $c(Q,we,ke,mt,Be){for(var xt,zt=[],nn=0,sn=Q.length,Wn=we!=null;nn<sn;nn++)(xt=Q[nn])&&(!ke||ke(xt,mt,Be))&&(zt.push(xt),Wn&&we.push(nn));return zt}function ql(Q,we,ke,mt,Be,xt){return mt&&!mt[Jn]&&(mt=ql(mt)),Be&&!Be[Jn]&&(Be=ql(Be,xt)),Cs(function(zt,nn,sn,Wn){var Un,Xn,xr,Zr=[],vn=[],Vi=nn.length,vo=zt||zh(we||"*",sn.nodeType?[sn]:sn,[]),Zi=Q&&(zt||!we)?$c(vo,Zr,Q,sn,Wn):vo,bi=ke?Be||(zt?Q:Vi||mt)?[]:nn:Zi;if(ke&&ke(Zi,bi,sn,Wn),mt)for(Un=$c(bi,vn),mt(Un,[],sn,Wn),Xn=Un.length;Xn--;)(xr=Un[Xn])&&(bi[vn[Xn]]=!(Zi[vn[Xn]]=xr));if(zt){if(Be||Q){if(Be){for(Un=[],Xn=bi.length;Xn--;)(xr=bi[Xn])&&Un.push(Zi[Xn]=xr);Be(null,bi=[],Un,Wn)}for(Xn=bi.length;Xn--;)(xr=bi[Xn])&&(Un=Be?Oa(zt,xr):Zr[Xn])>-1&&(zt[Un]=!(nn[Un]=xr))}}else bi=$c(bi===nn?bi.splice(Vi,bi.length):bi),Be?Be(null,nn,bi,Wn):Xs.apply(nn,bi)})}function ad(Q){for(var we,ke,mt,Be=Q.length,xt=M.relative[Q[0].type],zt=xt||M.relative[" "],nn=xt?1:0,sn=Hc(function(Xn){return Xn===we},zt,!0),Wn=Hc(function(Xn){return Oa(we,Xn)>-1},zt,!0),Un=[function(Xn,xr,Zr){var vn=!xt&&(Zr||xr!==Ve)||((we=xr).nodeType?sn(Xn,xr,Zr):Wn(Xn,xr,Zr));return we=null,vn}];nn<Be;nn++)if(ke=M.relative[Q[nn].type])Un=[Hc(sd(Un),ke)];else{if(ke=M.filter[Q[nn].type].apply(null,Q[nn].matches),ke[Jn]){for(mt=++nn;mt<Be&&!M.relative[Q[mt].type];mt++);return ql(nn>1&&sd(Un),nn>1&&pa(Q.slice(0,nn-1).concat({value:Q[nn-2].type===" "?"*":""})).replace(Ys,"$1"),ke,nn<mt&&ad(Q.slice(nn,mt)),mt<Be&&ad(Q=Q.slice(mt)),mt<Be&&pa(Q))}Un.push(ke)}return sd(Un)}function Jp(Q,we){var ke=we.length>0,mt=Q.length>0,Be=function(xt,zt,nn,sn,Wn){var Un,Xn,xr,Zr=0,vn="0",Vi=xt&&[],vo=[],Zi=Ve,bi=xt||mt&&M.find.TAG("*",Wn),cl=Vo+=Zi==null?1:Math.random()||.1,Jl=bi.length;for(Wn&&(Ve=zt==pt||zt||Wn);vn!==Jl&&(Un=bi[vn])!=null;vn++){if(mt&&Un){for(Xn=0,!zt&&Un.ownerDocument!=pt&&(Ze(Un),nn=!ur);xr=Q[Xn++];)if(xr(Un,zt||pt,nn)){sn.push(Un);break}Wn&&(Vo=cl)}ke&&((Un=!xr&&Un)&&Zr--,xt&&Vi.push(Un))}if(Zr+=vn,ke&&vn!==Zr){for(Xn=0;xr=we[Xn++];)xr(Vi,vo,zt,nn);if(xt){if(Zr>0)for(;vn--;)Vi[vn]||vo[vn]||(vo[vn]=Zs.call(sn));vo=$c(vo)}Xs.apply(sn,vo),Wn&&!xt&&vo.length>0&&Zr+we.length>1&&di.uniqueSort(sn)}return Wn&&(Vo=cl,Ve=Zi),Vi};return ke?Cs(Be):Be}return Ee=di.compile=function(Q,we){var ke,mt=[],Be=[],xt=ks[Q+" "];if(!xt){for(we||(we=H(Q)),ke=we.length;ke--;)xt=ad(we[ke]),xt[Jn]?mt.push(xt):Be.push(xt);xt=ks(Q,Jp(Be,mt)),xt.selector=Q}return xt},xe=di.select=function(Q,we,ke,mt){var Be,xt,zt,nn,sn,Wn=typeof Q=="function"&&Q,Un=!mt&&H(Q=Wn.selector||Q);if(ke=ke||[],Un.length===1){if(xt=Un[0]=Un[0].slice(0),xt.length>2&&(zt=xt[0]).type==="ID"&&we.nodeType===9&&ur&&M.relative[xt[1].type]){if(we=(M.find.ID(zt.matches[0].replace($o,xs),we)||[])[0],we)Wn&&(we=we.parentNode);else return ke;Q=Q.slice(xt.shift().value.length)}for(Be=Gs.needsContext.test(Q)?0:xt.length;Be--&&(zt=xt[Be],!M.relative[nn=zt.type]);)if((sn=M.find[nn])&&(mt=sn(zt.matches[0].replace($o,xs),zc.test(xt[0].type)&&Kl(we.parentNode)||we))){if(xt.splice(Be,1),Q=mt.length&&pa(xt),!Q)return Xs.apply(ke,mt),ke;break}}return(Wn||Ee(Q,Un))(mt,we,!ur,ke,!we||zc.test(Q)&&Kl(we.parentNode)||we),ke},_.sortStable=Jn.split("").sort(Is).join("")===Jn,_.detectDuplicates=!!Ft,Ze(),_.sortDetached=Jo(function(Q){return Q.compareDocumentPosition(pt.createElement("fieldset"))&1}),Jo(function(Q){return Q.innerHTML="<a href='#'></a>",Q.firstChild.getAttribute("href")==="#"})||Yl("type|href|height|width",function(Q,we,ke){if(!ke)return Q.getAttribute(we,we.toLowerCase()==="type"?1:2)}),(!_.attributes||!Jo(function(Q){return Q.innerHTML="<input/>",Q.firstChild.setAttribute("value",""),Q.firstChild.getAttribute("value")===""}))&&Yl("value",function(Q,we,ke){if(!ke&&Q.nodeName.toLowerCase()==="input")return Q.defaultValue}),Jo(function(Q){return Q.getAttribute("disabled")==null})||Yl(td,function(Q,we,ke){var mt;if(!ke)return Q[we]===!0?we.toLowerCase():(mt=Q.getAttributeNode(we))&&mt.specified?mt.value:null}),di}(D);A.find=Ue,A.expr=Ue.selectors,A.expr[":"]=A.expr.pseudos,A.uniqueSort=A.unique=Ue.uniqueSort,A.text=Ue.getText,A.isXMLDoc=Ue.isXML,A.contains=Ue.contains,A.escapeSelector=Ue.escape;var At=function(m,C,_){for(var M=[],I=_!==void 0;(m=m[C])&&m.nodeType!==9;)if(m.nodeType===1){if(I&&A(m).is(_))break;M.push(m)}return M},Xt=function(m,C){for(var _=[];m;m=m.nextSibling)m.nodeType===1&&m!==C&&_.push(m);return _},On=A.expr.match.needsContext;function le(m,C){return m.nodeName&&m.nodeName.toLowerCase()===C.toLowerCase()}var Fn=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function hr(m,C,_){return j(C)?A.grep(m,function(M,I){return!!C.call(M,I,M)!==_}):C.nodeType?A.grep(m,function(M){return M===C!==_}):typeof C!="string"?A.grep(m,function(M){return ae.call(C,M)>-1!==_}):A.filter(C,m,_)}A.filter=function(m,C,_){var M=C[0];return _&&(m=":not("+m+")"),C.length===1&&M.nodeType===1?A.find.matchesSelector(M,m)?[M]:[]:A.find.matches(m,A.grep(C,function(I){return I.nodeType===1}))},A.fn.extend({find:function(m){var C,_,M=this.length,I=this;if(typeof m!="string")return this.pushStack(A(m).filter(function(){for(C=0;C<M;C++)if(A.contains(I[C],this))return!0}));for(_=this.pushStack([]),C=0;C<M;C++)A.find(m,I[C],_);return M>1?A.uniqueSort(_):_},filter:function(m){return this.pushStack(hr(this,m||[],!1))},not:function(m){return this.pushStack(hr(this,m||[],!0))},is:function(m){return!!hr(this,typeof m=="string"&&On.test(m)?A(m):m||[],!1).length}});var qn,pr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,L=A.fn.init=function(m,C,_){var M,I;if(!m)return this;if(_=_||qn,typeof m=="string")if(m[0]==="<"&&m[m.length-1]===">"&&m.length>=3?M=[null,m,null]:M=pr.exec(m),M&&(M[1]||!C))if(M[1]){if(C=C instanceof A?C[0]:C,A.merge(this,A.parseHTML(M[1],C&&C.nodeType?C.ownerDocument||C:R,!0)),Fn.test(M[1])&&A.isPlainObject(C))for(M in C)j(this[M])?this[M](C[M]):this.attr(M,C[M]);return this}else return I=R.getElementById(M[2]),I&&(this[0]=I,this.length=1),this;else return!C||C.jquery?(C||_).find(m):this.constructor(C).find(m);else{if(m.nodeType)return this[0]=m,this.length=1,this;if(j(m))return _.ready!==void 0?_.ready(m):m(A)}return A.makeArray(m,this)};L.prototype=A.fn,qn=A(R);var he=/^(?:parents|prev(?:Until|All))/,lt={children:!0,contents:!0,next:!0,prev:!0};A.fn.extend({has:function(m){var C=A(m,this),_=C.length;return this.filter(function(){for(var M=0;M<_;M++)if(A.contains(this,C[M]))return!0})},closest:function(m,C){var _,M=0,I=this.length,G=[],H=typeof m!="string"&&A(m);if(!On.test(m)){for(;M<I;M++)for(_=this[M];_&&_!==C;_=_.parentNode)if(_.nodeType<11&&(H?H.index(_)>-1:_.nodeType===1&&A.find.matchesSelector(_,m))){G.push(_);break}}return this.pushStack(G.length>1?A.uniqueSort(G):G)},index:function(m){return m?typeof m=="string"?ae.call(A(m),this[0]):ae.call(this,m.jquery?m[0]:m):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(m,C){return this.pushStack(A.uniqueSort(A.merge(this.get(),A(m,C))))},addBack:function(m){return this.add(m==null?this.prevObject:this.prevObject.filter(m))}});function Vt(m,C){for(;(m=m[C])&&m.nodeType!==1;);return m}A.each({parent:function(m){var C=m.parentNode;return C&&C.nodeType!==11?C:null},parents:function(m){return At(m,"parentNode")},parentsUntil:function(m,C,_){return At(m,"parentNode",_)},next:function(m){return Vt(m,"nextSibling")},prev:function(m){return Vt(m,"previousSibling")},nextAll:function(m){return At(m,"nextSibling")},prevAll:function(m){return At(m,"previousSibling")},nextUntil:function(m,C,_){return At(m,"nextSibling",_)},prevUntil:function(m,C,_){return At(m,"previousSibling",_)},siblings:function(m){return Xt((m.parentNode||{}).firstChild,m)},children:function(m){return Xt(m.firstChild)},contents:function(m){return m.contentDocument!=null&&X(m.contentDocument)?m.contentDocument:(le(m,"template")&&(m=m.content||m),A.merge([],m.childNodes))}},function(m,C){A.fn[m]=function(_,M){var I=A.map(this,C,_);return m.slice(-5)!=="Until"&&(M=_),M&&typeof M=="string"&&(I=A.filter(M,I)),this.length>1&&(lt[m]||A.uniqueSort(I),he.test(m)&&I.reverse()),this.pushStack(I)}});var et=/[^\x20\t\r\n\f]+/g;function wt(m){var C={};return A.each(m.match(et)||[],function(_,M){C[M]=!0}),C}A.Callbacks=function(m){m=typeof m=="string"?wt(m):A.extend({},m);var C,_,M,I,G=[],H=[],Ee=-1,xe=function(){for(I=I||m.once,M=C=!0;H.length;Ee=-1)for(_=H.shift();++Ee<G.length;)G[Ee].apply(_[0],_[1])===!1&&m.stopOnFalse&&(Ee=G.length,_=!1);m.memory||(_=!1),C=!1,I&&(_?G=[]:G="")},Ve={add:function(){return G&&(_&&!C&&(Ee=G.length-1,H.push(_)),function nt(Ft){A.each(Ft,function(Ze,pt){j(pt)?(!m.unique||!Ve.has(pt))&&G.push(pt):pt&&pt.length&&ve(pt)!=="string"&&nt(pt)})}(arguments),_&&!C&&xe()),this},remove:function(){return A.each(arguments,function(nt,Ft){for(var Ze;(Ze=A.inArray(Ft,G,Ze))>-1;)G.splice(Ze,1),Ze<=Ee&&Ee--}),this},has:function(nt){return nt?A.inArray(nt,G)>-1:G.length>0},empty:function(){return G&&(G=[]),this},disable:function(){return I=H=[],G=_="",this},disabled:function(){return!G},lock:function(){return I=H=[],!_&&!C&&(G=_=""),this},locked:function(){return!!I},fireWith:function(nt,Ft){return I||(Ft=Ft||[],Ft=[nt,Ft.slice?Ft.slice():Ft],H.push(Ft),C||xe()),this},fire:function(){return Ve.fireWith(this,arguments),this},fired:function(){return!!M}};return Ve};function Qe(m){return m}function ft(m){throw m}function ut(m,C,_,M){var I;try{m&&j(I=m.promise)?I.call(m).done(C).fail(_):m&&j(I=m.then)?I.call(m,C,_):C.apply(void 0,[m].slice(M))}catch(G){_.apply(void 0,[G])}}A.extend({Deferred:function(m){var C=[["notify","progress",A.Callbacks("memory"),A.Callbacks("memory"),2],["resolve","done",A.Callbacks("once memory"),A.Callbacks("once memory"),0,"resolved"],["reject","fail",A.Callbacks("once memory"),A.Callbacks("once memory"),1,"rejected"]],_="pending",M={state:function(){return _},always:function(){return I.done(arguments).fail(arguments),this},catch:function(G){return M.then(null,G)},pipe:function(){var G=arguments;return A.Deferred(function(H){A.each(C,function(Ee,xe){var Ve=j(G[xe[4]])&&G[xe[4]];I[xe[1]](function(){var nt=Ve&&Ve.apply(this,arguments);nt&&j(nt.promise)?nt.promise().progress(H.notify).done(H.resolve).fail(H.reject):H[xe[0]+"With"](this,Ve?[nt]:arguments)})}),G=null}).promise()},then:function(G,H,Ee){var xe=0;function Ve(nt,Ft,Ze,pt){return function(){var Rn=this,ur=arguments,Mn=function(){var Ni,Uo;if(!(nt<xe)){if(Ni=Ze.apply(Rn,ur),Ni===Ft.promise())throw new TypeError("Thenable self-resolution");Uo=Ni&&(typeof Ni=="object"||typeof Ni=="function")&&Ni.then,j(Uo)?pt?Uo.call(Ni,Ve(xe,Ft,Qe,pt),Ve(xe,Ft,ft,pt)):(xe++,Uo.call(Ni,Ve(xe,Ft,Qe,pt),Ve(xe,Ft,ft,pt),Ve(xe,Ft,Qe,Ft.notifyWith))):(Ze!==Qe&&(Rn=void 0,ur=[Ni]),(pt||Ft.resolveWith)(Rn,ur))}},Wi=pt?Mn:function(){try{Mn()}catch(Ni){A.Deferred.exceptionHook&&A.Deferred.exceptionHook(Ni,Wi.stackTrace),nt+1>=xe&&(Ze!==ft&&(Rn=void 0,ur=[Ni]),Ft.rejectWith(Rn,ur))}};nt?Wi():(A.Deferred.getStackHook&&(Wi.stackTrace=A.Deferred.getStackHook()),D.setTimeout(Wi))}}return A.Deferred(function(nt){C[0][3].add(Ve(0,nt,j(Ee)?Ee:Qe,nt.notifyWith)),C[1][3].add(Ve(0,nt,j(G)?G:Qe)),C[2][3].add(Ve(0,nt,j(H)?H:ft))}).promise()},promise:function(G){return G!=null?A.extend(G,M):M}},I={};return A.each(C,function(G,H){var Ee=H[2],xe=H[5];M[H[1]]=Ee.add,xe&&Ee.add(function(){_=xe},C[3-G][2].disable,C[3-G][3].disable,C[0][2].lock,C[0][3].lock),Ee.add(H[3].fire),I[H[0]]=function(){return I[H[0]+"With"](this===I?void 0:this,arguments),this},I[H[0]+"With"]=Ee.fireWith}),M.promise(I),m&&m.call(I,I),I},when:function(m){var C=arguments.length,_=C,M=Array(_),I=me.call(arguments),G=A.Deferred(),H=function(Ee){return function(xe){M[Ee]=this,I[Ee]=arguments.length>1?me.call(arguments):xe,--C||G.resolveWith(M,I)}};if(C<=1&&(ut(m,G.done(H(_)).resolve,G.reject,!C),G.state()==="pending"||j(I[_]&&I[_].then)))return G.then();for(;_--;)ut(I[_],H(_),G.reject);return G.promise()}});var $t=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;A.Deferred.exceptionHook=function(m,C){D.console&&D.console.warn&&m&&$t.test(m.name)&&D.console.warn("jQuery.Deferred exception: "+m.message,m.stack,C)},A.readyException=function(m){D.setTimeout(function(){throw m})};var It=A.Deferred();A.fn.ready=function(m){return It.then(m).catch(function(C){A.readyException(C)}),this},A.extend({isReady:!1,readyWait:1,ready:function(m){(m===!0?--A.readyWait:A.isReady)||(A.isReady=!0,!(m!==!0&&--A.readyWait>0)&&It.resolveWith(R,[A]))}}),A.ready.then=It.then;function on(){R.removeEventListener("DOMContentLoaded",on),D.removeEventListener("load",on),A.ready()}R.readyState==="complete"||R.readyState!=="loading"&&!R.documentElement.doScroll?D.setTimeout(A.ready):(R.addEventListener("DOMContentLoaded",on),D.addEventListener("load",on));var at=function(m,C,_,M,I,G,H){var Ee=0,xe=m.length,Ve=_==null;if(ve(_)==="object"){I=!0;for(Ee in _)at(m,C,Ee,_[Ee],!0,G,H)}else if(M!==void 0&&(I=!0,j(M)||(H=!0),Ve&&(H?(C.call(m,M),C=null):(Ve=C,C=function(nt,Ft,Ze){return Ve.call(A(nt),Ze)})),C))for(;Ee<xe;Ee++)C(m[Ee],_,H?M:M.call(m[Ee],Ee,C(m[Ee],_)));return I?m:Ve?C.call(m):xe?C(m[0],_):G},Yt=/^-ms-/,Cn=/-([a-z])/g;function St(m,C){return C.toUpperCase()}function sr(m){return m.replace(Yt,"ms-").replace(Cn,St)}var Nn=function(m){return m.nodeType===1||m.nodeType===9||!+m.nodeType};function Vr(){this.expando=A.expando+Vr.uid++}Vr.uid=1,Vr.prototype={cache:function(m){var C=m[this.expando];return C||(C={},Nn(m)&&(m.nodeType?m[this.expando]=C:Object.defineProperty(m,this.expando,{value:C,configurable:!0}))),C},set:function(m,C,_){var M,I=this.cache(m);if(typeof C=="string")I[sr(C)]=_;else for(M in C)I[sr(M)]=C[M];return I},get:function(m,C){return C===void 0?this.cache(m):m[this.expando]&&m[this.expando][sr(C)]},access:function(m,C,_){return C===void 0||C&&typeof C=="string"&&_===void 0?this.get(m,C):(this.set(m,C,_),_!==void 0?_:C)},remove:function(m,C){var _,M=m[this.expando];if(M!==void 0){if(C!==void 0)for(Array.isArray(C)?C=C.map(sr):(C=sr(C),C=C in M?[C]:C.match(et)||[]),_=C.length;_--;)delete M[C[_]];(C===void 0||A.isEmptyObject(M))&&(m.nodeType?m[this.expando]=void 0:delete m[this.expando])}},hasData:function(m){var C=m[this.expando];return C!==void 0&&!A.isEmptyObject(C)}};var an=new Vr,br=new Vr,po=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,J=/[A-Z]/g;function pi(m){return m==="true"?!0:m==="false"?!1:m==="null"?null:m===+m+""?+m:po.test(m)?JSON.parse(m):m}function vi(m,C,_){var M;if(_===void 0&&m.nodeType===1)if(M="data-"+C.replace(J,"-$&").toLowerCase(),_=m.getAttribute(M),typeof _=="string"){try{_=pi(_)}catch(I){}br.set(m,C,_)}else _=void 0;return _}A.extend({hasData:function(m){return br.hasData(m)||an.hasData(m)},data:function(m,C,_){return br.access(m,C,_)},removeData:function(m,C){br.remove(m,C)},_data:function(m,C,_){return an.access(m,C,_)},_removeData:function(m,C){an.remove(m,C)}}),A.fn.extend({data:function(m,C){var _,M,I,G=this[0],H=G&&G.attributes;if(m===void 0){if(this.length&&(I=br.get(G),G.nodeType===1&&!an.get(G,"hasDataAttrs"))){for(_=H.length;_--;)H[_]&&(M=H[_].name,M.indexOf("data-")===0&&(M=sr(M.slice(5)),vi(G,M,I[M])));an.set(G,"hasDataAttrs",!0)}return I}return typeof m=="object"?this.each(function(){br.set(this,m)}):at(this,function(Ee){var xe;if(G&&Ee===void 0)return xe=br.get(G,m),xe!==void 0||(xe=vi(G,m),xe!==void 0)?xe:void 0;this.each(function(){br.set(this,m,Ee)})},null,C,arguments.length>1,null,!0)},removeData:function(m){return this.each(function(){br.remove(this,m)})}}),A.extend({queue:function(m,C,_){var M;if(m)return C=(C||"fx")+"queue",M=an.get(m,C),_&&(!M||Array.isArray(_)?M=an.access(m,C,A.makeArray(_)):M.push(_)),M||[]},dequeue:function(m,C){C=C||"fx";var _=A.queue(m,C),M=_.length,I=_.shift(),G=A._queueHooks(m,C),H=function(){A.dequeue(m,C)};I==="inprogress"&&(I=_.shift(),M--),I&&(C==="fx"&&_.unshift("inprogress"),delete G.stop,I.call(m,H,G)),!M&&G&&G.empty.fire()},_queueHooks:function(m,C){var _=C+"queueHooks";return an.get(m,_)||an.access(m,_,{empty:A.Callbacks("once memory").add(function(){an.remove(m,[C+"queue",_])})})}}),A.fn.extend({queue:function(m,C){var _=2;return typeof m!="string"&&(C=m,m="fx",_--),arguments.length<_?A.queue(this[0],m):C===void 0?this:this.each(function(){var M=A.queue(this,m,C);A._queueHooks(this,m),m==="fx"&&M[0]!=="inprogress"&&A.dequeue(this,m)})},dequeue:function(m){return this.each(function(){A.dequeue(this,m)})},clearQueue:function(m){return this.queue(m||"fx",[])},promise:function(m,C){var _,M=1,I=A.Deferred(),G=this,H=this.length,Ee=function(){--M||I.resolveWith(G,[G])};for(typeof m!="string"&&(C=m,m=void 0),m=m||"fx";H--;)_=an.get(G[H],m+"queueHooks"),_&&_.empty&&(M++,_.empty.add(Ee));return Ee(),I.promise(C)}});var Ci=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,_r=new RegExp("^(?:([+-])=|)("+Ci+")([a-z%]*)$","i"),Ir=["Top","Right","Bottom","Left"],ai=R.documentElement,Nr=function(m){return A.contains(m.ownerDocument,m)},wr={composed:!0};ai.getRootNode&&(Nr=function(m){return A.contains(m.ownerDocument,m)||m.getRootNode(wr)===m.ownerDocument});var Mi=function(m,C){return m=C||m,m.style.display==="none"||m.style.display===""&&Nr(m)&&A.css(m,"display")==="none"};function zi(m,C,_,M){var I,G,H=20,Ee=M?function(){return M.cur()}:function(){return A.css(m,C,"")},xe=Ee(),Ve=_&&_[3]||(A.cssNumber[C]?"":"px"),nt=m.nodeType&&(A.cssNumber[C]||Ve!=="px"&&+xe)&&_r.exec(A.css(m,C));if(nt&&nt[3]!==Ve){for(xe=xe/2,Ve=Ve||nt[3],nt=+xe||1;H--;)A.style(m,C,nt+Ve),(1-G)*(1-(G=Ee()/xe||.5))<=0&&(H=0),nt=nt/G;nt=nt*2,A.style(m,C,nt+Ve),_=_||[]}return _&&(nt=+nt||+xe||0,I=_[1]?nt+(_[1]+1)*_[2]:+_[2],M&&(M.unit=Ve,M.start=nt,M.end=I)),I}var S={};function wi(m){var C,_=m.ownerDocument,M=m.nodeName,I=S[M];return I||(C=_.body.appendChild(_.createElement(M)),I=A.css(C,"display"),C.parentNode.removeChild(C),I==="none"&&(I="block"),S[M]=I,I)}function Cr(m,C){for(var _,M,I=[],G=0,H=m.length;G<H;G++)M=m[G],!!M.style&&(_=M.style.display,C?(_==="none"&&(I[G]=an.get(M,"display")||null,I[G]||(M.style.display="")),M.style.display===""&&Mi(M)&&(I[G]=wi(M))):_!=="none"&&(I[G]="none",an.set(M,"display",_)));for(G=0;G<H;G++)I[G]!=null&&(m[G].style.display=I[G]);return m}A.fn.extend({show:function(){return Cr(this,!0)},hide:function(){return Cr(this)},toggle:function(m){return typeof m=="boolean"?m?this.show():this.hide():this.each(function(){Mi(this)?A(this).show():A(this).hide()})}});var sa=/^(?:checkbox|radio)$/i,Nc=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,jr=/^$|^module$|\/(?:java|ecma)script/i;(function(){var m=R.createDocumentFragment(),C=m.appendChild(R.createElement("div")),_=R.createElement("input");_.setAttribute("type","radio"),_.setAttribute("checked","checked"),_.setAttribute("name","t"),C.appendChild(_),se.checkClone=C.cloneNode(!0).cloneNode(!0).lastChild.checked,C.innerHTML="<textarea>x</textarea>",se.noCloneChecked=!!C.cloneNode(!0).lastChild.defaultValue,C.innerHTML="<option></option>",se.option=!!C.lastChild})();var zo={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};zo.tbody=zo.tfoot=zo.colgroup=zo.caption=zo.thead,zo.th=zo.td,se.option||(zo.optgroup=zo.option=[1,"<select multiple='multiple'>","</select>"]);function Di(m,C){var _;return typeof m.getElementsByTagName!="undefined"?_=m.getElementsByTagName(C||"*"):typeof m.querySelectorAll!="undefined"?_=m.querySelectorAll(C||"*"):_=[],C===void 0||C&&le(m,C)?A.merge([m],_):_}function Ws(m,C){for(var _=0,M=m.length;_<M;_++)an.set(m[_],"globalEval",!C||an.get(C[_],"globalEval"))}var aa=/<|&#?\w+;/;function Ka(m,C,_,M,I){for(var G,H,Ee,xe,Ve,nt,Ft=C.createDocumentFragment(),Ze=[],pt=0,Rn=m.length;pt<Rn;pt++)if(G=m[pt],G||G===0)if(ve(G)==="object")A.merge(Ze,G.nodeType?[G]:G);else if(!aa.test(G))Ze.push(C.createTextNode(G));else{for(H=H||Ft.appendChild(C.createElement("div")),Ee=(Nc.exec(G)||["",""])[1].toLowerCase(),xe=zo[Ee]||zo._default,H.innerHTML=xe[1]+A.htmlPrefilter(G)+xe[2],nt=xe[0];nt--;)H=H.lastChild;A.merge(Ze,H.childNodes),H=Ft.firstChild,H.textContent=""}for(Ft.textContent="",pt=0;G=Ze[pt++];){if(M&&A.inArray(G,M)>-1){I&&I.push(G);continue}if(Ve=Nr(G),H=Di(Ft.appendChild(G),"script"),Ve&&Ws(H),_)for(nt=0;G=H[nt++];)jr.test(G.type||"")&&_.push(G)}return Ft}var Fl=/^([^.]*)(?:\.(.+)|)/;function io(){return!0}function Ui(){return!1}function gh(m,C){return m===mh()==(C==="focus")}function mh(){try{return R.activeElement}catch(m){}}function Rc(m,C,_,M,I,G){var H,Ee;if(typeof C=="object"){typeof _!="string"&&(M=M||_,_=void 0);for(Ee in C)Rc(m,Ee,_,M,C[Ee],G);return m}if(M==null&&I==null?(I=_,M=_=void 0):I==null&&(typeof _=="string"?(I=M,M=void 0):(I=M,M=_,_=void 0)),I===!1)I=Ui;else if(!I)return m;return G===1&&(H=I,I=function(xe){return A().off(xe),H.apply(this,arguments)},I.guid=H.guid||(H.guid=A.guid++)),m.each(function(){A.event.add(this,C,I,M,_)})}A.event={global:{},add:function(m,C,_,M,I){var G,H,Ee,xe,Ve,nt,Ft,Ze,pt,Rn,ur,Mn=an.get(m);if(!!Nn(m))for(_.handler&&(G=_,_=G.handler,I=G.selector),I&&A.find.matchesSelector(ai,I),_.guid||(_.guid=A.guid++),(xe=Mn.events)||(xe=Mn.events=Object.create(null)),(H=Mn.handle)||(H=Mn.handle=function(Wi){return typeof A!="undefined"&&A.event.triggered!==Wi.type?A.event.dispatch.apply(m,arguments):void 0}),C=(C||"").match(et)||[""],Ve=C.length;Ve--;)Ee=Fl.exec(C[Ve])||[],pt=ur=Ee[1],Rn=(Ee[2]||"").split(".").sort(),!!pt&&(Ft=A.event.special[pt]||{},pt=(I?Ft.delegateType:Ft.bindType)||pt,Ft=A.event.special[pt]||{},nt=A.extend({type:pt,origType:ur,data:M,handler:_,guid:_.guid,selector:I,needsContext:I&&A.expr.match.needsContext.test(I),namespace:Rn.join(".")},G),(Ze=xe[pt])||(Ze=xe[pt]=[],Ze.delegateCount=0,(!Ft.setup||Ft.setup.call(m,M,Rn,H)===!1)&&m.addEventListener&&m.addEventListener(pt,H)),Ft.add&&(Ft.add.call(m,nt),nt.handler.guid||(nt.handler.guid=_.guid)),I?Ze.splice(Ze.delegateCount++,0,nt):Ze.push(nt),A.event.global[pt]=!0)},remove:function(m,C,_,M,I){var G,H,Ee,xe,Ve,nt,Ft,Ze,pt,Rn,ur,Mn=an.hasData(m)&&an.get(m);if(!(!Mn||!(xe=Mn.events))){for(C=(C||"").match(et)||[""],Ve=C.length;Ve--;){if(Ee=Fl.exec(C[Ve])||[],pt=ur=Ee[1],Rn=(Ee[2]||"").split(".").sort(),!pt){for(pt in xe)A.event.remove(m,pt+C[Ve],_,M,!0);continue}for(Ft=A.event.special[pt]||{},pt=(M?Ft.delegateType:Ft.bindType)||pt,Ze=xe[pt]||[],Ee=Ee[2]&&new RegExp("(^|\\.)"+Rn.join("\\.(?:.*\\.|)")+"(\\.|$)"),H=G=Ze.length;G--;)nt=Ze[G],(I||ur===nt.origType)&&(!_||_.guid===nt.guid)&&(!Ee||Ee.test(nt.namespace))&&(!M||M===nt.selector||M==="**"&&nt.selector)&&(Ze.splice(G,1),nt.selector&&Ze.delegateCount--,Ft.remove&&Ft.remove.call(m,nt));H&&!Ze.length&&((!Ft.teardown||Ft.teardown.call(m,Rn,Mn.handle)===!1)&&A.removeEvent(m,pt,Mn.handle),delete xe[pt])}A.isEmptyObject(xe)&&an.remove(m,"handle events")}},dispatch:function(m){var C,_,M,I,G,H,Ee=new Array(arguments.length),xe=A.event.fix(m),Ve=(an.get(this,"events")||Object.create(null))[xe.type]||[],nt=A.event.special[xe.type]||{};for(Ee[0]=xe,C=1;C<arguments.length;C++)Ee[C]=arguments[C];if(xe.delegateTarget=this,!(nt.preDispatch&&nt.preDispatch.call(this,xe)===!1)){for(H=A.event.handlers.call(this,xe,Ve),C=0;(I=H[C++])&&!xe.isPropagationStopped();)for(xe.currentTarget=I.elem,_=0;(G=I.handlers[_++])&&!xe.isImmediatePropagationStopped();)(!xe.rnamespace||G.namespace===!1||xe.rnamespace.test(G.namespace))&&(xe.handleObj=G,xe.data=G.data,M=((A.event.special[G.origType]||{}).handle||G.handler).apply(I.elem,Ee),M!==void 0&&(xe.result=M)===!1&&(xe.preventDefault(),xe.stopPropagation()));return nt.postDispatch&&nt.postDispatch.call(this,xe),xe.result}},handlers:function(m,C){var _,M,I,G,H,Ee=[],xe=C.delegateCount,Ve=m.target;if(xe&&Ve.nodeType&&!(m.type==="click"&&m.button>=1)){for(;Ve!==this;Ve=Ve.parentNode||this)if(Ve.nodeType===1&&!(m.type==="click"&&Ve.disabled===!0)){for(G=[],H={},_=0;_<xe;_++)M=C[_],I=M.selector+" ",H[I]===void 0&&(H[I]=M.needsContext?A(I,this).index(Ve)>-1:A.find(I,this,null,[Ve]).length),H[I]&&G.push(M);G.length&&Ee.push({elem:Ve,handlers:G})}}return Ve=this,xe<C.length&&Ee.push({elem:Ve,handlers:C.slice(xe)}),Ee},addProp:function(m,C){Object.defineProperty(A.Event.prototype,m,{enumerable:!0,configurable:!0,get:j(C)?function(){if(this.originalEvent)return C(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[m]},set:function(_){Object.defineProperty(this,m,{enumerable:!0,configurable:!0,writable:!0,value:_})}})},fix:function(m){return m[A.expando]?m:new A.Event(m)},special:{load:{noBubble:!0},click:{setup:function(m){var C=this||m;return sa.test(C.type)&&C.click&&le(C,"input")&&Bl(C,"click",io),!1},trigger:function(m){var C=this||m;return sa.test(C.type)&&C.click&&le(C,"input")&&Bl(C,"click"),!0},_default:function(m){var C=m.target;return sa.test(C.type)&&C.click&&le(C,"input")&&an.get(C,"click")||le(C,"a")}},beforeunload:{postDispatch:function(m){m.result!==void 0&&m.originalEvent&&(m.originalEvent.returnValue=m.result)}}}};function Bl(m,C,_){if(!_){an.get(m,C)===void 0&&A.event.add(m,C,io);return}an.set(m,C,!1),A.event.add(m,C,{namespace:!1,handler:function(M){var I,G,H=an.get(this,C);if(M.isTrigger&1&&this[C]){if(H.length)(A.event.special[C]||{}).delegateType&&M.stopPropagation();else if(H=me.call(arguments),an.set(this,C,H),I=_(this,C),this[C](),G=an.get(this,C),H!==G||I?an.set(this,C,!1):G={},H!==G)return M.stopImmediatePropagation(),M.preventDefault(),G&&G.value}else H.length&&(an.set(this,C,{value:A.event.trigger(A.extend(H[0],A.Event.prototype),H.slice(1),this)}),M.stopImmediatePropagation())}})}A.removeEvent=function(m,C,_){m.removeEventListener&&m.removeEventListener(C,_)},A.Event=function(m,C){if(!(this instanceof A.Event))return new A.Event(m,C);m&&m.type?(this.originalEvent=m,this.type=m.type,this.isDefaultPrevented=m.defaultPrevented||m.defaultPrevented===void 0&&m.returnValue===!1?io:Ui,this.target=m.target&&m.target.nodeType===3?m.target.parentNode:m.target,this.currentTarget=m.currentTarget,this.relatedTarget=m.relatedTarget):this.type=m,C&&A.extend(this,C),this.timeStamp=m&&m.timeStamp||Date.now(),this[A.expando]=!0},A.Event.prototype={constructor:A.Event,isDefaultPrevented:Ui,isPropagationStopped:Ui,isImmediatePropagationStopped:Ui,isSimulated:!1,preventDefault:function(){var m=this.originalEvent;this.isDefaultPrevented=io,m&&!this.isSimulated&&m.preventDefault()},stopPropagation:function(){var m=this.originalEvent;this.isPropagationStopped=io,m&&!this.isSimulated&&m.stopPropagation()},stopImmediatePropagation:function(){var m=this.originalEvent;this.isImmediatePropagationStopped=io,m&&!this.isSimulated&&m.stopImmediatePropagation(),this.stopPropagation()}},A.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},A.event.addProp),A.each({focus:"focusin",blur:"focusout"},function(m,C){A.event.special[m]={setup:function(){return Bl(this,m,gh),!1},trigger:function(){return Bl(this,m),!0},_default:function(_){return an.get(_.target,m)},delegateType:C}}),A.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(m,C){A.event.special[m]={delegateType:C,bindType:C,handle:function(_){var M,I=this,G=_.relatedTarget,H=_.handleObj;return(!G||G!==I&&!A.contains(I,G))&&(_.type=H.origType,M=H.handler.apply(this,arguments),_.type=C),M}}}),A.fn.extend({on:function(m,C,_,M){return Rc(this,m,C,_,M)},one:function(m,C,_,M){return Rc(this,m,C,_,M,1)},off:function(m,C,_){var M,I;if(m&&m.preventDefault&&m.handleObj)return M=m.handleObj,A(m.delegateTarget).off(M.namespace?M.origType+"."+M.namespace:M.origType,M.selector,M.handler),this;if(typeof m=="object"){for(I in m)this.off(I,C,m[I]);return this}return(C===!1||typeof C=="function")&&(_=C,C=void 0),_===!1&&(_=Ui),this.each(function(){A.event.remove(this,m,_,C)})}});var vh=/<script|<style|<link/i,yh=/checked\s*(?:[^=]|=\s*.checked.)/i,bh=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function $u(m,C){return le(m,"table")&&le(C.nodeType!==11?C:C.firstChild,"tr")&&A(m).children("tbody")[0]||m}function Wu(m){return m.type=(m.getAttribute("type")!==null)+"/"+m.type,m}function _i(m){return(m.type||"").slice(0,5)==="true/"?m.type=m.type.slice(5):m.removeAttribute("type"),m}function Lr(m,C){var _,M,I,G,H,Ee,xe;if(C.nodeType===1){if(an.hasData(m)&&(G=an.get(m),xe=G.events,xe)){an.remove(C,"handle events");for(I in xe)for(_=0,M=xe[I].length;_<M;_++)A.event.add(C,I,xe[I][_])}br.hasData(m)&&(H=br.access(m),Ee=A.extend({},H),br.set(C,Ee))}}function xh(m,C){var _=C.nodeName.toLowerCase();_==="input"&&sa.test(m.type)?C.checked=m.checked:(_==="input"||_==="textarea")&&(C.defaultValue=m.defaultValue)}function qa(m,C,_,M){C=K(C);var I,G,H,Ee,xe,Ve,nt=0,Ft=m.length,Ze=Ft-1,pt=C[0],Rn=j(pt);if(Rn||Ft>1&&typeof pt=="string"&&!se.checkClone&&yh.test(pt))return m.each(function(ur){var Mn=m.eq(ur);Rn&&(C[0]=pt.call(this,ur,Mn.html())),qa(Mn,C,_,M)});if(Ft&&(I=Ka(C,m[0].ownerDocument,!1,m,M),G=I.firstChild,I.childNodes.length===1&&(I=G),G||M)){for(H=A.map(Di(I,"script"),Wu),Ee=H.length;nt<Ft;nt++)xe=I,nt!==Ze&&(xe=A.clone(xe,!0,!0),Ee&&A.merge(H,Di(xe,"script"))),_.call(m[nt],xe,nt);if(Ee)for(Ve=H[H.length-1].ownerDocument,A.map(H,_i),nt=0;nt<Ee;nt++)xe=H[nt],jr.test(xe.type||"")&&!an.access(xe,"globalEval")&&A.contains(Ve,xe)&&(xe.src&&(xe.type||"").toLowerCase()!=="module"?A._evalUrl&&!xe.noModule&&A._evalUrl(xe.src,{nonce:xe.nonce||xe.getAttribute("nonce")},Ve):re(xe.textContent.replace(bh,""),xe,Ve))}return m}function Ch(m,C,_){for(var M,I=C?A.filter(C,m):m,G=0;(M=I[G])!=null;G++)!_&&M.nodeType===1&&A.cleanData(Di(M)),M.parentNode&&(_&&Nr(M)&&Ws(Di(M,"script")),M.parentNode.removeChild(M));return m}A.extend({htmlPrefilter:function(m){return m},clone:function(m,C,_){var M,I,G,H,Ee=m.cloneNode(!0),xe=Nr(m);if(!se.noCloneChecked&&(m.nodeType===1||m.nodeType===11)&&!A.isXMLDoc(m))for(H=Di(Ee),G=Di(m),M=0,I=G.length;M<I;M++)xh(G[M],H[M]);if(C)if(_)for(G=G||Di(m),H=H||Di(Ee),M=0,I=G.length;M<I;M++)Lr(G[M],H[M]);else Lr(m,Ee);return H=Di(Ee,"script"),H.length>0&&Ws(H,!xe&&Di(m,"script")),Ee},cleanData:function(m){for(var C,_,M,I=A.event.special,G=0;(_=m[G])!==void 0;G++)if(Nn(_)){if(C=_[an.expando]){if(C.events)for(M in C.events)I[M]?A.event.remove(_,M):A.removeEvent(_,M,C.handle);_[an.expando]=void 0}_[br.expando]&&(_[br.expando]=void 0)}}}),A.fn.extend({detach:function(m){return Ch(this,m,!0)},remove:function(m){return Ch(this,m)},text:function(m){return at(this,function(C){return C===void 0?A.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=C)})},null,m,arguments.length)},append:function(){return qa(this,arguments,function(m){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var C=$u(this,m);C.appendChild(m)}})},prepend:function(){return qa(this,arguments,function(m){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var C=$u(this,m);C.insertBefore(m,C.firstChild)}})},before:function(){return qa(this,arguments,function(m){this.parentNode&&this.parentNode.insertBefore(m,this)})},after:function(){return qa(this,arguments,function(m){this.parentNode&&this.parentNode.insertBefore(m,this.nextSibling)})},empty:function(){for(var m,C=0;(m=this[C])!=null;C++)m.nodeType===1&&(A.cleanData(Di(m,!1)),m.textContent="");return this},clone:function(m,C){return m=m==null?!1:m,C=C==null?m:C,this.map(function(){return A.clone(this,m,C)})},html:function(m){return at(this,function(C){var _=this[0]||{},M=0,I=this.length;if(C===void 0&&_.nodeType===1)return _.innerHTML;if(typeof C=="string"&&!vh.test(C)&&!zo[(Nc.exec(C)||["",""])[1].toLowerCase()]){C=A.htmlPrefilter(C);try{for(;M<I;M++)_=this[M]||{},_.nodeType===1&&(A.cleanData(Di(_,!1)),_.innerHTML=C);_=0}catch(G){}}_&&this.empty().append(C)},null,m,arguments.length)},replaceWith:function(){var m=[];return qa(this,arguments,function(C){var _=this.parentNode;A.inArray(this,m)<0&&(A.cleanData(Di(this)),_&&_.replaceChild(C,this))},m)}}),A.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(m,C){A.fn[m]=function(_){for(var M,I=[],G=A(_),H=G.length-1,Ee=0;Ee<=H;Ee++)M=Ee===H?this:this.clone(!0),A(G[Ee])[C](M),q.apply(I,M.get());return this.pushStack(I)}});var zl=new RegExp("^("+Ci+")(?!px)[a-z%]+$","i"),Zu=/^--/,Ds=function(m){var C=m.ownerDocument.defaultView;return(!C||!C.opener)&&(C=D),C.getComputedStyle(m)},Xu=function(m,C,_){var M,I,G={};for(I in C)G[I]=m.style[I],m.style[I]=C[I];M=_.call(m);for(I in C)m.style[I]=G[I];return M},Np=new RegExp(Ir.join("|"),"i"),wh="[\\x20\\t\\r\\n\\f]",Rp=new RegExp("^"+wh+"+|((?:^|[^\\\\])(?:\\\\.)*)"+wh+"+$","g");(function(){function m(){if(!!Ve){xe.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",Ve.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ai.appendChild(xe).appendChild(Ve);var nt=D.getComputedStyle(Ve);_=nt.top!=="1%",Ee=C(nt.marginLeft)===12,Ve.style.right="60%",G=C(nt.right)===36,M=C(nt.width)===36,Ve.style.position="absolute",I=C(Ve.offsetWidth/3)===12,ai.removeChild(xe),Ve=null}}function C(nt){return Math.round(parseFloat(nt))}var _,M,I,G,H,Ee,xe=R.createElement("div"),Ve=R.createElement("div");!Ve.style||(Ve.style.backgroundClip="content-box",Ve.cloneNode(!0).style.backgroundClip="",se.clearCloneStyle=Ve.style.backgroundClip==="content-box",A.extend(se,{boxSizingReliable:function(){return m(),M},pixelBoxStyles:function(){return m(),G},pixelPosition:function(){return m(),_},reliableMarginLeft:function(){return m(),Ee},scrollboxSize:function(){return m(),I},reliableTrDimensions:function(){var nt,Ft,Ze,pt;return H==null&&(nt=R.createElement("table"),Ft=R.createElement("tr"),Ze=R.createElement("div"),nt.style.cssText="position:absolute;left:-11111px;border-collapse:separate",Ft.style.cssText="border:1px solid",Ft.style.height="1px",Ze.style.height="9px",Ze.style.display="block",ai.appendChild(nt).appendChild(Ft).appendChild(Ze),pt=D.getComputedStyle(Ft),H=parseInt(pt.height,10)+parseInt(pt.borderTopWidth,10)+parseInt(pt.borderBottomWidth,10)===Ft.offsetHeight,ai.removeChild(nt)),H}}))})();function Ul(m,C,_){var M,I,G,H,Ee=Zu.test(C),xe=m.style;return _=_||Ds(m),_&&(H=_.getPropertyValue(C)||_[C],Ee&&H&&(H=H.replace(Rp,"$1")||void 0),H===""&&!Nr(m)&&(H=A.style(m,C)),!se.pixelBoxStyles()&&zl.test(H)&&Np.test(C)&&(M=xe.width,I=xe.minWidth,G=xe.maxWidth,xe.minWidth=xe.maxWidth=xe.width=H,H=_.width,xe.width=M,xe.minWidth=I,xe.maxWidth=G)),H!==void 0?H+"":H}function Eh(m,C){return{get:function(){if(m()){delete this.get;return}return(this.get=C).apply(this,arguments)}}}var Vl=["Webkit","Moz","ms"],kc=R.createElement("div").style,Sh={};function kp(m){for(var C=m[0].toUpperCase()+m.slice(1),_=Vl.length;_--;)if(m=Vl[_]+C,m in kc)return m}function Yu(m){var C=A.cssProps[m]||Sh[m];return C||(m in kc?m:Sh[m]=kp(m)||m)}var Ip=/^(none|table(?!-c[ea]).+)/,Lp={position:"absolute",visibility:"hidden",display:"block"},_h={letterSpacing:"0",fontWeight:"400"};function Ah(m,C,_){var M=_r.exec(C);return M?Math.max(0,M[2]-(_||0))+(M[3]||"px"):C}function Ku(m,C,_,M,I,G){var H=C==="width"?1:0,Ee=0,xe=0;if(_===(M?"border":"content"))return 0;for(;H<4;H+=2)_==="margin"&&(xe+=A.css(m,_+Ir[H],!0,I)),M?(_==="content"&&(xe-=A.css(m,"padding"+Ir[H],!0,I)),_!=="margin"&&(xe-=A.css(m,"border"+Ir[H]+"Width",!0,I))):(xe+=A.css(m,"padding"+Ir[H],!0,I),_!=="padding"?xe+=A.css(m,"border"+Ir[H]+"Width",!0,I):Ee+=A.css(m,"border"+Ir[H]+"Width",!0,I));return!M&&G>=0&&(xe+=Math.max(0,Math.ceil(m["offset"+C[0].toUpperCase()+C.slice(1)]-G-xe-Ee-.5))||0),xe}function Th(m,C,_){var M=Ds(m),I=!se.boxSizingReliable()||_,G=I&&A.css(m,"boxSizing",!1,M)==="border-box",H=G,Ee=Ul(m,C,M),xe="offset"+C[0].toUpperCase()+C.slice(1);if(zl.test(Ee)){if(!_)return Ee;Ee="auto"}return(!se.boxSizingReliable()&&G||!se.reliableTrDimensions()&&le(m,"tr")||Ee==="auto"||!parseFloat(Ee)&&A.css(m,"display",!1,M)==="inline")&&m.getClientRects().length&&(G=A.css(m,"boxSizing",!1,M)==="border-box",H=xe in m,H&&(Ee=m[xe])),Ee=parseFloat(Ee)||0,Ee+Ku(m,C,_||(G?"border":"content"),H,M,Ee)+"px"}A.extend({cssHooks:{opacity:{get:function(m,C){if(C){var _=Ul(m,"opacity");return _===""?"1":_}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(m,C,_,M){if(!(!m||m.nodeType===3||m.nodeType===8||!m.style)){var I,G,H,Ee=sr(C),xe=Zu.test(C),Ve=m.style;if(xe||(C=Yu(Ee)),H=A.cssHooks[C]||A.cssHooks[Ee],_!==void 0){if(G=typeof _,G==="string"&&(I=_r.exec(_))&&I[1]&&(_=zi(m,C,I),G="number"),_==null||_!==_)return;G==="number"&&!xe&&(_+=I&&I[3]||(A.cssNumber[Ee]?"":"px")),!se.clearCloneStyle&&_===""&&C.indexOf("background")===0&&(Ve[C]="inherit"),(!H||!("set"in H)||(_=H.set(m,_,M))!==void 0)&&(xe?Ve.setProperty(C,_):Ve[C]=_)}else return H&&"get"in H&&(I=H.get(m,!1,M))!==void 0?I:Ve[C]}},css:function(m,C,_,M){var I,G,H,Ee=sr(C),xe=Zu.test(C);return xe||(C=Yu(Ee)),H=A.cssHooks[C]||A.cssHooks[Ee],H&&"get"in H&&(I=H.get(m,!0,_)),I===void 0&&(I=Ul(m,C,M)),I==="normal"&&C in _h&&(I=_h[C]),_===""||_?(G=parseFloat(I),_===!0||isFinite(G)?G||0:I):I}}),A.each(["height","width"],function(m,C){A.cssHooks[C]={get:function(_,M,I){if(M)return Ip.test(A.css(_,"display"))&&(!_.getClientRects().length||!_.getBoundingClientRect().width)?Xu(_,Lp,function(){return Th(_,C,I)}):Th(_,C,I)},set:function(_,M,I){var G,H=Ds(_),Ee=!se.scrollboxSize()&&H.position==="absolute",xe=Ee||I,Ve=xe&&A.css(_,"boxSizing",!1,H)==="border-box",nt=I?Ku(_,C,I,Ve,H):0;return Ve&&Ee&&(nt-=Math.ceil(_["offset"+C[0].toUpperCase()+C.slice(1)]-parseFloat(H[C])-Ku(_,C,"border",!1,H)-.5)),nt&&(G=_r.exec(M))&&(G[3]||"px")!=="px"&&(_.style[C]=M,M=A.css(_,C)),Ah(_,M,nt)}}}),A.cssHooks.marginLeft=Eh(se.reliableMarginLeft,function(m,C){if(C)return(parseFloat(Ul(m,"marginLeft"))||m.getBoundingClientRect().left-Xu(m,{marginLeft:0},function(){return m.getBoundingClientRect().left}))+"px"}),A.each({margin:"",padding:"",border:"Width"},function(m,C){A.cssHooks[m+C]={expand:function(_){for(var M=0,I={},G=typeof _=="string"?_.split(" "):[_];M<4;M++)I[m+Ir[M]+C]=G[M]||G[M-2]||G[0];return I}},m!=="margin"&&(A.cssHooks[m+C].set=Ah)}),A.fn.extend({css:function(m,C){return at(this,function(_,M,I){var G,H,Ee={},xe=0;if(Array.isArray(M)){for(G=Ds(_),H=M.length;xe<H;xe++)Ee[M[xe]]=A.css(_,M[xe],!1,G);return Ee}return I!==void 0?A.style(_,M,I):A.css(_,M)},m,C,arguments.length>1)}});function Mo(m,C,_,M,I){return new Mo.prototype.init(m,C,_,M,I)}A.Tween=Mo,Mo.prototype={constructor:Mo,init:function(m,C,_,M,I,G){this.elem=m,this.prop=_,this.easing=I||A.easing._default,this.options=C,this.start=this.now=this.cur(),this.end=M,this.unit=G||(A.cssNumber[_]?"":"px")},cur:function(){var m=Mo.propHooks[this.prop];return m&&m.get?m.get(this):Mo.propHooks._default.get(this)},run:function(m){var C,_=Mo.propHooks[this.prop];return this.options.duration?this.pos=C=A.easing[this.easing](m,this.options.duration*m,0,1,this.options.duration):this.pos=C=m,this.now=(this.end-this.start)*C+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),_&&_.set?_.set(this):Mo.propHooks._default.set(this),this}},Mo.prototype.init.prototype=Mo.prototype,Mo.propHooks={_default:{get:function(m){var C;return m.elem.nodeType!==1||m.elem[m.prop]!=null&&m.elem.style[m.prop]==null?m.elem[m.prop]:(C=A.css(m.elem,m.prop,""),!C||C==="auto"?0:C)},set:function(m){A.fx.step[m.prop]?A.fx.step[m.prop](m):m.elem.nodeType===1&&(A.cssHooks[m.prop]||m.elem.style[Yu(m.prop)]!=null)?A.style(m.elem,m.prop,m.now+m.unit):m.elem[m.prop]=m.now}}},Mo.propHooks.scrollTop=Mo.propHooks.scrollLeft={set:function(m){m.elem.nodeType&&m.elem.parentNode&&(m.elem[m.prop]=m.now)}},A.easing={linear:function(m){return m},swing:function(m){return .5-Math.cos(m*Math.PI)/2},_default:"swing"},A.fx=Mo.prototype.init,A.fx.step={};var Ja,jl,Gp=/^(?:toggle|show|hide)$/,Qa=/queueHooks$/;function la(){jl&&(R.hidden===!1&&D.requestAnimationFrame?D.requestAnimationFrame(la):D.setTimeout(la,A.fx.interval),A.fx.tick())}function ms(){return D.setTimeout(function(){Ja=void 0}),Ja=Date.now()}function Ic(m,C){var _,M=0,I={height:m};for(C=C?1:0;M<4;M+=2-C)_=Ir[M],I["margin"+_]=I["padding"+_]=m;return C&&(I.opacity=I.width=m),I}function vs(m,C,_){for(var M,I=(qo.tweeners[C]||[]).concat(qo.tweeners["*"]),G=0,H=I.length;G<H;G++)if(M=I[G].call(_,C,m))return M}function qu(m,C,_){var M,I,G,H,Ee,xe,Ve,nt,Ft="width"in C||"height"in C,Ze=this,pt={},Rn=m.style,ur=m.nodeType&&Mi(m),Mn=an.get(m,"fxshow");_.queue||(H=A._queueHooks(m,"fx"),H.unqueued==null&&(H.unqueued=0,Ee=H.empty.fire,H.empty.fire=function(){H.unqueued||Ee()}),H.unqueued++,Ze.always(function(){Ze.always(function(){H.unqueued--,A.queue(m,"fx").length||H.empty.fire()})}));for(M in C)if(I=C[M],Gp.test(I)){if(delete C[M],G=G||I==="toggle",I===(ur?"hide":"show"))if(I==="show"&&Mn&&Mn[M]!==void 0)ur=!0;else continue;pt[M]=Mn&&Mn[M]||A.style(m,M)}if(xe=!A.isEmptyObject(C),!(!xe&&A.isEmptyObject(pt))){Ft&&m.nodeType===1&&(_.overflow=[Rn.overflow,Rn.overflowX,Rn.overflowY],Ve=Mn&&Mn.display,Ve==null&&(Ve=an.get(m,"display")),nt=A.css(m,"display"),nt==="none"&&(Ve?nt=Ve:(Cr([m],!0),Ve=m.style.display||Ve,nt=A.css(m,"display"),Cr([m]))),(nt==="inline"||nt==="inline-block"&&Ve!=null)&&A.css(m,"float")==="none"&&(xe||(Ze.done(function(){Rn.display=Ve}),Ve==null&&(nt=Rn.display,Ve=nt==="none"?"":nt)),Rn.display="inline-block")),_.overflow&&(Rn.overflow="hidden",Ze.always(function(){Rn.overflow=_.overflow[0],Rn.overflowX=_.overflow[1],Rn.overflowY=_.overflow[2]})),xe=!1;for(M in pt)xe||(Mn?"hidden"in Mn&&(ur=Mn.hidden):Mn=an.access(m,"fxshow",{display:Ve}),G&&(Mn.hidden=!ur),ur&&Cr([m],!0),Ze.done(function(){ur||Cr([m]),an.remove(m,"fxshow");for(M in pt)A.style(m,M,pt[M])})),xe=vs(ur?Mn[M]:0,M,Ze),M in Mn||(Mn[M]=xe.start,ur&&(xe.end=xe.start,xe.start=0))}}function Mh(m,C){var _,M,I,G,H;for(_ in m)if(M=sr(_),I=C[M],G=m[_],Array.isArray(G)&&(I=G[1],G=m[_]=G[0]),_!==M&&(m[M]=G,delete m[_]),H=A.cssHooks[M],H&&"expand"in H){G=H.expand(G),delete m[M];for(_ in G)_ in m||(m[_]=G[_],C[_]=I)}else C[M]=I}function qo(m,C,_){var M,I,G=0,H=qo.prefilters.length,Ee=A.Deferred().always(function(){delete xe.elem}),xe=function(){if(I)return!1;for(var Ft=Ja||ms(),Ze=Math.max(0,Ve.startTime+Ve.duration-Ft),pt=Ze/Ve.duration||0,Rn=1-pt,ur=0,Mn=Ve.tweens.length;ur<Mn;ur++)Ve.tweens[ur].run(Rn);return Ee.notifyWith(m,[Ve,Rn,Ze]),Rn<1&&Mn?Ze:(Mn||Ee.notifyWith(m,[Ve,1,0]),Ee.resolveWith(m,[Ve]),!1)},Ve=Ee.promise({elem:m,props:A.extend({},C),opts:A.extend(!0,{specialEasing:{},easing:A.easing._default},_),originalProperties:C,originalOptions:_,startTime:Ja||ms(),duration:_.duration,tweens:[],createTween:function(Ft,Ze){var pt=A.Tween(m,Ve.opts,Ft,Ze,Ve.opts.specialEasing[Ft]||Ve.opts.easing);return Ve.tweens.push(pt),pt},stop:function(Ft){var Ze=0,pt=Ft?Ve.tweens.length:0;if(I)return this;for(I=!0;Ze<pt;Ze++)Ve.tweens[Ze].run(1);return Ft?(Ee.notifyWith(m,[Ve,1,0]),Ee.resolveWith(m,[Ve,Ft])):Ee.rejectWith(m,[Ve,Ft]),this}}),nt=Ve.props;for(Mh(nt,Ve.opts.specialEasing);G<H;G++)if(M=qo.prefilters[G].call(Ve,m,nt,Ve.opts),M)return j(M.stop)&&(A._queueHooks(Ve.elem,Ve.opts.queue).stop=M.stop.bind(M)),M;return A.map(nt,vs,Ve),j(Ve.opts.start)&&Ve.opts.start.call(m,Ve),Ve.progress(Ve.opts.progress).done(Ve.opts.done,Ve.opts.complete).fail(Ve.opts.fail).always(Ve.opts.always),A.fx.timer(A.extend(xe,{elem:m,anim:Ve,queue:Ve.opts.queue})),Ve}A.Animation=A.extend(qo,{tweeners:{"*":[function(m,C){var _=this.createTween(m,C);return zi(_.elem,m,_r.exec(C),_),_}]},tweener:function(m,C){j(m)?(C=m,m=["*"]):m=m.match(et);for(var _,M=0,I=m.length;M<I;M++)_=m[M],qo.tweeners[_]=qo.tweeners[_]||[],qo.tweeners[_].unshift(C)},prefilters:[qu],prefilter:function(m,C){C?qo.prefilters.unshift(m):qo.prefilters.push(m)}}),A.speed=function(m,C,_){var M=m&&typeof m=="object"?A.extend({},m):{complete:_||!_&&C||j(m)&&m,duration:m,easing:_&&C||C&&!j(C)&&C};return A.fx.off?M.duration=0:typeof M.duration!="number"&&(M.duration in A.fx.speeds?M.duration=A.fx.speeds[M.duration]:M.duration=A.fx.speeds._default),(M.queue==null||M.queue===!0)&&(M.queue="fx"),M.old=M.complete,M.complete=function(){j(M.old)&&M.old.call(this),M.queue&&A.dequeue(this,M.queue)},M},A.fn.extend({fadeTo:function(m,C,_,M){return this.filter(Mi).css("opacity",0).show().end().animate({opacity:C},m,_,M)},animate:function(m,C,_,M){var I=A.isEmptyObject(m),G=A.speed(C,_,M),H=function(){var Ee=qo(this,A.extend({},m),G);(I||an.get(this,"finish"))&&Ee.stop(!0)};return H.finish=H,I||G.queue===!1?this.each(H):this.queue(G.queue,H)},stop:function(m,C,_){var M=function(I){var G=I.stop;delete I.stop,G(_)};return typeof m!="string"&&(_=C,C=m,m=void 0),C&&this.queue(m||"fx",[]),this.each(function(){var I=!0,G=m!=null&&m+"queueHooks",H=A.timers,Ee=an.get(this);if(G)Ee[G]&&Ee[G].stop&&M(Ee[G]);else for(G in Ee)Ee[G]&&Ee[G].stop&&Qa.test(G)&&M(Ee[G]);for(G=H.length;G--;)H[G].elem===this&&(m==null||H[G].queue===m)&&(H[G].anim.stop(_),I=!1,H.splice(G,1));(I||!_)&&A.dequeue(this,m)})},finish:function(m){return m!==!1&&(m=m||"fx"),this.each(function(){var C,_=an.get(this),M=_[m+"queue"],I=_[m+"queueHooks"],G=A.timers,H=M?M.length:0;for(_.finish=!0,A.queue(this,m,[]),I&&I.stop&&I.stop.call(this,!0),C=G.length;C--;)G[C].elem===this&&G[C].queue===m&&(G[C].anim.stop(!0),G.splice(C,1));for(C=0;C<H;C++)M[C]&&M[C].finish&&M[C].finish.call(this);delete _.finish})}}),A.each(["toggle","show","hide"],function(m,C){var _=A.fn[C];A.fn[C]=function(M,I,G){return M==null||typeof M=="boolean"?_.apply(this,arguments):this.animate(Ic(C,!0),M,I,G)}}),A.each({slideDown:Ic("show"),slideUp:Ic("hide"),slideToggle:Ic("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(m,C){A.fn[m]=function(_,M,I){return this.animate(C,_,M,I)}}),A.timers=[],A.fx.tick=function(){var m,C=0,_=A.timers;for(Ja=Date.now();C<_.length;C++)m=_[C],!m()&&_[C]===m&&_.splice(C--,1);_.length||A.fx.stop(),Ja=void 0},A.fx.timer=function(m){A.timers.push(m),A.fx.start()},A.fx.interval=13,A.fx.start=function(){jl||(jl=!0,la())},A.fx.stop=function(){jl=null},A.fx.speeds={slow:600,fast:200,_default:400},A.fn.delay=function(m,C){return m=A.fx&&A.fx.speeds[m]||m,C=C||"fx",this.queue(C,function(_,M){var I=D.setTimeout(_,m);M.stop=function(){D.clearTimeout(I)}})},function(){var m=R.createElement("input"),C=R.createElement("select"),_=C.appendChild(R.createElement("option"));m.type="checkbox",se.checkOn=m.value!=="",se.optSelected=_.selected,m=R.createElement("input"),m.value="t",m.type="radio",se.radioValue=m.value==="t"}();var Lc,Hl=A.expr.attrHandle;A.fn.extend({attr:function(m,C){return at(this,A.attr,m,C,arguments.length>1)},removeAttr:function(m){return this.each(function(){A.removeAttr(this,m)})}}),A.extend({attr:function(m,C,_){var M,I,G=m.nodeType;if(!(G===3||G===8||G===2)){if(typeof m.getAttribute=="undefined")return A.prop(m,C,_);if((G!==1||!A.isXMLDoc(m))&&(I=A.attrHooks[C.toLowerCase()]||(A.expr.match.bool.test(C)?Lc:void 0)),_!==void 0){if(_===null){A.removeAttr(m,C);return}return I&&"set"in I&&(M=I.set(m,_,C))!==void 0?M:(m.setAttribute(C,_+""),_)}return I&&"get"in I&&(M=I.get(m,C))!==null?M:(M=A.find.attr(m,C),M==null?void 0:M)}},attrHooks:{type:{set:function(m,C){if(!se.radioValue&&C==="radio"&&le(m,"input")){var _=m.value;return m.setAttribute("type",C),_&&(m.value=_),C}}}},removeAttr:function(m,C){var _,M=0,I=C&&C.match(et);if(I&&m.nodeType===1)for(;_=I[M++];)m.removeAttribute(_)}}),Lc={set:function(m,C,_){return C===!1?A.removeAttr(m,_):m.setAttribute(_,_),_}},A.each(A.expr.match.bool.source.match(/\w+/g),function(m,C){var _=Hl[C]||A.find.attr;Hl[C]=function(M,I,G){var H,Ee,xe=I.toLowerCase();return G||(Ee=Hl[xe],Hl[xe]=H,H=_(M,I,G)!=null?xe:null,Hl[xe]=Ee),H}});var Fp=/^(?:input|select|textarea|button)$/i,Bp=/^(?:a|area)$/i;A.fn.extend({prop:function(m,C){return at(this,A.prop,m,C,arguments.length>1)},removeProp:function(m){return this.each(function(){delete this[A.propFix[m]||m]})}}),A.extend({prop:function(m,C,_){var M,I,G=m.nodeType;if(!(G===3||G===8||G===2))return(G!==1||!A.isXMLDoc(m))&&(C=A.propFix[C]||C,I=A.propHooks[C]),_!==void 0?I&&"set"in I&&(M=I.set(m,_,C))!==void 0?M:m[C]=_:I&&"get"in I&&(M=I.get(m,C))!==null?M:m[C]},propHooks:{tabIndex:{get:function(m){var C=A.find.attr(m,"tabindex");return C?parseInt(C,10):Fp.test(m.nodeName)||Bp.test(m.nodeName)&&m.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),se.optSelected||(A.propHooks.selected={get:function(m){var C=m.parentNode;return C&&C.parentNode&&C.parentNode.selectedIndex,null},set:function(m){var C=m.parentNode;C&&(C.selectedIndex,C.parentNode&&C.parentNode.selectedIndex)}}),A.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){A.propFix[this.toLowerCase()]=this});function go(m){var C=m.match(et)||[];return C.join(" ")}function $i(m){return m.getAttribute&&m.getAttribute("class")||""}function Ma(m){return Array.isArray(m)?m:typeof m=="string"?m.match(et)||[]:[]}A.fn.extend({addClass:function(m){var C,_,M,I,G,H;return j(m)?this.each(function(Ee){A(this).addClass(m.call(this,Ee,$i(this)))}):(C=Ma(m),C.length?this.each(function(){if(M=$i(this),_=this.nodeType===1&&" "+go(M)+" ",_){for(G=0;G<C.length;G++)I=C[G],_.indexOf(" "+I+" ")<0&&(_+=I+" ");H=go(_),M!==H&&this.setAttribute("class",H)}}):this)},removeClass:function(m){var C,_,M,I,G,H;return j(m)?this.each(function(Ee){A(this).removeClass(m.call(this,Ee,$i(this)))}):arguments.length?(C=Ma(m),C.length?this.each(function(){if(M=$i(this),_=this.nodeType===1&&" "+go(M)+" ",_){for(G=0;G<C.length;G++)for(I=C[G];_.indexOf(" "+I+" ")>-1;)_=_.replace(" "+I+" "," ");H=go(_),M!==H&&this.setAttribute("class",H)}}):this):this.attr("class","")},toggleClass:function(m,C){var _,M,I,G,H=typeof m,Ee=H==="string"||Array.isArray(m);return j(m)?this.each(function(xe){A(this).toggleClass(m.call(this,xe,$i(this),C),C)}):typeof C=="boolean"&&Ee?C?this.addClass(m):this.removeClass(m):(_=Ma(m),this.each(function(){if(Ee)for(G=A(this),I=0;I<_.length;I++)M=_[I],G.hasClass(M)?G.removeClass(M):G.addClass(M);else(m===void 0||H==="boolean")&&(M=$i(this),M&&an.set(this,"__className__",M),this.setAttribute&&this.setAttribute("class",M||m===!1?"":an.get(this,"__className__")||""))}))},hasClass:function(m){var C,_,M=0;for(C=" "+m+" ";_=this[M++];)if(_.nodeType===1&&(" "+go($i(_))+" ").indexOf(C)>-1)return!0;return!1}});var zp=/\r/g;A.fn.extend({val:function(m){var C,_,M,I=this[0];return arguments.length?(M=j(m),this.each(function(G){var H;this.nodeType===1&&(M?H=m.call(this,G,A(this).val()):H=m,H==null?H="":typeof H=="number"?H+="":Array.isArray(H)&&(H=A.map(H,function(Ee){return Ee==null?"":Ee+""})),C=A.valHooks[this.type]||A.valHooks[this.nodeName.toLowerCase()],(!C||!("set"in C)||C.set(this,H,"value")===void 0)&&(this.value=H))})):I?(C=A.valHooks[I.type]||A.valHooks[I.nodeName.toLowerCase()],C&&"get"in C&&(_=C.get(I,"value"))!==void 0?_:(_=I.value,typeof _=="string"?_.replace(zp,""):_==null?"":_)):void 0}}),A.extend({valHooks:{option:{get:function(m){var C=A.find.attr(m,"value");return C!=null?C:go(A.text(m))}},select:{get:function(m){var C,_,M,I=m.options,G=m.selectedIndex,H=m.type==="select-one",Ee=H?null:[],xe=H?G+1:I.length;for(G<0?M=xe:M=H?G:0;M<xe;M++)if(_=I[M],(_.selected||M===G)&&!_.disabled&&(!_.parentNode.disabled||!le(_.parentNode,"optgroup"))){if(C=A(_).val(),H)return C;Ee.push(C)}return Ee},set:function(m,C){for(var _,M,I=m.options,G=A.makeArray(C),H=I.length;H--;)M=I[H],(M.selected=A.inArray(A.valHooks.option.get(M),G)>-1)&&(_=!0);return _||(m.selectedIndex=-1),G}}}}),A.each(["radio","checkbox"],function(){A.valHooks[this]={set:function(m,C){if(Array.isArray(C))return m.checked=A.inArray(A(m).val(),C)>-1}},se.checkOn||(A.valHooks[this].get=function(m){return m.getAttribute("value")===null?"on":m.value})}),se.focusin="onfocusin"in D;var Ju=/^(?:focusinfocus|focusoutblur)$/,Qu=function(m){m.stopPropagation()};A.extend(A.event,{trigger:function(m,C,_,M){var I,G,H,Ee,xe,Ve,nt,Ft,Ze=[_||R],pt=W.call(m,"type")?m.type:m,Rn=W.call(m,"namespace")?m.namespace.split("."):[];if(G=Ft=H=_=_||R,!(_.nodeType===3||_.nodeType===8)&&!Ju.test(pt+A.event.triggered)&&(pt.indexOf(".")>-1&&(Rn=pt.split("."),pt=Rn.shift(),Rn.sort()),xe=pt.indexOf(":")<0&&"on"+pt,m=m[A.expando]?m:new A.Event(pt,typeof m=="object"&&m),m.isTrigger=M?2:3,m.namespace=Rn.join("."),m.rnamespace=m.namespace?new RegExp("(^|\\.)"+Rn.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,m.result=void 0,m.target||(m.target=_),C=C==null?[m]:A.makeArray(C,[m]),nt=A.event.special[pt]||{},!(!M&&nt.trigger&&nt.trigger.apply(_,C)===!1))){if(!M&&!nt.noBubble&&!b(_)){for(Ee=nt.delegateType||pt,Ju.test(Ee+pt)||(G=G.parentNode);G;G=G.parentNode)Ze.push(G),H=G;H===(_.ownerDocument||R)&&Ze.push(H.defaultView||H.parentWindow||D)}for(I=0;(G=Ze[I++])&&!m.isPropagationStopped();)Ft=G,m.type=I>1?Ee:nt.bindType||pt,Ve=(an.get(G,"events")||Object.create(null))[m.type]&&an.get(G,"handle"),Ve&&Ve.apply(G,C),Ve=xe&&G[xe],Ve&&Ve.apply&&Nn(G)&&(m.result=Ve.apply(G,C),m.result===!1&&m.preventDefault());return m.type=pt,!M&&!m.isDefaultPrevented()&&(!nt._default||nt._default.apply(Ze.pop(),C)===!1)&&Nn(_)&&xe&&j(_[pt])&&!b(_)&&(H=_[xe],H&&(_[xe]=null),A.event.triggered=pt,m.isPropagationStopped()&&Ft.addEventListener(pt,Qu),_[pt](),m.isPropagationStopped()&&Ft.removeEventListener(pt,Qu),A.event.triggered=void 0,H&&(_[xe]=H)),m.result}},simulate:function(m,C,_){var M=A.extend(new A.Event,_,{type:m,isSimulated:!0});A.event.trigger(M,null,C)}}),A.fn.extend({trigger:function(m,C){return this.each(function(){A.event.trigger(m,C,this)})},triggerHandler:function(m,C){var _=this[0];if(_)return A.event.trigger(m,C,_,!0)}}),se.focusin||A.each({focus:"focusin",blur:"focusout"},function(m,C){var _=function(M){A.event.simulate(C,M.target,A.event.fix(M))};A.event.special[C]={setup:function(){var M=this.ownerDocument||this.document||this,I=an.access(M,C);I||M.addEventListener(m,_,!0),an.access(M,C,(I||0)+1)},teardown:function(){var M=this.ownerDocument||this.document||this,I=an.access(M,C)-1;I?an.access(M,C,I):(M.removeEventListener(m,_,!0),an.remove(M,C))}}});var ca=D.location,Pa={guid:Date.now()},ys=/\?/;A.parseXML=function(m){var C,_;if(!m||typeof m!="string")return null;try{C=new D.DOMParser().parseFromString(m,"text/xml")}catch(M){}return _=C&&C.getElementsByTagName("parsererror")[0],(!C||_)&&A.error("Invalid XML: "+(_?A.map(_.childNodes,function(M){return M.textContent}).join(`
`):m)),C};var Po=/\[\]$/,Ph=/\r?\n/g,Up=/^(?:submit|button|image|reset|file)$/i,Oh=/^(?:input|select|textarea|keygen)/i;function Gc(m,C,_,M){var I;if(Array.isArray(C))A.each(C,function(G,H){_||Po.test(m)?M(m,H):Gc(m+"["+(typeof H=="object"&&H!=null?G:"")+"]",H,_,M)});else if(!_&&ve(C)==="object")for(I in C)Gc(m+"["+I+"]",C[I],_,M);else M(m,C)}A.param=function(m,C){var _,M=[],I=function(G,H){var Ee=j(H)?H():H;M[M.length]=encodeURIComponent(G)+"="+encodeURIComponent(Ee==null?"":Ee)};if(m==null)return"";if(Array.isArray(m)||m.jquery&&!A.isPlainObject(m))A.each(m,function(){I(this.name,this.value)});else for(_ in m)Gc(_,m[_],C,I);return M.join("&")},A.fn.extend({serialize:function(){return A.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var m=A.prop(this,"elements");return m?A.makeArray(m):this}).filter(function(){var m=this.type;return this.name&&!A(this).is(":disabled")&&Oh.test(this.nodeName)&&!Up.test(m)&&(this.checked||!sa.test(m))}).map(function(m,C){var _=A(this).val();return _==null?null:Array.isArray(_)?A.map(_,function(M){return{name:C.name,value:M.replace(Ph,`\r
`)}}):{name:C.name,value:_.replace(Ph,`\r
`)}}).get()}});var Vp=/%20/g,jp=/#.*$/,Hp=/([?&])_=[^&]*/,el=/^(.*?):[ \t]*([^\r\n]*)$/mg,ua=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,$p=/^(?:GET|HEAD)$/,Wp=/^\/\//,tl={},da={},ed="*/".concat("*"),Ns=R.createElement("a");Ns.href=ca.href;function Dh(m){return function(C,_){typeof C!="string"&&(_=C,C="*");var M,I=0,G=C.toLowerCase().match(et)||[];if(j(_))for(;M=G[I++];)M[0]==="+"?(M=M.slice(1)||"*",(m[M]=m[M]||[]).unshift(_)):(m[M]=m[M]||[]).push(_)}}function nl(m,C,_,M){var I={},G=m===da;function H(Ee){var xe;return I[Ee]=!0,A.each(m[Ee]||[],function(Ve,nt){var Ft=nt(C,_,M);if(typeof Ft=="string"&&!G&&!I[Ft])return C.dataTypes.unshift(Ft),H(Ft),!1;if(G)return!(xe=Ft)}),xe}return H(C.dataTypes[0])||!I["*"]&&H("*")}function rl(m,C){var _,M,I=A.ajaxSettings.flatOptions||{};for(_ in C)C[_]!==void 0&&((I[_]?m:M||(M={}))[_]=C[_]);return M&&A.extend(!0,m,M),m}function ha(m,C,_){for(var M,I,G,H,Ee=m.contents,xe=m.dataTypes;xe[0]==="*";)xe.shift(),M===void 0&&(M=m.mimeType||C.getResponseHeader("Content-Type"));if(M){for(I in Ee)if(Ee[I]&&Ee[I].test(M)){xe.unshift(I);break}}if(xe[0]in _)G=xe[0];else{for(I in _){if(!xe[0]||m.converters[I+" "+xe[0]]){G=I;break}H||(H=I)}G=G||H}if(G)return G!==xe[0]&&xe.unshift(G),_[G]}function $l(m,C,_,M){var I,G,H,Ee,xe,Ve={},nt=m.dataTypes.slice();if(nt[1])for(H in m.converters)Ve[H.toLowerCase()]=m.converters[H];for(G=nt.shift();G;)if(m.responseFields[G]&&(_[m.responseFields[G]]=C),!xe&&M&&m.dataFilter&&(C=m.dataFilter(C,m.dataType)),xe=G,G=nt.shift(),G){if(G==="*")G=xe;else if(xe!=="*"&&xe!==G){if(H=Ve[xe+" "+G]||Ve["* "+G],!H){for(I in Ve)if(Ee=I.split(" "),Ee[1]===G&&(H=Ve[xe+" "+Ee[0]]||Ve["* "+Ee[0]],H)){H===!0?H=Ve[I]:Ve[I]!==!0&&(G=Ee[0],nt.unshift(Ee[1]));break}}if(H!==!0)if(H&&m.throws)C=H(C);else try{C=H(C)}catch(Ft){return{state:"parsererror",error:H?Ft:"No conversion from "+xe+" to "+G}}}}return{state:"success",data:C}}A.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ca.href,type:"GET",isLocal:ua.test(ca.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ed,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":A.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(m,C){return C?rl(rl(m,A.ajaxSettings),C):rl(A.ajaxSettings,m)},ajaxPrefilter:Dh(tl),ajaxTransport:Dh(da),ajax:function(m,C){typeof m=="object"&&(C=m,m=void 0),C=C||{};var _,M,I,G,H,Ee,xe,Ve,nt,Ft,Ze=A.ajaxSetup({},C),pt=Ze.context||Ze,Rn=Ze.context&&(pt.nodeType||pt.jquery)?A(pt):A.event,ur=A.Deferred(),Mn=A.Callbacks("once memory"),Wi=Ze.statusCode||{},Ni={},Uo={},Jn="canceled",nr={readyState:0,getResponseHeader:function(gr){var yi;if(xe){if(!G)for(G={};yi=el.exec(I);)G[yi[1].toLowerCase()+" "]=(G[yi[1].toLowerCase()+" "]||[]).concat(yi[2]);yi=G[gr.toLowerCase()+" "]}return yi==null?null:yi.join(", ")},getAllResponseHeaders:function(){return xe?I:null},setRequestHeader:function(gr,yi){return xe==null&&(gr=Uo[gr.toLowerCase()]=Uo[gr.toLowerCase()]||gr,Ni[gr]=yi),this},overrideMimeType:function(gr){return xe==null&&(Ze.mimeType=gr),this},statusCode:function(gr){var yi;if(gr)if(xe)nr.always(gr[nr.status]);else for(yi in gr)Wi[yi]=[Wi[yi],gr[yi]];return this},abort:function(gr){var yi=gr||Jn;return _&&_.abort(yi),Vo(0,yi),this}};if(ur.promise(nr),Ze.url=((m||Ze.url||ca.href)+"").replace(Wp,ca.protocol+"//"),Ze.type=C.method||C.type||Ze.method||Ze.type,Ze.dataTypes=(Ze.dataType||"*").toLowerCase().match(et)||[""],Ze.crossDomain==null){Ee=R.createElement("a");try{Ee.href=Ze.url,Ee.href=Ee.href,Ze.crossDomain=Ns.protocol+"//"+Ns.host!=Ee.protocol+"//"+Ee.host}catch(gr){Ze.crossDomain=!0}}if(Ze.data&&Ze.processData&&typeof Ze.data!="string"&&(Ze.data=A.param(Ze.data,Ze.traditional)),nl(tl,Ze,C,nr),xe)return nr;Ve=A.event&&Ze.global,Ve&&A.active++==0&&A.event.trigger("ajaxStart"),Ze.type=Ze.type.toUpperCase(),Ze.hasContent=!$p.test(Ze.type),M=Ze.url.replace(jp,""),Ze.hasContent?Ze.data&&Ze.processData&&(Ze.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(Ze.data=Ze.data.replace(Vp,"+")):(Ft=Ze.url.slice(M.length),Ze.data&&(Ze.processData||typeof Ze.data=="string")&&(M+=(ys.test(M)?"&":"?")+Ze.data,delete Ze.data),Ze.cache===!1&&(M=M.replace(Hp,"$1"),Ft=(ys.test(M)?"&":"?")+"_="+Pa.guid+++Ft),Ze.url=M+Ft),Ze.ifModified&&(A.lastModified[M]&&nr.setRequestHeader("If-Modified-Since",A.lastModified[M]),A.etag[M]&&nr.setRequestHeader("If-None-Match",A.etag[M])),(Ze.data&&Ze.hasContent&&Ze.contentType!==!1||C.contentType)&&nr.setRequestHeader("Content-Type",Ze.contentType),nr.setRequestHeader("Accept",Ze.dataTypes[0]&&Ze.accepts[Ze.dataTypes[0]]?Ze.accepts[Ze.dataTypes[0]]+(Ze.dataTypes[0]!=="*"?", "+ed+"; q=0.01":""):Ze.accepts["*"]);for(nt in Ze.headers)nr.setRequestHeader(nt,Ze.headers[nt]);if(Ze.beforeSend&&(Ze.beforeSend.call(pt,nr,Ze)===!1||xe))return nr.abort();if(Jn="abort",Mn.add(Ze.complete),nr.done(Ze.success),nr.fail(Ze.error),_=nl(da,Ze,C,nr),!_)Vo(-1,"No Transport");else{if(nr.readyState=1,Ve&&Rn.trigger("ajaxSend",[nr,Ze]),xe)return nr;Ze.async&&Ze.timeout>0&&(H=D.setTimeout(function(){nr.abort("timeout")},Ze.timeout));try{xe=!1,_.send(Ni,Vo)}catch(gr){if(xe)throw gr;Vo(-1,gr)}}function Vo(gr,yi,Rs,ks){var Oo,Is,bs,mo,Zs,jo=yi;xe||(xe=!0,H&&D.clearTimeout(H),_=void 0,I=ks||"",nr.readyState=gr>0?4:0,Oo=gr>=200&&gr<300||gr===304,Rs&&(mo=ha(Ze,nr,Rs)),!Oo&&A.inArray("script",Ze.dataTypes)>-1&&A.inArray("json",Ze.dataTypes)<0&&(Ze.converters["text script"]=function(){}),mo=$l(Ze,mo,nr,Oo),Oo?(Ze.ifModified&&(Zs=nr.getResponseHeader("Last-Modified"),Zs&&(A.lastModified[M]=Zs),Zs=nr.getResponseHeader("etag"),Zs&&(A.etag[M]=Zs)),gr===204||Ze.type==="HEAD"?jo="nocontent":gr===304?jo="notmodified":(jo=mo.state,Is=mo.data,bs=mo.error,Oo=!bs)):(bs=jo,(gr||!jo)&&(jo="error",gr<0&&(gr=0))),nr.status=gr,nr.statusText=(yi||jo)+"",Oo?ur.resolveWith(pt,[Is,jo,nr]):ur.rejectWith(pt,[nr,jo,bs]),nr.statusCode(Wi),Wi=void 0,Ve&&Rn.trigger(Oo?"ajaxSuccess":"ajaxError",[nr,Ze,Oo?Is:bs]),Mn.fireWith(pt,[nr,jo]),Ve&&(Rn.trigger("ajaxComplete",[nr,Ze]),--A.active||A.event.trigger("ajaxStop")))}return nr},getJSON:function(m,C,_){return A.get(m,C,_,"json")},getScript:function(m,C){return A.get(m,void 0,C,"script")}}),A.each(["get","post"],function(m,C){A[C]=function(_,M,I,G){return j(M)&&(G=G||I,I=M,M=void 0),A.ajax(A.extend({url:_,type:C,dataType:G,data:M,success:I},A.isPlainObject(_)&&_))}}),A.ajaxPrefilter(function(m){var C;for(C in m.headers)C.toLowerCase()==="content-type"&&(m.contentType=m.headers[C]||"")}),A._evalUrl=function(m,C,_){return A.ajax({url:m,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(M){A.globalEval(M,C,_)}})},A.fn.extend({wrapAll:function(m){var C;return this[0]&&(j(m)&&(m=m.call(this[0])),C=A(m,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&C.insertBefore(this[0]),C.map(function(){for(var _=this;_.firstElementChild;)_=_.firstElementChild;return _}).append(this)),this},wrapInner:function(m){return j(m)?this.each(function(C){A(this).wrapInner(m.call(this,C))}):this.each(function(){var C=A(this),_=C.contents();_.length?_.wrapAll(m):C.append(m)})},wrap:function(m){var C=j(m);return this.each(function(_){A(this).wrapAll(C?m.call(this,_):m)})},unwrap:function(m){return this.parent(m).not("body").each(function(){A(this).replaceWith(this.childNodes)}),this}}),A.expr.pseudos.hidden=function(m){return!A.expr.pseudos.visible(m)},A.expr.pseudos.visible=function(m){return!!(m.offsetWidth||m.offsetHeight||m.getClientRects().length)},A.ajaxSettings.xhr=function(){try{return new D.XMLHttpRequest}catch(m){}};var Nh={0:200,1223:204},il=A.ajaxSettings.xhr();se.cors=!!il&&"withCredentials"in il,se.ajax=il=!!il,A.ajaxTransport(function(m){var C,_;if(se.cors||il&&!m.crossDomain)return{send:function(M,I){var G,H=m.xhr();if(H.open(m.type,m.url,m.async,m.username,m.password),m.xhrFields)for(G in m.xhrFields)H[G]=m.xhrFields[G];m.mimeType&&H.overrideMimeType&&H.overrideMimeType(m.mimeType),!m.crossDomain&&!M["X-Requested-With"]&&(M["X-Requested-With"]="XMLHttpRequest");for(G in M)H.setRequestHeader(G,M[G]);C=function(Ee){return function(){C&&(C=_=H.onload=H.onerror=H.onabort=H.ontimeout=H.onreadystatechange=null,Ee==="abort"?H.abort():Ee==="error"?typeof H.status!="number"?I(0,"error"):I(H.status,H.statusText):I(Nh[H.status]||H.status,H.statusText,(H.responseType||"text")!=="text"||typeof H.responseText!="string"?{binary:H.response}:{text:H.responseText},H.getAllResponseHeaders()))}},H.onload=C(),_=H.onerror=H.ontimeout=C("error"),H.onabort!==void 0?H.onabort=_:H.onreadystatechange=function(){H.readyState===4&&D.setTimeout(function(){C&&_()})},C=C("abort");try{H.send(m.hasContent&&m.data||null)}catch(Ee){if(C)throw Ee}},abort:function(){C&&C()}}}),A.ajaxPrefilter(function(m){m.crossDomain&&(m.contents.script=!1)}),A.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(m){return A.globalEval(m),m}}}),A.ajaxPrefilter("script",function(m){m.cache===void 0&&(m.cache=!1),m.crossDomain&&(m.type="GET")}),A.ajaxTransport("script",function(m){if(m.crossDomain||m.scriptAttrs){var C,_;return{send:function(M,I){C=A("<script>").attr(m.scriptAttrs||{}).prop({charset:m.scriptCharset,src:m.url}).on("load error",_=function(G){C.remove(),_=null,G&&I(G.type==="error"?404:200,G.type)}),R.head.appendChild(C[0])},abort:function(){_&&_()}}}});var Rh=[],ol=/(=)\?(?=&|$)|\?\?/;A.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var m=Rh.pop()||A.expando+"_"+Pa.guid++;return this[m]=!0,m}}),A.ajaxPrefilter("json jsonp",function(m,C,_){var M,I,G,H=m.jsonp!==!1&&(ol.test(m.url)?"url":typeof m.data=="string"&&(m.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&ol.test(m.data)&&"data");if(H||m.dataTypes[0]==="jsonp")return M=m.jsonpCallback=j(m.jsonpCallback)?m.jsonpCallback():m.jsonpCallback,H?m[H]=m[H].replace(ol,"$1"+M):m.jsonp!==!1&&(m.url+=(ys.test(m.url)?"&":"?")+m.jsonp+"="+M),m.converters["script json"]=function(){return G||A.error(M+" was not called"),G[0]},m.dataTypes[0]="json",I=D[M],D[M]=function(){G=arguments},_.always(function(){I===void 0?A(D).removeProp(M):D[M]=I,m[M]&&(m.jsonpCallback=C.jsonpCallback,Rh.push(M)),G&&j(I)&&I(G[0]),G=I=void 0}),"script"}),se.createHTMLDocument=function(){var m=R.implementation.createHTMLDocument("").body;return m.innerHTML="<form></form><form></form>",m.childNodes.length===2}(),A.parseHTML=function(m,C,_){if(typeof m!="string")return[];typeof C=="boolean"&&(_=C,C=!1);var M,I,G;return C||(se.createHTMLDocument?(C=R.implementation.createHTMLDocument(""),M=C.createElement("base"),M.href=R.location.href,C.head.appendChild(M)):C=R),I=Fn.exec(m),G=!_&&[],I?[C.createElement(I[1])]:(I=Ka([m],C,G),G&&G.length&&A(G).remove(),A.merge([],I.childNodes))},A.fn.load=function(m,C,_){var M,I,G,H=this,Ee=m.indexOf(" ");return Ee>-1&&(M=go(m.slice(Ee)),m=m.slice(0,Ee)),j(C)?(_=C,C=void 0):C&&typeof C=="object"&&(I="POST"),H.length>0&&A.ajax({url:m,type:I||"GET",dataType:"html",data:C}).done(function(xe){G=arguments,H.html(M?A("<div>").append(A.parseHTML(xe)).find(M):xe)}).always(_&&function(xe,Ve){H.each(function(){_.apply(this,G||[xe.responseText,Ve,xe])})}),this},A.expr.pseudos.animated=function(m){return A.grep(A.timers,function(C){return m===C.elem}).length},A.offset={setOffset:function(m,C,_){var M,I,G,H,Ee,xe,Ve,nt=A.css(m,"position"),Ft=A(m),Ze={};nt==="static"&&(m.style.position="relative"),Ee=Ft.offset(),G=A.css(m,"top"),xe=A.css(m,"left"),Ve=(nt==="absolute"||nt==="fixed")&&(G+xe).indexOf("auto")>-1,Ve?(M=Ft.position(),H=M.top,I=M.left):(H=parseFloat(G)||0,I=parseFloat(xe)||0),j(C)&&(C=C.call(m,_,A.extend({},Ee))),C.top!=null&&(Ze.top=C.top-Ee.top+H),C.left!=null&&(Ze.left=C.left-Ee.left+I),"using"in C?C.using.call(m,Ze):Ft.css(Ze)}},A.fn.extend({offset:function(m){if(arguments.length)return m===void 0?this:this.each(function(I){A.offset.setOffset(this,m,I)});var C,_,M=this[0];if(!!M)return M.getClientRects().length?(C=M.getBoundingClientRect(),_=M.ownerDocument.defaultView,{top:C.top+_.pageYOffset,left:C.left+_.pageXOffset}):{top:0,left:0}},position:function(){if(!!this[0]){var m,C,_,M=this[0],I={top:0,left:0};if(A.css(M,"position")==="fixed")C=M.getBoundingClientRect();else{for(C=this.offset(),_=M.ownerDocument,m=M.offsetParent||_.documentElement;m&&(m===_.body||m===_.documentElement)&&A.css(m,"position")==="static";)m=m.parentNode;m&&m!==M&&m.nodeType===1&&(I=A(m).offset(),I.top+=A.css(m,"borderTopWidth",!0),I.left+=A.css(m,"borderLeftWidth",!0))}return{top:C.top-I.top-A.css(M,"marginTop",!0),left:C.left-I.left-A.css(M,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var m=this.offsetParent;m&&A.css(m,"position")==="static";)m=m.offsetParent;return m||ai})}}),A.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(m,C){var _=C==="pageYOffset";A.fn[m]=function(M){return at(this,function(I,G,H){var Ee;if(b(I)?Ee=I:I.nodeType===9&&(Ee=I.defaultView),H===void 0)return Ee?Ee[C]:I[G];Ee?Ee.scrollTo(_?Ee.pageXOffset:H,_?H:Ee.pageYOffset):I[G]=H},m,M,arguments.length)}}),A.each(["top","left"],function(m,C){A.cssHooks[C]=Eh(se.pixelPosition,function(_,M){if(M)return M=Ul(_,C),zl.test(M)?A(_).position()[C]+"px":M})}),A.each({Height:"height",Width:"width"},function(m,C){A.each({padding:"inner"+m,content:C,"":"outer"+m},function(_,M){A.fn[M]=function(I,G){var H=arguments.length&&(_||typeof I!="boolean"),Ee=_||(I===!0||G===!0?"margin":"border");return at(this,function(xe,Ve,nt){var Ft;return b(xe)?M.indexOf("outer")===0?xe["inner"+m]:xe.document.documentElement["client"+m]:xe.nodeType===9?(Ft=xe.documentElement,Math.max(xe.body["scroll"+m],Ft["scroll"+m],xe.body["offset"+m],Ft["offset"+m],Ft["client"+m])):nt===void 0?A.css(xe,Ve,Ee):A.style(xe,Ve,nt,Ee)},C,H?I:void 0,H)}})}),A.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(m,C){A.fn[C]=function(_){return this.on(C,_)}}),A.fn.extend({bind:function(m,C,_){return this.on(m,null,C,_)},unbind:function(m,C){return this.off(m,null,C)},delegate:function(m,C,_,M){return this.on(C,m,_,M)},undelegate:function(m,C,_){return arguments.length===1?this.off(m,"**"):this.off(C,m||"**",_)},hover:function(m,C){return this.mouseenter(m).mouseleave(C||m)}}),A.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(m,C){A.fn[C]=function(_,M){return arguments.length>0?this.on(C,null,_,M):this.trigger(C)}});var Zp=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;A.proxy=function(m,C){var _,M,I;if(typeof C=="string"&&(_=m[C],C=m,m=_),!!j(m))return M=me.call(arguments,2),I=function(){return m.apply(C||this,M.concat(me.call(arguments)))},I.guid=m.guid=m.guid||A.guid++,I},A.holdReady=function(m){m?A.readyWait++:A.ready(!0)},A.isArray=Array.isArray,A.parseJSON=JSON.parse,A.nodeName=le,A.isFunction=j,A.isWindow=b,A.camelCase=sr,A.type=ve,A.now=Date.now,A.isNumeric=function(m){var C=A.type(m);return(C==="number"||C==="string")&&!isNaN(m-parseFloat(m))},A.trim=function(m){return m==null?"":(m+"").replace(Zp,"$1")},w=[],k=function(){return A}.apply(N,w),k!==void 0&&(Se.exports=k);var Xp=D.jQuery,Yp=D.$;return A.noConflict=function(m){return D.$===A&&(D.$=Yp),m&&D.jQuery===A&&(D.jQuery=Xp),A},typeof F=="undefined"&&(D.jQuery=D.$=A),A})},47443:function(Se,N,w){var k=w(42118);function D(F,U){var X=F==null?0:F.length;return!!X&&k(F,U,0)>-1}Se.exports=D},1196:function(Se){function N(w,k,D){for(var F=-1,U=w==null?0:w.length;++F<U;)if(D(k,w[F]))return!0;return!1}Se.exports=N},41848:function(Se){function N(w,k,D,F){for(var U=w.length,X=D+(F?1:-1);F?X--:++X<U;)if(k(w[X],X,w))return X;return-1}Se.exports=N},42118:function(Se,N,w){var k=w(41848),D=w(62722),F=w(42351);function U(X,me,K){return me===me?F(X,me,K):k(X,D,K)}Se.exports=U},62722:function(Se){function N(w){return w!==w}Se.exports=N},40371:function(Se){function N(w){return function(k){return k==null?void 0:k[w]}}Se.exports=N},45652:function(Se,N,w){var k=w(88668),D=w(47443),F=w(1196),U=w(74757),X=w(23593),me=w(21814),K=200;function q(ae,ee,V){var W=-1,ce=D,B=ae.length,se=!0,j=[],b=j;if(V)se=!1,ce=F;else if(B>=K){var R=ee?null:X(ae);if(R)return me(R);se=!1,ce=U,b=new k}else b=ee?[]:j;e:for(;++W<B;){var Me=ae[W],re=ee?ee(Me):Me;if(Me=V||Me!==0?Me:0,se&&re===re){for(var ve=b.length;ve--;)if(b[ve]===re)continue e;ee&&b.push(re),j.push(Me)}else ce(b,re,V)||(b!==j&&b.push(re),j.push(Me))}return j}Se.exports=q},23593:function(Se,N,w){var k=w(58525),D=w(50308),F=w(21814),U=1/0,X=k&&1/F(new k([,-0]))[1]==U?function(me){return new k(me)}:D;Se.exports=X},42351:function(Se){function N(w,k,D){for(var F=D-1,U=w.length;++F<U;)if(w[F]===k)return F;return-1}Se.exports=N},51584:function(Se,N,w){var k=w(44239),D=w(37005),F="[object Boolean]";function U(X){return X===!0||X===!1||D(X)&&k(X)==F}Se.exports=U},50308:function(Se){function N(){}Se.exports=N},45578:function(Se,N,w){var k=w(67206),D=w(45652);function F(U,X){return U&&U.length?D(U,k(X,2)):[]}Se.exports=F},53893:function(Se,N,w){"use strict";w.r(N),w.d(N,{red:function(){return k},pink:function(){return D},purple:function(){return F},deepPurple:function(){return U},indigo:function(){return X},blue:function(){return me},lightBlue:function(){return K},cyan:function(){return q},teal:function(){return ae},green:function(){return ee},lightGreen:function(){return V},lime:function(){return W},yellow:function(){return ce},amber:function(){return B},orange:function(){return se},deepOrange:function(){return j},brown:function(){return b},grey:function(){return R},blueGrey:function(){return Me},darkText:function(){return re},lightText:function(){return ve},darkIcons:function(){return ht},lightIcons:function(){return A},white:function(){return Oe},black:function(){return Ue}});var k={"50":"#ffebee","100":"#ffcdd2","200":"#ef9a9a","300":"#e57373","400":"#ef5350","500":"#f44336","600":"#e53935","700":"#d32f2f","800":"#c62828","900":"#b71c1c",a100:"#ff8a80",a200:"#ff5252",a400:"#ff1744",a700:"#d50000"},D={"50":"#fce4ec","100":"#f8bbd0","200":"#f48fb1","300":"#f06292","400":"#ec407a","500":"#e91e63","600":"#d81b60","700":"#c2185b","800":"#ad1457","900":"#880e4f",a100:"#ff80ab",a200:"#ff4081",a400:"#f50057",a700:"#c51162"},F={"50":"#f3e5f5","100":"#e1bee7","200":"#ce93d8","300":"#ba68c8","400":"#ab47bc","500":"#9c27b0","600":"#8e24aa","700":"#7b1fa2","800":"#6a1b9a","900":"#4a148c",a100:"#ea80fc",a200:"#e040fb",a400:"#d500f9",a700:"#aa00ff"},U={"50":"#ede7f6","100":"#d1c4e9","200":"#b39ddb","300":"#9575cd","400":"#7e57c2","500":"#673ab7","600":"#5e35b1","700":"#512da8","800":"#4527a0","900":"#311b92",a100:"#b388ff",a200:"#7c4dff",a400:"#651fff",a700:"#6200ea"},X={"50":"#e8eaf6","100":"#c5cae9","200":"#9fa8da","300":"#7986cb","400":"#5c6bc0","500":"#3f51b5","600":"#3949ab","700":"#303f9f","800":"#283593","900":"#1a237e",a100:"#8c9eff",a200:"#536dfe",a400:"#3d5afe",a700:"#304ffe"},me={"50":"#e3f2fd","100":"#bbdefb","200":"#90caf9","300":"#64b5f6","400":"#42a5f5","500":"#2196f3","600":"#1e88e5","700":"#1976d2","800":"#1565c0","900":"#0d47a1",a100:"#82b1ff",a200:"#448aff",a400:"#2979ff",a700:"#2962ff"},K={"50":"#e1f5fe","100":"#b3e5fc","200":"#81d4fa","300":"#4fc3f7","400":"#29b6f6","500":"#03a9f4","600":"#039be5","700":"#0288d1","800":"#0277bd","900":"#01579b",a100:"#80d8ff",a200:"#40c4ff",a400:"#00b0ff",a700:"#0091ea"},q={"50":"#e0f7fa","100":"#b2ebf2","200":"#80deea","300":"#4dd0e1","400":"#26c6da","500":"#00bcd4","600":"#00acc1","700":"#0097a7","800":"#00838f","900":"#006064",a100:"#84ffff",a200:"#18ffff",a400:"#00e5ff",a700:"#00b8d4"},ae={"50":"#e0f2f1","100":"#b2dfdb","200":"#80cbc4","300":"#4db6ac","400":"#26a69a","500":"#009688","600":"#00897b","700":"#00796b","800":"#00695c","900":"#004d40",a100:"#a7ffeb",a200:"#64ffda",a400:"#1de9b6",a700:"#00bfa5"},ee={"50":"#e8f5e9","100":"#c8e6c9","200":"#a5d6a7","300":"#81c784","400":"#66bb6a","500":"#4caf50","600":"#43a047","700":"#388e3c","800":"#2e7d32","900":"#1b5e20",a100:"#b9f6ca",a200:"#69f0ae",a400:"#00e676",a700:"#00c853"},V={"50":"#f1f8e9","100":"#dcedc8","200":"#c5e1a5","300":"#aed581","400":"#9ccc65","500":"#8bc34a","600":"#7cb342","700":"#689f38","800":"#558b2f","900":"#33691e",a100:"#ccff90",a200:"#b2ff59",a400:"#76ff03",a700:"#64dd17"},W={"50":"#f9fbe7","100":"#f0f4c3","200":"#e6ee9c","300":"#dce775","400":"#d4e157","500":"#cddc39","600":"#c0ca33","700":"#afb42b","800":"#9e9d24","900":"#827717",a100:"#f4ff81",a200:"#eeff41",a400:"#c6ff00",a700:"#aeea00"},ce={"50":"#fffde7","100":"#fff9c4","200":"#fff59d","300":"#fff176","400":"#ffee58","500":"#ffeb3b","600":"#fdd835","700":"#fbc02d","800":"#f9a825","900":"#f57f17",a100:"#ffff8d",a200:"#ffff00",a400:"#ffea00",a700:"#ffd600"},B={"50":"#fff8e1","100":"#ffecb3","200":"#ffe082","300":"#ffd54f","400":"#ffca28","500":"#ffc107","600":"#ffb300","700":"#ffa000","800":"#ff8f00","900":"#ff6f00",a100:"#ffe57f",a200:"#ffd740",a400:"#ffc400",a700:"#ffab00"},se={"50":"#fff3e0","100":"#ffe0b2","200":"#ffcc80","300":"#ffb74d","400":"#ffa726","500":"#ff9800","600":"#fb8c00","700":"#f57c00","800":"#ef6c00","900":"#e65100",a100:"#ffd180",a200:"#ffab40",a400:"#ff9100",a700:"#ff6d00"},j={"50":"#fbe9e7","100":"#ffccbc","200":"#ffab91","300":"#ff8a65","400":"#ff7043","500":"#ff5722","600":"#f4511e","700":"#e64a19","800":"#d84315","900":"#bf360c",a100:"#ff9e80",a200:"#ff6e40",a400:"#ff3d00",a700:"#dd2c00"},b={"50":"#efebe9","100":"#d7ccc8","200":"#bcaaa4","300":"#a1887f","400":"#8d6e63","500":"#795548","600":"#6d4c41","700":"#5d4037","800":"#4e342e","900":"#3e2723"},R={"50":"#fafafa","100":"#f5f5f5","200":"#eeeeee","300":"#e0e0e0","400":"#bdbdbd","500":"#9e9e9e","600":"#757575","700":"#616161","800":"#424242","900":"#212121"},Me={"50":"#eceff1","100":"#cfd8dc","200":"#b0bec5","300":"#90a4ae","400":"#78909c","500":"#607d8b","600":"#546e7a","700":"#455a64","800":"#37474f","900":"#263238"},re={primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)",disabled:"rgba(0, 0, 0, 0.38)",dividers:"rgba(0, 0, 0, 0.12)"},ve={primary:"rgba(255, 255, 255, 1)",secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",dividers:"rgba(255, 255, 255, 0.12)"},ht={active:"rgba(0, 0, 0, 0.54)",inactive:"rgba(0, 0, 0, 0.38)"},A={active:"rgba(255, 255, 255, 1)",inactive:"rgba(255, 255, 255, 0.5)"},Oe="#ffffff",Ue="#000000";N.default={red:k,pink:D,purple:F,deepPurple:U,indigo:X,blue:me,lightBlue:K,cyan:q,teal:ae,green:ee,lightGreen:V,lime:W,yellow:ce,amber:B,orange:se,deepOrange:j,brown:b,grey:R,blueGrey:Me,darkText:re,lightText:ve,darkIcons:ht,lightIcons:A,white:Oe,black:Ue}},42441:function(Se,N,w){var k;(function(D,F,U){if(!D)return;for(var X={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},me={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},K={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},q={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},ae,ee=1;ee<20;++ee)X[111+ee]="f"+ee;for(ee=0;ee<=9;++ee)X[ee+96]=ee.toString();function V(Oe,Ue,At){if(Oe.addEventListener){Oe.addEventListener(Ue,At,!1);return}Oe.attachEvent("on"+Ue,At)}function W(Oe){if(Oe.type=="keypress"){var Ue=String.fromCharCode(Oe.which);return Oe.shiftKey||(Ue=Ue.toLowerCase()),Ue}return X[Oe.which]?X[Oe.which]:me[Oe.which]?me[Oe.which]:String.fromCharCode(Oe.which).toLowerCase()}function ce(Oe,Ue){return Oe.sort().join(",")===Ue.sort().join(",")}function B(Oe){var Ue=[];return Oe.shiftKey&&Ue.push("shift"),Oe.altKey&&Ue.push("alt"),Oe.ctrlKey&&Ue.push("ctrl"),Oe.metaKey&&Ue.push("meta"),Ue}function se(Oe){if(Oe.preventDefault){Oe.preventDefault();return}Oe.returnValue=!1}function j(Oe){if(Oe.stopPropagation){Oe.stopPropagation();return}Oe.cancelBubble=!0}function b(Oe){return Oe=="shift"||Oe=="ctrl"||Oe=="alt"||Oe=="meta"}function R(){if(!ae){ae={};for(var Oe in X)Oe>95&&Oe<112||X.hasOwnProperty(Oe)&&(ae[X[Oe]]=Oe)}return ae}function Me(Oe,Ue,At){return At||(At=R()[Oe]?"keydown":"keypress"),At=="keypress"&&Ue.length&&(At="keydown"),At}function re(Oe){return Oe==="+"?["+"]:(Oe=Oe.replace(/\+{2}/g,"+plus"),Oe.split("+"))}function ve(Oe,Ue){var At,Xt,On,le=[];for(At=re(Oe),On=0;On<At.length;++On)Xt=At[On],q[Xt]&&(Xt=q[Xt]),Ue&&Ue!="keypress"&&K[Xt]&&(Xt=K[Xt],le.push("shift")),b(Xt)&&le.push(Xt);return Ue=Me(Xt,le,Ue),{key:Xt,modifiers:le,action:Ue}}function ht(Oe,Ue){return Oe===null||Oe===F?!1:Oe===Ue?!0:ht(Oe.parentNode,Ue)}function A(Oe){var Ue=this;if(Oe=Oe||F,!(Ue instanceof A))return new A(Oe);Ue.target=Oe,Ue._callbacks={},Ue._directMap={};var At={},Xt,On=!1,le=!1,Fn=!1;function hr(et){et=et||{};var wt=!1,Qe;for(Qe in At){if(et[Qe]){wt=!0;continue}At[Qe]=0}wt||(Fn=!1)}function qn(et,wt,Qe,ft,ut,$t){var It,on,at=[],Yt=Qe.type;if(!Ue._callbacks[et])return[];for(Yt=="keyup"&&b(et)&&(wt=[et]),It=0;It<Ue._callbacks[et].length;++It)if(on=Ue._callbacks[et][It],!(!ft&&on.seq&&At[on.seq]!=on.level)&&Yt==on.action&&(Yt=="keypress"&&!Qe.metaKey&&!Qe.ctrlKey||ce(wt,on.modifiers))){var Cn=!ft&&on.combo==ut,St=ft&&on.seq==ft&&on.level==$t;(Cn||St)&&Ue._callbacks[et].splice(It,1),at.push(on)}return at}function pr(et,wt,Qe,ft){Ue.stopCallback(wt,wt.target||wt.srcElement,Qe,ft)||et(wt,Qe)===!1&&(se(wt),j(wt))}Ue._handleKey=function(et,wt,Qe){var ft=qn(et,wt,Qe),ut,$t={},It=0,on=!1;for(ut=0;ut<ft.length;++ut)ft[ut].seq&&(It=Math.max(It,ft[ut].level));for(ut=0;ut<ft.length;++ut){if(ft[ut].seq){if(ft[ut].level!=It)continue;on=!0,$t[ft[ut].seq]=1,pr(ft[ut].callback,Qe,ft[ut].combo,ft[ut].seq);continue}on||pr(ft[ut].callback,Qe,ft[ut].combo)}var at=Qe.type=="keypress"&&le;Qe.type==Fn&&!b(et)&&!at&&hr($t),le=on&&Qe.type=="keydown"};function L(et){typeof et.which!="number"&&(et.which=et.keyCode);var wt=W(et);if(!!wt){if(et.type=="keyup"&&On===wt){On=!1;return}Ue.handleKey(wt,B(et),et)}}function he(){clearTimeout(Xt),Xt=setTimeout(hr,1e3)}function lt(et,wt,Qe,ft){At[et]=0;function ut(Yt){return function(){Fn=Yt,++At[et],he()}}function $t(Yt){pr(Qe,Yt,et),ft!=="keyup"&&(On=W(Yt)),setTimeout(hr,10)}for(var It=0;It<wt.length;++It){var on=It+1===wt.length,at=on?$t:ut(ft||ve(wt[It+1]).action);Vt(wt[It],at,ft,et,It)}}function Vt(et,wt,Qe,ft,ut){Ue._directMap[et+":"+Qe]=wt,et=et.replace(/\s+/g," ");var $t=et.split(" "),It;if($t.length>1){lt(et,$t,wt,Qe);return}It=ve(et,Qe),Ue._callbacks[It.key]=Ue._callbacks[It.key]||[],qn(It.key,It.modifiers,{type:It.action},ft,et,ut),Ue._callbacks[It.key][ft?"unshift":"push"]({callback:wt,modifiers:It.modifiers,action:It.action,seq:ft,level:ut,combo:et})}Ue._bindMultiple=function(et,wt,Qe){for(var ft=0;ft<et.length;++ft)Vt(et[ft],wt,Qe)},V(Oe,"keypress",L),V(Oe,"keydown",L),V(Oe,"keyup",L)}A.prototype.bind=function(Oe,Ue,At){var Xt=this;return Oe=Oe instanceof Array?Oe:[Oe],Xt._bindMultiple.call(Xt,Oe,Ue,At),Xt},A.prototype.unbind=function(Oe,Ue){var At=this;return At.bind.call(At,Oe,function(){},Ue)},A.prototype.trigger=function(Oe,Ue){var At=this;return At._directMap[Oe+":"+Ue]&&At._directMap[Oe+":"+Ue]({},Oe),At},A.prototype.reset=function(){var Oe=this;return Oe._callbacks={},Oe._directMap={},Oe},A.prototype.stopCallback=function(Oe,Ue){var At=this;if((" "+Ue.className+" ").indexOf(" mousetrap ")>-1||ht(Ue,At.target))return!1;if("composedPath"in Oe&&typeof Oe.composedPath=="function"){var Xt=Oe.composedPath()[0];Xt!==Oe.target&&(Ue=Xt)}return Ue.tagName=="INPUT"||Ue.tagName=="SELECT"||Ue.tagName=="TEXTAREA"||Ue.isContentEditable},A.prototype.handleKey=function(){var Oe=this;return Oe._handleKey.apply(Oe,arguments)},A.addKeycodes=function(Oe){for(var Ue in Oe)Oe.hasOwnProperty(Ue)&&(X[Ue]=Oe[Ue]);ae=null},A.init=function(){var Oe=A(F);for(var Ue in Oe)Ue.charAt(0)!=="_"&&(A[Ue]=function(At){return function(){return Oe[At].apply(Oe,arguments)}}(Ue))},A.init(),D.Mousetrap=A,Se.exports&&(Se.exports=A),k=function(){return A}.call(N,w,N,Se),k!==U&&(Se.exports=k)})(typeof window!="undefined"?window:null,typeof window!="undefined"?document:null)},40582:function(Se,N,w){var k=w(89550),D=w(68854),F=w(36820),U=w(43650),X=w(56601),me=[0,0];Se.exports.x7=function(q,ae,ee,V,W){return k(q,ee,V),F(q,q),D(ae,-q[1],q[0]),D(me,-ee[1],ee[0]),W/X(ae,me)},Se.exports.mJ=function(q,ae){return D(q,-ae[1],ae[0]),q},Se.exports.o7=function(q,ae,ee){return U(q,ae,ee),F(q,q),q}},9563:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.AlphaPicker=void 0;var k=Object.assign||function(V){for(var W=1;W<arguments.length;W++){var ce=arguments[W];for(var B in ce)Object.prototype.hasOwnProperty.call(ce,B)&&(V[B]=ce[B])}return V},D=w(67294),F=ae(D),U=w(79941),X=ae(U),me=w(1150),K=w(82519),q=ae(K);function ae(V){return V&&V.__esModule?V:{default:V}}var ee=N.AlphaPicker=function(W){var ce=W.rgb,B=W.hsl,se=W.width,j=W.height,b=W.onChange,R=W.direction,Me=W.style,re=W.renderers,ve=W.pointer,ht=W.className,A=ht===void 0?"":ht,Oe=(0,X.default)({default:{picker:{position:"relative",width:se,height:j},alpha:{radius:"2px",style:Me}}});return F.default.createElement("div",{style:Oe.picker,className:"alpha-picker "+A},F.default.createElement(me.Alpha,k({},Oe.alpha,{rgb:ce,hsl:B,pointer:ve,renderers:re,onChange:b,direction:R})))};ee.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:q.default},N.default=(0,me.ColorWrap)(ee)},82519:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.AlphaPointer=void 0;var k=w(67294),D=X(k),F=w(79941),U=X(F);function X(K){return K&&K.__esModule?K:{default:K}}var me=N.AlphaPointer=function(q){var ae=q.direction,ee=(0,U.default)({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:ae==="vertical"});return D.default.createElement("div",{style:ee.picker})};N.default=me},88858:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.Block=void 0;var k=w(67294),D=B(k),F=w(45697),U=B(F),X=w(79941),me=B(X),K=w(82492),q=B(K),ae=w(64809),ee=B(ae),V=w(1150),W=w(53014),ce=B(W);function B(j){return j&&j.__esModule?j:{default:j}}var se=N.Block=function(b){var R=b.onChange,Me=b.onSwatchHover,re=b.hex,ve=b.colors,ht=b.width,A=b.triangle,Oe=b.styles,Ue=Oe===void 0?{}:Oe,At=b.className,Xt=At===void 0?"":At,On=re==="transparent",le=function(qn,pr){ee.default.isValidHex(qn)&&R({hex:qn,source:"hex"},pr)},Fn=(0,me.default)((0,q.default)({default:{card:{width:ht,background:"#fff",boxShadow:"0 1px rgba(0,0,0,.1)",borderRadius:"6px",position:"relative"},head:{height:"110px",background:re,borderRadius:"6px 6px 0 0",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},body:{padding:"10px"},label:{fontSize:"18px",color:ee.default.getContrastingColor(re),position:"relative"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 10px 10px 10px",borderColor:"transparent transparent "+re+" transparent",position:"absolute",top:"-10px",left:"50%",marginLeft:"-10px"},input:{width:"100%",fontSize:"12px",color:"#666",border:"0px",outline:"none",height:"22px",boxShadow:"inset 0 0 0 1px #ddd",borderRadius:"4px",padding:"0 7px",boxSizing:"border-box"}},"hide-triangle":{triangle:{display:"none"}}},Ue),{"hide-triangle":A==="hide"});return D.default.createElement("div",{style:Fn.card,className:"block-picker "+Xt},D.default.createElement("div",{style:Fn.triangle}),D.default.createElement("div",{style:Fn.head},On&&D.default.createElement(V.Checkboard,{borderRadius:"6px 6px 0 0"}),D.default.createElement("div",{style:Fn.label},re)),D.default.createElement("div",{style:Fn.body},D.default.createElement(ce.default,{colors:ve,onClick:le,onSwatchHover:Me}),D.default.createElement(V.EditableInput,{style:{input:Fn.input},value:re,onChange:le})))};se.propTypes={width:U.default.oneOfType([U.default.string,U.default.number]),colors:U.default.arrayOf(U.default.string),triangle:U.default.oneOf(["top","hide"]),styles:U.default.object},se.defaultProps={width:170,colors:["#D9E3F0","#F47373","#697689","#37D67A","#2CCCE4","#555555","#dce775","#ff8a65","#ba68c8"],triangle:"top",styles:{}},N.default=(0,V.ColorWrap)(se)},53014:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.BlockSwatches=void 0;var k=w(67294),D=q(k),F=w(79941),U=q(F),X=w(35161),me=q(X),K=w(1150);function q(ee){return ee&&ee.__esModule?ee:{default:ee}}var ae=N.BlockSwatches=function(V){var W=V.colors,ce=V.onClick,B=V.onSwatchHover,se=(0,U.default)({default:{swatches:{marginRight:"-10px"},swatch:{width:"22px",height:"22px",float:"left",marginRight:"10px",marginBottom:"10px",borderRadius:"4px"},clear:{clear:"both"}}});return D.default.createElement("div",{style:se.swatches},(0,me.default)(W,function(j){return D.default.createElement(K.Swatch,{key:j,color:j,style:se.swatch,onClick:ce,onHover:B,focusStyle:{boxShadow:"0 0 4px "+j}})}),D.default.createElement("div",{style:se.clear}))};N.default=ae},21847:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.Chrome=void 0;var k=w(67294),D=j(k),F=w(45697),U=j(F),X=w(79941),me=j(X),K=w(82492),q=j(K),ae=w(1150),ee=w(32564),V=j(ee),W=w(14066),ce=j(W),B=w(20289),se=j(B);function j(R){return R&&R.__esModule?R:{default:R}}var b=N.Chrome=function(Me){var re=Me.width,ve=Me.onChange,ht=Me.disableAlpha,A=Me.rgb,Oe=Me.hsl,Ue=Me.hsv,At=Me.hex,Xt=Me.renderers,On=Me.styles,le=On===void 0?{}:On,Fn=Me.className,hr=Fn===void 0?"":Fn,qn=(0,me.default)((0,q.default)({default:{picker:{width:re,background:"#fff",borderRadius:"2px",boxShadow:"0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)",boxSizing:"initial",fontFamily:"Menlo"},saturation:{width:"100%",paddingBottom:"55%",position:"relative",borderRadius:"2px 2px 0 0",overflow:"hidden"},Saturation:{radius:"2px 2px 0 0"},body:{padding:"16px 16px 12px"},controls:{display:"flex"},color:{width:"32px"},swatch:{marginTop:"6px",width:"16px",height:"16px",borderRadius:"8px",position:"relative",overflow:"hidden"},active:{absolute:"0px 0px 0px 0px",borderRadius:"8px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.1)",background:"rgba("+A.r+", "+A.g+", "+A.b+", "+A.a+")",zIndex:"2"},toggles:{flex:"1"},hue:{height:"10px",position:"relative",marginBottom:"8px"},Hue:{radius:"2px"},alpha:{height:"10px",position:"relative"},Alpha:{radius:"2px"}},disableAlpha:{color:{width:"22px"},alpha:{display:"none"},hue:{marginBottom:"0px"},swatch:{width:"10px",height:"10px",marginTop:"0px"}}},le),{disableAlpha:ht});return D.default.createElement("div",{style:qn.picker,className:"chrome-picker "+hr},D.default.createElement("div",{style:qn.saturation},D.default.createElement(ae.Saturation,{style:qn.Saturation,hsl:Oe,hsv:Ue,pointer:se.default,onChange:ve})),D.default.createElement("div",{style:qn.body},D.default.createElement("div",{style:qn.controls,className:"flexbox-fix"},D.default.createElement("div",{style:qn.color},D.default.createElement("div",{style:qn.swatch},D.default.createElement("div",{style:qn.active}),D.default.createElement(ae.Checkboard,{renderers:Xt}))),D.default.createElement("div",{style:qn.toggles},D.default.createElement("div",{style:qn.hue},D.default.createElement(ae.Hue,{style:qn.Hue,hsl:Oe,pointer:ce.default,onChange:ve})),D.default.createElement("div",{style:qn.alpha},D.default.createElement(ae.Alpha,{style:qn.Alpha,rgb:A,hsl:Oe,pointer:ce.default,renderers:Xt,onChange:ve})))),D.default.createElement(V.default,{rgb:A,hsl:Oe,hex:At,onChange:ve,disableAlpha:ht})))};b.propTypes={width:U.default.oneOfType([U.default.string,U.default.number]),disableAlpha:U.default.bool,styles:U.default.object},b.defaultProps={width:225,disableAlpha:!1,styles:{}},N.default=(0,ae.ColorWrap)(b)},32564:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.ChromeFields=void 0;var k=function(){function j(b,R){for(var Me=0;Me<R.length;Me++){var re=R[Me];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(b,re.key,re)}}return function(b,R,Me){return R&&j(b.prototype,R),Me&&j(b,Me),b}}(),D=w(67294),F=V(D),U=w(79941),X=V(U),me=w(64809),K=V(me),q=w(1150),ae=w(43891),ee=V(ae);function V(j){return j&&j.__esModule?j:{default:j}}function W(j,b){if(!(j instanceof b))throw new TypeError("Cannot call a class as a function")}function ce(j,b){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:j}function B(j,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);j.prototype=Object.create(b&&b.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(j,b):j.__proto__=b)}var se=N.ChromeFields=function(j){B(b,j);function b(){var R,Me,re,ve;W(this,b);for(var ht=arguments.length,A=Array(ht),Oe=0;Oe<ht;Oe++)A[Oe]=arguments[Oe];return ve=(Me=(re=ce(this,(R=b.__proto__||Object.getPrototypeOf(b)).call.apply(R,[this].concat(A))),re),re.state={view:""},re.toggleViews=function(){re.state.view==="hex"?re.setState({view:"rgb"}):re.state.view==="rgb"?re.setState({view:"hsl"}):re.state.view==="hsl"&&(re.props.hsl.a===1?re.setState({view:"hex"}):re.setState({view:"rgb"}))},re.handleChange=function(Ue,At){Ue.hex?K.default.isValidHex(Ue.hex)&&re.props.onChange({hex:Ue.hex,source:"hex"},At):Ue.r||Ue.g||Ue.b?re.props.onChange({r:Ue.r||re.props.rgb.r,g:Ue.g||re.props.rgb.g,b:Ue.b||re.props.rgb.b,source:"rgb"},At):Ue.a?(Ue.a<0?Ue.a=0:Ue.a>1&&(Ue.a=1),re.props.onChange({h:re.props.hsl.h,s:re.props.hsl.s,l:re.props.hsl.l,a:Math.round(Ue.a*100)/100,source:"rgb"},At)):(Ue.h||Ue.s||Ue.l)&&(typeof Ue.s=="string"&&Ue.s.includes("%")&&(Ue.s=Ue.s.replace("%","")),typeof Ue.l=="string"&&Ue.l.includes("%")&&(Ue.l=Ue.l.replace("%","")),re.props.onChange({h:Ue.h||re.props.hsl.h,s:Number(Ue.s&&Ue.s||re.props.hsl.s),l:Number(Ue.l&&Ue.l||re.props.hsl.l),source:"hsl"},At))},re.showHighlight=function(Ue){Ue.currentTarget.style.background="#eee"},re.hideHighlight=function(Ue){Ue.currentTarget.style.background="transparent"},Me),ce(re,ve)}return k(b,[{key:"componentDidMount",value:function(){this.props.hsl.a===1&&this.state.view!=="hex"?this.setState({view:"hex"}):this.state.view!=="rgb"&&this.state.view!=="hsl"&&this.setState({view:"rgb"})}},{key:"componentWillReceiveProps",value:function(Me){Me.hsl.a!==1&&this.state.view==="hex"&&this.setState({view:"rgb"})}},{key:"render",value:function(){var Me=this,re=(0,X.default)({default:{wrap:{paddingTop:"16px",display:"flex"},fields:{flex:"1",display:"flex",marginLeft:"-6px"},field:{paddingLeft:"6px",width:"100%"},alpha:{paddingLeft:"6px",width:"100%"},toggle:{width:"32px",textAlign:"right",position:"relative"},icon:{marginRight:"-4px",marginTop:"12px",cursor:"pointer",position:"relative"},iconHighlight:{position:"absolute",width:"24px",height:"28px",background:"#eee",borderRadius:"4px",top:"10px",left:"12px",display:"none"},input:{fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px",textAlign:"center"},label:{textTransform:"uppercase",fontSize:"11px",lineHeight:"11px",color:"#969696",textAlign:"center",display:"block",marginTop:"12px"},svg:{fill:"#333",width:"24px",height:"24px",border:"1px transparent solid",borderRadius:"5px"}},disableAlpha:{alpha:{display:"none"}}},this.props,this.state),ve=void 0;return this.state.view==="hex"?ve=F.default.createElement("div",{style:re.fields,className:"flexbox-fix"},F.default.createElement("div",{style:re.field},F.default.createElement(q.EditableInput,{style:{input:re.input,label:re.label},label:"hex",value:this.props.hex,onChange:this.handleChange}))):this.state.view==="rgb"?ve=F.default.createElement("div",{style:re.fields,className:"flexbox-fix"},F.default.createElement("div",{style:re.field},F.default.createElement(q.EditableInput,{style:{input:re.input,label:re.label},label:"r",value:this.props.rgb.r,onChange:this.handleChange})),F.default.createElement("div",{style:re.field},F.default.createElement(q.EditableInput,{style:{input:re.input,label:re.label},label:"g",value:this.props.rgb.g,onChange:this.handleChange})),F.default.createElement("div",{style:re.field},F.default.createElement(q.EditableInput,{style:{input:re.input,label:re.label},label:"b",value:this.props.rgb.b,onChange:this.handleChange})),F.default.createElement("div",{style:re.alpha},F.default.createElement(q.EditableInput,{style:{input:re.input,label:re.label},label:"a",value:this.props.rgb.a,arrowOffset:.01,onChange:this.handleChange}))):this.state.view==="hsl"&&(ve=F.default.createElement("div",{style:re.fields,className:"flexbox-fix"},F.default.createElement("div",{style:re.field},F.default.createElement(q.EditableInput,{style:{input:re.input,label:re.label},label:"h",value:Math.round(this.props.hsl.h),onChange:this.handleChange})),F.default.createElement("div",{style:re.field},F.default.createElement(q.EditableInput,{style:{input:re.input,label:re.label},label:"s",value:Math.round(this.props.hsl.s*100)+"%",onChange:this.handleChange})),F.default.createElement("div",{style:re.field},F.default.createElement(q.EditableInput,{style:{input:re.input,label:re.label},label:"l",value:Math.round(this.props.hsl.l*100)+"%",onChange:this.handleChange})),F.default.createElement("div",{style:re.alpha},F.default.createElement(q.EditableInput,{style:{input:re.input,label:re.label},label:"a",value:this.props.hsl.a,arrowOffset:.01,onChange:this.handleChange})))),F.default.createElement("div",{style:re.wrap,className:"flexbox-fix"},ve,F.default.createElement("div",{style:re.toggle},F.default.createElement("div",{style:re.icon,onClick:this.toggleViews,ref:function(A){return Me.icon=A}},F.default.createElement(ee.default,{style:re.svg,onMouseOver:this.showHighlight,onMouseEnter:this.showHighlight,onMouseOut:this.hideHighlight}))))}}]),b}(F.default.Component);N.default=se},14066:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.ChromePointer=void 0;var k=w(67294),D=X(k),F=w(79941),U=X(F);function X(K){return K&&K.__esModule?K:{default:K}}var me=N.ChromePointer=function(){var q=(0,U.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return D.default.createElement("div",{style:q.picker})};N.default=me},20289:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.ChromePointerCircle=void 0;var k=w(67294),D=X(k),F=w(79941),U=X(F);function X(K){return K&&K.__esModule?K:{default:K}}var me=N.ChromePointerCircle=function(){var q=(0,U.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}}});return D.default.createElement("div",{style:q.picker})};N.default=me},9703:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.Circle=void 0;var k=w(67294),D=b(k),F=w(45697),U=b(F),X=w(79941),me=b(X),K=w(35161),q=b(K),ae=w(82492),ee=b(ae),V=w(53893),W=j(V),ce=w(1150),B=w(26249),se=b(B);function j(Me){if(Me&&Me.__esModule)return Me;var re={};if(Me!=null)for(var ve in Me)Object.prototype.hasOwnProperty.call(Me,ve)&&(re[ve]=Me[ve]);return re.default=Me,re}function b(Me){return Me&&Me.__esModule?Me:{default:Me}}var R=N.Circle=function(re){var ve=re.width,ht=re.onChange,A=re.onSwatchHover,Oe=re.colors,Ue=re.hex,At=re.circleSize,Xt=re.styles,On=Xt===void 0?{}:Xt,le=re.circleSpacing,Fn=re.className,hr=Fn===void 0?"":Fn,qn=(0,me.default)((0,ee.default)({default:{card:{width:ve,display:"flex",flexWrap:"wrap",marginRight:-le,marginBottom:-le}}},On)),pr=function(he,lt){return ht({hex:he,source:"hex"},lt)};return D.default.createElement("div",{style:qn.card,className:"circle-picker "+hr},(0,q.default)(Oe,function(L){return D.default.createElement(se.default,{key:L,color:L,onClick:pr,onSwatchHover:A,active:Ue===L.toLowerCase(),circleSize:At,circleSpacing:le})}))};R.propTypes={width:U.default.oneOfType([U.default.string,U.default.number]),circleSize:U.default.number,circleSpacing:U.default.number,styles:U.default.object},R.defaultProps={width:252,circleSize:28,circleSpacing:14,colors:[W.red["500"],W.pink["500"],W.purple["500"],W.deepPurple["500"],W.indigo["500"],W.blue["500"],W.lightBlue["500"],W.cyan["500"],W.teal["500"],W.green["500"],W.lightGreen["500"],W.lime["500"],W.yellow["500"],W.amber["500"],W.orange["500"],W.deepOrange["500"],W.brown["500"],W.blueGrey["500"]],styles:{}},N.default=(0,ce.ColorWrap)(R)},26249:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.CircleSwatch=void 0;var k=w(67294),D=me(k),F=w(79941),U=me(F),X=w(1150);function me(q){return q&&q.__esModule?q:{default:q}}var K=N.CircleSwatch=function(ae){var ee=ae.color,V=ae.onClick,W=ae.onSwatchHover,ce=ae.hover,B=ae.active,se=ae.circleSize,j=ae.circleSpacing,b=(0,U.default)({default:{swatch:{width:se,height:se,marginRight:j,marginBottom:j,transform:"scale(1)",transition:"100ms transform ease"},Swatch:{borderRadius:"50%",background:"transparent",boxShadow:"inset 0 0 0 "+se/2+"px "+ee,transition:"100ms box-shadow ease"}},hover:{swatch:{transform:"scale(1.2)"}},active:{Swatch:{boxShadow:"inset 0 0 0 3px "+ee}}},{hover:ce,active:B});return D.default.createElement("div",{style:b.swatch},D.default.createElement(X.Swatch,{style:b.Swatch,color:ee,onClick:V,onHover:W,focusStyle:{boxShadow:b.Swatch.boxShadow+", 0 0 5px "+ee}}))};K.defaultProps={circleSize:28,circleSpacing:14},N.default=(0,F.handleHover)(K)},57319:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.Alpha=void 0;var k=Object.assign||function(b){for(var R=1;R<arguments.length;R++){var Me=arguments[R];for(var re in Me)Object.prototype.hasOwnProperty.call(Me,re)&&(b[re]=Me[re])}return b},D=function(){function b(R,Me){for(var re=0;re<Me.length;re++){var ve=Me[re];ve.enumerable=ve.enumerable||!1,ve.configurable=!0,"value"in ve&&(ve.writable=!0),Object.defineProperty(R,ve.key,ve)}}return function(R,Me,re){return Me&&b(R.prototype,Me),re&&b(R,re),R}}(),F=w(67294),U=W(F),X=w(79941),me=W(X),K=w(66713),q=V(K),ae=w(34349),ee=W(ae);function V(b){if(b&&b.__esModule)return b;var R={};if(b!=null)for(var Me in b)Object.prototype.hasOwnProperty.call(b,Me)&&(R[Me]=b[Me]);return R.default=b,R}function W(b){return b&&b.__esModule?b:{default:b}}function ce(b,R){if(!(b instanceof R))throw new TypeError("Cannot call a class as a function")}function B(b,R){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R&&(typeof R=="object"||typeof R=="function")?R:b}function se(b,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof R);b.prototype=Object.create(R&&R.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),R&&(Object.setPrototypeOf?Object.setPrototypeOf(b,R):b.__proto__=R)}var j=N.Alpha=function(b){se(R,b);function R(){var Me,re,ve,ht;ce(this,R);for(var A=arguments.length,Oe=Array(A),Ue=0;Ue<A;Ue++)Oe[Ue]=arguments[Ue];return ht=(re=(ve=B(this,(Me=R.__proto__||Object.getPrototypeOf(R)).call.apply(Me,[this].concat(Oe))),ve),ve.handleChange=function(At){var Xt=q.calculateChange(At,ve.props.hsl,ve.props.direction,ve.props.a,ve.container);Xt&&typeof ve.props.onChange=="function"&&ve.props.onChange(Xt,At)},ve.handleMouseDown=function(At){ve.handleChange(At),window.addEventListener("mousemove",ve.handleChange),window.addEventListener("mouseup",ve.handleMouseUp)},ve.handleMouseUp=function(){ve.unbindEventListeners()},ve.unbindEventListeners=function(){window.removeEventListener("mousemove",ve.handleChange),window.removeEventListener("mouseup",ve.handleMouseUp)},re),B(ve,ht)}return D(R,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var re=this,ve=this.props.rgb,ht=(0,me.default)({default:{alpha:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},checkboard:{absolute:"0px 0px 0px 0px",overflow:"hidden",borderRadius:this.props.radius},gradient:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, rgba("+ve.r+","+ve.g+","+ve.b+`, 0) 0%,
           rgba(`+ve.r+","+ve.g+","+ve.b+", 1) 100%)",boxShadow:this.props.shadow,borderRadius:this.props.radius},container:{position:"relative",height:"100%",margin:"0 3px"},pointer:{position:"absolute",left:ve.a*100+"%"},slider:{width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",marginTop:"1px",transform:"translateX(-2px)"}},vertical:{gradient:{background:"linear-gradient(to bottom, rgba("+ve.r+","+ve.g+","+ve.b+`, 0) 0%,
           rgba(`+ve.r+","+ve.g+","+ve.b+", 1) 100%)"},pointer:{left:0,top:ve.a*100+"%"}},overwrite:k({},this.props.style)},{vertical:this.props.direction==="vertical",overwrite:!0});return U.default.createElement("div",{style:ht.alpha},U.default.createElement("div",{style:ht.checkboard},U.default.createElement(ee.default,{renderers:this.props.renderers})),U.default.createElement("div",{style:ht.gradient}),U.default.createElement("div",{style:ht.container,ref:function(Oe){return re.container=Oe},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},U.default.createElement("div",{style:ht.pointer},this.props.pointer?U.default.createElement(this.props.pointer,this.props):U.default.createElement("div",{style:ht.slider}))))}}]),R}(F.PureComponent||F.Component);N.default=j},34349:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.Checkboard=void 0;var k=w(67294),D=q(k),F=w(79941),U=q(F),X=w(45704),me=K(X);function K(ee){if(ee&&ee.__esModule)return ee;var V={};if(ee!=null)for(var W in ee)Object.prototype.hasOwnProperty.call(ee,W)&&(V[W]=ee[W]);return V.default=ee,V}function q(ee){return ee&&ee.__esModule?ee:{default:ee}}var ae=N.Checkboard=function(V){var W=V.white,ce=V.grey,B=V.size,se=V.renderers,j=V.borderRadius,b=V.boxShadow,R=(0,U.default)({default:{grid:{borderRadius:j,boxShadow:b,absolute:"0px 0px 0px 0px",background:"url("+me.get(W,ce,B,se.canvas)+") center left"}}});return D.default.createElement("div",{style:R.grid})};ae.defaultProps={size:8,white:"transparent",grey:"rgba(0,0,0,.08)",renderers:{}},N.default=ae},88288:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.ColorWrap=void 0;var k=Object.assign||function(B){for(var se=1;se<arguments.length;se++){var j=arguments[se];for(var b in j)Object.prototype.hasOwnProperty.call(j,b)&&(B[b]=j[b])}return B},D=function(){function B(se,j){for(var b=0;b<j.length;b++){var R=j[b];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(se,R.key,R)}}return function(se,j,b){return j&&B(se.prototype,j),b&&B(se,b),se}}(),F=w(67294),U=ae(F),X=w(23279),me=ae(X),K=w(64809),q=ae(K);function ae(B){return B&&B.__esModule?B:{default:B}}function ee(B,se){if(!(B instanceof se))throw new TypeError("Cannot call a class as a function")}function V(B,se){if(!B)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return se&&(typeof se=="object"||typeof se=="function")?se:B}function W(B,se){if(typeof se!="function"&&se!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof se);B.prototype=Object.create(se&&se.prototype,{constructor:{value:B,enumerable:!1,writable:!0,configurable:!0}}),se&&(Object.setPrototypeOf?Object.setPrototypeOf(B,se):B.__proto__=se)}var ce=N.ColorWrap=function(se){var j=function(b){W(R,b);function R(Me){ee(this,R);var re=V(this,(R.__proto__||Object.getPrototypeOf(R)).call(this));return re.handleChange=function(ve,ht){var A=q.default.simpleCheckForValidColor(ve);if(A){var Oe=q.default.toState(ve,ve.h||re.state.oldHue);re.setState(Oe),re.props.onChangeComplete&&re.debounce(re.props.onChangeComplete,Oe,ht),re.props.onChange&&re.props.onChange(Oe,ht)}},re.handleSwatchHover=function(ve,ht){var A=q.default.simpleCheckForValidColor(ve);if(A){var Oe=q.default.toState(ve,ve.h||re.state.oldHue);re.setState(Oe),re.props.onSwatchHover&&re.props.onSwatchHover(Oe,ht)}},re.state=k({},q.default.toState(Me.color,0)),re.debounce=(0,me.default)(function(ve,ht,A){ve(ht,A)},100),re}return D(R,[{key:"componentWillReceiveProps",value:function(re){this.setState(k({},q.default.toState(re.color,this.state.oldHue)))}},{key:"render",value:function(){var re={};return this.props.onSwatchHover&&(re.onSwatchHover=this.handleSwatchHover),U.default.createElement(se,k({},this.props,this.state,{onChange:this.handleChange},re))}}]),R}(F.PureComponent||F.Component);return j.propTypes=k({},se.propTypes),j.defaultProps=k({},se.defaultProps,{color:{h:250,s:.5,l:.2,a:1}}),j};N.default=ce},27747:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.EditableInput=void 0;var k=function(){function re(ve,ht){for(var A=0;A<ht.length;A++){var Oe=ht[A];Oe.enumerable=Oe.enumerable||!1,Oe.configurable=!0,"value"in Oe&&(Oe.writable=!0),Object.defineProperty(ve,Oe.key,Oe)}}return function(ve,ht,A){return ht&&re(ve.prototype,ht),A&&re(ve,A),ve}}(),D=w(67294),F=me(D),U=w(79941),X=me(U);function me(re){return re&&re.__esModule?re:{default:re}}function K(re,ve,ht){return ve in re?Object.defineProperty(re,ve,{value:ht,enumerable:!0,configurable:!0,writable:!0}):re[ve]=ht,re}function q(re,ve){if(!(re instanceof ve))throw new TypeError("Cannot call a class as a function")}function ae(re,ve){if(!re)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ve&&(typeof ve=="object"||typeof ve=="function")?ve:re}function ee(re,ve){if(typeof ve!="function"&&ve!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ve);re.prototype=Object.create(ve&&ve.prototype,{constructor:{value:re,enumerable:!1,writable:!0,configurable:!0}}),ve&&(Object.setPrototypeOf?Object.setPrototypeOf(re,ve):re.__proto__=ve)}var V=1,W=38,ce=40,B=[W,ce],se=function(ve){return B.indexOf(ve)>-1},j=function(ve){return ve+"%"},b=function(ve){return Number(String(ve).replace(/%/g,""))},R=function(ve){return String(ve).indexOf("%")>-1},Me=N.EditableInput=function(re){ee(ve,re);function ve(ht){q(this,ve);var A=ae(this,(ve.__proto__||Object.getPrototypeOf(ve)).call(this));return A.handleBlur=function(){A.state.blurValue&&A.setState({value:A.state.blurValue,blurValue:null})},A.handleChange=function(Oe){A.setUpdatedValue(Oe.target.value,Oe)},A.handleKeyDown=function(Oe){var Ue=b(Oe.target.value);if(!isNaN(Ue)&&se(Oe.keyCode)){var At=A.getArrowOffset(),Xt=Oe.keyCode===W?Ue+At:Ue-At;A.setUpdatedValue(Xt,Oe)}},A.handleDrag=function(Oe){if(A.props.dragLabel){var Ue=Math.round(A.props.value+Oe.movementX);Ue>=0&&Ue<=A.props.dragMax&&A.props.onChange&&A.props.onChange(A.getValueObjectWithLabel(Ue),Oe)}},A.handleMouseDown=function(Oe){A.props.dragLabel&&(Oe.preventDefault(),A.handleDrag(Oe),window.addEventListener("mousemove",A.handleDrag),window.addEventListener("mouseup",A.handleMouseUp))},A.handleMouseUp=function(){A.unbindEventListeners()},A.unbindEventListeners=function(){window.removeEventListener("mousemove",A.handleDrag),window.removeEventListener("mouseup",A.handleMouseUp)},A.state={value:String(ht.value).toUpperCase(),blurValue:String(ht.value).toUpperCase()},A}return k(ve,[{key:"componentWillReceiveProps",value:function(A){var Oe=this.input;A.value!==this.state.value&&(Oe===document.activeElement?this.setState({blurValue:String(A.value).toUpperCase()}):this.setState({value:String(A.value).toUpperCase(),blurValue:!this.state.blurValue&&String(A.value).toUpperCase()}))}},{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"getValueObjectWithLabel",value:function(A){return K({},this.props.label,A)}},{key:"getArrowOffset",value:function(){return this.props.arrowOffset||V}},{key:"setUpdatedValue",value:function(A,Oe){var Ue=this.props.label!==null?this.getValueObjectWithLabel(A):A;this.props.onChange&&this.props.onChange(Ue,Oe);var At=R(Oe.target.value);this.setState({value:At?j(A):A})}},{key:"render",value:function(){var A=this,Oe=(0,X.default)({default:{wrap:{position:"relative"}},"user-override":{wrap:this.props.style&&this.props.style.wrap?this.props.style.wrap:{},input:this.props.style&&this.props.style.input?this.props.style.input:{},label:this.props.style&&this.props.style.label?this.props.style.label:{}},"dragLabel-true":{label:{cursor:"ew-resize"}}},{"user-override":!0},this.props);return F.default.createElement("div",{style:Oe.wrap},F.default.createElement("input",{style:Oe.input,ref:function(At){return A.input=At},value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,onBlur:this.handleBlur,placeholder:this.props.placeholder,spellCheck:"false"}),this.props.label&&!this.props.hideLabel?F.default.createElement("span",{style:Oe.label,onMouseDown:this.handleMouseDown},this.props.label):null)}}]),ve}(D.PureComponent||D.Component);N.default=Me},26358:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.Hue=void 0;var k=function(){function B(se,j){for(var b=0;b<j.length;b++){var R=j[b];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(se,R.key,R)}}return function(se,j,b){return j&&B(se.prototype,j),b&&B(se,b),se}}(),D=w(67294),F=ae(D),U=w(79941),X=ae(U),me=w(33716),K=q(me);function q(B){if(B&&B.__esModule)return B;var se={};if(B!=null)for(var j in B)Object.prototype.hasOwnProperty.call(B,j)&&(se[j]=B[j]);return se.default=B,se}function ae(B){return B&&B.__esModule?B:{default:B}}function ee(B,se){if(!(B instanceof se))throw new TypeError("Cannot call a class as a function")}function V(B,se){if(!B)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return se&&(typeof se=="object"||typeof se=="function")?se:B}function W(B,se){if(typeof se!="function"&&se!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof se);B.prototype=Object.create(se&&se.prototype,{constructor:{value:B,enumerable:!1,writable:!0,configurable:!0}}),se&&(Object.setPrototypeOf?Object.setPrototypeOf(B,se):B.__proto__=se)}var ce=N.Hue=function(B){W(se,B);function se(){var j,b,R,Me;ee(this,se);for(var re=arguments.length,ve=Array(re),ht=0;ht<re;ht++)ve[ht]=arguments[ht];return Me=(b=(R=V(this,(j=se.__proto__||Object.getPrototypeOf(se)).call.apply(j,[this].concat(ve))),R),R.handleChange=function(A){var Oe=K.calculateChange(A,R.props.direction,R.props.hsl,R.container);Oe&&typeof R.props.onChange=="function"&&R.props.onChange(Oe,A)},R.handleMouseDown=function(A){R.handleChange(A),window.addEventListener("mousemove",R.handleChange),window.addEventListener("mouseup",R.handleMouseUp)},R.handleMouseUp=function(){R.unbindEventListeners()},b),V(R,Me)}return k(se,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var b=this,R=this.props.direction,Me=R===void 0?"horizontal":R,re=(0,X.default)({default:{hue:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius,boxShadow:this.props.shadow},container:{padding:"0 2px",position:"relative",height:"100%",borderRadius:this.props.radius},pointer:{position:"absolute",left:this.props.hsl.h*100/360+"%"},slider:{marginTop:"1px",width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",transform:"translateX(-2px)"}},vertical:{pointer:{left:"0px",top:-(this.props.hsl.h*100/360)+100+"%"}}},{vertical:Me==="vertical"});return F.default.createElement("div",{style:re.hue},F.default.createElement("div",{className:"hue-"+Me,style:re.container,ref:function(ht){return b.container=ht},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},F.default.createElement("style",null,`
            .hue-horizontal {
              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0
                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to right, #f00 0%, #ff0
                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }

            .hue-vertical {
              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,
                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,
                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }
          `),F.default.createElement("div",{style:re.pointer},this.props.pointer?F.default.createElement(this.props.pointer,this.props):F.default.createElement("div",{style:re.slider}))))}}]),se}(D.PureComponent||D.Component);N.default=ce},96207:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.Raised=void 0;var k=w(67294),D=ae(k),F=w(45697),U=ae(F),X=w(79941),me=ae(X),K=w(82492),q=ae(K);function ae(V){return V&&V.__esModule?V:{default:V}}var ee=N.Raised=function(W){var ce=W.zDepth,B=W.radius,se=W.background,j=W.children,b=W.styles,R=b===void 0?{}:b,Me=(0,me.default)((0,q.default)({default:{wrap:{position:"relative",display:"inline-block"},content:{position:"relative"},bg:{absolute:"0px 0px 0px 0px",boxShadow:"0 "+ce+"px "+ce*4+"px rgba(0,0,0,.24)",borderRadius:B,background:se}},"zDepth-0":{bg:{boxShadow:"none"}},"zDepth-1":{bg:{boxShadow:"0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)"}},"zDepth-2":{bg:{boxShadow:"0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)"}},"zDepth-3":{bg:{boxShadow:"0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)"}},"zDepth-4":{bg:{boxShadow:"0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)"}},"zDepth-5":{bg:{boxShadow:"0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)"}},square:{bg:{borderRadius:"0"}},circle:{bg:{borderRadius:"50%"}}},R),{"zDepth-1":ce===1});return D.default.createElement("div",{style:Me.wrap},D.default.createElement("div",{style:Me.bg}),D.default.createElement("div",{style:Me.content},j))};ee.propTypes={background:U.default.string,zDepth:U.default.oneOf([0,1,2,3,4,5]),radius:U.default.number,styles:U.default.object},ee.defaultProps={background:"#fff",zDepth:1,radius:2,styles:{}},N.default=ee},76659:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.Saturation=void 0;var k=function(){function j(b,R){for(var Me=0;Me<R.length;Me++){var re=R[Me];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(b,re.key,re)}}return function(b,R,Me){return R&&j(b.prototype,R),Me&&j(b,Me),b}}(),D=w(67294),F=V(D),U=w(79941),X=V(U),me=w(23493),K=V(me),q=w(37599),ae=ee(q);function ee(j){if(j&&j.__esModule)return j;var b={};if(j!=null)for(var R in j)Object.prototype.hasOwnProperty.call(j,R)&&(b[R]=j[R]);return b.default=j,b}function V(j){return j&&j.__esModule?j:{default:j}}function W(j,b){if(!(j instanceof b))throw new TypeError("Cannot call a class as a function")}function ce(j,b){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:j}function B(j,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);j.prototype=Object.create(b&&b.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(j,b):j.__proto__=b)}var se=N.Saturation=function(j){B(b,j);function b(R){W(this,b);var Me=ce(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,R));return Me.handleChange=function(re){typeof Me.props.onChange=="function"&&Me.throttle(Me.props.onChange,ae.calculateChange(re,Me.props.hsl,Me.container),re)},Me.handleMouseDown=function(re){Me.handleChange(re),window.addEventListener("mousemove",Me.handleChange),window.addEventListener("mouseup",Me.handleMouseUp)},Me.handleMouseUp=function(){Me.unbindEventListeners()},Me.throttle=(0,K.default)(function(re,ve,ht){re(ve,ht)},50),Me}return k(b,[{key:"componentWillUnmount",value:function(){this.throttle.cancel(),this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var Me=this,re=this.props.style||{},ve=re.color,ht=re.white,A=re.black,Oe=re.pointer,Ue=re.circle,At=(0,X.default)({default:{color:{absolute:"0px 0px 0px 0px",background:"hsl("+this.props.hsl.h+",100%, 50%)",borderRadius:this.props.radius},white:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},black:{absolute:"0px 0px 0px 0px",boxShadow:this.props.shadow,borderRadius:this.props.radius},pointer:{position:"absolute",top:-(this.props.hsv.v*100)+100+"%",left:this.props.hsv.s*100+"%",cursor:"default"},circle:{width:"4px",height:"4px",boxShadow:`0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),
            0 0 1px 2px rgba(0,0,0,.4)`,borderRadius:"50%",cursor:"hand",transform:"translate(-2px, -2px)"}},custom:{color:ve,white:ht,black:A,pointer:Oe,circle:Ue}},{custom:!!this.props.style});return F.default.createElement("div",{style:At.color,ref:function(On){return Me.container=On},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},F.default.createElement("style",null,`
          .saturation-white {
            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));
            background: linear-gradient(to right, #fff, rgba(255,255,255,0));
          }
          .saturation-black {
            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));
            background: linear-gradient(to top, #000, rgba(0,0,0,0));
          }
        `),F.default.createElement("div",{style:At.white,className:"saturation-white"},F.default.createElement("div",{style:At.black,className:"saturation-black"}),F.default.createElement("div",{style:At.pointer},this.props.pointer?F.default.createElement(this.props.pointer,this.props):F.default.createElement("div",{style:At.circle}))))}}]),b}(D.PureComponent||D.Component);N.default=se},62489:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.Swatch=void 0;var k=Object.assign||function(W){for(var ce=1;ce<arguments.length;ce++){var B=arguments[ce];for(var se in B)Object.prototype.hasOwnProperty.call(B,se)&&(W[se]=B[se])}return W},D=w(67294),F=ae(D),U=w(79941),X=ae(U),me=w(82538),K=w(34349),q=ae(K);function ae(W){return W&&W.__esModule?W:{default:W}}var ee=13,V=N.Swatch=function(ce){var B=ce.color,se=ce.style,j=ce.onClick,b=j===void 0?function(){}:j,R=ce.onHover,Me=ce.title,re=Me===void 0?B:Me,ve=ce.children,ht=ce.focus,A=ce.focusStyle,Oe=A===void 0?{}:A,Ue=B==="transparent",At=(0,X.default)({default:{swatch:k({background:B,height:"100%",width:"100%",cursor:"pointer",position:"relative",outline:"none"},se,ht?Oe:{})}}),Xt=function(qn){return b(B,qn)},On=function(qn){return qn.keyCode===ee&&b(B,qn)},le=function(qn){return R(B,qn)},Fn={};return R&&(Fn.onMouseOver=le),F.default.createElement("div",k({style:At.swatch,onClick:Xt,title:re,tabIndex:0,onKeyDown:On},Fn),ve,Ue&&F.default.createElement(q.default,{borderRadius:At.swatch.borderRadius,boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"}))};N.default=(0,me.handleFocus)(V)},1150:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var k=w(57319);Object.defineProperty(N,"Alpha",{enumerable:!0,get:function(){return ae(k).default}});var D=w(34349);Object.defineProperty(N,"Checkboard",{enumerable:!0,get:function(){return ae(D).default}});var F=w(27747);Object.defineProperty(N,"EditableInput",{enumerable:!0,get:function(){return ae(F).default}});var U=w(26358);Object.defineProperty(N,"Hue",{enumerable:!0,get:function(){return ae(U).default}});var X=w(96207);Object.defineProperty(N,"Raised",{enumerable:!0,get:function(){return ae(X).default}});var me=w(76659);Object.defineProperty(N,"Saturation",{enumerable:!0,get:function(){return ae(me).default}});var K=w(88288);Object.defineProperty(N,"ColorWrap",{enumerable:!0,get:function(){return ae(K).default}});var q=w(62489);Object.defineProperty(N,"Swatch",{enumerable:!0,get:function(){return ae(q).default}});function ae(ee){return ee&&ee.__esModule?ee:{default:ee}}},99766:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.Compact=void 0;var k=w(67294),D=R(k),F=w(45697),U=R(F),X=w(79941),me=R(X),K=w(35161),q=R(K),ae=w(82492),ee=R(ae),V=w(64809),W=R(V),ce=w(1150),B=w(49613),se=R(B),j=w(82018),b=R(j);function R(re){return re&&re.__esModule?re:{default:re}}var Me=N.Compact=function(ve){var ht=ve.onChange,A=ve.onSwatchHover,Oe=ve.colors,Ue=ve.hex,At=ve.rgb,Xt=ve.styles,On=Xt===void 0?{}:Xt,le=ve.className,Fn=le===void 0?"":le,hr=(0,me.default)((0,ee.default)({default:{Compact:{background:"#f6f6f6",radius:"4px"},compact:{paddingTop:"5px",paddingLeft:"5px",boxSizing:"initial",width:"240px"},clear:{clear:"both"}}},On)),qn=function(L,he){L.hex?W.default.isValidHex(L.hex)&&ht({hex:L.hex,source:"hex"},he):ht(L,he)};return D.default.createElement(ce.Raised,{style:hr.Compact,styles:On},D.default.createElement("div",{style:hr.compact,className:"compact-picker "+Fn},D.default.createElement("div",null,(0,q.default)(Oe,function(pr){return D.default.createElement(se.default,{key:pr,color:pr,active:pr.toLowerCase()===Ue,onClick:qn,onSwatchHover:A})}),D.default.createElement("div",{style:hr.clear})),D.default.createElement(b.default,{hex:Ue,rgb:At,onChange:qn})))};Me.propTypes={colors:U.default.arrayOf(U.default.string),styles:U.default.object},Me.defaultProps={colors:["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],styles:{}},N.default=(0,ce.ColorWrap)(Me)},49613:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.CompactColor=void 0;var k=w(67294),D=q(k),F=w(79941),U=q(F),X=w(64809),me=q(X),K=w(1150);function q(ee){return ee&&ee.__esModule?ee:{default:ee}}var ae=N.CompactColor=function(V){var W=V.color,ce=V.onClick,B=ce===void 0?function(){}:ce,se=V.onSwatchHover,j=V.active,b=(0,U.default)({default:{color:{background:W,width:"15px",height:"15px",float:"left",marginRight:"5px",marginBottom:"5px",position:"relative",cursor:"pointer"},dot:{absolute:"5px 5px 5px 5px",background:me.default.getContrastingColor(W),borderRadius:"50%",opacity:"0"}},active:{dot:{opacity:"1"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},dot:{background:"#000"}},transparent:{dot:{background:"#000"}}},{active:j,"color-#FFFFFF":W==="#FFFFFF",transparent:W==="transparent"});return D.default.createElement(K.Swatch,{style:b.color,color:W,onClick:B,onHover:se,focusStyle:{boxShadow:"0 0 4px "+W}},D.default.createElement("div",{style:b.dot}))};N.default=ae},82018:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.CompactFields=void 0;var k=w(67294),D=me(k),F=w(79941),U=me(F),X=w(1150);function me(q){return q&&q.__esModule?q:{default:q}}var K=N.CompactFields=function(ae){var ee=ae.hex,V=ae.rgb,W=ae.onChange,ce=(0,U.default)({default:{fields:{display:"flex",paddingBottom:"6px",paddingRight:"5px",position:"relative"},active:{position:"absolute",top:"6px",left:"5px",height:"9px",width:"9px",background:ee},HEXwrap:{flex:"6",position:"relative"},HEXinput:{width:"80%",padding:"0px",paddingLeft:"20%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},HEXlabel:{display:"none"},RGBwrap:{flex:"3",position:"relative"},RGBinput:{width:"70%",padding:"0px",paddingLeft:"30%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},RGBlabel:{position:"absolute",top:"3px",left:"0px",lineHeight:"16px",textTransform:"uppercase",fontSize:"12px",color:"#999"}}}),B=function(j,b){j.r||j.g||j.b?W({r:j.r||V.r,g:j.g||V.g,b:j.b||V.b,source:"rgb"},b):W({hex:j.hex,source:"hex"},b)};return D.default.createElement("div",{style:ce.fields,className:"flexbox-fix"},D.default.createElement("div",{style:ce.active}),D.default.createElement(X.EditableInput,{style:{wrap:ce.HEXwrap,input:ce.HEXinput,label:ce.HEXlabel},label:"hex",value:ee,onChange:B}),D.default.createElement(X.EditableInput,{style:{wrap:ce.RGBwrap,input:ce.RGBinput,label:ce.RGBlabel},label:"r",value:V.r,onChange:B}),D.default.createElement(X.EditableInput,{style:{wrap:ce.RGBwrap,input:ce.RGBinput,label:ce.RGBlabel},label:"g",value:V.g,onChange:B}),D.default.createElement(X.EditableInput,{style:{wrap:ce.RGBwrap,input:ce.RGBinput,label:ce.RGBlabel},label:"b",value:V.b,onChange:B}))};N.default=K},19700:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.Github=void 0;var k=w(67294),D=B(k),F=w(45697),U=B(F),X=w(79941),me=B(X),K=w(35161),q=B(K),ae=w(82492),ee=B(ae),V=w(1150),W=w(13255),ce=B(W);function B(j){return j&&j.__esModule?j:{default:j}}var se=N.Github=function(b){var R=b.width,Me=b.colors,re=b.onChange,ve=b.onSwatchHover,ht=b.triangle,A=b.styles,Oe=A===void 0?{}:A,Ue=b.className,At=Ue===void 0?"":Ue,Xt=(0,me.default)((0,ee.default)({default:{card:{width:R,background:"#fff",border:"1px solid rgba(0,0,0,0.2)",boxShadow:"0 3px 12px rgba(0,0,0,0.15)",borderRadius:"4px",position:"relative",padding:"5px",display:"flex",flexWrap:"wrap"},triangle:{position:"absolute",border:"7px solid transparent",borderBottomColor:"#fff"},triangleShadow:{position:"absolute",border:"8px solid transparent",borderBottomColor:"rgba(0,0,0,0.15)"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-14px",left:"10px"},triangleShadow:{top:"-16px",left:"9px"}},"top-right-triangle":{triangle:{top:"-14px",right:"10px"},triangleShadow:{top:"-16px",right:"9px"}},"bottom-left-triangle":{triangle:{top:"35px",left:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",left:"9px",transform:"rotate(180deg)"}},"bottom-right-triangle":{triangle:{top:"35px",right:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",right:"9px",transform:"rotate(180deg)"}}},Oe),{"hide-triangle":ht==="hide","top-left-triangle":ht==="top-left","top-right-triangle":ht==="top-right","bottom-left-triangle":ht==="bottom-left","bottom-right-triangle":ht==="bottom-right"}),On=function(Fn,hr){return re({hex:Fn,source:"hex"},hr)};return D.default.createElement("div",{style:Xt.card,className:"github-picker "+At},D.default.createElement("div",{style:Xt.triangleShadow}),D.default.createElement("div",{style:Xt.triangle}),(0,q.default)(Me,function(le){return D.default.createElement(ce.default,{color:le,key:le,onClick:On,onSwatchHover:ve})}))};se.propTypes={width:U.default.oneOfType([U.default.string,U.default.number]),colors:U.default.arrayOf(U.default.string),triangle:U.default.oneOf(["hide","top-left","top-right","bottom-left","bottom-right"]),styles:U.default.object},se.defaultProps={width:200,colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],triangle:"top-left",styles:{}},N.default=(0,V.ColorWrap)(se)},13255:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.GithubSwatch=void 0;var k=w(67294),D=me(k),F=w(79941),U=me(F),X=w(1150);function me(q){return q&&q.__esModule?q:{default:q}}var K=N.GithubSwatch=function(ae){var ee=ae.hover,V=ae.color,W=ae.onClick,ce=ae.onSwatchHover,B={position:"relative",zIndex:"2",outline:"2px solid #fff",boxShadow:"0 0 5px 2px rgba(0,0,0,0.25)"},se=(0,U.default)({default:{swatch:{width:"25px",height:"25px",fontSize:"0"}},hover:{swatch:B}},{hover:ee});return D.default.createElement("div",{style:se.swatch},D.default.createElement(X.Swatch,{color:V,onClick:W,onHover:ce,focusStyle:B}))};N.default=(0,F.handleHover)(K)},10565:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.HuePicker=void 0;var k=Object.assign||function(se){for(var j=1;j<arguments.length;j++){var b=arguments[j];for(var R in b)Object.prototype.hasOwnProperty.call(b,R)&&(se[R]=b[R])}return se},D=w(67294),F=ce(D),U=w(45697),X=ce(U),me=w(79941),K=ce(me),q=w(82492),ae=ce(q),ee=w(1150),V=w(88878),W=ce(V);function ce(se){return se&&se.__esModule?se:{default:se}}var B=N.HuePicker=function(j){var b=j.width,R=j.height,Me=j.onChange,re=j.hsl,ve=j.direction,ht=j.pointer,A=j.styles,Oe=A===void 0?{}:A,Ue=j.className,At=Ue===void 0?"":Ue,Xt=(0,K.default)((0,ae.default)({default:{picker:{position:"relative",width:b,height:R},hue:{radius:"2px"}}},Oe)),On=function(Fn){return Me({a:1,h:Fn.h,l:.5,s:1})};return F.default.createElement("div",{style:Xt.picker,className:"hue-picker "+At},F.default.createElement(ee.Hue,k({},Xt.hue,{hsl:re,pointer:ht,onChange:On,direction:ve})))};B.propTypes={styles:X.default.object},B.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:W.default,styles:{}},N.default=(0,ee.ColorWrap)(B)},88878:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.SliderPointer=void 0;var k=w(67294),D=X(k),F=w(79941),U=X(F);function X(K){return K&&K.__esModule?K:{default:K}}var me=N.SliderPointer=function(q){var ae=q.direction,ee=(0,U.default)({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:ae==="vertical"});return D.default.createElement("div",{style:ee.picker})};N.default=me},66142:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.Material=void 0;var k=w(67294),D=ee(k),F=w(79941),U=ee(F),X=w(82492),me=ee(X),K=w(64809),q=ee(K),ae=w(1150);function ee(W){return W&&W.__esModule?W:{default:W}}var V=N.Material=function(ce){var B=ce.onChange,se=ce.hex,j=ce.rgb,b=ce.styles,R=b===void 0?{}:b,Me=ce.className,re=Me===void 0?"":Me,ve=(0,U.default)((0,me.default)({default:{material:{width:"98px",height:"98px",padding:"16px",fontFamily:"Roboto"},HEXwrap:{position:"relative"},HEXinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"2px solid "+se,outline:"none",height:"30px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},Hex:{style:{}},RGBwrap:{position:"relative"},RGBinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"1px solid #eee",outline:"none",height:"30px"},RGBlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},split:{display:"flex",marginRight:"-10px",paddingTop:"11px"},third:{flex:"1",paddingRight:"10px"}}},R)),ht=function(Oe,Ue){Oe.hex?q.default.isValidHex(Oe.hex)&&B({hex:Oe.hex,source:"hex"},Ue):(Oe.r||Oe.g||Oe.b)&&B({r:Oe.r||j.r,g:Oe.g||j.g,b:Oe.b||j.b,source:"rgb"},Ue)};return D.default.createElement(ae.Raised,{styles:R},D.default.createElement("div",{style:ve.material,className:"material-picker "+re},D.default.createElement(ae.EditableInput,{style:{wrap:ve.HEXwrap,input:ve.HEXinput,label:ve.HEXlabel},label:"hex",value:se,onChange:ht}),D.default.createElement("div",{style:ve.split,className:"flexbox-fix"},D.default.createElement("div",{style:ve.third},D.default.createElement(ae.EditableInput,{style:{wrap:ve.RGBwrap,input:ve.RGBinput,label:ve.RGBlabel},label:"r",value:j.r,onChange:ht})),D.default.createElement("div",{style:ve.third},D.default.createElement(ae.EditableInput,{style:{wrap:ve.RGBwrap,input:ve.RGBinput,label:ve.RGBlabel},label:"g",value:j.g,onChange:ht})),D.default.createElement("div",{style:ve.third},D.default.createElement(ae.EditableInput,{style:{wrap:ve.RGBwrap,input:ve.RGBinput,label:ve.RGBlabel},label:"b",value:j.b,onChange:ht})))))};N.default=(0,ae.ColorWrap)(V)},33165:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.Photoshop=void 0;var k=function(){function At(Xt,On){for(var le=0;le<On.length;le++){var Fn=On[le];Fn.enumerable=Fn.enumerable||!1,Fn.configurable=!0,"value"in Fn&&(Fn.writable=!0),Object.defineProperty(Xt,Fn.key,Fn)}}return function(Xt,On,le){return On&&At(Xt.prototype,On),le&&At(Xt,le),Xt}}(),D=w(67294),F=ve(D),U=w(45697),X=ve(U),me=w(79941),K=ve(me),q=w(82492),ae=ve(q),ee=w(1150),V=w(21962),W=ve(V),ce=w(31804),B=ve(ce),se=w(40670),j=ve(se),b=w(10170),R=ve(b),Me=w(29628),re=ve(Me);function ve(At){return At&&At.__esModule?At:{default:At}}function ht(At,Xt){if(!(At instanceof Xt))throw new TypeError("Cannot call a class as a function")}function A(At,Xt){if(!At)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xt&&(typeof Xt=="object"||typeof Xt=="function")?Xt:At}function Oe(At,Xt){if(typeof Xt!="function"&&Xt!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Xt);At.prototype=Object.create(Xt&&Xt.prototype,{constructor:{value:At,enumerable:!1,writable:!0,configurable:!0}}),Xt&&(Object.setPrototypeOf?Object.setPrototypeOf(At,Xt):At.__proto__=Xt)}var Ue=N.Photoshop=function(At){Oe(Xt,At);function Xt(On){ht(this,Xt);var le=A(this,(Xt.__proto__||Object.getPrototypeOf(Xt)).call(this));return le.state={currentColor:On.hex},le}return k(Xt,[{key:"render",value:function(){var le=this.props,Fn=le.styles,hr=Fn===void 0?{}:Fn,qn=le.className,pr=qn===void 0?"":qn,L=(0,K.default)((0,ae.default)({default:{picker:{background:"#DCDCDC",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)",boxSizing:"initial",width:"513px"},head:{backgroundImage:"linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)",borderBottom:"1px solid #B1B1B1",boxShadow:"inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)",height:"23px",lineHeight:"24px",borderRadius:"4px 4px 0 0",fontSize:"13px",color:"#4D4D4D",textAlign:"center"},body:{padding:"15px 15px 0",display:"flex"},saturation:{width:"256px",height:"256px",position:"relative",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0",overflow:"hidden"},hue:{position:"relative",height:"256px",width:"19px",marginLeft:"10px",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0"},controls:{width:"180px",marginLeft:"10px"},top:{display:"flex"},previews:{width:"60px"},actions:{flex:"1",marginLeft:"20px"}}},hr));return F.default.createElement("div",{style:L.picker,className:"photoshop-picker "+pr},F.default.createElement("div",{style:L.head},this.props.header),F.default.createElement("div",{style:L.body,className:"flexbox-fix"},F.default.createElement("div",{style:L.saturation},F.default.createElement(ee.Saturation,{hsl:this.props.hsl,hsv:this.props.hsv,pointer:B.default,onChange:this.props.onChange})),F.default.createElement("div",{style:L.hue},F.default.createElement(ee.Hue,{direction:"vertical",hsl:this.props.hsl,pointer:j.default,onChange:this.props.onChange})),F.default.createElement("div",{style:L.controls},F.default.createElement("div",{style:L.top,className:"flexbox-fix"},F.default.createElement("div",{style:L.previews},F.default.createElement(re.default,{rgb:this.props.rgb,currentColor:this.state.currentColor})),F.default.createElement("div",{style:L.actions},F.default.createElement(R.default,{label:"OK",onClick:this.props.onAccept,active:!0}),F.default.createElement(R.default,{label:"Cancel",onClick:this.props.onCancel}),F.default.createElement(W.default,{onChange:this.props.onChange,rgb:this.props.rgb,hsv:this.props.hsv,hex:this.props.hex}))))))}}]),Xt}(F.default.Component);Ue.propTypes={header:X.default.string,styles:X.default.object},Ue.defaultProps={header:"Color Picker",styles:{}},N.default=(0,ee.ColorWrap)(Ue)},10170:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.PhotoshopButton=void 0;var k=w(67294),D=X(k),F=w(79941),U=X(F);function X(K){return K&&K.__esModule?K:{default:K}}var me=N.PhotoshopButton=function(q){var ae=q.onClick,ee=q.label,V=q.children,W=q.active,ce=(0,U.default)({default:{button:{backgroundImage:"linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)",border:"1px solid #878787",borderRadius:"2px",height:"20px",boxShadow:"0 1px 0 0 #EAEAEA",fontSize:"14px",color:"#000",lineHeight:"20px",textAlign:"center",marginBottom:"10px",cursor:"pointer"}},active:{button:{boxShadow:"0 0 0 1px #878787"}}},{active:W});return D.default.createElement("div",{style:ce.button,onClick:ae},ee||V)};N.default=me},21962:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.PhotoshopPicker=void 0;var k=w(67294),D=q(k),F=w(79941),U=q(F),X=w(64809),me=q(X),K=w(1150);function q(ee){return ee&&ee.__esModule?ee:{default:ee}}var ae=N.PhotoshopPicker=function(V){var W=V.onChange,ce=V.rgb,B=V.hsv,se=V.hex,j=(0,U.default)({default:{fields:{paddingTop:"5px",paddingBottom:"9px",width:"80px",position:"relative"},divider:{height:"5px"},RGBwrap:{position:"relative"},RGBinput:{marginLeft:"40%",width:"40%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"5px",fontSize:"13px",paddingLeft:"3px",marginRight:"10px"},RGBlabel:{left:"0px",width:"34px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px",position:"absolute"},HEXwrap:{position:"relative"},HEXinput:{marginLeft:"20%",width:"80%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"6px",fontSize:"13px",paddingLeft:"3px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",width:"14px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px"},fieldSymbols:{position:"absolute",top:"5px",right:"-7px",fontSize:"13px"},symbol:{height:"20px",lineHeight:"22px",paddingBottom:"7px"}}}),b=function(Me,re){Me["#"]?me.default.isValidHex(Me["#"])&&W({hex:Me["#"],source:"hex"},re):Me.r||Me.g||Me.b?W({r:Me.r||ce.r,g:Me.g||ce.g,b:Me.b||ce.b,source:"rgb"},re):(Me.h||Me.s||Me.v)&&W({h:Me.h||B.h,s:Me.s||B.s,v:Me.v||B.v,source:"hsv"},re)};return D.default.createElement("div",{style:j.fields},D.default.createElement(K.EditableInput,{style:{wrap:j.RGBwrap,input:j.RGBinput,label:j.RGBlabel},label:"h",value:Math.round(B.h),onChange:b}),D.default.createElement(K.EditableInput,{style:{wrap:j.RGBwrap,input:j.RGBinput,label:j.RGBlabel},label:"s",value:Math.round(B.s*100),onChange:b}),D.default.createElement(K.EditableInput,{style:{wrap:j.RGBwrap,input:j.RGBinput,label:j.RGBlabel},label:"v",value:Math.round(B.v*100),onChange:b}),D.default.createElement("div",{style:j.divider}),D.default.createElement(K.EditableInput,{style:{wrap:j.RGBwrap,input:j.RGBinput,label:j.RGBlabel},label:"r",value:ce.r,onChange:b}),D.default.createElement(K.EditableInput,{style:{wrap:j.RGBwrap,input:j.RGBinput,label:j.RGBlabel},label:"g",value:ce.g,onChange:b}),D.default.createElement(K.EditableInput,{style:{wrap:j.RGBwrap,input:j.RGBinput,label:j.RGBlabel},label:"b",value:ce.b,onChange:b}),D.default.createElement("div",{style:j.divider}),D.default.createElement(K.EditableInput,{style:{wrap:j.HEXwrap,input:j.HEXinput,label:j.HEXlabel},label:"#",value:se.replace("#",""),onChange:b}),D.default.createElement("div",{style:j.fieldSymbols},D.default.createElement("div",{style:j.symbol},"\xB0"),D.default.createElement("div",{style:j.symbol},"%"),D.default.createElement("div",{style:j.symbol},"%")))};N.default=ae},40670:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.PhotoshopPointerCircle=void 0;var k=w(67294),D=X(k),F=w(79941),U=X(F);function X(K){return K&&K.__esModule?K:{default:K}}var me=N.PhotoshopPointerCircle=function(){var q=(0,U.default)({default:{triangle:{width:0,height:0,borderStyle:"solid",borderWidth:"4px 0 4px 6px",borderColor:"transparent transparent transparent #fff",position:"absolute",top:"1px",left:"1px"},triangleBorder:{width:0,height:0,borderStyle:"solid",borderWidth:"5px 0 5px 8px",borderColor:"transparent transparent transparent #555"},left:{Extend:"triangleBorder",transform:"translate(-13px, -4px)"},leftInside:{Extend:"triangle",transform:"translate(-8px, -5px)"},right:{Extend:"triangleBorder",transform:"translate(20px, -14px) rotate(180deg)"},rightInside:{Extend:"triangle",transform:"translate(-8px, -5px)"}}});return D.default.createElement("div",{style:q.pointer},D.default.createElement("div",{style:q.left},D.default.createElement("div",{style:q.leftInside})),D.default.createElement("div",{style:q.right},D.default.createElement("div",{style:q.rightInside})))};N.default=me},31804:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.PhotoshopPointerCircle=void 0;var k=w(67294),D=X(k),F=w(79941),U=X(F);function X(K){return K&&K.__esModule?K:{default:K}}var me=N.PhotoshopPointerCircle=function(q){var ae=q.hsl,ee=(0,U.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}},"black-outline":{picker:{boxShadow:"inset 0 0 0 1px #000"}}},{"black-outline":ae.l>.5});return D.default.createElement("div",{style:ee.picker})};N.default=me},29628:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.PhotoshopPreviews=void 0;var k=w(67294),D=X(k),F=w(79941),U=X(F);function X(K){return K&&K.__esModule?K:{default:K}}var me=N.PhotoshopPreviews=function(q){var ae=q.rgb,ee=q.currentColor,V=(0,U.default)({default:{swatches:{border:"1px solid #B3B3B3",borderBottom:"1px solid #F0F0F0",marginBottom:"2px",marginTop:"1px"},new:{height:"34px",background:"rgb("+ae.r+","+ae.g+", "+ae.b+")",boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000"},current:{height:"34px",background:ee,boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000"},label:{fontSize:"14px",color:"#000",textAlign:"center"}}});return D.default.createElement("div",null,D.default.createElement("div",{style:V.label},"new"),D.default.createElement("div",{style:V.swatches},D.default.createElement("div",{style:V.new}),D.default.createElement("div",{style:V.current})),D.default.createElement("div",{style:V.label},"current"))};N.default=me},89753:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.Sketch=void 0;var k=Object.assign||function(b){for(var R=1;R<arguments.length;R++){var Me=arguments[R];for(var re in Me)Object.prototype.hasOwnProperty.call(Me,re)&&(b[re]=Me[re])}return b},D=w(67294),F=se(D),U=w(45697),X=se(U),me=w(79941),K=se(me),q=w(82492),ae=se(q),ee=w(1150),V=w(24530),W=se(V),ce=w(13067),B=se(ce);function se(b){return b&&b.__esModule?b:{default:b}}var j=N.Sketch=function(R){var Me=R.width,re=R.rgb,ve=R.hex,ht=R.hsv,A=R.hsl,Oe=R.onChange,Ue=R.onSwatchHover,At=R.disableAlpha,Xt=R.presetColors,On=R.renderers,le=R.styles,Fn=le===void 0?{}:le,hr=R.className,qn=hr===void 0?"":hr,pr=(0,K.default)((0,ae.default)({default:k({picker:{width:Me,padding:"10px 10px 0",boxSizing:"initial",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)"},saturation:{width:"100%",paddingBottom:"75%",position:"relative",overflow:"hidden"},Saturation:{radius:"3px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},controls:{display:"flex"},sliders:{padding:"4px 0",flex:"1"},color:{width:"24px",height:"24px",position:"relative",marginTop:"4px",marginLeft:"4px",borderRadius:"3px"},activeColor:{absolute:"0px 0px 0px 0px",borderRadius:"2px",background:"rgba("+re.r+","+re.g+","+re.b+","+re.a+")",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},hue:{position:"relative",height:"10px",overflow:"hidden"},Hue:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},alpha:{position:"relative",height:"10px",marginTop:"4px",overflow:"hidden"},Alpha:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"}},Fn),disableAlpha:{color:{height:"10px"},hue:{height:"10px"},alpha:{display:"none"}}},Fn),{disableAlpha:At});return F.default.createElement("div",{style:pr.picker,className:"sketch-picker "+qn},F.default.createElement("div",{style:pr.saturation},F.default.createElement(ee.Saturation,{style:pr.Saturation,hsl:A,hsv:ht,onChange:Oe})),F.default.createElement("div",{style:pr.controls,className:"flexbox-fix"},F.default.createElement("div",{style:pr.sliders},F.default.createElement("div",{style:pr.hue},F.default.createElement(ee.Hue,{style:pr.Hue,hsl:A,onChange:Oe})),F.default.createElement("div",{style:pr.alpha},F.default.createElement(ee.Alpha,{style:pr.Alpha,rgb:re,hsl:A,renderers:On,onChange:Oe}))),F.default.createElement("div",{style:pr.color},F.default.createElement(ee.Checkboard,null),F.default.createElement("div",{style:pr.activeColor}))),F.default.createElement(W.default,{rgb:re,hsl:A,hex:ve,onChange:Oe,disableAlpha:At}),F.default.createElement(B.default,{colors:Xt,onClick:Oe,onSwatchHover:Ue}))};j.propTypes={disableAlpha:X.default.bool,width:X.default.oneOfType([X.default.string,X.default.number]),styles:X.default.object},j.defaultProps={disableAlpha:!1,width:200,styles:{},presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"]},N.default=(0,ee.ColorWrap)(j)},24530:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.SketchFields=void 0;var k=w(67294),D=q(k),F=w(79941),U=q(F),X=w(64809),me=q(X),K=w(1150);function q(ee){return ee&&ee.__esModule?ee:{default:ee}}var ae=N.SketchFields=function(V){var W=V.onChange,ce=V.rgb,B=V.hsl,se=V.hex,j=V.disableAlpha,b=(0,U.default)({default:{fields:{display:"flex",paddingTop:"4px"},single:{flex:"1",paddingLeft:"6px"},alpha:{flex:"1",paddingLeft:"6px"},double:{flex:"2"},input:{width:"80%",padding:"4px 10% 3px",border:"none",boxShadow:"inset 0 0 0 1px #ccc",fontSize:"11px"},label:{display:"block",textAlign:"center",fontSize:"11px",color:"#222",paddingTop:"3px",paddingBottom:"4px",textTransform:"capitalize"}},disableAlpha:{alpha:{display:"none"}}},{disableAlpha:j}),R=function(re,ve){re.hex?me.default.isValidHex(re.hex)&&W({hex:re.hex,source:"hex"},ve):re.r||re.g||re.b?W({r:re.r||ce.r,g:re.g||ce.g,b:re.b||ce.b,a:ce.a,source:"rgb"},ve):re.a&&(re.a<0?re.a=0:re.a>100&&(re.a=100),re.a/=100,W({h:B.h,s:B.s,l:B.l,a:re.a,source:"rgb"},ve))};return D.default.createElement("div",{style:b.fields,className:"flexbox-fix"},D.default.createElement("div",{style:b.double},D.default.createElement(K.EditableInput,{style:{input:b.input,label:b.label},label:"hex",value:se.replace("#",""),onChange:R})),D.default.createElement("div",{style:b.single},D.default.createElement(K.EditableInput,{style:{input:b.input,label:b.label},label:"r",value:ce.r,onChange:R,dragLabel:"true",dragMax:"255"})),D.default.createElement("div",{style:b.single},D.default.createElement(K.EditableInput,{style:{input:b.input,label:b.label},label:"g",value:ce.g,onChange:R,dragLabel:"true",dragMax:"255"})),D.default.createElement("div",{style:b.single},D.default.createElement(K.EditableInput,{style:{input:b.input,label:b.label},label:"b",value:ce.b,onChange:R,dragLabel:"true",dragMax:"255"})),D.default.createElement("div",{style:b.alpha},D.default.createElement(K.EditableInput,{style:{input:b.input,label:b.label},label:"a",value:Math.round(ce.a*100),onChange:R,dragLabel:"true",dragMax:"100"})))};N.default=ae},13067:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.SketchPresetColors=void 0;var k=Object.assign||function(V){for(var W=1;W<arguments.length;W++){var ce=arguments[W];for(var B in ce)Object.prototype.hasOwnProperty.call(ce,B)&&(V[B]=ce[B])}return V},D=w(67294),F=ae(D),U=w(45697),X=ae(U),me=w(79941),K=ae(me),q=w(1150);function ae(V){return V&&V.__esModule?V:{default:V}}var ee=N.SketchPresetColors=function(W){var ce=W.colors,B=W.onClick,se=B===void 0?function(){}:B,j=W.onSwatchHover,b=(0,K.default)({default:{colors:{margin:"0 -10px",padding:"10px 0 0 10px",borderTop:"1px solid #eee",display:"flex",flexWrap:"wrap",position:"relative"},swatchWrap:{width:"16px",height:"16px",margin:"0 10px 10px 0"},swatch:{borderRadius:"3px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15)"}},"no-presets":{colors:{display:"none"}}},{"no-presets":!ce||!ce.length}),R=function(re,ve){se({hex:re,source:"hex"},ve)};return F.default.createElement("div",{style:b.colors,className:"flexbox-fix"},ce.map(function(Me){var re=typeof Me=="string"?{color:Me}:Me,ve=""+re.color+(re.title||"");return F.default.createElement("div",{key:ve,style:b.swatchWrap},F.default.createElement(q.Swatch,k({},re,{style:b.swatch,onClick:R,onHover:j,focusStyle:{boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px "+re.color}})))}))};ee.propTypes={colors:X.default.arrayOf(X.default.oneOfType([X.default.string,X.default.shape({color:X.default.string,title:X.default.string})])).isRequired},N.default=ee},49857:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.Slider=void 0;var k=w(67294),D=B(k),F=w(45697),U=B(F),X=w(79941),me=B(X),K=w(82492),q=B(K),ae=w(1150),ee=w(6457),V=B(ee),W=w(77792),ce=B(W);function B(j){return j&&j.__esModule?j:{default:j}}var se=N.Slider=function(b){var R=b.hsl,Me=b.onChange,re=b.pointer,ve=b.styles,ht=ve===void 0?{}:ve,A=b.className,Oe=A===void 0?"":A,Ue=(0,me.default)((0,q.default)({default:{hue:{height:"12px",position:"relative"},Hue:{radius:"2px"}}},ht));return D.default.createElement("div",{style:Ue.wrap||{},className:"slider-picker "+Oe},D.default.createElement("div",{style:Ue.hue},D.default.createElement(ae.Hue,{style:Ue.Hue,hsl:R,pointer:re,onChange:Me})),D.default.createElement("div",{style:Ue.swatches},D.default.createElement(V.default,{hsl:R,onClick:Me})))};se.propTypes={styles:U.default.object},se.defaultProps={pointer:ce.default,styles:{}},N.default=(0,ae.ColorWrap)(se)},77792:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.SliderPointer=void 0;var k=w(67294),D=X(k),F=w(79941),U=X(F);function X(K){return K&&K.__esModule?K:{default:K}}var me=N.SliderPointer=function(){var q=(0,U.default)({default:{picker:{width:"14px",height:"14px",borderRadius:"6px",transform:"translate(-7px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return D.default.createElement("div",{style:q.picker})};N.default=me},64377:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.SliderSwatch=void 0;var k=w(67294),D=X(k),F=w(79941),U=X(F);function X(K){return K&&K.__esModule?K:{default:K}}var me=N.SliderSwatch=function(q){var ae=q.hsl,ee=q.offset,V=q.onClick,W=V===void 0?function(){}:V,ce=q.active,B=q.first,se=q.last,j=(0,U.default)({default:{swatch:{height:"12px",background:"hsl("+ae.h+", 50%, "+ee*100+"%)",cursor:"pointer"}},first:{swatch:{borderRadius:"2px 0 0 2px"}},last:{swatch:{borderRadius:"0 2px 2px 0"}},active:{swatch:{transform:"scaleY(1.8)",borderRadius:"3.6px/2px"}}},{active:ce,first:B,last:se}),b=function(Me){return W({h:ae.h,s:.5,l:ee,source:"hsl"},Me)};return D.default.createElement("div",{style:j.swatch,onClick:b})};N.default=me},6457:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.SliderSwatches=void 0;var k=w(67294),D=K(k),F=w(79941),U=K(F),X=w(64377),me=K(X);function K(ae){return ae&&ae.__esModule?ae:{default:ae}}var q=N.SliderSwatches=function(ee){var V=ee.onClick,W=ee.hsl,ce=(0,U.default)({default:{swatches:{marginTop:"20px"},swatch:{boxSizing:"border-box",width:"20%",paddingRight:"1px",float:"left"},clear:{clear:"both"}}}),B=.1;return D.default.createElement("div",{style:ce.swatches},D.default.createElement("div",{style:ce.swatch},D.default.createElement(me.default,{hsl:W,offset:".80",active:Math.abs(W.l-.8)<B&&Math.abs(W.s-.5)<B,onClick:V,first:!0})),D.default.createElement("div",{style:ce.swatch},D.default.createElement(me.default,{hsl:W,offset:".65",active:Math.abs(W.l-.65)<B&&Math.abs(W.s-.5)<B,onClick:V})),D.default.createElement("div",{style:ce.swatch},D.default.createElement(me.default,{hsl:W,offset:".50",active:Math.abs(W.l-.5)<B&&Math.abs(W.s-.5)<B,onClick:V})),D.default.createElement("div",{style:ce.swatch},D.default.createElement(me.default,{hsl:W,offset:".35",active:Math.abs(W.l-.35)<B&&Math.abs(W.s-.5)<B,onClick:V})),D.default.createElement("div",{style:ce.swatch},D.default.createElement(me.default,{hsl:W,offset:".20",active:Math.abs(W.l-.2)<B&&Math.abs(W.s-.5)<B,onClick:V,last:!0})),D.default.createElement("div",{style:ce.clear}))};N.default=q},93926:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.Swatches=void 0;var k=w(67294),D=Me(k),F=w(45697),U=Me(F),X=w(79941),me=Me(X),K=w(35161),q=Me(K),ae=w(82492),ee=Me(ae),V=w(64809),W=Me(V),ce=w(53893),B=R(ce),se=w(1150),j=w(23088),b=Me(j);function R(ve){if(ve&&ve.__esModule)return ve;var ht={};if(ve!=null)for(var A in ve)Object.prototype.hasOwnProperty.call(ve,A)&&(ht[A]=ve[A]);return ht.default=ve,ht}function Me(ve){return ve&&ve.__esModule?ve:{default:ve}}var re=N.Swatches=function(ht){var A=ht.width,Oe=ht.height,Ue=ht.onChange,At=ht.onSwatchHover,Xt=ht.colors,On=ht.hex,le=ht.styles,Fn=le===void 0?{}:le,hr=ht.className,qn=hr===void 0?"":hr,pr=(0,me.default)((0,ee.default)({default:{picker:{width:A,height:Oe},overflow:{height:Oe,overflowY:"scroll"},body:{padding:"16px 0 6px 16px"},clear:{clear:"both"}}},Fn)),L=function(lt,Vt){W.default.isValidHex(lt)&&Ue({hex:lt,source:"hex"},Vt)};return D.default.createElement("div",{style:pr.picker,className:"swatches-picker "+qn},D.default.createElement(se.Raised,null,D.default.createElement("div",{style:pr.overflow},D.default.createElement("div",{style:pr.body},(0,q.default)(Xt,function(he){return D.default.createElement(b.default,{key:he.toString(),group:he,active:On,onClick:L,onSwatchHover:At})}),D.default.createElement("div",{style:pr.clear})))))};re.propTypes={width:U.default.oneOfType([U.default.string,U.default.number]),height:U.default.oneOfType([U.default.string,U.default.number]),colors:U.default.arrayOf(U.default.arrayOf(U.default.string)),styles:U.default.object},re.defaultProps={width:320,height:240,colors:[[B.red["900"],B.red["700"],B.red["500"],B.red["300"],B.red["100"]],[B.pink["900"],B.pink["700"],B.pink["500"],B.pink["300"],B.pink["100"]],[B.purple["900"],B.purple["700"],B.purple["500"],B.purple["300"],B.purple["100"]],[B.deepPurple["900"],B.deepPurple["700"],B.deepPurple["500"],B.deepPurple["300"],B.deepPurple["100"]],[B.indigo["900"],B.indigo["700"],B.indigo["500"],B.indigo["300"],B.indigo["100"]],[B.blue["900"],B.blue["700"],B.blue["500"],B.blue["300"],B.blue["100"]],[B.lightBlue["900"],B.lightBlue["700"],B.lightBlue["500"],B.lightBlue["300"],B.lightBlue["100"]],[B.cyan["900"],B.cyan["700"],B.cyan["500"],B.cyan["300"],B.cyan["100"]],[B.teal["900"],B.teal["700"],B.teal["500"],B.teal["300"],B.teal["100"]],["#194D33",B.green["700"],B.green["500"],B.green["300"],B.green["100"]],[B.lightGreen["900"],B.lightGreen["700"],B.lightGreen["500"],B.lightGreen["300"],B.lightGreen["100"]],[B.lime["900"],B.lime["700"],B.lime["500"],B.lime["300"],B.lime["100"]],[B.yellow["900"],B.yellow["700"],B.yellow["500"],B.yellow["300"],B.yellow["100"]],[B.amber["900"],B.amber["700"],B.amber["500"],B.amber["300"],B.amber["100"]],[B.orange["900"],B.orange["700"],B.orange["500"],B.orange["300"],B.orange["100"]],[B.deepOrange["900"],B.deepOrange["700"],B.deepOrange["500"],B.deepOrange["300"],B.deepOrange["100"]],[B.brown["900"],B.brown["700"],B.brown["500"],B.brown["300"],B.brown["100"]],[B.blueGrey["900"],B.blueGrey["700"],B.blueGrey["500"],B.blueGrey["300"],B.blueGrey["100"]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]],styles:{}},N.default=(0,se.ColorWrap)(re)},85638:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.SwatchesColor=void 0;var k=w(67294),D=ee(k),F=w(79941),U=ee(F),X=w(64809),me=ee(X),K=w(1150),q=w(70597),ae=ee(q);function ee(W){return W&&W.__esModule?W:{default:W}}var V=N.SwatchesColor=function(ce){var B=ce.color,se=ce.onClick,j=se===void 0?function(){}:se,b=ce.onSwatchHover,R=ce.first,Me=ce.last,re=ce.active,ve=(0,U.default)({default:{color:{width:"40px",height:"24px",cursor:"pointer",background:B,marginBottom:"1px"},check:{color:me.default.getContrastingColor(B),marginLeft:"8px",display:"none"}},first:{color:{overflow:"hidden",borderRadius:"2px 2px 0 0"}},last:{color:{overflow:"hidden",borderRadius:"0 0 2px 2px"}},active:{check:{display:"block"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},check:{color:"#333"}},transparent:{check:{color:"#333"}}},{first:R,last:Me,active:re,"color-#FFFFFF":B==="#FFFFFF",transparent:B==="transparent"});return D.default.createElement(K.Swatch,{color:B,style:ve.color,onClick:j,onHover:b,focusStyle:{boxShadow:"0 0 4px "+B}},D.default.createElement("div",{style:ve.check},D.default.createElement(ae.default,null)))};N.default=V},23088:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.SwatchesGroup=void 0;var k=w(67294),D=ae(k),F=w(79941),U=ae(F),X=w(35161),me=ae(X),K=w(85638),q=ae(K);function ae(V){return V&&V.__esModule?V:{default:V}}var ee=N.SwatchesGroup=function(W){var ce=W.onClick,B=W.onSwatchHover,se=W.group,j=W.active,b=(0,U.default)({default:{group:{paddingBottom:"10px",width:"40px",float:"left",marginRight:"10px"}}});return D.default.createElement("div",{style:b.group},(0,me.default)(se,function(R,Me){return D.default.createElement(q.default,{key:R,color:R,active:R.toLowerCase()===j,first:Me===0,last:Me===se.length-1,onClick:ce,onSwatchHover:B})}))};N.default=ee},64503:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.Twitter=void 0;var k=w(67294),D=B(k),F=w(45697),U=B(F),X=w(79941),me=B(X),K=w(35161),q=B(K),ae=w(82492),ee=B(ae),V=w(64809),W=B(V),ce=w(1150);function B(j){return j&&j.__esModule?j:{default:j}}var se=N.Twitter=function(b){var R=b.onChange,Me=b.onSwatchHover,re=b.hex,ve=b.colors,ht=b.width,A=b.triangle,Oe=b.styles,Ue=Oe===void 0?{}:Oe,At=b.className,Xt=At===void 0?"":At,On=(0,me.default)((0,ee.default)({default:{card:{width:ht,background:"#fff",border:"0 solid rgba(0,0,0,0.25)",boxShadow:"0 1px 4px rgba(0,0,0,0.25)",borderRadius:"4px",position:"relative"},body:{padding:"15px 9px 9px 15px"},label:{fontSize:"18px",color:"#fff"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent #fff transparent",position:"absolute"},triangleShadow:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent rgba(0,0,0,.1) transparent",position:"absolute"},hash:{background:"#F0F0F0",height:"30px",width:"30px",borderRadius:"4px 0 0 4px",float:"left",color:"#98A1A4",display:"flex",alignItems:"center",justifyContent:"center"},input:{width:"100px",fontSize:"14px",color:"#666",border:"0px",outline:"none",height:"28px",boxShadow:"inset 0 0 0 1px #F0F0F0",boxSizing:"content-box",borderRadius:"0 4px 4px 0",float:"left",paddingLeft:"8px"},swatch:{width:"30px",height:"30px",float:"left",borderRadius:"4px",margin:"0 6px 6px 0"},clear:{clear:"both"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-10px",left:"12px"},triangleShadow:{top:"-11px",left:"12px"}},"top-right-triangle":{triangle:{top:"-10px",right:"12px"},triangleShadow:{top:"-11px",right:"12px"}}},Ue),{"hide-triangle":A==="hide","top-left-triangle":A==="top-left","top-right-triangle":A==="top-right"}),le=function(hr,qn){W.default.isValidHex(hr)&&R({hex:hr,source:"hex"},qn)};return D.default.createElement("div",{style:On.card,className:"twitter-picker "+Xt},D.default.createElement("div",{style:On.triangleShadow}),D.default.createElement("div",{style:On.triangle}),D.default.createElement("div",{style:On.body},(0,q.default)(ve,function(Fn,hr){return D.default.createElement(ce.Swatch,{key:hr,color:Fn,hex:Fn,style:On.swatch,onClick:le,onHover:Me,focusStyle:{boxShadow:"0 0 4px "+Fn}})}),D.default.createElement("div",{style:On.hash},"#"),D.default.createElement(ce.EditableInput,{style:{input:On.input},value:re.replace("#",""),onChange:le}),D.default.createElement("div",{style:On.clear})))};se.propTypes={width:U.default.oneOfType([U.default.string,U.default.number]),triangle:U.default.oneOf(["hide","top-left","top-right"]),colors:U.default.arrayOf(U.default.string),styles:U.default.object},se.defaultProps={width:276,colors:["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],triangle:"top-left",styles:{}},N.default=(0,ce.ColorWrap)(se)},66713:function(Se,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var w=N.calculateChange=function(D,F,U,X,me){D.preventDefault();var K=me.clientWidth,q=me.clientHeight,ae=typeof D.pageX=="number"?D.pageX:D.touches[0].pageX,ee=typeof D.pageY=="number"?D.pageY:D.touches[0].pageY,V=ae-(me.getBoundingClientRect().left+window.pageXOffset),W=ee-(me.getBoundingClientRect().top+window.pageYOffset);if(U==="vertical"){var ce=void 0;if(W<0?ce=0:W>q?ce=1:ce=Math.round(W*100/q)/100,F.a!==ce)return{h:F.h,s:F.s,l:F.l,a:ce,source:"rgb"}}else{var B=void 0;if(V<0?B=0:V>K?B=1:B=Math.round(V*100/K)/100,X!==B)return{h:F.h,s:F.s,l:F.l,a:B,source:"rgb"}}return null}},45704:function(Se,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var w={},k=N.render=function(U,X,me,K){if(typeof document=="undefined"&&!K)return null;var q=K?new K:document.createElement("canvas");q.width=me*2,q.height=me*2;var ae=q.getContext("2d");return ae?(ae.fillStyle=U,ae.fillRect(0,0,q.width,q.height),ae.fillStyle=X,ae.fillRect(0,0,me,me),ae.translate(me,me),ae.fillRect(0,0,me,me),q.toDataURL()):null},D=N.get=function(U,X,me,K){var q=U+"-"+X+"-"+me+(K?"-server":"");if(w[q])return w[q];var ae=k(U,X,me,K);return w[q]=ae,ae}},64809:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.red=void 0;var k=w(66073),D=X(k),F=w(17621),U=X(F);function X(K){return K&&K.__esModule?K:{default:K}}N.default={simpleCheckForValidColor:function(q){var ae=["r","g","b","a","h","s","l","v"],ee=0,V=0;return(0,D.default)(ae,function(W){if(q[W]&&(ee+=1,isNaN(q[W])||(V+=1),W==="s"||W==="l")){var ce=/^\d+%$/;ce.test(q[W])&&(V+=1)}}),ee===V?q:!1},toState:function(q,ae){var ee=q.hex?(0,U.default)(q.hex):(0,U.default)(q),V=ee.toHsl(),W=ee.toHsv(),ce=ee.toRgb(),B=ee.toHex();V.s===0&&(V.h=ae||0,W.h=ae||0);var se=B==="000000"&&ce.a===0;return{hsl:V,hex:se?"transparent":"#"+B,rgb:ce,hsv:W,oldHue:q.h||ae||V.h,source:q.source}},isValidHex:function(q){var ae=String(q).charAt(0)==="#"?1:0;return q.length!==4+ae&&q.length<7+ae&&(0,U.default)(q).isValid()},getContrastingColor:function(q){if(!q)return"#fff";var ae=this.toState(q);if(ae.hex==="transparent")return"rgba(0,0,0,0.4)";var ee=(ae.rgb.r*299+ae.rgb.g*587+ae.rgb.b*114)/1e3;return ee>=128?"#000":"#fff"}};var me=N.red={hsl:{a:1,h:0,l:.5,s:1},hex:"#ff0000",rgb:{r:255,g:0,b:0,a:1},hsv:{h:0,s:1,v:1,a:1}}},33716:function(Se,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var w=N.calculateChange=function(D,F,U,X){D.preventDefault();var me=X.clientWidth,K=X.clientHeight,q=typeof D.pageX=="number"?D.pageX:D.touches[0].pageX,ae=typeof D.pageY=="number"?D.pageY:D.touches[0].pageY,ee=q-(X.getBoundingClientRect().left+window.pageXOffset),V=ae-(X.getBoundingClientRect().top+window.pageYOffset);if(F==="vertical"){var W=void 0;if(V<0)W=359;else if(V>K)W=0;else{var ce=-(V*100/K)+100;W=360*ce/100}if(U.h!==W)return{h:W,s:U.s,l:U.l,a:U.a,source:"rgb"}}else{var B=void 0;if(ee<0)B=0;else if(ee>me)B=359;else{var se=ee*100/me;B=360*se/100}if(U.h!==B)return{h:B,s:U.s,l:U.l,a:U.a,source:"rgb"}}return null}},82538:function(Se,N,w){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.handleFocus=void 0;var k=Object.assign||function(ee){for(var V=1;V<arguments.length;V++){var W=arguments[V];for(var ce in W)Object.prototype.hasOwnProperty.call(W,ce)&&(ee[ce]=W[ce])}return ee},D=function(){function ee(V,W){for(var ce=0;ce<W.length;ce++){var B=W[ce];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(V,B.key,B)}}return function(V,W,ce){return W&&ee(V.prototype,W),ce&&ee(V,ce),V}}(),F=w(67294),U=X(F);function X(ee){return ee&&ee.__esModule?ee:{default:ee}}function me(ee,V){if(!(ee instanceof V))throw new TypeError("Cannot call a class as a function")}function K(ee,V){if(!ee)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return V&&(typeof V=="object"||typeof V=="function")?V:ee}function q(ee,V){if(typeof V!="function"&&V!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof V);ee.prototype=Object.create(V&&V.prototype,{constructor:{value:ee,enumerable:!1,writable:!0,configurable:!0}}),V&&(Object.setPrototypeOf?Object.setPrototypeOf(ee,V):ee.__proto__=V)}var ae=N.handleFocus=function(V){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return function(ce){q(B,ce);function B(){var se,j,b,R;me(this,B);for(var Me=arguments.length,re=Array(Me),ve=0;ve<Me;ve++)re[ve]=arguments[ve];return R=(j=(b=K(this,(se=B.__proto__||Object.getPrototypeOf(B)).call.apply(se,[this].concat(re))),b),b.state={focus:!1},b.handleFocus=function(){return b.setState({focus:!0})},b.handleBlur=function(){return b.setState({focus:!1})},j),K(b,R)}return D(B,[{key:"render",value:function(){return U.default.createElement(W,{onFocus:this.handleFocus,onBlur:this.handleBlur},U.default.createElement(V,k({},this.props,this.state)))}}]),B}(U.default.Component)}},37599:function(Se,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var w=N.calculateChange=function(D,F,U){D.preventDefault();var X=U.getBoundingClientRect(),me=X.width,K=X.height,q=typeof D.pageX=="number"?D.pageX:D.touches[0].pageX,ae=typeof D.pageY=="number"?D.pageY:D.touches[0].pageY,ee=q-(U.getBoundingClientRect().left+window.pageXOffset),V=ae-(U.getBoundingClientRect().top+window.pageYOffset);ee<0?ee=0:ee>me?ee=me:V<0?V=0:V>K&&(V=K);var W=ee*100/me,ce=-(V*100/K)+100;return{h:F.h,s:W,v:ce,a:F.a,source:"rgb"}}},24198:function(Se,N,w){"use strict";var k;k={value:!0},k=k=k=k=N.xS=k=k=k=k=k=k=k=k=k=k=void 0;var D=w(9563);k={enumerable:!0,get:function(){return b(D).default}};var F=w(88858);k={enumerable:!0,get:function(){return b(F).default}};var U=w(9703);k={enumerable:!0,get:function(){return b(U).default}};var X=w(21847);k={enumerable:!0,get:function(){return b(X).default}};var me=w(99766);k={enumerable:!0,get:function(){return b(me).default}};var K=w(19700);k={enumerable:!0,get:function(){return b(K).default}};var q=w(10565);k={enumerable:!0,get:function(){return b(q).default}};var ae=w(66142);k={enumerable:!0,get:function(){return b(ae).default}};var ee=w(33165);k={enumerable:!0,get:function(){return b(ee).default}};var V=w(89753);Object.defineProperty(N,"xS",{enumerable:!0,get:function(){return b(V).default}});var W=w(49857);k={enumerable:!0,get:function(){return b(W).default}};var ce=w(93926);k={enumerable:!0,get:function(){return b(ce).default}};var B=w(64503);k={enumerable:!0,get:function(){return b(B).default}};var se=w(88288);k={enumerable:!0,get:function(){return b(se).default}};var j=b(X);function b(R){return R&&R.__esModule?R:{default:R}}k=j.default},81550:function(Se){(function(N,w){Se.exports=w()})(this,function(){"use strict";var N=function(O){return O instanceof Uint8Array||O instanceof Uint16Array||O instanceof Uint32Array||O instanceof Int8Array||O instanceof Int16Array||O instanceof Int32Array||O instanceof Float32Array||O instanceof Float64Array||O instanceof Uint8ClampedArray},w=function(O,Y){for(var ge=Object.keys(Y),$e=0;$e<ge.length;++$e)O[ge[$e]]=Y[ge[$e]];return O},k=`
`;function D(O){return typeof atob!="undefined"?atob(O):"base64:"+O}function F(O){var Y=new Error("(regl) "+O);throw console.error(Y),Y}function U(O,Y){O||F(Y)}function X(O){return O?": "+O:""}function me(O,Y,ge){O in Y||F("unknown parameter ("+O+")"+X(ge)+". possible values: "+Object.keys(Y).join())}function K(O,Y){N(O)||F("invalid parameter type"+X(Y)+". must be a typed array")}function q(O,Y){switch(Y){case"number":return typeof O=="number";case"object":return typeof O=="object";case"string":return typeof O=="string";case"boolean":return typeof O=="boolean";case"function":return typeof O=="function";case"undefined":return typeof O=="undefined";case"symbol":return typeof O=="symbol"}}function ae(O,Y,ge){q(O,Y)||F("invalid parameter type"+X(ge)+". expected "+Y+", got "+typeof O)}function ee(O,Y){O>=0&&(O|0)===O||F("invalid parameter type, ("+O+")"+X(Y)+". must be a nonnegative integer")}function V(O,Y,ge){Y.indexOf(O)<0&&F("invalid value"+X(ge)+". must be one of: "+Y)}var W=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function ce(O){Object.keys(O).forEach(function(Y){W.indexOf(Y)<0&&F('invalid regl constructor argument "'+Y+'". must be one of '+W)})}function B(O,Y){for(O=O+"";O.length<Y;)O=" "+O;return O}function se(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function j(O,Y){this.number=O,this.line=Y,this.errors=[]}function b(O,Y,ge){this.file=O,this.line=Y,this.message=ge}function R(){var O=new Error,Y=(O.stack||O).toString(),ge=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Y);if(ge)return ge[1];var $e=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Y);return $e?$e[1]:"unknown"}function Me(){var O=new Error,Y=(O.stack||O).toString(),ge=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Y);if(ge)return ge[1];var $e=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Y);return $e?$e[1]:"unknown"}function re(O,Y){var ge=O.split(`
`),$e=1,ot=0,He={unknown:new se,0:new se};He.unknown.name=He[0].name=Y||R(),He.unknown.lines.push(new j(0,""));for(var Ke=0;Ke<ge.length;++Ke){var Et=ge[Ke],Dt=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Et);if(Dt)switch(Dt[1]){case"line":var Lt=/(\d+)(\s+\d+)?/.exec(Dt[2]);Lt&&($e=Lt[1]|0,Lt[2]&&(ot=Lt[2]|0,ot in He||(He[ot]=new se)));break;case"define":var Mt=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Dt[2]);Mt&&(He[ot].name=Mt[1]?D(Mt[2]):Mt[2]);break}He[ot].lines.push(new j($e++,Et))}return Object.keys(He).forEach(function(Ut){var Wt=He[Ut];Wt.lines.forEach(function(_t){Wt.index[_t.number]=_t})}),He}function ve(O){var Y=[];return O.split(`
`).forEach(function(ge){if(!(ge.length<5)){var $e=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(ge);$e?Y.push(new b($e[1]|0,$e[2]|0,$e[3].trim())):ge.length>0&&Y.push(new b("unknown",0,ge))}}),Y}function ht(O,Y){Y.forEach(function(ge){var $e=O[ge.file];if($e){var ot=$e.index[ge.line];if(ot){ot.errors.push(ge),$e.hasErrors=!0;return}}O.unknown.hasErrors=!0,O.unknown.lines[0].errors.push(ge)})}function A(O,Y,ge,$e,ot){if(!O.getShaderParameter(Y,O.COMPILE_STATUS)){var He=O.getShaderInfoLog(Y),Ke=$e===O.FRAGMENT_SHADER?"fragment":"vertex";Fn(ge,"string",Ke+" shader source must be a string",ot);var Et=re(ge,ot),Dt=ve(He);ht(Et,Dt),Object.keys(Et).forEach(function(Lt){var Mt=Et[Lt];if(!Mt.hasErrors)return;var Ut=[""],Wt=[""];function _t(Bt,Le){Ut.push(Bt),Wt.push(Le||"")}_t("file number "+Lt+": "+Mt.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Mt.lines.forEach(function(Bt){if(Bt.errors.length>0){_t(B(Bt.number,4)+"|  ","background-color:yellow; font-weight:bold"),_t(Bt.line+k,"color:red; background-color:yellow; font-weight:bold");var Le=0;Bt.errors.forEach(function(Ye){var Gt=Ye.message,Qt=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Gt);if(Qt){var gt=Qt[1];switch(Gt=Qt[2],gt){case"assign":gt="=";break}Le=Math.max(Bt.line.indexOf(gt,Le),0)}else Le=0;_t(B("| ",6)),_t(B("^^^",Le+3)+k,"font-weight:bold"),_t(B("| ",6)),_t(Gt+k,"font-weight:bold")}),_t(B("| ",6)+k)}else _t(B(Bt.number,4)+"|  "),_t(Bt.line+k,"color:red")}),typeof document!="undefined"&&!window.chrome?(Wt[0]=Ut.join("%c"),console.log.apply(console,Wt)):console.log(Ut.join(""))}),U.raise("Error compiling "+Ke+" shader, "+Et[0].name)}}function Oe(O,Y,ge,$e,ot){if(!O.getProgramParameter(Y,O.LINK_STATUS)){var He=O.getProgramInfoLog(Y),Ke=re(ge,ot),Et=re($e,ot),Dt='Error linking program with vertex shader, "'+Et[0].name+'", and fragment shader "'+Ke[0].name+'"';typeof document!="undefined"?console.log("%c"+Dt+k+"%c"+He,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Dt+k+He),U.raise(Dt)}}function Ue(O){O._commandRef=R()}function At(O,Y,ge,$e){Ue(O);function ot(Dt){return Dt?$e.id(Dt):0}O._fragId=ot(O.static.frag),O._vertId=ot(O.static.vert);function He(Dt,Lt){Object.keys(Lt).forEach(function(Mt){Dt[$e.id(Mt)]=!0})}var Ke=O._uniformSet={};He(Ke,Y.static),He(Ke,Y.dynamic);var Et=O._attributeSet={};He(Et,ge.static),He(Et,ge.dynamic),O._hasCount="count"in O.static||"count"in O.dynamic||"elements"in O.static||"elements"in O.dynamic}function Xt(O,Y){var ge=Me();F(O+" in command "+(Y||R())+(ge==="unknown"?"":" called from "+ge))}function On(O,Y,ge){O||Xt(Y,ge||R())}function le(O,Y,ge,$e){O in Y||Xt("unknown parameter ("+O+")"+X(ge)+". possible values: "+Object.keys(Y).join(),$e||R())}function Fn(O,Y,ge,$e){q(O,Y)||Xt("invalid parameter type"+X(ge)+". expected "+Y+", got "+typeof O,$e||R())}function hr(O){O()}function qn(O,Y,ge){O.texture?V(O.texture._texture.internalformat,Y,"unsupported texture format for attachment"):V(O.renderbuffer._renderbuffer.format,ge,"unsupported renderbuffer format for attachment")}var pr=33071,L=9728,he=9984,lt=9985,Vt=9986,et=9987,wt=5120,Qe=5121,ft=5122,ut=5123,$t=5124,It=5125,on=5126,at=32819,Yt=32820,Cn=33635,St=34042,sr=36193,Nn={};Nn[wt]=Nn[Qe]=1,Nn[ft]=Nn[ut]=Nn[sr]=Nn[Cn]=Nn[at]=Nn[Yt]=2,Nn[$t]=Nn[It]=Nn[on]=Nn[St]=4;function Vr(O,Y){return O===Yt||O===at||O===Cn?2:O===St?4:Nn[O]*Y}function an(O){return!(O&O-1)&&!!O}function br(O,Y,ge){var $e,ot=Y.width,He=Y.height,Ke=Y.channels;U(ot>0&&ot<=ge.maxTextureSize&&He>0&&He<=ge.maxTextureSize,"invalid texture shape"),(O.wrapS!==pr||O.wrapT!==pr)&&U(an(ot)&&an(He),"incompatible wrap mode for texture, both width and height must be power of 2"),Y.mipmask===1?ot!==1&&He!==1&&U(O.minFilter!==he&&O.minFilter!==Vt&&O.minFilter!==lt&&O.minFilter!==et,"min filter requires mipmap"):(U(an(ot)&&an(He),"texture must be a square power of 2 to support mipmapping"),U(Y.mipmask===(ot<<1)-1,"missing or incomplete mipmap data")),Y.type===on&&(ge.extensions.indexOf("oes_texture_float_linear")<0&&U(O.minFilter===L&&O.magFilter===L,"filter not supported, must enable oes_texture_float_linear"),U(!O.genMipmaps,"mipmap generation not supported with float textures"));var Et=Y.images;for($e=0;$e<16;++$e)if(Et[$e]){var Dt=ot>>$e,Lt=He>>$e;U(Y.mipmask&1<<$e,"missing mipmap data");var Mt=Et[$e];if(U(Mt.width===Dt&&Mt.height===Lt,"invalid shape for mip images"),U(Mt.format===Y.format&&Mt.internalformat===Y.internalformat&&Mt.type===Y.type,"incompatible type for mip image"),!Mt.compressed)if(Mt.data){var Ut=Math.ceil(Vr(Mt.type,Ke)*Dt/Mt.unpackAlignment)*Mt.unpackAlignment;U(Mt.data.byteLength===Ut*Lt,"invalid data for image, buffer size is inconsistent with image format")}else Mt.element||Mt.copy}else O.genMipmaps||U((Y.mipmask&1<<$e)==0,"extra mipmap data");Y.compressed&&U(!O.genMipmaps,"mipmap generation for compressed images not supported")}function po(O,Y,ge,$e){var ot=O.width,He=O.height,Ke=O.channels;U(ot>0&&ot<=$e.maxTextureSize&&He>0&&He<=$e.maxTextureSize,"invalid texture shape"),U(ot===He,"cube map must be square"),U(Y.wrapS===pr&&Y.wrapT===pr,"wrap mode not supported by cube map");for(var Et=0;Et<ge.length;++Et){var Dt=ge[Et];U(Dt.width===ot&&Dt.height===He,"inconsistent cube map face shape"),Y.genMipmaps&&(U(!Dt.compressed,"can not generate mipmap for compressed textures"),U(Dt.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Lt=Dt.images,Mt=0;Mt<16;++Mt){var Ut=Lt[Mt];if(Ut){var Wt=ot>>Mt,_t=He>>Mt;U(Dt.mipmask&1<<Mt,"missing mipmap data"),U(Ut.width===Wt&&Ut.height===_t,"invalid shape for mip images"),U(Ut.format===O.format&&Ut.internalformat===O.internalformat&&Ut.type===O.type,"incompatible type for mip image"),Ut.compressed||(Ut.data?U(Ut.data.byteLength===Wt*_t*Math.max(Vr(Ut.type,Ke),Ut.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Ut.element||Ut.copy)}}}}var J=w(U,{optional:hr,raise:F,commandRaise:Xt,command:On,parameter:me,commandParameter:le,constructor:ce,type:ae,commandType:Fn,isTypedArray:K,nni:ee,oneOf:V,shaderError:A,linkError:Oe,callSite:Me,saveCommandRef:Ue,saveDrawInfo:At,framebufferFormat:qn,guessCommand:R,texture2D:br,textureCube:po}),pi=0,vi=0,Ci=5,_r=6;function Ir(O,Y){this.id=pi++,this.type=O,this.data=Y}function ai(O){return O.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Nr(O){if(O.length===0)return[];var Y=O.charAt(0),ge=O.charAt(O.length-1);if(O.length>1&&Y===ge&&(Y==='"'||Y==="'"))return['"'+ai(O.substr(1,O.length-2))+'"'];var $e=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(O);if($e)return Nr(O.substr(0,$e.index)).concat(Nr($e[1])).concat(Nr(O.substr($e.index+$e[0].length)));var ot=O.split(".");if(ot.length===1)return['"'+ai(O)+'"'];for(var He=[],Ke=0;Ke<ot.length;++Ke)He=He.concat(Nr(ot[Ke]));return He}function wr(O){return"["+Nr(O).join("][")+"]"}function Mi(O,Y){return new Ir(O,wr(Y+""))}function zi(O){return typeof O=="function"&&!O._reglType||O instanceof Ir}function S(O,Y){if(typeof O=="function")return new Ir(vi,O);if(typeof O=="number"||typeof O=="boolean")return new Ir(Ci,O);if(Array.isArray(O))return new Ir(_r,O.map((ge,$e)=>S(ge,Y+"["+$e+"]")));if(O instanceof Ir)return O;J(!1,"invalid option type in uniform "+Y)}var wi={DynamicVariable:Ir,define:Mi,isDynamic:zi,unbox:S,accessor:wr},Cr={next:typeof requestAnimationFrame=="function"?function(O){return requestAnimationFrame(O)}:function(O){return setTimeout(O,16)},cancel:typeof cancelAnimationFrame=="function"?function(O){return cancelAnimationFrame(O)}:clearTimeout},sa=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Nc(){var O={"":0},Y=[""];return{id:function(ge){var $e=O[ge];return $e||($e=O[ge]=Y.length,Y.push(ge),$e)},str:function(ge){return Y[ge]}}}function jr(O,Y,ge){var $e=document.createElement("canvas");w($e.style,{border:0,margin:0,padding:0,top:0,left:0}),O.appendChild($e),O===document.body&&($e.style.position="absolute",w(O.style,{margin:0,padding:0}));function ot(){var Et=window.innerWidth,Dt=window.innerHeight;if(O!==document.body){var Lt=O.getBoundingClientRect();Et=Lt.right-Lt.left,Dt=Lt.bottom-Lt.top}$e.width=ge*Et,$e.height=ge*Dt,w($e.style,{width:Et+"px",height:Dt+"px"})}var He;O!==document.body&&typeof ResizeObserver=="function"?(He=new ResizeObserver(function(){setTimeout(ot)}),He.observe(O)):window.addEventListener("resize",ot,!1);function Ke(){He?He.disconnect():window.removeEventListener("resize",ot),O.removeChild($e)}return ot(),{canvas:$e,onDestroy:Ke}}function zo(O,Y){function ge($e){try{return O.getContext($e,Y)}catch(ot){return null}}return ge("webgl")||ge("experimental-webgl")||ge("webgl-experimental")}function Di(O){return typeof O.nodeName=="string"&&typeof O.appendChild=="function"&&typeof O.getBoundingClientRect=="function"}function Ws(O){return typeof O.drawArrays=="function"||typeof O.drawElements=="function"}function aa(O){return typeof O=="string"?O.split():(J(Array.isArray(O),"invalid extension array"),O)}function Ka(O){return typeof O=="string"?(J(typeof document!="undefined","not supported outside of DOM"),document.querySelector(O)):O}function Fl(O){var Y=O||{},ge,$e,ot,He,Ke={},Et=[],Dt=[],Lt=typeof window=="undefined"?1:window.devicePixelRatio,Mt=!1,Ut=function(Bt){Bt&&J.raise(Bt)},Wt=function(){};if(typeof Y=="string"?(J(typeof document!="undefined","selector queries only supported in DOM enviroments"),ge=document.querySelector(Y),J(ge,"invalid query string for element")):typeof Y=="object"?Di(Y)?ge=Y:Ws(Y)?(He=Y,ot=He.canvas):(J.constructor(Y),"gl"in Y?He=Y.gl:"canvas"in Y?ot=Ka(Y.canvas):"container"in Y&&($e=Ka(Y.container)),"attributes"in Y&&(Ke=Y.attributes,J.type(Ke,"object","invalid context attributes")),"extensions"in Y&&(Et=aa(Y.extensions)),"optionalExtensions"in Y&&(Dt=aa(Y.optionalExtensions)),"onDone"in Y&&(J.type(Y.onDone,"function","invalid or missing onDone callback"),Ut=Y.onDone),"profile"in Y&&(Mt=!!Y.profile),"pixelRatio"in Y&&(Lt=+Y.pixelRatio,J(Lt>0,"invalid pixel ratio"))):J.raise("invalid arguments to regl"),ge&&(ge.nodeName.toLowerCase()==="canvas"?ot=ge:$e=ge),!He){if(!ot){J(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var _t=jr($e||document.body,Ut,Lt);if(!_t)return null;ot=_t.canvas,Wt=_t.onDestroy}Ke.premultipliedAlpha===void 0&&(Ke.premultipliedAlpha=!0),He=zo(ot,Ke)}return He?{gl:He,canvas:ot,container:$e,extensions:Et,optionalExtensions:Dt,pixelRatio:Lt,profile:Mt,onDone:Ut,onDestroy:Wt}:(Wt(),Ut("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function io(O,Y){var ge={};function $e(Ke){J.type(Ke,"string","extension name must be string");var Et=Ke.toLowerCase(),Dt;try{Dt=ge[Et]=O.getExtension(Et)}catch(Lt){}return!!Dt}for(var ot=0;ot<Y.extensions.length;++ot){var He=Y.extensions[ot];if(!$e(He))return Y.onDestroy(),Y.onDone('"'+He+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Y.optionalExtensions.forEach($e),{extensions:ge,restore:function(){Object.keys(ge).forEach(function(Ke){if(ge[Ke]&&!$e(Ke))throw new Error("(regl): error restoring extension "+Ke)})}}}function Ui(O,Y){for(var ge=Array(O),$e=0;$e<O;++$e)ge[$e]=Y($e);return ge}var gh=5120,mh=5121,Rc=5122,Bl=5123,vh=5124,yh=5125,bh=5126;function $u(O){for(var Y=16;Y<=1<<28;Y*=16)if(O<=Y)return Y;return 0}function Wu(O){var Y,ge;return Y=(O>65535)<<4,O>>>=Y,ge=(O>255)<<3,O>>>=ge,Y|=ge,ge=(O>15)<<2,O>>>=ge,Y|=ge,ge=(O>3)<<1,O>>>=ge,Y|=ge,Y|O>>1}function _i(){var O=Ui(8,function(){return[]});function Y(He){var Ke=$u(He),Et=O[Wu(Ke)>>2];return Et.length>0?Et.pop():new ArrayBuffer(Ke)}function ge(He){O[Wu(He.byteLength)>>2].push(He)}function $e(He,Ke){var Et=null;switch(He){case gh:Et=new Int8Array(Y(Ke),0,Ke);break;case mh:Et=new Uint8Array(Y(Ke),0,Ke);break;case Rc:Et=new Int16Array(Y(2*Ke),0,Ke);break;case Bl:Et=new Uint16Array(Y(2*Ke),0,Ke);break;case vh:Et=new Int32Array(Y(4*Ke),0,Ke);break;case yh:Et=new Uint32Array(Y(4*Ke),0,Ke);break;case bh:Et=new Float32Array(Y(4*Ke),0,Ke);break;default:return null}return Et.length!==Ke?Et.subarray(0,Ke):Et}function ot(He){ge(He.buffer)}return{alloc:Y,free:ge,allocType:$e,freeType:ot}}var Lr=_i();Lr.zero=_i();var xh=3408,qa=3410,Ch=3411,zl=3412,Zu=3413,Ds=3414,Xu=3415,Np=33901,wh=33902,Rp=3379,Ul=3386,Eh=34921,Vl=36347,kc=36348,Sh=35661,kp=35660,Yu=34930,Ip=36349,Lp=34076,_h=34024,Ah=7936,Ku=7937,Th=7938,Mo=35724,Ja=34047,jl=36063,Gp=34852,Qa=3553,la=34067,ms=34069,Ic=33984,vs=6408,qu=5126,Mh=5121,qo=36160,Lc=36053,Hl=36064,Fp=16384,Bp=function(O,Y){var ge=1;Y.ext_texture_filter_anisotropic&&(ge=O.getParameter(Ja));var $e=1,ot=1;Y.webgl_draw_buffers&&($e=O.getParameter(Gp),ot=O.getParameter(jl));var He=!!Y.oes_texture_float;if(He){var Ke=O.createTexture();O.bindTexture(Qa,Ke),O.texImage2D(Qa,0,vs,1,1,0,vs,qu,null);var Et=O.createFramebuffer();if(O.bindFramebuffer(qo,Et),O.framebufferTexture2D(qo,Hl,Qa,Ke,0),O.bindTexture(Qa,null),O.checkFramebufferStatus(qo)!==Lc)He=!1;else{O.viewport(0,0,1,1),O.clearColor(1,0,0,1),O.clear(Fp);var Dt=Lr.allocType(qu,4);O.readPixels(0,0,1,1,vs,qu,Dt),O.getError()?He=!1:(O.deleteFramebuffer(Et),O.deleteTexture(Ke),He=Dt[0]===1),Lr.freeType(Dt)}}var Lt=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Mt=!0;if(!Lt){var Ut=O.createTexture(),Wt=Lr.allocType(Mh,36);O.activeTexture(Ic),O.bindTexture(la,Ut),O.texImage2D(ms,0,vs,3,3,0,vs,Mh,Wt),Lr.freeType(Wt),O.bindTexture(la,null),O.deleteTexture(Ut),Mt=!O.getError()}return{colorBits:[O.getParameter(qa),O.getParameter(Ch),O.getParameter(zl),O.getParameter(Zu)],depthBits:O.getParameter(Ds),stencilBits:O.getParameter(Xu),subpixelBits:O.getParameter(xh),extensions:Object.keys(Y).filter(function(_t){return!!Y[_t]}),maxAnisotropic:ge,maxDrawbuffers:$e,maxColorAttachments:ot,pointSizeDims:O.getParameter(Np),lineWidthDims:O.getParameter(wh),maxViewportDims:O.getParameter(Ul),maxCombinedTextureUnits:O.getParameter(Sh),maxCubeMapSize:O.getParameter(Lp),maxRenderbufferSize:O.getParameter(_h),maxTextureUnits:O.getParameter(Yu),maxTextureSize:O.getParameter(Rp),maxAttributes:O.getParameter(Eh),maxVertexUniforms:O.getParameter(Vl),maxVertexTextureUnits:O.getParameter(kp),maxVaryingVectors:O.getParameter(kc),maxFragmentUniforms:O.getParameter(Ip),glsl:O.getParameter(Mo),renderer:O.getParameter(Ku),vendor:O.getParameter(Ah),version:O.getParameter(Th),readFloat:He,npotTextureCube:Mt}};function go(O){return!!O&&typeof O=="object"&&Array.isArray(O.shape)&&Array.isArray(O.stride)&&typeof O.offset=="number"&&O.shape.length===O.stride.length&&(Array.isArray(O.data)||N(O.data))}var $i=function(O){return Object.keys(O).map(function(Y){return O[Y]})},Ma={shape:ys,flatten:Pa};function zp(O,Y,ge){for(var $e=0;$e<Y;++$e)ge[$e]=O[$e]}function Ju(O,Y,ge,$e){for(var ot=0,He=0;He<Y;++He)for(var Ke=O[He],Et=0;Et<ge;++Et)$e[ot++]=Ke[Et]}function Qu(O,Y,ge,$e,ot,He){for(var Ke=He,Et=0;Et<Y;++Et)for(var Dt=O[Et],Lt=0;Lt<ge;++Lt)for(var Mt=Dt[Lt],Ut=0;Ut<$e;++Ut)ot[Ke++]=Mt[Ut]}function ca(O,Y,ge,$e,ot){for(var He=1,Ke=ge+1;Ke<Y.length;++Ke)He*=Y[Ke];var Et=Y[ge];if(Y.length-ge==4){var Dt=Y[ge+1],Lt=Y[ge+2],Mt=Y[ge+3];for(Ke=0;Ke<Et;++Ke)Qu(O[Ke],Dt,Lt,Mt,$e,ot),ot+=He}else for(Ke=0;Ke<Et;++Ke)ca(O[Ke],Y,ge+1,$e,ot),ot+=He}function Pa(O,Y,ge,$e){var ot=1;if(Y.length)for(var He=0;He<Y.length;++He)ot*=Y[He];else ot=0;var Ke=$e||Lr.allocType(ge,ot);switch(Y.length){case 0:break;case 1:zp(O,Y[0],Ke);break;case 2:Ju(O,Y[0],Y[1],Ke);break;case 3:Qu(O,Y[0],Y[1],Y[2],Ke,0);break;default:ca(O,Y,0,Ke,0)}return Ke}function ys(O){for(var Y=[],ge=O;ge.length;ge=ge[0])Y.push(ge.length);return Y}var Po={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Ph=5120,Up=5122,Oh=5124,Gc=5121,Vp=5123,jp=5125,Hp=5126,el=5126,ua={int8:Ph,int16:Up,int32:Oh,uint8:Gc,uint16:Vp,uint32:jp,float:Hp,float32:el},$p=35048,Wp=35040,tl={dynamic:$p,stream:Wp,static:35044},da=Ma.flatten,ed=Ma.shape,Ns=35044,Dh=35040,nl=5121,rl=5126,ha=[];ha[5120]=1,ha[5122]=2,ha[5124]=4,ha[5121]=1,ha[5123]=2,ha[5125]=4,ha[5126]=4;function $l(O){return Po[Object.prototype.toString.call(O)]|0}function Nh(O,Y){for(var ge=0;ge<Y.length;++ge)O[ge]=Y[ge]}function il(O,Y,ge,$e,ot,He,Ke){for(var Et=0,Dt=0;Dt<ge;++Dt)for(var Lt=0;Lt<$e;++Lt)O[Et++]=Y[ot*Dt+He*Lt+Ke]}function Rh(O,Y,ge,$e){var ot=0,He={};function Ke(Le){this.id=ot++,this.buffer=O.createBuffer(),this.type=Le,this.usage=Ns,this.byteLength=0,this.dimension=1,this.dtype=nl,this.persistentData=null,ge.profile&&(this.stats={size:0})}Ke.prototype.bind=function(){O.bindBuffer(this.type,this.buffer)},Ke.prototype.destroy=function(){Wt(this)};var Et=[];function Dt(Le,Ye){var Gt=Et.pop();return Gt||(Gt=new Ke(Le)),Gt.bind(),Ut(Gt,Ye,Dh,0,1,!1),Gt}function Lt(Le){Et.push(Le)}function Mt(Le,Ye,Gt){Le.byteLength=Ye.byteLength,O.bufferData(Le.type,Ye,Gt)}function Ut(Le,Ye,Gt,Qt,gt,en){var yt;if(Le.usage=Gt,Array.isArray(Ye)){if(Le.dtype=Qt||rl,Ye.length>0){var jt;if(Array.isArray(Ye[0])){yt=ed(Ye);for(var vt=1,Rt=1;Rt<yt.length;++Rt)vt*=yt[Rt];Le.dimension=vt,jt=da(Ye,yt,Le.dtype),Mt(Le,jt,Gt),en?Le.persistentData=jt:Lr.freeType(jt)}else if(typeof Ye[0]=="number"){Le.dimension=gt;var En=Lr.allocType(Le.dtype,Ye.length);Nh(En,Ye),Mt(Le,En,Gt),en?Le.persistentData=En:Lr.freeType(En)}else N(Ye[0])?(Le.dimension=Ye[0].length,Le.dtype=Qt||$l(Ye[0])||rl,jt=da(Ye,[Ye.length,Ye[0].length],Le.dtype),Mt(Le,jt,Gt),en?Le.persistentData=jt:Lr.freeType(jt)):J.raise("invalid buffer data")}}else if(N(Ye))Le.dtype=Qt||$l(Ye),Le.dimension=gt,Mt(Le,Ye,Gt),en&&(Le.persistentData=new Uint8Array(new Uint8Array(Ye.buffer)));else if(go(Ye)){yt=Ye.shape;var zn=Ye.stride,Zt=Ye.offset,Pt=0,dt=0,kn=0,er=0;yt.length===1?(Pt=yt[0],dt=1,kn=zn[0],er=0):yt.length===2?(Pt=yt[0],dt=yt[1],kn=zn[0],er=zn[1]):J.raise("invalid shape"),Le.dtype=Qt||$l(Ye.data)||rl,Le.dimension=dt;var ln=Lr.allocType(Le.dtype,Pt*dt);il(ln,Ye.data,Pt,dt,kn,er,Zt),Mt(Le,ln,Gt),en?Le.persistentData=ln:Lr.freeType(ln)}else Ye instanceof ArrayBuffer?(Le.dtype=nl,Le.dimension=gt,Mt(Le,Ye,Gt),en&&(Le.persistentData=new Uint8Array(new Uint8Array(Ye)))):J.raise("invalid buffer data")}function Wt(Le){Y.bufferCount--,$e(Le);var Ye=Le.buffer;J(Ye,"buffer must not be deleted already"),O.deleteBuffer(Ye),Le.buffer=null,delete He[Le.id]}function _t(Le,Ye,Gt,Qt){Y.bufferCount++;var gt=new Ke(Ye);He[gt.id]=gt;function en(vt){var Rt=Ns,En=null,zn=0,Zt=0,Pt=1;return Array.isArray(vt)||N(vt)||go(vt)||vt instanceof ArrayBuffer?En=vt:typeof vt=="number"?zn=vt|0:vt&&(J.type(vt,"object","buffer arguments must be an object, a number or an array"),"data"in vt&&(J(En===null||Array.isArray(En)||N(En)||go(En),"invalid data for buffer"),En=vt.data),"usage"in vt&&(J.parameter(vt.usage,tl,"invalid buffer usage"),Rt=tl[vt.usage]),"type"in vt&&(J.parameter(vt.type,ua,"invalid buffer type"),Zt=ua[vt.type]),"dimension"in vt&&(J.type(vt.dimension,"number","invalid dimension"),Pt=vt.dimension|0),"length"in vt&&(J.nni(zn,"buffer length must be a nonnegative integer"),zn=vt.length|0)),gt.bind(),En?Ut(gt,En,Rt,Zt,Pt,Qt):(zn&&O.bufferData(gt.type,zn,Rt),gt.dtype=Zt||nl,gt.usage=Rt,gt.dimension=Pt,gt.byteLength=zn),ge.profile&&(gt.stats.size=gt.byteLength*ha[gt.dtype]),en}function yt(vt,Rt){J(Rt+vt.byteLength<=gt.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+vt.byteLength+" starting from offset "+Rt+" to a buffer of size "+gt.byteLength),O.bufferSubData(gt.type,Rt,vt)}function jt(vt,Rt){var En=(Rt||0)|0,zn;if(gt.bind(),N(vt)||vt instanceof ArrayBuffer)yt(vt,En);else if(Array.isArray(vt)){if(vt.length>0)if(typeof vt[0]=="number"){var Zt=Lr.allocType(gt.dtype,vt.length);Nh(Zt,vt),yt(Zt,En),Lr.freeType(Zt)}else if(Array.isArray(vt[0])||N(vt[0])){zn=ed(vt);var Pt=da(vt,zn,gt.dtype);yt(Pt,En),Lr.freeType(Pt)}else J.raise("invalid buffer data")}else if(go(vt)){zn=vt.shape;var dt=vt.stride,kn=0,er=0,ln=0,ar=0;zn.length===1?(kn=zn[0],er=1,ln=dt[0],ar=0):zn.length===2?(kn=zn[0],er=zn[1],ln=dt[0],ar=dt[1]):J.raise("invalid shape");var Vn=Array.isArray(vt.data)?gt.dtype:$l(vt.data),rr=Lr.allocType(Vn,kn*er);il(rr,vt.data,kn,er,ln,ar,vt.offset),yt(rr,En),Lr.freeType(rr)}else J.raise("invalid data for buffer subdata");return en}return Gt||en(Le),en._reglType="buffer",en._buffer=gt,en.subdata=jt,ge.profile&&(en.stats=gt.stats),en.destroy=function(){Wt(gt)},en}function Bt(){$i(He).forEach(function(Le){Le.buffer=O.createBuffer(),O.bindBuffer(Le.type,Le.buffer),O.bufferData(Le.type,Le.persistentData||Le.byteLength,Le.usage)})}return ge.profile&&(Y.getTotalBufferSize=function(){var Le=0;return Object.keys(He).forEach(function(Ye){Le+=He[Ye].stats.size}),Le}),{create:_t,createStream:Dt,destroyStream:Lt,clear:function(){$i(He).forEach(Wt),Et.forEach(Wt)},getBuffer:function(Le){return Le&&Le._buffer instanceof Ke?Le._buffer:null},restore:Bt,_initBuffer:Ut}}var ol=0,Zp=0,Xp=1,Yp=1,m=4,C=4,_={points:ol,point:Zp,lines:Xp,line:Yp,triangles:m,triangle:C,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},M=0,I=1,G=4,H=5120,Ee=5121,xe=5122,Ve=5123,nt=5124,Ft=5125,Ze=34963,pt=35040,Rn=35044;function ur(O,Y,ge,$e){var ot={},He=0,Ke={uint8:Ee,uint16:Ve};Y.oes_element_index_uint&&(Ke.uint32=Ft);function Et(Bt){this.id=He++,ot[this.id]=this,this.buffer=Bt,this.primType=G,this.vertCount=0,this.type=0}Et.prototype.bind=function(){this.buffer.bind()};var Dt=[];function Lt(Bt){var Le=Dt.pop();return Le||(Le=new Et(ge.create(null,Ze,!0,!1)._buffer)),Ut(Le,Bt,pt,-1,-1,0,0),Le}function Mt(Bt){Dt.push(Bt)}function Ut(Bt,Le,Ye,Gt,Qt,gt,en){Bt.buffer.bind();var yt;if(Le){var jt=en;!en&&(!N(Le)||go(Le)&&!N(Le.data))&&(jt=Y.oes_element_index_uint?Ft:Ve),ge._initBuffer(Bt.buffer,Le,Ye,jt,3)}else O.bufferData(Ze,gt,Ye),Bt.buffer.dtype=yt||Ee,Bt.buffer.usage=Ye,Bt.buffer.dimension=3,Bt.buffer.byteLength=gt;if(yt=en,!en){switch(Bt.buffer.dtype){case Ee:case H:yt=Ee;break;case Ve:case xe:yt=Ve;break;case Ft:case nt:yt=Ft;break;default:J.raise("unsupported type for element array")}Bt.buffer.dtype=yt}Bt.type=yt,J(yt!==Ft||!!Y.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var vt=Qt;vt<0&&(vt=Bt.buffer.byteLength,yt===Ve?vt>>=1:yt===Ft&&(vt>>=2)),Bt.vertCount=vt;var Rt=Gt;if(Gt<0){Rt=G;var En=Bt.buffer.dimension;En===1&&(Rt=M),En===2&&(Rt=I),En===3&&(Rt=G)}Bt.primType=Rt}function Wt(Bt){$e.elementsCount--,J(Bt.buffer!==null,"must not double destroy elements"),delete ot[Bt.id],Bt.buffer.destroy(),Bt.buffer=null}function _t(Bt,Le){var Ye=ge.create(null,Ze,!0),Gt=new Et(Ye._buffer);$e.elementsCount++;function Qt(gt){if(!gt)Ye(),Gt.primType=G,Gt.vertCount=0,Gt.type=Ee;else if(typeof gt=="number")Ye(gt),Gt.primType=G,Gt.vertCount=gt|0,Gt.type=Ee;else{var en=null,yt=Rn,jt=-1,vt=-1,Rt=0,En=0;Array.isArray(gt)||N(gt)||go(gt)?en=gt:(J.type(gt,"object","invalid arguments for elements"),"data"in gt&&(en=gt.data,J(Array.isArray(en)||N(en)||go(en),"invalid data for element buffer")),"usage"in gt&&(J.parameter(gt.usage,tl,"invalid element buffer usage"),yt=tl[gt.usage]),"primitive"in gt&&(J.parameter(gt.primitive,_,"invalid element buffer primitive"),jt=_[gt.primitive]),"count"in gt&&(J(typeof gt.count=="number"&&gt.count>=0,"invalid vertex count for elements"),vt=gt.count|0),"type"in gt&&(J.parameter(gt.type,Ke,"invalid buffer type"),En=Ke[gt.type]),"length"in gt?Rt=gt.length|0:(Rt=vt,En===Ve||En===xe?Rt*=2:(En===Ft||En===nt)&&(Rt*=4))),Ut(Gt,en,yt,jt,vt,Rt,En)}return Qt}return Qt(Bt),Qt._reglType="elements",Qt._elements=Gt,Qt.subdata=function(gt,en){return Ye.subdata(gt,en),Qt},Qt.destroy=function(){Wt(Gt)},Qt}return{create:_t,createStream:Lt,destroyStream:Mt,getElements:function(Bt){return typeof Bt=="function"&&Bt._elements instanceof Et?Bt._elements:null},clear:function(){$i(ot).forEach(Wt)}}}var Mn=new Float32Array(1),Wi=new Uint32Array(Mn.buffer),Ni=5123;function Uo(O){for(var Y=Lr.allocType(Ni,O.length),ge=0;ge<O.length;++ge)if(isNaN(O[ge]))Y[ge]=65535;else if(O[ge]===Infinity)Y[ge]=31744;else if(O[ge]===-Infinity)Y[ge]=64512;else{Mn[0]=O[ge];var $e=Wi[0],ot=$e>>>31<<15,He=($e<<1>>>24)-127,Ke=$e>>13&(1<<10)-1;if(He<-24)Y[ge]=ot;else if(He<-14){var Et=-14-He;Y[ge]=ot+(Ke+(1<<10)>>Et)}else He>15?Y[ge]=ot+31744:Y[ge]=ot+(He+15<<10)+Ke}return Y}function Jn(O){return Array.isArray(O)||N(O)}var nr=function(O){return!(O&O-1)&&!!O},Vo=34467,gr=3553,yi=34067,Rs=34069,ks=6408,Oo=6406,Is=6407,bs=6409,mo=6410,Zs=32854,jo=32855,Xs=36194,Wl=32819,Oa=32820,td=33635,Jr=34042,Ho=6402,Ls=34041,Zl=35904,nd=35906,Ys=36193,rd=33776,Fc=33777,Bc=33778,id=33779,Xl=35986,Gs=35987,kh=34798,Ih=35840,Lh=35841,sl=35842,Gh=35843,zc=36196,$o=5121,xs=5123,Uc=5125,al=5126,Fh=10242,Kp=10243,di=10497,ll=33071,Cs=33648,Jo=10240,Yl=10241,Vc=9728,qp=9729,od=9984,jc=9985,fa=9986,Kl=9987,Bh=33170,pa=4352,Hc=4353,sd=4354,zh=34046,$c=3317,ql=37440,ad=37441,Jp=37443,Q=37444,we=33984,ke=[od,fa,jc,Kl],mt=[0,bs,mo,Is,ks],Be={};Be[bs]=Be[Oo]=Be[Ho]=1,Be[Ls]=Be[mo]=2,Be[Is]=Be[Zl]=3,Be[ks]=Be[nd]=4;function xt(O){return"[object "+O+"]"}var zt=xt("HTMLCanvasElement"),nn=xt("OffscreenCanvas"),sn=xt("CanvasRenderingContext2D"),Wn=xt("ImageBitmap"),Un=xt("HTMLImageElement"),Xn=xt("HTMLVideoElement"),xr=Object.keys(Po).concat([zt,nn,sn,Wn,Un,Xn]),Zr=[];Zr[$o]=1,Zr[al]=4,Zr[Ys]=2,Zr[xs]=2,Zr[Uc]=4;var vn=[];vn[Zs]=2,vn[jo]=2,vn[Xs]=2,vn[Ls]=4,vn[rd]=.5,vn[Fc]=.5,vn[Bc]=1,vn[id]=1,vn[Xl]=.5,vn[Gs]=1,vn[kh]=1,vn[Ih]=.5,vn[Lh]=.25,vn[sl]=.5,vn[Gh]=.25,vn[zc]=.5;function Vi(O){return Array.isArray(O)&&(O.length===0||typeof O[0]=="number")}function vo(O){if(!Array.isArray(O))return!1;var Y=O.length;return!(Y===0||!Jn(O[0]))}function Zi(O){return Object.prototype.toString.call(O)}function bi(O){return Zi(O)===zt}function cl(O){return Zi(O)===nn}function Jl(O){return Zi(O)===sn}function Qo(O){return Zi(O)===Wn}function px(O){return Zi(O)===Un}function gx(O){return Zi(O)===Xn}function Qp(O){if(!O)return!1;var Y=Zi(O);return xr.indexOf(Y)>=0?!0:Vi(O)||vo(O)||go(O)}function km(O){return Po[Object.prototype.toString.call(O)]|0}function mx(O,Y){var ge=Y.length;switch(O.type){case $o:case xs:case Uc:case al:var $e=Lr.allocType(O.type,ge);$e.set(Y),O.data=$e;break;case Ys:O.data=Uo(Y);break;default:J.raise("unsupported texture type, must specify a typed array")}}function Im(O,Y){return Lr.allocType(O.type===Ys?al:O.type,Y)}function Lm(O,Y){O.type===Ys?(O.data=Uo(Y),Lr.freeType(Y)):O.data=Y}function vx(O,Y,ge,$e,ot,He){for(var Ke=O.width,Et=O.height,Dt=O.channels,Lt=Ke*Et*Dt,Mt=Im(O,Lt),Ut=0,Wt=0;Wt<Et;++Wt)for(var _t=0;_t<Ke;++_t)for(var Bt=0;Bt<Dt;++Bt)Mt[Ut++]=Y[ge*_t+$e*Wt+ot*Bt+He];Lm(O,Mt)}function Uh(O,Y,ge,$e,ot,He){var Ke;if(typeof vn[O]!="undefined"?Ke=vn[O]:Ke=Be[O]*Zr[Y],He&&(Ke*=6),ot){for(var Et=0,Dt=ge;Dt>=1;)Et+=Ke*Dt*Dt,Dt/=2;return Et}else return Ke*ge*$e}function yx(O,Y,ge,$e,ot,He,Ke){var Et={"don't care":pa,"dont care":pa,nice:sd,fast:Hc},Dt={repeat:di,clamp:ll,mirror:Cs},Lt={nearest:Vc,linear:qp},Mt=w({mipmap:Kl,"nearest mipmap nearest":od,"linear mipmap nearest":jc,"nearest mipmap linear":fa,"linear mipmap linear":Kl},Lt),Ut={none:0,browser:Q},Wt={uint8:$o,rgba4:Wl,rgb565:td,"rgb5 a1":Oa},_t={alpha:Oo,luminance:bs,"luminance alpha":mo,rgb:Is,rgba:ks,rgba4:Zs,"rgb5 a1":jo,rgb565:Xs},Bt={};Y.ext_srgb&&(_t.srgb=Zl,_t.srgba=nd),Y.oes_texture_float&&(Wt.float32=Wt.float=al),Y.oes_texture_half_float&&(Wt.float16=Wt["half float"]=Ys),Y.webgl_depth_texture&&(w(_t,{depth:Ho,"depth stencil":Ls}),w(Wt,{uint16:xs,uint32:Uc,"depth stencil":Jr})),Y.webgl_compressed_texture_s3tc&&w(Bt,{"rgb s3tc dxt1":rd,"rgba s3tc dxt1":Fc,"rgba s3tc dxt3":Bc,"rgba s3tc dxt5":id}),Y.webgl_compressed_texture_atc&&w(Bt,{"rgb atc":Xl,"rgba atc explicit alpha":Gs,"rgba atc interpolated alpha":kh}),Y.webgl_compressed_texture_pvrtc&&w(Bt,{"rgb pvrtc 4bppv1":Ih,"rgb pvrtc 2bppv1":Lh,"rgba pvrtc 4bppv1":sl,"rgba pvrtc 2bppv1":Gh}),Y.webgl_compressed_texture_etc1&&(Bt["rgb etc1"]=zc);var Le=Array.prototype.slice.call(O.getParameter(Vo));Object.keys(Bt).forEach(function(ue){var We=Bt[ue];Le.indexOf(We)>=0&&(_t[ue]=We)});var Ye=Object.keys(_t);ge.textureFormats=Ye;var Gt=[];Object.keys(_t).forEach(function(ue){var We=_t[ue];Gt[We]=ue});var Qt=[];Object.keys(Wt).forEach(function(ue){var We=Wt[ue];Qt[We]=ue});var gt=[];Object.keys(Lt).forEach(function(ue){var We=Lt[ue];gt[We]=ue});var en=[];Object.keys(Mt).forEach(function(ue){var We=Mt[ue];en[We]=ue});var yt=[];Object.keys(Dt).forEach(function(ue){var We=Dt[ue];yt[We]=ue});var jt=Ye.reduce(function(ue,We){var je=_t[We];return je===bs||je===Oo||je===bs||je===mo||je===Ho||je===Ls||Y.ext_srgb&&(je===Zl||je===nd)?ue[je]=je:je===jo||We.indexOf("rgba")>=0?ue[je]=ks:ue[je]=Is,ue},{});function vt(){this.internalformat=ks,this.format=ks,this.type=$o,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Q,this.width=0,this.height=0,this.channels=0}function Rt(ue,We){ue.internalformat=We.internalformat,ue.format=We.format,ue.type=We.type,ue.compressed=We.compressed,ue.premultiplyAlpha=We.premultiplyAlpha,ue.flipY=We.flipY,ue.unpackAlignment=We.unpackAlignment,ue.colorSpace=We.colorSpace,ue.width=We.width,ue.height=We.height,ue.channels=We.channels}function En(ue,We){if(!(typeof We!="object"||!We)){if("premultiplyAlpha"in We&&(J.type(We.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),ue.premultiplyAlpha=We.premultiplyAlpha),"flipY"in We&&(J.type(We.flipY,"boolean","invalid texture flip"),ue.flipY=We.flipY),"alignment"in We&&(J.oneOf(We.alignment,[1,2,4,8],"invalid texture unpack alignment"),ue.unpackAlignment=We.alignment),"colorSpace"in We&&(J.parameter(We.colorSpace,Ut,"invalid colorSpace"),ue.colorSpace=Ut[We.colorSpace]),"type"in We){var je=We.type;J(Y.oes_texture_float||!(je==="float"||je==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),J(Y.oes_texture_half_float||!(je==="half float"||je==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),J(Y.webgl_depth_texture||!(je==="uint16"||je==="uint32"||je==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),J.parameter(je,Wt,"invalid texture type"),ue.type=Wt[je]}var rn=ue.width,dr=ue.height,ie=ue.channels,Z=!1;"shape"in We?(J(Array.isArray(We.shape)&&We.shape.length>=2,"shape must be an array"),rn=We.shape[0],dr=We.shape[1],We.shape.length===3&&(ie=We.shape[2],J(ie>0&&ie<=4,"invalid number of channels"),Z=!0),J(rn>=0&&rn<=ge.maxTextureSize,"invalid width"),J(dr>=0&&dr<=ge.maxTextureSize,"invalid height")):("radius"in We&&(rn=dr=We.radius,J(rn>=0&&rn<=ge.maxTextureSize,"invalid radius")),"width"in We&&(rn=We.width,J(rn>=0&&rn<=ge.maxTextureSize,"invalid width")),"height"in We&&(dr=We.height,J(dr>=0&&dr<=ge.maxTextureSize,"invalid height")),"channels"in We&&(ie=We.channels,J(ie>0&&ie<=4,"invalid number of channels"),Z=!0)),ue.width=rn|0,ue.height=dr|0,ue.channels=ie|0;var be=!1;if("format"in We){var Ie=We.format;J(Y.webgl_depth_texture||!(Ie==="depth"||Ie==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),J.parameter(Ie,_t,"invalid texture format");var Ge=ue.internalformat=_t[Ie];ue.format=jt[Ge],Ie in Wt&&("type"in We||(ue.type=Wt[Ie])),Ie in Bt&&(ue.compressed=!0),be=!0}!Z&&be?ue.channels=Be[ue.format]:Z&&!be?ue.channels!==mt[ue.format]&&(ue.format=ue.internalformat=mt[ue.channels]):be&&Z&&J(ue.channels===Be[ue.format],"number of channels inconsistent with specified format")}}function zn(ue){O.pixelStorei(ql,ue.flipY),O.pixelStorei(ad,ue.premultiplyAlpha),O.pixelStorei(Jp,ue.colorSpace),O.pixelStorei($c,ue.unpackAlignment)}function Zt(){vt.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Pt(ue,We){var je=null;if(Qp(We)?je=We:We&&(J.type(We,"object","invalid pixel data type"),En(ue,We),"x"in We&&(ue.xOffset=We.x|0),"y"in We&&(ue.yOffset=We.y|0),Qp(We.data)&&(je=We.data)),J(!ue.compressed||je instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),We.copy){J(!je,"can not specify copy and data field for the same texture");var rn=ot.viewportWidth,dr=ot.viewportHeight;ue.width=ue.width||rn-ue.xOffset,ue.height=ue.height||dr-ue.yOffset,ue.needsCopy=!0,J(ue.xOffset>=0&&ue.xOffset<rn&&ue.yOffset>=0&&ue.yOffset<dr&&ue.width>0&&ue.width<=rn&&ue.height>0&&ue.height<=dr,"copy texture read out of bounds")}else if(!je)ue.width=ue.width||1,ue.height=ue.height||1,ue.channels=ue.channels||4;else if(N(je))ue.channels=ue.channels||4,ue.data=je,!("type"in We)&&ue.type===$o&&(ue.type=km(je));else if(Vi(je))ue.channels=ue.channels||4,mx(ue,je),ue.alignment=1,ue.needsFree=!0;else if(go(je)){var ie=je.data;!Array.isArray(ie)&&ue.type===$o&&(ue.type=km(ie));var Z=je.shape,be=je.stride,Ie,Ge,_e,Ce,Ne,oe;Z.length===3?(_e=Z[2],oe=be[2]):(J(Z.length===2,"invalid ndarray pixel data, must be 2 or 3D"),_e=1,oe=1),Ie=Z[0],Ge=Z[1],Ce=be[0],Ne=be[1],ue.alignment=1,ue.width=Ie,ue.height=Ge,ue.channels=_e,ue.format=ue.internalformat=mt[_e],ue.needsFree=!0,vx(ue,ie,Ce,Ne,oe,je.offset)}else if(bi(je)||cl(je)||Jl(je))bi(je)||cl(je)?ue.element=je:ue.element=je.canvas,ue.width=ue.element.width,ue.height=ue.element.height,ue.channels=4;else if(Qo(je))ue.element=je,ue.width=je.width,ue.height=je.height,ue.channels=4;else if(px(je))ue.element=je,ue.width=je.naturalWidth,ue.height=je.naturalHeight,ue.channels=4;else if(gx(je))ue.element=je,ue.width=je.videoWidth,ue.height=je.videoHeight,ue.channels=4;else if(vo(je)){var ye=ue.width||je[0].length,te=ue.height||je.length,Re=ue.channels;Jn(je[0][0])?Re=Re||je[0][0].length:Re=Re||1;for(var ze=Ma.shape(je),rt=1,st=0;st<ze.length;++st)rt*=ze[st];var Je=Im(ue,rt);Ma.flatten(je,ze,"",Je),Lm(ue,Je),ue.alignment=1,ue.width=ye,ue.height=te,ue.channels=Re,ue.format=ue.internalformat=mt[Re],ue.needsFree=!0}ue.type===al?J(ge.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):ue.type===Ys&&J(ge.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function dt(ue,We,je){var rn=ue.element,dr=ue.data,ie=ue.internalformat,Z=ue.format,be=ue.type,Ie=ue.width,Ge=ue.height;zn(ue),rn?O.texImage2D(We,je,Z,Z,be,rn):ue.compressed?O.compressedTexImage2D(We,je,ie,Ie,Ge,0,dr):ue.needsCopy?($e(),O.copyTexImage2D(We,je,Z,ue.xOffset,ue.yOffset,Ie,Ge,0)):O.texImage2D(We,je,Z,Ie,Ge,0,Z,be,dr||null)}function kn(ue,We,je,rn,dr){var ie=ue.element,Z=ue.data,be=ue.internalformat,Ie=ue.format,Ge=ue.type,_e=ue.width,Ce=ue.height;zn(ue),ie?O.texSubImage2D(We,dr,je,rn,Ie,Ge,ie):ue.compressed?O.compressedTexSubImage2D(We,dr,je,rn,be,_e,Ce,Z):ue.needsCopy?($e(),O.copyTexSubImage2D(We,dr,je,rn,ue.xOffset,ue.yOffset,_e,Ce)):O.texSubImage2D(We,dr,je,rn,_e,Ce,Ie,Ge,Z)}var er=[];function ln(){return er.pop()||new Zt}function ar(ue){ue.needsFree&&Lr.freeType(ue.data),Zt.call(ue),er.push(ue)}function Vn(){vt.call(this),this.genMipmaps=!1,this.mipmapHint=pa,this.mipmask=0,this.images=Array(16)}function rr(ue,We,je){var rn=ue.images[0]=ln();ue.mipmask=1,rn.width=ue.width=We,rn.height=ue.height=je,rn.channels=ue.channels=4}function Er(ue,We){var je=null;if(Qp(We))je=ue.images[0]=ln(),Rt(je,ue),Pt(je,We),ue.mipmask=1;else if(En(ue,We),Array.isArray(We.mipmap))for(var rn=We.mipmap,dr=0;dr<rn.length;++dr)je=ue.images[dr]=ln(),Rt(je,ue),je.width>>=dr,je.height>>=dr,Pt(je,rn[dr]),ue.mipmask|=1<<dr;else je=ue.images[0]=ln(),Rt(je,ue),Pt(je,We),ue.mipmask=1;Rt(ue,ue.images[0]),ue.compressed&&(ue.internalformat===rd||ue.internalformat===Fc||ue.internalformat===Bc||ue.internalformat===id)&&J(ue.width%4==0&&ue.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Hi(ue,We){for(var je=ue.images,rn=0;rn<je.length;++rn){if(!je[rn])return;dt(je[rn],We,rn)}}var ir=[];function mr(){var ue=ir.pop()||new Vn;vt.call(ue),ue.mipmask=0;for(var We=0;We<16;++We)ue.images[We]=null;return ue}function oo(ue){for(var We=ue.images,je=0;je<We.length;++je)We[je]&&ar(We[je]),We[je]=null;ir.push(ue)}function gi(){this.minFilter=Vc,this.magFilter=Vc,this.wrapS=ll,this.wrapT=ll,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=pa}function ri(ue,We){if("min"in We){var je=We.min;J.parameter(je,Mt),ue.minFilter=Mt[je],ke.indexOf(ue.minFilter)>=0&&!("faces"in We)&&(ue.genMipmaps=!0)}if("mag"in We){var rn=We.mag;J.parameter(rn,Lt),ue.magFilter=Lt[rn]}var dr=ue.wrapS,ie=ue.wrapT;if("wrap"in We){var Z=We.wrap;typeof Z=="string"?(J.parameter(Z,Dt),dr=ie=Dt[Z]):Array.isArray(Z)&&(J.parameter(Z[0],Dt),J.parameter(Z[1],Dt),dr=Dt[Z[0]],ie=Dt[Z[1]])}else{if("wrapS"in We){var be=We.wrapS;J.parameter(be,Dt),dr=Dt[be]}if("wrapT"in We){var Ie=We.wrapT;J.parameter(Ie,Dt),ie=Dt[Ie]}}if(ue.wrapS=dr,ue.wrapT=ie,"anisotropic"in We){var Ge=We.anisotropic;J(typeof Ge=="number"&&Ge>=1&&Ge<=ge.maxAnisotropic,"aniso samples must be between 1 and "),ue.anisotropic=We.anisotropic}if("mipmap"in We){var _e=!1;switch(typeof We.mipmap){case"string":J.parameter(We.mipmap,Et,"invalid mipmap hint"),ue.mipmapHint=Et[We.mipmap],ue.genMipmaps=!0,_e=!0;break;case"boolean":_e=ue.genMipmaps=We.mipmap;break;case"object":J(Array.isArray(We.mipmap),"invalid mipmap type"),ue.genMipmaps=!1,_e=!0;break;default:J.raise("invalid mipmap type")}_e&&!("min"in We)&&(ue.minFilter=od)}}function Xi(ue,We){O.texParameteri(We,Yl,ue.minFilter),O.texParameteri(We,Jo,ue.magFilter),O.texParameteri(We,Fh,ue.wrapS),O.texParameteri(We,Kp,ue.wrapT),Y.ext_texture_filter_anisotropic&&O.texParameteri(We,zh,ue.anisotropic),ue.genMipmaps&&(O.hint(Bh,ue.mipmapHint),O.generateMipmap(We))}var Yi=0,bo={},So=ge.maxTextureUnits,Ri=Array(So).map(function(){return null});function Qn(ue){vt.call(this),this.mipmask=0,this.internalformat=ks,this.id=Yi++,this.refCount=1,this.target=ue,this.texture=O.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new gi,Ke.profile&&(this.stats={size:0})}function _o(ue){O.activeTexture(we),O.bindTexture(ue.target,ue.texture)}function Hr(){var ue=Ri[0];ue?O.bindTexture(ue.target,ue.texture):O.bindTexture(gr,null)}function _n(ue){var We=ue.texture;J(We,"must not double destroy texture");var je=ue.unit,rn=ue.target;je>=0&&(O.activeTexture(we+je),O.bindTexture(rn,null),Ri[je]=null),O.deleteTexture(We),ue.texture=null,ue.params=null,ue.pixels=null,ue.refCount=0,delete bo[ue.id],He.textureCount--}w(Qn.prototype,{bind:function(){var ue=this;ue.bindCount+=1;var We=ue.unit;if(We<0){for(var je=0;je<So;++je){var rn=Ri[je];if(rn){if(rn.bindCount>0)continue;rn.unit=-1}Ri[je]=ue,We=je;break}We>=So&&J.raise("insufficient number of texture units"),Ke.profile&&He.maxTextureUnits<We+1&&(He.maxTextureUnits=We+1),ue.unit=We,O.activeTexture(we+We),O.bindTexture(ue.target,ue.texture)}return We},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&_n(this)}});function fr(ue,We){var je=new Qn(gr);bo[je.id]=je,He.textureCount++;function rn(Z,be){var Ie=je.texInfo;gi.call(Ie);var Ge=mr();return typeof Z=="number"?typeof be=="number"?rr(Ge,Z|0,be|0):rr(Ge,Z|0,Z|0):Z?(J.type(Z,"object","invalid arguments to regl.texture"),ri(Ie,Z),Er(Ge,Z)):rr(Ge,1,1),Ie.genMipmaps&&(Ge.mipmask=(Ge.width<<1)-1),je.mipmask=Ge.mipmask,Rt(je,Ge),J.texture2D(Ie,Ge,ge),je.internalformat=Ge.internalformat,rn.width=Ge.width,rn.height=Ge.height,_o(je),Hi(Ge,gr),Xi(Ie,gr),Hr(),oo(Ge),Ke.profile&&(je.stats.size=Uh(je.internalformat,je.type,Ge.width,Ge.height,Ie.genMipmaps,!1)),rn.format=Gt[je.internalformat],rn.type=Qt[je.type],rn.mag=gt[Ie.magFilter],rn.min=en[Ie.minFilter],rn.wrapS=yt[Ie.wrapS],rn.wrapT=yt[Ie.wrapT],rn}function dr(Z,be,Ie,Ge){J(!!Z,"must specify image data");var _e=be|0,Ce=Ie|0,Ne=Ge|0,oe=ln();return Rt(oe,je),oe.width=0,oe.height=0,Pt(oe,Z),oe.width=oe.width||(je.width>>Ne)-_e,oe.height=oe.height||(je.height>>Ne)-Ce,J(je.type===oe.type&&je.format===oe.format&&je.internalformat===oe.internalformat,"incompatible format for texture.subimage"),J(_e>=0&&Ce>=0&&_e+oe.width<=je.width&&Ce+oe.height<=je.height,"texture.subimage write out of bounds"),J(je.mipmask&1<<Ne,"missing mipmap data"),J(oe.data||oe.element||oe.needsCopy,"missing image data"),_o(je),kn(oe,gr,_e,Ce,Ne),Hr(),ar(oe),rn}function ie(Z,be){var Ie=Z|0,Ge=be|0||Ie;if(Ie===je.width&&Ge===je.height)return rn;rn.width=je.width=Ie,rn.height=je.height=Ge,_o(je);for(var _e=0;je.mipmask>>_e;++_e){var Ce=Ie>>_e,Ne=Ge>>_e;if(!Ce||!Ne)break;O.texImage2D(gr,_e,je.format,Ce,Ne,0,je.format,je.type,null)}return Hr(),Ke.profile&&(je.stats.size=Uh(je.internalformat,je.type,Ie,Ge,!1,!1)),rn}return rn(ue,We),rn.subimage=dr,rn.resize=ie,rn._reglType="texture2d",rn._texture=je,Ke.profile&&(rn.stats=je.stats),rn.destroy=function(){je.decRef()},rn}function Ar(ue,We,je,rn,dr,ie){var Z=new Qn(yi);bo[Z.id]=Z,He.cubeCount++;var be=new Array(6);function Ie(Ce,Ne,oe,ye,te,Re){var ze,rt=Z.texInfo;for(gi.call(rt),ze=0;ze<6;++ze)be[ze]=mr();if(typeof Ce=="number"||!Ce){var st=Ce|0||1;for(ze=0;ze<6;++ze)rr(be[ze],st,st)}else if(typeof Ce=="object")if(Ne)Er(be[0],Ce),Er(be[1],Ne),Er(be[2],oe),Er(be[3],ye),Er(be[4],te),Er(be[5],Re);else if(ri(rt,Ce),En(Z,Ce),"faces"in Ce){var Je=Ce.faces;for(J(Array.isArray(Je)&&Je.length===6,"cube faces must be a length 6 array"),ze=0;ze<6;++ze)J(typeof Je[ze]=="object"&&!!Je[ze],"invalid input for cube map face"),Rt(be[ze],Z),Er(be[ze],Je[ze])}else for(ze=0;ze<6;++ze)Er(be[ze],Ce);else J.raise("invalid arguments to cube map");for(Rt(Z,be[0]),ge.npotTextureCube||J(nr(Z.width)&&nr(Z.height),"your browser does not support non power or two texture dimensions"),rt.genMipmaps?Z.mipmask=(be[0].width<<1)-1:Z.mipmask=be[0].mipmask,J.textureCube(Z,rt,be,ge),Z.internalformat=be[0].internalformat,Ie.width=be[0].width,Ie.height=be[0].height,_o(Z),ze=0;ze<6;++ze)Hi(be[ze],Rs+ze);for(Xi(rt,yi),Hr(),Ke.profile&&(Z.stats.size=Uh(Z.internalformat,Z.type,Ie.width,Ie.height,rt.genMipmaps,!0)),Ie.format=Gt[Z.internalformat],Ie.type=Qt[Z.type],Ie.mag=gt[rt.magFilter],Ie.min=en[rt.minFilter],Ie.wrapS=yt[rt.wrapS],Ie.wrapT=yt[rt.wrapT],ze=0;ze<6;++ze)oo(be[ze]);return Ie}function Ge(Ce,Ne,oe,ye,te){J(!!Ne,"must specify image data"),J(typeof Ce=="number"&&Ce===(Ce|0)&&Ce>=0&&Ce<6,"invalid face");var Re=oe|0,ze=ye|0,rt=te|0,st=ln();return Rt(st,Z),st.width=0,st.height=0,Pt(st,Ne),st.width=st.width||(Z.width>>rt)-Re,st.height=st.height||(Z.height>>rt)-ze,J(Z.type===st.type&&Z.format===st.format&&Z.internalformat===st.internalformat,"incompatible format for texture.subimage"),J(Re>=0&&ze>=0&&Re+st.width<=Z.width&&ze+st.height<=Z.height,"texture.subimage write out of bounds"),J(Z.mipmask&1<<rt,"missing mipmap data"),J(st.data||st.element||st.needsCopy,"missing image data"),_o(Z),kn(st,Rs+Ce,Re,ze,rt),Hr(),ar(st),Ie}function _e(Ce){var Ne=Ce|0;if(Ne!==Z.width){Ie.width=Z.width=Ne,Ie.height=Z.height=Ne,_o(Z);for(var oe=0;oe<6;++oe)for(var ye=0;Z.mipmask>>ye;++ye)O.texImage2D(Rs+oe,ye,Z.format,Ne>>ye,Ne>>ye,0,Z.format,Z.type,null);return Hr(),Ke.profile&&(Z.stats.size=Uh(Z.internalformat,Z.type,Ie.width,Ie.height,!1,!0)),Ie}}return Ie(ue,We,je,rn,dr,ie),Ie.subimage=Ge,Ie.resize=_e,Ie._reglType="textureCube",Ie._texture=Z,Ke.profile&&(Ie.stats=Z.stats),Ie.destroy=function(){Z.decRef()},Ie}function ki(){for(var ue=0;ue<So;++ue)O.activeTexture(we+ue),O.bindTexture(gr,null),Ri[ue]=null;$i(bo).forEach(_n),He.cubeCount=0,He.textureCount=0}Ke.profile&&(He.getTotalTextureSize=function(){var ue=0;return Object.keys(bo).forEach(function(We){ue+=bo[We].stats.size}),ue});function ga(){for(var ue=0;ue<So;++ue){var We=Ri[ue];We&&(We.bindCount=0,We.unit=-1,Ri[ue]=null)}$i(bo).forEach(function(je){je.texture=O.createTexture(),O.bindTexture(je.target,je.texture);for(var rn=0;rn<32;++rn)if((je.mipmask&1<<rn)!=0)if(je.target===gr)O.texImage2D(gr,rn,je.internalformat,je.width>>rn,je.height>>rn,0,je.internalformat,je.type,null);else for(var dr=0;dr<6;++dr)O.texImage2D(Rs+dr,rn,je.internalformat,je.width>>rn,je.height>>rn,0,je.internalformat,je.type,null);Xi(je.texInfo,je.target)})}function lc(){for(var ue=0;ue<So;++ue){var We=Ri[ue];We&&(We.bindCount=0,We.unit=-1,Ri[ue]=null),O.activeTexture(we+ue),O.bindTexture(gr,null),O.bindTexture(yi,null)}}return{create2D:fr,createCube:Ar,clear:ki,getTexture:function(ue){return null},restore:ga,refresh:lc}}var ul=36161,Vh=32854,Gm=32855,Fm=36194,Bm=33189,Ei=36168,zm=34041,Um=35907,Vm=34836,Ql=34842,jm=34843,Fs=[];Fs[Vh]=2,Fs[Gm]=2,Fs[Fm]=2,Fs[Bm]=2,Fs[Ei]=1,Fs[zm]=4,Fs[Um]=4,Fs[Vm]=16,Fs[Ql]=8,Fs[jm]=6;function Wc(O,Y,ge){return Fs[O]*Y*ge}var bx=function(O,Y,ge,$e,ot){var He={rgba4:Vh,rgb565:Fm,"rgb5 a1":Gm,depth:Bm,stencil:Ei,"depth stencil":zm};Y.ext_srgb&&(He.srgba=Um),Y.ext_color_buffer_half_float&&(He.rgba16f=Ql,He.rgb16f=jm),Y.webgl_color_buffer_float&&(He.rgba32f=Vm);var Ke=[];Object.keys(He).forEach(function(_t){var Bt=He[_t];Ke[Bt]=_t});var Et=0,Dt={};function Lt(_t){this.id=Et++,this.refCount=1,this.renderbuffer=_t,this.format=Vh,this.width=0,this.height=0,ot.profile&&(this.stats={size:0})}Lt.prototype.decRef=function(){--this.refCount<=0&&Mt(this)};function Mt(_t){var Bt=_t.renderbuffer;J(Bt,"must not double destroy renderbuffer"),O.bindRenderbuffer(ul,null),O.deleteRenderbuffer(Bt),_t.renderbuffer=null,_t.refCount=0,delete Dt[_t.id],$e.renderbufferCount--}function Ut(_t,Bt){var Le=new Lt(O.createRenderbuffer());Dt[Le.id]=Le,$e.renderbufferCount++;function Ye(Qt,gt){var en=0,yt=0,jt=Vh;if(typeof Qt=="object"&&Qt){var vt=Qt;if("shape"in vt){var Rt=vt.shape;J(Array.isArray(Rt)&&Rt.length>=2,"invalid renderbuffer shape"),en=Rt[0]|0,yt=Rt[1]|0}else"radius"in vt&&(en=yt=vt.radius|0),"width"in vt&&(en=vt.width|0),"height"in vt&&(yt=vt.height|0);"format"in vt&&(J.parameter(vt.format,He,"invalid renderbuffer format"),jt=He[vt.format])}else typeof Qt=="number"?(en=Qt|0,typeof gt=="number"?yt=gt|0:yt=en):Qt?J.raise("invalid arguments to renderbuffer constructor"):en=yt=1;if(J(en>0&&yt>0&&en<=ge.maxRenderbufferSize&&yt<=ge.maxRenderbufferSize,"invalid renderbuffer size"),!(en===Le.width&&yt===Le.height&&jt===Le.format))return Ye.width=Le.width=en,Ye.height=Le.height=yt,Le.format=jt,O.bindRenderbuffer(ul,Le.renderbuffer),O.renderbufferStorage(ul,jt,en,yt),J(O.getError()===0,"invalid render buffer format"),ot.profile&&(Le.stats.size=Wc(Le.format,Le.width,Le.height)),Ye.format=Ke[Le.format],Ye}function Gt(Qt,gt){var en=Qt|0,yt=gt|0||en;return en===Le.width&&yt===Le.height||(J(en>0&&yt>0&&en<=ge.maxRenderbufferSize&&yt<=ge.maxRenderbufferSize,"invalid renderbuffer size"),Ye.width=Le.width=en,Ye.height=Le.height=yt,O.bindRenderbuffer(ul,Le.renderbuffer),O.renderbufferStorage(ul,Le.format,en,yt),J(O.getError()===0,"invalid render buffer format"),ot.profile&&(Le.stats.size=Wc(Le.format,Le.width,Le.height))),Ye}return Ye(_t,Bt),Ye.resize=Gt,Ye._reglType="renderbuffer",Ye._renderbuffer=Le,ot.profile&&(Ye.stats=Le.stats),Ye.destroy=function(){Le.decRef()},Ye}ot.profile&&($e.getTotalRenderbufferSize=function(){var _t=0;return Object.keys(Dt).forEach(function(Bt){_t+=Dt[Bt].stats.size}),_t});function Wt(){$i(Dt).forEach(function(_t){_t.renderbuffer=O.createRenderbuffer(),O.bindRenderbuffer(ul,_t.renderbuffer),O.renderbufferStorage(ul,_t.format,_t.width,_t.height)}),O.bindRenderbuffer(ul,null)}return{create:Ut,clear:function(){$i(Dt).forEach(Mt)},restore:Wt}},Ks=36160,eg=36161,as=3553,ld=34069,Hm=36064,cd=36096,$m=36128,Wm=33306,Zm=36053,Xm=36054,xx=36055,Cx=36057,jh=36061,wx=36193,Ym=5121,Ex=5126,Km=6407,qm=6408,Sx=6402,_x=[Km,qm],Hh=[];Hh[qm]=4,Hh[Km]=3;var $h=[];$h[Ym]=1,$h[Ex]=4,$h[wx]=2;var Zc=32854,Ax=32855,tg=36194,Tx=33189,Mx=36168,Jm=34041,Px=35907,Ox=34836,Dx=34842,ng=34843,Nx=[Zc,Ax,tg,Px,Dx,ng,Ox],dl={};dl[Zm]="complete",dl[Xm]="incomplete attachment",dl[Cx]="incomplete dimensions",dl[xx]="incomplete, missing attachment",dl[jh]="unsupported";function Rx(O,Y,ge,$e,ot,He){var Ke={cur:null,next:null,dirty:!1,setFBO:null},Et=["rgba"],Dt=["rgba4","rgb565","rgb5 a1"];Y.ext_srgb&&Dt.push("srgba"),Y.ext_color_buffer_half_float&&Dt.push("rgba16f","rgb16f"),Y.webgl_color_buffer_float&&Dt.push("rgba32f");var Lt=["uint8"];Y.oes_texture_half_float&&Lt.push("half float","float16"),Y.oes_texture_float&&Lt.push("float","float32");function Mt(Zt,Pt,dt){this.target=Zt,this.texture=Pt,this.renderbuffer=dt;var kn=0,er=0;Pt?(kn=Pt.width,er=Pt.height):dt&&(kn=dt.width,er=dt.height),this.width=kn,this.height=er}function Ut(Zt){Zt&&(Zt.texture&&Zt.texture._texture.decRef(),Zt.renderbuffer&&Zt.renderbuffer._renderbuffer.decRef())}function Wt(Zt,Pt,dt){if(!!Zt)if(Zt.texture){var kn=Zt.texture._texture,er=Math.max(1,kn.width),ln=Math.max(1,kn.height);J(er===Pt&&ln===dt,"inconsistent width/height for supplied texture"),kn.refCount+=1}else{var ar=Zt.renderbuffer._renderbuffer;J(ar.width===Pt&&ar.height===dt,"inconsistent width/height for renderbuffer"),ar.refCount+=1}}function _t(Zt,Pt){Pt&&(Pt.texture?O.framebufferTexture2D(Ks,Zt,Pt.target,Pt.texture._texture.texture,0):O.framebufferRenderbuffer(Ks,Zt,eg,Pt.renderbuffer._renderbuffer.renderbuffer))}function Bt(Zt){var Pt=as,dt=null,kn=null,er=Zt;typeof Zt=="object"&&(er=Zt.data,"target"in Zt&&(Pt=Zt.target|0)),J.type(er,"function","invalid attachment data");var ln=er._reglType;return ln==="texture2d"?(dt=er,J(Pt===as)):ln==="textureCube"?(dt=er,J(Pt>=ld&&Pt<ld+6,"invalid cube map target")):ln==="renderbuffer"?(kn=er,Pt=eg):J.raise("invalid regl object for attachment"),new Mt(Pt,dt,kn)}function Le(Zt,Pt,dt,kn,er){if(dt){var ln=$e.create2D({width:Zt,height:Pt,format:kn,type:er});return ln._texture.refCount=0,new Mt(as,ln,null)}else{var ar=ot.create({width:Zt,height:Pt,format:kn});return ar._renderbuffer.refCount=0,new Mt(eg,null,ar)}}function Ye(Zt){return Zt&&(Zt.texture||Zt.renderbuffer)}function Gt(Zt,Pt,dt){Zt&&(Zt.texture?Zt.texture.resize(Pt,dt):Zt.renderbuffer&&Zt.renderbuffer.resize(Pt,dt),Zt.width=Pt,Zt.height=dt)}var Qt=0,gt={};function en(){this.id=Qt++,gt[this.id]=this,this.framebuffer=O.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function yt(Zt){Zt.colorAttachments.forEach(Ut),Ut(Zt.depthAttachment),Ut(Zt.stencilAttachment),Ut(Zt.depthStencilAttachment)}function jt(Zt){var Pt=Zt.framebuffer;J(Pt,"must not double destroy framebuffer"),O.deleteFramebuffer(Pt),Zt.framebuffer=null,He.framebufferCount--,delete gt[Zt.id]}function vt(Zt){var Pt;O.bindFramebuffer(Ks,Zt.framebuffer);var dt=Zt.colorAttachments;for(Pt=0;Pt<dt.length;++Pt)_t(Hm+Pt,dt[Pt]);for(Pt=dt.length;Pt<ge.maxColorAttachments;++Pt)O.framebufferTexture2D(Ks,Hm+Pt,as,null,0);O.framebufferTexture2D(Ks,Wm,as,null,0),O.framebufferTexture2D(Ks,cd,as,null,0),O.framebufferTexture2D(Ks,$m,as,null,0),_t(cd,Zt.depthAttachment),_t($m,Zt.stencilAttachment),_t(Wm,Zt.depthStencilAttachment);var kn=O.checkFramebufferStatus(Ks);!O.isContextLost()&&kn!==Zm&&J.raise("framebuffer configuration not supported, status = "+dl[kn]),O.bindFramebuffer(Ks,Ke.next?Ke.next.framebuffer:null),Ke.cur=Ke.next,O.getError()}function Rt(Zt,Pt){var dt=new en;He.framebufferCount++;function kn(ln,ar){var Vn;J(Ke.next!==dt,"can not update framebuffer which is currently in use");var rr=0,Er=0,Hi=!0,ir=!0,mr=null,oo=!0,gi="rgba",ri="uint8",Xi=1,Yi=null,bo=null,So=null,Ri=!1;if(typeof ln=="number")rr=ln|0,Er=ar|0||rr;else if(!ln)rr=Er=1;else{J.type(ln,"object","invalid arguments for framebuffer");var Qn=ln;if("shape"in Qn){var _o=Qn.shape;J(Array.isArray(_o)&&_o.length>=2,"invalid shape for framebuffer"),rr=_o[0],Er=_o[1]}else"radius"in Qn&&(rr=Er=Qn.radius),"width"in Qn&&(rr=Qn.width),"height"in Qn&&(Er=Qn.height);("color"in Qn||"colors"in Qn)&&(mr=Qn.color||Qn.colors,Array.isArray(mr)&&J(mr.length===1||Y.webgl_draw_buffers,"multiple render targets not supported")),mr||("colorCount"in Qn&&(Xi=Qn.colorCount|0,J(Xi>0,"invalid color buffer count")),"colorTexture"in Qn&&(oo=!!Qn.colorTexture,gi="rgba4"),"colorType"in Qn&&(ri=Qn.colorType,oo?(J(Y.oes_texture_float||!(ri==="float"||ri==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),J(Y.oes_texture_half_float||!(ri==="half float"||ri==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):ri==="half float"||ri==="float16"?(J(Y.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),gi="rgba16f"):(ri==="float"||ri==="float32")&&(J(Y.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),gi="rgba32f"),J.oneOf(ri,Lt,"invalid color type")),"colorFormat"in Qn&&(gi=Qn.colorFormat,Et.indexOf(gi)>=0?oo=!0:Dt.indexOf(gi)>=0?oo=!1:oo?J.oneOf(Qn.colorFormat,Et,"invalid color format for texture"):J.oneOf(Qn.colorFormat,Dt,"invalid color format for renderbuffer"))),("depthTexture"in Qn||"depthStencilTexture"in Qn)&&(Ri=!!(Qn.depthTexture||Qn.depthStencilTexture),J(!Ri||Y.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Qn&&(typeof Qn.depth=="boolean"?Hi=Qn.depth:(Yi=Qn.depth,ir=!1)),"stencil"in Qn&&(typeof Qn.stencil=="boolean"?ir=Qn.stencil:(bo=Qn.stencil,Hi=!1)),"depthStencil"in Qn&&(typeof Qn.depthStencil=="boolean"?Hi=ir=Qn.depthStencil:(So=Qn.depthStencil,Hi=!1,ir=!1))}var Hr=null,_n=null,fr=null,Ar=null;if(Array.isArray(mr))Hr=mr.map(Bt);else if(mr)Hr=[Bt(mr)];else for(Hr=new Array(Xi),Vn=0;Vn<Xi;++Vn)Hr[Vn]=Le(rr,Er,oo,gi,ri);J(Y.webgl_draw_buffers||Hr.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),J(Hr.length<=ge.maxColorAttachments,"too many color attachments, not supported"),rr=rr||Hr[0].width,Er=Er||Hr[0].height,Yi?_n=Bt(Yi):Hi&&!ir&&(_n=Le(rr,Er,Ri,"depth","uint32")),bo?fr=Bt(bo):ir&&!Hi&&(fr=Le(rr,Er,!1,"stencil","uint8")),So?Ar=Bt(So):!Yi&&!bo&&ir&&Hi&&(Ar=Le(rr,Er,Ri,"depth stencil","depth stencil")),J(!!Yi+!!bo+!!So<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var ki=null;for(Vn=0;Vn<Hr.length;++Vn)if(Wt(Hr[Vn],rr,Er),J(!Hr[Vn]||Hr[Vn].texture&&_x.indexOf(Hr[Vn].texture._texture.format)>=0||Hr[Vn].renderbuffer&&Nx.indexOf(Hr[Vn].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Vn+" is invalid"),Hr[Vn]&&Hr[Vn].texture){var ga=Hh[Hr[Vn].texture._texture.format]*$h[Hr[Vn].texture._texture.type];ki===null?ki=ga:J(ki===ga,"all color attachments much have the same number of bits per pixel.")}return Wt(_n,rr,Er),J(!_n||_n.texture&&_n.texture._texture.format===Sx||_n.renderbuffer&&_n.renderbuffer._renderbuffer.format===Tx,"invalid depth attachment for framebuffer object"),Wt(fr,rr,Er),J(!fr||fr.renderbuffer&&fr.renderbuffer._renderbuffer.format===Mx,"invalid stencil attachment for framebuffer object"),Wt(Ar,rr,Er),J(!Ar||Ar.texture&&Ar.texture._texture.format===Jm||Ar.renderbuffer&&Ar.renderbuffer._renderbuffer.format===Jm,"invalid depth-stencil attachment for framebuffer object"),yt(dt),dt.width=rr,dt.height=Er,dt.colorAttachments=Hr,dt.depthAttachment=_n,dt.stencilAttachment=fr,dt.depthStencilAttachment=Ar,kn.color=Hr.map(Ye),kn.depth=Ye(_n),kn.stencil=Ye(fr),kn.depthStencil=Ye(Ar),kn.width=dt.width,kn.height=dt.height,vt(dt),kn}function er(ln,ar){J(Ke.next!==dt,"can not resize a framebuffer which is currently in use");var Vn=Math.max(ln|0,1),rr=Math.max(ar|0||Vn,1);if(Vn===dt.width&&rr===dt.height)return kn;for(var Er=dt.colorAttachments,Hi=0;Hi<Er.length;++Hi)Gt(Er[Hi],Vn,rr);return Gt(dt.depthAttachment,Vn,rr),Gt(dt.stencilAttachment,Vn,rr),Gt(dt.depthStencilAttachment,Vn,rr),dt.width=kn.width=Vn,dt.height=kn.height=rr,vt(dt),kn}return kn(Zt,Pt),w(kn,{resize:er,_reglType:"framebuffer",_framebuffer:dt,destroy:function(){jt(dt),yt(dt)},use:function(ln){Ke.setFBO({framebuffer:kn},ln)}})}function En(Zt){var Pt=Array(6);function dt(er){var ln;J(Pt.indexOf(Ke.next)<0,"can not update framebuffer which is currently in use");var ar={color:null},Vn=0,rr=null,Er="rgba",Hi="uint8",ir=1;if(typeof er=="number")Vn=er|0;else if(!er)Vn=1;else{J.type(er,"object","invalid arguments for framebuffer");var mr=er;if("shape"in mr){var oo=mr.shape;J(Array.isArray(oo)&&oo.length>=2,"invalid shape for framebuffer"),J(oo[0]===oo[1],"cube framebuffer must be square"),Vn=oo[0]}else"radius"in mr&&(Vn=mr.radius|0),"width"in mr?(Vn=mr.width|0,"height"in mr&&J(mr.height===Vn,"must be square")):"height"in mr&&(Vn=mr.height|0);("color"in mr||"colors"in mr)&&(rr=mr.color||mr.colors,Array.isArray(rr)&&J(rr.length===1||Y.webgl_draw_buffers,"multiple render targets not supported")),rr||("colorCount"in mr&&(ir=mr.colorCount|0,J(ir>0,"invalid color buffer count")),"colorType"in mr&&(J.oneOf(mr.colorType,Lt,"invalid color type"),Hi=mr.colorType),"colorFormat"in mr&&(Er=mr.colorFormat,J.oneOf(mr.colorFormat,Et,"invalid color format for texture"))),"depth"in mr&&(ar.depth=mr.depth),"stencil"in mr&&(ar.stencil=mr.stencil),"depthStencil"in mr&&(ar.depthStencil=mr.depthStencil)}var gi;if(rr)if(Array.isArray(rr))for(gi=[],ln=0;ln<rr.length;++ln)gi[ln]=rr[ln];else gi=[rr];else{gi=Array(ir);var ri={radius:Vn,format:Er,type:Hi};for(ln=0;ln<ir;++ln)gi[ln]=$e.createCube(ri)}for(ar.color=Array(gi.length),ln=0;ln<gi.length;++ln){var Xi=gi[ln];J(typeof Xi=="function"&&Xi._reglType==="textureCube","invalid cube map"),Vn=Vn||Xi.width,J(Xi.width===Vn&&Xi.height===Vn,"invalid cube map shape"),ar.color[ln]={target:ld,data:gi[ln]}}for(ln=0;ln<6;++ln){for(var Yi=0;Yi<gi.length;++Yi)ar.color[Yi].target=ld+ln;ln>0&&(ar.depth=Pt[0].depth,ar.stencil=Pt[0].stencil,ar.depthStencil=Pt[0].depthStencil),Pt[ln]?Pt[ln](ar):Pt[ln]=Rt(ar)}return w(dt,{width:Vn,height:Vn,color:gi})}function kn(er){var ln,ar=er|0;if(J(ar>0&&ar<=ge.maxCubeMapSize,"invalid radius for cube fbo"),ar===dt.width)return dt;var Vn=dt.color;for(ln=0;ln<Vn.length;++ln)Vn[ln].resize(ar);for(ln=0;ln<6;++ln)Pt[ln].resize(ar);return dt.width=dt.height=ar,dt}return dt(Zt),w(dt,{faces:Pt,resize:kn,_reglType:"framebufferCube",destroy:function(){Pt.forEach(function(er){er.destroy()})}})}function zn(){Ke.cur=null,Ke.next=null,Ke.dirty=!0,$i(gt).forEach(function(Zt){Zt.framebuffer=O.createFramebuffer(),vt(Zt)})}return w(Ke,{getFramebuffer:function(Zt){if(typeof Zt=="function"&&Zt._reglType==="framebuffer"){var Pt=Zt._framebuffer;if(Pt instanceof en)return Pt}return null},create:Rt,createCube:En,clear:function(){$i(gt).forEach(jt)},restore:zn})}var rg=5126,ec=34962;function Wh(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=rg,this.offset=0,this.stride=0,this.divisor=0}function kx(O,Y,ge,$e,ot){for(var He=ge.maxAttributes,Ke=new Array(He),Et=0;Et<He;++Et)Ke[Et]=new Wh;var Dt=0,Lt={},Mt={Record:Wh,scope:{},state:Ke,currentVAO:null,targetVAO:null,restore:Wt()?gt:function(){},createVAO:en,getVAO:Bt,destroyBuffer:Ut,setVAO:Wt()?Le:Ye,clear:Wt()?Gt:function(){}};function Ut(yt){for(var jt=0;jt<Ke.length;++jt){var vt=Ke[jt];vt.buffer===yt&&(O.disableVertexAttribArray(jt),vt.buffer=null)}}function Wt(){return Y.oes_vertex_array_object}function _t(){return Y.angle_instanced_arrays}function Bt(yt){return typeof yt=="function"&&yt._vao?yt._vao:null}function Le(yt){if(yt!==Mt.currentVAO){var jt=Wt();yt?jt.bindVertexArrayOES(yt.vao):jt.bindVertexArrayOES(null),Mt.currentVAO=yt}}function Ye(yt){if(yt!==Mt.currentVAO){if(yt)yt.bindAttrs();else for(var jt=_t(),vt=0;vt<Ke.length;++vt){var Rt=Ke[vt];Rt.buffer?(O.enableVertexAttribArray(vt),O.vertexAttribPointer(vt,Rt.size,Rt.type,Rt.normalized,Rt.stride,Rt.offfset),jt&&Rt.divisor&&jt.vertexAttribDivisorANGLE(vt,Rt.divisor)):(O.disableVertexAttribArray(vt),O.vertexAttrib4f(vt,Rt.x,Rt.y,Rt.z,Rt.w))}Mt.currentVAO=yt}}function Gt(){$i(Lt).forEach(function(yt){yt.destroy()})}function Qt(){this.id=++Dt,this.attributes=[];var yt=Wt();yt?this.vao=yt.createVertexArrayOES():this.vao=null,Lt[this.id]=this,this.buffers=[]}Qt.prototype.bindAttrs=function(){for(var yt=_t(),jt=this.attributes,vt=0;vt<jt.length;++vt){var Rt=jt[vt];Rt.buffer?(O.enableVertexAttribArray(vt),O.bindBuffer(ec,Rt.buffer.buffer),O.vertexAttribPointer(vt,Rt.size,Rt.type,Rt.normalized,Rt.stride,Rt.offset),yt&&Rt.divisor&&yt.vertexAttribDivisorANGLE(vt,Rt.divisor)):(O.disableVertexAttribArray(vt),O.vertexAttrib4f(vt,Rt.x,Rt.y,Rt.z,Rt.w))}for(var En=jt.length;En<He;++En)O.disableVertexAttribArray(En)},Qt.prototype.refresh=function(){var yt=Wt();yt&&(yt.bindVertexArrayOES(this.vao),this.bindAttrs(),Mt.currentVAO=this)},Qt.prototype.destroy=function(){if(this.vao){var yt=Wt();this===Mt.currentVAO&&(Mt.currentVAO=null,yt.bindVertexArrayOES(null)),yt.deleteVertexArrayOES(this.vao),this.vao=null}Lt[this.id]&&(delete Lt[this.id],$e.vaoCount-=1)};function gt(){var yt=Wt();yt&&$i(Lt).forEach(function(jt){jt.refresh()})}function en(yt){var jt=new Qt;$e.vaoCount+=1;function vt(Rt){J(Array.isArray(Rt),"arguments to vertex array constructor must be an array"),J(Rt.length<He,"too many attributes"),J(Rt.length>0,"must specify at least one attribute");var En={},zn=jt.attributes;zn.length=Rt.length;for(var Zt=0;Zt<Rt.length;++Zt){var Pt=Rt[Zt],dt=zn[Zt]=new Wh,kn=Pt.data||Pt;if(Array.isArray(kn)||N(kn)||go(kn)){var er;jt.buffers[Zt]&&(er=jt.buffers[Zt],N(kn)&&er._buffer.byteLength>=kn.byteLength?er.subdata(kn):(er.destroy(),jt.buffers[Zt]=null)),jt.buffers[Zt]||(er=jt.buffers[Zt]=ot.create(Pt,ec,!1,!0)),dt.buffer=ot.getBuffer(er),dt.size=dt.buffer.dimension|0,dt.normalized=!1,dt.type=dt.buffer.dtype,dt.offset=0,dt.stride=0,dt.divisor=0,dt.state=1,En[Zt]=1}else ot.getBuffer(Pt)?(dt.buffer=ot.getBuffer(Pt),dt.size=dt.buffer.dimension|0,dt.normalized=!1,dt.type=dt.buffer.dtype,dt.offset=0,dt.stride=0,dt.divisor=0,dt.state=1):ot.getBuffer(Pt.buffer)?(dt.buffer=ot.getBuffer(Pt.buffer),dt.size=(+Pt.size||dt.buffer.dimension)|0,dt.normalized=!!Pt.normalized||!1,"type"in Pt?(J.parameter(Pt.type,ua,"invalid buffer type"),dt.type=ua[Pt.type]):dt.type=dt.buffer.dtype,dt.offset=(Pt.offset||0)|0,dt.stride=(Pt.stride||0)|0,dt.divisor=(Pt.divisor||0)|0,dt.state=1,J(dt.size>=1&&dt.size<=4,"size must be between 1 and 4"),J(dt.offset>=0,"invalid offset"),J(dt.stride>=0&&dt.stride<=255,"stride must be between 0 and 255"),J(dt.divisor>=0,"divisor must be positive"),J(!dt.divisor||!!Y.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Pt?(J(Zt>0,"first attribute must not be a constant"),dt.x=+Pt.x||0,dt.y=+Pt.y||0,dt.z=+Pt.z||0,dt.w=+Pt.w||0,dt.state=2):J(!1,"invalid attribute spec for location "+Zt)}for(var ln=0;ln<jt.buffers.length;++ln)!En[ln]&&jt.buffers[ln]&&(jt.buffers[ln].destroy(),jt.buffers[ln]=null);return jt.refresh(),vt}return vt.destroy=function(){for(var Rt=0;Rt<jt.buffers.length;++Rt)jt.buffers[Rt]&&jt.buffers[Rt].destroy();jt.buffers.length=0,jt.destroy()},vt._vao=jt,vt._reglType="vao",vt(yt)}return Mt}var ig=35632,Qm=35633,ev=35718,tv=35721;function Ix(O,Y,ge,$e){var ot={},He={};function Ke(Le,Ye,Gt,Qt){this.name=Le,this.id=Ye,this.location=Gt,this.info=Qt}function Et(Le,Ye){for(var Gt=0;Gt<Le.length;++Gt)if(Le[Gt].id===Ye.id){Le[Gt].location=Ye.location;return}Le.push(Ye)}function Dt(Le,Ye,Gt){var Qt=Le===ig?ot:He,gt=Qt[Ye];if(!gt){var en=Y.str(Ye);gt=O.createShader(Le),O.shaderSource(gt,en),O.compileShader(gt),J.shaderError(O,gt,en,Le,Gt),Qt[Ye]=gt}return gt}var Lt={},Mt=[],Ut=0;function Wt(Le,Ye){this.id=Ut++,this.fragId=Le,this.vertId=Ye,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,$e.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function _t(Le,Ye,Gt){var Qt,gt,en=Dt(ig,Le.fragId),yt=Dt(Qm,Le.vertId),jt=Le.program=O.createProgram();if(O.attachShader(jt,en),O.attachShader(jt,yt),Gt)for(Qt=0;Qt<Gt.length;++Qt){var vt=Gt[Qt];O.bindAttribLocation(jt,vt[0],vt[1])}O.linkProgram(jt),J.linkError(O,jt,Y.str(Le.fragId),Y.str(Le.vertId),Ye);var Rt=O.getProgramParameter(jt,ev);$e.profile&&(Le.stats.uniformsCount=Rt);var En=Le.uniforms;for(Qt=0;Qt<Rt;++Qt)if(gt=O.getActiveUniform(jt,Qt),gt)if(gt.size>1)for(var zn=0;zn<gt.size;++zn){var Zt=gt.name.replace("[0]","["+zn+"]");Et(En,new Ke(Zt,Y.id(Zt),O.getUniformLocation(jt,Zt),gt))}else Et(En,new Ke(gt.name,Y.id(gt.name),O.getUniformLocation(jt,gt.name),gt));var Pt=O.getProgramParameter(jt,tv);$e.profile&&(Le.stats.attributesCount=Pt);var dt=Le.attributes;for(Qt=0;Qt<Pt;++Qt)gt=O.getActiveAttrib(jt,Qt),gt&&Et(dt,new Ke(gt.name,Y.id(gt.name),O.getAttribLocation(jt,gt.name),gt))}$e.profile&&(ge.getMaxUniformsCount=function(){var Le=0;return Mt.forEach(function(Ye){Ye.stats.uniformsCount>Le&&(Le=Ye.stats.uniformsCount)}),Le},ge.getMaxAttributesCount=function(){var Le=0;return Mt.forEach(function(Ye){Ye.stats.attributesCount>Le&&(Le=Ye.stats.attributesCount)}),Le});function Bt(){ot={},He={};for(var Le=0;Le<Mt.length;++Le)_t(Mt[Le],null,Mt[Le].attributes.map(function(Ye){return[Ye.location,Ye.name]}))}return{clear:function(){var Le=O.deleteShader.bind(O);$i(ot).forEach(Le),ot={},$i(He).forEach(Le),He={},Mt.forEach(function(Ye){O.deleteProgram(Ye.program)}),Mt.length=0,Lt={},ge.shaderCount=0},program:function(Le,Ye,Gt,Qt){J.command(Le>=0,"missing vertex shader",Gt),J.command(Ye>=0,"missing fragment shader",Gt);var gt=Lt[Ye];gt||(gt=Lt[Ye]={});var en=gt[Le];if(en&&(en.refCount++,!Qt))return en;var yt=new Wt(Ye,Le);return ge.shaderCount++,_t(yt,Gt,Qt),en||(gt[Le]=yt),Mt.push(yt),w(yt,{destroy:function(){if(yt.refCount--,yt.refCount<=0){O.deleteProgram(yt.program);var jt=Mt.indexOf(yt);Mt.splice(jt,1),ge.shaderCount--}gt[yt.vertId].refCount<=0&&(O.deleteShader(He[yt.vertId]),delete He[yt.vertId],delete Lt[yt.fragId][yt.vertId]),Object.keys(Lt[yt.fragId]).length||(O.deleteShader(ot[yt.fragId]),delete ot[yt.fragId],delete Lt[yt.fragId])}})},restore:Bt,shader:Dt,frag:-1,vert:-1}}var Lx=6408,ud=5121,Gx=3333,Zh=5126;function tc(O,Y,ge,$e,ot,He,Ke){function Et(Mt){var Ut;Y.next===null?(J(ot.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Ut=ud):(J(Y.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Ut=Y.next.colorAttachments[0].texture._texture.type,He.oes_texture_float?(J(Ut===ud||Ut===Zh,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Ut===Zh&&J(Ke.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):J(Ut===ud,"Reading from a framebuffer is only allowed for the type 'uint8'"));var Wt=0,_t=0,Bt=$e.framebufferWidth,Le=$e.framebufferHeight,Ye=null;N(Mt)?Ye=Mt:Mt&&(J.type(Mt,"object","invalid arguments to regl.read()"),Wt=Mt.x|0,_t=Mt.y|0,J(Wt>=0&&Wt<$e.framebufferWidth,"invalid x offset for regl.read"),J(_t>=0&&_t<$e.framebufferHeight,"invalid y offset for regl.read"),Bt=(Mt.width||$e.framebufferWidth-Wt)|0,Le=(Mt.height||$e.framebufferHeight-_t)|0,Ye=Mt.data||null),Ye&&(Ut===ud?J(Ye instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Ut===Zh&&J(Ye instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),J(Bt>0&&Bt+Wt<=$e.framebufferWidth,"invalid width for read pixels"),J(Le>0&&Le+_t<=$e.framebufferHeight,"invalid height for read pixels"),ge();var Gt=Bt*Le*4;return Ye||(Ut===ud?Ye=new Uint8Array(Gt):Ut===Zh&&(Ye=Ye||new Float32Array(Gt))),J.isTypedArray(Ye,"data buffer for regl.read() must be a typedarray"),J(Ye.byteLength>=Gt,"data buffer for regl.read() too small"),O.pixelStorei(Gx,4),O.readPixels(Wt,_t,Bt,Le,Lx,Ut,Ye),Ye}function Dt(Mt){var Ut;return Y.setFBO({framebuffer:Mt.framebuffer},function(){Ut=Et(Mt)}),Ut}function Lt(Mt){return!Mt||!("framebuffer"in Mt)?Et(Mt):Dt(Mt)}return Lt}function qs(O){return Array.prototype.slice.call(O)}function Xc(O){return qs(O).join("")}function nv(){var O=0,Y=[],ge=[];function $e(Ut){for(var Wt=0;Wt<ge.length;++Wt)if(ge[Wt]===Ut)return Y[Wt];var _t="g"+O++;return Y.push(_t),ge.push(Ut),_t}function ot(){var Ut=[];function Wt(){Ut.push.apply(Ut,qs(arguments))}var _t=[];function Bt(){var Le="v"+O++;return _t.push(Le),arguments.length>0&&(Ut.push(Le,"="),Ut.push.apply(Ut,qs(arguments)),Ut.push(";")),Le}return w(Wt,{def:Bt,toString:function(){return Xc([_t.length>0?"var "+_t.join(",")+";":"",Xc(Ut)])}})}function He(){var Ut=ot(),Wt=ot(),_t=Ut.toString,Bt=Wt.toString;function Le(Ye,Gt){Wt(Ye,Gt,"=",Ut.def(Ye,Gt),";")}return w(function(){Ut.apply(Ut,qs(arguments))},{def:Ut.def,entry:Ut,exit:Wt,save:Le,set:function(Ye,Gt,Qt){Le(Ye,Gt),Ut(Ye,Gt,"=",Qt,";")},toString:function(){return _t()+Bt()}})}function Ke(){var Ut=Xc(arguments),Wt=He(),_t=He(),Bt=Wt.toString,Le=_t.toString;return w(Wt,{then:function(){return Wt.apply(Wt,qs(arguments)),this},else:function(){return _t.apply(_t,qs(arguments)),this},toString:function(){var Ye=Le();return Ye&&(Ye="else{"+Ye+"}"),Xc(["if(",Ut,"){",Bt(),"}",Ye])}})}var Et=ot(),Dt={};function Lt(Ut,Wt){var _t=[];function Bt(){var gt="a"+_t.length;return _t.push(gt),gt}Wt=Wt||0;for(var Le=0;Le<Wt;++Le)Bt();var Ye=He(),Gt=Ye.toString,Qt=Dt[Ut]=w(Ye,{arg:Bt,toString:function(){return Xc(["function(",_t.join(),"){",Gt(),"}"])}});return Qt}function Mt(){var Ut=['"use strict";',Et,"return {"];Object.keys(Dt).forEach(function(Bt){Ut.push('"',Bt,'":',Dt[Bt].toString(),",")}),Ut.push("}");var Wt=Xc(Ut).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),_t=Function.apply(null,Y.concat(Wt));return _t.apply(null,ge)}return{global:Et,link:$e,block:ot,proc:Lt,scope:He,cond:Ke,compile:Mt}}var nc="xyzw".split(""),dd=5121,Yc=1,Xh=2,og=0,sg=1,Yh=2,hd=3,Kh=4,rv=5,iv=6,ov="dither",yo="blend.enable",sv="blend.color",qh="blend.equation",ag="blend.func",av="depth.enable",lv="depth.func",lg="depth.range",cv="depth.mask",cg="colorMask",uv="cull.enable",dv="cull.face",ug="frontFace",fd="lineWidth",pd="polygonOffset.enable",dg="polygonOffset.offset",hg="sample.alpha",hv="sample.enable",Jh="sample.coverage",fg="stencil.enable",fv="stencil.mask",pg="stencil.func",gg="stencil.opFront",gd="stencil.opBack",pv="scissor.enable",md="scissor.box",Js="viewport",vd="profile",rc="framebuffer",yd="vert",bd="frag",ic="elements",Da="primitive",oc="count",Qh="offset",hl="instances",xd="vao",mg="Width",vg="Height",fl=rc+mg,Kc=rc+vg,Fx=Js+mg,Bx=Js+vg,gv="drawingBuffer",mv=gv+mg,yg=gv+vg,zx=[ag,qh,pg,gg,gd,Jh,Js,md,dg],qc=34962,Ux=34963,Vx=35632,jx=35633,vv=3553,Hx=34067,$x=2884,Wx=3042,Zx=3024,Xx=2960,sc=2929,Yx=3089,bg=32823,Kx=32926,ef=32928,xg=5126,tf=35664,nf=35665,rf=35666,Cg=5124,of=35667,sf=35668,af=35669,wg=35670,Cd=35671,lf=35672,cf=35673,wd=35674,Ed=35675,Sd=35676,_d=35678,Ad=35680,yv=4,Td=1028,ac=1029,bv=2304,xv=2305,Cv=32775,qx=32776,Jx=519,pl=7680,wv=0,Ev=1,Jc=32774,Qx=513,Sv=36160,eC=36064,Bs={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},_v=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Qc={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},gl={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Av={frag:Vx,vert:jx},Eg={cw:bv,ccw:xv};function uf(O){return Array.isArray(O)||N(O)||go(O)}function Tv(O){return O.sort(function(Y,ge){return Y===Js?-1:ge===Js?1:Y<ge?-1:1})}function es(O,Y,ge,$e){this.thisDep=O,this.contextDep=Y,this.propDep=ge,this.append=$e}function ml(O){return O&&!(O.thisDep||O.contextDep||O.propDep)}function ji(O){return new es(!1,!1,!1,O)}function ls(O,Y){var ge=O.type;if(ge===og){var $e=O.data.length;return new es(!0,$e>=1,$e>=2,Y)}else if(ge===Kh){var ot=O.data;return new es(ot.thisDep,ot.contextDep,ot.propDep,Y)}else{if(ge===rv)return new es(!1,!1,!1,Y);if(ge===iv){for(var He=!1,Ke=!1,Et=!1,Dt=0;Dt<O.data.length;++Dt){var Lt=O.data[Dt];if(Lt.type===sg)Et=!0;else if(Lt.type===Yh)Ke=!0;else if(Lt.type===hd)He=!0;else if(Lt.type===og){He=!0;var Mt=Lt.data;Mt>=1&&(Ke=!0),Mt>=2&&(Et=!0)}else Lt.type===Kh&&(He=He||Lt.data.thisDep,Ke=Ke||Lt.data.contextDep,Et=Et||Lt.data.propDep)}return new es(He,Ke,Et,Y)}else return new es(ge===hd,ge===Yh,ge===sg,Y)}}var Sg=new es(!1,!1,!1,function(){});function tC(O,Y,ge,$e,ot,He,Ke,Et,Dt,Lt,Mt,Ut,Wt,_t,Bt){var Le=Lt.Record,Ye={add:32774,subtract:32778,"reverse subtract":32779};ge.ext_blend_minmax&&(Ye.min=Cv,Ye.max=qx);var Gt=ge.angle_instanced_arrays,Qt=ge.webgl_draw_buffers,gt={dirty:!0,profile:Bt.profile},en={},yt=[],jt={},vt={};function Rt(ie){return ie.replace(".","_")}function En(ie,Z,be){var Ie=Rt(ie);yt.push(ie),en[Ie]=gt[Ie]=!!be,jt[Ie]=Z}function zn(ie,Z,be){var Ie=Rt(ie);yt.push(ie),Array.isArray(be)?(gt[Ie]=be.slice(),en[Ie]=be.slice()):gt[Ie]=en[Ie]=be,vt[Ie]=Z}En(ov,Zx),En(yo,Wx),zn(sv,"blendColor",[0,0,0,0]),zn(qh,"blendEquationSeparate",[Jc,Jc]),zn(ag,"blendFuncSeparate",[Ev,wv,Ev,wv]),En(av,sc,!0),zn(lv,"depthFunc",Qx),zn(lg,"depthRange",[0,1]),zn(cv,"depthMask",!0),zn(cg,cg,[!0,!0,!0,!0]),En(uv,$x),zn(dv,"cullFace",ac),zn(ug,ug,xv),zn(fd,fd,1),En(pd,bg),zn(dg,"polygonOffset",[0,0]),En(hg,Kx),En(hv,ef),zn(Jh,"sampleCoverage",[1,!1]),En(fg,Xx),zn(fv,"stencilMask",-1),zn(pg,"stencilFunc",[Jx,0,-1]),zn(gg,"stencilOpSeparate",[Td,pl,pl,pl]),zn(gd,"stencilOpSeparate",[ac,pl,pl,pl]),En(pv,Yx),zn(md,"scissor",[0,0,O.drawingBufferWidth,O.drawingBufferHeight]),zn(Js,Js,[0,0,O.drawingBufferWidth,O.drawingBufferHeight]);var Zt={gl:O,context:Wt,strings:Y,next:en,current:gt,draw:Ut,elements:He,buffer:ot,shader:Mt,attributes:Lt.state,vao:Lt,uniforms:Dt,framebuffer:Et,extensions:ge,timer:_t,isBufferArgs:uf},Pt={primTypes:_,compareFuncs:Qc,blendFuncs:Bs,blendEquations:Ye,stencilOps:gl,glTypes:ua,orientationType:Eg};J.optional(function(){Zt.isArrayLike=Jn}),Qt&&(Pt.backBuffer=[ac],Pt.drawBuffer=Ui($e.maxDrawbuffers,function(ie){return ie===0?[0]:Ui(ie,function(Z){return eC+Z})}));var dt=0;function kn(){var ie=nv(),Z=ie.link,be=ie.global;ie.id=dt++,ie.batchId="0";var Ie=Z(Zt),Ge=ie.shared={props:"a0"};Object.keys(Zt).forEach(function(ye){Ge[ye]=be.def(Ie,".",ye)}),J.optional(function(){ie.CHECK=Z(J),ie.commandStr=J.guessCommand(),ie.command=Z(ie.commandStr),ie.assert=function(ye,te,Re){ye("if(!(",te,"))",this.CHECK,".commandRaise(",Z(Re),",",this.command,");")},Pt.invalidBlendCombinations=_v});var _e=ie.next={},Ce=ie.current={};Object.keys(vt).forEach(function(ye){Array.isArray(gt[ye])&&(_e[ye]=be.def(Ge.next,".",ye),Ce[ye]=be.def(Ge.current,".",ye))});var Ne=ie.constants={};Object.keys(Pt).forEach(function(ye){Ne[ye]=be.def(JSON.stringify(Pt[ye]))}),ie.invoke=function(ye,te){switch(te.type){case og:var Re=["this",Ge.context,Ge.props,ie.batchId];return ye.def(Z(te.data),".call(",Re.slice(0,Math.max(te.data.length+1,4)),")");case sg:return ye.def(Ge.props,te.data);case Yh:return ye.def(Ge.context,te.data);case hd:return ye.def("this",te.data);case Kh:return te.data.append(ie,ye),te.data.ref;case rv:return te.data.toString();case iv:return te.data.map(function(ze){return ie.invoke(ye,ze)})}},ie.attribCache={};var oe={};return ie.scopeAttrib=function(ye){var te=Y.id(ye);if(te in oe)return oe[te];var Re=Lt.scope[te];Re||(Re=Lt.scope[te]=new Le);var ze=oe[te]=Z(Re);return ze},ie}function er(ie){var Z=ie.static,be=ie.dynamic,Ie;if(vd in Z){var Ge=!!Z[vd];Ie=ji(function(Ce,Ne){return Ge}),Ie.enable=Ge}else if(vd in be){var _e=be[vd];Ie=ls(_e,function(Ce,Ne){return Ce.invoke(Ne,_e)})}return Ie}function ln(ie,Z){var be=ie.static,Ie=ie.dynamic;if(rc in be){var Ge=be[rc];return Ge?(Ge=Et.getFramebuffer(Ge),J.command(Ge,"invalid framebuffer object"),ji(function(Ce,Ne){var oe=Ce.link(Ge),ye=Ce.shared;Ne.set(ye.framebuffer,".next",oe);var te=ye.context;return Ne.set(te,"."+fl,oe+".width"),Ne.set(te,"."+Kc,oe+".height"),oe})):ji(function(Ce,Ne){var oe=Ce.shared;Ne.set(oe.framebuffer,".next","null");var ye=oe.context;return Ne.set(ye,"."+fl,ye+"."+mv),Ne.set(ye,"."+Kc,ye+"."+yg),"null"})}else if(rc in Ie){var _e=Ie[rc];return ls(_e,function(Ce,Ne){var oe=Ce.invoke(Ne,_e),ye=Ce.shared,te=ye.framebuffer,Re=Ne.def(te,".getFramebuffer(",oe,")");J.optional(function(){Ce.assert(Ne,"!"+oe+"||"+Re,"invalid framebuffer object")}),Ne.set(te,".next",Re);var ze=ye.context;return Ne.set(ze,"."+fl,Re+"?"+Re+".width:"+ze+"."+mv),Ne.set(ze,"."+Kc,Re+"?"+Re+".height:"+ze+"."+yg),Re})}else return null}function ar(ie,Z,be){var Ie=ie.static,Ge=ie.dynamic;function _e(oe){if(oe in Ie){var ye=Ie[oe];J.commandType(ye,"object","invalid "+oe,be.commandStr);var te=!0,Re=ye.x|0,ze=ye.y|0,rt,st;return"width"in ye?(rt=ye.width|0,J.command(rt>=0,"invalid "+oe,be.commandStr)):te=!1,"height"in ye?(st=ye.height|0,J.command(st>=0,"invalid "+oe,be.commandStr)):te=!1,new es(!te&&Z&&Z.thisDep,!te&&Z&&Z.contextDep,!te&&Z&&Z.propDep,function(mn,tr){var cn=mn.shared.context,An=rt;"width"in ye||(An=tr.def(cn,".",fl,"-",Re));var Yn=st;return"height"in ye||(Yn=tr.def(cn,".",Kc,"-",ze)),[Re,ze,An,Yn]})}else if(oe in Ge){var Je=Ge[oe],kt=ls(Je,function(mn,tr){var cn=mn.invoke(tr,Je);J.optional(function(){mn.assert(tr,cn+"&&typeof "+cn+'==="object"',"invalid "+oe)});var An=mn.shared.context,Yn=tr.def(cn,".x|0"),Gr=tr.def(cn,".y|0"),Pi=tr.def('"width" in ',cn,"?",cn,".width|0:","(",An,".",fl,"-",Yn,")"),ts=tr.def('"height" in ',cn,"?",cn,".height|0:","(",An,".",Kc,"-",Gr,")");return J.optional(function(){mn.assert(tr,Pi+">=0&&"+ts+">=0","invalid "+oe)}),[Yn,Gr,Pi,ts]});return Z&&(kt.thisDep=kt.thisDep||Z.thisDep,kt.contextDep=kt.contextDep||Z.contextDep,kt.propDep=kt.propDep||Z.propDep),kt}else return Z?new es(Z.thisDep,Z.contextDep,Z.propDep,function(mn,tr){var cn=mn.shared.context;return[0,0,tr.def(cn,".",fl),tr.def(cn,".",Kc)]}):null}var Ce=_e(Js);if(Ce){var Ne=Ce;Ce=new es(Ce.thisDep,Ce.contextDep,Ce.propDep,function(oe,ye){var te=Ne.append(oe,ye),Re=oe.shared.context;return ye.set(Re,"."+Fx,te[2]),ye.set(Re,"."+Bx,te[3]),te})}return{viewport:Ce,scissor_box:_e(md)}}function Vn(ie,Z){var be=ie.static,Ie=typeof be[bd]=="string"&&typeof be[yd]=="string";if(Ie){if(Object.keys(Z.dynamic).length>0)return null;var Ge=Z.static,_e=Object.keys(Ge);if(_e.length>0&&typeof Ge[_e[0]]=="number"){for(var Ce=[],Ne=0;Ne<_e.length;++Ne)J(typeof Ge[_e[Ne]]=="number","must specify all vertex attribute locations when using vaos"),Ce.push([Ge[_e[Ne]]|0,_e[Ne]]);return Ce}}return null}function rr(ie,Z,be){var Ie=ie.static,Ge=ie.dynamic;function _e(te){if(te in Ie){var Re=Y.id(Ie[te]);J.optional(function(){Mt.shader(Av[te],Re,J.guessCommand())});var ze=ji(function(){return Re});return ze.id=Re,ze}else if(te in Ge){var rt=Ge[te];return ls(rt,function(st,Je){var kt=st.invoke(Je,rt),mn=Je.def(st.shared.strings,".id(",kt,")");return J.optional(function(){Je(st.shared.shader,".shader(",Av[te],",",mn,",",st.command,");")}),mn})}return null}var Ce=_e(bd),Ne=_e(yd),oe=null,ye;return ml(Ce)&&ml(Ne)?(oe=Mt.program(Ne.id,Ce.id,null,be),ye=ji(function(te,Re){return te.link(oe)})):ye=new es(Ce&&Ce.thisDep||Ne&&Ne.thisDep,Ce&&Ce.contextDep||Ne&&Ne.contextDep,Ce&&Ce.propDep||Ne&&Ne.propDep,function(te,Re){var ze=te.shared.shader,rt;Ce?rt=Ce.append(te,Re):rt=Re.def(ze,".",bd);var st;Ne?st=Ne.append(te,Re):st=Re.def(ze,".",yd);var Je=ze+".program("+st+","+rt;return J.optional(function(){Je+=","+te.command}),Re.def(Je+")")}),{frag:Ce,vert:Ne,progVar:ye,program:oe}}function Er(ie,Z){var be=ie.static,Ie=ie.dynamic;function Ge(){if(ic in be){var te=be[ic];uf(te)?te=He.getElements(He.create(te,!0)):te&&(te=He.getElements(te),J.command(te,"invalid elements",Z.commandStr));var Re=ji(function(rt,st){if(te){var Je=rt.link(te);return rt.ELEMENTS=Je,Je}return rt.ELEMENTS=null,null});return Re.value=te,Re}else if(ic in Ie){var ze=Ie[ic];return ls(ze,function(rt,st){var Je=rt.shared,kt=Je.isBufferArgs,mn=Je.elements,tr=rt.invoke(st,ze),cn=st.def("null"),An=st.def(kt,"(",tr,")"),Yn=rt.cond(An).then(cn,"=",mn,".createStream(",tr,");").else(cn,"=",mn,".getElements(",tr,");");return J.optional(function(){rt.assert(Yn.else,"!"+tr+"||"+cn,"invalid elements")}),st.entry(Yn),st.exit(rt.cond(An).then(mn,".destroyStream(",cn,");")),rt.ELEMENTS=cn,cn})}return null}var _e=Ge();function Ce(){if(Da in be){var te=be[Da];return J.commandParameter(te,_,"invalid primitve",Z.commandStr),ji(function(ze,rt){return _[te]})}else if(Da in Ie){var Re=Ie[Da];return ls(Re,function(ze,rt){var st=ze.constants.primTypes,Je=ze.invoke(rt,Re);return J.optional(function(){ze.assert(rt,Je+" in "+st,"invalid primitive, must be one of "+Object.keys(_))}),rt.def(st,"[",Je,"]")})}else if(_e)return ml(_e)?_e.value?ji(function(ze,rt){return rt.def(ze.ELEMENTS,".primType")}):ji(function(){return yv}):new es(_e.thisDep,_e.contextDep,_e.propDep,function(ze,rt){var st=ze.ELEMENTS;return rt.def(st,"?",st,".primType:",yv)});return null}function Ne(te,Re){if(te in be){var ze=be[te]|0;return J.command(!Re||ze>=0,"invalid "+te,Z.commandStr),ji(function(st,Je){return Re&&(st.OFFSET=ze),ze})}else if(te in Ie){var rt=Ie[te];return ls(rt,function(st,Je){var kt=st.invoke(Je,rt);return Re&&(st.OFFSET=kt,J.optional(function(){st.assert(Je,kt+">=0","invalid "+te)})),kt})}else if(Re&&_e)return ji(function(st,Je){return st.OFFSET="0",0});return null}var oe=Ne(Qh,!0);function ye(){if(oc in be){var te=be[oc]|0;return J.command(typeof te=="number"&&te>=0,"invalid vertex count",Z.commandStr),ji(function(){return te})}else if(oc in Ie){var Re=Ie[oc];return ls(Re,function(st,Je){var kt=st.invoke(Je,Re);return J.optional(function(){st.assert(Je,"typeof "+kt+'==="number"&&'+kt+">=0&&"+kt+"===("+kt+"|0)","invalid vertex count")}),kt})}else if(_e)if(ml(_e)){if(_e)return oe?new es(oe.thisDep,oe.contextDep,oe.propDep,function(st,Je){var kt=Je.def(st.ELEMENTS,".vertCount-",st.OFFSET);return J.optional(function(){st.assert(Je,kt+">=0","invalid vertex offset/element buffer too small")}),kt}):ji(function(st,Je){return Je.def(st.ELEMENTS,".vertCount")});var ze=ji(function(){return-1});return J.optional(function(){ze.MISSING=!0}),ze}else{var rt=new es(_e.thisDep||oe.thisDep,_e.contextDep||oe.contextDep,_e.propDep||oe.propDep,function(st,Je){var kt=st.ELEMENTS;return st.OFFSET?Je.def(kt,"?",kt,".vertCount-",st.OFFSET,":-1"):Je.def(kt,"?",kt,".vertCount:-1")});return J.optional(function(){rt.DYNAMIC=!0}),rt}return null}return{elements:_e,primitive:Ce(),count:ye(),instances:Ne(hl,!1),offset:oe}}function Hi(ie,Z){var be=ie.static,Ie=ie.dynamic,Ge={};return yt.forEach(function(_e){var Ce=Rt(_e);function Ne(oe,ye){if(_e in be){var te=oe(be[_e]);Ge[Ce]=ji(function(){return te})}else if(_e in Ie){var Re=Ie[_e];Ge[Ce]=ls(Re,function(ze,rt){return ye(ze,rt,ze.invoke(rt,Re))})}}switch(_e){case uv:case yo:case ov:case fg:case av:case pv:case pd:case hg:case hv:case cv:return Ne(function(oe){return J.commandType(oe,"boolean",_e,Z.commandStr),oe},function(oe,ye,te){return J.optional(function(){oe.assert(ye,"typeof "+te+'==="boolean"',"invalid flag "+_e,oe.commandStr)}),te});case lv:return Ne(function(oe){return J.commandParameter(oe,Qc,"invalid "+_e,Z.commandStr),Qc[oe]},function(oe,ye,te){var Re=oe.constants.compareFuncs;return J.optional(function(){oe.assert(ye,te+" in "+Re,"invalid "+_e+", must be one of "+Object.keys(Qc))}),ye.def(Re,"[",te,"]")});case lg:return Ne(function(oe){return J.command(Jn(oe)&&oe.length===2&&typeof oe[0]=="number"&&typeof oe[1]=="number"&&oe[0]<=oe[1],"depth range is 2d array",Z.commandStr),oe},function(oe,ye,te){J.optional(function(){oe.assert(ye,oe.shared.isArrayLike+"("+te+")&&"+te+".length===2&&typeof "+te+'[0]==="number"&&typeof '+te+'[1]==="number"&&'+te+"[0]<="+te+"[1]","depth range must be a 2d array")});var Re=ye.def("+",te,"[0]"),ze=ye.def("+",te,"[1]");return[Re,ze]});case ag:return Ne(function(oe){J.commandType(oe,"object","blend.func",Z.commandStr);var ye="srcRGB"in oe?oe.srcRGB:oe.src,te="srcAlpha"in oe?oe.srcAlpha:oe.src,Re="dstRGB"in oe?oe.dstRGB:oe.dst,ze="dstAlpha"in oe?oe.dstAlpha:oe.dst;return J.commandParameter(ye,Bs,Ce+".srcRGB",Z.commandStr),J.commandParameter(te,Bs,Ce+".srcAlpha",Z.commandStr),J.commandParameter(Re,Bs,Ce+".dstRGB",Z.commandStr),J.commandParameter(ze,Bs,Ce+".dstAlpha",Z.commandStr),J.command(_v.indexOf(ye+", "+Re)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+ye+", "+Re+")",Z.commandStr),[Bs[ye],Bs[Re],Bs[te],Bs[ze]]},function(oe,ye,te){var Re=oe.constants.blendFuncs;J.optional(function(){oe.assert(ye,te+"&&typeof "+te+'==="object"',"invalid blend func, must be an object")});function ze(cn,An){var Yn=ye.def('"',cn,An,'" in ',te,"?",te,".",cn,An,":",te,".",cn);return J.optional(function(){oe.assert(ye,Yn+" in "+Re,"invalid "+_e+"."+cn+An+", must be one of "+Object.keys(Bs))}),Yn}var rt=ze("src","RGB"),st=ze("dst","RGB");J.optional(function(){var cn=oe.constants.invalidBlendCombinations;oe.assert(ye,cn+".indexOf("+rt+'+", "+'+st+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var Je=ye.def(Re,"[",rt,"]"),kt=ye.def(Re,"[",ze("src","Alpha"),"]"),mn=ye.def(Re,"[",st,"]"),tr=ye.def(Re,"[",ze("dst","Alpha"),"]");return[Je,mn,kt,tr]});case qh:return Ne(function(oe){if(typeof oe=="string")return J.commandParameter(oe,Ye,"invalid "+_e,Z.commandStr),[Ye[oe],Ye[oe]];if(typeof oe=="object")return J.commandParameter(oe.rgb,Ye,_e+".rgb",Z.commandStr),J.commandParameter(oe.alpha,Ye,_e+".alpha",Z.commandStr),[Ye[oe.rgb],Ye[oe.alpha]];J.commandRaise("invalid blend.equation",Z.commandStr)},function(oe,ye,te){var Re=oe.constants.blendEquations,ze=ye.def(),rt=ye.def(),st=oe.cond("typeof ",te,'==="string"');return J.optional(function(){function Je(kt,mn,tr){oe.assert(kt,tr+" in "+Re,"invalid "+mn+", must be one of "+Object.keys(Ye))}Je(st.then,_e,te),oe.assert(st.else,te+"&&typeof "+te+'==="object"',"invalid "+_e),Je(st.else,_e+".rgb",te+".rgb"),Je(st.else,_e+".alpha",te+".alpha")}),st.then(ze,"=",rt,"=",Re,"[",te,"];"),st.else(ze,"=",Re,"[",te,".rgb];",rt,"=",Re,"[",te,".alpha];"),ye(st),[ze,rt]});case sv:return Ne(function(oe){return J.command(Jn(oe)&&oe.length===4,"blend.color must be a 4d array",Z.commandStr),Ui(4,function(ye){return+oe[ye]})},function(oe,ye,te){return J.optional(function(){oe.assert(ye,oe.shared.isArrayLike+"("+te+")&&"+te+".length===4","blend.color must be a 4d array")}),Ui(4,function(Re){return ye.def("+",te,"[",Re,"]")})});case fv:return Ne(function(oe){return J.commandType(oe,"number",Ce,Z.commandStr),oe|0},function(oe,ye,te){return J.optional(function(){oe.assert(ye,"typeof "+te+'==="number"',"invalid stencil.mask")}),ye.def(te,"|0")});case pg:return Ne(function(oe){J.commandType(oe,"object",Ce,Z.commandStr);var ye=oe.cmp||"keep",te=oe.ref||0,Re="mask"in oe?oe.mask:-1;return J.commandParameter(ye,Qc,_e+".cmp",Z.commandStr),J.commandType(te,"number",_e+".ref",Z.commandStr),J.commandType(Re,"number",_e+".mask",Z.commandStr),[Qc[ye],te,Re]},function(oe,ye,te){var Re=oe.constants.compareFuncs;J.optional(function(){function Je(){oe.assert(ye,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Je(te+"&&typeof ",te,'==="object"'),Je('!("cmp" in ',te,")||(",te,".cmp in ",Re,")")});var ze=ye.def('"cmp" in ',te,"?",Re,"[",te,".cmp]",":",pl),rt=ye.def(te,".ref|0"),st=ye.def('"mask" in ',te,"?",te,".mask|0:-1");return[ze,rt,st]});case gg:case gd:return Ne(function(oe){J.commandType(oe,"object",Ce,Z.commandStr);var ye=oe.fail||"keep",te=oe.zfail||"keep",Re=oe.zpass||"keep";return J.commandParameter(ye,gl,_e+".fail",Z.commandStr),J.commandParameter(te,gl,_e+".zfail",Z.commandStr),J.commandParameter(Re,gl,_e+".zpass",Z.commandStr),[_e===gd?ac:Td,gl[ye],gl[te],gl[Re]]},function(oe,ye,te){var Re=oe.constants.stencilOps;J.optional(function(){oe.assert(ye,te+"&&typeof "+te+'==="object"',"invalid "+_e)});function ze(rt){return J.optional(function(){oe.assert(ye,'!("'+rt+'" in '+te+")||("+te+"."+rt+" in "+Re+")","invalid "+_e+"."+rt+", must be one of "+Object.keys(gl))}),ye.def('"',rt,'" in ',te,"?",Re,"[",te,".",rt,"]:",pl)}return[_e===gd?ac:Td,ze("fail"),ze("zfail"),ze("zpass")]});case dg:return Ne(function(oe){J.commandType(oe,"object",Ce,Z.commandStr);var ye=oe.factor|0,te=oe.units|0;return J.commandType(ye,"number",Ce+".factor",Z.commandStr),J.commandType(te,"number",Ce+".units",Z.commandStr),[ye,te]},function(oe,ye,te){J.optional(function(){oe.assert(ye,te+"&&typeof "+te+'==="object"',"invalid "+_e)});var Re=ye.def(te,".factor|0"),ze=ye.def(te,".units|0");return[Re,ze]});case dv:return Ne(function(oe){var ye=0;return oe==="front"?ye=Td:oe==="back"&&(ye=ac),J.command(!!ye,Ce,Z.commandStr),ye},function(oe,ye,te){return J.optional(function(){oe.assert(ye,te+'==="front"||'+te+'==="back"',"invalid cull.face")}),ye.def(te,'==="front"?',Td,":",ac)});case fd:return Ne(function(oe){return J.command(typeof oe=="number"&&oe>=$e.lineWidthDims[0]&&oe<=$e.lineWidthDims[1],"invalid line width, must be a positive number between "+$e.lineWidthDims[0]+" and "+$e.lineWidthDims[1],Z.commandStr),oe},function(oe,ye,te){return J.optional(function(){oe.assert(ye,"typeof "+te+'==="number"&&'+te+">="+$e.lineWidthDims[0]+"&&"+te+"<="+$e.lineWidthDims[1],"invalid line width")}),te});case ug:return Ne(function(oe){return J.commandParameter(oe,Eg,Ce,Z.commandStr),Eg[oe]},function(oe,ye,te){return J.optional(function(){oe.assert(ye,te+'==="cw"||'+te+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),ye.def(te+'==="cw"?'+bv+":"+xv)});case cg:return Ne(function(oe){return J.command(Jn(oe)&&oe.length===4,"color.mask must be length 4 array",Z.commandStr),oe.map(function(ye){return!!ye})},function(oe,ye,te){return J.optional(function(){oe.assert(ye,oe.shared.isArrayLike+"("+te+")&&"+te+".length===4","invalid color.mask")}),Ui(4,function(Re){return"!!"+te+"["+Re+"]"})});case Jh:return Ne(function(oe){J.command(typeof oe=="object"&&oe,Ce,Z.commandStr);var ye="value"in oe?oe.value:1,te=!!oe.invert;return J.command(typeof ye=="number"&&ye>=0&&ye<=1,"sample.coverage.value must be a number between 0 and 1",Z.commandStr),[ye,te]},function(oe,ye,te){J.optional(function(){oe.assert(ye,te+"&&typeof "+te+'==="object"',"invalid sample.coverage")});var Re=ye.def('"value" in ',te,"?+",te,".value:1"),ze=ye.def("!!",te,".invert");return[Re,ze]})}}),Ge}function ir(ie,Z){var be=ie.static,Ie=ie.dynamic,Ge={};return Object.keys(be).forEach(function(_e){var Ce=be[_e],Ne;if(typeof Ce=="number"||typeof Ce=="boolean")Ne=ji(function(){return Ce});else if(typeof Ce=="function"){var oe=Ce._reglType;oe==="texture2d"||oe==="textureCube"?Ne=ji(function(ye){return ye.link(Ce)}):oe==="framebuffer"||oe==="framebufferCube"?(J.command(Ce.color.length>0,'missing color attachment for framebuffer sent to uniform "'+_e+'"',Z.commandStr),Ne=ji(function(ye){return ye.link(Ce.color[0])})):J.commandRaise('invalid data for uniform "'+_e+'"',Z.commandStr)}else Jn(Ce)?Ne=ji(function(ye){var te=ye.global.def("[",Ui(Ce.length,function(Re){return J.command(typeof Ce[Re]=="number"||typeof Ce[Re]=="boolean","invalid uniform "+_e,ye.commandStr),Ce[Re]}),"]");return te}):J.commandRaise('invalid or missing data for uniform "'+_e+'"',Z.commandStr);Ne.value=Ce,Ge[_e]=Ne}),Object.keys(Ie).forEach(function(_e){var Ce=Ie[_e];Ge[_e]=ls(Ce,function(Ne,oe){return Ne.invoke(oe,Ce)})}),Ge}function mr(ie,Z){var be=ie.static,Ie=ie.dynamic,Ge={};return Object.keys(be).forEach(function(_e){var Ce=be[_e],Ne=Y.id(_e),oe=new Le;if(uf(Ce))oe.state=Yc,oe.buffer=ot.getBuffer(ot.create(Ce,qc,!1,!0)),oe.type=0;else{var ye=ot.getBuffer(Ce);if(ye)oe.state=Yc,oe.buffer=ye,oe.type=0;else if(J.command(typeof Ce=="object"&&Ce,"invalid data for attribute "+_e,Z.commandStr),"constant"in Ce){var te=Ce.constant;oe.buffer="null",oe.state=Xh,typeof te=="number"?oe.x=te:(J.command(Jn(te)&&te.length>0&&te.length<=4,"invalid constant for attribute "+_e,Z.commandStr),nc.forEach(function(mn,tr){tr<te.length&&(oe[mn]=te[tr])}))}else{uf(Ce.buffer)?ye=ot.getBuffer(ot.create(Ce.buffer,qc,!1,!0)):ye=ot.getBuffer(Ce.buffer),J.command(!!ye,'missing buffer for attribute "'+_e+'"',Z.commandStr);var Re=Ce.offset|0;J.command(Re>=0,'invalid offset for attribute "'+_e+'"',Z.commandStr);var ze=Ce.stride|0;J.command(ze>=0&&ze<256,'invalid stride for attribute "'+_e+'", must be integer betweeen [0, 255]',Z.commandStr);var rt=Ce.size|0;J.command(!("size"in Ce)||rt>0&&rt<=4,'invalid size for attribute "'+_e+'", must be 1,2,3,4',Z.commandStr);var st=!!Ce.normalized,Je=0;"type"in Ce&&(J.commandParameter(Ce.type,ua,"invalid type for attribute "+_e,Z.commandStr),Je=ua[Ce.type]);var kt=Ce.divisor|0;"divisor"in Ce&&(J.command(kt===0||Gt,'cannot specify divisor for attribute "'+_e+'", instancing not supported',Z.commandStr),J.command(kt>=0,'invalid divisor for attribute "'+_e+'"',Z.commandStr)),J.optional(function(){var mn=Z.commandStr,tr=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Ce).forEach(function(cn){J.command(tr.indexOf(cn)>=0,'unknown parameter "'+cn+'" for attribute pointer "'+_e+'" (valid parameters are '+tr+")",mn)})}),oe.buffer=ye,oe.state=Yc,oe.size=rt,oe.normalized=st,oe.type=Je||ye.dtype,oe.offset=Re,oe.stride=ze,oe.divisor=kt}}Ge[_e]=ji(function(mn,tr){var cn=mn.attribCache;if(Ne in cn)return cn[Ne];var An={isStream:!1};return Object.keys(oe).forEach(function(Yn){An[Yn]=oe[Yn]}),oe.buffer&&(An.buffer=mn.link(oe.buffer),An.type=An.type||An.buffer+".dtype"),cn[Ne]=An,An})}),Object.keys(Ie).forEach(function(_e){var Ce=Ie[_e];function Ne(oe,ye){var te=oe.invoke(ye,Ce),Re=oe.shared,ze=oe.constants,rt=Re.isBufferArgs,st=Re.buffer;J.optional(function(){oe.assert(ye,te+"&&(typeof "+te+'==="object"||typeof '+te+'==="function")&&('+rt+"("+te+")||"+st+".getBuffer("+te+")||"+st+".getBuffer("+te+".buffer)||"+rt+"("+te+'.buffer)||("constant" in '+te+"&&(typeof "+te+'.constant==="number"||'+Re.isArrayLike+"("+te+".constant))))",'invalid dynamic attribute "'+_e+'"')});var Je={isStream:ye.def(!1)},kt=new Le;kt.state=Yc,Object.keys(kt).forEach(function(An){Je[An]=ye.def(""+kt[An])});var mn=Je.buffer,tr=Je.type;ye("if(",rt,"(",te,")){",Je.isStream,"=true;",mn,"=",st,".createStream(",qc,",",te,");",tr,"=",mn,".dtype;","}else{",mn,"=",st,".getBuffer(",te,");","if(",mn,"){",tr,"=",mn,".dtype;",'}else if("constant" in ',te,"){",Je.state,"=",Xh,";","if(typeof "+te+'.constant === "number"){',Je[nc[0]],"=",te,".constant;",nc.slice(1).map(function(An){return Je[An]}).join("="),"=0;","}else{",nc.map(function(An,Yn){return Je[An]+"="+te+".constant.length>"+Yn+"?"+te+".constant["+Yn+"]:0;"}).join(""),"}}else{","if(",rt,"(",te,".buffer)){",mn,"=",st,".createStream(",qc,",",te,".buffer);","}else{",mn,"=",st,".getBuffer(",te,".buffer);","}",tr,'="type" in ',te,"?",ze.glTypes,"[",te,".type]:",mn,".dtype;",Je.normalized,"=!!",te,".normalized;");function cn(An){ye(Je[An],"=",te,".",An,"|0;")}return cn("size"),cn("offset"),cn("stride"),cn("divisor"),ye("}}"),ye.exit("if(",Je.isStream,"){",st,".destroyStream(",mn,");","}"),Je}Ge[_e]=ls(Ce,Ne)}),Ge}function oo(ie,Z){var be=ie.static,Ie=ie.dynamic;if(xd in be){var Ge=be[xd];return Ge!==null&&Lt.getVAO(Ge)===null&&(Ge=Lt.createVAO(Ge)),ji(function(Ce){return Ce.link(Lt.getVAO(Ge))})}else if(xd in Ie){var _e=Ie[xd];return ls(_e,function(Ce,Ne){var oe=Ce.invoke(Ne,_e);return Ne.def(Ce.shared.vao+".getVAO("+oe+")")})}return null}function gi(ie){var Z=ie.static,be=ie.dynamic,Ie={};return Object.keys(Z).forEach(function(Ge){var _e=Z[Ge];Ie[Ge]=ji(function(Ce,Ne){return typeof _e=="number"||typeof _e=="boolean"?""+_e:Ce.link(_e)})}),Object.keys(be).forEach(function(Ge){var _e=be[Ge];Ie[Ge]=ls(_e,function(Ce,Ne){return Ce.invoke(Ne,_e)})}),Ie}function ri(ie,Z,be,Ie,Ge){var _e=ie.static,Ce=ie.dynamic;J.optional(function(){var cn=[rc,yd,bd,ic,Da,Qh,oc,hl,vd,xd].concat(yt);function An(Yn){Object.keys(Yn).forEach(function(Gr){J.command(cn.indexOf(Gr)>=0,'unknown parameter "'+Gr+'"',Ge.commandStr)})}An(_e),An(Ce)});var Ne=Vn(ie,Z),oe=ln(ie,Ge),ye=ar(ie,oe,Ge),te=Er(ie,Ge),Re=Hi(ie,Ge),ze=rr(ie,Ge,Ne);function rt(cn){var An=ye[cn];An&&(Re[cn]=An)}rt(Js),rt(Rt(md));var st=Object.keys(Re).length>0,Je={framebuffer:oe,draw:te,shader:ze,state:Re,dirty:st,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(Je.profile=er(ie,Ge),Je.uniforms=ir(be,Ge),Je.drawVAO=Je.scopeVAO=oo(ie,Ge),!Je.drawVAO&&ze.program&&!Ne&&ge.angle_instanced_arrays){var kt=!0,mn=ze.program.attributes.map(function(cn){var An=Z.static[cn];return kt=kt&&!!An,An});if(kt&&mn.length>0){var tr=Lt.getVAO(Lt.createVAO(mn));Je.drawVAO=new es(null,null,null,function(cn,An){return cn.link(tr)}),Je.useVAO=!0}}return Ne?Je.useVAO=!0:Je.attributes=mr(Z,Ge),Je.context=gi(Ie,Ge),Je}function Xi(ie,Z,be){var Ie=ie.shared,Ge=Ie.context,_e=ie.scope();Object.keys(be).forEach(function(Ce){Z.save(Ge,"."+Ce);var Ne=be[Ce],oe=Ne.append(ie,Z);Array.isArray(oe)?_e(Ge,".",Ce,"=[",oe.join(),"];"):_e(Ge,".",Ce,"=",oe,";")}),Z(_e)}function Yi(ie,Z,be,Ie){var Ge=ie.shared,_e=Ge.gl,Ce=Ge.framebuffer,Ne;Qt&&(Ne=Z.def(Ge.extensions,".webgl_draw_buffers"));var oe=ie.constants,ye=oe.drawBuffer,te=oe.backBuffer,Re;be?Re=be.append(ie,Z):Re=Z.def(Ce,".next"),Ie||Z("if(",Re,"!==",Ce,".cur){"),Z("if(",Re,"){",_e,".bindFramebuffer(",Sv,",",Re,".framebuffer);"),Qt&&Z(Ne,".drawBuffersWEBGL(",ye,"[",Re,".colorAttachments.length]);"),Z("}else{",_e,".bindFramebuffer(",Sv,",null);"),Qt&&Z(Ne,".drawBuffersWEBGL(",te,");"),Z("}",Ce,".cur=",Re,";"),Ie||Z("}")}function bo(ie,Z,be){var Ie=ie.shared,Ge=Ie.gl,_e=ie.current,Ce=ie.next,Ne=Ie.current,oe=Ie.next,ye=ie.cond(Ne,".dirty");yt.forEach(function(te){var Re=Rt(te);if(!(Re in be.state)){var ze,rt;if(Re in Ce){ze=Ce[Re],rt=_e[Re];var st=Ui(gt[Re].length,function(kt){return ye.def(ze,"[",kt,"]")});ye(ie.cond(st.map(function(kt,mn){return kt+"!=="+rt+"["+mn+"]"}).join("||")).then(Ge,".",vt[Re],"(",st,");",st.map(function(kt,mn){return rt+"["+mn+"]="+kt}).join(";"),";"))}else{ze=ye.def(oe,".",Re);var Je=ie.cond(ze,"!==",Ne,".",Re);ye(Je),Re in jt?Je(ie.cond(ze).then(Ge,".enable(",jt[Re],");").else(Ge,".disable(",jt[Re],");"),Ne,".",Re,"=",ze,";"):Je(Ge,".",vt[Re],"(",ze,");",Ne,".",Re,"=",ze,";")}}}),Object.keys(be.state).length===0&&ye(Ne,".dirty=false;"),Z(ye)}function So(ie,Z,be,Ie){var Ge=ie.shared,_e=ie.current,Ce=Ge.current,Ne=Ge.gl;Tv(Object.keys(be)).forEach(function(oe){var ye=be[oe];if(!(Ie&&!Ie(ye))){var te=ye.append(ie,Z);if(jt[oe]){var Re=jt[oe];ml(ye)?te?Z(Ne,".enable(",Re,");"):Z(Ne,".disable(",Re,");"):Z(ie.cond(te).then(Ne,".enable(",Re,");").else(Ne,".disable(",Re,");")),Z(Ce,".",oe,"=",te,";")}else if(Jn(te)){var ze=_e[oe];Z(Ne,".",vt[oe],"(",te,");",te.map(function(rt,st){return ze+"["+st+"]="+rt}).join(";"),";")}else Z(Ne,".",vt[oe],"(",te,");",Ce,".",oe,"=",te,";")}})}function Ri(ie,Z){Gt&&(ie.instancing=Z.def(ie.shared.extensions,".angle_instanced_arrays"))}function Qn(ie,Z,be,Ie,Ge){var _e=ie.shared,Ce=ie.stats,Ne=_e.current,oe=_e.timer,ye=be.profile;function te(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var Re,ze;function rt(cn){Re=Z.def(),cn(Re,"=",te(),";"),typeof Ge=="string"?cn(Ce,".count+=",Ge,";"):cn(Ce,".count++;"),_t&&(Ie?(ze=Z.def(),cn(ze,"=",oe,".getNumPendingQueries();")):cn(oe,".beginQuery(",Ce,");"))}function st(cn){cn(Ce,".cpuTime+=",te(),"-",Re,";"),_t&&(Ie?cn(oe,".pushScopeStats(",ze,",",oe,".getNumPendingQueries(),",Ce,");"):cn(oe,".endQuery();"))}function Je(cn){var An=Z.def(Ne,".profile");Z(Ne,".profile=",cn,";"),Z.exit(Ne,".profile=",An,";")}var kt;if(ye){if(ml(ye)){ye.enable?(rt(Z),st(Z.exit),Je("true")):Je("false");return}kt=ye.append(ie,Z),Je(kt)}else kt=Z.def(Ne,".profile");var mn=ie.block();rt(mn),Z("if(",kt,"){",mn,"}");var tr=ie.block();st(tr),Z.exit("if(",kt,"){",tr,"}")}function _o(ie,Z,be,Ie,Ge){var _e=ie.shared;function Ce(oe){switch(oe){case tf:case of:case Cd:return 2;case nf:case sf:case lf:return 3;case rf:case af:case cf:return 4;default:return 1}}function Ne(oe,ye,te){var Re=_e.gl,ze=Z.def(oe,".location"),rt=Z.def(_e.attributes,"[",ze,"]"),st=te.state,Je=te.buffer,kt=[te.x,te.y,te.z,te.w],mn=["buffer","normalized","offset","stride"];function tr(){Z("if(!",rt,".buffer){",Re,".enableVertexAttribArray(",ze,");}");var An=te.type,Yn;if(te.size?Yn=Z.def(te.size,"||",ye):Yn=ye,Z("if(",rt,".type!==",An,"||",rt,".size!==",Yn,"||",mn.map(function(Pi){return rt+"."+Pi+"!=="+te[Pi]}).join("||"),"){",Re,".bindBuffer(",qc,",",Je,".buffer);",Re,".vertexAttribPointer(",[ze,Yn,An,te.normalized,te.stride,te.offset],");",rt,".type=",An,";",rt,".size=",Yn,";",mn.map(function(Pi){return rt+"."+Pi+"="+te[Pi]+";"}).join(""),"}"),Gt){var Gr=te.divisor;Z("if(",rt,".divisor!==",Gr,"){",ie.instancing,".vertexAttribDivisorANGLE(",[ze,Gr],");",rt,".divisor=",Gr,";}")}}function cn(){Z("if(",rt,".buffer){",Re,".disableVertexAttribArray(",ze,");",rt,".buffer=null;","}if(",nc.map(function(An,Yn){return rt+"."+An+"!=="+kt[Yn]}).join("||"),"){",Re,".vertexAttrib4f(",ze,",",kt,");",nc.map(function(An,Yn){return rt+"."+An+"="+kt[Yn]+";"}).join(""),"}")}st===Yc?tr():st===Xh?cn():(Z("if(",st,"===",Yc,"){"),tr(),Z("}else{"),cn(),Z("}"))}Ie.forEach(function(oe){var ye=oe.name,te=be.attributes[ye],Re;if(te){if(!Ge(te))return;Re=te.append(ie,Z)}else{if(!Ge(Sg))return;var ze=ie.scopeAttrib(ye);J.optional(function(){ie.assert(Z,ze+".state","missing attribute "+ye)}),Re={},Object.keys(new Le).forEach(function(rt){Re[rt]=Z.def(ze,".",rt)})}Ne(ie.link(oe),Ce(oe.info.type),Re)})}function Hr(ie,Z,be,Ie,Ge){for(var _e=ie.shared,Ce=_e.gl,Ne,oe=0;oe<Ie.length;++oe){var ye=Ie[oe],te=ye.name,Re=ye.info.type,ze=be.uniforms[te],rt=ie.link(ye),st=rt+".location",Je;if(ze){if(!Ge(ze))continue;if(ml(ze)){var kt=ze.value;if(J.command(kt!==null&&typeof kt!="undefined",'missing uniform "'+te+'"',ie.commandStr),Re===_d||Re===Ad){J.command(typeof kt=="function"&&(Re===_d&&(kt._reglType==="texture2d"||kt._reglType==="framebuffer")||Re===Ad&&(kt._reglType==="textureCube"||kt._reglType==="framebufferCube")),"invalid texture for uniform "+te,ie.commandStr);var mn=ie.link(kt._texture||kt.color[0]._texture);Z(Ce,".uniform1i(",st,",",mn+".bind());"),Z.exit(mn,".unbind();")}else if(Re===wd||Re===Ed||Re===Sd){J.optional(function(){J.command(Jn(kt),"invalid matrix for uniform "+te,ie.commandStr),J.command(Re===wd&&kt.length===4||Re===Ed&&kt.length===9||Re===Sd&&kt.length===16,"invalid length for matrix uniform "+te,ie.commandStr)});var tr=ie.global.def("new Float32Array(["+Array.prototype.slice.call(kt)+"])"),cn=2;Re===Ed?cn=3:Re===Sd&&(cn=4),Z(Ce,".uniformMatrix",cn,"fv(",st,",false,",tr,");")}else{switch(Re){case xg:J.commandType(kt,"number","uniform "+te,ie.commandStr),Ne="1f";break;case tf:J.command(Jn(kt)&&kt.length===2,"uniform "+te,ie.commandStr),Ne="2f";break;case nf:J.command(Jn(kt)&&kt.length===3,"uniform "+te,ie.commandStr),Ne="3f";break;case rf:J.command(Jn(kt)&&kt.length===4,"uniform "+te,ie.commandStr),Ne="4f";break;case wg:J.commandType(kt,"boolean","uniform "+te,ie.commandStr),Ne="1i";break;case Cg:J.commandType(kt,"number","uniform "+te,ie.commandStr),Ne="1i";break;case Cd:J.command(Jn(kt)&&kt.length===2,"uniform "+te,ie.commandStr),Ne="2i";break;case of:J.command(Jn(kt)&&kt.length===2,"uniform "+te,ie.commandStr),Ne="2i";break;case lf:J.command(Jn(kt)&&kt.length===3,"uniform "+te,ie.commandStr),Ne="3i";break;case sf:J.command(Jn(kt)&&kt.length===3,"uniform "+te,ie.commandStr),Ne="3i";break;case cf:J.command(Jn(kt)&&kt.length===4,"uniform "+te,ie.commandStr),Ne="4i";break;case af:J.command(Jn(kt)&&kt.length===4,"uniform "+te,ie.commandStr),Ne="4i";break}Z(Ce,".uniform",Ne,"(",st,",",Jn(kt)?Array.prototype.slice.call(kt):kt,");")}continue}else Je=ze.append(ie,Z)}else{if(!Ge(Sg))continue;Je=Z.def(_e.uniforms,"[",Y.id(te),"]")}Re===_d?(J(!Array.isArray(Je),"must specify a scalar prop for textures"),Z("if(",Je,"&&",Je,'._reglType==="framebuffer"){',Je,"=",Je,".color[0];","}")):Re===Ad&&(J(!Array.isArray(Je),"must specify a scalar prop for cube maps"),Z("if(",Je,"&&",Je,'._reglType==="framebufferCube"){',Je,"=",Je,".color[0];","}")),J.optional(function(){function ts(Qs,Rv){ie.assert(Z,Qs,'bad data or missing for uniform "'+te+'".  '+Rv)}function Tg(Qs){J(!Array.isArray(Je),"must not specify an array type for uniform"),ts("typeof "+Je+'==="'+Qs+'"',"invalid type, expected "+Qs)}function zs(Qs,Rv){Array.isArray(Je)?J(Je.length===Qs,"must have length "+Qs):ts(_e.isArrayLike+"("+Je+")&&"+Je+".length==="+Qs,"invalid vector, should have length "+Qs,ie.commandStr)}function Nv(Qs){J(!Array.isArray(Je),"must not specify a value type"),ts("typeof "+Je+'==="function"&&'+Je+'._reglType==="texture'+(Qs===vv?"2d":"Cube")+'"',"invalid texture type",ie.commandStr)}switch(Re){case Cg:Tg("number");break;case of:zs(2,"number");break;case sf:zs(3,"number");break;case af:zs(4,"number");break;case xg:Tg("number");break;case tf:zs(2,"number");break;case nf:zs(3,"number");break;case rf:zs(4,"number");break;case wg:Tg("boolean");break;case Cd:zs(2,"boolean");break;case lf:zs(3,"boolean");break;case cf:zs(4,"boolean");break;case wd:zs(4,"number");break;case Ed:zs(9,"number");break;case Sd:zs(16,"number");break;case _d:Nv(vv);break;case Ad:Nv(Hx);break}});var An=1;switch(Re){case _d:case Ad:var Yn=Z.def(Je,"._texture");Z(Ce,".uniform1i(",st,",",Yn,".bind());"),Z.exit(Yn,".unbind();");continue;case Cg:case wg:Ne="1i";break;case of:case Cd:Ne="2i",An=2;break;case sf:case lf:Ne="3i",An=3;break;case af:case cf:Ne="4i",An=4;break;case xg:Ne="1f";break;case tf:Ne="2f",An=2;break;case nf:Ne="3f",An=3;break;case rf:Ne="4f",An=4;break;case wd:Ne="Matrix2fv";break;case Ed:Ne="Matrix3fv";break;case Sd:Ne="Matrix4fv";break}if(Z(Ce,".uniform",Ne,"(",st,","),Ne.charAt(0)==="M"){var Gr=Math.pow(Re-wd+2,2),Pi=ie.global.def("new Float32Array(",Gr,")");Array.isArray(Je)?Z("false,(",Ui(Gr,function(ts){return Pi+"["+ts+"]="+Je[ts]}),",",Pi,")"):Z("false,(Array.isArray(",Je,")||",Je," instanceof Float32Array)?",Je,":(",Ui(Gr,function(ts){return Pi+"["+ts+"]="+Je+"["+ts+"]"}),",",Pi,")")}else An>1?Z(Ui(An,function(ts){return Array.isArray(Je)?Je[ts]:Je+"["+ts+"]"})):(J(!Array.isArray(Je),"uniform value must not be an array"),Z(Je));Z(");")}}function _n(ie,Z,be,Ie){var Ge=ie.shared,_e=Ge.gl,Ce=Ge.draw,Ne=Ie.draw;function oe(){var Yn=Ne.elements,Gr,Pi=Z;return Yn?((Yn.contextDep&&Ie.contextDynamic||Yn.propDep)&&(Pi=be),Gr=Yn.append(ie,Pi)):Gr=Pi.def(Ce,".",ic),Gr&&Pi("if("+Gr+")"+_e+".bindBuffer("+Ux+","+Gr+".buffer.buffer);"),Gr}function ye(){var Yn=Ne.count,Gr,Pi=Z;return Yn?((Yn.contextDep&&Ie.contextDynamic||Yn.propDep)&&(Pi=be),Gr=Yn.append(ie,Pi),J.optional(function(){Yn.MISSING&&ie.assert(Z,"false","missing vertex count"),Yn.DYNAMIC&&ie.assert(Pi,Gr+">=0","missing vertex count")})):(Gr=Pi.def(Ce,".",oc),J.optional(function(){ie.assert(Pi,Gr+">=0","missing vertex count")})),Gr}var te=oe();function Re(Yn){var Gr=Ne[Yn];return Gr?Gr.contextDep&&Ie.contextDynamic||Gr.propDep?Gr.append(ie,be):Gr.append(ie,Z):Z.def(Ce,".",Yn)}var ze=Re(Da),rt=Re(Qh),st=ye();if(typeof st=="number"){if(st===0)return}else be("if(",st,"){"),be.exit("}");var Je,kt;Gt&&(Je=Re(hl),kt=ie.instancing);var mn=te+".type",tr=Ne.elements&&ml(Ne.elements);function cn(){function Yn(){be(kt,".drawElementsInstancedANGLE(",[ze,st,mn,rt+"<<(("+mn+"-"+dd+")>>1)",Je],");")}function Gr(){be(kt,".drawArraysInstancedANGLE(",[ze,rt,st,Je],");")}te?tr?Yn():(be("if(",te,"){"),Yn(),be("}else{"),Gr(),be("}")):Gr()}function An(){function Yn(){be(_e+".drawElements("+[ze,st,mn,rt+"<<(("+mn+"-"+dd+")>>1)"]+");")}function Gr(){be(_e+".drawArrays("+[ze,rt,st]+");")}te?tr?Yn():(be("if(",te,"){"),Yn(),be("}else{"),Gr(),be("}")):Gr()}Gt&&(typeof Je!="number"||Je>=0)?typeof Je=="string"?(be("if(",Je,">0){"),cn(),be("}else if(",Je,"<0){"),An(),be("}")):cn():An()}function fr(ie,Z,be,Ie,Ge){var _e=kn(),Ce=_e.proc("body",Ge);return J.optional(function(){_e.commandStr=Z.commandStr,_e.command=_e.link(Z.commandStr)}),Gt&&(_e.instancing=Ce.def(_e.shared.extensions,".angle_instanced_arrays")),ie(_e,Ce,be,Ie),_e.compile().body}function Ar(ie,Z,be,Ie){Ri(ie,Z),be.useVAO?be.drawVAO?Z(ie.shared.vao,".setVAO(",be.drawVAO.append(ie,Z),");"):Z(ie.shared.vao,".setVAO(",ie.shared.vao,".targetVAO);"):(Z(ie.shared.vao,".setVAO(null);"),_o(ie,Z,be,Ie.attributes,function(){return!0})),Hr(ie,Z,be,Ie.uniforms,function(){return!0}),_n(ie,Z,Z,be)}function ki(ie,Z){var be=ie.proc("draw",1);Ri(ie,be),Xi(ie,be,Z.context),Yi(ie,be,Z.framebuffer),bo(ie,be,Z),So(ie,be,Z.state),Qn(ie,be,Z,!1,!0);var Ie=Z.shader.progVar.append(ie,be);if(be(ie.shared.gl,".useProgram(",Ie,".program);"),Z.shader.program)Ar(ie,be,Z,Z.shader.program);else{be(ie.shared.vao,".setVAO(null);");var Ge=ie.global.def("{}"),_e=be.def(Ie,".id"),Ce=be.def(Ge,"[",_e,"]");be(ie.cond(Ce).then(Ce,".call(this,a0);").else(Ce,"=",Ge,"[",_e,"]=",ie.link(function(Ne){return fr(Ar,ie,Z,Ne,1)}),"(",Ie,");",Ce,".call(this,a0);"))}Object.keys(Z.state).length>0&&be(ie.shared.current,".dirty=true;")}function ga(ie,Z,be,Ie){ie.batchId="a1",Ri(ie,Z);function Ge(){return!0}_o(ie,Z,be,Ie.attributes,Ge),Hr(ie,Z,be,Ie.uniforms,Ge),_n(ie,Z,Z,be)}function lc(ie,Z,be,Ie){Ri(ie,Z);var Ge=be.contextDep,_e=Z.def(),Ce="a0",Ne="a1",oe=Z.def();ie.shared.props=oe,ie.batchId=_e;var ye=ie.scope(),te=ie.scope();Z(ye.entry,"for(",_e,"=0;",_e,"<",Ne,";++",_e,"){",oe,"=",Ce,"[",_e,"];",te,"}",ye.exit);function Re(mn){return mn.contextDep&&Ge||mn.propDep}function ze(mn){return!Re(mn)}if(be.needsContext&&Xi(ie,te,be.context),be.needsFramebuffer&&Yi(ie,te,be.framebuffer),So(ie,te,be.state,Re),be.profile&&Re(be.profile)&&Qn(ie,te,be,!1,!0),Ie)be.useVAO?be.drawVAO?Re(be.drawVAO)?te(ie.shared.vao,".setVAO(",be.drawVAO.append(ie,te),");"):ye(ie.shared.vao,".setVAO(",be.drawVAO.append(ie,ye),");"):ye(ie.shared.vao,".setVAO(",ie.shared.vao,".targetVAO);"):(ye(ie.shared.vao,".setVAO(null);"),_o(ie,ye,be,Ie.attributes,ze),_o(ie,te,be,Ie.attributes,Re)),Hr(ie,ye,be,Ie.uniforms,ze),Hr(ie,te,be,Ie.uniforms,Re),_n(ie,ye,te,be);else{var rt=ie.global.def("{}"),st=be.shader.progVar.append(ie,te),Je=te.def(st,".id"),kt=te.def(rt,"[",Je,"]");te(ie.shared.gl,".useProgram(",st,".program);","if(!",kt,"){",kt,"=",rt,"[",Je,"]=",ie.link(function(mn){return fr(ga,ie,be,mn,2)}),"(",st,");}",kt,".call(this,a0[",_e,"],",_e,");")}}function ue(ie,Z){var be=ie.proc("batch",2);ie.batchId="0",Ri(ie,be);var Ie=!1,Ge=!0;Object.keys(Z.context).forEach(function(rt){Ie=Ie||Z.context[rt].propDep}),Ie||(Xi(ie,be,Z.context),Ge=!1);var _e=Z.framebuffer,Ce=!1;_e?(_e.propDep?Ie=Ce=!0:_e.contextDep&&Ie&&(Ce=!0),Ce||Yi(ie,be,_e)):Yi(ie,be,null),Z.state.viewport&&Z.state.viewport.propDep&&(Ie=!0);function Ne(rt){return rt.contextDep&&Ie||rt.propDep}bo(ie,be,Z),So(ie,be,Z.state,function(rt){return!Ne(rt)}),(!Z.profile||!Ne(Z.profile))&&Qn(ie,be,Z,!1,"a1"),Z.contextDep=Ie,Z.needsContext=Ge,Z.needsFramebuffer=Ce;var oe=Z.shader.progVar;if(oe.contextDep&&Ie||oe.propDep)lc(ie,be,Z,null);else{var ye=oe.append(ie,be);if(be(ie.shared.gl,".useProgram(",ye,".program);"),Z.shader.program)lc(ie,be,Z,Z.shader.program);else{be(ie.shared.vao,".setVAO(null);");var te=ie.global.def("{}"),Re=be.def(ye,".id"),ze=be.def(te,"[",Re,"]");be(ie.cond(ze).then(ze,".call(this,a0,a1);").else(ze,"=",te,"[",Re,"]=",ie.link(function(rt){return fr(lc,ie,Z,rt,2)}),"(",ye,");",ze,".call(this,a0,a1);"))}}Object.keys(Z.state).length>0&&be(ie.shared.current,".dirty=true;")}function We(ie,Z){var be=ie.proc("scope",3);ie.batchId="a2";var Ie=ie.shared,Ge=Ie.current;Xi(ie,be,Z.context),Z.framebuffer&&Z.framebuffer.append(ie,be),Tv(Object.keys(Z.state)).forEach(function(Ce){var Ne=Z.state[Ce],oe=Ne.append(ie,be);Jn(oe)?oe.forEach(function(ye,te){be.set(ie.next[Ce],"["+te+"]",ye)}):be.set(Ie.next,"."+Ce,oe)}),Qn(ie,be,Z,!0,!0),[ic,Qh,oc,hl,Da].forEach(function(Ce){var Ne=Z.draw[Ce];!Ne||be.set(Ie.draw,"."+Ce,""+Ne.append(ie,be))}),Object.keys(Z.uniforms).forEach(function(Ce){var Ne=Z.uniforms[Ce].append(ie,be);Array.isArray(Ne)&&(Ne="["+Ne.join()+"]"),be.set(Ie.uniforms,"["+Y.id(Ce)+"]",Ne)}),Object.keys(Z.attributes).forEach(function(Ce){var Ne=Z.attributes[Ce].append(ie,be),oe=ie.scopeAttrib(Ce);Object.keys(new Le).forEach(function(ye){be.set(oe,"."+ye,Ne[ye])})}),Z.scopeVAO&&be.set(Ie.vao,".targetVAO",Z.scopeVAO.append(ie,be));function _e(Ce){var Ne=Z.shader[Ce];Ne&&be.set(Ie.shader,"."+Ce,Ne.append(ie,be))}_e(yd),_e(bd),Object.keys(Z.state).length>0&&(be(Ge,".dirty=true;"),be.exit(Ge,".dirty=true;")),be("a1(",ie.shared.context,",a0,",ie.batchId,");")}function je(ie){if(!(typeof ie!="object"||Jn(ie))){for(var Z=Object.keys(ie),be=0;be<Z.length;++be)if(wi.isDynamic(ie[Z[be]]))return!0;return!1}}function rn(ie,Z,be){var Ie=Z.static[be];if(!Ie||!je(Ie))return;var Ge=ie.global,_e=Object.keys(Ie),Ce=!1,Ne=!1,oe=!1,ye=ie.global.def("{}");_e.forEach(function(Re){var ze=Ie[Re];if(wi.isDynamic(ze)){typeof ze=="function"&&(ze=Ie[Re]=wi.unbox(ze));var rt=ls(ze,null);Ce=Ce||rt.thisDep,oe=oe||rt.propDep,Ne=Ne||rt.contextDep}else{switch(Ge(ye,".",Re,"="),typeof ze){case"number":Ge(ze);break;case"string":Ge('"',ze,'"');break;case"object":Array.isArray(ze)&&Ge("[",ze.join(),"]");break;default:Ge(ie.link(ze));break}Ge(";")}});function te(Re,ze){_e.forEach(function(rt){var st=Ie[rt];if(!!wi.isDynamic(st)){var Je=Re.invoke(ze,st);ze(ye,".",rt,"=",Je,";")}})}Z.dynamic[be]=new wi.DynamicVariable(Kh,{thisDep:Ce,contextDep:Ne,propDep:oe,ref:ye,append:te}),delete Z.static[be]}function dr(ie,Z,be,Ie,Ge){var _e=kn();_e.stats=_e.link(Ge),Object.keys(Z.static).forEach(function(Ne){rn(_e,Z,Ne)}),zx.forEach(function(Ne){rn(_e,ie,Ne)});var Ce=ri(ie,Z,be,Ie,_e);return ki(_e,Ce),We(_e,Ce),ue(_e,Ce),w(_e.compile(),{destroy:function(){Ce.shader.program.destroy()}})}return{next:en,current:gt,procs:function(){var ie=kn(),Z=ie.proc("poll"),be=ie.proc("refresh"),Ie=ie.block();Z(Ie),be(Ie);var Ge=ie.shared,_e=Ge.gl,Ce=Ge.next,Ne=Ge.current;Ie(Ne,".dirty=false;"),Yi(ie,Z),Yi(ie,be,null,!0);var oe;Gt&&(oe=ie.link(Gt)),ge.oes_vertex_array_object&&be(ie.link(ge.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var ye=0;ye<$e.maxAttributes;++ye){var te=be.def(Ge.attributes,"[",ye,"]"),Re=ie.cond(te,".buffer");Re.then(_e,".enableVertexAttribArray(",ye,");",_e,".bindBuffer(",qc,",",te,".buffer.buffer);",_e,".vertexAttribPointer(",ye,",",te,".size,",te,".type,",te,".normalized,",te,".stride,",te,".offset);").else(_e,".disableVertexAttribArray(",ye,");",_e,".vertexAttrib4f(",ye,",",te,".x,",te,".y,",te,".z,",te,".w);",te,".buffer=null;"),be(Re),Gt&&be(oe,".vertexAttribDivisorANGLE(",ye,",",te,".divisor);")}return be(ie.shared.vao,".currentVAO=null;",ie.shared.vao,".setVAO(",ie.shared.vao,".targetVAO);"),Object.keys(jt).forEach(function(ze){var rt=jt[ze],st=Ie.def(Ce,".",ze),Je=ie.block();Je("if(",st,"){",_e,".enable(",rt,")}else{",_e,".disable(",rt,")}",Ne,".",ze,"=",st,";"),be(Je),Z("if(",st,"!==",Ne,".",ze,"){",Je,"}")}),Object.keys(vt).forEach(function(ze){var rt=vt[ze],st=gt[ze],Je,kt,mn=ie.block();if(mn(_e,".",rt,"("),Jn(st)){var tr=st.length;Je=ie.global.def(Ce,".",ze),kt=ie.global.def(Ne,".",ze),mn(Ui(tr,function(cn){return Je+"["+cn+"]"}),");",Ui(tr,function(cn){return kt+"["+cn+"]="+Je+"["+cn+"];"}).join("")),Z("if(",Ui(tr,function(cn){return Je+"["+cn+"]!=="+kt+"["+cn+"]"}).join("||"),"){",mn,"}")}else Je=Ie.def(Ce,".",ze),kt=Ie.def(Ne,".",ze),mn(Je,");",Ne,".",ze,"=",Je,";"),Z("if(",Je,"!==",kt,"){",mn,"}");be(mn)}),ie.compile()}(),compile:dr}}function nC(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var rC=34918,iC=34919,Mv=35007,oC=function(O,Y){if(!Y.ext_disjoint_timer_query)return null;var ge=[];function $e(){return ge.pop()||Y.ext_disjoint_timer_query.createQueryEXT()}function ot(Gt){ge.push(Gt)}var He=[];function Ke(Gt){var Qt=$e();Y.ext_disjoint_timer_query.beginQueryEXT(Mv,Qt),He.push(Qt),_t(He.length-1,He.length,Gt)}function Et(){Y.ext_disjoint_timer_query.endQueryEXT(Mv)}function Dt(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Lt=[];function Mt(){return Lt.pop()||new Dt}function Ut(Gt){Lt.push(Gt)}var Wt=[];function _t(Gt,Qt,gt){var en=Mt();en.startQueryIndex=Gt,en.endQueryIndex=Qt,en.sum=0,en.stats=gt,Wt.push(en)}var Bt=[],Le=[];function Ye(){var Gt,Qt,gt=He.length;if(gt!==0){Le.length=Math.max(Le.length,gt+1),Bt.length=Math.max(Bt.length,gt+1),Bt[0]=0,Le[0]=0;var en=0;for(Gt=0,Qt=0;Qt<He.length;++Qt){var yt=He[Qt];Y.ext_disjoint_timer_query.getQueryObjectEXT(yt,iC)?(en+=Y.ext_disjoint_timer_query.getQueryObjectEXT(yt,rC),ot(yt)):He[Gt++]=yt,Bt[Qt+1]=en,Le[Qt+1]=Gt}for(He.length=Gt,Gt=0,Qt=0;Qt<Wt.length;++Qt){var jt=Wt[Qt],vt=jt.startQueryIndex,Rt=jt.endQueryIndex;jt.sum+=Bt[Rt]-Bt[vt];var En=Le[vt],zn=Le[Rt];zn===En?(jt.stats.gpuTime+=jt.sum/1e6,Ut(jt)):(jt.startQueryIndex=En,jt.endQueryIndex=zn,Wt[Gt++]=jt)}Wt.length=Gt}}return{beginQuery:Ke,endQuery:Et,pushScopeStats:_t,update:Ye,getNumPendingQueries:function(){return He.length},clear:function(){ge.push.apply(ge,He);for(var Gt=0;Gt<ge.length;Gt++)Y.ext_disjoint_timer_query.deleteQueryEXT(ge[Gt]);He.length=0,ge.length=0},restore:function(){He.length=0,ge.length=0}}},sC=16384,aC=256,lC=1024,Na=34962,Pv="webglcontextlost",cC="webglcontextrestored",Ov=1,_g=2,Dv=3;function Ag(O,Y){for(var ge=0;ge<O.length;++ge)if(O[ge]===Y)return ge;return-1}function uC(O){var Y=Fl(O);if(!Y)return null;var ge=Y.gl,$e=ge.getContextAttributes(),ot=ge.isContextLost(),He=io(ge,Y);if(!He)return null;var Ke=Nc(),Et=nC(),Dt=He.extensions,Lt=oC(ge,Dt),Mt=sa(),Ut=ge.drawingBufferWidth,Wt=ge.drawingBufferHeight,_t={tick:0,time:0,viewportWidth:Ut,viewportHeight:Wt,framebufferWidth:Ut,framebufferHeight:Wt,drawingBufferWidth:Ut,drawingBufferHeight:Wt,pixelRatio:Y.pixelRatio},Bt={},Le={elements:null,primitive:4,count:-1,offset:0,instances:-1},Ye=Bp(ge,Dt),Gt=Rh(ge,Et,Y,gt),Qt=kx(ge,Dt,Ye,Et,Gt);function gt(_n){return Qt.destroyBuffer(_n)}var en=ur(ge,Dt,Gt,Et),yt=Ix(ge,Ke,Et,Y),jt=yx(ge,Dt,Ye,function(){En.procs.poll()},_t,Et,Y),vt=bx(ge,Dt,Ye,Et,Y),Rt=Rx(ge,Dt,Ye,jt,vt,Et),En=tC(ge,Ke,Dt,Ye,Gt,en,jt,Rt,Bt,Qt,yt,Le,_t,Lt,Y),zn=tc(ge,Rt,En.procs.poll,_t,$e,Dt,Ye),Zt=En.next,Pt=ge.canvas,dt=[],kn=[],er=[],ln=[Y.onDestroy],ar=null;function Vn(){if(dt.length===0){Lt&&Lt.update(),ar=null;return}ar=Cr.next(Vn),So();for(var _n=dt.length-1;_n>=0;--_n){var fr=dt[_n];fr&&fr(_t,null,0)}ge.flush(),Lt&&Lt.update()}function rr(){!ar&&dt.length>0&&(ar=Cr.next(Vn))}function Er(){ar&&(Cr.cancel(Vn),ar=null)}function Hi(_n){_n.preventDefault(),ot=!0,Er(),kn.forEach(function(fr){fr()})}function ir(_n){ge.getError(),ot=!1,He.restore(),yt.restore(),Gt.restore(),jt.restore(),vt.restore(),Rt.restore(),Qt.restore(),Lt&&Lt.restore(),En.procs.refresh(),rr(),er.forEach(function(fr){fr()})}Pt&&(Pt.addEventListener(Pv,Hi,!1),Pt.addEventListener(cC,ir,!1));function mr(){dt.length=0,Er(),Pt&&(Pt.removeEventListener(Pv,Hi),Pt.removeEventListener(cC,ir)),yt.clear(),Rt.clear(),vt.clear(),jt.clear(),en.clear(),Gt.clear(),Qt.clear(),Lt&&Lt.clear(),ln.forEach(function(_n){_n()})}function oo(_n){J(!!_n,"invalid args to regl({...})"),J.type(_n,"object","invalid args to regl({...})");function fr(Ge){var _e=w({},Ge);delete _e.uniforms,delete _e.attributes,delete _e.context,delete _e.vao,"stencil"in _e&&_e.stencil.op&&(_e.stencil.opBack=_e.stencil.opFront=_e.stencil.op,delete _e.stencil.op);function Ce(Ne){if(Ne in _e){var oe=_e[Ne];delete _e[Ne],Object.keys(oe).forEach(function(ye){_e[Ne+"."+ye]=oe[ye]})}}return Ce("blend"),Ce("depth"),Ce("cull"),Ce("stencil"),Ce("polygonOffset"),Ce("scissor"),Ce("sample"),"vao"in Ge&&(_e.vao=Ge.vao),_e}function Ar(Ge,_e){var Ce={},Ne={};return Object.keys(Ge).forEach(function(oe){var ye=Ge[oe];if(wi.isDynamic(ye)){Ne[oe]=wi.unbox(ye,oe);return}else if(_e&&Array.isArray(ye)){for(var te=0;te<ye.length;++te)if(wi.isDynamic(ye[te])){Ne[oe]=wi.unbox(ye,oe);return}}Ce[oe]=ye}),{dynamic:Ne,static:Ce}}var ki=Ar(_n.context||{},!0),ga=Ar(_n.uniforms||{},!0),lc=Ar(_n.attributes||{},!1),ue=Ar(fr(_n),!1),We={gpuTime:0,cpuTime:0,count:0},je=En.compile(ue,lc,ga,ki,We),rn=je.draw,dr=je.batch,ie=je.scope,Z=[];function be(Ge){for(;Z.length<Ge;)Z.push(null);return Z}function Ie(Ge,_e){var Ce;if(ot&&J.raise("context lost"),typeof Ge=="function")return ie.call(this,null,Ge,0);if(typeof _e=="function")if(typeof Ge=="number")for(Ce=0;Ce<Ge;++Ce)ie.call(this,null,_e,Ce);else if(Array.isArray(Ge))for(Ce=0;Ce<Ge.length;++Ce)ie.call(this,Ge[Ce],_e,Ce);else return ie.call(this,Ge,_e,0);else if(typeof Ge=="number"){if(Ge>0)return dr.call(this,be(Ge|0),Ge|0)}else if(Array.isArray(Ge)){if(Ge.length)return dr.call(this,Ge,Ge.length)}else return rn.call(this,Ge)}return w(Ie,{stats:We,destroy:function(){je.destroy()}})}var gi=Rt.setFBO=oo({framebuffer:wi.define.call(null,Ov,"framebuffer")});function ri(_n,fr){var Ar=0;En.procs.poll();var ki=fr.color;ki&&(ge.clearColor(+ki[0]||0,+ki[1]||0,+ki[2]||0,+ki[3]||0),Ar|=sC),"depth"in fr&&(ge.clearDepth(+fr.depth),Ar|=aC),"stencil"in fr&&(ge.clearStencil(fr.stencil|0),Ar|=lC),J(!!Ar,"called regl.clear with no buffer specified"),ge.clear(Ar)}function Xi(_n){if(J(typeof _n=="object"&&_n,"regl.clear() takes an object as input"),"framebuffer"in _n)if(_n.framebuffer&&_n.framebuffer_reglType==="framebufferCube")for(var fr=0;fr<6;++fr)gi(w({framebuffer:_n.framebuffer.faces[fr]},_n),ri);else gi(_n,ri);else ri(null,_n)}function Yi(_n){J.type(_n,"function","regl.frame() callback must be a function"),dt.push(_n);function fr(){var Ar=Ag(dt,_n);J(Ar>=0,"cannot cancel a frame twice");function ki(){var ga=Ag(dt,ki);dt[ga]=dt[dt.length-1],dt.length-=1,dt.length<=0&&Er()}dt[Ar]=ki}return rr(),{cancel:fr}}function bo(){var _n=Zt.viewport,fr=Zt.scissor_box;_n[0]=_n[1]=fr[0]=fr[1]=0,_t.viewportWidth=_t.framebufferWidth=_t.drawingBufferWidth=_n[2]=fr[2]=ge.drawingBufferWidth,_t.viewportHeight=_t.framebufferHeight=_t.drawingBufferHeight=_n[3]=fr[3]=ge.drawingBufferHeight}function So(){_t.tick+=1,_t.time=Qn(),bo(),En.procs.poll()}function Ri(){jt.refresh(),bo(),En.procs.refresh(),Lt&&Lt.update()}function Qn(){return(sa()-Mt)/1e3}Ri();function _o(_n,fr){J.type(fr,"function","listener callback must be a function");var Ar;switch(_n){case"frame":return Yi(fr);case"lost":Ar=kn;break;case"restore":Ar=er;break;case"destroy":Ar=ln;break;default:J.raise("invalid event, must be one of frame,lost,restore,destroy")}return Ar.push(fr),{cancel:function(){for(var ki=0;ki<Ar.length;++ki)if(Ar[ki]===fr){Ar[ki]=Ar[Ar.length-1],Ar.pop();return}}}}var Hr=w(oo,{clear:Xi,prop:wi.define.bind(null,Ov),context:wi.define.bind(null,_g),this:wi.define.bind(null,Dv),draw:oo({}),buffer:function(_n){return Gt.create(_n,Na,!1,!1)},elements:function(_n){return en.create(_n,!1)},texture:jt.create2D,cube:jt.createCube,renderbuffer:vt.create,framebuffer:Rt.create,framebufferCube:Rt.createCube,vao:Qt.createVAO,attributes:$e,frame:Yi,on:_o,limits:Ye,hasExtension:function(_n){return Ye.extensions.indexOf(_n.toLowerCase())>=0},read:zn,destroy:mr,_gl:ge,_refresh:Ri,poll:function(){So(),Lt&&Lt.update()},now:Qn,stats:Et});return Y.onDone(null,Hr),Hr}return uC})},94633:function(Se){Se.exports=function(F){return N(w(F),F)},Se.exports.array=N;function N(F,U){var X=F.length,me=new Array(X),K={},q=X,ae=k(U),ee=D(F);for(U.forEach(function(W){if(!ee.has(W[0])||!ee.has(W[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});q--;)K[q]||V(F[q],q,new Set);return me;function V(W,ce,B){if(B.has(W)){var se;try{se=", node was:"+JSON.stringify(W)}catch(R){se=""}throw new Error("Cyclic dependency"+se)}if(!ee.has(W))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(W));if(!K[ce]){K[ce]=!0;var j=ae.get(W)||new Set;if(j=Array.from(j),ce=j.length){B.add(W);do{var b=j[--ce];V(b,ee.get(b),B)}while(ce);B.delete(W)}me[--X]=W}}}function w(F){for(var U=new Set,X=0,me=F.length;X<me;X++){var K=F[X];U.add(K[0]),U.add(K[1])}return Array.from(U)}function k(F){for(var U=new Map,X=0,me=F.length;X<me;X++){var K=F[X];U.has(K[0])||U.set(K[0],new Set),U.has(K[1])||U.set(K[1],new Set),U.get(K[0]).add(K[1])}return U}function D(F){for(var U=new Map,X=0,me=F.length;X<me;X++)U.set(F[X],X);return U}}}]);
